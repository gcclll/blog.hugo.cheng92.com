<!DOCTYPE html>
<html lang="en">
<head>
  <!-- 2022-05-05 Thu 10:14 -->
  <meta charset="utf-8">
  <meta name="viewport" content=
  "width=device-width, initial-scale=1">
  <title>build your own vue compiler-sfc</title>
  <meta name="author" content="Zhicheng Lee">
  <meta name="generator" content="Org Mode">
  <style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  </style>
  <link rel="stylesheet" type="text/css" href=
  "/assets/css/htmlize.css">
  <link rel="stylesheet" type="text/css" href=
  "/assets/css/readtheorg.css">
  <link rel="stylesheet" type="text/css" href=
  "/assets/css/global.css">
  <link rel="stylesheet" type="text/css" href=
  "/assets/css/element-plus.css">
  <link rel="icon" type="image/png" sizes="48x48" href=
  "/favicon.ico">
  <script type="text/javascript" src=
  "/assets/js/jquery.min.js"></script>
  <script type="text/javascript" src=
  "/assets/js/jquery.stickytableheaders.min.js"></script>
  <script type="text/javascript" src=
  "/assets/js/bootstrap.min.js"></script>
  <script type="text/javascript" src=
  "/assets/js/lodash.min.js"></script>
  <script type="text/javascript" src=
  "/assets/js/readtheorg.js"></script>
  <link rel="stylesheet" href="/assets/js/fancybox/fancybox.css"
  type="text/css" media="screen">
  <script type="text/javascript" src=
  "/assets/js/fancybox/fancybox.umd.js"></script>
  <script type="text/javascript" src=
  "/assets/js/mobile-detect.min.js"></script>
  <script type="text/javascript" src=
  "/assets/js/Valine.min.js"></script>
  <script type="text/javascript" src="/assets/js/vue.js"></script>
  <script type="text/javascript" src=
  "/assets/js/element-plus.js"></script>
  <script type="text/javascript" src=
  "/assets/js/dist/stats.js"></script>
  <script type="text/javascript" src=
  "/assets/js/dist/apps.js"></script>
  <script type="text/javascript" src=
  "/assets/js/dist/global.js"></script>
  <meta name="category" content="vue">
  <meta name="tags" content="compiler-sfc">
  <meta name="createdAt" content="2022-04-28 16:19:09">
  <style>
        /* From: https://endlessparentheses.com/public/css/endless.css */
        /* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
        kbd
        {
          -moz-border-radius: 6px;
          -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
          -webkit-border-radius: 6px;
          -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
          background-color: #f7f7f7;
          border: 1px solid #ccc;
          border-radius: 6px;
          box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
          color: #333;
          display: inline-block;
          font-family: 'Droid Sans Mono', monospace;
          font-size: 80%;
          font-weight: normal;
          line-height: inherit;
          margin: 0 .1em;
          padding: .08em .4em;
          text-shadow: 0 1px 0 #fff;
          word-spacing: -4px;
        
          box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
        }
  </style>
  <link rel="stylesheet" type="text/css" href=
  "/assets/css/tooltipster.bundle.min.css">
  <link rel="stylesheet" type="text/css" href=
  "/assets/css/tooltipster-sideTip-punk.min.css">
  <script type="text/javascript">
            if (typeof jQuery == 'undefined') {
                document.write(unescape('%3Cscript src="https://code.jquery.com/jquery-1.10.0.min.js"%3E%3C/script%3E'));
            }
  </script>
  <script type="text/javascript" src=
  "/assets/js/tooltipster.bundle.min.js"></script>
  <script type="text/javascript" src=
  "/assets/js/tooltipster-scrollableTip.min.js"></script>
  <script type="text/javascript" src=
  "/assets/js/dist/tooltips.js"></script>
  <style>
           abbr {color: red;}
        
           .tooltip { border-bottom: 1px dotted #000;
                      color:red;
                      text-decoration: none;}
  </style>
</head>
<body>
  <div id="content" class="content">
    <h1 class="title">build your own vue compiler-sfc</h1>
    <div id="table-of-contents" role="doc-toc">
      <h2>Table of Contents</h2>
      <div id="text-table-of-contents" role="doc-toc">
        <ul>
          <li>
            <a href="#org0bf7807">1. GlobalVars</a>
            <ul>
              <li>
                <a href="#org9139d8f">1.1. reactivity-transform</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="#org92ff454">2. script</a>
            <ul>
              <li>
                <a href="#org807a578">2.1. compileScript()</a>
              </li>
              <li>
                <a href="#org92987cf">2.2. utils</a>
                <ul>
                  <li>
                    <a href="#orgfb208d2">2.2.1. helper()</a>
                  </li>
                  <li>
                    <a href="#org0d7af35">2.2.2. parse()</a>
                  </li>
                  <li>
                    <a href="#org4f93937">2.2.3. error()</a>
                  </li>
                  <li>
                    <a href="#orgdf5b916">2.2.4.
                    registerUserImport()</a>
                  </li>
                  <li>
                    <a href="#org1b99f2e">2.2.5.
                    processDefineProps()</a>
                  </li>
                  <li>
                    <a href="#orgda18fb6">2.2.6.
                    processWithDefaults()</a>
                  </li>
                  <li>
                    <a href="#org80b2259">2.2.7.
                    processDefineEmits()</a>
                  </li>
                  <li>
                    <a href="#orgcdc2f57">2.2.8.
                    resolveQualifiedType()</a>
                  </li>
                  <li>
                    <a href="#orgaef0ead">2.2.9.
                    processDefineExpose()</a>
                  </li>
                  <li>
                    <a href="#org6da1a64">2.2.10.
                    checkInvalidScopeReference()</a>
                  </li>
                  <li>
                    <a href="#org1cbcbee">2.2.11.
                    processAwait()</a>
                  </li>
                  <li>
                    <a href="#orged495a9">2.2.12.
                    hasStaticWithDefaults()</a>
                  </li>
                  <li>
                    <a href="#org4a211df">2.2.13.
                    genRuntimeProps()</a>
                  </li>
                  <li>
                    <a href="#org5320144">2.2.14.
                    genDestructuredDefaultValue()</a>
                  </li>
                  <li>
                    <a href="#org45d51ad">2.2.15.
                    genSetupPropsType()</a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="#org0a984a9">2.3. steps</a>
                <ul>
                  <li>
                    <a href="#org934fbd6">2.3.1. process normal
                    script</a>
                  </li>
                  <li>
                    <a href="#org69d0234">2.3.2. process setup
                    script</a>
                  </li>
                  <li>
                    <a href="#orgb9eb434">2.3.3. apply reactivity
                    transform</a>
                  </li>
                  <li>
                    <a href="#orgef5f97f">2.3.4. extract runtime
                    props/emits</a>
                  </li>
                  <li>
                    <a href="#org2f63b19">2.3.5. check useOptions
                    dont ref setup scope variables</a>
                  </li>
                  <li>
                    <a href="#org9e9ebdb">2.3.6. remove non-script
                    content</a>
                  </li>
                  <li>
                    <a href="#orgb8f7b27">2.3.7. analyze binding
                    metadata</a>
                  </li>
                  <li>
                    <a href="#orgfeaa62f">2.3.8. inject useCssVars
                    calls</a>
                  </li>
                  <li>
                    <a href="#org09fc0a6">2.3.9. finalize setup()
                    argument signature</a>
                  </li>
                  <li>
                    <a href="#orge3301b8">2.3.10. generate return
                    statement</a>
                  </li>
                  <li>
                    <a href="#orgd6ebf1b">2.3.11. finalize default
                    export</a>
                  </li>
                  <li>
                    <a href="#orga8fcc52">2.3.12. finalize Vue
                    helper imports</a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="#orgb2db54f">2.4. functions</a>
                <ul>
                  <li>
                    <a href="#org6296eab">2.4.1.
                    registerBinding()</a>
                  </li>
                  <li>
                    <a href="#orgf0bbba4">2.4.2.
                    walkDeclaration()</a>
                  </li>
                  <li>
                    <a href="#org234c7d6">2.4.3.
                    walkObjectPattern()</a>
                  </li>
                  <li>
                    <a href="#orga60be00">2.4.4.
                    walkArrayPattern()</a>
                  </li>
                  <li>
                    <a href="#orgd71799c">2.4.5. walkPattern()</a>
                  </li>
                  <li>
                    <a href="#org97d0f54">2.4.6. recordType()</a>
                  </li>
                  <li>
                    <a href="#orgc41d9be">2.4.7.
                    extractRuntimeProps()</a>
                  </li>
                  <li>
                    <a href="#org999a464">2.4.8.
                    inferRuntimeType()</a>
                  </li>
                  <li>
                    <a href="#org7e4ac77">2.4.9.
                    toRuntimeTypeString()</a>
                  </li>
                  <li>
                    <a href="#org7dbc85e">2.4.10.
                    extractRuntimeEmits()</a>
                  </li>
                  <li>
                    <a href="#orgea4e472">2.4.11.
                    extractEventNames()</a>
                  </li>
                  <li>
                    <a href="#org297819b">2.4.12.
                    genRuntimeEmits()</a>
                  </li>
                  <li>
                    <a href="#orgfde16d9">2.4.13. isCallOf()</a>
                  </li>
                  <li>
                    <a href="#org28fbd86">2.4.14.
                    canNeverBeRef()</a>
                  </li>
                  <li>
                    <a href="#orgda510b0">2.4.15.
                    analyzeScriptBindings()</a>
                  </li>
                  <li>
                    <a href="#orgd96b3d9">2.4.16.
                    analyzeBindingsFromOptions()</a>
                  </li>
                  <li>
                    <a href="#org30d8fc0">2.4.17.
                    getObjectExpressionKeys()</a>
                  </li>
                  <li>
                    <a href="#org5684efd">2.4.18.
                    getArrayExpressionKeys()</a>
                  </li>
                  <li>
                    <a href="#org6b35df7">2.4.19.
                    getObjectOrArrayExpressionKeys()</a>
                  </li>
                  <li>
                    <a href="#org01b16fb">2.4.20.
                    resolveTemplateUsageCheckString()</a>
                  </li>
                  <li>
                    <a href="#orgdac734f">2.4.21.
                    stripStrings()</a>
                  </li>
                  <li>
                    <a href="#orga7be713">2.4.22.
                    stripTemplateString()</a>
                  </li>
                  <li>
                    <a href="#org08f0a0a">2.4.23.
                    isImportUsed()</a>
                  </li>
                  <li>
                    <a href="#org5f0593d">2.4.24.
                    hmrShouldReload()</a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="#org5cb8c0d">2.5. rewriteDefault</a>
              </li>
              <li>
                <a href="#org51806fe">2.6. cssVars</a>
              </li>
              <li>
                <a href="#org1cf2850">2.7. testing</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="#org5259eed">3. template</a>
            <ul>
              <li>
                <a href="#org7ca679e">3.1. compileTemplate()</a>
              </li>
            </ul>
          </li>
          <li>
            <a href="#org9b490a0">4. mindmaps</a>
          </li>
        </ul>
      </div>
    </div>
    <p><a href="/"><img src=
    "https://img.shields.io/badge/GCCLL-Homepage-green?logo=gnu-emacs"></a></p>
    <p>TODO compiler-sfc</p><br>
    <details class="code-details" style=
    "padding: 1em; background-color: #e5f5e5; /* background-color: pink; */ border-radius: 15px; color: hsl(157 75%); font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;">
      <summary>
        <strong><font face="Courier" size="3" color=
        "green">compiler-dom</font></strong>
      </summary>
      <p><a href=
      "https://blog.cheng92.com/posts/build_your_own_vue_compiler_dom.html">
      build your own vue compiler-dom</a></p>
      <div class="org-src-container">
        <pre class="src src-js" id="org4be670b"><span class=
        "linenr">    1: </span><span class=
        "org-keyword">let</span> <span class=
        "org-variable-name">__BROWSER__</span> = <span class=
        "org-keyword">typeof</span> window !== <span class=
        "org-string">'undefined'</span>
<span class="linenr">    2: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">logs</span> = {}, <span class=
"org-variable-name">currentLogKey</span> = <span class=
"org-string">'cc'</span>
<span class="linenr">    3: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">w</span> = {}
<span class="linenr">    4: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">debugEle</span> = <span class=
"org-constant">null</span>
<span class="linenr">    5: </span><span class=
"org-keyword">if</span> (__BROWSER__) {
<span class="linenr">    6: </span>  w = <span class=
"org-keyword">typeof</span> window !== <span class=
"org-string">'undefined'</span> ? window : {}
<span class="linenr">    7: </span>}
<span class=
"linenr">    8: </span>w.log = (msg, isLine = <span class=
"org-constant">false</span>) =&gt; {
<span class="linenr">    9: </span>  <span class=
"org-keyword">if</span> (debugEle) {
<span class="linenr">   10: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">cls</span> = [<span class=
"org-string">'debug'</span>, isLine ? <span class=
"org-string">'line'</span> : <span class=
"org-string">''</span>].filter(Boolen)
<span class="linenr">   11: </span>    ele.innerHTML = <span class=
"org-string">`${debugEl.innerHTML}&lt;pre class="${cls.join(' ')}"&gt;&lt;code&gt;${</span>
<span class="linenr">   12: </span><span class=
"org-string">      typeof msg === 'object' ? syntaxHighlight(msg) : msg</span>
<span class="linenr">   13: </span><span class=
"org-string">    }&lt;/code&gt;&lt;/pre&gt;`</span>
<span class="linenr">   14: </span>    <span class=
"org-keyword">return</span> ele.innerHTML
<span class="linenr">   15: </span>  }
<span class="linenr">   16: </span>}
<span class="linenr">   17: </span>
<span class="linenr">   18: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">syntaxHighlight</span>(<span class=
"org-variable-name">json</span>) {
<span class="linenr">   19: </span>  <span class=
"org-keyword">if</span> (<span class=
"org-keyword">typeof</span> json != <span class=
"org-string">'string'</span>) {
<span class=
"linenr">   20: </span>    json = JSON.stringify(json, <span class=
"org-constant">undefined</span>, <span class=
"org-highlight-numbers-number">2</span>)
<span class="linenr">   21: </span>  }
<span class=
"linenr">   22: </span>  json = json.replace(<span class=
"org-string">/&amp;/</span>g, <span class=
"org-string">'&amp;amp;'</span>).replace(<span class=
"org-string">/&lt;/</span>g, <span class=
"org-string">'&amp;lt;'</span>).replace(<span class=
"org-string">/&gt;/</span>g, <span class=
"org-string">'&amp;gt;'</span>)
<span class="linenr">   23: </span>  <span class=
"org-keyword">return</span> json.replace(
<span class="linenr">   24: </span>    <span class=
"org-string">/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/</span>g,
<span class="linenr">   25: </span>    <span class=
"org-keyword">function</span> (<span class=
"org-variable-name">match</span>) {
<span class="linenr">   26: </span>      <span class=
"org-keyword">var</span> <span class=
"org-variable-name">cls</span> = <span class=
"org-string">'number'</span>
<span class="linenr">   27: </span>      <span class=
"org-keyword">if</span> (<span class=
"org-string">/^"/</span>.test(match)) {
<span class="linenr">   28: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-string">/:$/</span>.test(match)) {
<span class="linenr">   29: </span>          cls = <span class=
"org-string">'key'</span>
<span class="linenr">   30: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr">   31: </span>          cls = <span class=
"org-string">'string'</span>
<span class="linenr">   32: </span>        }
<span class="linenr">   33: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-string">/true|false/</span>.test(match)) {
<span class="linenr">   34: </span>        cls = <span class=
"org-string">'boolean'</span>
<span class="linenr">   35: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-string">/null/</span>.test(match)) {
<span class="linenr">   36: </span>        cls = <span class=
"org-string">'null'</span>
<span class="linenr">   37: </span>      }
<span class="linenr">   38: </span>      <span class=
"org-keyword">return</span> <span class=
"org-string">'&lt;span class="'</span> + cls + <span class=
"org-string">'"&gt;'</span> + match + <span class=
"org-string">'&lt;/span&gt;'</span>
<span class="linenr">   39: </span>    }
<span class="linenr">   40: </span>  )
<span class="linenr">   41: </span>}
<span class="linenr">   42: </span>
<span class="linenr">   43: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">babelParser</span>
<span class="linenr">   44: </span><span class=
"org-keyword">if</span> (!__BROWSER__) {
<span class=
"linenr">   45: </span>  babelParser = require(process.env.NODE_LIB + <span class="org-string">'/@babel/parser'</span>)
<span class="linenr">   46: </span>}
<span class="linenr">   47: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">The default decoder only provides escapes for characters reserved as part of</span>
<span class="linenr">   48: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the template syntax, and is only used if the custom renderer did not provide</span>
<span class="linenr">   49: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">a platform-specific decoder.</span>
<span class="linenr">   50: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">decodeRE</span> = <span class=
"org-string">/&amp;(gt|lt|amp|apos|quot);/</span>g
<span class="linenr">   51: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">decodeMap</span> = {
<span class="linenr">   52: </span>  gt: <span class=
"org-string">'&gt;'</span>,
<span class="linenr">   53: </span>  lt: <span class=
"org-string">'&lt;'</span>,
<span class="linenr">   54: </span>  amp: <span class=
"org-string">'&amp;'</span>,
<span class="linenr">   55: </span>  apos: <span class=
"org-string">"'"</span>,
<span class="linenr">   56: </span>  quot: <span class=
"org-string">'"'</span>
<span class="linenr">   57: </span>}
<span class="linenr">   58: </span>
<span class="linenr">   59: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">EMPTY_OBJ</span> = {}
<span class="linenr">   60: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">NO</span> = () =&gt; <span class=
"org-constant">false</span>
<span class="linenr">   61: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">NOOP</span> = () =&gt; {}
<span class="linenr">   62: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">locStub</span> = {
<span class="linenr">   63: </span>  source: <span class=
"org-string">''</span>,
<span class="linenr">   64: </span>  start: { line: <span class=
"org-highlight-numbers-number">1</span>, column: <span class=
"org-highlight-numbers-number">1</span>, offset: <span class=
"org-highlight-numbers-number">0</span> },
<span class="linenr">   65: </span>  end: { line: <span class=
"org-highlight-numbers-number">1</span>, column: <span class=
"org-highlight-numbers-number">1</span>, offset: <span class=
"org-highlight-numbers-number">0</span> }
<span class="linenr">   66: </span>}
<span class="linenr">   67: </span>
<span class="linenr">   68: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">ConstantTypes</span> = {
<span class="linenr">   69: </span>  NOT_CONSTANT: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr">   70: </span>  CAN_SKIP_PATCH: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr">   71: </span>  CAN_HOIST: <span class=
"org-highlight-numbers-number">2</span>,
<span class="linenr">   72: </span>  CAN_STRINGIFY: <span class=
"org-highlight-numbers-number">3</span>
<span class="linenr">   73: </span>}
<span class="linenr">   74: </span>
<span class="linenr">   75: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">ElementTypes</span> = {
<span class="linenr">   76: </span>  ELEMENT: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr">   77: </span>  COMPONENT: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr">   78: </span>  SLOT: <span class=
"org-highlight-numbers-number">2</span>,
<span class="linenr">   79: </span>  TEMPLATE: <span class=
"org-highlight-numbers-number">3</span>
<span class="linenr">   80: </span>}
<span class="linenr">   81: </span>
<span class="linenr">   82: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">Namespaces</span> = {
<span class="linenr">   83: </span>  HTML: <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">   84: </span>}
<span class="linenr">   85: </span>
<span class="linenr">   86: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">NodeTypes</span> = {
<span class="linenr">   87: </span>  ROOT: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr">   88: </span>  ELEMENT: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr">   89: </span>  TEXT: <span class=
"org-highlight-numbers-number">2</span>,
<span class="linenr">   90: </span>  COMMENT: <span class=
"org-highlight-numbers-number">3</span>,
<span class=
"linenr">   91: </span>  SIMPLE_EXPRESSION: <span class="org-highlight-numbers-number">4</span>,
<span class="linenr">   92: </span>  INTERPOLATION: <span class=
"org-highlight-numbers-number">5</span>,
<span class="linenr">   93: </span>  ATTRIBUTE: <span class=
"org-highlight-numbers-number">6</span>,
<span class="linenr">   94: </span>  DIRECTIVE: <span class=
"org-highlight-numbers-number">7</span>,
<span class="linenr">   95: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">containers</span>
<span class=
"linenr">   96: </span>  COMPOUND_EXPRESSION: <span class=
"org-highlight-numbers-number">8</span>,
<span class="linenr">   97: </span>  IF: <span class=
"org-highlight-numbers-number">9</span>,
<span class="linenr">   98: </span>  IF_BRANCH: <span class=
"org-highlight-numbers-number">10</span>,
<span class="linenr">   99: </span>  FOR: <span class=
"org-highlight-numbers-number">11</span>,
<span class="linenr">  100: </span>  TEXT_CALL: <span class=
"org-highlight-numbers-number">12</span>,
<span class="linenr">  101: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">codegen</span>
<span class="linenr">  102: </span>  VNODE_CALL: <span class=
"org-highlight-numbers-number">13</span>,
<span class=
"linenr">  103: </span>  JS_CALL_EXPRESSION: <span class=
"org-highlight-numbers-number">14</span>,
<span class=
"linenr">  104: </span>  JS_OBJECT_EXPRESSION: <span class=
"org-highlight-numbers-number">15</span>,
<span class="linenr">  105: </span>  JS_PROPERTY: <span class=
"org-highlight-numbers-number">16</span>,
<span class=
"linenr">  106: </span>  JS_ARRAY_EXPRESSION: <span class=
"org-highlight-numbers-number">17</span>,
<span class=
"linenr">  107: </span>  JS_FUNCTION_EXPRESSION: <span class=
"org-highlight-numbers-number">18</span>,
<span class=
"linenr">  108: </span>  JS_CONDITIONAL_EXPRESSION: <span class=
"org-highlight-numbers-number">19</span>,
<span class=
"linenr">  109: </span>  JS_CACHE_EXPRESSION: <span class=
"org-highlight-numbers-number">20</span>,
<span class="linenr">  110: </span>
<span class="linenr">  111: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">ssr codegen</span>
<span class=
"linenr">  112: </span>  JS_BLOCK_STATEMENT: <span class=
"org-highlight-numbers-number">21</span>,
<span class=
"linenr">  113: </span>  JS_TEMPLATE_LITERAL: <span class=
"org-highlight-numbers-number">22</span>,
<span class="linenr">  114: </span>  JS_IF_STATEMENT: <span class=
"org-highlight-numbers-number">23</span>,
<span class=
"linenr">  115: </span>  JS_ASSIGNMENT_EXPRESSION: <span class=
"org-highlight-numbers-number">24</span>,
<span class=
"linenr">  116: </span>  JS_SEQUENCE_EXPRESSION: <span class=
"org-highlight-numbers-number">25</span>,
<span class=
"linenr">  117: </span>  JS_RETURN_STATEMENT: <span class=
"org-highlight-numbers-number">26</span>
<span class="linenr">  118: </span>}
<span class="linenr">  119: </span>
<span class="linenr">  120: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">__DEV__</span> = <span class=
"org-constant">true</span>
<span class="linenr">  121: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">defaultParserOptions</span> = {
<span class="linenr">  122: </span>  delimiters: [<span class=
"org-string">`{{`</span>, <span class="org-string">`}}`</span>],
<span class=
"linenr">  123: </span>  getNamespace: () =&gt; Namespaces.HTML,
<span class=
"linenr">  124: </span>  getTextMode: () =&gt; TextModes.DATA,
<span class="linenr">  125: </span>  isVoidTag: NO,
<span class="linenr">  126: </span>  isPreTag: NO,
<span class="linenr">  127: </span>  isCustomElement: NO,
<span class=
"linenr">  128: </span>  decodeEntities: (rawText) =&gt; rawText.replace(decodeRE, (_, p1) =&gt; decodeMap[p1]),
<span class="linenr">  129: </span>  onError: defaultOnError,
<span class="linenr">  130: </span>  onWarn: defaultOnWarn,
<span class="linenr">  131: </span>  comments: __DEV__
<span class="linenr">  132: </span>}
<span class="linenr">  133: </span>
<span class="linenr">  134: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TagType</span> = {
<span class="linenr">  135: </span>  Start: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr">  136: </span>  End: <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr">  137: </span>}
<span class="linenr">  138: </span>
<span class="linenr">  139: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TextModes</span> = {
<span class="linenr">  140: </span>  DATA: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr">  141: </span>  RCDATA: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr">  142: </span>  RAWTEXT: <span class=
"org-highlight-numbers-number">2</span>,
<span class="linenr">  143: </span>  CDATA: <span class=
"org-highlight-numbers-number">3</span>,
<span class="linenr">  144: </span>  ATTRIBUTE_VALUE: <span class=
"org-highlight-numbers-number">4</span>
<span class="linenr">  145: </span>}
<span class="linenr">  146: </span>
<span class="linenr">  147: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">debugOn</span> = <span class=
"org-constant">true</span>
<span class="linenr">  148: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">log</span> = (fn, message) =&gt; {
<span class="linenr">  149: </span>  <span class=
"org-keyword">if</span> (debugOn) {
<span class="linenr">  150: </span>    <span class=
"org-keyword">if</span> (message === <span class=
"org-constant">undefined</span>) {
<span class="linenr">  151: </span>      console.log(fn)
<span class="linenr">  152: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">  153: </span>      console.log(<span class=
"org-string">`[${fn}] ${message}`</span>)
<span class="linenr">  154: </span>    }
<span class="linenr">  155: </span>  }
<span class="linenr">  156: </span>}
<span class="linenr">  157: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">logOn</span> = () =&gt; (debugOn = <span class=
"org-constant">true</span>)
<span class="linenr">  158: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">logOff</span> = () =&gt; (debugOn = <span class="org-constant">false</span>)
<span class="linenr">  159: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">logEnd</span> = (hint = <span class=
"org-string">"END"</span>) =&gt; {
<span class="linenr">  160: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">m</span> = <span class=
"org-string">`--------- ${hint} ---------`</span>
<span class="linenr">  161: </span>  <span class=
"org-keyword">if</span> (debugOn)
<span class="linenr">  162: </span>    pushLog(m, <span class=
"org-string">'title'</span>)
<span class="linenr">  163: </span>  <span class=
"org-keyword">return</span> m
<span class="linenr">  164: </span>}
<span class="linenr">  165: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">logBr</span> = () =&gt; console.log(<span class="org-string">"\n"</span>)
<span class="linenr">  166: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">debugTraverseOn</span> = <span class=
"org-constant">false</span>
<span class="linenr">  167: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">logTraverseOn</span> = () =&gt; (debugTraverseOn=<span class="org-constant">true</span>)
<span class="linenr">  168: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">logTraverseOff</span> = () =&gt; (debugTraverseOn=<span class="org-constant">false</span>)
<span class="linenr">  169: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">logg</span> = ( hint, ...msg ) =&gt; {
<span class="linenr">  170: </span>  <span class=
"org-keyword">if</span> (!debugTraverseOn &amp;& hint === <span class="org-string">'traverseNode'</span>) <span class="org-keyword">return</span>
<span class="linenr">  171: </span>  <span class=
"org-keyword">if</span> (debugOn) {
<span class="linenr">  172: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">m</span> = logEnd(hint)
<span class=
"linenr">  173: </span>    msg.forEach((m) =&gt; pushLog(m))
<span class="linenr">  174: </span>  }
<span class="linenr">  175: </span>}
<span class="linenr">  176: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">pushLog</span>(<span class=
"org-variable-name">m</span>, <span class=
"org-variable-name">type</span> = <span class=
"org-string">'normal'</span>) {
<span class=
"linenr">  177: </span>  ;( logs[currentLogKey] || (logs[currentLogKey] = [])).push({ value: m, type })
<span class="linenr">  178: </span>  log(m)
<span class="linenr">  179: </span>}
<span class="linenr">  180: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">clearLog</span>(<span class=
"org-variable-name">key</span>) {
<span class="linenr">  181: </span>  <span class=
"org-keyword">if</span> (key) {
<span class="linenr">  182: </span>    logs[key] = []
<span class="linenr">  183: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">  184: </span>    logs = {}
<span class="linenr">  185: </span>  }
<span class="linenr">  186: </span>}
<span class="linenr">  187: </span>
<span class="linenr">  188: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">extend</span> = Object.assign
<span class="linenr">  189: </span>
<span class="linenr">  190: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">defaultOnError</span>(<span class=
"org-variable-name">error</span>) {
<span class="linenr">  191: </span>  <span class=
"org-keyword">throw</span> error
<span class="linenr">  192: </span>}
<span class="linenr">  193: </span>
<span class="linenr">  194: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">defaultOnWarn</span>(<span class=
"org-variable-name">msg</span>) {
<span class=
"linenr">  195: </span>  __DEV__ &amp;& console.warn(<span class=
"org-string">`[Vue warn] ${msg.message}`</span>)
<span class="linenr">  196: </span>}
<span class="linenr">  197: </span>
<span class="linenr">  198: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">makeMap</span>(<span class=
"org-variable-name">str</span>, <span class=
"org-variable-name">expectsLowerCase</span>) {
<span class="linenr">  199: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">map</span> = Object.create(<span class=
"org-constant">null</span>)
<span class="linenr">  200: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">list</span> = str.split(<span class=
"org-string">','</span>)
<span class="linenr">  201: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; list.length; i++) {
<span class="linenr">  202: </span>    map[list[i]] = <span class=
"org-constant">true</span>
<span class="linenr">  203: </span>  }
<span class="linenr">  204: </span>  <span class=
"org-keyword">return</span> expectsLowerCase ? val =&gt; !!map[val.toLowerCase()] : val =&gt; !!map[val]
<span class="linenr">  205: </span>}
<span class="linenr">  206: </span>
<span class="linenr">  207: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">hasOwnProperty</span> = Object.<span class=
"org-constant">prototype</span>.hasOwnProperty
<span class="linenr">  208: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">hasOwn</span> = (val, key) =&gt; hasOwnProperty.call(val, key)
<span class="linenr">  209: </span>
<span class="linenr">  210: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isArray</span> = Array.isArray
<span class="linenr">  211: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isMap</span> = (val) =&gt; toTypeString(val) === <span class="org-string">'[object Map]'</span>
<span class="linenr">  212: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSet</span> = (val) =&gt; toTypeString(val) === <span class="org-string">'[object Set]'</span>
<span class="linenr">  213: </span>
<span class="linenr">  214: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDate</span> = (val) =&gt; val <span class=
"org-keyword">instanceof</span> <span class="org-type">Date</span>
<span class="linenr">  215: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isFunction</span> = (val) =&gt; <span class=
"org-keyword">typeof</span> val === <span class=
"org-string">'function'</span>
<span class="linenr">  216: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isString</span> = (val) =&gt; <span class=
"org-keyword">typeof</span> val === <span class=
"org-string">'string'</span>
<span class="linenr">  217: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSymbol</span> = (val) =&gt; <span class=
"org-keyword">typeof</span> val === <span class=
"org-string">'symbol'</span>
<span class="linenr">  218: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isObject</span> = (val) =&gt; val !== <span class="org-constant">null</span> &amp;& <span class="org-keyword">typeof</span> val === <span class="org-string">'object'</span>
<span class="linenr">  219: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">onRE</span> = <span class=
"org-string">/^on[^a-z]/</span>
<span class="linenr">  220: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isOn</span> = (key) =&gt; onRE.test(key)
<span class="linenr">  221: </span>
<span class="linenr">  222: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isPromise</span> = (val) =&gt; {
<span class="linenr">  223: </span>  <span class=
"org-keyword">return</span> isObject(val) &amp;& isFunction(val.then) &amp;& isFunction(val.<span class="org-keyword">catch</span>)
<span class="linenr">  224: </span>}
<span class="linenr">  225: </span>
<span class="linenr">  226: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">objectToString</span> = Object.<span class=
"org-constant">prototype</span>.toString
<span class="linenr">  227: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">toTypeString</span> = (value) =&gt; objectToString.call(value)
<span class="linenr">  228: </span>
<span class="linenr">  229: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">toRawType</span> = (value) =&gt; {
<span class="linenr">  230: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">extract "RawType" from strings like "[object RawType]"</span>
<span class="linenr">  231: </span>  <span class=
"org-keyword">return</span> toTypeString(value).slice(<span class=
"org-highlight-numbers-number">8</span>, -<span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr">  232: </span>}
<span class="linenr">  233: </span>
<span class="linenr">  234: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isText</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">  235: </span>  <span class=
"org-keyword">return</span> node.type === NodeTypes.INTERPOLATION || node.type === NodeTypes.TEXT
<span class="linenr">  236: </span>}
<span class="linenr">  237: </span>
<span class="linenr">  238: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isPlainObject</span> = (val) =&gt; toTypeString(val) === <span class="org-string">'[object Object]'</span>
<span class="linenr">  239: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isIntegerKey</span> = (key) =&gt;
<span class="linenr">  240: </span>  isString(key) &amp;&
<span class="linenr">  241: </span>  key !== <span class=
"org-string">'NaN'</span> &amp;&
<span class="linenr">  242: </span>  key[<span class=
"org-highlight-numbers-number">0</span>] !== <span class=
"org-string">'-'</span> &amp;&
<span class="linenr">  243: </span>  <span class=
"org-string">''</span> + parseInt(key, <span class=
"org-highlight-numbers-number">10</span>) === key
<span class="linenr">  244: </span>
<span class="linenr">  245: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isReservedProp</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr">  246: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the leading comma is intentional so empty string "" is also included</span>
<span class="linenr">  247: </span>  <span class=
"org-string">',key,ref,ref_for,ref_key,'</span> +
<span class="linenr">  248: </span>    <span class=
"org-string">'onVnodeBeforeMount,onVnodeMounted,'</span> +
<span class="linenr">  249: </span>    <span class=
"org-string">'onVnodeBeforeUpdate,onVnodeUpdated,'</span> +
<span class="linenr">  250: </span>    <span class=
"org-string">'onVnodeBeforeUnmount,onVnodeUnmounted'</span>
<span class="linenr">  251: </span>)
<span class="linenr">  252: </span>
<span class="linenr">  253: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">GLOBALS_WHITE_LISTED</span> =
<span class="linenr">  254: </span>  <span class=
"org-string">'Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,'</span> +
<span class="linenr">  255: </span>  <span class=
"org-string">'decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,'</span> +
<span class="linenr">  256: </span>  <span class=
"org-string">'Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt'</span>
<span class="linenr">  257: </span>
<span class="linenr">  258: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isGloballyWhitelisted</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(GLOBALS_WHITE_LISTED)
<span class="linenr">  259: </span>
<span class="linenr">  260: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">nonIdentifierRE</span> = <span class=
"org-string">/^\d|[^\$\w]/</span>
<span class="linenr">  261: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSimpleIdentifier</span> = (name) =&gt; !nonIdentifierRE.test(name)
<span class="linenr">  262: </span>
<span class="linenr">  263: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isBuiltInDirective</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr">  264: </span>  <span class=
"org-string">'bind,cloak,else-if,else,for,html,if,model,on,once,pre,show,slot,text,memo'</span>
<span class="linenr">  265: </span>)
<span class="linenr">  266: </span>
<span class="linenr">  267: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getCursor</span>(<span class=
"org-variable-name">context</span>) {
<span class="linenr">  268: </span>  <span class=
"org-keyword">const</span> { column, line, offset } = context
<span class="linenr">  269: </span>  <span class=
"org-keyword">return</span> { column, line, offset }
<span class="linenr">  270: </span>}
<span class="linenr">  271: </span>
<span class="linenr">  272: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getSelection</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">start</span>, <span class=
"org-variable-name">end</span>) {
<span class=
"linenr">  273: </span>  end = end || getCursor(context)
<span class="linenr">  274: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr">  275: </span>    start,
<span class="linenr">  276: </span>    end,
<span class=
"linenr">  277: </span>    source: context.originalSource.slice(start.offset, end.offset)
<span class="linenr">  278: </span>  }
<span class="linenr">  279: </span>}
<span class="linenr">  280: </span>
<span class="linenr">  281: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">last</span>(<span class=
"org-variable-name">xs</span>) {
<span class="linenr">  282: </span>  <span class=
"org-keyword">return</span> xs[xs.length - <span class=
"org-highlight-numbers-number">1</span>]
<span class="linenr">  283: </span>}
<span class="linenr">  284: </span>
<span class="linenr">  285: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">startsWith</span>(<span class=
"org-variable-name">source</span>, <span class=
"org-variable-name">searchString</span>) {
<span class="linenr">  286: </span>  <span class=
"org-keyword">return</span> source.startsWith(searchString)
<span class="linenr">  287: </span>}
<span class="linenr">  288: </span>
<span class="linenr">  289: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">advancePositionWithMutation</span>(<span class=
"org-variable-name">pos</span>, <span class=
"org-variable-name">source</span>, <span class=
"org-variable-name">numberOfCharacters</span> = <span class=
"org-variable-name">source</span>.<span class=
"org-variable-name">length</span>) {
<span class="linenr">  290: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">linesCount</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">  291: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">lastNewLinePos</span> = -<span class=
"org-highlight-numbers-number">1</span>
<span class="linenr">  292: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; numberOfCharacters; i++) {
<span class="linenr">  293: </span>    <span class=
"org-keyword">if</span> (source.charCodeAt(i) === <span class=
"org-highlight-numbers-number">10</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">newline char code</span><span class=
"org-comment-delimiter"> */</span>) {
<span class="linenr">  294: </span>      linesCount++
<span class="linenr">  295: </span>      lastNewLinePos = i
<span class="linenr">  296: </span>    }
<span class="linenr">  297: </span>  }
<span class="linenr">  298: </span>
<span class=
"linenr">  299: </span>  pos.offset += numberOfCharacters
<span class="linenr">  300: </span>  pos.line += linesCount
<span class="linenr">  301: </span>  pos.column =
<span class=
"linenr">  302: </span>    lastNewLinePos === -<span class=
"org-highlight-numbers-number">1</span>
<span class=
"linenr">  303: </span>      ? pos.column + numberOfCharacters
<span class=
"linenr">  304: </span>      : numberOfCharacters - lastNewLinePos
<span class="linenr">  305: </span>
<span class="linenr">  306: </span>  <span class=
"org-keyword">return</span> pos
<span class="linenr">  307: </span>}
<span class="linenr">  308: </span>
<span class="linenr">  309: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">advancePositionWithClone</span>(
<span class="linenr">  310: </span>  <span class=
"org-variable-name">pos</span>,
<span class="linenr">  311: </span>  <span class=
"org-variable-name">source</span>,
<span class=
"linenr">  312: </span>  numberOfCharacters = source.length
<span class="linenr">  313: </span>) {
<span class="linenr">  314: </span>  <span class=
"org-keyword">return</span> advancePositionWithMutation(
<span class="linenr">  315: </span>    extend({}, pos),
<span class="linenr">  316: </span>    source,
<span class="linenr">  317: </span>    numberOfCharacters
<span class="linenr">  318: </span>  )
<span class="linenr">  319: </span>}
<span class="linenr">  320: </span>
<span class="linenr">  321: </span>
<span class="linenr">  322: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">advanceBy</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">numberOfCharacters</span>) {
<span class="linenr">  323: </span>  <span class=
"org-keyword">const</span> { source } = context
<span class=
"linenr">  324: </span>  advancePositionWithMutation(context, source, numberOfCharacters)
<span class=
"linenr">  325: </span>  context.source = source.slice(numberOfCharacters)
<span class="linenr">  326: </span>}
<span class="linenr">  327: </span>
<span class="linenr">  328: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">advanceSpaces</span>(<span class=
"org-variable-name">context</span>) {
<span class="linenr">  329: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">match</span> = <span class=
"org-string">/^[\t\r\n\f ]+/</span>.exec(context.source)
<span class="linenr">  330: </span>  <span class=
"org-keyword">if</span> (match) {
<span class=
"linenr">  331: </span>    advanceBy(context, match[<span class=
"org-highlight-numbers-number">0</span>].length)
<span class="linenr">  332: </span>  }
<span class="linenr">  333: </span>}
<span class="linenr">  334: </span>
<span class="linenr">  335: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getNewPosition</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">start</span>, <span class=
"org-variable-name">numberOfCharacters</span>) {
<span class="linenr">  336: </span>  <span class=
"org-keyword">return</span> advancePositionWithClone(
<span class="linenr">  337: </span>    start,
<span class=
"linenr">  338: </span>    context.originalSource.slice(start.offset, numberOfCharacters),
<span class="linenr">  339: </span>    numberOfCharacters
<span class="linenr">  340: </span>  )
<span class="linenr">  341: </span>}
<span class="linenr">  342: </span>
<span class="linenr">  343: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">emitError</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">code</span>, <span class=
"org-variable-name">offset</span>, <span class=
"org-variable-name">loc</span> = <span class=
"org-variable-name">getCursor</span>(<span class=
"org-variable-name">context</span>)) {
<span class="linenr">  344: </span>  <span class=
"org-keyword">if</span> (offset) {
<span class="linenr">  345: </span>    loc.offset += offset
<span class="linenr">  346: </span>    loc.column += offset
<span class="linenr">  347: </span>  }
<span class="linenr">  348: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">ignore...</span>
<span class="linenr">  349: </span>}
<span class="linenr">  350: </span>
<span class="linenr">  351: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isEnd</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">mode</span>, <span class=
"org-variable-name">ancestors</span>) {
<span class="linenr">  352: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">s</span> = context.source
<span class="linenr">  353: </span>
<span class="linenr">  354: </span>  <span class=
"org-keyword">switch</span> (mode) {
<span class="linenr">  355: </span>    <span class=
"org-keyword">case</span> TextModes.DATA:
<span class="linenr">  356: </span>      <span class=
"org-keyword">if</span> (startsWith(s, <span class=
"org-string">'&lt;/'</span>)) {
<span class="linenr">  357: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO:</span></span></span><span class=
"org-comment"> probably bad performance</span>
<span class="linenr">  358: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = ancestors.length - <span class=
"org-highlight-numbers-number">1</span>; i &gt;= <span class=
"org-highlight-numbers-number">0</span>; --i) {
<span class="linenr">  359: </span>          <span class=
"org-keyword">if</span> (startsWithEndTagOpen(s, ancestors[i].tag)) {
<span class="linenr">  360: </span>            <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">  361: </span>          }
<span class="linenr">  362: </span>        }
<span class="linenr">  363: </span>      }
<span class="linenr">  364: </span>      <span class=
"org-keyword">break</span>
<span class="linenr">  365: </span>
<span class="linenr">  366: </span>    <span class=
"org-keyword">case</span> TextModes.RCDATA:
<span class="linenr">  367: </span>    <span class=
"org-keyword">case</span> TextModes.RAWTEXT: {
<span class="linenr">  368: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parent</span> = last(ancestors)
<span class="linenr">  369: </span>      <span class=
"org-keyword">if</span> (parent &amp;& startsWithEndTagOpen(s, parent.tag)) {
<span class="linenr">  370: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">  371: </span>      }
<span class="linenr">  372: </span>      <span class=
"org-keyword">break</span>
<span class="linenr">  373: </span>    }
<span class="linenr">  374: </span>
<span class="linenr">  375: </span>    <span class=
"org-keyword">case</span> TextModes.CDATA:
<span class="linenr">  376: </span>      <span class=
"org-keyword">if</span> (startsWith(s, <span class=
"org-string">']]&gt;'</span>)) {
<span class="linenr">  377: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">  378: </span>      }
<span class="linenr">  379: </span>      <span class=
"org-keyword">break</span>
<span class="linenr">  380: </span>  }
<span class="linenr">  381: </span>
<span class="linenr">  382: </span>  <span class=
"org-keyword">return</span> !s
<span class="linenr">  383: </span>}
<span class="linenr">  384: </span>
<span class="linenr">  385: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">startsWithEndTagOpen</span>(<span class=
"org-variable-name">source</span>, <span class=
"org-variable-name">tag</span>) {
<span class="linenr">  386: </span>  <span class=
"org-keyword">return</span> (
<span class=
"linenr">  387: </span>    startsWith(source, <span class=
"org-string">'&lt;/'</span>) &amp;&
<span class="linenr">  388: </span>    source.slice(<span class=
"org-highlight-numbers-number">2</span>, <span class=
"org-highlight-numbers-number">2</span> + tag.length).toLowerCase() === tag.toLowerCase() &amp;&
<span class=
"linenr">  389: </span>    /[\t\r\n\f /&gt;]/.test(source[<span class="org-highlight-numbers-number">2</span> + tag.length] || <span class="org-string">'&gt;'</span>)
<span class="linenr">  390: </span>  )
<span class="linenr">  391: </span>}
<span class="linenr">  392: </span>
<span class="linenr">  393: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">cacheStringFunction</span> = (fn) =&gt; {
<span class="linenr">  394: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">cache</span> = Object.create(<span class=
"org-constant">null</span>)
<span class="linenr">  395: </span>  <span class=
"org-keyword">return</span> ((str) =&gt; {
<span class="linenr">  396: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hit</span> = cache[str]
<span class="linenr">  397: </span>    <span class=
"org-keyword">return</span> hit || (cache[str] = fn(str))
<span class="linenr">  398: </span>  })
<span class="linenr">  399: </span>}
<span class="linenr">  400: </span>
<span class="linenr">  401: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">camelizeRE</span> = <span class=
"org-string">/-(\w)/</span>g
<span class="linenr">  402: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">camelize</span> = cacheStringFunction((str) =&gt; {
<span class="linenr">  403: </span>  <span class=
"org-keyword">return</span> str.replace(camelizeRE, (_, c) =&gt; (c ? c.toUpperCase() : <span class="org-string">''</span>))
<span class="linenr">  404: </span>})
<span class="linenr">  405: </span>
<span class="linenr">  406: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">hyphenateRE</span> = <span class=
"org-string">/\B([A-Z])/</span>g
<span class="linenr">  407: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">hyphenate</span> = cacheStringFunction((str) =&gt;
<span class=
"linenr">  408: </span>  str.replace(hyphenateRE, <span class=
"org-string">'-$1'</span>).toLowerCase()
<span class="linenr">  409: </span>)
<span class="linenr">  410: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">capitalize</span> = cacheStringFunction(
<span class=
"linenr">  411: </span>  (str) =&gt; str.charAt(<span class=
"org-highlight-numbers-number">0</span>).toUpperCase() + str.slice(<span class="org-highlight-numbers-number">1</span>)
<span class="linenr">  412: </span>)
<span class="linenr">  413: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">toHandlerKey</span> = cacheStringFunction((str) =&gt; str ? <span class="org-string">`on${capitalize(str)}`</span> : <span class="org-string">``</span>)
<span class="linenr">  414: </span>
<span class="linenr">  415: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isBuiltInType</span> = (tag, expected) =&gt; tag === expected || tag === hyphenate(expected)
<span class="linenr">  416: </span>
<span class="linenr">  417: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isCoreComponent</span>(<span class=
"org-variable-name">tag</span>) {
<span class="linenr">  418: </span>  <span class=
"org-keyword">if</span> (isBuiltInType(tag, <span class=
"org-string">'Teleport'</span>)) {
<span class="linenr">  419: </span>    <span class=
"org-keyword">return</span> TELEPORT
<span class="linenr">  420: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isBuiltInType(tag, <span class=
"org-string">'Suspense'</span>)) {
<span class="linenr">  421: </span>    <span class=
"org-keyword">return</span> SUSPENSE
<span class="linenr">  422: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isBuiltInType(tag, <span class=
"org-string">'KeepAlive'</span>)) {
<span class="linenr">  423: </span>    <span class=
"org-keyword">return</span> KEEP_ALIVE
<span class="linenr">  424: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isBuiltInType(tag, <span class=
"org-string">'BaseTransition'</span>)) {
<span class="linenr">  425: </span>    <span class=
"org-keyword">return</span> BASE_TRANSITION
<span class="linenr">  426: </span>  }
<span class="linenr">  427: </span>}
<span class="linenr">  428: </span>
<span class="linenr">  429: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSpecialTemplateDirective</span> = <span class="org-comment-delimiter">/*</span><span class="org-comment">#__PURE__</span><span class="org-comment-delimiter">*/</span> makeMap(
<span class="linenr">  430: </span>  <span class=
"org-string">`if,else,else-if,for,slot`</span>
<span class="linenr">  431: </span>)
<span class="linenr">  432: </span>
<span class="linenr">  433: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isComponent</span>(<span class=
"org-variable-name">tag</span>, <span class=
"org-variable-name">props</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr">  434: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">options</span> = context.options
<span class="linenr">  435: </span>  <span class=
"org-keyword">if</span> (options.isCustomElement(tag)) {
<span class="linenr">  436: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">  437: </span>  }
<span class="linenr">  438: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr">  439: </span>    tag === <span class=
"org-string">'component'</span> ||
<span class="linenr">  440: </span>    /^[A-Z]/.test(tag) ||
<span class="linenr">  441: </span>    isCoreComponent(tag) ||
<span class=
"linenr">  442: </span>    (options.isBuiltInComponent &amp;& options.isBuiltInComponent(tag)) ||
<span class=
"linenr">  443: </span>    (options.isNativeTag &amp;& !options.isNativeTag(tag))
<span class="linenr">  444: </span>  ) {
<span class="linenr">  445: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">  446: </span>  }
<span class="linenr">  447: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">at this point the tag should be a native tag, but check for potential "is"</span>
<span class="linenr">  448: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">casting</span>
<span class="linenr">  449: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; props.length; i++) {
<span class="linenr">  450: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = props[i]
<span class="linenr">  451: </span>    <span class=
"org-keyword">if</span> (p.type === NodeTypes.ATTRIBUTE) {
<span class="linenr">  452: </span>      <span class=
"org-keyword">if</span> (p.name === <span class=
"org-string">'is'</span> &amp;& p.value) {
<span class="linenr">  453: </span>        <span class=
"org-keyword">if</span> (p.value.content.startsWith(<span class=
"org-string">'vue:'</span>)) {
<span class="linenr">  454: </span>          <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">  455: </span>        }
<span class="linenr">  456: </span>      }
<span class="linenr">  457: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">  458: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">directive</span>
<span class="linenr">  459: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-is (</span><span class="org-comment"><span class=
"org-bold"><span class=
"org-warning">TODO</span></span></span><span class=
"org-comment"> Deprecate)</span>
<span class="linenr">  460: </span>      <span class=
"org-keyword">if</span> (p.name === <span class=
"org-string">'is'</span>) {
<span class="linenr">  461: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">  462: </span>      }
<span class="linenr">  463: </span>    }
<span class="linenr">  464: </span>  }
<span class="linenr">  465: </span>}
<span class="linenr">  466: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">pushNode</span>(<span class=
"org-variable-name">nodes</span>, <span class=
"org-variable-name">node</span>) {
<span class="linenr">  467: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.TEXT) {
<span class="linenr">  468: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prev</span> = last(nodes)
<span class="linenr">  469: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Merge if both this and the previous node are text and those are</span>
<span class="linenr">  470: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">consecutive. This happens for cases like "a &lt; b".</span>
<span class="linenr">  471: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr">  472: </span>      prev &amp;&
<span class=
"linenr">  473: </span>      prev.type === NodeTypes.TEXT &amp;&
<span class=
"linenr">  474: </span>      prev.loc.end.offset === node.loc.start.offset
<span class="linenr">  475: </span>    ) {
<span class=
"linenr">  476: </span>      prev.content += node.content
<span class=
"linenr">  477: </span>      prev.loc.end = node.loc.end
<span class=
"linenr">  478: </span>      prev.loc.source += node.loc.source
<span class="linenr">  479: </span>      <span class=
"org-keyword">return</span>
<span class="linenr">  480: </span>    }
<span class="linenr">  481: </span>  }
<span class="linenr">  482: </span>
<span class="linenr">  483: </span>  nodes.push(node)
<span class="linenr">  484: </span>}
<span class="linenr">  485: </span>
<span class="linenr">  486: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getVNodeHelper</span>(<span class=
"org-variable-name">ssr</span>, <span class=
"org-variable-name">isComponent</span>) {
<span class="linenr">  487: </span>  <span class=
"org-keyword">return</span> ssr || isComponent ? CREATE_VNODE : CREATE_ELEMENT_VNODE
<span class="linenr">  488: </span>}
<span class="linenr">  489: </span>
<span class="linenr">  490: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getVNodeBlockHelper</span>(<span class=
"org-variable-name">ssr</span>, <span class=
"org-variable-name">isComponent</span>) {
<span class="linenr">  491: </span>  <span class=
"org-keyword">return</span> ssr || isComponent ? CREATE_BLOCK : CREATE_ELEMENT_BLOCK
<span class="linenr">  492: </span>}
<span class="linenr">  493: </span>
<span class="linenr">  494: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isSingleElementRoot</span>(<span class=
"org-variable-name">root</span>, <span class=
"org-variable-name">child</span>) {
<span class="linenr">  495: </span>  <span class=
"org-keyword">const</span> { children } = root
<span class="linenr">  496: </span>  <span class=
"org-keyword">return</span> (
<span class=
"linenr">  497: </span>    children.length === <span class=
"org-highlight-numbers-number">1</span> &amp;&
<span class=
"linenr">  498: </span>    child.type === NodeTypes.ELEMENT &amp;&
<span class="linenr">  499: </span>    !isSlotOutlet(child)
<span class="linenr">  500: </span>  )
<span class="linenr">  501: </span>}
<span class="linenr">  502: </span>
<span class="linenr">  503: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isSlotOutlet</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">  504: </span>  <span class=
"org-keyword">return</span> node.type === NodeTypes.ELEMENT &amp;& node.tagType === ElementTypes.SLOT
<span class="linenr">  505: </span>}
<span class="linenr">  506: </span>
<span class="linenr">  507: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">findDir</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">name</span>, <span class=
"org-variable-name">allowEmpty</span> = <span class=
"org-constant">false</span>) {
<span class="linenr">  508: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr">  509: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = node.props[i]
<span class="linenr">  510: </span>    <span class=
"org-keyword">if</span> (
<span class=
"linenr">  511: </span>      p.type === NodeTypes.DIRECTIVE &amp;&
<span class=
"linenr">  512: </span>      (allowEmpty || p.exp) &amp;&
<span class=
"linenr">  513: </span>      (isString(name) ? p.name === name : name.test(p.name))
<span class="linenr">  514: </span>    ) {
<span class="linenr">  515: </span>      <span class=
"org-keyword">return</span> p
<span class="linenr">  516: </span>    }
<span class="linenr">  517: </span>  }
<span class="linenr">  518: </span>}
<span class="linenr">  519: </span>
<span class="linenr">  520: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">findProp</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">name</span>, <span class=
"org-variable-name">dynamicOnly</span> = <span class=
"org-constant">false</span>, <span class=
"org-variable-name">allowEmpty</span> = <span class=
"org-constant">false</span>) {
<span class="linenr">  521: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr">  522: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = node.props[i]
<span class="linenr">  523: </span>    <span class=
"org-keyword">if</span> (p.type === NodeTypes.ATTRIBUTE) {
<span class="linenr">  524: </span>      <span class=
"org-keyword">if</span> (dynamicOnly) <span class=
"org-keyword">continue</span>
<span class="linenr">  525: </span>      <span class=
"org-keyword">if</span> (p.name === name &amp;& (p.value || allowEmpty)) {
<span class="linenr">  526: </span>        <span class=
"org-keyword">return</span> p
<span class="linenr">  527: </span>      }
<span class="linenr">  528: </span>    } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class="linenr">  529: </span>      p.name === <span class=
"org-string">'bind'</span> &amp;&
<span class=
"linenr">  530: </span>      (p.exp || allowEmpty) &amp;&
<span class="linenr">  531: </span>      isStaticArgOf(p.arg, name)
<span class="linenr">  532: </span>    ) {
<span class="linenr">  533: </span>      <span class=
"org-keyword">return</span> p
<span class="linenr">  534: </span>    }
<span class="linenr">  535: </span>  }
<span class="linenr">  536: </span>}
<span class="linenr">  537: </span>
<span class="linenr">  538: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isStaticExp</span> = (p) =&gt; p.type === NodeTypes.SIMPLE_EXPRESSION &amp;& p.isStatic
<span class="linenr">  539: </span>
<span class="linenr">  540: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isStaticArgOf</span>(<span class=
"org-variable-name">arg</span>, <span class=
"org-variable-name">name</span>) {
<span class="linenr">  541: </span>  <span class=
"org-keyword">return</span> !!(arg &amp;& isStaticExp(arg) &amp;& arg.content === name)
<span class="linenr">  542: </span>}
<span class="linenr">  543: </span>
<span class="linenr">  544: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isVSlot</span>(<span class=
"org-variable-name">p</span>) {
<span class="linenr">  545: </span>  <span class=
"org-keyword">return</span> p.type === NodeTypes.DIRECTIVE &amp;& p.name === <span class="org-string">'slot'</span>
<span class="linenr">  546: </span>}
<span class="linenr">  547: </span>
<span class="linenr">  548: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getMemoedVNodeCall</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">  549: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.JS_CALL_EXPRESSION &amp;& node.callee === WITH_MEMO) {
<span class="linenr">  550: </span>    <span class=
"org-keyword">return</span> node.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">1</span>].returns
<span class="linenr">  551: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">  552: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr">  553: </span>  }
<span class="linenr">  554: </span>}
<span class="linenr">  555: </span>
<span class="linenr">  556: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getInnerRange</span>(<span class=
"org-variable-name">loc</span>, <span class=
"org-variable-name">offset</span>, <span class=
"org-variable-name">length</span>) {
<span class="linenr">  557: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = loc.source.slice(offset, offset + length)
<span class="linenr">  558: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">newLoc</span> = {
<span class="linenr">  559: </span>    source,
<span class=
"linenr">  560: </span>    start: advancePositionWithClone(loc.start, loc.source, offset),
<span class="linenr">  561: </span>    end: loc.end
<span class="linenr">  562: </span>  }
<span class="linenr">  563: </span>
<span class="linenr">  564: </span>  <span class=
"org-keyword">if</span> (length != <span class=
"org-constant">null</span>) {
<span class=
"linenr">  565: </span>    newLoc.end = advancePositionWithClone(
<span class="linenr">  566: </span>      loc.start,
<span class="linenr">  567: </span>      loc.source,
<span class="linenr">  568: </span>      offset + length
<span class="linenr">  569: </span>    )
<span class="linenr">  570: </span>  }
<span class="linenr">  571: </span>
<span class="linenr">  572: </span>  <span class=
"org-keyword">return</span> newLoc
<span class="linenr">  573: </span>}
<span class="linenr">  574: </span>
<span class="linenr">  575: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">toValidAssetId</span>(<span class=
"org-variable-name">name</span>, <span class=
"org-variable-name">type</span>) {
<span class="linenr">  576: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">see issue#4422, we need adding identifier on validAssetId if variable `name` has specific character</span>
<span class="linenr">  577: </span>  <span class=
"org-keyword">return</span> <span class=
"org-string">`_${type}_${name.replace(/[^\w]/g, (searchValue, replaceValue) =&gt; {</span>
<span class="linenr">  578: </span><span class=
"org-string">    return searchValue === '-' ? '_' : name.charCodeAt(replaceValue).toString()</span>
<span class="linenr">  579: </span><span class=
"org-string">  })}`</span>
<span class="linenr">  580: </span>}
<span class="linenr">  581: </span>
<span class="linenr">  582: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isTemplateNode</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">  583: </span>  <span class=
"org-keyword">return</span> (
<span class=
"linenr">  584: </span>    node.type === NodeTypes.ELEMENT &amp;& node.tagType === ElementTypes.TEMPLATE
<span class="linenr">  585: </span>  )
<span class="linenr">  586: </span>}
<span class="linenr">  587: </span>
<span class="linenr">  588: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">FRAGMENT</span> = Symbol(__DEV__ ? <span class=
"org-string">`Fragment`</span> : <span class=
"org-string">``</span>)
<span class="linenr">  589: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TELEPORT</span> = Symbol(__DEV__ ? <span class=
"org-string">`Teleport`</span> : <span class=
"org-string">``</span>)
<span class="linenr">  590: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">SUSPENSE</span> = Symbol(__DEV__ ? <span class=
"org-string">`Suspense`</span> : <span class=
"org-string">``</span>)
<span class="linenr">  591: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">KEEP_ALIVE</span> = Symbol(__DEV__ ? <span class="org-string">`KeepAlive`</span> : <span class="org-string">``</span>)
<span class="linenr">  592: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">BASE_TRANSITION</span> = Symbol(__DEV__ ? <span class="org-string">`BaseTransition`</span> : <span class="org-string">``</span>)
<span class="linenr">  593: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">OPEN_BLOCK</span> = Symbol(__DEV__ ? <span class="org-string">`openBlock`</span> : <span class="org-string">``</span>)
<span class="linenr">  594: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_BLOCK</span> = Symbol(__DEV__ ? <span class="org-string">`createBlock`</span> : <span class="org-string">``</span>)
<span class="linenr">  595: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_ELEMENT_BLOCK</span> = Symbol(__DEV__ ? <span class="org-string">`createElementBlock`</span> : <span class="org-string">``</span>)
<span class="linenr">  596: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_VNODE</span> = Symbol(__DEV__ ? <span class="org-string">`createVNode`</span> : <span class="org-string">``</span>)
<span class="linenr">  597: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_ELEMENT_VNODE</span> = Symbol(__DEV__ ? <span class="org-string">`createElementVNode`</span> : <span class="org-string">``</span>)
<span class="linenr">  598: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_COMMENT</span> = Symbol(__DEV__ ? <span class="org-string">`createCommentVNode`</span> : <span class="org-string">``</span>)
<span class="linenr">  599: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_TEXT</span> = Symbol(__DEV__ ? <span class="org-string">`createTextVNode`</span> : <span class="org-string">``</span>)
<span class="linenr">  600: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_STATIC</span> = Symbol(__DEV__ ? <span class="org-string">`createStaticVNode`</span> : <span class="org-string">``</span>)
<span class="linenr">  601: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">RESOLVE_COMPONENT</span> = Symbol(__DEV__ ? <span class="org-string">`resolveComponent`</span> : <span class="org-string">``</span>)
<span class="linenr">  602: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">RESOLVE_DYNAMIC_COMPONENT</span> = Symbol(
<span class="linenr">  603: </span>  __DEV__ ? <span class=
"org-string">`resolveDynamicComponent`</span> : <span class=
"org-string">``</span>
<span class="linenr">  604: </span>)
<span class="linenr">  605: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">RESOLVE_DIRECTIVE</span> = Symbol(__DEV__ ? <span class="org-string">`resolveDirective`</span> : <span class="org-string">``</span>)
<span class="linenr">  606: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">RESOLVE_FILTER</span> = Symbol(__DEV__ ? <span class="org-string">`resolveFilter`</span> : <span class="org-string">``</span>)
<span class="linenr">  607: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">WITH_DIRECTIVES</span> = Symbol(__DEV__ ? <span class="org-string">`withDirectives`</span> : <span class="org-string">``</span>)
<span class="linenr">  608: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">RENDER_LIST</span> = Symbol(__DEV__ ? <span class="org-string">`renderList`</span> : <span class="org-string">``</span>)
<span class="linenr">  609: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">RENDER_SLOT</span> = Symbol(__DEV__ ? <span class="org-string">`renderSlot`</span> : <span class="org-string">``</span>)
<span class="linenr">  610: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_SLOTS</span> = Symbol(__DEV__ ? <span class="org-string">`createSlots`</span> : <span class="org-string">``</span>)
<span class="linenr">  611: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TO_DISPLAY_STRING</span> = Symbol(__DEV__ ? <span class="org-string">`toDisplayString`</span> : <span class="org-string">``</span>)
<span class="linenr">  612: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">MERGE_PROPS</span> = Symbol(__DEV__ ? <span class="org-string">`mergeProps`</span> : <span class="org-string">``</span>)
<span class="linenr">  613: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">NORMALIZE_CLASS</span> = Symbol(__DEV__ ? <span class="org-string">`normalizeClass`</span> : <span class="org-string">``</span>)
<span class="linenr">  614: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">NORMALIZE_STYLE</span> = Symbol(__DEV__ ? <span class="org-string">`normalizeStyle`</span> : <span class="org-string">``</span>)
<span class="linenr">  615: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">NORMALIZE_PROPS</span> = Symbol(__DEV__ ? <span class="org-string">`normalizeProps`</span> : <span class="org-string">``</span>)
<span class="linenr">  616: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">GUARD_REACTIVE_PROPS</span> = Symbol(__DEV__ ? <span class="org-string">`guardReactiveProps`</span> : <span class="org-string">``</span>)
<span class="linenr">  617: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TO_HANDLERS</span> = Symbol(__DEV__ ? <span class="org-string">`toHandlers`</span> : <span class="org-string">``</span>)
<span class="linenr">  618: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CAMELIZE</span> = Symbol(__DEV__ ? <span class=
"org-string">`camelize`</span> : <span class=
"org-string">``</span>)
<span class="linenr">  619: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CAPITALIZE</span> = Symbol(__DEV__ ? <span class="org-string">`capitalize`</span> : <span class="org-string">``</span>)
<span class="linenr">  620: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TO_HANDLER_KEY</span> = Symbol(__DEV__ ? <span class="org-string">`toHandlerKey`</span> : <span class="org-string">``</span>)
<span class="linenr">  621: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">SET_BLOCK_TRACKING</span> = Symbol(__DEV__ ? <span class="org-string">`setBlockTracking`</span> : <span class="org-string">``</span>)
<span class="linenr">  622: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">PUSH_SCOPE_ID</span> = Symbol(__DEV__ ? <span class="org-string">`pushScopeId`</span> : <span class="org-string">``</span>)
<span class="linenr">  623: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">POP_SCOPE_ID</span> = Symbol(__DEV__ ? <span class="org-string">`popScopeId`</span> : <span class="org-string">``</span>)
<span class="linenr">  624: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">WITH_CTX</span> = Symbol(__DEV__ ? <span class=
"org-string">`withCtx`</span> : <span class="org-string">``</span>)
<span class="linenr">  625: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">UNREF</span> = Symbol(__DEV__ ? <span class=
"org-string">`unref`</span> : <span class="org-string">``</span>)
<span class="linenr">  626: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">IS_REF</span> = Symbol(__DEV__ ? <span class=
"org-string">`isRef`</span> : <span class="org-string">``</span>)
<span class="linenr">  627: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">WITH_MEMO</span> = Symbol(__DEV__ ? <span class="org-string">`withMemo`</span> : <span class="org-string">``</span>)
<span class="linenr">  628: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">IS_MEMO_SAME</span> = Symbol(__DEV__ ? <span class="org-string">`isMemoSame`</span> : <span class="org-string">``</span>)
<span class="linenr">  629: </span>
<span class="linenr">  630: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Name mapping for runtime helpers that need to be imported from 'vue' in</span>
<span class="linenr">  631: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">generated code. Make sure these are correctly exported in the runtime!</span>
<span class="linenr">  632: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Using `any` here because TS doesn't allow symbols as index type.</span>
<span class="linenr">  633: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">helperNameMap</span> = {
<span class="linenr">  634: </span>  [FRAGMENT]: <span class=
"org-string">`Fragment`</span>,
<span class="linenr">  635: </span>  [TELEPORT]: <span class=
"org-string">`Teleport`</span>,
<span class="linenr">  636: </span>  [SUSPENSE]: <span class=
"org-string">`Suspense`</span>,
<span class="linenr">  637: </span>  [KEEP_ALIVE]: <span class=
"org-string">`KeepAlive`</span>,
<span class=
"linenr">  638: </span>  [BASE_TRANSITION]: <span class="org-string">`BaseTransition`</span>,
<span class="linenr">  639: </span>  [OPEN_BLOCK]: <span class=
"org-string">`openBlock`</span>,
<span class="linenr">  640: </span>  [CREATE_BLOCK]: <span class=
"org-string">`createBlock`</span>,
<span class=
"linenr">  641: </span>  [CREATE_ELEMENT_BLOCK]: <span class=
"org-string">`createElementBlock`</span>,
<span class="linenr">  642: </span>  [CREATE_VNODE]: <span class=
"org-string">`createVNode`</span>,
<span class=
"linenr">  643: </span>  [CREATE_ELEMENT_VNODE]: <span class=
"org-string">`createElementVNode`</span>,
<span class="linenr">  644: </span>  [CREATE_COMMENT]: <span class=
"org-string">`createCommentVNode`</span>,
<span class="linenr">  645: </span>  [CREATE_TEXT]: <span class=
"org-string">`createTextVNode`</span>,
<span class="linenr">  646: </span>  [CREATE_STATIC]: <span class=
"org-string">`createStaticVNode`</span>,
<span class=
"linenr">  647: </span>  [RESOLVE_COMPONENT]: <span class=
"org-string">`resolveComponent`</span>,
<span class=
"linenr">  648: </span>  [RESOLVE_DYNAMIC_COMPONENT]: <span class=
"org-string">`resolveDynamicComponent`</span>,
<span class=
"linenr">  649: </span>  [RESOLVE_DIRECTIVE]: <span class=
"org-string">`resolveDirective`</span>,
<span class="linenr">  650: </span>  [RESOLVE_FILTER]: <span class=
"org-string">`resolveFilter`</span>,
<span class=
"linenr">  651: </span>  [WITH_DIRECTIVES]: <span class="org-string">`withDirectives`</span>,
<span class="linenr">  652: </span>  [RENDER_LIST]: <span class=
"org-string">`renderList`</span>,
<span class="linenr">  653: </span>  [RENDER_SLOT]: <span class=
"org-string">`renderSlot`</span>,
<span class="linenr">  654: </span>  [CREATE_SLOTS]: <span class=
"org-string">`createSlots`</span>,
<span class=
"linenr">  655: </span>  [TO_DISPLAY_STRING]: <span class=
"org-string">`toDisplayString`</span>,
<span class="linenr">  656: </span>  [MERGE_PROPS]: <span class=
"org-string">`mergeProps`</span>,
<span class=
"linenr">  657: </span>  [NORMALIZE_CLASS]: <span class="org-string">`normalizeClass`</span>,
<span class=
"linenr">  658: </span>  [NORMALIZE_STYLE]: <span class="org-string">`normalizeStyle`</span>,
<span class=
"linenr">  659: </span>  [NORMALIZE_PROPS]: <span class="org-string">`normalizeProps`</span>,
<span class=
"linenr">  660: </span>  [GUARD_REACTIVE_PROPS]: <span class=
"org-string">`guardReactiveProps`</span>,
<span class="linenr">  661: </span>  [TO_HANDLERS]: <span class=
"org-string">`toHandlers`</span>,
<span class="linenr">  662: </span>  [CAMELIZE]: <span class=
"org-string">`camelize`</span>,
<span class="linenr">  663: </span>  [CAPITALIZE]: <span class=
"org-string">`capitalize`</span>,
<span class="linenr">  664: </span>  [TO_HANDLER_KEY]: <span class=
"org-string">`toHandlerKey`</span>,
<span class=
"linenr">  665: </span>  [SET_BLOCK_TRACKING]: <span class=
"org-string">`setBlockTracking`</span>,
<span class="linenr">  666: </span>  [PUSH_SCOPE_ID]: <span class=
"org-string">`pushScopeId`</span>,
<span class="linenr">  667: </span>  [POP_SCOPE_ID]: <span class=
"org-string">`popScopeId`</span>,
<span class="linenr">  668: </span>  [WITH_CTX]: <span class=
"org-string">`withCtx`</span>,
<span class="linenr">  669: </span>  [UNREF]: <span class=
"org-string">`unref`</span>,
<span class="linenr">  670: </span>  [IS_REF]: <span class=
"org-string">`isRef`</span>,
<span class="linenr">  671: </span>  [WITH_MEMO]: <span class=
"org-string">`withMemo`</span>,
<span class="linenr">  672: </span>  [IS_MEMO_SAME]: <span class=
"org-string">`isMemoSame`</span>
<span class="linenr">  673: </span>}
<span class="linenr">  674: </span>
<span class="linenr">  675: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">registerRuntimeHelpers</span>(<span class=
"org-variable-name">helpers</span>) {
<span class=
"linenr">  676: </span>  Object.getOwnPropertySymbols(helpers).forEach(s =&gt; {
<span class=
"linenr">  677: </span>    helperNameMap[s] = helpers[s]
<span class="linenr">  678: </span>  })
<span class="linenr">  679: </span>}
<span class="linenr">  680: </span>
<span class="linenr">  681: </span>
<span class="linenr">  682: </span><span class="org-doc">/**</span>
<span class="linenr">  683: </span><span class=
"org-doc"> * Patch flags are optimization hints generated by the compiler.</span>
<span class="linenr">  684: </span><span class=
"org-doc"> * when a block with dynamicChildren is encountered during diff, the algorithm</span>
<span class="linenr">  685: </span><span class=
"org-doc"> * enters "optimized mode". In this mode, we know that the vdom is produced by</span>
<span class="linenr">  686: </span><span class=
"org-doc"> * a render function generated by the compiler, so the algorithm only needs to</span>
<span class="linenr">  687: </span><span class=
"org-doc"> * handle updates explicitly marked by these patch flags.</span>
<span class="linenr">  688: </span><span class="org-doc"> *</span>
<span class="linenr">  689: </span><span class=
"org-doc"> * Patch flags can be combined using the | bitwise operator and can be checked</span>
<span class="linenr">  690: </span><span class=
"org-doc"> * using the & operator, e.g.</span>
<span class="linenr">  691: </span><span class="org-doc"> *</span>
<span class="linenr">  692: </span><span class=
"org-doc"> * ```js</span>
<span class="linenr">  693: </span><span class=
"org-doc"> * const flag = TEXT | CLASS</span>
<span class="linenr">  694: </span><span class=
"org-doc"> * if (flag & TEXT) { ... }</span>
<span class="linenr">  695: </span><span class=
"org-doc"> * ```</span>
<span class="linenr">  696: </span><span class="org-doc"> *</span>
<span class="linenr">  697: </span><span class=
"org-doc"> * Check the `patchElement` function in '../../runtime-core/src/renderer.ts' to see how the</span>
<span class="linenr">  698: </span><span class=
"org-doc"> * flags are handled during diff.</span>
<span class="linenr">  699: </span><span class="org-doc"> */</span>
<span class="linenr">  700: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">PatchFlags</span> = {
<span class="linenr">  701: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  702: </span><span class=
"org-doc">   * Indicates an element with dynamic textContent (children fast path)</span>
<span class="linenr">  703: </span><span class=
"org-doc">   */</span>
<span class="linenr">  704: </span>  TEXT: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr">  705: </span>
<span class="linenr">  706: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  707: </span><span class=
"org-doc">   * Indicates an element with dynamic class binding.</span>
<span class="linenr">  708: </span><span class=
"org-doc">   */</span>
<span class="linenr">  709: </span>  CLASS: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr">  710: </span>
<span class="linenr">  711: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  712: </span><span class=
"org-doc">   * Indicates an element with dynamic style</span>
<span class="linenr">  713: </span><span class=
"org-doc">   * The compiler pre-compiles static string styles into static objects</span>
<span class="linenr">  714: </span><span class=
"org-doc">   * + detects and hoists inline static objects</span>
<span class="linenr">  715: </span><span class=
"org-doc">   * e.g. `style="color: red"` and `:style="{ color: 'red' }"` both get hoisted</span>
<span class="linenr">  716: </span><span class=
"org-doc">   * as:</span>
<span class="linenr">  717: </span><span class=
"org-doc">   * ```js</span>
<span class="linenr">  718: </span><span class=
"org-doc">   * const style = { color: 'red' }</span>
<span class="linenr">  719: </span><span class=
"org-doc">   * render() { return e('div', { style }) }</span>
<span class="linenr">  720: </span><span class=
"org-doc">   * ```</span>
<span class="linenr">  721: </span><span class=
"org-doc">   */</span>
<span class="linenr">  722: </span>  STYLE: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">2</span>,
<span class="linenr">  723: </span>
<span class="linenr">  724: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  725: </span><span class=
"org-doc">   * Indicates an element that has non-class/style dynamic props.</span>
<span class="linenr">  726: </span><span class=
"org-doc">   * Can also be on a component that has any dynamic props (includes</span>
<span class="linenr">  727: </span><span class=
"org-doc">   * class/style). when this flag is present, the vnode also has a dynamicProps</span>
<span class="linenr">  728: </span><span class=
"org-doc">   * array that contains the keys of the props that may change so the runtime</span>
<span class="linenr">  729: </span><span class=
"org-doc">   * can diff them faster (without having to worry about removed props)</span>
<span class="linenr">  730: </span><span class=
"org-doc">   */</span>
<span class="linenr">  731: </span>  PROPS: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">3</span>,
<span class="linenr">  732: </span>
<span class="linenr">  733: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  734: </span><span class=
"org-doc">   * Indicates an element with props with dynamic keys. When keys change, a full</span>
<span class="linenr">  735: </span><span class=
"org-doc">   * diff is always needed to remove the old key. This flag is mutually</span>
<span class="linenr">  736: </span><span class=
"org-doc">   * exclusive with CLASS, STYLE and PROPS.</span>
<span class="linenr">  737: </span><span class=
"org-doc">   */</span>
<span class="linenr">  738: </span>  FULL_PROPS: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">4</span>,
<span class="linenr">  739: </span>
<span class="linenr">  740: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  741: </span><span class=
"org-doc">   * Indicates an element with event listeners (which need to be attached</span>
<span class="linenr">  742: </span><span class=
"org-doc">   * during hydration)</span>
<span class="linenr">  743: </span><span class=
"org-doc">   */</span>
<span class="linenr">  744: </span>  HYDRATE_EVENTS: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">5</span>,
<span class="linenr">  745: </span>
<span class="linenr">  746: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  747: </span><span class=
"org-doc">   * Indicates a fragment whose children order doesn't change.</span>
<span class="linenr">  748: </span><span class=
"org-doc">   */</span>
<span class="linenr">  749: </span>  STABLE_FRAGMENT: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">6</span>,
<span class="linenr">  750: </span>
<span class="linenr">  751: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  752: </span><span class=
"org-doc">   * Indicates a fragment with keyed or partially keyed children</span>
<span class="linenr">  753: </span><span class=
"org-doc">   */</span>
<span class="linenr">  754: </span>  KEYED_FRAGMENT: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">7</span>,
<span class="linenr">  755: </span>
<span class="linenr">  756: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  757: </span><span class=
"org-doc">   * Indicates a fragment with unkeyed children.</span>
<span class="linenr">  758: </span><span class=
"org-doc">   */</span>
<span class="linenr">  759: </span>  UNKEYED_FRAGMENT: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">8</span>,
<span class="linenr">  760: </span>
<span class="linenr">  761: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  762: </span><span class=
"org-doc">   * Indicates an element that only needs non-props patching, e.g. ref or</span>
<span class="linenr">  763: </span><span class=
"org-doc">   * directives (onVnodeXXX hooks). since every patched vnode checks for refs</span>
<span class="linenr">  764: </span><span class=
"org-doc">   * and onVnodeXXX hooks, it simply marks the vnode so that a parent block</span>
<span class="linenr">  765: </span><span class=
"org-doc">   * will track it.</span>
<span class="linenr">  766: </span><span class=
"org-doc">   */</span>
<span class="linenr">  767: </span>  NEED_PATCH: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">9</span>,
<span class="linenr">  768: </span>
<span class="linenr">  769: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  770: </span><span class=
"org-doc">   * Indicates a component with dynamic slots (e.g. slot that references a v-for</span>
<span class="linenr">  771: </span><span class=
"org-doc">   * iterated value, or dynamic slot names).</span>
<span class="linenr">  772: </span><span class=
"org-doc">   * Components with this flag are always force updated.</span>
<span class="linenr">  773: </span><span class=
"org-doc">   */</span>
<span class="linenr">  774: </span>  DYNAMIC_SLOTS: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">10</span>,
<span class="linenr">  775: </span>
<span class="linenr">  776: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  777: </span><span class=
"org-doc">   * Indicates a fragment that was created only because the user has placed</span>
<span class="linenr">  778: </span><span class=
"org-doc">   * comments at the root level of a template. This is a dev-only flag since</span>
<span class="linenr">  779: </span><span class=
"org-doc">   * comments are stripped in production.</span>
<span class="linenr">  780: </span><span class=
"org-doc">   */</span>
<span class=
"linenr">  781: </span>  DEV_ROOT_FRAGMENT: <span class="org-highlight-numbers-number">1</span> &lt;&lt; <span class="org-highlight-numbers-number">11</span>,
<span class="linenr">  782: </span>
<span class="linenr">  783: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  784: </span><span class=
"org-doc">   * SPECIAL FLAGS -------------------------------------------------------------</span>
<span class="linenr">  785: </span><span class=
"org-doc">   * Special flags are negative integers. They are never matched against using</span>
<span class="linenr">  786: </span><span class=
"org-doc">   * bitwise operators (bitwise matching should only happen in branches where</span>
<span class="linenr">  787: </span><span class=
"org-doc">   * patchFlag &gt; 0), and are mutually exclusive. When checking for a special</span>
<span class="linenr">  788: </span><span class=
"org-doc">   * flag, simply check patchFlag === FLAG.</span>
<span class="linenr">  789: </span><span class=
"org-doc">   */</span>
<span class="linenr">  790: </span>
<span class="linenr">  791: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  792: </span><span class=
"org-doc">   * Indicates a hoisted static vnode. This is a hint for hydration to skip</span>
<span class="linenr">  793: </span><span class=
"org-doc">   * the entire sub tree since static content never needs to be updated.</span>
<span class="linenr">  794: </span><span class=
"org-doc">   */</span>
<span class="linenr">  795: </span>  HOISTED: -<span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr">  796: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  797: </span><span class=
"org-doc">   * A special flag that indicates that the diffing algorithm should bail out</span>
<span class="linenr">  798: </span><span class=
"org-doc">   * of optimized mode. For example, on block fragments created by renderSlot()</span>
<span class="linenr">  799: </span><span class=
"org-doc">   * when encountering non-compiler generated slots (i.e. manually written</span>
<span class="linenr">  800: </span><span class=
"org-doc">   * render functions, which should always be fully diffed)</span>
<span class="linenr">  801: </span><span class=
"org-doc">   * OR manually cloneVNodes</span>
<span class="linenr">  802: </span><span class=
"org-doc">   */</span>
<span class="linenr">  803: </span>  BAIL: -<span class=
"org-highlight-numbers-number">2</span>
<span class="linenr">  804: </span>}
<span class="linenr">  805: </span>
<span class="linenr">  806: </span><span class="org-doc">/**</span>
<span class="linenr">  807: </span><span class=
"org-doc"> * dev only flag -&gt; name mapping</span>
<span class="linenr">  808: </span><span class="org-doc"> */</span>
<span class="linenr">  809: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">PatchFlagNames</span> = {
<span class=
"linenr">  810: </span>  [PatchFlags.TEXT]: <span class="org-string">`TEXT`</span>,
<span class=
"linenr">  811: </span>  [PatchFlags.CLASS]: <span class=
"org-string">`CLASS`</span>,
<span class=
"linenr">  812: </span>  [PatchFlags.STYLE]: <span class=
"org-string">`STYLE`</span>,
<span class=
"linenr">  813: </span>  [PatchFlags.PROPS]: <span class=
"org-string">`PROPS`</span>,
<span class=
"linenr">  814: </span>  [PatchFlags.FULL_PROPS]: <span class=
"org-string">`FULL_PROPS`</span>,
<span class=
"linenr">  815: </span>  [PatchFlags.HYDRATE_EVENTS]: <span class=
"org-string">`HYDRATE_EVENTS`</span>,
<span class=
"linenr">  816: </span>  [PatchFlags.STABLE_FRAGMENT]: <span class=
"org-string">`STABLE_FRAGMENT`</span>,
<span class=
"linenr">  817: </span>  [PatchFlags.KEYED_FRAGMENT]: <span class=
"org-string">`KEYED_FRAGMENT`</span>,
<span class=
"linenr">  818: </span>  [PatchFlags.UNKEYED_FRAGMENT]: <span class="org-string">`UNKEYED_FRAGMENT`</span>,
<span class=
"linenr">  819: </span>  [PatchFlags.NEED_PATCH]: <span class=
"org-string">`NEED_PATCH`</span>,
<span class=
"linenr">  820: </span>  [PatchFlags.DYNAMIC_SLOTS]: <span class=
"org-string">`DYNAMIC_SLOTS`</span>,
<span class=
"linenr">  821: </span>  [PatchFlags.DEV_ROOT_FRAGMENT]: <span class="org-string">`DEV_ROOT_FRAGMENT`</span>,
<span class=
"linenr">  822: </span>  [PatchFlags.HOISTED]: <span class=
"org-string">`HOISTED`</span>,
<span class=
"linenr">  823: </span>  [PatchFlags.BAIL]: <span class="org-string">`BAIL`</span>
<span class="linenr">  824: </span>}
<span class="linenr">  825: </span>
<span class="linenr">  826: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genFlagText</span>(<span class=
"org-variable-name">flag</span>, <span class=
"org-variable-name">names</span> = <span class=
"org-variable-name">PatchFlagNames</span>) {
<span class="linenr">  827: </span>  <span class=
"org-keyword">if</span> (isArray(flag)) {
<span class="linenr">  828: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">f</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">  829: </span>    flag.forEach(ff =&gt; {
<span class="linenr">  830: </span>      f |= ff
<span class="linenr">  831: </span>    })
<span class="linenr">  832: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`${f} /* ${flag.map(f =&gt; names[f]).join(', ')} */`</span>
<span class="linenr">  833: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">  834: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`${flag} /* ${names[flag]} */`</span>
<span class="linenr">  835: </span>  }
<span class="linenr">  836: </span>}
<span class="linenr">  837: </span>
<span class="linenr">  838: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">propsHelperSet</span> = <span class=
"org-keyword">new</span> <span class=
"org-type">Set</span>([NORMALIZE_PROPS, GUARD_REACTIVE_PROPS])
<span class="linenr">  839: </span>
<span class="linenr">  840: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getUnnormalizedProps</span>(<span class=
"org-variable-name">props</span>, <span class=
"org-variable-name">callPath</span> = []) {
<span class="linenr">  841: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr">  842: </span>    props &amp;&
<span class="linenr">  843: </span>    !isString(props) &amp;&
<span class=
"linenr">  844: </span>    props.type === NodeTypes.JS_CALL_EXPRESSION
<span class="linenr">  845: </span>  ) {
<span class="linenr">  846: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">callee</span> = props.callee
<span class="linenr">  847: </span>    <span class=
"org-keyword">if</span> (!isString(callee) &amp;& propsHelperSet.has(callee)) {
<span class="linenr">  848: </span>      <span class=
"org-keyword">return</span> getUnnormalizedProps(
<span class="linenr">  849: </span>        props.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>],
<span class="linenr">  850: </span>        callPath.concat(props)
<span class="linenr">  851: </span>      )
<span class="linenr">  852: </span>    }
<span class="linenr">  853: </span>  }
<span class="linenr">  854: </span>  <span class=
"org-keyword">return</span> [props, callPath]
<span class="linenr">  855: </span>}
<span class="linenr">  856: </span>
<span class="linenr">  857: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">injectProp</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">prop</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr">  858: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsWithInjection</span>
<span class="linenr">  859: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  860: </span><span class=
"org-doc">   * 1. mergeProps(...)</span>
<span class="linenr">  861: </span><span class=
"org-doc">   * 2. toHandlers(...)</span>
<span class="linenr">  862: </span><span class=
"org-doc">   * 3. normalizeProps(...)</span>
<span class="linenr">  863: </span><span class=
"org-doc">   * 4. normalizeProps(guardReactiveProps(...))</span>
<span class="linenr">  864: </span><span class=
"org-doc">   *</span>
<span class="linenr">  865: </span><span class=
"org-doc">   * we need to get the real props before normalization</span>
<span class="linenr">  866: </span><span class=
"org-doc">   */</span>
<span class="linenr">  867: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">props</span> =
<span class=
"linenr">  868: </span>    node.type === NodeTypes.VNODE_CALL ? node.props : node.<span class="org-constant">arguments</span>[<span class="org-highlight-numbers-number">2</span>]
<span class="linenr">  869: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">callPath</span> = []
<span class="linenr">  870: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">parentCall</span>
<span class="linenr">  871: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr">  872: </span>    props &amp;&
<span class="linenr">  873: </span>    !isString(props) &amp;&
<span class=
"linenr">  874: </span>    props.type === NodeTypes.JS_CALL_EXPRESSION
<span class="linenr">  875: </span>  ) {
<span class="linenr">  876: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ret</span> = getUnnormalizedProps(props)
<span class="linenr">  877: </span>    props = ret[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr">  878: </span>    callPath = ret[<span class=
"org-highlight-numbers-number">1</span>]
<span class=
"linenr">  879: </span>    parentCall = callPath[callPath.length - <span class="org-highlight-numbers-number">1</span>]
<span class="linenr">  880: </span>  }
<span class="linenr">  881: </span>
<span class="linenr">  882: </span>  <span class=
"org-keyword">if</span> (props == <span class=
"org-constant">null</span> || isString(props)) {
<span class=
"linenr">  883: </span>    propsWithInjection = createObjectExpression([prop])
<span class="linenr">  884: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (props.type === NodeTypes.JS_CALL_EXPRESSION) {
<span class="linenr">  885: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">merged props... add ours</span>
<span class="linenr">  886: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">only inject key to object literal if it's the first argument so that</span>
<span class="linenr">  887: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if doesn't override user provided keys</span>
<span class="linenr">  888: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">first</span> = props.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>] | JSChildNode
<span class="linenr">  889: </span>    <span class=
"org-keyword">if</span> (!isString(first) &amp;& first.type === NodeTypes.JS_OBJECT_EXPRESSION) {
<span class=
"linenr">  890: </span>      first.properties.unshift(prop)
<span class="linenr">  891: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">  892: </span>      <span class=
"org-keyword">if</span> (props.callee === TO_HANDLERS) {
<span class="linenr">  893: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#2366</span>
<span class=
"linenr">  894: </span>        propsWithInjection = createCallExpression(context.helper(MERGE_PROPS), [
<span class=
"linenr">  895: </span>          createObjectExpression([prop]),
<span class="linenr">  896: </span>          props
<span class="linenr">  897: </span>        ])
<span class="linenr">  898: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">  899: </span>        props.<span class=
"org-constant">arguments</span>.unshift(createObjectExpression([prop]))
<span class="linenr">  900: </span>      }
<span class="linenr">  901: </span>    }
<span class=
"linenr">  902: </span>    !propsWithInjection &amp;& (propsWithInjection = props)
<span class="linenr">  903: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (props.type === NodeTypes.JS_OBJECT_EXPRESSION) {
<span class="linenr">  904: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">alreadyExists</span> = <span class=
"org-constant">false</span>
<span class="linenr">  905: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check existing key to avoid overriding user provided keys</span>
<span class="linenr">  906: </span>    <span class=
"org-keyword">if</span> (prop.key.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr">  907: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">propKeyName</span> = prop.key.content
<span class=
"linenr">  908: </span>      alreadyExists = props.properties.some(
<span class="linenr">  909: </span>        p =&gt;
<span class=
"linenr">  910: </span>          p.key.type === NodeTypes.SIMPLE_EXPRESSION &amp;&
<span class=
"linenr">  911: </span>          p.key.content === propKeyName
<span class="linenr">  912: </span>      )
<span class="linenr">  913: </span>    }
<span class="linenr">  914: </span>    <span class=
"org-keyword">if</span> (!alreadyExists) {
<span class=
"linenr">  915: </span>      props.properties.unshift(prop)
<span class="linenr">  916: </span>    }
<span class="linenr">  917: </span>    propsWithInjection = props
<span class="linenr">  918: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">  919: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">single v-bind with expression, return a merged replacement</span>
<span class=
"linenr">  920: </span>    propsWithInjection = createCallExpression(context.helper(MERGE_PROPS), [
<span class=
"linenr">  921: </span>      createObjectExpression([prop]),
<span class="linenr">  922: </span>      props
<span class="linenr">  923: </span>    ])
<span class="linenr">  924: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in the case of nested helper call, e.g. `normalizeProps(guardReactiveProps(props))`,</span>
<span class="linenr">  925: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">it will be rewritten as `normalizeProps(mergeProps({ key: 0 }, props))`,</span>
<span class="linenr">  926: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the `guardReactiveProps` will no longer be needed</span>
<span class="linenr">  927: </span>    <span class=
"org-keyword">if</span> (parentCall &amp;& parentCall.callee === GUARD_REACTIVE_PROPS) {
<span class=
"linenr">  928: </span>      parentCall = callPath[callPath.length - <span class="org-highlight-numbers-number">2</span>]
<span class="linenr">  929: </span>    }
<span class="linenr">  930: </span>  }
<span class="linenr">  931: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.VNODE_CALL) {
<span class="linenr">  932: </span>    <span class=
"org-keyword">if</span> (parentCall) {
<span class="linenr">  933: </span>      parentCall.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>] = propsWithInjection
<span class="linenr">  934: </span>    } <span class=
"org-keyword">else</span> {
<span class=
"linenr">  935: </span>      node.props = propsWithInjection
<span class="linenr">  936: </span>    }
<span class="linenr">  937: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">  938: </span>    <span class=
"org-keyword">if</span> (parentCall) {
<span class="linenr">  939: </span>      parentCall.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>] = propsWithInjection
<span class="linenr">  940: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">  941: </span>      node.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">2</span>] = propsWithInjection
<span class="linenr">  942: </span>    }
<span class="linenr">  943: </span>  }
<span class="linenr">  944: </span>}
<span class="linenr">  945: </span>
<span class="linenr">  946: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">BindingTypes</span> = {
<span class="linenr">  947: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  948: </span><span class=
"org-doc">   * returned from data()</span>
<span class="linenr">  949: </span><span class=
"org-doc">   */</span>
<span class="linenr">  950: </span>  DATA: <span class=
"org-string">'data'</span>,
<span class="linenr">  951: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  952: </span><span class=
"org-doc">   * declared as a prop</span>
<span class="linenr">  953: </span><span class=
"org-doc">   */</span>
<span class="linenr">  954: </span>  PROPS: <span class=
"org-string">'props'</span>,
<span class="linenr">  955: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  956: </span><span class=
"org-doc">   * a local alias of a `&lt;script setup&gt;` destructured prop.</span>
<span class="linenr">  957: </span><span class=
"org-doc">   * the original is stored in __propsAliases of the bindingMetadata object.</span>
<span class="linenr">  958: </span><span class=
"org-doc">   */</span>
<span class="linenr">  959: </span>  PROPS_ALIASED: <span class=
"org-string">'props-aliased'</span>,
<span class="linenr">  960: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  961: </span><span class=
"org-doc">   * a let binding (may or may not be a ref)</span>
<span class="linenr">  962: </span><span class=
"org-doc">   */</span>
<span class="linenr">  963: </span>  SETUP_LET: <span class=
"org-string">'setup-let'</span>,
<span class="linenr">  964: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  965: </span><span class=
"org-doc">   * a const binding that can never be a ref.</span>
<span class="linenr">  966: </span><span class=
"org-doc">   * these bindings don't need `unref()` calls when processed in inlined</span>
<span class="linenr">  967: </span><span class=
"org-doc">   * template expressions.</span>
<span class="linenr">  968: </span><span class=
"org-doc">   */</span>
<span class="linenr">  969: </span>  SETUP_CONST: <span class=
"org-string">'setup-const'</span>,
<span class="linenr">  970: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  971: </span><span class=
"org-doc">   * a const binding that may be a ref.</span>
<span class="linenr">  972: </span><span class=
"org-doc">   */</span>
<span class="linenr">  973: </span>  SETUP_MAYBE_REF: <span class=
"org-string">'setup-maybe-ref'</span>,
<span class="linenr">  974: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  975: </span><span class=
"org-doc">   * bindings that are guaranteed to be refs</span>
<span class="linenr">  976: </span><span class=
"org-doc">   */</span>
<span class="linenr">  977: </span>  SETUP_REF: <span class=
"org-string">'setup-ref'</span>,
<span class="linenr">  978: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  979: </span><span class=
"org-doc">   * declared by other options, e.g. computed, inject</span>
<span class="linenr">  980: </span><span class=
"org-doc">   */</span>
<span class="linenr">  981: </span>  OPTIONS: <span class=
"org-string">'options'</span>
<span class="linenr">  982: </span>}
<span class="linenr">  983: </span>
<span class="linenr">  984: </span><span class=
"org-keyword">class</span> WalkerBase {
<span class="linenr">  985: </span>  constructor() {
<span class="linenr">  986: </span>    <span class=
"org-doc">/** @type {boolean} */</span>
<span class="linenr">  987: </span>    <span class=
"org-constant">this</span>.should_skip = <span class=
"org-constant">false</span>
<span class="linenr">  988: </span>
<span class="linenr">  989: </span>    <span class=
"org-doc">/** @type {boolean} */</span>
<span class="linenr">  990: </span>    <span class=
"org-constant">this</span>.should_remove = <span class=
"org-constant">false</span>
<span class="linenr">  991: </span>
<span class="linenr">  992: </span>    <span class=
"org-doc">/** @type {BaseNode | null} */</span>
<span class="linenr">  993: </span>    <span class=
"org-constant">this</span>.replacement = <span class=
"org-constant">null</span>
<span class="linenr">  994: </span>
<span class="linenr">  995: </span>    <span class=
"org-doc">/** @type {WalkerContext} */</span>
<span class="linenr">  996: </span>    <span class=
"org-constant">this</span>.context = {
<span class=
"linenr">  997: </span>      skip: () =&gt; (<span class=
"org-constant">this</span>.should_skip = <span class=
"org-constant">true</span>),
<span class=
"linenr">  998: </span>      remove: () =&gt; (<span class=
"org-constant">this</span>.should_remove = <span class=
"org-constant">true</span>),
<span class=
"linenr">  999: </span>      replace: (node) =&gt; (<span class=
"org-constant">this</span>.replacement = node)
<span class="linenr"> 1000: </span>    }
<span class="linenr"> 1001: </span>  }
<span class="linenr"> 1002: </span>
<span class=
"linenr"> 1003: </span>  replace(parent, prop, index, node) {
<span class="linenr"> 1004: </span>    <span class=
"org-keyword">if</span> (parent) {
<span class="linenr"> 1005: </span>      <span class=
"org-keyword">if</span> (index !== <span class=
"org-constant">null</span>) {
<span class=
"linenr"> 1006: </span>        parent[prop][index] = node
<span class="linenr"> 1007: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 1008: </span>        parent[prop] = node
<span class="linenr"> 1009: </span>      }
<span class="linenr"> 1010: </span>    }
<span class="linenr"> 1011: </span>  }
<span class="linenr"> 1012: </span>
<span class="linenr"> 1013: </span>  remove(parent, prop, index) {
<span class="linenr"> 1014: </span>    <span class=
"org-keyword">if</span> (parent) {
<span class="linenr"> 1015: </span>      <span class=
"org-keyword">if</span> (index !== <span class=
"org-constant">null</span>) {
<span class=
"linenr"> 1016: </span>        parent[prop].splice(index, <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 1017: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 1018: </span>        <span class=
"org-keyword">delete</span> parent[prop]
<span class="linenr"> 1019: </span>      }
<span class="linenr"> 1020: </span>    }
<span class="linenr"> 1021: </span>  }
<span class="linenr"> 1022: </span>}
<span class="linenr"> 1023: </span>
<span class="linenr"> 1024: </span><span class=
"org-keyword">class</span> SyncWalker <span class=
"org-keyword">extends</span> WalkerBase {
<span class="linenr"> 1025: </span>
<span class="linenr"> 1026: </span>  constructor(enter, leave) {
<span class="linenr"> 1027: </span>    <span class=
"org-keyword">super</span>()
<span class="linenr"> 1028: </span>
<span class="linenr"> 1029: </span>    <span class=
"org-doc">/** @type {SyncHandler} */</span>
<span class="linenr"> 1030: </span>    <span class=
"org-constant">this</span>.enter = enter
<span class="linenr"> 1031: </span>
<span class="linenr"> 1032: </span>    <span class=
"org-doc">/** @type {SyncHandler} */</span>
<span class="linenr"> 1033: </span>    <span class=
"org-constant">this</span>.leave = leave
<span class="linenr"> 1034: </span>  }
<span class="linenr"> 1035: </span>
<span class=
"linenr"> 1036: </span>  visit(node, parent, prop, index) {
<span class="linenr"> 1037: </span>    <span class=
"org-keyword">if</span> (node) {
<span class="linenr"> 1038: </span>      <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.enter) {
<span class="linenr"> 1039: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_should_skip</span> = <span class=
"org-constant">this</span>.should_skip
<span class="linenr"> 1040: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_should_remove</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1041: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_replacement</span> = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1042: </span>        <span class=
"org-constant">this</span>.should_skip = <span class=
"org-constant">false</span>
<span class="linenr"> 1043: </span>        <span class=
"org-constant">this</span>.should_remove = <span class=
"org-constant">false</span>
<span class="linenr"> 1044: </span>        <span class=
"org-constant">this</span>.replacement = <span class=
"org-constant">null</span>
<span class="linenr"> 1045: </span>
<span class="linenr"> 1046: </span>        <span class=
"org-constant">this</span>.enter.call(<span class=
"org-constant">this</span>.context, node, parent, prop, index)
<span class="linenr"> 1047: </span>
<span class="linenr"> 1048: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.replacement) {
<span class="linenr"> 1049: </span>          node = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1050: </span>          <span class=
"org-constant">this</span>.replace(parent, prop, index, node)
<span class="linenr"> 1051: </span>        }
<span class="linenr"> 1052: </span>
<span class="linenr"> 1053: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.should_remove) {
<span class="linenr"> 1054: </span>          <span class=
"org-constant">this</span>.remove(parent, prop, index)
<span class="linenr"> 1055: </span>        }
<span class="linenr"> 1056: </span>
<span class="linenr"> 1057: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">skipped</span> = <span class=
"org-constant">this</span>.should_skip
<span class="linenr"> 1058: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">removed</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1059: </span>
<span class="linenr"> 1060: </span>        <span class=
"org-constant">this</span>.should_skip = _should_skip
<span class="linenr"> 1061: </span>        <span class=
"org-constant">this</span>.should_remove = _should_remove
<span class="linenr"> 1062: </span>        <span class=
"org-constant">this</span>.replacement = _replacement
<span class="linenr"> 1063: </span>
<span class="linenr"> 1064: </span>        <span class=
"org-keyword">if</span> (skipped) <span class=
"org-keyword">return</span> node
<span class="linenr"> 1065: </span>        <span class=
"org-keyword">if</span> (removed) <span class=
"org-keyword">return</span> <span class="org-constant">null</span>
<span class="linenr"> 1066: </span>      }
<span class="linenr"> 1067: </span>
<span class="linenr"> 1068: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> node) {
<span class="linenr"> 1069: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">value</span> = node[key]
<span class="linenr"> 1070: </span>
<span class="linenr"> 1071: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-keyword">typeof</span> value !== <span class=
"org-string">'object'</span>) {
<span class="linenr"> 1072: </span>          <span class=
"org-keyword">continue</span>
<span class="linenr"> 1073: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (Array.isArray(value)) {
<span class="linenr"> 1074: </span>          <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; value.length; i += <span class="org-highlight-numbers-number">1</span>) {
<span class="linenr"> 1075: </span>            <span class=
"org-keyword">if</span> (value[i] !== <span class=
"org-constant">null</span> &amp;& <span class=
"org-keyword">typeof</span> value[i].type === <span class=
"org-string">'string'</span>) {
<span class="linenr"> 1076: </span>              <span class=
"org-keyword">if</span> (!<span class=
"org-constant">this</span>.visit(value[i], node, key, i)) {
<span class="linenr"> 1077: </span>                <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">removed</span>
<span class="linenr"> 1078: </span>                i--
<span class="linenr"> 1079: </span>              }
<span class="linenr"> 1080: </span>            }
<span class="linenr"> 1081: </span>          }
<span class="linenr"> 1082: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (value !== <span class=
"org-constant">null</span> &amp;& <span class=
"org-keyword">typeof</span> value.type === <span class=
"org-string">'string'</span>) {
<span class="linenr"> 1083: </span>          <span class=
"org-constant">this</span>.visit(value, node, key, <span class=
"org-constant">null</span>)
<span class="linenr"> 1084: </span>        }
<span class="linenr"> 1085: </span>      }
<span class="linenr"> 1086: </span>
<span class="linenr"> 1087: </span>      <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.leave) {
<span class="linenr"> 1088: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_replacement</span> = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1089: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_should_remove</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1090: </span>        <span class=
"org-constant">this</span>.replacement = <span class=
"org-constant">null</span>
<span class="linenr"> 1091: </span>        <span class=
"org-constant">this</span>.should_remove = <span class=
"org-constant">false</span>
<span class="linenr"> 1092: </span>
<span class="linenr"> 1093: </span>        <span class=
"org-constant">this</span>.leave.call(<span class=
"org-constant">this</span>.context, node, parent, prop, index)
<span class="linenr"> 1094: </span>
<span class="linenr"> 1095: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.replacement) {
<span class="linenr"> 1096: </span>          node = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1097: </span>          <span class=
"org-constant">this</span>.replace(parent, prop, index, node)
<span class="linenr"> 1098: </span>        }
<span class="linenr"> 1099: </span>
<span class="linenr"> 1100: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.should_remove) {
<span class="linenr"> 1101: </span>          <span class=
"org-constant">this</span>.remove(parent, prop, index)
<span class="linenr"> 1102: </span>        }
<span class="linenr"> 1103: </span>
<span class="linenr"> 1104: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">removed</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1105: </span>
<span class="linenr"> 1106: </span>        <span class=
"org-constant">this</span>.replacement = _replacement
<span class="linenr"> 1107: </span>        <span class=
"org-constant">this</span>.should_remove = _should_remove
<span class="linenr"> 1108: </span>
<span class="linenr"> 1109: </span>        <span class=
"org-keyword">if</span> (removed) <span class=
"org-keyword">return</span> <span class="org-constant">null</span>
<span class="linenr"> 1110: </span>      }
<span class="linenr"> 1111: </span>    }
<span class="linenr"> 1112: </span>
<span class="linenr"> 1113: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 1114: </span>  }
<span class="linenr"> 1115: </span>}
<span class="linenr"> 1116: </span>
<span class="linenr"> 1117: </span><span class=
"org-keyword">class</span> AsyncWalker <span class=
"org-keyword">extends</span> WalkerBase {
<span class="linenr"> 1118: </span>
<span class="linenr"> 1119: </span>  constructor(enter, leave) {
<span class="linenr"> 1120: </span>    <span class=
"org-keyword">super</span>()
<span class="linenr"> 1121: </span>
<span class="linenr"> 1122: </span>    <span class=
"org-doc">/** @type {AsyncHandler} */</span>
<span class="linenr"> 1123: </span>    <span class=
"org-constant">this</span>.enter = enter
<span class="linenr"> 1124: </span>
<span class="linenr"> 1125: </span>    <span class=
"org-doc">/** @type {AsyncHandler} */</span>
<span class="linenr"> 1126: </span>    <span class=
"org-constant">this</span>.leave = leave
<span class="linenr"> 1127: </span>  }
<span class="linenr"> 1128: </span>
<span class="linenr"> 1129: </span>  <span class=
"org-keyword">async</span> visit(node, parent, prop, index) {
<span class="linenr"> 1130: </span>    <span class=
"org-keyword">if</span> (node) {
<span class="linenr"> 1131: </span>      <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.enter) {
<span class="linenr"> 1132: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_should_skip</span> = <span class=
"org-constant">this</span>.should_skip
<span class="linenr"> 1133: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_should_remove</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1134: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_replacement</span> = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1135: </span>        <span class=
"org-constant">this</span>.should_skip = <span class=
"org-constant">false</span>
<span class="linenr"> 1136: </span>        <span class=
"org-constant">this</span>.should_remove = <span class=
"org-constant">false</span>
<span class="linenr"> 1137: </span>        <span class=
"org-constant">this</span>.replacement = <span class=
"org-constant">null</span>
<span class="linenr"> 1138: </span>
<span class="linenr"> 1139: </span>        <span class=
"org-keyword">await</span> <span class=
"org-constant">this</span>.enter.call(<span class=
"org-constant">this</span>.context, node, parent, prop, index)
<span class="linenr"> 1140: </span>
<span class="linenr"> 1141: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.replacement) {
<span class="linenr"> 1142: </span>          node = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1143: </span>          <span class=
"org-constant">this</span>.replace(parent, prop, index, node)
<span class="linenr"> 1144: </span>        }
<span class="linenr"> 1145: </span>
<span class="linenr"> 1146: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.should_remove) {
<span class="linenr"> 1147: </span>          <span class=
"org-constant">this</span>.remove(parent, prop, index)
<span class="linenr"> 1148: </span>        }
<span class="linenr"> 1149: </span>
<span class="linenr"> 1150: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">skipped</span> = <span class=
"org-constant">this</span>.should_skip
<span class="linenr"> 1151: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">removed</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1152: </span>
<span class="linenr"> 1153: </span>        <span class=
"org-constant">this</span>.should_skip = _should_skip
<span class="linenr"> 1154: </span>        <span class=
"org-constant">this</span>.should_remove = _should_remove
<span class="linenr"> 1155: </span>        <span class=
"org-constant">this</span>.replacement = _replacement
<span class="linenr"> 1156: </span>
<span class="linenr"> 1157: </span>        <span class=
"org-keyword">if</span> (skipped) <span class=
"org-keyword">return</span> node
<span class="linenr"> 1158: </span>        <span class=
"org-keyword">if</span> (removed) <span class=
"org-keyword">return</span> <span class="org-constant">null</span>
<span class="linenr"> 1159: </span>      }
<span class="linenr"> 1160: </span>
<span class="linenr"> 1161: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> node) {
<span class="linenr"> 1162: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">value</span> = node[key]
<span class="linenr"> 1163: </span>
<span class="linenr"> 1164: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-keyword">typeof</span> value !== <span class=
"org-string">'object'</span>) {
<span class="linenr"> 1165: </span>          <span class=
"org-keyword">continue</span>
<span class="linenr"> 1166: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (Array.isArray(value)) {
<span class="linenr"> 1167: </span>          <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; value.length; i += <span class="org-highlight-numbers-number">1</span>) {
<span class="linenr"> 1168: </span>            <span class=
"org-keyword">if</span> (value[i] !== <span class=
"org-constant">null</span> &amp;& <span class=
"org-keyword">typeof</span> value[i].type === <span class=
"org-string">'string'</span>) {
<span class="linenr"> 1169: </span>              <span class=
"org-keyword">if</span> (!(<span class=
"org-keyword">await</span> <span class=
"org-constant">this</span>.visit(value[i], node, key, i))) {
<span class="linenr"> 1170: </span>                <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">removed</span>
<span class="linenr"> 1171: </span>                i--
<span class="linenr"> 1172: </span>              }
<span class="linenr"> 1173: </span>            }
<span class="linenr"> 1174: </span>          }
<span class="linenr"> 1175: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (value !== <span class=
"org-constant">null</span> &amp;& <span class=
"org-keyword">typeof</span> value.type === <span class=
"org-string">'string'</span>) {
<span class="linenr"> 1176: </span>          <span class=
"org-keyword">await</span> <span class=
"org-constant">this</span>.visit(value, node, key, <span class=
"org-constant">null</span>)
<span class="linenr"> 1177: </span>        }
<span class="linenr"> 1178: </span>      }
<span class="linenr"> 1179: </span>
<span class="linenr"> 1180: </span>      <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.leave) {
<span class="linenr"> 1181: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_replacement</span> = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1182: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_should_remove</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1183: </span>        <span class=
"org-constant">this</span>.replacement = <span class=
"org-constant">null</span>
<span class="linenr"> 1184: </span>        <span class=
"org-constant">this</span>.should_remove = <span class=
"org-constant">false</span>
<span class="linenr"> 1185: </span>
<span class="linenr"> 1186: </span>        <span class=
"org-keyword">await</span> <span class=
"org-constant">this</span>.leave.call(<span class=
"org-constant">this</span>.context, node, parent, prop, index)
<span class="linenr"> 1187: </span>
<span class="linenr"> 1188: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.replacement) {
<span class="linenr"> 1189: </span>          node = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1190: </span>          <span class=
"org-constant">this</span>.replace(parent, prop, index, node)
<span class="linenr"> 1191: </span>        }
<span class="linenr"> 1192: </span>
<span class="linenr"> 1193: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.should_remove) {
<span class="linenr"> 1194: </span>          <span class=
"org-constant">this</span>.remove(parent, prop, index)
<span class="linenr"> 1195: </span>        }
<span class="linenr"> 1196: </span>
<span class="linenr"> 1197: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">removed</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1198: </span>
<span class="linenr"> 1199: </span>        <span class=
"org-constant">this</span>.replacement = _replacement
<span class="linenr"> 1200: </span>        <span class=
"org-constant">this</span>.should_remove = _should_remove
<span class="linenr"> 1201: </span>
<span class="linenr"> 1202: </span>        <span class=
"org-keyword">if</span> (removed) <span class=
"org-keyword">return</span> <span class="org-constant">null</span>
<span class="linenr"> 1203: </span>      }
<span class="linenr"> 1204: </span>    }
<span class="linenr"> 1205: </span>
<span class="linenr"> 1206: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 1207: </span>  }
<span class="linenr"> 1208: </span>}
<span class="linenr"> 1209: </span>
<span class="linenr"> 1210: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">walk</span>(<span class=
"org-variable-name">ast</span>, { <span class=
"org-variable-name">enter</span>, <span class=
"org-variable-name">leave</span> }) {
<span class="linenr"> 1211: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">instance</span> = <span class=
"org-keyword">new</span> <span class=
"org-type">SyncWalker</span>(enter, leave)
<span class="linenr"> 1212: </span>  <span class=
"org-keyword">return</span> instance.visit(ast, <span class=
"org-constant">null</span>)
<span class="linenr"> 1213: </span>}
<span class="linenr"> 1214: </span>
<span class="linenr"> 1215: </span><span class=
"org-keyword">async</span> <span class=
"org-keyword">function</span> asyncWalk(<span class=
"org-variable-name">ast</span>, { <span class=
"org-variable-name">enter</span>, <span class=
"org-variable-name">leave</span> }) {
<span class="linenr"> 1216: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">instance</span> = <span class=
"org-keyword">new</span> <span class=
"org-type">AsyncWalker</span>(enter, leave)
<span class="linenr"> 1217: </span>  <span class=
"org-keyword">return</span> <span class=
"org-keyword">await</span> instance.visit(ast, <span class=
"org-constant">null</span>)
<span class="linenr"> 1218: </span>}
<span class="linenr"> 1219: </span>
<span class="linenr"> 1220: </span>
<span class="linenr"> 1221: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isInDestructureAssignment</span>(
<span class="linenr"> 1222: </span>  <span class=
"org-variable-name">parent</span>,
<span class="linenr"> 1223: </span>  parentStack
<span class="linenr"> 1224: </span>) {
<span class="linenr"> 1225: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 1226: </span>    parent &amp;&
<span class=
"linenr"> 1227: </span>    (parent.type === <span class="org-string">'ObjectProperty'</span> || parent.type === <span class="org-string">'ArrayPattern'</span>)
<span class="linenr"> 1228: </span>  ) {
<span class="linenr"> 1229: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = parentStack.length
<span class="linenr"> 1230: </span>    <span class=
"org-keyword">while</span> (i--) {
<span class="linenr"> 1231: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = parentStack[i]
<span class="linenr"> 1232: </span>      <span class=
"org-keyword">if</span> (p.type === <span class=
"org-string">'AssignmentExpression'</span>) {
<span class="linenr"> 1233: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1234: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.type !== <span class=
"org-string">'ObjectProperty'</span> &amp;& !p.type.endsWith(<span class="org-string">'Pattern'</span>)) {
<span class="linenr"> 1235: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 1236: </span>      }
<span class="linenr"> 1237: </span>    }
<span class="linenr"> 1238: </span>  }
<span class="linenr"> 1239: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1240: </span>}
<span class="linenr"> 1241: </span>
<span class="linenr"> 1242: </span>
<span class="linenr"> 1243: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">walkIdentifiers</span>(
<span class="linenr"> 1244: </span>  <span class=
"org-variable-name">root</span>,
<span class="linenr"> 1245: </span>  <span class=
"org-variable-name">onIdentifier</span>,
<span class="linenr"> 1246: </span>  includeAll = <span class=
"org-constant">false</span>,
<span class="linenr"> 1247: </span>  parentStack = [],
<span class=
"linenr"> 1248: </span>  knownIds = Object.create(<span class=
"org-constant">null</span>)
<span class="linenr"> 1249: </span>) {
<span class="linenr"> 1250: </span>  <span class=
"org-keyword">if</span> (__BROWSER__) {
<span class="linenr"> 1251: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 1252: </span>  }
<span class="linenr"> 1253: </span>
<span class="linenr"> 1254: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rootExp</span> =
<span class="linenr"> 1255: </span>    root.type === <span class=
"org-string">'Program'</span> &amp;&
<span class="linenr"> 1256: </span>    root.body[<span class=
"org-highlight-numbers-number">0</span>].type === <span class=
"org-string">'ExpressionStatement'</span> &amp;&
<span class="linenr"> 1257: </span>    root.body[<span class=
"org-highlight-numbers-number">0</span>].expression
<span class="linenr"> 1258: </span>
<span class="linenr"> 1259: </span>  walk(root, {
<span class="linenr"> 1260: </span>    enter(node, parent) {
<span class=
"linenr"> 1261: </span>      parent &amp;& parentStack.push(parent)
<span class="linenr"> 1262: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 1263: </span>        parent &amp;&
<span class=
"linenr"> 1264: </span>        parent.type.startsWith(<span class=
"org-string">'TS'</span>) &amp;&
<span class=
"linenr"> 1265: </span>        parent.type !== <span class=
"org-string">'TSAsExpression'</span> &amp;&
<span class=
"linenr"> 1266: </span>        parent.type !== <span class=
"org-string">'TSNonNullExpression'</span> &amp;&
<span class=
"linenr"> 1267: </span>        parent.type !== <span class=
"org-string">'TSTypeAssertion'</span>
<span class="linenr"> 1268: </span>      ) {
<span class="linenr"> 1269: </span>        <span class=
"org-keyword">return</span> <span class=
"org-constant">this</span>.skip()
<span class="linenr"> 1270: </span>      }
<span class="linenr"> 1271: </span>      <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr"> 1272: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isLocal</span> = !!knownIds[node.name]
<span class="linenr"> 1273: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isRefed</span> = isReferencedIdentifier(node, parent, parentStack)
<span class="linenr"> 1274: </span>        <span class=
"org-keyword">if</span> (includeAll || (isRefed &amp;& !isLocal)) {
<span class=
"linenr"> 1275: </span>          onIdentifier(node, parent, parentStack, isRefed, isLocal)
<span class="linenr"> 1276: </span>        }
<span class="linenr"> 1277: </span>      } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr"> 1278: </span>        node.type === <span class=
"org-string">'ObjectProperty'</span> &amp;&
<span class=
"linenr"> 1279: </span>        parent.type === <span class=
"org-string">'ObjectPattern'</span>
<span class="linenr"> 1280: </span>      ) {
<span class="linenr"> 1281: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">mark property in destructure pattern</span>
<span class=
"linenr"> 1282: </span>        node.inPattern = <span class=
"org-constant">true</span>
<span class="linenr"> 1283: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isFunctionType(node)) {
<span class="linenr"> 1284: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">walk function expressions and add its arguments to known identifiers</span>
<span class="linenr"> 1285: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">so that we don't prefix them</span>
<span class=
"linenr"> 1286: </span>        walkFunctionParams(node, id =&gt; markScopeIdentifier(node, id, knownIds))
<span class="linenr"> 1287: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'BlockStatement'</span>) {
<span class="linenr"> 1288: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#3445 record block-level local variables</span>
<span class=
"linenr"> 1289: </span>        walkBlockDeclarations(node, id =&gt;
<span class=
"linenr"> 1290: </span>          markScopeIdentifier(node, id, knownIds)
<span class="linenr"> 1291: </span>        )
<span class="linenr"> 1292: </span>      }
<span class="linenr"> 1293: </span>    },
<span class="linenr"> 1294: </span>    leave(node, parent) {
<span class=
"linenr"> 1295: </span>      parent &amp;& parentStack.pop()
<span class="linenr"> 1296: </span>      <span class=
"org-keyword">if</span> (node !== rootExp &amp;& node.scopeIds) {
<span class="linenr"> 1297: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">id</span> <span class=
"org-keyword">of</span> node.scopeIds) {
<span class="linenr"> 1298: </span>          knownIds[id]--
<span class="linenr"> 1299: </span>          <span class=
"org-keyword">if</span> (knownIds[id] === <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 1300: </span>            <span class=
"org-keyword">delete</span> knownIds[id]
<span class="linenr"> 1301: </span>          }
<span class="linenr"> 1302: </span>        }
<span class="linenr"> 1303: </span>      }
<span class="linenr"> 1304: </span>    }
<span class="linenr"> 1305: </span>  })
<span class="linenr"> 1306: </span>}
<span class="linenr"> 1307: </span>
<span class="linenr"> 1308: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isReferencedIdentifier</span>(
<span class="linenr"> 1309: </span>  <span class=
"org-variable-name">id</span>,
<span class="linenr"> 1310: </span>  <span class=
"org-variable-name">parent</span>,
<span class="linenr"> 1311: </span>  parentStack
<span class="linenr"> 1312: </span>) {
<span class="linenr"> 1313: </span>  <span class=
"org-keyword">if</span> (__BROWSER__) {
<span class="linenr"> 1314: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1315: </span>  }
<span class="linenr"> 1316: </span>
<span class="linenr"> 1317: </span>  <span class=
"org-keyword">if</span> (!parent) {
<span class="linenr"> 1318: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1319: </span>  }
<span class="linenr"> 1320: </span>
<span class="linenr"> 1321: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">is a special keyword but parsed as identifier</span>
<span class="linenr"> 1322: </span>  <span class=
"org-keyword">if</span> (id.name === <span class=
"org-string">'arguments'</span>) {
<span class="linenr"> 1323: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1324: </span>  }
<span class="linenr"> 1325: </span>
<span class="linenr"> 1326: </span>  <span class=
"org-keyword">if</span> (isReferenced(id, parent)) {
<span class="linenr"> 1327: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1328: </span>  }
<span class="linenr"> 1329: </span>
<span class="linenr"> 1330: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">babel's isReferenced check returns false for ids being assigned to, so we</span>
<span class="linenr"> 1331: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">need to cover those cases here</span>
<span class="linenr"> 1332: </span>  <span class=
"org-keyword">switch</span> (parent.type) {
<span class="linenr"> 1333: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'AssignmentExpression'</span>:
<span class="linenr"> 1334: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'AssignmentPattern'</span>:
<span class="linenr"> 1335: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1336: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ObjectPattern'</span>:
<span class="linenr"> 1337: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ArrayPattern'</span>:
<span class="linenr"> 1338: </span>      <span class=
"org-keyword">return</span> isInDestructureAssignment(parent, parentStack)
<span class="linenr"> 1339: </span>  }
<span class="linenr"> 1340: </span>
<span class="linenr"> 1341: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1342: </span>}
<span class="linenr"> 1343: </span>
<span class="linenr"> 1344: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isInDestructureAssignment</span>(
<span class="linenr"> 1345: </span>  <span class=
"org-variable-name">parent</span>,
<span class="linenr"> 1346: </span>  parentStack
<span class="linenr"> 1347: </span>) {
<span class="linenr"> 1348: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 1349: </span>    parent &amp;&
<span class=
"linenr"> 1350: </span>    (parent.type === <span class="org-string">'ObjectProperty'</span> || parent.type === <span class="org-string">'ArrayPattern'</span>)
<span class="linenr"> 1351: </span>  ) {
<span class="linenr"> 1352: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = parentStack.length
<span class="linenr"> 1353: </span>    <span class=
"org-keyword">while</span> (i--) {
<span class="linenr"> 1354: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = parentStack[i]
<span class="linenr"> 1355: </span>      <span class=
"org-keyword">if</span> (p.type === <span class=
"org-string">'AssignmentExpression'</span>) {
<span class="linenr"> 1356: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1357: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.type !== <span class=
"org-string">'ObjectProperty'</span> &amp;& !p.type.endsWith(<span class="org-string">'Pattern'</span>)) {
<span class="linenr"> 1358: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 1359: </span>      }
<span class="linenr"> 1360: </span>    }
<span class="linenr"> 1361: </span>  }
<span class="linenr"> 1362: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1363: </span>}
<span class="linenr"> 1364: </span>
<span class="linenr"> 1365: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">walkFunctionParams</span>(
<span class="linenr"> 1366: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 1367: </span>  onIdent
<span class="linenr"> 1368: </span>) {
<span class="linenr"> 1369: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> <span class=
"org-keyword">of</span> node.params) {
<span class="linenr"> 1370: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">id</span> <span class=
"org-keyword">of</span> extractIdentifiers(p)) {
<span class="linenr"> 1371: </span>      onIdent(id)
<span class="linenr"> 1372: </span>    }
<span class="linenr"> 1373: </span>  }
<span class="linenr"> 1374: </span>}
<span class="linenr"> 1375: </span>
<span class="linenr"> 1376: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">walkBlockDeclarations</span>(
<span class="linenr"> 1377: </span>  <span class=
"org-variable-name">block</span>,
<span class="linenr"> 1378: </span>  onIdent
<span class="linenr"> 1379: </span>) {
<span class="linenr"> 1380: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">stmt</span> <span class=
"org-keyword">of</span> block.body) {
<span class="linenr"> 1381: </span>    <span class=
"org-keyword">if</span> (stmt.type === <span class=
"org-string">'VariableDeclaration'</span>) {
<span class="linenr"> 1382: </span>      <span class=
"org-keyword">if</span> (stmt.declare) <span class=
"org-keyword">continue</span>
<span class="linenr"> 1383: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">decl</span> <span class=
"org-keyword">of</span> stmt.declarations) {
<span class="linenr"> 1384: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">id</span> <span class=
"org-keyword">of</span> extractIdentifiers(decl.id)) {
<span class="linenr"> 1385: </span>          onIdent(id)
<span class="linenr"> 1386: </span>        }
<span class="linenr"> 1387: </span>      }
<span class="linenr"> 1388: </span>    } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class="linenr"> 1389: </span>      stmt.type === <span class=
"org-string">'FunctionDeclaration'</span> ||
<span class="linenr"> 1390: </span>      stmt.type === <span class=
"org-string">'ClassDeclaration'</span>
<span class="linenr"> 1391: </span>    ) {
<span class="linenr"> 1392: </span>      <span class=
"org-keyword">if</span> (stmt.declare || !stmt.id) <span class=
"org-keyword">continue</span>
<span class="linenr"> 1393: </span>      onIdent(stmt.id)
<span class="linenr"> 1394: </span>    }
<span class="linenr"> 1395: </span>  }
<span class="linenr"> 1396: </span>}
<span class="linenr"> 1397: </span>
<span class="linenr"> 1398: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">extractIdentifiers</span>(
<span class="linenr"> 1399: </span>  <span class=
"org-variable-name">param</span>,
<span class="linenr"> 1400: </span>  nodes = []
<span class="linenr"> 1401: </span>) {
<span class="linenr"> 1402: </span>  <span class=
"org-keyword">switch</span> (param.type) {
<span class="linenr"> 1403: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'Identifier'</span>:
<span class="linenr"> 1404: </span>      nodes.push(param)
<span class="linenr"> 1405: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 1406: </span>
<span class="linenr"> 1407: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'MemberExpression'</span>:
<span class="linenr"> 1408: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">object</span> = param
<span class="linenr"> 1409: </span>      <span class=
"org-keyword">while</span> (object.type === <span class=
"org-string">'MemberExpression'</span>) {
<span class="linenr"> 1410: </span>        object = object.object
<span class="linenr"> 1411: </span>      }
<span class="linenr"> 1412: </span>      nodes.push(object)
<span class="linenr"> 1413: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 1414: </span>
<span class="linenr"> 1415: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ObjectPattern'</span>:
<span class="linenr"> 1416: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">prop</span> <span class=
"org-keyword">of</span> param.properties) {
<span class="linenr"> 1417: </span>        <span class=
"org-keyword">if</span> (prop.type === <span class=
"org-string">'RestElement'</span>) {
<span class=
"linenr"> 1418: </span>          extractIdentifiers(prop.argument, nodes)
<span class="linenr"> 1419: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 1420: </span>          extractIdentifiers(prop.value, nodes)
<span class="linenr"> 1421: </span>        }
<span class="linenr"> 1422: </span>      }
<span class="linenr"> 1423: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 1424: </span>
<span class="linenr"> 1425: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ArrayPattern'</span>:
<span class=
"linenr"> 1426: </span>      param.elements.forEach(element =&gt; {
<span class="linenr"> 1427: </span>        <span class=
"org-keyword">if</span> (element) extractIdentifiers(element, nodes)
<span class="linenr"> 1428: </span>      })
<span class="linenr"> 1429: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 1430: </span>
<span class="linenr"> 1431: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'RestElement'</span>:
<span class=
"linenr"> 1432: </span>      extractIdentifiers(param.argument, nodes)
<span class="linenr"> 1433: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 1434: </span>
<span class="linenr"> 1435: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'AssignmentPattern'</span>:
<span class=
"linenr"> 1436: </span>      extractIdentifiers(param.left, nodes)
<span class="linenr"> 1437: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 1438: </span>  }
<span class="linenr"> 1439: </span>
<span class="linenr"> 1440: </span>  <span class=
"org-keyword">return</span> nodes
<span class="linenr"> 1441: </span>}
<span class="linenr"> 1442: </span>
<span class="linenr"> 1443: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">markScopeIdentifier</span>(
<span class="linenr"> 1444: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 1445: </span>  <span class=
"org-variable-name">child</span>,
<span class="linenr"> 1446: </span>  knownIds
<span class="linenr"> 1447: </span>) {
<span class="linenr"> 1448: </span>  <span class=
"org-keyword">const</span> { name } = child
<span class="linenr"> 1449: </span>  <span class=
"org-keyword">if</span> (node.scopeIds &amp;& node.scopeIds.has(name)) {
<span class="linenr"> 1450: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 1451: </span>  }
<span class="linenr"> 1452: </span>  <span class=
"org-keyword">if</span> (name <span class=
"org-keyword">in</span> knownIds) {
<span class="linenr"> 1453: </span>    knownIds[name]++
<span class="linenr"> 1454: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 1455: </span>    knownIds[name] = <span class="org-highlight-numbers-number">1</span>
<span class="linenr"> 1456: </span>  }
<span class=
"linenr"> 1457: </span>  ;(node.scopeIds || (node.scopeIds = <span class="org-keyword">new</span> <span class="org-type">Set</span>())).add(name)
<span class="linenr"> 1458: </span>}
<span class="linenr"> 1459: </span>
<span class="linenr"> 1460: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isFunctionType</span> = (node) =&gt; {
<span class="linenr"> 1461: </span>  <span class=
"org-keyword">return</span> <span class=
"org-string">/Function(?:Expression|Declaration)$|Method$/</span>.test(node.type)
<span class="linenr"> 1462: </span>}
<span class="linenr"> 1463: </span>
<span class="linenr"> 1464: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isStaticProperty</span> = (node) =&gt;
<span class="linenr"> 1465: </span>  node &amp;&
<span class="linenr"> 1466: </span>  (node.type === <span class=
"org-string">'ObjectProperty'</span> || node.type === <span class=
"org-string">'ObjectMethod'</span>) &amp;&
<span class="linenr"> 1467: </span>  !node.computed
<span class="linenr"> 1468: </span>
<span class="linenr"> 1469: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isStaticPropertyKey</span> = (node, parent) =&gt; isStaticProperty(parent) &amp;& parent.key === node
<span class="linenr"> 1470: </span>
<span class="linenr"> 1471: </span><span class="org-doc">/**</span>
<span class="linenr"> 1472: </span><span class=
"org-doc"> * Copied from https://github.com/babel/babel/blob/main/packages/babel-types/src/validators/isReferenced.ts</span>
<span class="linenr"> 1473: </span><span class=
"org-doc"> * To avoid runtime dependency on @babel/types (which includes process references)</span>
<span class="linenr"> 1474: </span><span class=
"org-doc"> * This file should not change very often in babel but we may need to keep it</span>
<span class="linenr"> 1475: </span><span class=
"org-doc"> * up-to-date from time to time.</span>
<span class="linenr"> 1476: </span><span class="org-doc"> *</span>
<span class="linenr"> 1477: </span><span class=
"org-doc"> * https://github.com/babel/babel/blob/main/LICENSE</span>
<span class="linenr"> 1478: </span><span class="org-doc"> *</span>
<span class="linenr"> 1479: </span><span class="org-doc"> */</span>
<span class="linenr"> 1480: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isReferenced</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">parent</span>, <span class=
"org-variable-name">grandparent</span>) {
<span class="linenr"> 1481: </span>  <span class=
"org-keyword">switch</span> (parent.type) {
<span class="linenr"> 1482: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: PARENT[NODE]</span>
<span class="linenr"> 1483: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: NODE.child</span>
<span class="linenr"> 1484: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: parent.NODE</span>
<span class="linenr"> 1485: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'MemberExpression'</span>:
<span class="linenr"> 1486: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'OptionalMemberExpression'</span>:
<span class="linenr"> 1487: </span>      <span class=
"org-keyword">if</span> (parent.property === node) {
<span class="linenr"> 1488: </span>        <span class=
"org-keyword">return</span> !!parent.computed
<span class="linenr"> 1489: </span>      }
<span class="linenr"> 1490: </span>      <span class=
"org-keyword">return</span> parent.object === node
<span class="linenr"> 1491: </span>
<span class="linenr"> 1492: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'JSXMemberExpression'</span>:
<span class="linenr"> 1493: </span>      <span class=
"org-keyword">return</span> parent.object === node
<span class="linenr"> 1494: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: let NODE = init;</span>
<span class="linenr"> 1495: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: let id = NODE;</span>
<span class="linenr"> 1496: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'VariableDeclarator'</span>:
<span class="linenr"> 1497: </span>      <span class=
"org-keyword">return</span> parent.init === node
<span class="linenr"> 1498: </span>
<span class="linenr"> 1499: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: () =&gt; NODE</span>
<span class="linenr"> 1500: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: (NODE) =&gt; {}</span>
<span class="linenr"> 1501: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ArrowFunctionExpression'</span>:
<span class="linenr"> 1502: </span>      <span class=
"org-keyword">return</span> parent.body === node
<span class="linenr"> 1503: </span>
<span class="linenr"> 1504: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class { #NODE; }</span>
<span class="linenr"> 1505: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class { get #NODE() {} }</span>
<span class="linenr"> 1506: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class { #NODE() {} }</span>
<span class="linenr"> 1507: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class { fn() { return this.#NODE; } }</span>
<span class="linenr"> 1508: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'PrivateName'</span>:
<span class="linenr"> 1509: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1510: </span>
<span class="linenr"> 1511: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class { NODE() {} }</span>
<span class="linenr"> 1512: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: class { [NODE]() {} }</span>
<span class="linenr"> 1513: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class { foo(NODE) {} }</span>
<span class="linenr"> 1514: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ClassMethod'</span>:
<span class="linenr"> 1515: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ClassPrivateMethod'</span>:
<span class="linenr"> 1516: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ObjectMethod'</span>:
<span class="linenr"> 1517: </span>      <span class=
"org-keyword">if</span> (parent.key === node) {
<span class="linenr"> 1518: </span>        <span class=
"org-keyword">return</span> !!parent.computed
<span class="linenr"> 1519: </span>      }
<span class="linenr"> 1520: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1521: </span>
<span class="linenr"> 1522: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: { [NODE]: "" }</span>
<span class="linenr"> 1523: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: { NODE: "" }</span>
<span class="linenr"> 1524: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">depends: { NODE }</span>
<span class="linenr"> 1525: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">depends: { key: NODE }</span>
<span class="linenr"> 1526: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ObjectProperty'</span>:
<span class="linenr"> 1527: </span>      <span class=
"org-keyword">if</span> (parent.key === node) {
<span class="linenr"> 1528: </span>        <span class=
"org-keyword">return</span> !!parent.computed
<span class="linenr"> 1529: </span>      }
<span class="linenr"> 1530: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">parent.value === node</span>
<span class="linenr"> 1531: </span>      <span class=
"org-keyword">return</span> !grandparent || grandparent.type !== <span class="org-string">'ObjectPattern'</span>
<span class="linenr"> 1532: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class { NODE = value; }</span>
<span class="linenr"> 1533: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: class { [NODE] = value; }</span>
<span class="linenr"> 1534: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: class { key = NODE; }</span>
<span class="linenr"> 1535: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ClassProperty'</span>:
<span class="linenr"> 1536: </span>      <span class=
"org-keyword">if</span> (parent.key === node) {
<span class="linenr"> 1537: </span>        <span class=
"org-keyword">return</span> !!parent.computed
<span class="linenr"> 1538: </span>      }
<span class="linenr"> 1539: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1540: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ClassPrivateProperty'</span>:
<span class="linenr"> 1541: </span>      <span class=
"org-keyword">return</span> parent.key !== node
<span class="linenr"> 1542: </span>
<span class="linenr"> 1543: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class NODE {}</span>
<span class="linenr"> 1544: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: class Foo extends NODE {}</span>
<span class="linenr"> 1545: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ClassDeclaration'</span>:
<span class="linenr"> 1546: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ClassExpression'</span>:
<span class="linenr"> 1547: </span>      <span class=
"org-keyword">return</span> parent.superClass === node
<span class="linenr"> 1548: </span>
<span class="linenr"> 1549: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: left = NODE;</span>
<span class="linenr"> 1550: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: NODE = right;</span>
<span class="linenr"> 1551: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'AssignmentExpression'</span>:
<span class="linenr"> 1552: </span>      <span class=
"org-keyword">return</span> parent.right === node
<span class="linenr"> 1553: </span>
<span class="linenr"> 1554: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: [NODE = foo] = [];</span>
<span class="linenr"> 1555: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: [foo = NODE] = [];</span>
<span class="linenr"> 1556: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'AssignmentPattern'</span>:
<span class="linenr"> 1557: </span>      <span class=
"org-keyword">return</span> parent.right === node
<span class="linenr"> 1558: </span>
<span class="linenr"> 1559: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: NODE: for (;;) {}</span>
<span class="linenr"> 1560: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'LabeledStatement'</span>:
<span class="linenr"> 1561: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1562: </span>
<span class="linenr"> 1563: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: try {} catch (NODE) {}</span>
<span class="linenr"> 1564: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'CatchClause'</span>:
<span class="linenr"> 1565: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1566: </span>
<span class="linenr"> 1567: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: function foo(...NODE) {}</span>
<span class="linenr"> 1568: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'RestElement'</span>:
<span class="linenr"> 1569: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1570: </span>
<span class="linenr"> 1571: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'BreakStatement'</span>:
<span class="linenr"> 1572: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ContinueStatement'</span>:
<span class="linenr"> 1573: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1574: </span>
<span class="linenr"> 1575: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: function NODE() {}</span>
<span class="linenr"> 1576: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: function foo(NODE) {}</span>
<span class="linenr"> 1577: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'FunctionDeclaration'</span>:
<span class="linenr"> 1578: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'FunctionExpression'</span>:
<span class="linenr"> 1579: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1580: </span>
<span class="linenr"> 1581: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: export NODE from "foo";</span>
<span class="linenr"> 1582: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: export * as NODE from "foo";</span>
<span class="linenr"> 1583: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ExportNamespaceSpecifier'</span>:
<span class="linenr"> 1584: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ExportDefaultSpecifier'</span>:
<span class="linenr"> 1585: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1586: </span>
<span class="linenr"> 1587: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: export { foo as NODE };</span>
<span class="linenr"> 1588: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: export { NODE as foo };</span>
<span class="linenr"> 1589: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: export { NODE as foo } from "foo";</span>
<span class="linenr"> 1590: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ExportSpecifier'</span>:
<span class="linenr"> 1591: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">@ts-expect-error</span>
<span class="linenr"> 1592: </span>      <span class=
"org-keyword">if</span> (grandparent?.source) {
<span class="linenr"> 1593: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1594: </span>      }
<span class="linenr"> 1595: </span>      <span class=
"org-keyword">return</span> parent.local === node
<span class="linenr"> 1596: </span>
<span class="linenr"> 1597: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: import NODE from "foo";</span>
<span class="linenr"> 1598: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: import * as NODE from "foo";</span>
<span class="linenr"> 1599: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: import { NODE as foo } from "foo";</span>
<span class="linenr"> 1600: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: import { foo as NODE } from "foo";</span>
<span class="linenr"> 1601: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: import NODE from "bar";</span>
<span class="linenr"> 1602: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ImportDefaultSpecifier'</span>:
<span class="linenr"> 1603: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ImportNamespaceSpecifier'</span>:
<span class="linenr"> 1604: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ImportSpecifier'</span>:
<span class="linenr"> 1605: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1606: </span>
<span class="linenr"> 1607: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: import "foo" assert { NODE: "json" }</span>
<span class="linenr"> 1608: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ImportAttribute'</span>:
<span class="linenr"> 1609: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1610: </span>
<span class="linenr"> 1611: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: &lt;div NODE="foo" /&gt;</span>
<span class="linenr"> 1612: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'JSXAttribute'</span>:
<span class="linenr"> 1613: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1614: </span>
<span class="linenr"> 1615: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: [NODE] = [];</span>
<span class="linenr"> 1616: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: ({ NODE }) = [];</span>
<span class="linenr"> 1617: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ObjectPattern'</span>:
<span class="linenr"> 1618: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ArrayPattern'</span>:
<span class="linenr"> 1619: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1620: </span>
<span class="linenr"> 1621: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: new.NODE</span>
<span class="linenr"> 1622: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: NODE.target</span>
<span class="linenr"> 1623: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'MetaProperty'</span>:
<span class="linenr"> 1624: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1625: </span>
<span class="linenr"> 1626: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: type X = { someProperty: NODE }</span>
<span class="linenr"> 1627: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: type X = { NODE: OtherType }</span>
<span class="linenr"> 1628: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ObjectTypeProperty'</span>:
<span class="linenr"> 1629: </span>      <span class=
"org-keyword">return</span> parent.key !== node
<span class="linenr"> 1630: </span>
<span class="linenr"> 1631: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: enum X { Foo = NODE }</span>
<span class="linenr"> 1632: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: enum X { NODE }</span>
<span class="linenr"> 1633: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSEnumMember'</span>:
<span class="linenr"> 1634: </span>      <span class=
"org-keyword">return</span> parent.id !== node
<span class="linenr"> 1635: </span>
<span class="linenr"> 1636: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: { [NODE]: value }</span>
<span class="linenr"> 1637: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: { NODE: value }</span>
<span class="linenr"> 1638: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSPropertySignature'</span>:
<span class="linenr"> 1639: </span>      <span class=
"org-keyword">if</span> (parent.key === node) {
<span class="linenr"> 1640: </span>        <span class=
"org-keyword">return</span> !!parent.computed
<span class="linenr"> 1641: </span>      }
<span class="linenr"> 1642: </span>
<span class="linenr"> 1643: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1644: </span>  }
<span class="linenr"> 1645: </span>
<span class="linenr"> 1646: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1647: </span>}
<span class="linenr"> 1648: </span>
<span class="linenr"> 1649: </span>
<span class="linenr"> 1650: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">validFirstIdentCharRE</span> = <span class=
"org-string">/[A-Za-z_$\xA0-\uFFFF]/</span>
<span class="linenr"> 1651: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">validIdentCharRE</span> = <span class=
"org-string">/[\.\?\w$\xA0-\uFFFF]/</span>
<span class="linenr"> 1652: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">whitespaceRE</span> = <span class=
"org-string">/\s+[.[]\s*|\s*[.[]\s+/</span>g
<span class="linenr"> 1653: </span>
<span class="linenr"> 1654: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">MemberExpLexState</span> = {
<span class="linenr"> 1655: </span>  inMemberExp: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 1656: </span>  inBrackets: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr"> 1657: </span>  inParens: <span class=
"org-highlight-numbers-number">2</span>,
<span class="linenr"> 1658: </span>  inString: <span class=
"org-highlight-numbers-number">3</span>
<span class="linenr"> 1659: </span>}
<span class="linenr"> 1660: </span>
<span class="linenr"> 1661: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isMemberExpressionBrowser</span> = path =&gt; {
<span class="linenr"> 1662: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">remove whitespaces around . or [ first</span>
<span class=
"linenr"> 1663: </span>  path = path.trim().replace(whitespaceRE, s =&gt; s.trim())
<span class="linenr"> 1664: </span>
<span class="linenr"> 1665: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">state</span> = MemberExpLexState.inMemberExp
<span class="linenr"> 1666: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">stateStack</span> = []
<span class="linenr"> 1667: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">currentOpenBracketCount</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 1668: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">currentOpenParensCount</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 1669: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">currentStringType</span> = <span class=
"org-constant">null</span>
<span class="linenr"> 1670: </span>
<span class="linenr"> 1671: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; path.length; i++) {
<span class="linenr"> 1672: </span>    <span class=
"org-keyword">const</span> <span class=
"org-type">char</span> = path.charAt(i)
<span class="linenr"> 1673: </span>    <span class=
"org-keyword">switch</span> (state) {
<span class="linenr"> 1674: </span>      <span class=
"org-keyword">case</span> MemberExpLexState.inMemberExp:
<span class="linenr"> 1675: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class="org-string">'['</span>) {
<span class="linenr"> 1676: </span>          stateStack.push(state)
<span class=
"linenr"> 1677: </span>          state = MemberExpLexState.inBrackets
<span class=
"linenr"> 1678: </span>          currentOpenBracketCount++
<span class="linenr"> 1679: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class="org-string">'('</span>) {
<span class="linenr"> 1680: </span>          stateStack.push(state)
<span class=
"linenr"> 1681: </span>          state = MemberExpLexState.inParens
<span class=
"linenr"> 1682: </span>          currentOpenParensCount++
<span class="linenr"> 1683: </span>        } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class="linenr"> 1684: </span>          !(i === <span class=
"org-highlight-numbers-number">0</span> ? validFirstIdentCharRE : validIdentCharRE).test(<span class="org-type">char</span>)
<span class="linenr"> 1685: </span>        ) {
<span class="linenr"> 1686: </span>          <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1687: </span>        }
<span class="linenr"> 1688: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 1689: </span>      <span class=
"org-keyword">case</span> MemberExpLexState.inBrackets:
<span class="linenr"> 1690: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class=
"org-string">`'`</span> || <span class=
"org-type">char</span> === <span class=
"org-string">`"`</span> || <span class=
"org-type">char</span> === <span class="org-string">'`'</span>) {
<span class="linenr"> 1691: </span>          stateStack.push(state)
<span class=
"linenr"> 1692: </span>          state = MemberExpLexState.inString
<span class=
"linenr"> 1693: </span>          currentStringType = <span class=
"org-type">char</span>
<span class="linenr"> 1694: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class="org-string">`[`</span>) {
<span class=
"linenr"> 1695: </span>          currentOpenBracketCount++
<span class="linenr"> 1696: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class="org-string">`]`</span>) {
<span class="linenr"> 1697: </span>          <span class=
"org-keyword">if</span> (!--currentOpenBracketCount) {
<span class=
"linenr"> 1698: </span>            state = stateStack.pop()
<span class="linenr"> 1699: </span>          }
<span class="linenr"> 1700: </span>        }
<span class="linenr"> 1701: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 1702: </span>      <span class=
"org-keyword">case</span> MemberExpLexState.inParens:
<span class="linenr"> 1703: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class=
"org-string">`'`</span> || <span class=
"org-type">char</span> === <span class=
"org-string">`"`</span> || <span class=
"org-type">char</span> === <span class="org-string">'`'</span>) {
<span class="linenr"> 1704: </span>          stateStack.push(state)
<span class=
"linenr"> 1705: </span>          state = MemberExpLexState.inString
<span class=
"linenr"> 1706: </span>          currentStringType = <span class=
"org-type">char</span>
<span class="linenr"> 1707: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class="org-string">`(`</span>) {
<span class=
"linenr"> 1708: </span>          currentOpenParensCount++
<span class="linenr"> 1709: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class="org-string">`)`</span>) {
<span class="linenr"> 1710: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if the exp ends as a call then it should not be considered valid</span>
<span class="linenr"> 1711: </span>          <span class=
"org-keyword">if</span> (i === path.length - <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 1712: </span>            <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1713: </span>          }
<span class="linenr"> 1714: </span>          <span class=
"org-keyword">if</span> (!--currentOpenParensCount) {
<span class=
"linenr"> 1715: </span>            state = stateStack.pop()
<span class="linenr"> 1716: </span>          }
<span class="linenr"> 1717: </span>        }
<span class="linenr"> 1718: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 1719: </span>      <span class=
"org-keyword">case</span> MemberExpLexState.inString:
<span class="linenr"> 1720: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === currentStringType) {
<span class=
"linenr"> 1721: </span>          state = stateStack.pop()
<span class=
"linenr"> 1722: </span>          currentStringType = <span class=
"org-constant">null</span>
<span class="linenr"> 1723: </span>        }
<span class="linenr"> 1724: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 1725: </span>    }
<span class="linenr"> 1726: </span>  }
<span class="linenr"> 1727: </span>  <span class=
"org-keyword">return</span> !currentOpenBracketCount &amp;& !currentOpenParensCount
<span class="linenr"> 1728: </span>}
<span class="linenr"> 1729: </span>
<span class="linenr"> 1730: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isMemberExpressionNode</span> = __BROWSER__
<span class="linenr"> 1731: </span>  ? NOOP
<span class="linenr"> 1732: </span>  : (path, context) =&gt; {
<span class="linenr"> 1733: </span>      <span class=
"org-keyword">try</span> {
<span class="linenr"> 1734: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">ret</span> = babelParser.parseExpression(path, {
<span class=
"linenr"> 1735: </span>          plugins: context.expressionPlugins
<span class="linenr"> 1736: </span>        })
<span class="linenr"> 1737: </span>        <span class=
"org-keyword">if</span> (ret.type === <span class=
"org-string">'TSAsExpression'</span> || ret.type === <span class=
"org-string">'TSTypeAssertion'</span>) {
<span class="linenr"> 1738: </span>          ret = ret.expression
<span class="linenr"> 1739: </span>        }
<span class="linenr"> 1740: </span>        <span class=
"org-keyword">return</span> (
<span class=
"linenr"> 1741: </span>          ret.type === <span class=
"org-string">'MemberExpression'</span> ||
<span class=
"linenr"> 1742: </span>          ret.type === <span class=
"org-string">'OptionalMemberExpression'</span> ||
<span class=
"linenr"> 1743: </span>          ret.type === <span class=
"org-string">'Identifier'</span>
<span class="linenr"> 1744: </span>        )
<span class="linenr"> 1745: </span>      } <span class=
"org-keyword">catch</span> (e) {
<span class="linenr"> 1746: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1747: </span>      }
<span class="linenr"> 1748: </span>    }
<span class="linenr"> 1749: </span>
<span class="linenr"> 1750: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isMemberExpression</span> = __BROWSER__
<span class="linenr"> 1751: </span>  ? isMemberExpressionBrowser
<span class="linenr"> 1752: </span>  : isMemberExpressionNode
<span class="linenr"> 1753: </span>
<span class="linenr"> 1754: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Check if a node contains expressions that reference current context scope ids</span>
<span class="linenr"> 1755: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">hasScopeRef</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">ids</span>) {
<span class="linenr"> 1756: </span>  <span class=
"org-keyword">if</span> (!node || Object.keys(ids).length === <span class="org-highlight-numbers-number">0</span>) {
<span class="linenr"> 1757: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1758: </span>  }
<span class="linenr"> 1759: </span>  <span class=
"org-keyword">switch</span> (node.type) {
<span class="linenr"> 1760: </span>    <span class=
"org-keyword">case</span> NodeTypes.ELEMENT:
<span class="linenr"> 1761: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr"> 1762: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = node.props[i]
<span class="linenr"> 1763: </span>        <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 1764: </span>          p.type === NodeTypes.DIRECTIVE &amp;&
<span class=
"linenr"> 1765: </span>          (hasScopeRef(p.arg, ids) || hasScopeRef(p.exp, ids))
<span class="linenr"> 1766: </span>        ) {
<span class="linenr"> 1767: </span>          <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1768: </span>        }
<span class="linenr"> 1769: </span>      }
<span class="linenr"> 1770: </span>      <span class=
"org-keyword">return</span> node.children.some(c =&gt; hasScopeRef(c, ids))
<span class="linenr"> 1771: </span>    <span class=
"org-keyword">case</span> NodeTypes.FOR:
<span class="linenr"> 1772: </span>      <span class=
"org-keyword">if</span> (hasScopeRef(node.source, ids)) {
<span class="linenr"> 1773: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1774: </span>      }
<span class="linenr"> 1775: </span>      <span class=
"org-keyword">return</span> node.children.some(c =&gt; hasScopeRef(c, ids))
<span class="linenr"> 1776: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF:
<span class="linenr"> 1777: </span>      <span class=
"org-keyword">return</span> node.branches.some(b =&gt; hasScopeRef(b, ids))
<span class="linenr"> 1778: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF_BRANCH:
<span class="linenr"> 1779: </span>      <span class=
"org-keyword">if</span> (hasScopeRef(node.condition, ids)) {
<span class="linenr"> 1780: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1781: </span>      }
<span class="linenr"> 1782: </span>      <span class=
"org-keyword">return</span> node.children.some(c =&gt; hasScopeRef(c, ids))
<span class="linenr"> 1783: </span>    <span class=
"org-keyword">case</span> NodeTypes.SIMPLE_EXPRESSION:
<span class="linenr"> 1784: </span>      <span class=
"org-keyword">return</span> (
<span class="linenr"> 1785: </span>        !node.isStatic &amp;&
<span class=
"linenr"> 1786: </span>        isSimpleIdentifier(node.content) &amp;&
<span class="linenr"> 1787: </span>        !!ids[node.content]
<span class="linenr"> 1788: </span>      )
<span class="linenr"> 1789: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMPOUND_EXPRESSION:
<span class="linenr"> 1790: </span>      <span class=
"org-keyword">return</span> node.children.some(c =&gt; isObject(c) &amp;& hasScopeRef(c, ids))
<span class="linenr"> 1791: </span>    <span class=
"org-keyword">case</span> NodeTypes.INTERPOLATION:
<span class="linenr"> 1792: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT_CALL:
<span class="linenr"> 1793: </span>      <span class=
"org-keyword">return</span> hasScopeRef(node.content, ids)
<span class="linenr"> 1794: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT:
<span class="linenr"> 1795: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMMENT:
<span class="linenr"> 1796: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1797: </span>    <span class=
"org-keyword">default</span>:
<span class="linenr"> 1798: </span>      <span class=
"org-keyword">if</span> (__DEV__) {
<span class="linenr"> 1799: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exhaustiveCheck</span> = node
<span class="linenr"> 1800: </span>        exhaustiveCheck
<span class="linenr"> 1801: </span>      }
<span class="linenr"> 1802: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1803: </span>  }
<span class="linenr"> 1804: </span>}
<span class="linenr"> 1805: </span>
<span class="linenr"> 1806: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">SlotFlags</span> = {
<span class="linenr"> 1807: </span>  <span class=
"org-doc">/**</span>
<span class="linenr"> 1808: </span><span class=
"org-doc">   * Stable slots that only reference slot props or context state. The slot</span>
<span class="linenr"> 1809: </span><span class=
"org-doc">   * can fully capture its own dependencies so when passed down the parent won't</span>
<span class="linenr"> 1810: </span><span class=
"org-doc">   * need to force the child to update.</span>
<span class="linenr"> 1811: </span><span class=
"org-doc">   */</span>
<span class="linenr"> 1812: </span>  STABLE: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr"> 1813: </span>  <span class=
"org-doc">/**</span>
<span class="linenr"> 1814: </span><span class=
"org-doc">   * Slots that reference scope variables (v-for or an outer slot prop), or</span>
<span class="linenr"> 1815: </span><span class=
"org-doc">   * has conditional structure (v-if, v-for). The parent will need to force</span>
<span class="linenr"> 1816: </span><span class=
"org-doc">   * the child to update because the slot does not fully capture its dependencies.</span>
<span class="linenr"> 1817: </span><span class=
"org-doc">   */</span>
<span class="linenr"> 1818: </span>  DYNAMIC: <span class=
"org-highlight-numbers-number">2</span>,
<span class="linenr"> 1819: </span>  <span class=
"org-doc">/**</span>
<span class="linenr"> 1820: </span><span class=
"org-doc">   * `&lt;slot/&gt;` being forwarded into a child component. Whether the parent needs</span>
<span class="linenr"> 1821: </span><span class=
"org-doc">   * to update the child is dependent on what kind of slots the parent itself</span>
<span class="linenr"> 1822: </span><span class=
"org-doc">   * received. This has to be refined at runtime, when the child's vnode</span>
<span class="linenr"> 1823: </span><span class=
"org-doc">   * is being created (in `normalizeChildren`)</span>
<span class="linenr"> 1824: </span><span class=
"org-doc">   */</span>
<span class="linenr"> 1825: </span>  FORWARDED: <span class=
"org-highlight-numbers-number">3</span>
<span class="linenr"> 1826: </span>}
<span class="linenr"> 1827: </span>
<span class="linenr"> 1828: </span><span class="org-doc">/**</span>
<span class="linenr"> 1829: </span><span class=
"org-doc"> * Dev only</span>
<span class="linenr"> 1830: </span><span class="org-doc"> */</span>
<span class="linenr"> 1831: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotFlagsText</span> = {
<span class=
"linenr"> 1832: </span>  [SlotFlags.STABLE]: <span class=
"org-string">'STABLE'</span>,
<span class=
"linenr"> 1833: </span>  [SlotFlags.DYNAMIC]: <span class=
"org-string">'DYNAMIC'</span>,
<span class=
"linenr"> 1834: </span>  [SlotFlags.FORWARDED]: <span class=
"org-string">'FORWARDED'</span>
<span class="linenr"> 1835: </span>}
<span class="linenr"> 1836: </span>
<span class="linenr"> 1837: </span>
<span class="linenr"> 1838: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createElementWithCodegen</span>(
<span class="linenr"> 1839: </span>  <span class=
"org-variable-name">tag</span>,
<span class="linenr"> 1840: </span>  <span class=
"org-variable-name">props</span>,
<span class="linenr"> 1841: </span>  <span class=
"org-variable-name">children</span>,
<span class="linenr"> 1842: </span>  <span class=
"org-variable-name">patchFlag</span>,
<span class="linenr"> 1843: </span>  dynamicProps
<span class="linenr"> 1844: </span>) {
<span class="linenr"> 1845: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 1846: </span>    type: NodeTypes.ELEMENT,
<span class="linenr"> 1847: </span>    loc: locStub,
<span class="linenr"> 1848: </span>    ns: Namespaces.HTML,
<span class="linenr"> 1849: </span>    tag: <span class=
"org-string">'div'</span>,
<span class=
"linenr"> 1850: </span>    tagType: ElementTypes.ELEMENT,
<span class="linenr"> 1851: </span>    isSelfClosing: <span class=
"org-constant">false</span>,
<span class="linenr"> 1852: </span>    props: [],
<span class="linenr"> 1853: </span>    children: [],
<span class="linenr"> 1854: </span>    codegenNode: {
<span class=
"linenr"> 1855: </span>      type: NodeTypes.VNODE_CALL,
<span class="linenr"> 1856: </span>      tag,
<span class="linenr"> 1857: </span>      props,
<span class="linenr"> 1858: </span>      children,
<span class="linenr"> 1859: </span>      patchFlag,
<span class="linenr"> 1860: </span>      dynamicProps,
<span class="linenr"> 1861: </span>      directives: <span class=
"org-constant">undefined</span>,
<span class="linenr"> 1862: </span>      isBlock: <span class=
"org-constant">false</span>,
<span class=
"linenr"> 1863: </span>      disableTracking: <span class=
"org-constant">false</span>,
<span class="linenr"> 1864: </span>      isComponent: <span class=
"org-constant">false</span>,
<span class="linenr"> 1865: </span>      loc: locStub
<span class="linenr"> 1866: </span>    }
<span class="linenr"> 1867: </span>  }
<span class="linenr"> 1868: </span>}
<span class="linenr"> 1869: </span>
<span class="linenr"> 1870: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createParserContext</span>(<span class=
"org-variable-name">content</span>, <span class=
"org-variable-name">rawOptions</span>) {
<span class="linenr"> 1871: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">options</span> = extend({}, defaultParserOptions)
<span class="linenr"> 1872: </span>
<span class="linenr"> 1873: </span>  <span class=
"org-keyword">let</span> <span class="org-variable-name">key</span>
<span class="linenr"> 1874: </span>  <span class=
"org-keyword">for</span> (key <span class=
"org-keyword">in</span> rawOptions) {
<span class="linenr"> 1875: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">@ts-ignore</span>
<span class="linenr"> 1876: </span>    options[key] =
<span class=
"linenr"> 1877: </span>      rawOptions[key] === <span class=
"org-constant">undefined</span>
<span class=
"linenr"> 1878: </span>        ? defaultParserOptions[key]
<span class="linenr"> 1879: </span>        : rawOptions[key]
<span class="linenr"> 1880: </span>  }
<span class="linenr"> 1881: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 1882: </span>    options,
<span class="linenr"> 1883: </span>    column: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr"> 1884: </span>    line: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr"> 1885: </span>    offset: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 1886: </span>    originalSource: content,
<span class="linenr"> 1887: </span>    source: content,
<span class="linenr"> 1888: </span>    inPre: <span class=
"org-constant">false</span>,
<span class="linenr"> 1889: </span>    inVPre: <span class=
"org-constant">false</span>,
<span class="linenr"> 1890: </span>    onWarn: options.onWarn
<span class="linenr"> 1891: </span>  }
<span class="linenr"> 1892: </span>}
<span class="linenr"> 1893: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createRoot</span>(<span class=
"org-variable-name">children</span>, <span class=
"org-variable-name">loc</span> = <span class=
"org-variable-name">locStub</span>) {
<span class="linenr"> 1894: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 1895: </span>    type: NodeTypes.ROOT,
<span class="linenr"> 1896: </span>    children,
<span class="linenr"> 1897: </span>    helpers: [],
<span class="linenr"> 1898: </span>    components: [],
<span class="linenr"> 1899: </span>    directives: [],
<span class="linenr"> 1900: </span>    hoists: [],
<span class="linenr"> 1901: </span>    imports: [],
<span class="linenr"> 1902: </span>    cached: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 1903: </span>    temps: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 1904: </span>    codegenNode: <span class=
"org-constant">undefined</span>,
<span class="linenr"> 1905: </span>    loc
<span class="linenr"> 1906: </span>  }
<span class="linenr"> 1907: </span>}
<span class="linenr"> 1908: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseChildren</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">mode</span>, <span class=
"org-variable-name">ancestors</span>) {
<span class="linenr"> 1909: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parent</span> = last(ancestors)
<span class="linenr"> 1910: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ns</span> = parent ? parent.ns : Namespaces.HTML
<span class="linenr"> 1911: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">nodes</span> = [] <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">-&gt; ancestors</span>
<span class="linenr"> 1912: </span>
<span class="linenr"> 1913: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. while -&gt; isEnd ? 游标不断往前走直接所以 source 都解析完成</span>
<span class="linenr"> 1914: </span>  <span class=
"org-keyword">while</span> (!isEnd(context, mode, ancestors)) {
<span class="linenr"> 1915: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">s</span> = context.source
<span class="linenr"> 1916: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">node</span> = <span class=
"org-constant">undefined</span>
<span class="linenr"> 1917: </span>
<span class="linenr"> 1918: </span>    <span class=
"org-keyword">if</span> (mode === TextModes.DATA || mode === TextModes.RCDATA) {
<span class="linenr"> 1919: </span>      <span class=
"org-keyword">if</span> (!context.inVPre &amp;& startsWith(s, context.options.delimiters[<span class="org-highlight-numbers-number">0</span>])) {
<span class="linenr"> 1920: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">'{{' 插值开始</span>
<span class=
"linenr"> 1921: </span>        node = parseInterpolation(context, mode)
<span class="linenr"> 1922: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (mode === TextModes.DATA &amp;& s[<span class="org-highlight-numbers-number">0</span>] === <span class="org-string">'&lt;'</span>) {
<span class="linenr"> 1923: </span>        <span class=
"org-keyword">if</span> (s[<span class=
"org-highlight-numbers-number">1</span>] === <span class=
"org-string">'/'</span>) {
<span class="linenr"> 1924: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">结束标签</span>
<span class="linenr"> 1925: </span>          <span class=
"org-keyword">if</span> (<span class=
"org-string">/[a-z]/</span>i.test(s[<span class=
"org-highlight-numbers-number">2</span>])) {
<span class="linenr"> 1926: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">异常结束，如：`&lt;div&gt;some text&lt;a`</span>
<span class=
"linenr"> 1927: </span>            emitError(context, <span class=
"org-string">'X_INVALID_END_TAG'</span>)
<span class=
"linenr"> 1928: </span>            parseTag(context, TagType.End, parent)
<span class="linenr"> 1929: </span>            <span class=
"org-keyword">continue</span>
<span class="linenr"> 1930: </span>          }
<span class="linenr"> 1931: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-string">/[a-z]/</span>i.test(s[<span class=
"org-highlight-numbers-number">1</span>])) {
<span class="linenr"> 1932: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">正常的开始标签</span>
<span class=
"linenr"> 1933: </span>          node = parseElement(context, ancestors)
<span class="linenr"> 1934: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2.x &lt;template&gt; 无指令兼容，这里就不实现了，重点关注 3.x 的代码</span>
<span class="linenr"> 1935: </span>        }
<span class="linenr"> 1936: </span>      }
<span class="linenr"> 1937: </span>    }
<span class="linenr"> 1938: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">以上都不是，说明应该是纯文本节点</span>
<span class="linenr"> 1939: </span>    <span class=
"org-keyword">if</span> (!node) {
<span class=
"linenr"> 1940: </span>      node = parseText(context, mode)
<span class="linenr"> 1941: </span>    }
<span class="linenr"> 1942: </span>
<span class="linenr"> 1943: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">用 pushNode 在其中合并相邻的文本节点</span>
<span class="linenr"> 1944: </span>    <span class=
"org-keyword">if</span> (isArray(node)) {
<span class="linenr"> 1945: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.length; i++) {
<span class="linenr"> 1946: </span>        pushNode(nodes, node[i])
<span class="linenr"> 1947: </span>      }
<span class="linenr"> 1948: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 1949: </span>      pushNode(nodes, node)
<span class="linenr"> 1950: </span>    }
<span class="linenr"> 1951: </span>  }
<span class="linenr"> 1952: </span>
<span class="linenr"> 1953: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. 合并相邻文本节点，空格处理，会将多个空格合并成一个空格</span>
<span class="linenr"> 1954: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">removedWhitespace</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 1955: </span>  <span class=
"org-keyword">if</span> (mode !== TextModes.RAWTEXT &amp;& mode !== TextModes.RCDATA) {
<span class=
"linenr"> 1956: </span>    removedWhitespace = _removeWhitespace(nodes, context)
<span class="linenr"> 1957: </span>  }
<span class="linenr"> 1958: </span>
<span class="linenr"> 1959: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">3. 最后返回解析后的节点树</span>
<span class="linenr"> 1960: </span>  <span class=
"org-keyword">return</span> removedWhitespace ? nodes.filter(Boolean) : nodes
<span class="linenr"> 1961: </span>}
<span class="linenr"> 1962: </span>
<span class="linenr"> 1963: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">_removeWhitespace</span>(<span class=
"org-variable-name">nodes</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 1964: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">removedWhitespace</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 1965: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">可以通过选项来指定是不是保留空格，否则多余的会合并成一个</span>
<span class="linenr"> 1966: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">shouldCondense</span> = context.options.whitespace !== <span class="org-string">'preserve'</span>
<span class="linenr"> 1967: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; nodes.length; i++) {
<span class="linenr"> 1968: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> = nodes[i]
<span class="linenr"> 1969: </span>    <span class=
"org-keyword">if</span> (!context.inPre &amp;& node.type === NodeTypes.TEXT) {
<span class="linenr"> 1970: </span>      <span class=
"org-keyword">if</span> (!<span class=
"org-string">/[^\t\r\n\f]/</span>.test(node.content)) {
<span class="linenr"> 1971: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prev</span> = nodes[i - <span class=
"org-highlight-numbers-number">1</span>]
<span class="linenr"> 1972: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">next</span> = nodes[i + <span class=
"org-highlight-numbers-number">1</span>]
<span class="linenr"> 1973: </span>
<span class="linenr"> 1974: </span>        <span class=
"org-keyword">if</span> (
<span class="linenr"> 1975: </span>          !prev ||
<span class="linenr"> 1976: </span>            !next ||
<span class=
"linenr"> 1977: </span>            (shouldCondense &amp;& (
<span class=
"linenr"> 1978: </span>              prev.type === NodeTypes.COMMENT || next.type === NodeTypes.COMMENT || (
<span class=
"linenr"> 1979: </span>                prev.type === NodeTypes.ELEMENT &amp;& next.type === NodeTypes.ELEMENT &amp;& <span class="org-string">/[\r\n]/</span>.test(node.content)
<span class="linenr"> 1980: </span>              )
<span class="linenr"> 1981: </span>            ))
<span class="linenr"> 1982: </span>        ) {
<span class=
"linenr"> 1983: </span>          removedWhitespace = <span class=
"org-constant">true</span>
<span class=
"linenr"> 1984: </span>          nodes[i] = <span class="org-constant">null</span>
<span class="linenr"> 1985: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr"> 1986: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">合并成一个</span>
<span class=
"linenr"> 1987: </span>          node.content = <span class=
"org-string">' '</span>
<span class="linenr"> 1988: </span>        }
<span class="linenr"> 1989: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (shouldCondense) {
<span class="linenr"> 1990: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">保留空格</span>
<span class=
"linenr"> 1991: </span>        node.content = node.content.replace(<span class="org-string">/[\t\r\n\f]+/</span>g, <span class="org-string">' '</span>)
<span class="linenr"> 1992: </span>      }
<span class="linenr"> 1993: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === NodeTypes.COMMENT &amp;& !context.options.comments) {
<span class="linenr"> 1994: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">可以通过配置删除注释节点</span>
<span class=
"linenr"> 1995: </span>      removedWhitespace = <span class=
"org-constant">true</span>
<span class="linenr"> 1996: </span>      nodes[i] = <span class=
"org-constant">null</span>
<span class="linenr"> 1997: </span>    }
<span class="linenr"> 1998: </span>  }
<span class="linenr"> 1999: </span>
<span class="linenr"> 2000: </span>  <span class=
"org-keyword">if</span> (context.inPre &amp;& parent &amp;& context.options.isPreTag(parent.tag)) {
<span class="linenr"> 2001: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">删除 &lt;pre&gt; 中的第一行的空行</span>
<span class="linenr"> 2002: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">first</span> = nodes[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 2003: </span>    <span class=
"org-keyword">if</span> (first &amp;& first.type === NodeTypes.TEXT) {
<span class=
"linenr"> 2004: </span>      first.content = first.content.replace(<span class="org-string">/^\r?\n/</span>, <span class="org-string">''</span>)
<span class="linenr"> 2005: </span>    }
<span class="linenr"> 2006: </span>  }
<span class="linenr"> 2007: </span>
<span class="linenr"> 2008: </span>  <span class=
"org-keyword">return</span> removedWhitespace
<span class="linenr"> 2009: </span>}
<span class="linenr"> 2010: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseElement</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">ancestors</span>) {
<span class="linenr"> 2011: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parent</span> = last(ancestors)
<span class="linenr"> 2012: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. 解析出开始标签</span>
<span class="linenr"> 2013: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">element</span> = parseTag(context, TagType.Start, parent)
<span class="linenr"> 2014: </span>
<span class="linenr"> 2015: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">自闭合的标签： &lt;div/&gt;</span>
<span class="linenr"> 2016: </span>  <span class=
"org-keyword">if</span> (element.isSelfClosing || context.options.isVoidTag(element.tag)) {
<span class="linenr"> 2017: </span>    <span class=
"org-keyword">return</span> element
<span class="linenr"> 2018: </span>  }
<span class="linenr"> 2019: </span>
<span class="linenr"> 2020: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">children</span>
<span class="linenr"> 2021: </span>  ancestors.push(element)
<span class="linenr"> 2022: </span>
<span class="linenr"> 2023: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">mode</span> = context.options.getTextMode(element, parent)
<span class="linenr"> 2024: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">递归解析子节点</span>
<span class="linenr"> 2025: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">children</span> = parseChildren(context, mode, ancestors)
<span class="linenr"> 2026: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">解析完出栈 [root, parent1, parent2, ...] 代表层级</span>
<span class="linenr"> 2027: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;root&gt;&lt;parent1&gt;&lt;parent2&gt;&lt;/parent&gt;&lt;parent1&gt;&lt;/root&gt; -&gt; 解析过程中通过</span>
<span class="linenr"> 2028: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">ancestors 来维护这个层级关系</span>
<span class="linenr"> 2029: </span>  ancestors.pop()
<span class="linenr"> 2030: </span>
<span class="linenr"> 2031: </span>  element.children = children
<span class="linenr"> 2032: </span>
<span class="linenr"> 2033: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. 解析结束标签</span>
<span class="linenr"> 2034: </span>  <span class=
"org-keyword">if</span> (startsWithEndTagOpen(context.source, element.tag)) {
<span class=
"linenr"> 2035: </span>    parseTag(context, TagType.End, parent)
<span class="linenr"> 2036: </span>  }
<span class="linenr"> 2037: </span>
<span class="linenr"> 2038: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">更新解析后节点在源码中的位置信息</span>
<span class=
"linenr"> 2039: </span>  element.loc = getSelection(context, element.loc.start)
<span class="linenr"> 2040: </span>
<span class="linenr"> 2041: </span>  <span class=
"org-keyword">return</span> element
<span class="linenr"> 2042: </span>}
<span class="linenr"> 2043: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseTag</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">type</span>, <span class=
"org-variable-name">parent</span>) {
<span class="linenr"> 2044: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. 开始标签</span>
<span class="linenr"> 2045: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = getCursor(context)
<span class="linenr"> 2046: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">合法标签的正则匹配</span>
<span class="linenr"> 2047: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">match</span> = <span class=
"org-string">/^&lt;\/?([a-z][^\t\r\n\f /&gt;]*)/</span>i.exec(context.source)
<span class="linenr"> 2048: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">tag</span> = match[<span class=
"org-highlight-numbers-number">1</span>]
<span class="linenr"> 2049: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ns</span> = context.options.getNamespace(tag, parent)
<span class="linenr"> 2050: </span>
<span class="linenr"> 2051: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">游标前进标签名长度的位置，如： &lt;div id="foo"&gt; -&gt; ` id="foo"&gt;`</span>
<span class=
"linenr"> 2052: </span>  advanceBy(context, match[<span class=
"org-highlight-numbers-number">0</span>].length)
<span class="linenr"> 2053: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">空格处理</span>
<span class="linenr"> 2054: </span>  advanceSpaces(context)
<span class="linenr"> 2055: </span>
<span class="linenr"> 2056: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">parse attributes</span>
<span class="linenr"> 2057: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">props</span> = parseAttributes(context, type)
<span class="linenr"> 2058: </span>
<span class="linenr"> 2059: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO</span></span></span><span class=
"org-comment"> v-pre 检测</span>
<span class="linenr"> 2060: </span>
<span class="linenr"> 2061: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. 闭合标签</span>
<span class="linenr"> 2062: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">isSelfClosing</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 2063: </span>  <span class=
"org-keyword">if</span> (context.source.length === <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 2064: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">非法情况, ignore</span>
<span class="linenr"> 2065: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 2066: </span>    isSelfClosing = startsWith(context.source, <span class="org-string">'/&gt;'</span>)
<span class=
"linenr"> 2067: </span>    advanceBy(context, isSelfClosing ? <span class="org-highlight-numbers-number">2</span> : <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 2068: </span>  }
<span class="linenr"> 2069: </span>
<span class="linenr"> 2070: </span>  <span class=
"org-keyword">if</span> (type === TagType.End) {
<span class="linenr"> 2071: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 2072: </span>  }
<span class="linenr"> 2073: </span>
<span class="linenr"> 2074: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">3. 分析出标签的类型</span>
<span class="linenr"> 2075: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">tagType</span> = ElementTypes.ELEMENT
<span class="linenr"> 2076: </span>  <span class=
"org-keyword">if</span> (!context.inVPre) {
<span class="linenr"> 2077: </span>    <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'slot'</span>) {
<span class=
"linenr"> 2078: </span>      tagType = ElementTypes.SLOT
<span class="linenr"> 2079: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'template'</span>) {
<span class="linenr"> 2080: </span>      <span class=
"org-keyword">if</span> (props.some(p =&gt; p.type === NodeTypes.DIRECTIVE &amp;& isSpecialTemplateDirective(p.name))) {
<span class=
"linenr"> 2081: </span>        tagType = ElementTypes.TEMPLATE
<span class="linenr"> 2082: </span>      }
<span class="linenr"> 2083: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isComponent(tag, props, context)) {
<span class=
"linenr"> 2084: </span>      tagType = ElementTypes.COMPONENT
<span class="linenr"> 2085: </span>    }
<span class="linenr"> 2086: </span>  }
<span class="linenr"> 2087: </span>
<span class="linenr"> 2088: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 2089: </span>    type: NodeTypes.ELEMENT,
<span class="linenr"> 2090: </span>    ns,
<span class="linenr"> 2091: </span>    tag,
<span class="linenr"> 2092: </span>    tagType,
<span class="linenr"> 2093: </span>    props,
<span class="linenr"> 2094: </span>    isSelfClosing,
<span class="linenr"> 2095: </span>    children: [],
<span class=
"linenr"> 2096: </span>    loc: getSelection(context, start),
<span class="linenr"> 2097: </span>    codegenNode: <span class=
"org-constant">undefined</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">在 transform 阶段生成的产物</span>
<span class="linenr"> 2098: </span>  }
<span class="linenr"> 2099: </span>}
<span class="linenr"> 2100: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseText</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">mode</span>) {
<span class="linenr"> 2101: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">endTokens</span> = mode === TextModes.CDATA ? [<span class="org-string">']]&gt;'</span>] : [<span class="org-string">'&lt;'</span>, context.options.delimiters[<span class="org-highlight-numbers-number">0</span>]]
<span class="linenr"> 2102: </span>
<span class="linenr"> 2103: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">endIndex</span> = context.source.length
<span class="linenr"> 2104: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; endTokens.length; i++) {
<span class="linenr"> 2105: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">index</span> = context.source.indexOf(endTokens[i], <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 2106: </span>    <span class=
"org-keyword">if</span> (index !== -<span class=
"org-highlight-numbers-number">1</span> &amp;& endIndex &gt; index) {
<span class="linenr"> 2107: </span>      endIndex = index
<span class="linenr"> 2108: </span>    }
<span class="linenr"> 2109: </span>  }
<span class="linenr"> 2110: </span>
<span class="linenr"> 2111: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = getCursor(context)
<span class="linenr"> 2112: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">content</span> = parseTextData(context, endIndex, mode)
<span class="linenr"> 2113: </span>
<span class="linenr"> 2114: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 2115: </span>    type: NodeTypes.TEXT,
<span class="linenr"> 2116: </span>    content,
<span class=
"linenr"> 2117: </span>    loc: getSelection(context, start)
<span class="linenr"> 2118: </span>  }
<span class="linenr"> 2119: </span>}
<span class="linenr"> 2120: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseTextData</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">length</span>, <span class=
"org-variable-name">mode</span>) {
<span class="linenr"> 2121: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rawText</span> = context.source.slice(<span class="org-highlight-numbers-number">0</span>, length)
<span class="linenr"> 2122: </span>  advanceBy(context, length)
<span class="linenr"> 2123: </span>
<span class="linenr"> 2124: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">不含HTML entities</span>
<span class="linenr"> 2125: </span>  <span class=
"org-keyword">if</span> (mode === TextModes.RAWTEXT || mode === TextModes.CDATA || !rawText.includes(<span class="org-string">'&amp;'</span>)) {
<span class="linenr"> 2126: </span>    <span class=
"org-keyword">return</span> rawText
<span class="linenr"> 2127: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2128: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">将 &amp;gt; -&gt; `&gt;`, &amp;lt; -&gt; `&lt;`, &amp;amp; -&gt; `&amp;`, &amp;apos; -&gt; `'`, &amp;quot; -&gt; `"`</span>
<span class="linenr"> 2129: </span>    <span class=
"org-keyword">return</span> context.options.decodeEntities(rawText, mode === TextModes.ATTRIBUTE_VALUE)
<span class="linenr"> 2130: </span>  }
<span class="linenr"> 2131: </span>}
<span class="linenr"> 2132: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseInterpolation</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">mode</span>) {
<span class="linenr"> 2133: </span>  <span class=
"org-keyword">const</span> [<span class=
"org-variable-name">open</span>, <span class=
"org-variable-name">close</span>] = context.options.delimiters
<span class="linenr"> 2134: </span>
<span class="linenr"> 2135: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">如： source = "{{ a + b }}"</span>
<span class="linenr"> 2136: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">closeIndex = indexOf("}}", "{{".length) = 9</span>
<span class="linenr"> 2137: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">closeIndex</span> = context.source.indexOf(close, open.length)
<span class="linenr"> 2138: </span>  <span class=
"org-keyword">if</span> (closeIndex === -<span class=
"org-highlight-numbers-number">1</span>) {
<span class=
"linenr"> 2139: </span>    emitError(context, <span class=
"org-string">'X_MISSING_INTERPOLATION_END'</span>)
<span class="linenr"> 2140: </span>    <span class=
"org-keyword">return</span> <span class=
"org-constant">undefined</span>
<span class="linenr"> 2141: </span>  }
<span class="linenr"> 2142: </span>
<span class="linenr"> 2143: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = getCursor(context)
<span class="linenr"> 2144: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&gt;&gt; 2 -&gt; " a + b }}"</span>
<span class=
"linenr"> 2145: </span>  advanceBy(context, open.length)
<span class="linenr"> 2146: </span>
<span class="linenr"> 2147: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">{ line, column, offset }</span>
<span class="linenr"> 2148: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">innerStart</span> = getCursor(context)
<span class="linenr"> 2149: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">innerEnd</span> = getCursor(context)
<span class="linenr"> 2150: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">9 - '{{'.length = 7</span>
<span class="linenr"> 2151: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rawContentLength</span> = closeIndex - open.length
<span class="linenr"> 2152: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">" a + b }}".slice(0, 7) =&gt; " a + b "</span>
<span class="linenr"> 2153: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rawContent</span> = context.source.slice(<span class="org-highlight-numbers-number">0</span>, rawContentLength)
<span class="linenr"> 2154: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">preTrimContent</span> = parseTextData(context, rawContentLength, mode)
<span class="linenr"> 2155: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">" a + b " =&gt; "a + b"</span>
<span class="linenr"> 2156: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">content</span> = preTrimContent.trim()
<span class="linenr"> 2157: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">startOffset</span> = preTrimContent.indexOf(content)
<span class="linenr"> 2158: </span>  <span class=
"org-keyword">if</span> (startOffset &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 2159: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">处理换行问题</span>
<span class=
"linenr"> 2160: </span>    advancePositionWithMutation(innerStart, rawContent, startOffset)
<span class="linenr"> 2161: </span>  }
<span class="linenr"> 2162: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">endOffset</span> = rawContentLength - (preTrimContent.length - content.length - startOffset)
<span class=
"linenr"> 2163: </span>  advancePositionWithMutation(innerEnd, rawContent, endOffset)
<span class=
"linenr"> 2164: </span>  advanceBy(context, close.length)
<span class="linenr"> 2165: </span>
<span class="linenr"> 2166: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 2167: </span>    type: NodeTypes.INTERPOLATION,
<span class="linenr"> 2168: </span>    content: {
<span class=
"linenr"> 2169: </span>      type: NodeTypes.SIMPLE_EXPRESSION,
<span class="linenr"> 2170: </span>      isStatic: <span class=
"org-constant">false</span>,
<span class="linenr"> 2171: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Set `isConstant` to false by default and will decide in transformExpression</span>
<span class=
"linenr"> 2172: </span>      constType: ConstantTypes.NOT_CONSTANT,
<span class="linenr"> 2173: </span>      content,
<span class=
"linenr"> 2174: </span>      loc: getSelection(context, innerStart, innerEnd)
<span class="linenr"> 2175: </span>    },
<span class=
"linenr"> 2176: </span>    loc: getSelection(context, start)
<span class="linenr"> 2177: </span>  }
<span class="linenr"> 2178: </span>}
<span class="linenr"> 2179: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseAttributes</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">type</span>) {
<span class="linenr"> 2180: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">props</span> = []
<span class="linenr"> 2181: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">用 set 避免重复属性</span>
<span class="linenr"> 2182: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">attributeNames</span> = <span class=
"org-keyword">new</span> <span class="org-type">Set</span>()
<span class="linenr"> 2183: </span>  <span class=
"org-keyword">while</span> (
<span class=
"linenr"> 2184: </span>    context.source.length &gt; <span class=
"org-highlight-numbers-number">0</span> &amp;&
<span class=
"linenr"> 2185: </span>      !startsWith(context.source, <span class="org-string">'&gt;'</span>) &amp;&
<span class=
"linenr"> 2186: </span>      !startsWith(context.source, <span class="org-string">'/&gt;'</span>)
<span class="linenr"> 2187: </span>  ) {
<span class="linenr"> 2188: </span>
<span class="linenr"> 2189: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">一些非法检测, ignore</span>
<span class="linenr"> 2190: </span>
<span class="linenr"> 2191: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">attr</span> = parseAttribute(context, attributeNames)
<span class="linenr"> 2192: </span>
<span class="linenr"> 2193: </span>    logg(<span class=
"org-string">'ATTR'</span>, attr)
<span class="linenr"> 2194: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">去掉 class 之间多余的空格，如： `foo   bar  ` -&gt; `foo bar`</span>
<span class="linenr"> 2195: </span>    <span class=
"org-keyword">if</span> (attr.type === NodeTypes.ATTRIBUTE &amp;&
<span class=
"linenr"> 2196: </span>       attr.value &amp;& attr.name === <span class="org-string">'class'</span>) {
<span class=
"linenr"> 2197: </span>      attr.value.content = attr.value.content.replace(<span class="org-string">/\s+/</span>g, <span class="org-string">' '</span>).trim()
<span class="linenr"> 2198: </span>    }
<span class="linenr"> 2199: </span>
<span class="linenr"> 2200: </span>    <span class=
"org-keyword">if</span> (type === TagType.Start) {
<span class="linenr"> 2201: </span>      props.push(attr)
<span class="linenr"> 2202: </span>    }
<span class="linenr"> 2203: </span>
<span class="linenr"> 2204: </span>    advanceSpaces(context)
<span class="linenr"> 2205: </span>  }
<span class="linenr"> 2206: </span>
<span class="linenr"> 2207: </span>  <span class=
"org-keyword">return</span> props
<span class="linenr"> 2208: </span>}
<span class="linenr"> 2209: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseAttribute</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">nameSet</span>) {
<span class="linenr"> 2210: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = getCursor(context)
<span class="linenr"> 2211: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">match</span> = <span class=
"org-string">/^[^\t\r\n\f /&gt;][^\t\r\n\f /&gt;=]*/</span>.exec(context.source)
<span class="linenr"> 2212: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">name</span> = match[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 2213: </span>
<span class="linenr"> 2214: </span>  nameSet.add(name)
<span class="linenr"> 2215: </span>
<span class=
"linenr"> 2216: </span>  advanceBy(context, name.length)
<span class="linenr"> 2217: </span>
<span class="linenr"> 2218: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">value</span> = <span class=
"org-constant">undefined</span>
<span class="linenr"> 2219: </span>
<span class="linenr"> 2220: </span>  <span class=
"org-keyword">if</span> (<span class=
"org-string">/^[\t\r\n\f ]*=/</span>.test(context.source)) {
<span class="linenr"> 2221: </span>    advanceSpaces(context)
<span class=
"linenr"> 2222: </span>    advanceBy(context, <span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr"> 2223: </span>    advanceSpaces(context)
<span class=
"linenr"> 2224: </span>    value = parseAttributeValue(context)
<span class="linenr"> 2225: </span>  }
<span class="linenr"> 2226: </span>
<span class="linenr"> 2227: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">loc</span> = getSelection(context, start)
<span class="linenr"> 2228: </span>
<span class="linenr"> 2229: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-on(@), v-bind(:), v-if, v-else, v-slot(#) 指令</span>
<span class="linenr"> 2230: </span>  <span class=
"org-keyword">if</span> (!context.inVPre &amp;& <span class=
"org-string">/^(v-[A-Za-z0-9-]|:|\.|@|#)/</span>.test(name)) {
<span class="linenr"> 2231: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">match</span> = <span class=
"org-string">/(?:^v-([a-z0-9-]+))?(?:(?::|^\.|^@|^#)(\[[^\]]+\]|[^\.]+))?(.+)?$/</span>i.exec(name)
<span class="linenr"> 2232: </span>
<span class="linenr"> 2233: </span>    log(<span class=
"org-string">`parseAttribute| match=${match}`</span>)
<span class="linenr"> 2234: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">isPropShorthand</span> = startsWith(name, <span class="org-string">'.'</span>)
<span class="linenr"> 2235: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">dirName</span> =
<span class="linenr"> 2236: </span>        match[<span class=
"org-highlight-numbers-number">1</span>] ||
<span class=
"linenr"> 2237: </span>        (isPropShorthand || startsWith(name, <span class="org-string">':'</span>)
<span class="linenr"> 2238: </span>         ? <span class=
"org-string">'bind'</span>
<span class=
"linenr"> 2239: </span>         : startsWith(name, <span class=
"org-string">'@'</span>)
<span class="linenr"> 2240: </span>        ? <span class=
"org-string">'on'</span>
<span class="linenr"> 2241: </span>        : <span class=
"org-string">'slot'</span>)
<span class="linenr"> 2242: </span>    <span class=
"org-keyword">let</span> <span class="org-variable-name">arg</span>
<span class="linenr"> 2243: </span>
<span class="linenr"> 2244: </span>    <span class=
"org-keyword">if</span> (match[<span class=
"org-highlight-numbers-number">2</span>]) {
<span class="linenr"> 2245: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSlot</span> = dirName === <span class=
"org-string">'slot'</span>
<span class="linenr"> 2246: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">startOffset</span> = name.lastIndexOf(match[<span class="org-highlight-numbers-number">2</span>])
<span class="linenr"> 2247: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">loc</span> = getSelection(
<span class="linenr"> 2248: </span>        context,
<span class=
"linenr"> 2249: </span>        getNewPosition(context, start, startOffset),
<span class="linenr"> 2250: </span>        getNewPosition(
<span class="linenr"> 2251: </span>          context,
<span class="linenr"> 2252: </span>          start,
<span class=
"linenr"> 2253: </span>          startOffset + match[<span class=
"org-highlight-numbers-number">2</span>].length + ((isSlot &amp;& match[<span class="org-highlight-numbers-number">3</span>]) || <span class="org-string">''</span>).length
<span class="linenr"> 2254: </span>        )
<span class="linenr"> 2255: </span>      )
<span class="linenr"> 2256: </span>
<span class="linenr"> 2257: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">content</span> = match[<span class=
"org-highlight-numbers-number">2</span>]
<span class="linenr"> 2258: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">isStatic</span> = <span class=
"org-constant">true</span>
<span class="linenr"> 2259: </span>
<span class="linenr"> 2260: </span>      <span class=
"org-keyword">if</span> (content.startsWith(<span class=
"org-string">'['</span>)) {
<span class="linenr"> 2261: </span>        isStatic = <span class=
"org-constant">false</span>
<span class="linenr"> 2262: </span>
<span class=
"linenr"> 2263: </span>        content = content.slice(<span class=
"org-highlight-numbers-number">1</span>, content.length - <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 2264: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isSlot){
<span class=
"linenr"> 2265: </span>        content += match[<span class=
"org-highlight-numbers-number">3</span>] || <span class=
"org-string">''</span>
<span class="linenr"> 2266: </span>      }
<span class="linenr"> 2267: </span>
<span class="linenr"> 2268: </span>      arg = {
<span class=
"linenr"> 2269: </span>        type: NodeTypes.SIMPLE_EXPRESSION,
<span class="linenr"> 2270: </span>        content,
<span class="linenr"> 2271: </span>        isStatic,
<span class="linenr"> 2272: </span>        constType: isStatic
<span class=
"linenr"> 2273: </span>          ? ConstantTypes.CAN_STRINGIFY
<span class=
"linenr"> 2274: </span>          : ConstantTypes.NOT_CONSTANT,
<span class="linenr"> 2275: </span>        loc
<span class="linenr"> 2276: </span>      }
<span class="linenr"> 2277: </span>    }
<span class="linenr"> 2278: </span>
<span class="linenr"> 2279: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">quoted: `foo="bar"`, not quoted: `foo=bar`</span>
<span class="linenr"> 2280: </span>    <span class=
"org-keyword">if</span> (value &amp;& value.isQuoted) {
<span class="linenr"> 2281: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">valueLoc</span> = value.loc
<span class="linenr"> 2282: </span>      valueLoc.start.offset++
<span class="linenr"> 2283: </span>      valueLoc.start.column++
<span class=
"linenr"> 2284: </span>      valueLoc.end = advancePositionWithClone(valueLoc.start, value.content)
<span class=
"linenr"> 2285: </span>      valueLoc.source = valueLoc.source.slice(<span class="org-highlight-numbers-number">1</span>, -<span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 2286: </span>    }
<span class="linenr"> 2287: </span>
<span class="linenr"> 2288: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">修饰符 v-bind.number="foo" =&gt; '.number' =&gt; ['number']</span>
<span class="linenr"> 2289: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">modifiers</span> = match[<span class=
"org-highlight-numbers-number">3</span>] ? match[<span class=
"org-highlight-numbers-number">3</span>].slice(<span class=
"org-highlight-numbers-number">1</span>).split(<span class=
"org-string">'.'</span>) : []
<span class="linenr"> 2290: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">`&lt;div foo.prop="bar"&gt;` 如果不加 `.prop` 这个会被解析到 `$attrs` 中</span>
<span class="linenr"> 2291: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">如果加了 `.prop` 则会被解析到 `$props` 中去</span>
<span class="linenr"> 2292: </span>    <span class=
"org-keyword">if</span> (isPropShorthand) {
<span class=
"linenr"> 2293: </span>      modifiers.push(<span class="org-string">'prop'</span>)
<span class="linenr"> 2294: </span>    }
<span class="linenr"> 2295: </span>
<span class="linenr"> 2296: </span>    <span class=
"org-keyword">return</span> {
<span class="linenr"> 2297: </span>      type: NodeTypes.DIRECTIVE,
<span class="linenr"> 2298: </span>      name: dirName,
<span class="linenr"> 2299: </span>      exp: value &amp;& {
<span class=
"linenr"> 2300: </span>        type: NodeTypes.SIMPLE_EXPRESSION,
<span class="linenr"> 2301: </span>        content: value.content,
<span class="linenr"> 2302: </span>        isStatic: <span class=
"org-constant">false</span>,
<span class="linenr"> 2303: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Treat as non-constant by default. This can be potentially set to</span>
<span class="linenr"> 2304: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">other values by `transformExpression` to make it eligible for hoisting.</span>
<span class=
"linenr"> 2305: </span>        constType: ConstantTypes.NOT_CONSTANT,
<span class="linenr"> 2306: </span>        loc: value.loc
<span class="linenr"> 2307: </span>      },
<span class="linenr"> 2308: </span>      arg,
<span class="linenr"> 2309: </span>      modifiers,
<span class="linenr"> 2310: </span>      loc
<span class="linenr"> 2311: </span>    }
<span class="linenr"> 2312: </span>  }
<span class="linenr"> 2313: </span>
<span class="linenr"> 2314: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 2315: </span>    type: NodeTypes.ATTRIBUTE,
<span class="linenr"> 2316: </span>    name,
<span class="linenr"> 2317: </span>    value: value &amp;& {
<span class="linenr"> 2318: </span>      type: NodeTypes.TEXT,
<span class="linenr"> 2319: </span>      content: value.content,
<span class="linenr"> 2320: </span>      loc: value.loc
<span class="linenr"> 2321: </span>    },
<span class="linenr"> 2322: </span>    loc
<span class="linenr"> 2323: </span>  }
<span class="linenr"> 2324: </span>}
<span class="linenr"> 2325: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseAttributeValue</span>(<span class=
"org-variable-name">context</span>) {
<span class="linenr"> 2326: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = getCursor(context)
<span class="linenr"> 2327: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">content</span>
<span class="linenr"> 2328: </span>
<span class="linenr"> 2329: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">quote</span> = context.source[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 2330: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">value 分两种情况，可以用引号包起来也可以不使用引号</span>
<span class="linenr"> 2331: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">`&lt;div foo="value"&gt;` 或 `&lt;div foo=value&gt;`</span>
<span class="linenr"> 2332: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isQuoted</span> = quote === <span class=
"org-string">`"`</span> || quote === <span class=
"org-string">`'`</span>
<span class="linenr"> 2333: </span>  <span class=
"org-keyword">if</span> (isQuoted) {
<span class="linenr"> 2334: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Quoted value.</span>
<span class=
"linenr"> 2335: </span>    advanceBy(context, <span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr"> 2336: </span>
<span class="linenr"> 2337: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">endIndex</span> = context.source.indexOf(quote)
<span class="linenr"> 2338: </span>    <span class=
"org-keyword">if</span> (endIndex === -<span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 2339: </span>      content = parseTextData(
<span class="linenr"> 2340: </span>        context,
<span class="linenr"> 2341: </span>        context.source.length,
<span class=
"linenr"> 2342: </span>        TextModes.ATTRIBUTE_VALUE
<span class="linenr"> 2343: </span>      )
<span class="linenr"> 2344: </span>    } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 2345: </span>      content = parseTextData(context, endIndex, TextModes.ATTRIBUTE_VALUE)
<span class=
"linenr"> 2346: </span>      advanceBy(context, <span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr"> 2347: </span>    }
<span class="linenr"> 2348: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2349: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Unquoted</span>
<span class="linenr"> 2350: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">match</span> = <span class=
"org-string">/^[^\t\r\n\f &gt;]+/</span>.exec(context.source)
<span class="linenr"> 2351: </span>    <span class=
"org-keyword">if</span> (!match) {
<span class="linenr"> 2352: </span>      <span class=
"org-keyword">return</span> <span class=
"org-constant">undefined</span>
<span class="linenr"> 2353: </span>    }
<span class=
"linenr"> 2354: </span>    content = parseTextData(context, match[<span class="org-highlight-numbers-number">0</span>].length, TextModes.ATTRIBUTE_VALUE)
<span class="linenr"> 2355: </span>  }
<span class="linenr"> 2356: </span>
<span class="linenr"> 2357: </span>  <span class=
"org-keyword">return</span> { content, isQuoted, loc: getSelection(context, start) }
<span class="linenr"> 2358: </span>}
<span class="linenr"> 2359: </span>
<span class="linenr"> 2360: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">baseParse</span>(<span class=
"org-variable-name">content</span>, <span class=
"org-variable-name">options</span> = {}) {
<span class="linenr"> 2361: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">context</span> = createParserContext(content, options)
<span class="linenr"> 2362: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = getCursor(context)
<span class="linenr"> 2363: </span>  <span class=
"org-keyword">return</span> createRoot(
<span class=
"linenr"> 2364: </span>    parseChildren(context, TextModes.DATA, []),
<span class="linenr"> 2365: </span>    getSelection(context, start)
<span class="linenr"> 2366: </span>  )
<span class="linenr"> 2367: </span>}
<span class="linenr"> 2368: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createTransformContext</span>(
<span class="linenr"> 2369: </span>  <span class=
"org-variable-name">root</span>,
<span class="linenr"> 2370: </span>  {
<span class="linenr"> 2371: </span>    filename = <span class=
"org-string">''</span>,
<span class=
"linenr"> 2372: </span>    prefixIdentifiers = <span class=
"org-constant">false</span>,
<span class="linenr"> 2373: </span>    hoistStatic = <span class=
"org-constant">false</span>,
<span class="linenr"> 2374: </span>    cacheHandlers = <span class=
"org-constant">false</span>,
<span class="linenr"> 2375: </span>    nodeTransforms = [],
<span class="linenr"> 2376: </span>    directiveTransforms = {},
<span class=
"linenr"> 2377: </span>    transformHoist = <span class="org-constant">null</span>,
<span class="linenr"> 2378: </span>    isBuiltInComponent = NOOP,
<span class="linenr"> 2379: </span>    isCustomElement = NOOP,
<span class="linenr"> 2380: </span>    expressionPlugins = [],
<span class="linenr"> 2381: </span>    scopeId = <span class=
"org-constant">null</span>,
<span class="linenr"> 2382: </span>    slotted = <span class=
"org-constant">true</span>,
<span class="linenr"> 2383: </span>    ssr = <span class=
"org-constant">false</span>,
<span class="linenr"> 2384: </span>    inSSR = <span class=
"org-constant">false</span>,
<span class="linenr"> 2385: </span>    ssrCssVars = <span class=
"org-string">``</span>,
<span class="linenr"> 2386: </span>    bindingMetadata = EMPTY_OBJ,
<span class="linenr"> 2387: </span>    inline = <span class=
"org-constant">false</span>,
<span class="linenr"> 2388: </span>    isTS = <span class=
"org-constant">false</span>,
<span class="linenr"> 2389: </span>    onError = defaultOnError,
<span class="linenr"> 2390: </span>    onWarn = defaultOnWarn,
<span class="linenr"> 2391: </span>    compatConfig
<span class="linenr"> 2392: </span>  }
<span class="linenr"> 2393: </span>) {
<span class="linenr"> 2394: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">nameMatch</span> = filename.replace(<span class="org-string">/\?.*$/</span>, <span class="org-string">''</span>).match(<span class="org-string">/([^/\\]+)\.\w+$/</span>)
<span class="linenr"> 2395: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">context</span> = {
<span class="linenr"> 2396: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">options</span>
<span class=
"linenr"> 2397: </span>    selfName: nameMatch &amp;& capitalize(camelize(nameMatch[<span class="org-highlight-numbers-number">1</span>])),
<span class="linenr"> 2398: </span>    prefixIdentifiers,
<span class="linenr"> 2399: </span>    hoistStatic,
<span class="linenr"> 2400: </span>    cacheHandlers,
<span class="linenr"> 2401: </span>    nodeTransforms,
<span class="linenr"> 2402: </span>    directiveTransforms,
<span class="linenr"> 2403: </span>    transformHoist,
<span class="linenr"> 2404: </span>    isBuiltInComponent,
<span class="linenr"> 2405: </span>    isCustomElement,
<span class="linenr"> 2406: </span>    expressionPlugins,
<span class="linenr"> 2407: </span>    scopeId,
<span class="linenr"> 2408: </span>    slotted,
<span class="linenr"> 2409: </span>    ssr,
<span class="linenr"> 2410: </span>    inSSR,
<span class="linenr"> 2411: </span>    ssrCssVars,
<span class="linenr"> 2412: </span>    bindingMetadata,
<span class="linenr"> 2413: </span>    inline,
<span class="linenr"> 2414: </span>    isTS,
<span class="linenr"> 2415: </span>    onError,
<span class="linenr"> 2416: </span>    onWarn,
<span class="linenr"> 2417: </span>    compatConfig,
<span class="linenr"> 2418: </span>
<span class="linenr"> 2419: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">state</span>
<span class="linenr"> 2420: </span>    root,
<span class="linenr"> 2421: </span>    helpers: <span class=
"org-keyword">new</span> <span class="org-type">Map</span>(),
<span class="linenr"> 2422: </span>    components: <span class=
"org-keyword">new</span> <span class="org-type">Set</span>(),
<span class="linenr"> 2423: </span>    directives: <span class=
"org-keyword">new</span> <span class="org-type">Set</span>(),
<span class="linenr"> 2424: </span>    hoists: [],
<span class="linenr"> 2425: </span>    imports: [],
<span class="linenr"> 2426: </span>    constantCache: <span class=
"org-keyword">new</span> <span class="org-type">Map</span>(),
<span class="linenr"> 2427: </span>    temps: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 2428: </span>    cached: <span class=
"org-highlight-numbers-number">0</span>,
<span class=
"linenr"> 2429: </span>    identifiers: Object.create(<span class=
"org-constant">null</span>),
<span class="linenr"> 2430: </span>    scopes: { <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">记录下面四个指令的嵌套层次</span>
<span class="linenr"> 2431: </span>      vFor: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 2432: </span>      vSlot: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 2433: </span>      vPre: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 2434: </span>      vOnce: <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 2435: </span>    },
<span class="linenr"> 2436: </span>    parent: <span class=
"org-constant">null</span>,
<span class="linenr"> 2437: </span>    currentNode: root,
<span class="linenr"> 2438: </span>    childIndex: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 2439: </span>    inVOnce: <span class=
"org-constant">false</span>,
<span class="linenr"> 2440: </span>
<span class="linenr"> 2441: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">methods</span>
<span class="linenr"> 2442: </span>    helper(name) {
<span class="linenr"> 2443: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">count</span> = context.helpers.get(name) || <span class="org-highlight-numbers-number">0</span>
<span class=
"linenr"> 2444: </span>      context.helpers.set(name, count + <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 2445: </span>      <span class=
"org-keyword">return</span> name
<span class="linenr"> 2446: </span>    },
<span class="linenr"> 2447: </span>    removeHelper(name) {
<span class="linenr"> 2448: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">count</span> = context.helpers.get(name)
<span class="linenr"> 2449: </span>      <span class=
"org-keyword">if</span> (count) {
<span class="linenr"> 2450: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">currentCount</span> = count - <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 2451: </span>        <span class=
"org-keyword">if</span> (!currentCount) {
<span class=
"linenr"> 2452: </span>          context.helpers.<span class=
"org-keyword">delete</span>(name)
<span class="linenr"> 2453: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 2454: </span>          context.helpers.set(name, currentCount)
<span class="linenr"> 2455: </span>        }
<span class="linenr"> 2456: </span>      }
<span class="linenr"> 2457: </span>    },
<span class="linenr"> 2458: </span>    helperString(name) {
<span class="linenr"> 2459: </span>      <span class=
"org-keyword">return</span> <span class=
"org-string">`_${helperNameMap[context.helper(name)]}`</span>
<span class="linenr"> 2460: </span>    },
<span class="linenr"> 2461: </span>    replaceNode(node) {
<span class=
"linenr"> 2462: </span>      context.parent.children[context.childIndex] = context.currentNode = node
<span class="linenr"> 2463: </span>    },
<span class="linenr"> 2464: </span>    removeNode(node) {
<span class="linenr"> 2465: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">list</span> = context.parent.children
<span class="linenr"> 2466: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">removalIndex</span> = node
<span class="linenr"> 2467: </span>        ? list.indexOf(node)
<span class="linenr"> 2468: </span>        : context.currentNode
<span class="linenr"> 2469: </span>        ? context.childIndex
<span class="linenr"> 2470: </span>        : -<span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 2471: </span>
<span class="linenr"> 2472: </span>      <span class=
"org-keyword">if</span> (!node || node === context.currentNode) {
<span class="linenr"> 2473: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">current node removed</span>
<span class=
"linenr"> 2474: </span>        context.currentNode = <span class=
"org-constant">null</span>
<span class="linenr"> 2475: </span>        context.onNodeRemoved()
<span class="linenr"> 2476: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2477: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">sibling node removed</span>
<span class="linenr"> 2478: </span>        <span class=
"org-keyword">if</span> (context.childIndex &gt; removalIndex) {
<span class="linenr"> 2479: </span>          context.childIndex--
<span class=
"linenr"> 2480: </span>          context.onNodeRemoved()
<span class="linenr"> 2481: </span>        }
<span class="linenr"> 2482: </span>      }
<span class=
"linenr"> 2483: </span>      context.parent.children.splice(removalIndex, <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 2484: </span>    },
<span class="linenr"> 2485: </span>    onNodeRemoved: () =&gt; {},
<span class="linenr"> 2486: </span>    addIdentifiers(exp) {
<span class="linenr"> 2487: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">identifier tracking only happens in non-browser builds.</span>
<span class="linenr"> 2488: </span>      <span class=
"org-keyword">if</span> (!__BROWSER__) {
<span class="linenr"> 2489: </span>        <span class=
"org-keyword">if</span> (isString(exp)) {
<span class="linenr"> 2490: </span>          addId(exp)
<span class="linenr"> 2491: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (exp.identifiers) {
<span class=
"linenr"> 2492: </span>          exp.identifiers.forEach(addId)
<span class="linenr"> 2493: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (exp.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 2494: </span>          addId(exp.content)
<span class="linenr"> 2495: </span>        }
<span class="linenr"> 2496: </span>      }
<span class="linenr"> 2497: </span>    },
<span class="linenr"> 2498: </span>    removeIdentifiers(exp) {
<span class="linenr"> 2499: </span>      <span class=
"org-keyword">if</span> (!__BROWSER__) {
<span class="linenr"> 2500: </span>        <span class=
"org-keyword">if</span> (isString(exp)) {
<span class="linenr"> 2501: </span>          removeId(exp)
<span class="linenr"> 2502: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (exp.identifiers) {
<span class=
"linenr"> 2503: </span>          exp.identifiers.forEach(removeId)
<span class="linenr"> 2504: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (exp.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 2505: </span>          removeId(exp.content)
<span class="linenr"> 2506: </span>        }
<span class="linenr"> 2507: </span>      }
<span class="linenr"> 2508: </span>    },
<span class="linenr"> 2509: </span>    hoist(exp) {
<span class="linenr"> 2510: </span>      <span class=
"org-keyword">if</span> (isString(exp)) exp = createSimpleExpression(exp)
<span class="linenr"> 2511: </span>      context.hoists.push(exp)
<span class="linenr"> 2512: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">identifier</span> = createSimpleExpression(
<span class="linenr"> 2513: </span>        <span class=
"org-string">`_hoisted_${context.hoists.length}`</span>,
<span class="linenr"> 2514: </span>        <span class=
"org-constant">false</span>,
<span class="linenr"> 2515: </span>        exp.loc,
<span class="linenr"> 2516: </span>        ConstantTypes.CAN_HOIST
<span class="linenr"> 2517: </span>      )
<span class="linenr"> 2518: </span>      identifier.hoisted = exp
<span class="linenr"> 2519: </span>      <span class=
"org-keyword">return</span> identifier
<span class="linenr"> 2520: </span>    },
<span class=
"linenr"> 2521: </span>    cache(exp, isVNode = <span class=
"org-constant">false</span>) {
<span class="linenr"> 2522: </span>      <span class=
"org-keyword">return</span> createCacheExpression(context.cached++, exp, isVNode)
<span class="linenr"> 2523: </span>    }
<span class="linenr"> 2524: </span>  }
<span class="linenr"> 2525: </span>
<span class="linenr"> 2526: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">addId</span>(<span class=
"org-variable-name">id</span>) {
<span class="linenr"> 2527: </span>    <span class=
"org-keyword">const</span> { identifiers } = context
<span class="linenr"> 2528: </span>    <span class=
"org-keyword">if</span> (identifiers[id] === <span class=
"org-constant">undefined</span>) {
<span class=
"linenr"> 2529: </span>      identifiers[id] = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 2530: </span>    }
<span class="linenr"> 2531: </span>    identifiers[id]++
<span class="linenr"> 2532: </span>  }
<span class="linenr"> 2533: </span>
<span class="linenr"> 2534: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">removeId</span>(<span class=
"org-variable-name">id</span>) {
<span class="linenr"> 2535: </span>    context.identifiers[id]--
<span class="linenr"> 2536: </span>  }
<span class="linenr"> 2537: </span>
<span class="linenr"> 2538: </span>  <span class=
"org-keyword">return</span> context
<span class="linenr"> 2539: </span>}
<span class="linenr"> 2540: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">traverseNode</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 2541: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">记录当前正在处理的节点</span>
<span class="linenr"> 2542: </span>  context.currentNode = node
<span class="linenr"> 2543: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">对节点转换时使用到的插件(外部可通过这个来修改某个指令)</span>
<span class="linenr"> 2544: </span>  <span class=
"org-keyword">const</span> { nodeTransforms } = context
<span class="linenr"> 2545: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">递归遍历结束，回溯时调用的函数列表</span>
<span class="linenr"> 2546: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">也就是这个函数最后执行的函数，当一颗树遍历完成执行的函数</span>
<span class="linenr"> 2547: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">随后的 for 循环是用来收集这些函数的</span>
<span class="linenr"> 2548: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exitFns</span> = []
<span class="linenr"> 2549: </span>
<span class="linenr"> 2550: </span>  logg(<span class=
"org-string">'traverseNode'</span>, node)
<span class="linenr"> 2551: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; nodeTransforms.length; i++) {
<span class="linenr"> 2552: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">onExit</span> = nodeTransforms[i](node, context)
<span class="linenr"> 2553: </span>    <span class=
"org-keyword">if</span> (onExit) {
<span class="linenr"> 2554: </span>      <span class=
"org-keyword">if</span> (isArray(onExit)) {
<span class="linenr"> 2555: </span>        exitFns.push(...onExit)
<span class="linenr"> 2556: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2557: </span>        exitFns.push(onExit)
<span class="linenr"> 2558: </span>      }
<span class="linenr"> 2559: </span>    }
<span class="linenr"> 2560: </span>    <span class=
"org-keyword">if</span> (!context.currentNode) {
<span class="linenr"> 2561: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">node was removed</span>
<span class="linenr"> 2562: </span>      <span class=
"org-keyword">return</span>
<span class="linenr"> 2563: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2564: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">node may have been replaced</span>
<span class="linenr"> 2565: </span>      node = context.currentNode
<span class="linenr"> 2566: </span>    }
<span class="linenr"> 2567: </span>  }
<span class="linenr"> 2568: </span>
<span class="linenr"> 2569: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">根据节点类型来分别处理，这里忽略注释</span>
<span class="linenr"> 2570: </span>  <span class=
"org-keyword">switch</span> (node.type) {
<span class="linenr"> 2571: </span>    <span class=
"org-keyword">case</span> NodeTypes.INTERPOLATION:
<span class="linenr"> 2572: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no need to traverse, but we need to inject toString helper</span>
<span class="linenr"> 2573: </span>      <span class=
"org-keyword">if</span> (!context.ssr) {
<span class=
"linenr"> 2574: </span>        context.helper(TO_DISPLAY_STRING)
<span class="linenr"> 2575: </span>      }
<span class="linenr"> 2576: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 2577: </span>
<span class="linenr"> 2578: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for container types, further traverse downwards</span>
<span class="linenr"> 2579: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">处理 if...else if...else 分支</span>
<span class="linenr"> 2580: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF:
<span class="linenr"> 2581: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.branches.length; i++) {
<span class=
"linenr"> 2582: </span>        traverseNode(node.branches[i], context)
<span class="linenr"> 2583: </span>      }
<span class="linenr"> 2584: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 2585: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF_BRANCH: <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">else..if</span>
<span class="linenr"> 2586: </span>    <span class=
"org-keyword">case</span> NodeTypes.FOR: <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for</span>
<span class="linenr"> 2587: </span>    <span class=
"org-keyword">case</span> NodeTypes.ELEMENT:
<span class="linenr"> 2588: </span>    <span class=
"org-keyword">case</span> NodeTypes.ROOT:
<span class=
"linenr"> 2589: </span>      traverseChildren(node, context)
<span class="linenr"> 2590: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 2591: </span>  }
<span class="linenr"> 2592: </span>
<span class="linenr"> 2593: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">收集完成，执行这些收集到的函数，作用到当前节点上</span>
<span class="linenr"> 2594: </span>  context.currentNode = node
<span class="linenr"> 2595: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = exitFns.length
<span class="linenr"> 2596: </span>  <span class=
"org-keyword">while</span> (i--) {
<span class="linenr"> 2597: </span>    exitFns[i]()
<span class="linenr"> 2598: </span>  }
<span class="linenr"> 2599: </span>}
<span class="linenr"> 2600: </span>
<span class="linenr"> 2601: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">traverseChildren</span>(<span class=
"org-variable-name">parent</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 2602: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 2603: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">nodeRemoved</span> = () =&gt; {
<span class="linenr"> 2604: </span>    i--
<span class="linenr"> 2605: </span>  }
<span class="linenr"> 2606: </span>  <span class=
"org-keyword">for</span> (; i &lt; parent.children.length; i++) {
<span class="linenr"> 2607: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = parent.children[i]
<span class="linenr"> 2608: </span>    <span class=
"org-keyword">if</span> (isString(child)) <span class=
"org-keyword">continue</span>
<span class="linenr"> 2609: </span>    context.parent = parent
<span class="linenr"> 2610: </span>    context.childIndex = i
<span class=
"linenr"> 2611: </span>    context.onNodeRemoved = nodeRemoved
<span class="linenr"> 2612: </span>    traverseNode(child, context)
<span class="linenr"> 2613: </span>  }
<span class="linenr"> 2614: </span>}
<span class="linenr"> 2615: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">hoistStatic</span>(<span class=
"org-variable-name">root</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 2616: </span>  _walk(
<span class="linenr"> 2617: </span>    root,
<span class="linenr"> 2618: </span>    context,
<span class="linenr"> 2619: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Root node is unfortunately non-hoistable due to potential parent</span>
<span class="linenr"> 2620: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">fallthrough attributes.</span>
<span class=
"linenr"> 2621: </span>    isSingleElementRoot(root, root.children[<span class="org-highlight-numbers-number">0</span>])
<span class="linenr"> 2622: </span>  )
<span class="linenr"> 2623: </span>}
<span class="linenr"> 2624: </span>
<span class="linenr"> 2625: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isSingleElementRoot</span>(
<span class="linenr"> 2626: </span>  <span class=
"org-variable-name">root</span>,
<span class="linenr"> 2627: </span>  child
<span class="linenr"> 2628: </span>) {
<span class="linenr"> 2629: </span>  <span class=
"org-keyword">const</span> { children } = root
<span class="linenr"> 2630: </span>  <span class=
"org-keyword">return</span> (
<span class=
"linenr"> 2631: </span>    children.length === <span class=
"org-highlight-numbers-number">1</span> &amp;&
<span class=
"linenr"> 2632: </span>    child.type === NodeTypes.ELEMENT &amp;&
<span class="linenr"> 2633: </span>    !isSlotOutlet(child)
<span class="linenr"> 2634: </span>  )
<span class="linenr"> 2635: </span>}
<span class="linenr"> 2636: </span>
<span class="linenr"> 2637: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">_walk</span>(
<span class="linenr"> 2638: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 2639: </span>  <span class=
"org-variable-name">context</span>,
<span class="linenr"> 2640: </span>  doNotHoistNode = <span class=
"org-constant">false</span>
<span class="linenr"> 2641: </span>) {
<span class="linenr"> 2642: </span>  <span class=
"org-keyword">const</span> { children } = node
<span class="linenr"> 2643: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">originalCount</span> = children.length
<span class="linenr"> 2644: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hoistedCount</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 2645: </span>
<span class="linenr"> 2646: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; children.length; i++) {
<span class="linenr"> 2647: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = children[i]
<span class="linenr"> 2648: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">only plain elements & text calls are eligible for hoisting.</span>
<span class="linenr"> 2649: </span>    <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 2650: </span>      child.type === NodeTypes.ELEMENT &amp;&
<span class=
"linenr"> 2651: </span>      child.tagType === ElementTypes.ELEMENT
<span class="linenr"> 2652: </span>    ) {
<span class="linenr"> 2653: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">constantType</span> = doNotHoistNode
<span class=
"linenr"> 2654: </span>        ? ConstantTypes.NOT_CONSTANT
<span class=
"linenr"> 2655: </span>        : getConstantType(child, context)
<span class="linenr"> 2656: </span>      <span class=
"org-keyword">if</span> (constantType &gt; ConstantTypes.NOT_CONSTANT) {
<span class="linenr"> 2657: </span>        <span class=
"org-keyword">if</span> (constantType &gt;= ConstantTypes.CAN_HOIST) {
<span class=
"linenr"> 2658: </span>          child.codegenNode.patchFlag =
<span class=
"linenr"> 2659: </span>            PatchFlags.HOISTED + (__DEV__ ? <span class="org-string">` /* HOISTED */`</span> : <span class="org-string">``</span>)
<span class=
"linenr"> 2660: </span>          child.codegenNode = context.hoist(child.codegenNode)
<span class="linenr"> 2661: </span>          hoistedCount++
<span class="linenr"> 2662: </span>          <span class=
"org-keyword">continue</span>
<span class="linenr"> 2663: </span>        }
<span class="linenr"> 2664: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2665: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">node may contain dynamic children, but its props may be eligible for</span>
<span class="linenr"> 2666: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">hoisting.</span>
<span class="linenr"> 2667: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">codegenNode</span> = child.codegenNode
<span class="linenr"> 2668: </span>        <span class=
"org-keyword">if</span> (codegenNode.type === NodeTypes.VNODE_CALL) {
<span class="linenr"> 2669: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">flag</span> = getPatchFlag(codegenNode)
<span class="linenr"> 2670: </span>          <span class=
"org-keyword">if</span> (
<span class="linenr"> 2671: </span>            (!flag ||
<span class=
"linenr"> 2672: </span>              flag === PatchFlags.NEED_PATCH ||
<span class=
"linenr"> 2673: </span>              flag === PatchFlags.TEXT) &amp;&
<span class=
"linenr"> 2674: </span>            getGeneratedPropsConstantType(child, context) &gt;=
<span class=
"linenr"> 2675: </span>              ConstantTypes.CAN_HOIST
<span class="linenr"> 2676: </span>          ) {
<span class="linenr"> 2677: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">props</span> = getNodeProps(child)
<span class="linenr"> 2678: </span>            <span class=
"org-keyword">if</span> (props) {
<span class=
"linenr"> 2679: </span>              codegenNode.props = context.hoist(props)
<span class="linenr"> 2680: </span>            }
<span class="linenr"> 2681: </span>          }
<span class="linenr"> 2682: </span>          <span class=
"org-keyword">if</span> (codegenNode.dynamicProps) {
<span class=
"linenr"> 2683: </span>            codegenNode.dynamicProps = context.hoist(codegenNode.dynamicProps)
<span class="linenr"> 2684: </span>          }
<span class="linenr"> 2685: </span>        }
<span class="linenr"> 2686: </span>      }
<span class="linenr"> 2687: </span>    } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr"> 2688: </span>      child.type === NodeTypes.TEXT_CALL &amp;&
<span class=
"linenr"> 2689: </span>      getConstantType(child.content, context) &gt;= ConstantTypes.CAN_HOIST
<span class="linenr"> 2690: </span>    ) {
<span class=
"linenr"> 2691: </span>      child.codegenNode = context.hoist(child.codegenNode)
<span class="linenr"> 2692: </span>      hoistedCount++
<span class="linenr"> 2693: </span>    }
<span class="linenr"> 2694: </span>
<span class="linenr"> 2695: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">walk further</span>
<span class="linenr"> 2696: </span>    <span class=
"org-keyword">if</span> (child.type === NodeTypes.ELEMENT) {
<span class="linenr"> 2697: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isComponent</span> = child.tagType === ElementTypes.COMPONENT
<span class="linenr"> 2698: </span>      <span class=
"org-keyword">if</span> (isComponent) {
<span class="linenr"> 2699: </span>        context.scopes.vSlot++
<span class="linenr"> 2700: </span>      }
<span class="linenr"> 2701: </span>      _walk(child, context)
<span class="linenr"> 2702: </span>      <span class=
"org-keyword">if</span> (isComponent) {
<span class="linenr"> 2703: </span>        context.scopes.vSlot--
<span class="linenr"> 2704: </span>      }
<span class="linenr"> 2705: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (child.type === NodeTypes.FOR) {
<span class="linenr"> 2706: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Do not hoist v-for single child because it has to be a block</span>
<span class=
"linenr"> 2707: </span>      _walk(child, context, child.children.length === <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 2708: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (child.type === NodeTypes.IF) {
<span class="linenr"> 2709: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; child.branches.length; i++) {
<span class="linenr"> 2710: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Do not hoist v-if single child because it has to be a block</span>
<span class="linenr"> 2711: </span>        _walk(
<span class="linenr"> 2712: </span>          child.branches[i],
<span class="linenr"> 2713: </span>          context,
<span class=
"linenr"> 2714: </span>          child.branches[i].children.length === <span class="org-highlight-numbers-number">1</span>
<span class="linenr"> 2715: </span>        )
<span class="linenr"> 2716: </span>      }
<span class="linenr"> 2717: </span>    }
<span class="linenr"> 2718: </span>  }
<span class="linenr"> 2719: </span>
<span class="linenr"> 2720: </span>  <span class=
"org-keyword">if</span> (hoistedCount &amp;& context.transformHoist) {
<span class="linenr"> 2721: </span>    logg(<span class=
"org-string">`hoist walk -&gt; transformHoist, hoistedCount = ${hoistedCount}`</span>)
<span class=
"linenr"> 2722: </span>    context.transformHoist(children, context, node)
<span class="linenr"> 2723: </span>  }
<span class="linenr"> 2724: </span>
<span class="linenr"> 2725: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">all children were hoisted - the entire children array is hoistable.</span>
<span class="linenr"> 2726: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 2727: </span>    hoistedCount &amp;&
<span class=
"linenr"> 2728: </span>    hoistedCount === originalCount &amp;&
<span class=
"linenr"> 2729: </span>    node.type === NodeTypes.ELEMENT &amp;&
<span class=
"linenr"> 2730: </span>    node.tagType === ElementTypes.ELEMENT &amp;&
<span class="linenr"> 2731: </span>    node.codegenNode &amp;&
<span class=
"linenr"> 2732: </span>    node.codegenNode.type === NodeTypes.VNODE_CALL &amp;&
<span class=
"linenr"> 2733: </span>    isArray(node.codegenNode.children)
<span class="linenr"> 2734: </span>  ) {
<span class=
"linenr"> 2735: </span>    node.codegenNode.children = context.hoist(
<span class=
"linenr"> 2736: </span>      createArrayExpression(node.codegenNode.children)
<span class="linenr"> 2737: </span>    )
<span class="linenr"> 2738: </span>  }
<span class="linenr"> 2739: </span>}
<span class="linenr"> 2740: </span>
<span class="linenr"> 2741: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getConstantType</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 2742: </span>  <span class=
"org-keyword">const</span> { constantCache } = context
<span class="linenr"> 2743: </span>  <span class=
"org-keyword">switch</span> (node.type) {
<span class="linenr"> 2744: </span>    <span class=
"org-keyword">case</span> NodeTypes.ELEMENT:
<span class="linenr"> 2745: </span>      <span class=
"org-keyword">if</span> (node.tagType !== ElementTypes.ELEMENT) {
<span class="linenr"> 2746: </span>        <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2747: </span>      }
<span class="linenr"> 2748: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">cached</span> = constantCache.get(node)
<span class="linenr"> 2749: </span>      <span class=
"org-keyword">if</span> (cached !== <span class=
"org-constant">undefined</span>) {
<span class="linenr"> 2750: </span>        <span class=
"org-keyword">return</span> cached
<span class="linenr"> 2751: </span>      }
<span class="linenr"> 2752: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">codegenNode</span> = node.codegenNode
<span class="linenr"> 2753: </span>      <span class=
"org-keyword">if</span> (codegenNode.type !== NodeTypes.VNODE_CALL) {
<span class="linenr"> 2754: </span>        <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2755: </span>      }
<span class="linenr"> 2756: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 2757: </span>        codegenNode.isBlock &amp;&
<span class=
"linenr"> 2758: </span>        node.tag !== <span class="org-string">'svg'</span> &amp;&
<span class=
"linenr"> 2759: </span>        node.tag !== <span class="org-string">'foreignObject'</span>
<span class="linenr"> 2760: </span>      ) {
<span class="linenr"> 2761: </span>        <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2762: </span>      }
<span class="linenr"> 2763: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">flag</span> = getPatchFlag(codegenNode)
<span class="linenr"> 2764: </span>      <span class=
"org-keyword">if</span> (!flag) {
<span class="linenr"> 2765: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">returnType</span> = ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 2766: </span>
<span class="linenr"> 2767: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Element itself has no patch flag. However we still need to check:</span>
<span class="linenr"> 2768: </span>
<span class="linenr"> 2769: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. Even for a node with no patch flag, it is possible for it to contain</span>
<span class="linenr"> 2770: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">non-hoistable expressions that refers to scope variables, e.g. compiler</span>
<span class="linenr"> 2771: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">injected keys or cached event handlers. Therefore we need to always</span>
<span class="linenr"> 2772: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check the codegenNode's props to be sure.</span>
<span class="linenr"> 2773: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">generatedPropsType</span> = getGeneratedPropsConstantType(node, context)
<span class="linenr"> 2774: </span>        <span class=
"org-keyword">if</span> (generatedPropsType === ConstantTypes.NOT_CONSTANT) {
<span class=
"linenr"> 2775: </span>          constantCache.set(node, ConstantTypes.NOT_CONSTANT)
<span class="linenr"> 2776: </span>          <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2777: </span>        }
<span class="linenr"> 2778: </span>        <span class=
"org-keyword">if</span> (generatedPropsType &lt; returnType) {
<span class=
"linenr"> 2779: </span>          returnType = generatedPropsType
<span class="linenr"> 2780: </span>        }
<span class="linenr"> 2781: </span>
<span class="linenr"> 2782: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. its children.</span>
<span class="linenr"> 2783: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.children.length; i++) {
<span class="linenr"> 2784: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">childType</span> = getConstantType(node.children[i], context)
<span class="linenr"> 2785: </span>          <span class=
"org-keyword">if</span> (childType === ConstantTypes.NOT_CONSTANT) {
<span class=
"linenr"> 2786: </span>            constantCache.set(node, ConstantTypes.NOT_CONSTANT)
<span class="linenr"> 2787: </span>            <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2788: </span>          }
<span class="linenr"> 2789: </span>          <span class=
"org-keyword">if</span> (childType &lt; returnType) {
<span class=
"linenr"> 2790: </span>            returnType = childType
<span class="linenr"> 2791: </span>          }
<span class="linenr"> 2792: </span>        }
<span class="linenr"> 2793: </span>
<span class="linenr"> 2794: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">3. if the type is not already CAN_SKIP_PATCH which is the lowest non-0</span>
<span class="linenr"> 2795: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">type, check if any of the props can cause the type to be lowered</span>
<span class="linenr"> 2796: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we can skip can_patch because it's guaranteed by the absence of a</span>
<span class="linenr"> 2797: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">patchFlag.</span>
<span class="linenr"> 2798: </span>        <span class=
"org-keyword">if</span> (returnType &gt; ConstantTypes.CAN_SKIP_PATCH) {
<span class="linenr"> 2799: </span>          <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr"> 2800: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = node.props[i]
<span class="linenr"> 2801: </span>            <span class=
"org-keyword">if</span> (p.type === NodeTypes.DIRECTIVE &amp;& p.name === <span class="org-string">'bind'</span> &amp;& p.exp) {
<span class="linenr"> 2802: </span>              <span class=
"org-keyword">const</span> <span class=
"org-variable-name">expType</span> = getConstantType(p.exp, context)
<span class="linenr"> 2803: </span>              <span class=
"org-keyword">if</span> (expType === ConstantTypes.NOT_CONSTANT) {
<span class=
"linenr"> 2804: </span>                constantCache.set(node, ConstantTypes.NOT_CONSTANT)
<span class="linenr"> 2805: </span>                <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2806: </span>              }
<span class="linenr"> 2807: </span>              <span class=
"org-keyword">if</span> (expType &lt; returnType) {
<span class=
"linenr"> 2808: </span>                returnType = expType
<span class="linenr"> 2809: </span>              }
<span class="linenr"> 2810: </span>            }
<span class="linenr"> 2811: </span>          }
<span class="linenr"> 2812: </span>        }
<span class="linenr"> 2813: </span>
<span class="linenr"> 2814: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">only svg/foreignObject could be block here, however if they are</span>
<span class="linenr"> 2815: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">static then they don't need to be blocks since there will be no</span>
<span class="linenr"> 2816: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">nested updates.</span>
<span class="linenr"> 2817: </span>        <span class=
"org-keyword">if</span> (codegenNode.isBlock) {
<span class=
"linenr"> 2818: </span>          context.removeHelper(OPEN_BLOCK)
<span class="linenr"> 2819: </span>          context.removeHelper(
<span class=
"linenr"> 2820: </span>            getVNodeBlockHelper(context.inSSR, codegenNode.isComponent)
<span class="linenr"> 2821: </span>          )
<span class=
"linenr"> 2822: </span>          codegenNode.isBlock = <span class=
"org-constant">false</span>
<span class=
"linenr"> 2823: </span>          context.helper(getVNodeHelper(context.inSSR, codegenNode.isComponent))
<span class="linenr"> 2824: </span>        }
<span class="linenr"> 2825: </span>
<span class=
"linenr"> 2826: </span>        constantCache.set(node, returnType)
<span class="linenr"> 2827: </span>        <span class=
"org-keyword">return</span> returnType
<span class="linenr"> 2828: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 2829: </span>        constantCache.set(node, ConstantTypes.NOT_CONSTANT)
<span class="linenr"> 2830: </span>        <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2831: </span>      }
<span class="linenr"> 2832: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT:
<span class="linenr"> 2833: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMMENT:
<span class="linenr"> 2834: </span>      <span class=
"org-keyword">return</span> ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 2835: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF:
<span class="linenr"> 2836: </span>    <span class=
"org-keyword">case</span> NodeTypes.FOR:
<span class="linenr"> 2837: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF_BRANCH:
<span class="linenr"> 2838: </span>      <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2839: </span>    <span class=
"org-keyword">case</span> NodeTypes.INTERPOLATION:
<span class="linenr"> 2840: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT_CALL:
<span class="linenr"> 2841: </span>      <span class=
"org-keyword">return</span> getConstantType(node.content, context)
<span class="linenr"> 2842: </span>    <span class=
"org-keyword">case</span> NodeTypes.SIMPLE_EXPRESSION:
<span class="linenr"> 2843: </span>      <span class=
"org-keyword">return</span> node.constType
<span class="linenr"> 2844: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMPOUND_EXPRESSION:
<span class="linenr"> 2845: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">returnType</span> = ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 2846: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.children.length; i++) {
<span class="linenr"> 2847: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = node.children[i]
<span class="linenr"> 2848: </span>        <span class=
"org-keyword">if</span> (isString(child) || isSymbol(child)) {
<span class="linenr"> 2849: </span>          <span class=
"org-keyword">continue</span>
<span class="linenr"> 2850: </span>        }
<span class="linenr"> 2851: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">childType</span> = getConstantType(child, context)
<span class="linenr"> 2852: </span>        <span class=
"org-keyword">if</span> (childType === ConstantTypes.NOT_CONSTANT) {
<span class="linenr"> 2853: </span>          <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2854: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (childType &lt; returnType) {
<span class="linenr"> 2855: </span>          returnType = childType
<span class="linenr"> 2856: </span>        }
<span class="linenr"> 2857: </span>      }
<span class="linenr"> 2858: </span>      <span class=
"org-keyword">return</span> returnType
<span class="linenr"> 2859: </span>    <span class=
"org-keyword">default</span>:
<span class="linenr"> 2860: </span>      <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2861: </span>  }
<span class="linenr"> 2862: </span>}
<span class="linenr"> 2863: </span>
<span class="linenr"> 2864: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">allowHoistedHelperSet</span> = <span class=
"org-keyword">new</span> <span class="org-type">Set</span>([
<span class="linenr"> 2865: </span>  NORMALIZE_CLASS,
<span class="linenr"> 2866: </span>  NORMALIZE_STYLE,
<span class="linenr"> 2867: </span>  NORMALIZE_PROPS,
<span class="linenr"> 2868: </span>  GUARD_REACTIVE_PROPS
<span class="linenr"> 2869: </span>])
<span class="linenr"> 2870: </span>
<span class="linenr"> 2871: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getConstantTypeOfHelperCall</span>(<span class=
"org-variable-name">value</span>, <span class=
"org-variable-name">context</span>){
<span class="linenr"> 2872: </span>  <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 2873: </span>    value.type === NodeTypes.JS_CALL_EXPRESSION &amp;&
<span class=
"linenr"> 2874: </span>    !isString(value.callee) &amp;&
<span class=
"linenr"> 2875: </span>    allowHoistedHelperSet.has(value.callee)
<span class="linenr"> 2876: </span>  ) {
<span class="linenr"> 2877: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">arg</span> = value.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 2878: </span>    <span class=
"org-keyword">if</span> (arg.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 2879: </span>      <span class=
"org-keyword">return</span> getConstantType(arg, context)
<span class="linenr"> 2880: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (arg.type === NodeTypes.JS_CALL_EXPRESSION) {
<span class="linenr"> 2881: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in the case of nested helper call, e.g. `normalizeProps(guardReactiveProps(exp))`</span>
<span class="linenr"> 2882: </span>      <span class=
"org-keyword">return</span> getConstantTypeOfHelperCall(arg, context)
<span class="linenr"> 2883: </span>    }
<span class="linenr"> 2884: </span>  }
<span class="linenr"> 2885: </span>  <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2886: </span>}
<span class="linenr"> 2887: </span>
<span class="linenr"> 2888: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getGeneratedPropsConstantType</span>(<span class="org-variable-name">node</span>, <span class="org-variable-name">context</span>) {
<span class="linenr"> 2889: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">returnType</span> = ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 2890: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">props</span> = getNodeProps(node)
<span class="linenr"> 2891: </span>  <span class=
"org-keyword">if</span> (props &amp;& props.type === NodeTypes.JS_OBJECT_EXPRESSION) {
<span class="linenr"> 2892: </span>    <span class=
"org-keyword">const</span> { properties } = props
<span class="linenr"> 2893: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; properties.length; i++) {
<span class="linenr"> 2894: </span>      <span class=
"org-keyword">const</span> { key, value } = properties[i]
<span class="linenr"> 2895: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyType</span> = getConstantType(key, context)
<span class="linenr"> 2896: </span>      <span class=
"org-keyword">if</span> (keyType === ConstantTypes.NOT_CONSTANT) {
<span class="linenr"> 2897: </span>        <span class=
"org-keyword">return</span> keyType
<span class="linenr"> 2898: </span>      }
<span class="linenr"> 2899: </span>      <span class=
"org-keyword">if</span> (keyType &lt; returnType) {
<span class="linenr"> 2900: </span>        returnType = keyType
<span class="linenr"> 2901: </span>      }
<span class="linenr"> 2902: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">valueType</span>
<span class="linenr"> 2903: </span>      <span class=
"org-keyword">if</span> (value.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class=
"linenr"> 2904: </span>        valueType = getConstantType(value, context)
<span class="linenr"> 2905: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (value.type === NodeTypes.JS_CALL_EXPRESSION) {
<span class="linenr"> 2906: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">some helper calls can be hoisted,</span>
<span class="linenr"> 2907: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">such as the `normalizeProps` generated by the compiler for pre-normalize class,</span>
<span class="linenr"> 2908: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in this case we need to respect the ConstantType of the helper's arguments</span>
<span class=
"linenr"> 2909: </span>        valueType = getConstantTypeOfHelperCall(value, context)
<span class="linenr"> 2910: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 2911: </span>        valueType = ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2912: </span>      }
<span class="linenr"> 2913: </span>      <span class=
"org-keyword">if</span> (valueType === ConstantTypes.NOT_CONSTANT) {
<span class="linenr"> 2914: </span>        <span class=
"org-keyword">return</span> valueType
<span class="linenr"> 2915: </span>      }
<span class="linenr"> 2916: </span>      <span class=
"org-keyword">if</span> (valueType &lt; returnType) {
<span class="linenr"> 2917: </span>        returnType = valueType
<span class="linenr"> 2918: </span>      }
<span class="linenr"> 2919: </span>    }
<span class="linenr"> 2920: </span>  }
<span class="linenr"> 2921: </span>  <span class=
"org-keyword">return</span> returnType
<span class="linenr"> 2922: </span>}
<span class="linenr"> 2923: </span>
<span class="linenr"> 2924: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getNodeProps</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr"> 2925: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">codegenNode</span> = node.codegenNode
<span class="linenr"> 2926: </span>  <span class=
"org-keyword">if</span> (codegenNode.type === NodeTypes.VNODE_CALL) {
<span class="linenr"> 2927: </span>    <span class=
"org-keyword">return</span> codegenNode.props
<span class="linenr"> 2928: </span>  }
<span class="linenr"> 2929: </span>}
<span class="linenr"> 2930: </span>
<span class="linenr"> 2931: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getPatchFlag</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr"> 2932: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">flag</span> = node.patchFlag
<span class="linenr"> 2933: </span>  <span class=
"org-keyword">return</span> flag ? parseInt(flag, <span class=
"org-highlight-numbers-number">10</span>) : <span class=
"org-constant">undefined</span>
<span class="linenr"> 2934: </span>}
<span class="linenr"> 2935: </span>
<span class="linenr"> 2936: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createRootCodegen</span>(<span class=
"org-variable-name">root</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 2937: </span>  <span class=
"org-keyword">const</span> { helper } = context
<span class="linenr"> 2938: </span>  <span class=
"org-keyword">const</span> { children } = root
<span class="linenr"> 2939: </span>  logg(<span class=
"org-string">'createRootCodegen'</span>, <span class=
"org-string">`children=${children.length}, 只有一个用 block, 多个用Fragment`</span>)
<span class="linenr"> 2940: </span>  <span class=
"org-keyword">if</span> (children.length === <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 2941: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = children[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 2942: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if the single child is an element, turn it into a block.</span>
<span class="linenr"> 2943: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">如果只有一个根元素，如： &lt;template&gt;&lt;div&gt;...&lt;/div&gt;&lt;/template&gt;</span>
<span class="linenr"> 2944: </span>    <span class=
"org-keyword">if</span> (isSingleElementRoot(root, child) &amp;& child.codegenNode) {
<span class="linenr"> 2945: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">single element root is never hoisted so codegenNode will never be</span>
<span class="linenr"> 2946: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">SimpleExpressionNode</span>
<span class="linenr"> 2947: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">codegenNode</span> = child.codegenNode
<span class="linenr"> 2948: </span>      <span class=
"org-keyword">if</span> (codegenNode.type === NodeTypes.VNODE_CALL) {
<span class=
"linenr"> 2949: </span>        makeBlock(codegenNode, context)
<span class="linenr"> 2950: </span>      }
<span class=
"linenr"> 2951: </span>      root.codegenNode = codegenNode
<span class="linenr"> 2952: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2953: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">- single &lt;slot/&gt;, IfNode, ForNode: already blocks.</span>
<span class="linenr"> 2954: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">- single text node: always patched.</span>
<span class="linenr"> 2955: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">root codegen falls through via genNode()</span>
<span class="linenr"> 2956: </span>      root.codegenNode = child
<span class="linenr"> 2957: </span>    }
<span class="linenr"> 2958: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (children.length &gt; <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 2959: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">root 下有多个节点时，使用 fragment block，3.x 特性，2.x中是不支持多个元素的</span>
<span class="linenr"> 2960: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">patchFlag</span> = PatchFlags.STABLE_FRAGMENT
<span class="linenr"> 2961: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">patchFlagText</span> = PatchFlagNames[PatchFlags.STABLE_FRAGMENT]
<span class="linenr"> 2962: </span>
<span class=
"linenr"> 2963: </span>    root.codegenNode = createVNodeCall(
<span class="linenr"> 2964: </span>      context,
<span class="linenr"> 2965: </span>      helper(FRAGMENT),
<span class="linenr"> 2966: </span>      <span class=
"org-constant">undefined</span>,
<span class="linenr"> 2967: </span>      root.children,
<span class=
"linenr"> 2968: </span>      patchFlag + (__DEV__ ? <span class=
"org-string">` /* ${patchFlagText} */`</span> : <span class=
"org-string">``</span>),
<span class="linenr"> 2969: </span>      <span class=
"org-constant">undefined</span>,
<span class="linenr"> 2970: </span>      <span class=
"org-constant">undefined</span>,
<span class="linenr"> 2971: </span>      <span class=
"org-constant">true</span>,
<span class="linenr"> 2972: </span>      <span class=
"org-constant">undefined</span>,
<span class="linenr"> 2973: </span>      <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">isComponent</span><span class=
"org-comment-delimiter"> */</span>
<span class="linenr"> 2974: </span>    )
<span class="linenr"> 2975: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2976: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no children = noop. codegen will return null.</span>
<span class="linenr"> 2977: </span>  }
<span class="linenr"> 2978: </span>}
<span class="linenr"> 2979: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createStructuralDirectiveTransform</span>(<span class="org-variable-name">name</span>, <span class="org-variable-name">fn</span>) {
<span class="linenr"> 2980: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">正则就用 test 方法，字符串直接比较</span>
<span class="linenr"> 2981: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">matches</span> = isString(name)
<span class="linenr"> 2982: </span>    ? (n) =&gt; n === name
<span class="linenr"> 2983: </span>    : (n) =&gt; name.test(n)
<span class="linenr"> 2984: </span>
<span class="linenr"> 2985: </span>  logg(<span class=
"org-string">'createStructuralDirectiveTransform'</span>, <span class="org-string">`name=${name}, matches=${matches}`</span>)
<span class="linenr"> 2986: </span>  <span class=
"org-keyword">return</span> (node, context) =&gt; {
<span class="linenr"> 2987: </span>    <span class=
"org-keyword">if</span> (node.type === NodeTypes.ELEMENT) {
<span class="linenr"> 2988: </span>      <span class=
"org-keyword">const</span> { props } = node
<span class="linenr"> 2989: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-slot 指令特殊处理，代码在 vSlot.ts 中，所以这里跳过它</span>
<span class="linenr"> 2990: </span>      <span class=
"org-keyword">if</span> (node.tagType === ElementTypes.TEMPLATE &amp;& props.some(isVSlot)) {
<span class="linenr"> 2991: </span>        <span class=
"org-keyword">return</span>
<span class="linenr"> 2992: </span>      }
<span class="linenr"> 2993: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exitFns</span> = []
<span class="linenr"> 2994: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; props.length; i++) {
<span class="linenr"> 2995: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prop</span> = props[i]
<span class="linenr"> 2996: </span>        <span class=
"org-keyword">if</span> (prop.type === NodeTypes.DIRECTIVE &amp;& matches(prop.name)) {
<span class="linenr"> 2997: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">structural directives are removed to avoid infinite recursion</span>
<span class="linenr"> 2998: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">also we remove them *before* applying so that it can further</span>
<span class="linenr"> 2999: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">traverse itself in case it moves the node around</span>
<span class=
"linenr"> 3000: </span>          props.splice(i, <span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr"> 3001: </span>          i--
<span class="linenr"> 3002: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">onExit</span> = fn(node, prop, context)
<span class="linenr"> 3003: </span>          <span class=
"org-keyword">if</span> (onExit) exitFns.push(onExit)
<span class="linenr"> 3004: </span>        }
<span class="linenr"> 3005: </span>      }
<span class="linenr"> 3006: </span>      <span class=
"org-keyword">return</span> exitFns
<span class="linenr"> 3007: </span>    }
<span class="linenr"> 3008: </span>  }
<span class="linenr"> 3009: </span>}
<span class="linenr"> 3010: </span>
<span class="linenr"> 3011: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getBaseTransformPreset</span>(<span class=
"org-variable-name">prefixIdentifiers</span>) {
<span class="linenr"> 3012: </span>  <span class=
"org-keyword">return</span> [
<span class="linenr"> 3013: </span>    [
<span class="linenr"> 3014: </span>      transformOnce,
<span class="linenr"> 3015: </span>      transformIf,
<span class="linenr"> 3016: </span>      transformMemo,
<span class="linenr"> 3017: </span>      transformFor,
<span class=
"linenr"> 3018: </span>      ...(!__BROWSER__ &amp;& prefixIdentifiers
<span class="linenr"> 3019: </span>        ? [
<span class="linenr"> 3020: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">order is important</span>
<span class="linenr"> 3021: </span>            trackVForSlotScopes,
<span class="linenr"> 3022: </span>            transformExpression
<span class="linenr"> 3023: </span>          ]
<span class=
"linenr"> 3024: </span>        : __BROWSER__ &amp;& __DEV__
<span class="linenr"> 3025: </span>        ? [transformExpression]
<span class="linenr"> 3026: </span>        : []),
<span class="linenr"> 3027: </span>      transformSlotOutlet,
<span class="linenr"> 3028: </span>      transformElement,
<span class="linenr"> 3029: </span>      trackSlotScopes,
<span class="linenr"> 3030: </span>      transformText
<span class="linenr"> 3031: </span>    ],
<span class="linenr"> 3032: </span>    {
<span class="linenr"> 3033: </span>      on: transformOn,
<span class="linenr"> 3034: </span>      bind: transformBind,
<span class="linenr"> 3035: </span>      model: transformModel
<span class="linenr"> 3036: </span>    }
<span class="linenr"> 3037: </span>  ]
<span class="linenr"> 3038: </span>}
<span class="linenr"> 3039: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">makeBlock</span>(<span class=
"org-variable-name">node</span>, { <span class=
"org-variable-name">helper</span>, <span class=
"org-variable-name">removeHelper</span>, <span class=
"org-variable-name">inSSR</span> }) {
<span class="linenr"> 3040: </span>  <span class=
"org-keyword">if</span> (!node.isBlock) {
<span class="linenr"> 3041: </span>    node.isBlock = <span class=
"org-constant">true</span>
<span class=
"linenr"> 3042: </span>    removeHelper(getVNodeHelper(inSSR, node.isComponent))
<span class="linenr"> 3043: </span>    helper(OPEN_BLOCK)
<span class=
"linenr"> 3044: </span>    helper(getVNodeBlockHelper(inSSR, node.isComponent))
<span class="linenr"> 3045: </span>  }
<span class="linenr"> 3046: </span>}
<span class="linenr"> 3047: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">defaultFallback</span> = createSimpleExpression(<span class="org-string">`undefined`</span>, <span class="org-constant">false</span>)
<span class="linenr"> 3048: </span>
<span class="linenr"> 3049: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">A NodeTransform that:</span>
<span class="linenr"> 3050: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. Tracks scope identifiers for scoped slots so that they don't get prefixed</span>
<span class="linenr"> 3051: </span><span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">by transformExpression. This is only applied in non-browser builds with</span>
<span class="linenr"> 3052: </span><span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">{ prefixIdentifiers: true }.</span>
<span class="linenr"> 3053: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. Track v-slot depths so that we know a slot is inside another slot.</span>
<span class="linenr"> 3054: </span><span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">Note the exit callback is executed before buildSlots() on the same node,</span>
<span class="linenr"> 3055: </span><span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">so only nested slots see positive numbers.</span>
<span class="linenr"> 3056: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">trackSlotScopes</span> = (node, context) =&gt; {
<span class="linenr"> 3057: </span>  <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 3058: </span>    node.type === NodeTypes.ELEMENT &amp;&
<span class=
"linenr"> 3059: </span>    (node.tagType === ElementTypes.COMPONENT ||
<span class=
"linenr"> 3060: </span>      node.tagType === ElementTypes.TEMPLATE)
<span class="linenr"> 3061: </span>  ) {
<span class="linenr"> 3062: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">We are only checking non-empty v-slot here</span>
<span class="linenr"> 3063: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">since we only care about slots that introduce scope variables.</span>
<span class="linenr"> 3064: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">vSlot</span> = findDir(node, <span class=
"org-string">'slot'</span>)
<span class="linenr"> 3065: </span>    <span class=
"org-keyword">if</span> (vSlot) {
<span class="linenr"> 3066: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotProps</span> = vSlot.exp
<span class="linenr"> 3067: </span>      <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 3068: </span>        slotProps &amp;& context.addIdentifiers(slotProps)
<span class="linenr"> 3069: </span>      }
<span class="linenr"> 3070: </span>      context.scopes.vSlot++
<span class="linenr"> 3071: </span>      <span class=
"org-keyword">return</span> () =&gt; {
<span class="linenr"> 3072: </span>        <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 3073: </span>          slotProps &amp;& context.removeIdentifiers(slotProps)
<span class="linenr"> 3074: </span>        }
<span class="linenr"> 3075: </span>        context.scopes.vSlot--
<span class="linenr"> 3076: </span>      }
<span class="linenr"> 3077: </span>    }
<span class="linenr"> 3078: </span>  }
<span class="linenr"> 3079: </span>}
<span class="linenr"> 3080: </span>
<span class="linenr"> 3081: </span>
<span class="linenr"> 3082: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">A NodeTransform that tracks scope identifiers for scoped slots with v-for.</span>
<span class="linenr"> 3083: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">This transform is only applied in non-browser builds with { prefixIdentifiers: true }</span>
<span class="linenr"> 3084: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">trackVForSlotScopes</span> = (node, context) =&gt; {
<span class="linenr"> 3085: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vFor</span>
<span class="linenr"> 3086: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 3087: </span>    isTemplateNode(node) &amp;&
<span class=
"linenr"> 3088: </span>    node.props.some(isVSlot) &amp;&
<span class=
"linenr"> 3089: </span>    (vFor = findDir(node, <span class=
"org-string">'for'</span>))
<span class="linenr"> 3090: </span>  ) {
<span class="linenr"> 3091: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">result</span> = (vFor.parseResult = parseForExpression(
<span class="linenr"> 3092: </span>      vFor.exp,
<span class="linenr"> 3093: </span>      context
<span class="linenr"> 3094: </span>    ))
<span class="linenr"> 3095: </span>    <span class=
"org-keyword">if</span> (result) {
<span class="linenr"> 3096: </span>      <span class=
"org-keyword">const</span> { value, key, index } = result
<span class="linenr"> 3097: </span>      <span class=
"org-keyword">const</span> { addIdentifiers, removeIdentifiers } = context
<span class=
"linenr"> 3098: </span>      value &amp;& addIdentifiers(value)
<span class=
"linenr"> 3099: </span>      key &amp;& addIdentifiers(key)
<span class=
"linenr"> 3100: </span>      index &amp;& addIdentifiers(index)
<span class="linenr"> 3101: </span>
<span class="linenr"> 3102: </span>      <span class=
"org-keyword">return</span> () =&gt; {
<span class=
"linenr"> 3103: </span>        value &amp;& removeIdentifiers(value)
<span class=
"linenr"> 3104: </span>        key &amp;& removeIdentifiers(key)
<span class=
"linenr"> 3105: </span>        index &amp;& removeIdentifiers(index)
<span class="linenr"> 3106: </span>      }
<span class="linenr"> 3107: </span>    }
<span class="linenr"> 3108: </span>  }
<span class="linenr"> 3109: </span>}
<span class="linenr"> 3110: </span>
<span class="linenr"> 3111: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">buildClientSlotFn</span> = (props, children, loc) =&gt;
<span class="linenr"> 3112: </span>  createFunctionExpression(
<span class="linenr"> 3113: </span>    props,
<span class="linenr"> 3114: </span>    children,
<span class="linenr"> 3115: </span>    <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">newline</span><span class=
"org-comment-delimiter"> */</span>,
<span class="linenr"> 3116: </span>    <span class=
"org-constant">true</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">isSlot</span><span class=
"org-comment-delimiter"> */</span>,
<span class=
"linenr"> 3117: </span>    children.length ? children[<span class=
"org-highlight-numbers-number">0</span>].loc : loc
<span class="linenr"> 3118: </span>  )
<span class="linenr"> 3119: </span>
<span class="linenr"> 3120: </span>
<span class="linenr"> 3121: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Instead of being a DirectiveTransform, v-slot processing is called during</span>
<span class="linenr"> 3122: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">transformElement to build the slots object for a component.</span>
<span class="linenr"> 3123: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">buildSlots</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">buildSlotFn</span>= <span class=
"org-variable-name">buildClientSlotFn</span>) {
<span class="linenr"> 3124: </span>  context.helper(WITH_CTX)
<span class="linenr"> 3125: </span>
<span class="linenr"> 3126: </span>  <span class=
"org-keyword">const</span> { children, loc } = node
<span class="linenr"> 3127: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotsProperties</span> = []
<span class="linenr"> 3128: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">dynamicSlots</span>= []
<span class="linenr"> 3129: </span>
<span class="linenr"> 3130: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">If the slot is inside a v-for or another v-slot, force it to be dynamic</span>
<span class="linenr"> 3131: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">since it likely uses a scope variable.</span>
<span class="linenr"> 3132: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasDynamicSlots</span> = context.scopes.vSlot &gt; <span class="org-highlight-numbers-number">0</span> || context.scopes.vFor &gt; <span class="org-highlight-numbers-number">0</span>
<span class="linenr"> 3133: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">with `prefixIdentifiers: true`, this can be further optimized to make</span>
<span class="linenr"> 3134: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">it dynamic only when the slot actually uses the scope variables.</span>
<span class="linenr"> 3135: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& !context.ssr &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 3136: </span>    hasDynamicSlots = hasScopeRef(node, context.identifiers)
<span class="linenr"> 3137: </span>  }
<span class="linenr"> 3138: </span>
<span class="linenr"> 3139: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. Check for slot with slotProps on component itself.</span>
<span class="linenr"> 3140: </span>  <span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">&lt;Comp v-slot="{ prop }"/&gt;</span>
<span class="linenr"> 3141: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">onComponentSlot</span> = findDir(node, <span class="org-string">'slot'</span>, <span class="org-constant">true</span>)
<span class="linenr"> 3142: </span>  <span class=
"org-keyword">if</span> (onComponentSlot) {
<span class="linenr"> 3143: </span>    <span class=
"org-keyword">const</span> { arg, exp } = onComponentSlot
<span class="linenr"> 3144: </span>    <span class=
"org-keyword">if</span> (arg &amp;& !isStaticExp(arg)) {
<span class=
"linenr"> 3145: </span>      hasDynamicSlots = <span class=
"org-constant">true</span>
<span class="linenr"> 3146: </span>    }
<span class="linenr"> 3147: </span>    slotsProperties.push(
<span class="linenr"> 3148: </span>      createObjectProperty(
<span class=
"linenr"> 3149: </span>        arg || createSimpleExpression(<span class="org-string">'default'</span>, <span class="org-constant">true</span>),
<span class=
"linenr"> 3150: </span>        buildSlotFn(exp, children, loc)
<span class="linenr"> 3151: </span>      )
<span class="linenr"> 3152: </span>    )
<span class="linenr"> 3153: </span>  }
<span class="linenr"> 3154: </span>
<span class="linenr"> 3155: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. Iterate through children and check for template slots</span>
<span class="linenr"> 3156: </span>  <span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">&lt;template v-slot:foo="{ prop }"&gt;</span>
<span class="linenr"> 3157: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasTemplateSlots</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3158: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasNamedDefaultSlot</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3159: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">implicitDefaultChildren</span> = []
<span class="linenr"> 3160: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">seenSlotNames</span> = <span class=
"org-keyword">new</span> <span class="org-type">Set</span>()
<span class="linenr"> 3161: </span>
<span class="linenr"> 3162: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; children.length; i++) {
<span class="linenr"> 3163: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotElement</span> = children[i]
<span class="linenr"> 3164: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">slotDir</span>
<span class="linenr"> 3165: </span>
<span class="linenr"> 3166: </span>    <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 3167: </span>      !isTemplateNode(slotElement) ||
<span class=
"linenr"> 3168: </span>      !(slotDir = findDir(slotElement, <span class="org-string">'slot'</span>, <span class="org-constant">true</span>))
<span class="linenr"> 3169: </span>    ) { <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">收集不在 template v-slot 中的元素/组件，这些都会合并到默认插槽中去</span>
<span class="linenr"> 3170: </span>      <span class=
"org-keyword">if</span> (slotElement.type !== NodeTypes.COMMENT) {
<span class=
"linenr"> 3171: </span>        implicitDefaultChildren.push(slotElement)
<span class="linenr"> 3172: </span>      }
<span class="linenr"> 3173: </span>      <span class=
"org-keyword">continue</span>
<span class="linenr"> 3174: </span>    }
<span class="linenr"> 3175: </span>
<span class="linenr"> 3176: </span>    <span class=
"org-keyword">if</span> (onComponentSlot) {
<span class="linenr"> 3177: </span>      logg(<span class=
"org-string">`buildSlots already has on-component slot - this is incorrect usage`</span>)
<span class="linenr"> 3178: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 3179: </span>    }
<span class="linenr"> 3180: </span>
<span class=
"linenr"> 3181: </span>    hasTemplateSlots = <span class=
"org-constant">true</span>
<span class="linenr"> 3182: </span>    <span class=
"org-keyword">const</span> { children: <span class=
"org-variable-name">slotChildren</span>, loc: <span class=
"org-variable-name">slotLoc</span> } = slotElement
<span class="linenr"> 3183: </span>    <span class=
"org-keyword">const</span> {
<span class=
"linenr"> 3184: </span>      arg: slotName = createSimpleExpression(<span class="org-string">`default`</span>, <span class="org-constant">true</span>),
<span class="linenr"> 3185: </span>      exp: slotProps,
<span class="linenr"> 3186: </span>      loc: dirLoc
<span class="linenr"> 3187: </span>    } = slotDir
<span class="linenr"> 3188: </span>
<span class="linenr"> 3189: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check if name is dynamic.</span>
<span class="linenr"> 3190: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">staticSlotName</span>
<span class="linenr"> 3191: </span>    <span class=
"org-keyword">if</span> (isStaticExp(slotName)) {
<span class=
"linenr"> 3192: </span>      staticSlotName = slotName ? slotName.content : <span class="org-string">`default`</span>
<span class="linenr"> 3193: </span>    } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 3194: </span>      hasDynamicSlots = <span class=
"org-constant">true</span>
<span class="linenr"> 3195: </span>    }
<span class="linenr"> 3196: </span>
<span class="linenr"> 3197: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotFunction</span> = buildSlotFn(slotProps, slotChildren, slotLoc)
<span class="linenr"> 3198: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check if this slot is conditional (v-if/v-for)</span>
<span class="linenr"> 3199: </span>    <span class=
"org-keyword">let</span> <span class="org-variable-name">vIf</span>
<span class="linenr"> 3200: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vElse</span>
<span class="linenr"> 3201: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vFor</span>
<span class="linenr"> 3202: </span>    <span class=
"org-keyword">if</span> ((vIf = findDir(slotElement, <span class=
"org-string">'if'</span>))) {
<span class=
"linenr"> 3203: </span>      hasDynamicSlots = <span class=
"org-constant">true</span>
<span class="linenr"> 3204: </span>      dynamicSlots.push(
<span class=
"linenr"> 3205: </span>        createConditionalExpression(
<span class="linenr"> 3206: </span>          vIf.exp,
<span class=
"linenr"> 3207: </span>          buildDynamicSlot(slotName, slotFunction),
<span class="linenr"> 3208: </span>          defaultFallback
<span class="linenr"> 3209: </span>        )
<span class="linenr"> 3210: </span>      )
<span class="linenr"> 3211: </span>    } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr"> 3212: </span>      (vElse = findDir(slotElement, <span class="org-string">/^else(-if)?$/</span>, <span class="org-constant">true</span> <span class="org-comment-delimiter">/* </span><span class="org-comment">allowEmpty</span><span class="org-comment-delimiter"> */</span>))
<span class="linenr"> 3213: </span>    ) {
<span class="linenr"> 3214: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">find adjacent v-if</span>
<span class="linenr"> 3215: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">j</span> = i
<span class="linenr"> 3216: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">prev</span>
<span class="linenr"> 3217: </span>      <span class=
"org-keyword">while</span> (j--) {
<span class="linenr"> 3218: </span>        prev = children[j]
<span class="linenr"> 3219: </span>        <span class=
"org-keyword">if</span> (prev.type !== NodeTypes.COMMENT) {
<span class="linenr"> 3220: </span>          <span class=
"org-keyword">break</span>
<span class="linenr"> 3221: </span>        }
<span class="linenr"> 3222: </span>      }
<span class="linenr"> 3223: </span>      <span class=
"org-keyword">if</span> (prev &amp;& isTemplateNode(prev) &amp;& findDir(prev, <span class="org-string">'if'</span>)) {
<span class="linenr"> 3224: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">remove node</span>
<span class=
"linenr"> 3225: </span>        children.splice(i, <span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr"> 3226: </span>        i--
<span class="linenr"> 3227: </span>
<span class="linenr"> 3228: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">attach this slot to previous conditional</span>
<span class="linenr"> 3229: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">conditional</span> = dynamicSlots[
<span class=
"linenr"> 3230: </span>          dynamicSlots.length - <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 3231: </span>        ]
<span class="linenr"> 3232: </span>        <span class=
"org-keyword">while</span> (
<span class=
"linenr"> 3233: </span>          conditional.alternate.type === NodeTypes.JS_CONDITIONAL_EXPRESSION
<span class="linenr"> 3234: </span>        ) {
<span class=
"linenr"> 3235: </span>          conditional = conditional.alternate
<span class="linenr"> 3236: </span>        }
<span class=
"linenr"> 3237: </span>        conditional.alternate = vElse.exp
<span class=
"linenr"> 3238: </span>          ? createConditionalExpression(
<span class="linenr"> 3239: </span>              vElse.exp,
<span class=
"linenr"> 3240: </span>              buildDynamicSlot(slotName, slotFunction),
<span class="linenr"> 3241: </span>              defaultFallback
<span class="linenr"> 3242: </span>            )
<span class=
"linenr"> 3243: </span>          : buildDynamicSlot(slotName, slotFunction)
<span class="linenr"> 3244: </span>      }
<span class="linenr"> 3245: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> ((vFor = findDir(slotElement, <span class=
"org-string">'for'</span>))) {
<span class=
"linenr"> 3246: </span>      hasDynamicSlots = <span class=
"org-constant">true</span>
<span class="linenr"> 3247: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parseResult</span> =
<span class="linenr"> 3248: </span>        vFor.parseResult ||
<span class=
"linenr"> 3249: </span>        parseForExpression(vFor.exp , context)
<span class="linenr"> 3250: </span>      <span class=
"org-keyword">if</span> (parseResult) {
<span class="linenr"> 3251: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Render the dynamic slots as an array and add it to the createSlot()</span>
<span class="linenr"> 3252: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">args. The runtime knows how to handle it appropriately.</span>
<span class="linenr"> 3253: </span>        dynamicSlots.push(
<span class=
"linenr"> 3254: </span>          createCallExpression(context.helper(RENDER_LIST), [
<span class="linenr"> 3255: </span>            parseResult.source,
<span class=
"linenr"> 3256: </span>            createFunctionExpression(
<span class=
"linenr"> 3257: </span>              createForLoopParams(parseResult),
<span class=
"linenr"> 3258: </span>              buildDynamicSlot(slotName, slotFunction),
<span class="linenr"> 3259: </span>              <span class=
"org-constant">true</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">force newline</span><span class=
"org-comment-delimiter"> */</span>
<span class="linenr"> 3260: </span>            )
<span class="linenr"> 3261: </span>          ])
<span class="linenr"> 3262: </span>        )
<span class="linenr"> 3263: </span>      }
<span class="linenr"> 3264: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 3265: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check duplicate static names</span>
<span class="linenr"> 3266: </span>      <span class=
"org-keyword">if</span> (staticSlotName) {
<span class="linenr"> 3267: </span>        <span class=
"org-keyword">if</span> (seenSlotNames.has(staticSlotName)) {
<span class="linenr"> 3268: </span>          logg(<span class=
"org-string">`buildSlots seenSlotNames has slot name`</span>)
<span class="linenr"> 3269: </span>          <span class=
"org-keyword">continue</span>
<span class="linenr"> 3270: </span>        }
<span class=
"linenr"> 3271: </span>        seenSlotNames.add(staticSlotName)
<span class="linenr"> 3272: </span>        <span class=
"org-keyword">if</span> (staticSlotName === <span class=
"org-string">'default'</span>) {
<span class=
"linenr"> 3273: </span>          hasNamedDefaultSlot = <span class=
"org-constant">true</span>
<span class="linenr"> 3274: </span>        }
<span class="linenr"> 3275: </span>      }
<span class=
"linenr"> 3276: </span>      slotsProperties.push(createObjectProperty(slotName, slotFunction))
<span class="linenr"> 3277: </span>    }
<span class="linenr"> 3278: </span>  }
<span class="linenr"> 3279: </span>
<span class="linenr"> 3280: </span>  <span class=
"org-keyword">if</span> (!onComponentSlot) {
<span class="linenr"> 3281: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">buildDefaultSlotProperty</span> = (props, children) =&gt; {
<span class="linenr"> 3282: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">fn</span> = buildSlotFn(props, children, loc)
<span class="linenr"> 3283: </span>
<span class="linenr"> 3284: </span>      <span class=
"org-keyword">return</span> createObjectProperty(<span class=
"org-string">`default`</span>, fn)
<span class="linenr"> 3285: </span>    }
<span class="linenr"> 3286: </span>
<span class="linenr"> 3287: </span>    <span class=
"org-keyword">if</span> (!hasTemplateSlots) {
<span class="linenr"> 3288: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">implicit default slot (on component)</span>
<span class=
"linenr"> 3289: </span>      slotsProperties.push(buildDefaultSlotProperty(<span class="org-constant">undefined</span>, children))
<span class="linenr"> 3290: </span>    } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr"> 3291: </span>      implicitDefaultChildren.length &amp;&
<span class="linenr"> 3292: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#3766</span>
<span class="linenr"> 3293: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">with whitespace: 'preserve', whitespaces between slots will end up in</span>
<span class="linenr"> 3294: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">implicitDefaultChildren. Ignore if all implicit children are whitespaces.</span>
<span class=
"linenr"> 3295: </span>      implicitDefaultChildren.some(node =&gt; isNonWhitespaceContent(node))
<span class="linenr"> 3296: </span>    ) {
<span class="linenr"> 3297: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">implicit default slot (mixed with named slots)</span>
<span class="linenr"> 3298: </span>      <span class=
"org-keyword">if</span> (hasNamedDefaultSlot) {
<span class="linenr"> 3299: </span>        logg(<span class=
"org-string">`buildSlots hasNamedDefaultSlot`</span>)
<span class="linenr"> 3300: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 3301: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">合并到默认插槽</span>
<span class="linenr"> 3302: </span>        slotsProperties.push(
<span class=
"linenr"> 3303: </span>          buildDefaultSlotProperty(<span class="org-constant">undefined</span>, implicitDefaultChildren)
<span class="linenr"> 3304: </span>        )
<span class="linenr"> 3305: </span>      }
<span class="linenr"> 3306: </span>    }
<span class="linenr"> 3307: </span>  }
<span class="linenr"> 3308: </span>
<span class="linenr"> 3309: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotFlag</span> = hasDynamicSlots
<span class="linenr"> 3310: </span>    ? SlotFlags.DYNAMIC
<span class=
"linenr"> 3311: </span>    : hasForwardedSlots(node.children)
<span class="linenr"> 3312: </span>    ? SlotFlags.FORWARDED
<span class="linenr"> 3313: </span>    : SlotFlags.STABLE
<span class="linenr"> 3314: </span>
<span class="linenr"> 3315: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">slots</span> = createObjectExpression(
<span class="linenr"> 3316: </span>    slotsProperties.concat(
<span class="linenr"> 3317: </span>      createObjectProperty(
<span class="linenr"> 3318: </span>        <span class=
"org-string">`_`</span>,
<span class="linenr"> 3319: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2 = compiled but dynamic = can skip normalization, but must run diff</span>
<span class="linenr"> 3320: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1 = compiled and static = can skip normalization AND diff as optimized</span>
<span class="linenr"> 3321: </span>        createSimpleExpression(
<span class=
"linenr"> 3322: </span>          slotFlag + (__DEV__ ? <span class=
"org-string">` /* ${slotFlagsText[slotFlag]} */`</span> : <span class="org-string">``</span>),
<span class="linenr"> 3323: </span>          <span class=
"org-constant">false</span>
<span class="linenr"> 3324: </span>        )
<span class="linenr"> 3325: </span>      )
<span class="linenr"> 3326: </span>    ),
<span class="linenr"> 3327: </span>    loc
<span class="linenr"> 3328: </span>  )
<span class="linenr"> 3329: </span>  <span class=
"org-keyword">if</span> (dynamicSlots.length) {
<span class=
"linenr"> 3330: </span>    slots = createCallExpression(context.helper(CREATE_SLOTS), [
<span class="linenr"> 3331: </span>      slots,
<span class=
"linenr"> 3332: </span>      createArrayExpression(dynamicSlots)
<span class="linenr"> 3333: </span>    ])
<span class="linenr"> 3334: </span>  }
<span class="linenr"> 3335: </span>
<span class="linenr"> 3336: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 3337: </span>    slots,
<span class="linenr"> 3338: </span>    hasDynamicSlots
<span class="linenr"> 3339: </span>  }
<span class="linenr"> 3340: </span>}
<span class="linenr"> 3341: </span>
<span class="linenr"> 3342: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">buildDynamicSlot</span>(<span class=
"org-variable-name">name</span>, <span class=
"org-variable-name">fn</span>) {
<span class="linenr"> 3343: </span>  <span class=
"org-keyword">return</span> createObjectExpression([
<span class=
"linenr"> 3344: </span>    createObjectProperty(<span class=
"org-string">`name`</span>, name),
<span class=
"linenr"> 3345: </span>    createObjectProperty(<span class=
"org-string">`fn`</span>, fn)
<span class="linenr"> 3346: </span>  ])
<span class="linenr"> 3347: </span>}
<span class="linenr"> 3348: </span>
<span class="linenr"> 3349: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">hasForwardedSlots</span>(<span class=
"org-variable-name">children</span>) {
<span class="linenr"> 3350: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; children.length; i++) {
<span class="linenr"> 3351: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = children[i]
<span class="linenr"> 3352: </span>    <span class=
"org-keyword">switch</span> (child.type) {
<span class="linenr"> 3353: </span>      <span class=
"org-keyword">case</span> NodeTypes.ELEMENT:
<span class="linenr"> 3354: </span>        <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 3355: </span>          child.tagType === ElementTypes.SLOT ||
<span class=
"linenr"> 3356: </span>          hasForwardedSlots(child.children)
<span class="linenr"> 3357: </span>        ) {
<span class="linenr"> 3358: </span>          <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 3359: </span>        }
<span class="linenr"> 3360: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 3361: </span>      <span class=
"org-keyword">case</span> NodeTypes.IF:
<span class="linenr"> 3362: </span>        <span class=
"org-keyword">if</span> (hasForwardedSlots(child.branches)) <span class="org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 3363: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 3364: </span>      <span class=
"org-keyword">case</span> NodeTypes.IF_BRANCH:
<span class="linenr"> 3365: </span>      <span class=
"org-keyword">case</span> NodeTypes.FOR:
<span class="linenr"> 3366: </span>        <span class=
"org-keyword">if</span> (hasForwardedSlots(child.children)) <span class="org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 3367: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 3368: </span>      <span class=
"org-keyword">default</span>:
<span class="linenr"> 3369: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 3370: </span>    }
<span class="linenr"> 3371: </span>  }
<span class="linenr"> 3372: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 3373: </span>}
<span class="linenr"> 3374: </span>
<span class="linenr"> 3375: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isNonWhitespaceContent</span>(<span class=
"org-variable-name">node</span>){
<span class="linenr"> 3376: </span>  <span class=
"org-keyword">if</span> (node.type !== NodeTypes.TEXT &amp;& node.type !== NodeTypes.TEXT_CALL)
<span class="linenr"> 3377: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 3378: </span>  <span class=
"org-keyword">return</span> node.type === NodeTypes.TEXT
<span class="linenr"> 3379: </span>    ? !!node.content.trim()
<span class=
"linenr"> 3380: </span>    : isNonWhitespaceContent(node.content)
<span class="linenr"> 3381: </span>}
<span class="linenr"> 3382: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">some directive transforms (e.g. v-model) may return a symbol for runtime</span>
<span class="linenr"> 3383: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">import, which should be used instead of a resolveDirective call.</span>
<span class="linenr"> 3384: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">directiveImportMap</span> = <span class=
"org-keyword">new</span> <span class="org-type">WeakMap</span>()
<span class="linenr"> 3385: </span>
<span class="linenr"> 3386: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">generate a JavaScript AST for this element's codegen</span>
<span class="linenr"> 3387: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformElement</span> = (node, context) =&gt; {
<span class="linenr"> 3388: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">perform the work on exit, after all child expressions have been</span>
<span class="linenr"> 3389: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">processed and merged.</span>
<span class="linenr"> 3390: </span>  <span class=
"org-keyword">return</span> <span class=
"org-keyword">function</span> postTransformElement() {
<span class="linenr"> 3391: </span>    node = context.currentNode
<span class="linenr"> 3392: </span>
<span class="linenr"> 3393: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr"> 3394: </span>      !(
<span class=
"linenr"> 3395: </span>        node.type === NodeTypes.ELEMENT &amp;&
<span class=
"linenr"> 3396: </span>        (node.tagType === ElementTypes.ELEMENT ||
<span class=
"linenr"> 3397: </span>          node.tagType === ElementTypes.COMPONENT)
<span class="linenr"> 3398: </span>      )
<span class="linenr"> 3399: </span>    ) {
<span class="linenr"> 3400: </span>      <span class=
"org-keyword">return</span>
<span class="linenr"> 3401: </span>    }
<span class="linenr"> 3402: </span>
<span class="linenr"> 3403: </span>    <span class=
"org-keyword">const</span> { tag, props } = node
<span class="linenr"> 3404: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isComponent</span> = node.tagType === ElementTypes.COMPONENT
<span class="linenr"> 3405: </span>
<span class="linenr"> 3406: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">The goal of the transform is to create a codegenNode implementing the</span>
<span class="linenr"> 3407: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">VNodeCall interface.</span>
<span class="linenr"> 3408: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vnodeTag</span> = isComponent
<span class=
"linenr"> 3409: </span>      ? resolveComponentType(node, context)
<span class="linenr"> 3410: </span>      : <span class=
"org-string">`"${tag}"`</span>
<span class="linenr"> 3411: </span>
<span class="linenr"> 3412: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDynamicComponent</span> =
<span class=
"linenr"> 3413: </span>      isObject(vnodeTag) &amp;& vnodeTag.callee === RESOLVE_DYNAMIC_COMPONENT
<span class="linenr"> 3414: </span>
<span class="linenr"> 3415: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vnodeProps</span>
<span class="linenr"> 3416: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vnodeChildren</span>
<span class="linenr"> 3417: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vnodePatchFlag</span>
<span class="linenr"> 3418: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">patchFlag</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 3419: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vnodeDynamicProps</span>
<span class="linenr"> 3420: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">dynamicPropNames</span>
<span class="linenr"> 3421: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vnodeDirectives</span>
<span class="linenr"> 3422: </span>
<span class="linenr"> 3423: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">shouldUseBlock</span> =
<span class="linenr"> 3424: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">dynamic component may resolve to plain elements</span>
<span class="linenr"> 3425: </span>      isDynamicComponent ||
<span class="linenr"> 3426: </span>      vnodeTag === TELEPORT ||
<span class="linenr"> 3427: </span>      vnodeTag === SUSPENSE ||
<span class="linenr"> 3428: </span>      (!isComponent &amp;&
<span class="linenr"> 3429: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;svg&gt; and &lt;foreignObject&gt; must be forced into blocks so that block</span>
<span class="linenr"> 3430: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">updates inside get proper isSVG flag at runtime. (#639, #643)</span>
<span class="linenr"> 3431: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">This is technically web-specific, but splitting the logic out of core</span>
<span class="linenr"> 3432: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">leads to too much unnecessary complexity.</span>
<span class="linenr"> 3433: </span>        (tag === <span class=
"org-string">'svg'</span> || tag === <span class=
"org-string">'foreignObject'</span>))
<span class="linenr"> 3434: </span>
<span class="linenr"> 3435: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props</span>
<span class="linenr"> 3436: </span>    <span class=
"org-keyword">if</span> (props.length &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 3437: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">propsBuildResult</span> = buildProps(node, context)
<span class=
"linenr"> 3438: </span>      vnodeProps = propsBuildResult.props
<span class=
"linenr"> 3439: </span>      patchFlag = propsBuildResult.patchFlag
<span class=
"linenr"> 3440: </span>      dynamicPropNames = propsBuildResult.dynamicPropNames
<span class="linenr"> 3441: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">directives</span> = propsBuildResult.directives
<span class="linenr"> 3442: </span>      vnodeDirectives =
<span class=
"linenr"> 3443: </span>        directives &amp;& directives.length
<span class=
"linenr"> 3444: </span>          ? (createArrayExpression(
<span class=
"linenr"> 3445: </span>              directives.map(dir =&gt; buildDirectiveArgs(dir, context))
<span class="linenr"> 3446: </span>            ))
<span class="linenr"> 3447: </span>          : <span class=
"org-constant">undefined</span>
<span class="linenr"> 3448: </span>
<span class="linenr"> 3449: </span>      <span class=
"org-keyword">if</span> (propsBuildResult.shouldUseBlock) {
<span class=
"linenr"> 3450: </span>        shouldUseBlock = <span class=
"org-constant">true</span>
<span class="linenr"> 3451: </span>      }
<span class="linenr"> 3452: </span>    }
<span class="linenr"> 3453: </span>
<span class="linenr"> 3454: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">children</span>
<span class="linenr"> 3455: </span>    <span class=
"org-keyword">if</span> (node.children.length &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 3456: </span>      <span class=
"org-keyword">if</span> (vnodeTag === KEEP_ALIVE) {
<span class="linenr"> 3457: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Although a built-in component, we compile KeepAlive with raw children</span>
<span class="linenr"> 3458: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">instead of slot functions so that it can be used inside Transition</span>
<span class="linenr"> 3459: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">or other Transition-wrapping HOCs.</span>
<span class="linenr"> 3460: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">To ensure correct updates with block optimizations, we need to:</span>
<span class="linenr"> 3461: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. Force keep-alive into a block. This avoids its children being</span>
<span class="linenr"> 3462: </span>        <span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">collected by a parent block.</span>
<span class=
"linenr"> 3463: </span>        shouldUseBlock = <span class=
"org-constant">true</span>
<span class="linenr"> 3464: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. Force keep-alive to always be updated, since it uses raw children.</span>
<span class=
"linenr"> 3465: </span>        patchFlag |= PatchFlags.DYNAMIC_SLOTS
<span class="linenr"> 3466: </span>      }
<span class="linenr"> 3467: </span>
<span class="linenr"> 3468: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">shouldBuildAsSlots</span> =
<span class="linenr"> 3469: </span>        isComponent &amp;&
<span class="linenr"> 3470: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Teleport is not a real component and has dedicated runtime handling</span>
<span class=
"linenr"> 3471: </span>        vnodeTag !== TELEPORT &amp;&
<span class="linenr"> 3472: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">explained above.</span>
<span class="linenr"> 3473: </span>        vnodeTag !== KEEP_ALIVE
<span class="linenr"> 3474: </span>
<span class="linenr"> 3475: </span>      <span class=
"org-keyword">if</span> (shouldBuildAsSlots) {
<span class="linenr"> 3476: </span>        <span class=
"org-keyword">const</span> { slots, hasDynamicSlots } = buildSlots(node, context)
<span class="linenr"> 3477: </span>        vnodeChildren = slots
<span class="linenr"> 3478: </span>        <span class=
"org-keyword">if</span> (hasDynamicSlots) {
<span class=
"linenr"> 3479: </span>          patchFlag |= PatchFlags.DYNAMIC_SLOTS
<span class="linenr"> 3480: </span>        }
<span class="linenr"> 3481: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.children.length === <span class=
"org-highlight-numbers-number">1</span> &amp;& vnodeTag !== TELEPORT) {
<span class="linenr"> 3482: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = node.children[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 3483: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = child.type
<span class="linenr"> 3484: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check for dynamic text children</span>
<span class="linenr"> 3485: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hasDynamicTextChild</span> =
<span class=
"linenr"> 3486: </span>          type === NodeTypes.INTERPOLATION ||
<span class=
"linenr"> 3487: </span>          type === NodeTypes.COMPOUND_EXPRESSION
<span class="linenr"> 3488: </span>        <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 3489: </span>          hasDynamicTextChild &amp;&
<span class=
"linenr"> 3490: </span>          getConstantType(child, context) === ConstantTypes.NOT_CONSTANT
<span class="linenr"> 3491: </span>        ) {
<span class=
"linenr"> 3492: </span>          patchFlag |= PatchFlags.TEXT
<span class="linenr"> 3493: </span>        }
<span class="linenr"> 3494: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">pass directly if the only child is a text node</span>
<span class="linenr"> 3495: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">(plain / interpolation / expression)</span>
<span class="linenr"> 3496: </span>        <span class=
"org-keyword">if</span> (hasDynamicTextChild || type === NodeTypes.TEXT) {
<span class="linenr"> 3497: </span>          vnodeChildren = child
<span class="linenr"> 3498: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 3499: </span>          vnodeChildren = node.children
<span class="linenr"> 3500: </span>        }
<span class="linenr"> 3501: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 3502: </span>        vnodeChildren = node.children
<span class="linenr"> 3503: </span>      }
<span class="linenr"> 3504: </span>    }
<span class="linenr"> 3505: </span>
<span class="linenr"> 3506: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">patchFlag & dynamicPropNames</span>
<span class="linenr"> 3507: </span>    <span class=
"org-keyword">if</span> (patchFlag !== <span class=
"org-highlight-numbers-number">0</span>) {
<span class=
"linenr"> 3508: </span>      vnodePatchFlag = String(patchFlag)
<span class="linenr"> 3509: </span>      <span class=
"org-keyword">if</span> (dynamicPropNames &amp;& dynamicPropNames.length) {
<span class=
"linenr"> 3510: </span>        vnodeDynamicProps = stringifyDynamicPropNames(dynamicPropNames)
<span class="linenr"> 3511: </span>      }
<span class="linenr"> 3512: </span>    }
<span class="linenr"> 3513: </span>
<span class=
"linenr"> 3514: </span>    node.codegenNode = createVNodeCall(
<span class="linenr"> 3515: </span>      context,
<span class="linenr"> 3516: </span>      vnodeTag,
<span class="linenr"> 3517: </span>      vnodeProps,
<span class="linenr"> 3518: </span>      vnodeChildren,
<span class="linenr"> 3519: </span>      vnodePatchFlag,
<span class="linenr"> 3520: </span>      vnodeDynamicProps,
<span class="linenr"> 3521: </span>      vnodeDirectives,
<span class="linenr"> 3522: </span>      !!shouldUseBlock,
<span class="linenr"> 3523: </span>      <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">disableTracking</span><span class=
"org-comment-delimiter"> */</span>,
<span class="linenr"> 3524: </span>      isComponent,
<span class="linenr"> 3525: </span>      node.loc
<span class="linenr"> 3526: </span>    )
<span class="linenr"> 3527: </span>  }
<span class="linenr"> 3528: </span>}
<span class="linenr"> 3529: </span>
<span class="linenr"> 3530: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">resolveComponentType</span>(
<span class="linenr"> 3531: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 3532: </span>  <span class=
"org-variable-name">context</span>,
<span class="linenr"> 3533: </span>  ssr = <span class=
"org-constant">false</span>
<span class="linenr"> 3534: </span>) {
<span class="linenr"> 3535: </span>  <span class=
"org-keyword">let</span> { tag } = node
<span class="linenr"> 3536: </span>
<span class="linenr"> 3537: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. dynamic component</span>
<span class="linenr"> 3538: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isExplicitDynamic</span> = isComponentTag(tag)
<span class="linenr"> 3539: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isProp</span> = findProp(node, <span class=
"org-string">'is'</span>)
<span class="linenr"> 3540: </span>  <span class=
"org-keyword">if</span> (isProp) {
<span class="linenr"> 3541: </span>    <span class=
"org-keyword">if</span> (isExplicitDynamic ) {
<span class="linenr"> 3542: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exp</span> =
<span class=
"linenr"> 3543: </span>        isProp.type === NodeTypes.ATTRIBUTE
<span class=
"linenr"> 3544: </span>          ? isProp.value &amp;& createSimpleExpression(isProp.value.content, <span class="org-constant">true</span>)
<span class="linenr"> 3545: </span>          : isProp.exp
<span class="linenr"> 3546: </span>      <span class=
"org-keyword">if</span> (exp) {
<span class="linenr"> 3547: </span>        <span class=
"org-keyword">return</span> createCallExpression(context.helper(RESOLVE_DYNAMIC_COMPONENT), [
<span class="linenr"> 3548: </span>          exp
<span class="linenr"> 3549: </span>        ])
<span class="linenr"> 3550: </span>      }
<span class="linenr"> 3551: </span>    } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr"> 3552: </span>      isProp.type === NodeTypes.ATTRIBUTE &amp;&
<span class=
"linenr"> 3553: </span>      isProp.value.content.startsWith(<span class="org-string">'vue:'</span>)
<span class="linenr"> 3554: </span>    ) {
<span class="linenr"> 3555: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;button is="vue:xxx"&gt;</span>
<span class="linenr"> 3556: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if not &lt;component&gt;, only is value that starts with "vue:" will be</span>
<span class="linenr"> 3557: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">treated as component by the parse phase and reach here, unless it's</span>
<span class="linenr"> 3558: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">compat mode where all is values are considered components</span>
<span class=
"linenr"> 3559: </span>      tag = isProp.value.content.slice(<span class="org-highlight-numbers-number">4</span>)
<span class="linenr"> 3560: </span>    }
<span class="linenr"> 3561: </span>  }
<span class="linenr"> 3562: </span>
<span class="linenr"> 3563: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1.5 v-is (</span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO:</span></span></span><span class=
"org-comment"> Deprecate)</span>
<span class="linenr"> 3564: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDir</span> = !isExplicitDynamic &amp;& findDir(node, <span class="org-string">'is'</span>)
<span class="linenr"> 3565: </span>  <span class=
"org-keyword">if</span> (isDir &amp;& isDir.exp) {
<span class="linenr"> 3566: </span>    <span class=
"org-keyword">return</span> createCallExpression(context.helper(RESOLVE_DYNAMIC_COMPONENT), [
<span class="linenr"> 3567: </span>      isDir.exp
<span class="linenr"> 3568: </span>    ])
<span class="linenr"> 3569: </span>  }
<span class="linenr"> 3570: </span>
<span class="linenr"> 3571: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. built-in components (Teleport, Transition, KeepAlive, Suspense...)</span>
<span class="linenr"> 3572: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">builtIn</span> = isCoreComponent(tag) || context.isBuiltInComponent(tag)
<span class="linenr"> 3573: </span>  <span class=
"org-keyword">if</span> (builtIn) {
<span class="linenr"> 3574: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">built-ins are simply fallthroughs / have special handling during ssr</span>
<span class="linenr"> 3575: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">so we don't need to import their runtime equivalents</span>
<span class="linenr"> 3576: </span>    <span class=
"org-keyword">if</span> (!ssr) context.helper(builtIn)
<span class="linenr"> 3577: </span>    <span class=
"org-keyword">return</span> builtIn
<span class="linenr"> 3578: </span>  }
<span class="linenr"> 3579: </span>
<span class="linenr"> 3580: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">3. user component (from setup bindings)</span>
<span class="linenr"> 3581: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">this is skipped in browser build since browser builds do not perform</span>
<span class="linenr"> 3582: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">binding analysis.</span>
<span class="linenr"> 3583: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__) {
<span class="linenr"> 3584: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">fromSetup</span> = resolveSetupReference(tag, context)
<span class="linenr"> 3585: </span>    <span class=
"org-keyword">if</span> (fromSetup) {
<span class="linenr"> 3586: </span>      <span class=
"org-keyword">return</span> fromSetup
<span class="linenr"> 3587: </span>    }
<span class="linenr"> 3588: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">dotIndex</span> = tag.indexOf(<span class=
"org-string">'.'</span>)
<span class="linenr"> 3589: </span>    <span class=
"org-keyword">if</span> (dotIndex &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 3590: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ns</span> = resolveSetupReference(tag.slice(<span class="org-highlight-numbers-number">0</span>, dotIndex), context)
<span class="linenr"> 3591: </span>      <span class=
"org-keyword">if</span> (ns) {
<span class="linenr"> 3592: </span>        <span class=
"org-keyword">return</span> ns + tag.slice(dotIndex)
<span class="linenr"> 3593: </span>      }
<span class="linenr"> 3594: </span>    }
<span class="linenr"> 3595: </span>  }
<span class="linenr"> 3596: </span>
<span class="linenr"> 3597: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">4. Self referencing component (inferred from filename)</span>
<span class="linenr"> 3598: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 3599: </span>    !__BROWSER__ &amp;&
<span class="linenr"> 3600: </span>    context.selfName &amp;&
<span class=
"linenr"> 3601: </span>    capitalize(camelize(tag)) === context.selfName
<span class="linenr"> 3602: </span>  ) {
<span class=
"linenr"> 3603: </span>    context.helper(RESOLVE_COMPONENT)
<span class="linenr"> 3604: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">codegen.ts has special check for __self postfix when generating</span>
<span class="linenr"> 3605: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">component imports, which will pass additional `maybeSelfReference` flag</span>
<span class="linenr"> 3606: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">to `resolveComponent`.</span>
<span class=
"linenr"> 3607: </span>    context.components.add(tag + <span class="org-string">`__self`</span>)
<span class="linenr"> 3608: </span>    <span class=
"org-keyword">return</span> toValidAssetId(tag, <span class=
"org-string">`component`</span>)
<span class="linenr"> 3609: </span>  }
<span class="linenr"> 3610: </span>
<span class="linenr"> 3611: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">5. user component (resolve)</span>
<span class=
"linenr"> 3612: </span>  context.helper(RESOLVE_COMPONENT)
<span class="linenr"> 3613: </span>  context.components.add(tag)
<span class="linenr"> 3614: </span>  <span class=
"org-keyword">return</span> toValidAssetId(tag, <span class=
"org-string">`component`</span>)
<span class="linenr"> 3615: </span>}
<span class="linenr"> 3616: </span>
<span class="linenr"> 3617: </span>
<span class="linenr"> 3618: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">resolveSetupReference</span>(<span class=
"org-variable-name">name</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 3619: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bindings</span> = context.bindingMetadata
<span class="linenr"> 3620: </span>  <span class=
"org-keyword">if</span> (!bindings || bindings.__isScriptSetup === <span class="org-constant">false</span>) {
<span class="linenr"> 3621: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 3622: </span>  }
<span class="linenr"> 3623: </span>
<span class="linenr"> 3624: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">camelName</span> = camelize(name)
<span class="linenr"> 3625: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">PascalName</span> = capitalize(camelName)
<span class="linenr"> 3626: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">checkType</span> = (type) =&gt; {
<span class="linenr"> 3627: </span>    <span class=
"org-keyword">if</span> (bindings[name] === type) {
<span class="linenr"> 3628: </span>      <span class=
"org-keyword">return</span> name
<span class="linenr"> 3629: </span>    }
<span class="linenr"> 3630: </span>    <span class=
"org-keyword">if</span> (bindings[camelName] === type) {
<span class="linenr"> 3631: </span>      <span class=
"org-keyword">return</span> camelName
<span class="linenr"> 3632: </span>    }
<span class="linenr"> 3633: </span>    <span class=
"org-keyword">if</span> (bindings[PascalName] === type) {
<span class="linenr"> 3634: </span>      <span class=
"org-keyword">return</span> PascalName
<span class="linenr"> 3635: </span>    }
<span class="linenr"> 3636: </span>  }
<span class="linenr"> 3637: </span>
<span class="linenr"> 3638: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">fromConst</span> = checkType(BindingTypes.SETUP_CONST)
<span class="linenr"> 3639: </span>  <span class=
"org-keyword">if</span> (fromConst) {
<span class="linenr"> 3640: </span>    <span class=
"org-keyword">return</span> context.inline
<span class="linenr"> 3641: </span>      ? <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in inline mode, const setup bindings (e.g. imports) can be used as-is</span>
<span class="linenr"> 3642: </span>        fromConst
<span class="linenr"> 3643: </span>      : <span class=
"org-string">`$setup[${JSON.stringify(fromConst)}]`</span>
<span class="linenr"> 3644: </span>  }
<span class="linenr"> 3645: </span>
<span class="linenr"> 3646: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">fromMaybeRef</span> =
<span class=
"linenr"> 3647: </span>    checkType(BindingTypes.SETUP_LET) ||
<span class=
"linenr"> 3648: </span>    checkType(BindingTypes.SETUP_REF) ||
<span class=
"linenr"> 3649: </span>    checkType(BindingTypes.SETUP_MAYBE_REF)
<span class="linenr"> 3650: </span>  <span class=
"org-keyword">if</span> (fromMaybeRef) {
<span class="linenr"> 3651: </span>    <span class=
"org-keyword">return</span> context.inline
<span class="linenr"> 3652: </span>      ? <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">setup scope bindings that may be refs need to be unrefed</span>
<span class="linenr"> 3653: </span>        <span class=
"org-string">`${context.helperString(UNREF)}(${fromMaybeRef})`</span>
<span class="linenr"> 3654: </span>      : <span class=
"org-string">`$setup[${JSON.stringify(fromMaybeRef)}]`</span>
<span class="linenr"> 3655: </span>  }
<span class="linenr"> 3656: </span>}
<span class="linenr"> 3657: </span>
<span class="linenr"> 3658: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">buildProps</span>(
<span class="linenr"> 3659: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 3660: </span>  <span class=
"org-variable-name">context</span>,
<span class="linenr"> 3661: </span>  props = node.props,
<span class="linenr"> 3662: </span>  ssr = <span class=
"org-constant">false</span>
<span class="linenr"> 3663: </span>) {
<span class="linenr"> 3664: </span>  <span class=
"org-keyword">const</span> { tag, loc: elementLoc, children } = node
<span class="linenr"> 3665: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isComponent</span> = node.tagType === ElementTypes.COMPONENT
<span class="linenr"> 3666: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">properties</span> = []
<span class="linenr"> 3667: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">mergeArgs</span> = []
<span class="linenr"> 3668: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">runtimeDirectives</span> = []
<span class="linenr"> 3669: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hasChildren</span> = children.length &gt; <span class="org-highlight-numbers-number">0</span>
<span class="linenr"> 3670: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">shouldUseBlock</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3671: </span>
<span class="linenr"> 3672: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">patchFlag analysis</span>
<span class="linenr"> 3673: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">patchFlag</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 3674: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasRef</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3675: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasClassBinding</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3676: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasStyleBinding</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3677: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasHydrationEventBinding</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3678: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasDynamicKeys</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3679: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasVnodeHook</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3680: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">dynamicPropNames</span> = []
<span class="linenr"> 3681: </span>
<span class="linenr"> 3682: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">analyzePatchFlag</span> = ({ key, value }) =&gt; {
<span class="linenr"> 3683: </span>    <span class=
"org-keyword">if</span> (isStaticExp(key)) {
<span class="linenr"> 3684: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">name</span> = key.content
<span class="linenr"> 3685: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isEventHandler</span> = isOn(name)
<span class="linenr"> 3686: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 3687: </span>        !isComponent &amp;&
<span class="linenr"> 3688: </span>        isEventHandler &amp;&
<span class="linenr"> 3689: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">omit the flag for click handlers because hydration gives click</span>
<span class="linenr"> 3690: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">dedicated fast path.</span>
<span class=
"linenr"> 3691: </span>        name.toLowerCase() !== <span class=
"org-string">'onclick'</span> &amp;&
<span class="linenr"> 3692: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">omit v-model handlers</span>
<span class="linenr"> 3693: </span>        name !== <span class=
"org-string">'onUpdate:modelValue'</span> &amp;&
<span class="linenr"> 3694: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">omit onVnodeXXX hooks</span>
<span class="linenr"> 3695: </span>        !isReservedProp(name)
<span class="linenr"> 3696: </span>      ) {
<span class=
"linenr"> 3697: </span>        hasHydrationEventBinding = <span class="org-constant">true</span>
<span class="linenr"> 3698: </span>      }
<span class="linenr"> 3699: </span>
<span class="linenr"> 3700: </span>      <span class=
"org-keyword">if</span> (isEventHandler &amp;& isReservedProp(name)) {
<span class=
"linenr"> 3701: </span>        hasVnodeHook = <span class=
"org-constant">true</span>
<span class="linenr"> 3702: </span>      }
<span class="linenr"> 3703: </span>
<span class="linenr"> 3704: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 3705: </span>        value.type === NodeTypes.JS_CACHE_EXPRESSION ||
<span class=
"linenr"> 3706: </span>        ((value.type === NodeTypes.SIMPLE_EXPRESSION ||
<span class=
"linenr"> 3707: </span>          value.type === NodeTypes.COMPOUND_EXPRESSION) &amp;&
<span class=
"linenr"> 3708: </span>          getConstantType(value, context) &gt; <span class="org-highlight-numbers-number">0</span>)
<span class="linenr"> 3709: </span>      ) {
<span class="linenr"> 3710: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip if the prop is a cached handler or has constant value</span>
<span class="linenr"> 3711: </span>        <span class=
"org-keyword">return</span>
<span class="linenr"> 3712: </span>      }
<span class="linenr"> 3713: </span>
<span class="linenr"> 3714: </span>      <span class=
"org-keyword">if</span> (name === <span class=
"org-string">'ref'</span>) {
<span class="linenr"> 3715: </span>        hasRef = <span class=
"org-constant">true</span>
<span class="linenr"> 3716: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (name === <span class=
"org-string">'class'</span>) {
<span class=
"linenr"> 3717: </span>        hasClassBinding = <span class=
"org-constant">true</span>
<span class="linenr"> 3718: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (name === <span class=
"org-string">'style'</span>) {
<span class=
"linenr"> 3719: </span>        hasStyleBinding = <span class=
"org-constant">true</span>
<span class="linenr"> 3720: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (name !== <span class=
"org-string">'key'</span> &amp;& !dynamicPropNames.includes(name)) {
<span class=
"linenr"> 3721: </span>        dynamicPropNames.push(name)
<span class="linenr"> 3722: </span>      }
<span class="linenr"> 3723: </span>
<span class="linenr"> 3724: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">treat the dynamic class and style binding of the component as dynamic props</span>
<span class="linenr"> 3725: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 3726: </span>        isComponent &amp;&
<span class="linenr"> 3727: </span>        (name === <span class=
"org-string">'class'</span> || name === <span class=
"org-string">'style'</span>) &amp;&
<span class=
"linenr"> 3728: </span>        !dynamicPropNames.includes(name)
<span class="linenr"> 3729: </span>      ) {
<span class=
"linenr"> 3730: </span>        dynamicPropNames.push(name)
<span class="linenr"> 3731: </span>      }
<span class="linenr"> 3732: </span>    } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 3733: </span>      hasDynamicKeys = <span class=
"org-constant">true</span>
<span class="linenr"> 3734: </span>    }
<span class="linenr"> 3735: </span>  }
<span class="linenr"> 3736: </span>
<span class="linenr"> 3737: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; props.length; i++) {
<span class="linenr"> 3738: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">static attribute</span>
<span class="linenr"> 3739: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prop</span> = props[i]
<span class="linenr"> 3740: </span>    <span class=
"org-keyword">if</span> (prop.type === NodeTypes.ATTRIBUTE) {
<span class="linenr"> 3741: </span>      <span class=
"org-keyword">const</span> { loc, name, value } = prop
<span class="linenr"> 3742: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">isStatic</span> = <span class=
"org-constant">true</span>
<span class="linenr"> 3743: </span>      <span class=
"org-keyword">if</span> (name === <span class=
"org-string">'ref'</span>) {
<span class="linenr"> 3744: </span>        hasRef = <span class=
"org-constant">true</span>
<span class="linenr"> 3745: </span>        <span class=
"org-keyword">if</span> (context.scopes.vFor &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 3746: </span>          properties.push(
<span class=
"linenr"> 3747: </span>            createObjectProperty(
<span class=
"linenr"> 3748: </span>              createSimpleExpression(<span class="org-string">'ref_for'</span>, <span class="org-constant">true</span>),
<span class=
"linenr"> 3749: </span>              createSimpleExpression(<span class="org-string">'true'</span>)
<span class="linenr"> 3750: </span>            )
<span class="linenr"> 3751: </span>          )
<span class="linenr"> 3752: </span>        }
<span class="linenr"> 3753: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in inline mode there is no setupState object, so we can't use string</span>
<span class="linenr"> 3754: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">keys to set the ref. Instead, we need to transform it to pass the</span>
<span class="linenr"> 3755: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">actual ref instead.</span>
<span class="linenr"> 3756: </span>        <span class=
"org-keyword">if</span> (
<span class="linenr"> 3757: </span>          !__BROWSER__ &amp;&
<span class="linenr"> 3758: </span>          value &amp;&
<span class="linenr"> 3759: </span>          context.inline &amp;&
<span class=
"linenr"> 3760: </span>          context.bindingMetadata[value.content]
<span class="linenr"> 3761: </span>        ) {
<span class=
"linenr"> 3762: </span>          isStatic = <span class="org-constant">false</span>
<span class="linenr"> 3763: </span>          properties.push(
<span class=
"linenr"> 3764: </span>            createObjectProperty(
<span class=
"linenr"> 3765: </span>              createSimpleExpression(<span class="org-string">'ref_key'</span>, <span class="org-constant">true</span>),
<span class=
"linenr"> 3766: </span>              createSimpleExpression(value.content, <span class="org-constant">true</span>, value.loc)
<span class="linenr"> 3767: </span>            )
<span class="linenr"> 3768: </span>          )
<span class="linenr"> 3769: </span>        }
<span class="linenr"> 3770: </span>      }
<span class="linenr"> 3771: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip is on &lt;component&gt;, or is="vue:xxx"</span>
<span class="linenr"> 3772: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 3773: </span>        name === <span class=
"org-string">'is'</span> &amp;&
<span class="linenr"> 3774: </span>        (isComponentTag(tag) ||
<span class=
"linenr"> 3775: </span>          (value &amp;& value.content.startsWith(<span class="org-string">'vue:'</span>)))
<span class="linenr"> 3776: </span>      ) {
<span class="linenr"> 3777: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 3778: </span>      }
<span class="linenr"> 3779: </span>      properties.push(
<span class="linenr"> 3780: </span>        createObjectProperty(
<span class=
"linenr"> 3781: </span>          createSimpleExpression(
<span class="linenr"> 3782: </span>            name,
<span class="linenr"> 3783: </span>            <span class=
"org-constant">true</span>,
<span class=
"linenr"> 3784: </span>            getInnerRange(loc, <span class=
"org-highlight-numbers-number">0</span>, name.length)
<span class="linenr"> 3785: </span>          ),
<span class=
"linenr"> 3786: </span>          createSimpleExpression(
<span class=
"linenr"> 3787: </span>            value ? value.content : <span class="org-string">''</span>,
<span class="linenr"> 3788: </span>            isStatic,
<span class=
"linenr"> 3789: </span>            value ? value.loc : loc
<span class="linenr"> 3790: </span>          )
<span class="linenr"> 3791: </span>        )
<span class="linenr"> 3792: </span>      )
<span class="linenr"> 3793: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 3794: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">directives</span>
<span class="linenr"> 3795: </span>      <span class=
"org-keyword">const</span> { name, arg, exp, loc } = prop
<span class="linenr"> 3796: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isVBind</span> = name === <span class=
"org-string">'bind'</span>
<span class="linenr"> 3797: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isVOn</span> = name === <span class=
"org-string">'on'</span>
<span class="linenr"> 3798: </span>
<span class="linenr"> 3799: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip v-slot - it is handled by its dedicated transform.</span>
<span class="linenr"> 3800: </span>      <span class=
"org-keyword">if</span> (name === <span class=
"org-string">'slot'</span>) {
<span class="linenr"> 3801: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 3802: </span>      }
<span class="linenr"> 3803: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip v-once/v-memo - they are handled by dedicated transforms.</span>
<span class="linenr"> 3804: </span>      <span class=
"org-keyword">if</span> (name === <span class=
"org-string">'once'</span> || name === <span class=
"org-string">'memo'</span>) {
<span class="linenr"> 3805: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 3806: </span>      }
<span class="linenr"> 3807: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip v-is and :is on &lt;component&gt;</span>
<span class="linenr"> 3808: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 3809: </span>        name === <span class=
"org-string">'is'</span> ||
<span class="linenr"> 3810: </span>        (isVBind &amp;&
<span class=
"linenr"> 3811: </span>          isStaticArgOf(arg, <span class=
"org-string">'is'</span>) &amp;&
<span class="linenr"> 3812: </span>          isComponentTag(tag))
<span class="linenr"> 3813: </span>      ) {
<span class="linenr"> 3814: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 3815: </span>      }
<span class="linenr"> 3816: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip v-on in SSR compilation</span>
<span class="linenr"> 3817: </span>      <span class=
"org-keyword">if</span> (isVOn &amp;& ssr) {
<span class="linenr"> 3818: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 3819: </span>      }
<span class="linenr"> 3820: </span>
<span class="linenr"> 3821: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 3822: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#938: elements with dynamic keys should be forced into blocks</span>
<span class=
"linenr"> 3823: </span>        (isVBind &amp;& isStaticArgOf(arg, <span class="org-string">'key'</span>)) ||
<span class="linenr"> 3824: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inline before-update hooks need to force block so that it is invoked</span>
<span class="linenr"> 3825: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">before children</span>
<span class=
"linenr"> 3826: </span>        (isVOn &amp;& hasChildren &amp;& isStaticArgOf(arg, <span class="org-string">'vue:before-update'</span>))
<span class="linenr"> 3827: </span>      ) {
<span class=
"linenr"> 3828: </span>        shouldUseBlock = <span class=
"org-constant">true</span>
<span class="linenr"> 3829: </span>      }
<span class="linenr"> 3830: </span>
<span class="linenr"> 3831: </span>      <span class=
"org-keyword">if</span> (isVBind &amp;& isStaticArgOf(arg, <span class="org-string">'ref'</span>) &amp;& context.scopes.vFor &gt; <span class="org-highlight-numbers-number">0</span>) {
<span class="linenr"> 3832: </span>        properties.push(
<span class="linenr"> 3833: </span>          createObjectProperty(
<span class=
"linenr"> 3834: </span>            createSimpleExpression(<span class="org-string">'ref_for'</span>, <span class="org-constant">true</span>),
<span class=
"linenr"> 3835: </span>            createSimpleExpression(<span class="org-string">'true'</span>)
<span class="linenr"> 3836: </span>          )
<span class="linenr"> 3837: </span>        )
<span class="linenr"> 3838: </span>      }
<span class="linenr"> 3839: </span>
<span class="linenr"> 3840: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">special case for v-bind and v-on with no argument</span>
<span class="linenr"> 3841: </span>      <span class=
"org-keyword">if</span> (!arg &amp;& (isVBind || isVOn)) {
<span class=
"linenr"> 3842: </span>        hasDynamicKeys = <span class=
"org-constant">true</span>
<span class="linenr"> 3843: </span>        <span class=
"org-keyword">if</span> (exp) {
<span class="linenr"> 3844: </span>          <span class=
"org-keyword">if</span> (properties.length) {
<span class="linenr"> 3845: </span>            mergeArgs.push(
<span class=
"linenr"> 3846: </span>              createObjectExpression(dedupeProperties(properties), elementLoc)
<span class="linenr"> 3847: </span>            )
<span class="linenr"> 3848: </span>            properties = []
<span class="linenr"> 3849: </span>          }
<span class="linenr"> 3850: </span>          <span class=
"org-keyword">if</span> (isVBind) {
<span class="linenr"> 3851: </span>            mergeArgs.push(exp)
<span class="linenr"> 3852: </span>          } <span class=
"org-keyword">else</span> {
<span class="linenr"> 3853: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-on="obj" -&gt; toHandlers(obj)</span>
<span class="linenr"> 3854: </span>            mergeArgs.push({
<span class=
"linenr"> 3855: </span>              type: NodeTypes.JS_CALL_EXPRESSION,
<span class="linenr"> 3856: </span>              loc,
<span class=
"linenr"> 3857: </span>              callee: context.helper(TO_HANDLERS),
<span class="linenr"> 3858: </span>              <span class=
"org-constant">arguments</span>: [exp]
<span class="linenr"> 3859: </span>            })
<span class="linenr"> 3860: </span>          }
<span class="linenr"> 3861: </span>        }
<span class="linenr"> 3862: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 3863: </span>      }
<span class="linenr"> 3864: </span>
<span class="linenr"> 3865: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">directiveTransform</span> = context.directiveTransforms[name]
<span class="linenr"> 3866: </span>      <span class=
"org-keyword">if</span> (directiveTransform) {
<span class="linenr"> 3867: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">has built-in directive transform.</span>
<span class="linenr"> 3868: </span>        <span class=
"org-keyword">const</span> { props, needRuntime } = directiveTransform(prop, node, context)
<span class=
"linenr"> 3869: </span>        !ssr &amp;& props.forEach(analyzePatchFlag)
<span class=
"linenr"> 3870: </span>        properties.push(...props)
<span class="linenr"> 3871: </span>        <span class=
"org-keyword">if</span> (needRuntime) {
<span class=
"linenr"> 3872: </span>          runtimeDirectives.push(prop)
<span class="linenr"> 3873: </span>          <span class=
"org-keyword">if</span> (isSymbol(needRuntime)) {
<span class=
"linenr"> 3874: </span>            directiveImportMap.set(prop, needRuntime)
<span class="linenr"> 3875: </span>          }
<span class="linenr"> 3876: </span>        }
<span class="linenr"> 3877: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (!isBuiltInDirective(name)) {
<span class="linenr"> 3878: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no built-in transform, this is a user custom directive.</span>
<span class=
"linenr"> 3879: </span>        runtimeDirectives.push(prop)
<span class="linenr"> 3880: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">custom dirs may use beforeUpdate so they need to force blocks</span>
<span class="linenr"> 3881: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">to ensure before-update gets called before children update</span>
<span class="linenr"> 3882: </span>        <span class=
"org-keyword">if</span> (hasChildren) {
<span class=
"linenr"> 3883: </span>          shouldUseBlock = <span class=
"org-constant">true</span>
<span class="linenr"> 3884: </span>        }
<span class="linenr"> 3885: </span>      }
<span class="linenr"> 3886: </span>    }
<span class="linenr"> 3887: </span>  }
<span class="linenr"> 3888: </span>
<span class="linenr"> 3889: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsExpression</span> = <span class=
"org-constant">undefined</span>
<span class="linenr"> 3890: </span>
<span class="linenr"> 3891: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">has v-bind="object" or v-on="object", wrap with mergeProps</span>
<span class="linenr"> 3892: </span>  <span class=
"org-keyword">if</span> (mergeArgs.length) {
<span class="linenr"> 3893: </span>    <span class=
"org-keyword">if</span> (properties.length) {
<span class="linenr"> 3894: </span>      mergeArgs.push(
<span class=
"linenr"> 3895: </span>        createObjectExpression(dedupeProperties(properties), elementLoc)
<span class="linenr"> 3896: </span>      )
<span class="linenr"> 3897: </span>    }
<span class="linenr"> 3898: </span>    <span class=
"org-keyword">if</span> (mergeArgs.length &gt; <span class=
"org-highlight-numbers-number">1</span>) {
<span class=
"linenr"> 3899: </span>      propsExpression = createCallExpression(
<span class=
"linenr"> 3900: </span>        context.helper(MERGE_PROPS),
<span class="linenr"> 3901: </span>        mergeArgs,
<span class="linenr"> 3902: </span>        elementLoc
<span class="linenr"> 3903: </span>      )
<span class="linenr"> 3904: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 3905: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">single v-bind with nothing else - no need for a mergeProps call</span>
<span class=
"linenr"> 3906: </span>      propsExpression = mergeArgs[<span class="org-highlight-numbers-number">0</span>]
<span class="linenr"> 3907: </span>    }
<span class="linenr"> 3908: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (properties.length) {
<span class=
"linenr"> 3909: </span>    propsExpression = createObjectExpression(
<span class=
"linenr"> 3910: </span>      dedupeProperties(properties),
<span class="linenr"> 3911: </span>      elementLoc
<span class="linenr"> 3912: </span>    )
<span class="linenr"> 3913: </span>  }
<span class="linenr"> 3914: </span>
<span class="linenr"> 3915: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">patchFlag analysis</span>
<span class="linenr"> 3916: </span>  <span class=
"org-keyword">if</span> (hasDynamicKeys) {
<span class=
"linenr"> 3917: </span>    patchFlag |= PatchFlags.FULL_PROPS
<span class="linenr"> 3918: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 3919: </span>    <span class=
"org-keyword">if</span> (hasClassBinding &amp;& !isComponent) {
<span class=
"linenr"> 3920: </span>      patchFlag |= PatchFlags.CLASS
<span class="linenr"> 3921: </span>    }
<span class="linenr"> 3922: </span>    <span class=
"org-keyword">if</span> (hasStyleBinding &amp;& !isComponent) {
<span class=
"linenr"> 3923: </span>      patchFlag |= PatchFlags.STYLE
<span class="linenr"> 3924: </span>    }
<span class="linenr"> 3925: </span>    <span class=
"org-keyword">if</span> (dynamicPropNames.length) {
<span class=
"linenr"> 3926: </span>      patchFlag |= PatchFlags.PROPS
<span class="linenr"> 3927: </span>    }
<span class="linenr"> 3928: </span>    <span class=
"org-keyword">if</span> (hasHydrationEventBinding) {
<span class=
"linenr"> 3929: </span>      patchFlag |= PatchFlags.HYDRATE_EVENTS
<span class="linenr"> 3930: </span>    }
<span class="linenr"> 3931: </span>  }
<span class="linenr"> 3932: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 3933: </span>    !shouldUseBlock &amp;&
<span class="linenr"> 3934: </span>    (patchFlag === <span class=
"org-highlight-numbers-number">0</span> || patchFlag === PatchFlags.HYDRATE_EVENTS) &amp;&
<span class=
"linenr"> 3935: </span>    (hasRef || hasVnodeHook || runtimeDirectives.length &gt; <span class="org-highlight-numbers-number">0</span>)
<span class="linenr"> 3936: </span>  ) {
<span class=
"linenr"> 3937: </span>    patchFlag |= PatchFlags.NEED_PATCH
<span class="linenr"> 3938: </span>  }
<span class="linenr"> 3939: </span>
<span class="linenr"> 3940: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">pre-normalize props, SSR is skipped for now</span>
<span class="linenr"> 3941: </span>  <span class=
"org-keyword">if</span> (!context.inSSR &amp;& propsExpression) {
<span class="linenr"> 3942: </span>    <span class=
"org-keyword">switch</span> (propsExpression.type) {
<span class="linenr"> 3943: </span>      <span class=
"org-keyword">case</span> NodeTypes.JS_OBJECT_EXPRESSION:
<span class="linenr"> 3944: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">means that there is no v-bind,</span>
<span class="linenr"> 3945: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">but still need to deal with dynamic key binding</span>
<span class="linenr"> 3946: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">classKeyIndex</span> = -<span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 3947: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">styleKeyIndex</span> = -<span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 3948: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasDynamicKey</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3949: </span>
<span class="linenr"> 3950: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; propsExpression.properties.length; i++) {
<span class="linenr"> 3951: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> = propsExpression.properties[i].key
<span class="linenr"> 3952: </span>          <span class=
"org-keyword">if</span> (isStaticExp(key)) {
<span class="linenr"> 3953: </span>            <span class=
"org-keyword">if</span> (key.content === <span class=
"org-string">'class'</span>) {
<span class="linenr"> 3954: </span>              classKeyIndex = i
<span class="linenr"> 3955: </span>            } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (key.content === <span class=
"org-string">'style'</span>) {
<span class="linenr"> 3956: </span>              styleKeyIndex = i
<span class="linenr"> 3957: </span>            }
<span class="linenr"> 3958: </span>          } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (!key.isHandlerKey) {
<span class=
"linenr"> 3959: </span>            hasDynamicKey = <span class=
"org-constant">true</span>
<span class="linenr"> 3960: </span>          }
<span class="linenr"> 3961: </span>        }
<span class="linenr"> 3962: </span>
<span class="linenr"> 3963: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">classProp</span> = propsExpression.properties[classKeyIndex]
<span class="linenr"> 3964: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">styleProp</span> = propsExpression.properties[styleKeyIndex]
<span class="linenr"> 3965: </span>
<span class="linenr"> 3966: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no dynamic key</span>
<span class="linenr"> 3967: </span>        <span class=
"org-keyword">if</span> (!hasDynamicKey) {
<span class="linenr"> 3968: </span>          <span class=
"org-keyword">if</span> (classProp &amp;& !isStaticExp(classProp.value)) {
<span class=
"linenr"> 3969: </span>            classProp.value = createCallExpression(
<span class=
"linenr"> 3970: </span>              context.helper(NORMALIZE_CLASS),
<span class="linenr"> 3971: </span>              [classProp.value]
<span class="linenr"> 3972: </span>            )
<span class="linenr"> 3973: </span>          }
<span class="linenr"> 3974: </span>          <span class=
"org-keyword">if</span> (
<span class="linenr"> 3975: </span>            styleProp &amp;&
<span class=
"linenr"> 3976: </span>            !isStaticExp(styleProp.value) &amp;&
<span class="linenr"> 3977: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the static style is compiled into an object,</span>
<span class="linenr"> 3978: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">so use `hasStyleBinding` to ensure that it is a dynamic style binding</span>
<span class="linenr"> 3979: </span>            (hasStyleBinding ||
<span class="linenr"> 3980: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-bind:style and style both exist,</span>
<span class="linenr"> 3981: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-bind:style with static literal object</span>
<span class=
"linenr"> 3982: </span>              styleProp.value.type === NodeTypes.JS_ARRAY_EXPRESSION)
<span class="linenr"> 3983: </span>          ) {
<span class=
"linenr"> 3984: </span>            styleProp.value = createCallExpression(
<span class=
"linenr"> 3985: </span>              context.helper(NORMALIZE_STYLE),
<span class="linenr"> 3986: </span>              [styleProp.value]
<span class="linenr"> 3987: </span>            )
<span class="linenr"> 3988: </span>          }
<span class="linenr"> 3989: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr"> 3990: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">dynamic key binding, wrap with `normalizeProps`</span>
<span class=
"linenr"> 3991: </span>          propsExpression = createCallExpression(
<span class=
"linenr"> 3992: </span>            context.helper(NORMALIZE_PROPS),
<span class="linenr"> 3993: </span>            [propsExpression]
<span class="linenr"> 3994: </span>          )
<span class="linenr"> 3995: </span>        }
<span class="linenr"> 3996: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 3997: </span>      <span class=
"org-keyword">case</span> NodeTypes.JS_CALL_EXPRESSION:
<span class="linenr"> 3998: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">mergeProps call, do nothing</span>
<span class="linenr"> 3999: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 4000: </span>      <span class=
"org-keyword">default</span>:
<span class="linenr"> 4001: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">single v-bind</span>
<span class=
"linenr"> 4002: </span>        propsExpression = createCallExpression(
<span class=
"linenr"> 4003: </span>          context.helper(NORMALIZE_PROPS),
<span class="linenr"> 4004: </span>          [
<span class=
"linenr"> 4005: </span>            createCallExpression(context.helper(GUARD_REACTIVE_PROPS), [
<span class="linenr"> 4006: </span>              propsExpression
<span class="linenr"> 4007: </span>            ])
<span class="linenr"> 4008: </span>          ]
<span class="linenr"> 4009: </span>        )
<span class="linenr"> 4010: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 4011: </span>    }
<span class="linenr"> 4012: </span>  }
<span class="linenr"> 4013: </span>
<span class="linenr"> 4014: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 4015: </span>    props: propsExpression,
<span class=
"linenr"> 4016: </span>    directives: runtimeDirectives,
<span class="linenr"> 4017: </span>    patchFlag,
<span class="linenr"> 4018: </span>    dynamicPropNames,
<span class="linenr"> 4019: </span>    shouldUseBlock
<span class="linenr"> 4020: </span>  }
<span class="linenr"> 4021: </span>}
<span class="linenr"> 4022: </span>
<span class="linenr"> 4023: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Dedupe props in an object literal.</span>
<span class="linenr"> 4024: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Literal duplicated attributes would have been warned during the parse phase,</span>
<span class="linenr"> 4025: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">however, it's possible to encounter duplicated `onXXX` handlers with different</span>
<span class="linenr"> 4026: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">modifiers. We also need to merge static and dynamic class / style attributes.</span>
<span class="linenr"> 4027: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">- onXXX handlers / style: merge into array</span>
<span class="linenr"> 4028: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">- class: merge into single expression with concatenation</span>
<span class="linenr"> 4029: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">dedupeProperties</span>(<span class=
"org-variable-name">properties</span>) {
<span class="linenr"> 4030: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">knownProps</span> = <span class=
"org-keyword">new</span> <span class="org-type">Map</span>()
<span class="linenr"> 4031: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">deduped</span> = []
<span class="linenr"> 4032: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; properties.length; i++) {
<span class="linenr"> 4033: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prop</span> = properties[i]
<span class="linenr"> 4034: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">dynamic keys are always allowed</span>
<span class="linenr"> 4035: </span>    <span class=
"org-keyword">if</span> (prop.key.type === NodeTypes.COMPOUND_EXPRESSION || !prop.key.isStatic) {
<span class="linenr"> 4036: </span>      deduped.push(prop)
<span class="linenr"> 4037: </span>      <span class=
"org-keyword">continue</span>
<span class="linenr"> 4038: </span>    }
<span class="linenr"> 4039: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">name</span> = prop.key.content
<span class="linenr"> 4040: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">existing</span> = knownProps.get(name)
<span class="linenr"> 4041: </span>    <span class=
"org-keyword">if</span> (existing) {
<span class="linenr"> 4042: </span>      <span class=
"org-keyword">if</span> (name === <span class=
"org-string">'style'</span> || name === <span class=
"org-string">'class'</span> || isOn(name)) {
<span class=
"linenr"> 4043: </span>        mergeAsArray(existing, prop)
<span class="linenr"> 4044: </span>      }
<span class="linenr"> 4045: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">unexpected duplicate, should have emitted error during parse</span>
<span class="linenr"> 4046: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4047: </span>      knownProps.set(name, prop)
<span class="linenr"> 4048: </span>      deduped.push(prop)
<span class="linenr"> 4049: </span>    }
<span class="linenr"> 4050: </span>  }
<span class="linenr"> 4051: </span>  <span class=
"org-keyword">return</span> deduped
<span class="linenr"> 4052: </span>}
<span class="linenr"> 4053: </span>
<span class="linenr"> 4054: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">mergeAsArray</span>(<span class=
"org-variable-name">existing</span>, <span class=
"org-variable-name">incoming</span>) {
<span class="linenr"> 4055: </span>  <span class=
"org-keyword">if</span> (existing.value.type === NodeTypes.JS_ARRAY_EXPRESSION) {
<span class=
"linenr"> 4056: </span>    existing.value.elements.push(incoming.value)
<span class="linenr"> 4057: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4058: </span>    existing.value = createArrayExpression(
<span class=
"linenr"> 4059: </span>      [existing.value, incoming.value],
<span class="linenr"> 4060: </span>      existing.loc
<span class="linenr"> 4061: </span>    )
<span class="linenr"> 4062: </span>  }
<span class="linenr"> 4063: </span>}
<span class="linenr"> 4064: </span>
<span class="linenr"> 4065: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">buildDirectiveArgs</span>(
<span class="linenr"> 4066: </span>  <span class=
"org-variable-name">dir</span>,
<span class="linenr"> 4067: </span>  context
<span class="linenr"> 4068: </span>) {
<span class="linenr"> 4069: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">dirArgs</span> = []
<span class="linenr"> 4070: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">runtime</span> = directiveImportMap.get(dir)
<span class="linenr"> 4071: </span>  <span class=
"org-keyword">if</span> (runtime) {
<span class="linenr"> 4072: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">built-in directive with runtime</span>
<span class=
"linenr"> 4073: </span>    dirArgs.push(context.helperString(runtime))
<span class="linenr"> 4074: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4075: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">user directive.</span>
<span class="linenr"> 4076: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">see if we have directives exposed via &lt;script setup&gt;</span>
<span class="linenr"> 4077: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">fromSetup</span> =
<span class=
"linenr"> 4078: </span>      !__BROWSER__ &amp;& resolveSetupReference(<span class="org-string">'v-'</span> + dir.name, context)
<span class="linenr"> 4079: </span>    <span class=
"org-keyword">if</span> (fromSetup) {
<span class="linenr"> 4080: </span>      dirArgs.push(fromSetup)
<span class="linenr"> 4081: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4082: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject statement for resolving directive</span>
<span class=
"linenr"> 4083: </span>      context.helper(RESOLVE_DIRECTIVE)
<span class=
"linenr"> 4084: </span>      context.directives.add(dir.name)
<span class=
"linenr"> 4085: </span>      dirArgs.push(toValidAssetId(dir.name, <span class="org-string">`directive`</span>))
<span class="linenr"> 4086: </span>    }
<span class="linenr"> 4087: </span>  }
<span class="linenr"> 4088: </span>  <span class=
"org-keyword">const</span> { loc } = dir
<span class="linenr"> 4089: </span>  <span class=
"org-keyword">if</span> (dir.exp) dirArgs.push(dir.exp)
<span class="linenr"> 4090: </span>  <span class=
"org-keyword">if</span> (dir.arg) {
<span class="linenr"> 4091: </span>    <span class=
"org-keyword">if</span> (!dir.exp) {
<span class="linenr"> 4092: </span>      dirArgs.push(<span class=
"org-string">`void 0`</span>)
<span class="linenr"> 4093: </span>    }
<span class="linenr"> 4094: </span>    dirArgs.push(dir.arg)
<span class="linenr"> 4095: </span>  }
<span class="linenr"> 4096: </span>  <span class=
"org-keyword">if</span> (Object.keys(dir.modifiers).length) {
<span class="linenr"> 4097: </span>    <span class=
"org-keyword">if</span> (!dir.arg) {
<span class="linenr"> 4098: </span>      <span class=
"org-keyword">if</span> (!dir.exp) {
<span class=
"linenr"> 4099: </span>        dirArgs.push(<span class="org-string">`void 0`</span>)
<span class="linenr"> 4100: </span>      }
<span class="linenr"> 4101: </span>      dirArgs.push(<span class=
"org-string">`void 0`</span>)
<span class="linenr"> 4102: </span>    }
<span class="linenr"> 4103: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">trueExpression</span> = createSimpleExpression(<span class="org-string">`true`</span>, <span class="org-constant">false</span>, loc)
<span class="linenr"> 4104: </span>    dirArgs.push(
<span class="linenr"> 4105: </span>      createObjectExpression(
<span class=
"linenr"> 4106: </span>        dir.modifiers.map(modifier =&gt;
<span class=
"linenr"> 4107: </span>          createObjectProperty(modifier, trueExpression)
<span class="linenr"> 4108: </span>        ),
<span class="linenr"> 4109: </span>        loc
<span class="linenr"> 4110: </span>      )
<span class="linenr"> 4111: </span>    )
<span class="linenr"> 4112: </span>  }
<span class="linenr"> 4113: </span>  <span class=
"org-keyword">return</span> createArrayExpression(dirArgs, dir.loc)
<span class="linenr"> 4114: </span>}
<span class="linenr"> 4115: </span>
<span class="linenr"> 4116: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">stringifyDynamicPropNames</span>(<span class=
"org-variable-name">props</span>) {
<span class="linenr"> 4117: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsNamesString</span> = <span class=
"org-string">`[`</span>
<span class="linenr"> 4118: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>, <span class=
"org-variable-name">l</span> = props.length; i &lt; l; i++) {
<span class=
"linenr"> 4119: </span>    propsNamesString += JSON.stringify(props[i])
<span class="linenr"> 4120: </span>    <span class=
"org-keyword">if</span> (i &lt; l - <span class=
"org-highlight-numbers-number">1</span>) propsNamesString += <span class="org-string">', '</span>
<span class="linenr"> 4121: </span>  }
<span class="linenr"> 4122: </span>  <span class=
"org-keyword">return</span> propsNamesString + <span class=
"org-string">`]`</span>
<span class="linenr"> 4123: </span>}
<span class="linenr"> 4124: </span>
<span class="linenr"> 4125: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isComponentTag</span>(<span class=
"org-variable-name">tag</span>) {
<span class="linenr"> 4126: </span>  <span class=
"org-keyword">return</span> tag === <span class=
"org-string">'component'</span> || tag === <span class=
"org-string">'Component'</span>
<span class="linenr"> 4127: </span>}
<span class="linenr"> 4128: </span>
<span class="linenr"> 4129: </span>
<span class="linenr"> 4130: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isLiteralWhitelisted</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(<span class=
"org-string">'true,false,null,this'</span>)
<span class="linenr"> 4131: </span>
<span class="linenr"> 4132: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformExpression</span> = (node, context) =&gt; {
<span class="linenr"> 4133: </span>  logg(<span class=
"org-string">`transformExpression`</span>, node)
<span class="linenr"> 4134: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">插值处理</span>
<span class="linenr"> 4135: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.INTERPOLATION) {
<span class=
"linenr"> 4136: </span>    node.content = processExpression(
<span class="linenr"> 4137: </span>      node.content ,
<span class="linenr"> 4138: </span>      context
<span class="linenr"> 4139: </span>    )
<span class="linenr"> 4140: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === NodeTypes.ELEMENT) {
<span class="linenr"> 4141: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">处理元素上的指令</span>
<span class="linenr"> 4142: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr"> 4143: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">dir</span> = node.props[i]
<span class="linenr"> 4144: </span>      logg(<span class=
"org-string">`transformExpression - prop[${i}] - directive`</span>, node.props[i])
<span class="linenr"> 4145: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">do not process for v-on & v-for since they are special handled</span>
<span class="linenr"> 4146: </span>      <span class=
"org-keyword">if</span> (dir.type === NodeTypes.DIRECTIVE &amp;& dir.name !== <span class="org-string">'for'</span>) { <span class="org-comment-delimiter">// </span><span class="org-comment">v-for 在 vFor.ts 中处理</span>
<span class="linenr"> 4147: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exp</span> = dir.exp
<span class="linenr"> 4148: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">arg</span> = dir.arg
<span class="linenr"> 4149: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">do not process exp if this is v-on:arg - we need special handling</span>
<span class="linenr"> 4150: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for wrapping inline statements.</span>
<span class="linenr"> 4151: </span>        <span class=
"org-keyword">if</span> (
<span class="linenr"> 4152: </span>          exp &amp;&
<span class=
"linenr"> 4153: </span>          exp.type === NodeTypes.SIMPLE_EXPRESSION &amp;&
<span class=
"linenr"> 4154: </span>          !(dir.name === <span class=
"org-string">'on'</span> &amp;& arg)
<span class="linenr"> 4155: </span>        ) {
<span class=
"linenr"> 4156: </span>          dir.exp = processExpression(
<span class="linenr"> 4157: </span>            exp,
<span class="linenr"> 4158: </span>            context,
<span class="linenr"> 4159: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">slot args must be processed as function params</span>
<span class=
"linenr"> 4160: </span>            dir.name === <span class=
"org-string">'slot'</span>
<span class="linenr"> 4161: </span>          )
<span class="linenr"> 4162: </span>        }
<span class="linenr"> 4163: </span>        <span class=
"org-keyword">if</span> (arg &amp;& arg.type === NodeTypes.SIMPLE_EXPRESSION &amp;& !arg.isStatic) {
<span class=
"linenr"> 4164: </span>          dir.arg = processExpression(arg, context)
<span class="linenr"> 4165: </span>        }
<span class="linenr"> 4166: </span>      }
<span class="linenr"> 4167: </span>    }
<span class="linenr"> 4168: </span>  }
<span class="linenr"> 4169: </span>}
<span class="linenr"> 4170: </span>
<span class="linenr"> 4171: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Important: since this function uses Node.js only dependencies, it should</span>
<span class="linenr"> 4172: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">always be used with a leading !__BROWSER__ check so that it can be</span>
<span class="linenr"> 4173: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">tree-shaken from the browser build.</span>
<span class="linenr"> 4174: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">processExpression</span>(
<span class="linenr"> 4175: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 4176: </span>  <span class=
"org-variable-name">context</span>,
<span class="linenr"> 4177: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">some expressions like v-slot props & v-for aliases should be parsed as</span>
<span class="linenr"> 4178: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">function params</span>
<span class="linenr"> 4179: </span>  asParams = <span class=
"org-constant">false</span>,
<span class="linenr"> 4180: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-on handler values may contain multiple statements</span>
<span class="linenr"> 4181: </span>  asRawStatements = <span class=
"org-constant">false</span>,
<span class=
"linenr"> 4182: </span>  localVars = Object.create(context.identifiers)
<span class="linenr"> 4183: </span>) {
<span class="linenr"> 4184: </span>  <span class=
"org-keyword">if</span> (__BROWSER__) {
<span class="linenr"> 4185: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 4186: </span>  }
<span class="linenr"> 4187: </span>
<span class="linenr"> 4188: </span>  <span class=
"org-keyword">if</span> (!context.prefixIdentifiers || !node.content.trim()) {
<span class="linenr"> 4189: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 4190: </span>  }
<span class="linenr"> 4191: </span>
<span class="linenr"> 4192: </span>  <span class=
"org-keyword">const</span> { inline, bindingMetadata } = context
<span class="linenr"> 4193: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rewriteIdentifier</span> = (raw, parent, id) =&gt; {
<span class="linenr"> 4194: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = hasOwn(bindingMetadata, raw) &amp;& bindingMetadata[raw]
<span class="linenr"> 4195: </span>    <span class=
"org-keyword">if</span> (inline) {
<span class="linenr"> 4196: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x = y</span>
<span class="linenr"> 4197: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isAssignmentLVal</span> =
<span class=
"linenr"> 4198: </span>        parent &amp;& parent.type === <span class="org-string">'AssignmentExpression'</span> &amp;& parent.left === id
<span class="linenr"> 4199: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x++</span>
<span class="linenr"> 4200: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isUpdateArg</span> =
<span class=
"linenr"> 4201: </span>        parent &amp;& parent.type === <span class="org-string">'UpdateExpression'</span> &amp;& parent.argument === id
<span class="linenr"> 4202: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">({ x } = y)</span>
<span class="linenr"> 4203: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDestructureAssignment</span> =
<span class=
"linenr"> 4204: </span>        parent &amp;& isInDestructureAssignment(parent, parentStack)
<span class="linenr"> 4205: </span>
<span class="linenr"> 4206: </span>      <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_CONST || localVars[raw]) {
<span class="linenr"> 4207: </span>        <span class=
"org-keyword">return</span> raw
<span class="linenr"> 4208: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_REF) {
<span class="linenr"> 4209: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`${raw}.value`</span>
<span class="linenr"> 4210: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_MAYBE_REF) {
<span class="linenr"> 4211: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">const binding that may or may not be ref</span>
<span class="linenr"> 4212: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if it's not a ref, then assignments don't make sense -</span>
<span class="linenr"> 4213: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">so we ignore the non-ref assignment case and generate code</span>
<span class="linenr"> 4214: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">that assumes the value to be a ref for more efficiency</span>
<span class="linenr"> 4215: </span>        <span class=
"org-keyword">return</span> isAssignmentLVal || isUpdateArg || isDestructureAssignment
<span class="linenr"> 4216: </span>          ? <span class=
"org-string">`${raw}.value`</span>
<span class="linenr"> 4217: </span>          : <span class=
"org-string">`${context.helperString(UNREF)}(${raw})`</span>
<span class="linenr"> 4218: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_LET) {
<span class="linenr"> 4219: </span>        <span class=
"org-keyword">if</span> (isAssignmentLVal) {
<span class="linenr"> 4220: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let binding.</span>
<span class="linenr"> 4221: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">this is a bit more tricky as we need to cover the case where</span>
<span class="linenr"> 4222: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let is a local non-ref value, and we need to replicate the</span>
<span class="linenr"> 4223: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">right hand side value.</span>
<span class="linenr"> 4224: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x = y --&gt; isRef(x) ? x.value = y : x = y</span>
<span class="linenr"> 4225: </span>          <span class=
"org-keyword">const</span> { right: rVal, operator } = parent
<span class="linenr"> 4226: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rExp</span> = rawExp.slice(rVal.start - <span class="org-highlight-numbers-number">1</span>, rVal.end - <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 4227: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rExpString</span> = stringifyExpression(
<span class="linenr"> 4228: </span>            processExpression(
<span class=
"linenr"> 4229: </span>              createSimpleExpression(rExp, <span class="org-constant">false</span>),
<span class="linenr"> 4230: </span>              context,
<span class="linenr"> 4231: </span>              <span class=
"org-constant">false</span>,
<span class="linenr"> 4232: </span>              <span class=
"org-constant">false</span>,
<span class="linenr"> 4233: </span>              knownIds
<span class="linenr"> 4234: </span>            )
<span class="linenr"> 4235: </span>          )
<span class="linenr"> 4236: </span>          <span class=
"org-keyword">return</span> <span class=
"org-string">`${context.helperString(IS_REF)}(${raw})${``} ? ${raw}.value ${operator} ${rExpString} : ${raw}`</span>
<span class="linenr"> 4237: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isUpdateArg) {
<span class="linenr"> 4238: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">make id replace parent in the code range so the raw update operator</span>
<span class="linenr"> 4239: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">is removed</span>
<span class=
"linenr"> 4240: </span>          id.start = parent.start
<span class="linenr"> 4241: </span>          id.end = parent.end
<span class="linenr"> 4242: </span>          <span class=
"org-keyword">const</span> { prefix: isPrefix, operator } = parent
<span class="linenr"> 4243: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prefix</span> = isPrefix ? operator : <span class="org-string">``</span>
<span class="linenr"> 4244: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">postfix</span> = isPrefix ? <span class=
"org-string">``</span> : operator
<span class="linenr"> 4245: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let binding.</span>
<span class="linenr"> 4246: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x++ --&gt; isRef(a) ? a.value++ : a++</span>
<span class="linenr"> 4247: </span>          <span class=
"org-keyword">return</span> <span class=
"org-string">`${context.helperString(IS_REF)}(${raw})${``} ? ${prefix}${raw}.value${postfix} : ${prefix}${raw}${postfix}`</span>
<span class="linenr"> 4248: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isDestructureAssignment) {
<span class="linenr"> 4249: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO</span></span></span>
<span class="linenr"> 4250: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let binding in a destructure assignment - it's very tricky to</span>
<span class="linenr"> 4251: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">handle both possible cases here without altering the original</span>
<span class="linenr"> 4252: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">structure of the code, so we just assume it's not a ref here</span>
<span class="linenr"> 4253: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for now</span>
<span class="linenr"> 4254: </span>          <span class=
"org-keyword">return</span> raw
<span class="linenr"> 4255: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4256: </span>          <span class=
"org-keyword">return</span> <span class=
"org-string">`${context.helperString(UNREF)}(${raw})`</span>
<span class="linenr"> 4257: </span>        }
<span class="linenr"> 4258: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.PROPS) {
<span class="linenr"> 4259: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">use __props which is generated by compileScript so in ts mode</span>
<span class="linenr"> 4260: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">it gets correct type</span>
<span class="linenr"> 4261: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`__props.${raw}`</span>
<span class="linenr"> 4262: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.PROPS_ALIASED) {
<span class="linenr"> 4263: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">prop with a different local alias (from defineProps() destructure)</span>
<span class="linenr"> 4264: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`__props.${bindingMetadata.__propsAliases[raw]}`</span>
<span class="linenr"> 4265: </span>      }
<span class="linenr"> 4266: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4267: </span>      <span class=
"org-keyword">if</span> (type &amp;& type.startsWith(<span class=
"org-string">'setup'</span>)) {
<span class="linenr"> 4268: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">setup bindings in non-inline mode</span>
<span class="linenr"> 4269: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`$setup.${raw}`</span>
<span class="linenr"> 4270: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.PROPS_ALIASED) {
<span class="linenr"> 4271: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`$props.${bindingMetadata.__propsAliases[raw]}`</span>
<span class="linenr"> 4272: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type) {
<span class="linenr"> 4273: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`$${type}.${raw}`</span>
<span class="linenr"> 4274: </span>      }
<span class="linenr"> 4275: </span>    }
<span class="linenr"> 4276: </span>
<span class="linenr"> 4277: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">fallback to ctx</span>
<span class="linenr"> 4278: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`_ctx.${raw}`</span>
<span class="linenr"> 4279: </span>  }
<span class="linenr"> 4280: </span>
<span class="linenr"> 4281: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">fast path if expression is a simple identifier.</span>
<span class="linenr"> 4282: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rawExp</span> = node.content
<span class="linenr"> 4283: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">bail constant on parens (function invocation) and dot (member access)</span>
<span class="linenr"> 4284: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bailConstant</span> = rawExp.indexOf(<span class="org-string">`(`</span>) &gt; -<span class="org-highlight-numbers-number">1</span> || rawExp.indexOf(<span class="org-string">'.'</span>) &gt; <span class="org-highlight-numbers-number">0</span>
<span class="linenr"> 4285: </span>
<span class="linenr"> 4286: </span>  logg(<span class=
"org-string">`processExpression - node.content: ${rawExp}`</span>)
<span class="linenr"> 4287: </span>  <span class=
"org-keyword">if</span> (isSimpleIdentifier(rawExp)) {
<span class="linenr"> 4288: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isScopeVarReference</span> = context.identifiers[rawExp]
<span class="linenr"> 4289: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isAllowedGlobal</span> = isGloballyWhitelisted(rawExp)
<span class="linenr"> 4290: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isLiteral</span> = isLiteralWhitelisted(rawExp)
<span class="linenr"> 4291: </span>    <span class=
"org-keyword">if</span> (!asParams &amp;& !isScopeVarReference &amp;& !isAllowedGlobal &amp;& !isLiteral) {
<span class="linenr"> 4292: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">const bindings exposed from setup can be skipped for patching but</span>
<span class="linenr"> 4293: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">cannot be hoisted to module scope</span>
<span class="linenr"> 4294: </span>      <span class=
"org-keyword">if</span> (bindingMetadata[node.content] === BindingTypes.SETUP_CONST) {
<span class=
"linenr"> 4295: </span>        node.constType = ConstantTypes.CAN_SKIP_PATCH
<span class="linenr"> 4296: </span>      }
<span class=
"linenr"> 4297: </span>      node.content = rewriteIdentifier(rawExp)
<span class="linenr"> 4298: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (!isScopeVarReference) {
<span class="linenr"> 4299: </span>      <span class=
"org-keyword">if</span> (isLiteral) {
<span class=
"linenr"> 4300: </span>        node.constType = ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 4301: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4302: </span>        node.constType = ConstantTypes.CAN_HOIST
<span class="linenr"> 4303: </span>      }
<span class="linenr"> 4304: </span>    }
<span class="linenr"> 4305: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 4306: </span>  }
<span class="linenr"> 4307: </span>
<span class="linenr"> 4308: </span>  <span class=
"org-keyword">let</span> <span class="org-variable-name">ast</span>
<span class="linenr"> 4309: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">exp needs to be parsed differently:</span>
<span class="linenr"> 4310: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. Multiple inline statements (v-on, with presence of `;`): parse as raw</span>
<span class="linenr"> 4311: </span>  <span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">exp, but make sure to pad with spaces for consistent ranges</span>
<span class="linenr"> 4312: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. Expressions: wrap with parens (for e.g. object expressions)</span>
<span class="linenr"> 4313: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">3. Function arguments (v-for, v-slot): place in a function argument position</span>
<span class="linenr"> 4314: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = asRawStatements
<span class="linenr"> 4315: </span>    ? <span class=
"org-string">` ${rawExp} `</span>
<span class="linenr"> 4316: </span>    : <span class=
"org-string">`(${rawExp})${asParams ? `</span>=&gt;{}<span class=
"org-string">` : ``}`</span>
<span class="linenr"> 4317: </span>  <span class=
"org-keyword">try</span> {
<span class=
"linenr"> 4318: </span>    ast = babelParser.parse(source, {
<span class=
"linenr"> 4319: </span>      plugins: context.expressionPlugins
<span class="linenr"> 4320: </span>    }).program
<span class="linenr"> 4321: </span>  } <span class=
"org-keyword">catch</span> (e) {
<span class="linenr"> 4322: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 4323: </span>  }
<span class="linenr"> 4324: </span>
<span class="linenr"> 4325: </span>  logg(<span class=
"org-string">`processExpression - babel parse`</span>, ast)
<span class="linenr"> 4326: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ids</span> = []
<span class="linenr"> 4327: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parentStack</span> = []
<span class="linenr"> 4328: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">knownIds</span> = Object.create(context.identifiers)
<span class="linenr"> 4329: </span>
<span class="linenr"> 4330: </span>  walkIdentifiers(
<span class="linenr"> 4331: </span>    ast,
<span class=
"linenr"> 4332: </span>    (node, parent, _, isReferenced, isLocal) =&gt; {
<span class="linenr"> 4333: </span>      <span class=
"org-keyword">if</span> (isStaticPropertyKey(node, parent)) {
<span class="linenr"> 4334: </span>        <span class=
"org-keyword">return</span>
<span class="linenr"> 4335: </span>      }
<span class="linenr"> 4336: </span>
<span class="linenr"> 4337: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">needPrefix</span> = isReferenced &amp;& canPrefix(node)
<span class="linenr"> 4338: </span>      <span class=
"org-keyword">if</span> (needPrefix &amp;& !isLocal) {
<span class="linenr"> 4339: </span>        <span class=
"org-keyword">if</span> (isStaticProperty(parent) &amp;& parent.shorthand) {
<span class="linenr"> 4340: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">property shorthand like { foo }, we need to add the key since</span>
<span class="linenr"> 4341: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we rewrite the value</span>
<span class=
"linenr"> 4342: </span>          node.prefix = <span class=
"org-string">`${node.name}: `</span>
<span class="linenr"> 4343: </span>        }
<span class=
"linenr"> 4344: </span>        node.name = rewriteIdentifier(node.name, parent, node)
<span class="linenr"> 4345: </span>        ids.push(node)
<span class="linenr"> 4346: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4347: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">The identifier is considered constant unless it's pointing to a</span>
<span class="linenr"> 4348: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">local scope variable (a v-for alias, or a v-slot prop)</span>
<span class="linenr"> 4349: </span>        <span class=
"org-keyword">if</span> (!(needPrefix &amp;& isLocal) &amp;& !bailConstant) {
<span class=
"linenr"> 4350: </span>          node.isConstant = <span class=
"org-constant">true</span>
<span class="linenr"> 4351: </span>        }
<span class="linenr"> 4352: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">also generate sub-expressions for other identifiers for better</span>
<span class="linenr"> 4353: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">source map support. (except for property keys which are static)</span>
<span class="linenr"> 4354: </span>        ids.push(node)
<span class="linenr"> 4355: </span>      }
<span class="linenr"> 4356: </span>    },
<span class="linenr"> 4357: </span>    <span class=
"org-constant">true</span>, <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">invoke on ALL identifiers</span>
<span class="linenr"> 4358: </span>    parentStack,
<span class="linenr"> 4359: </span>    knownIds
<span class="linenr"> 4360: </span>  )
<span class="linenr"> 4361: </span>
<span class="linenr"> 4362: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">We break up the compound expression into an array of strings and sub</span>
<span class="linenr"> 4363: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">expressions (for identifiers that have been prefixed). In codegen, if</span>
<span class="linenr"> 4364: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">an ExpressionNode has the `.children` property, it will be used instead of</span>
<span class="linenr"> 4365: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">`.content`.</span>
<span class="linenr"> 4366: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">children</span> = []
<span class=
"linenr"> 4367: </span>  ids.sort((a, b) =&gt; a.start - b.start)
<span class="linenr"> 4368: </span>  ids.forEach((id, i) =&gt; {
<span class="linenr"> 4369: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">range is offset by -1 due to the wrapping parens when parsed</span>
<span class="linenr"> 4370: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = id.start - <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 4371: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">end</span> = id.end - <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 4372: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">last</span> = ids[i - <span class=
"org-highlight-numbers-number">1</span>]
<span class="linenr"> 4373: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">leadingText</span> = rawExp.slice(last ? last.end - <span class="org-highlight-numbers-number">1</span> : <span class="org-highlight-numbers-number">0</span>, start)
<span class="linenr"> 4374: </span>    <span class=
"org-keyword">if</span> (leadingText.length || id.prefix) {
<span class=
"linenr"> 4375: </span>      children.push(leadingText + (id.prefix || <span class="org-string">``</span>))
<span class="linenr"> 4376: </span>    }
<span class="linenr"> 4377: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = rawExp.slice(start, end)
<span class="linenr"> 4378: </span>    children.push(
<span class="linenr"> 4379: </span>      createSimpleExpression(
<span class="linenr"> 4380: </span>        id.name,
<span class="linenr"> 4381: </span>        <span class=
"org-constant">false</span>,
<span class="linenr"> 4382: </span>        {
<span class="linenr"> 4383: </span>          source,
<span class=
"linenr"> 4384: </span>          start: advancePositionWithClone(node.loc.start, source, start),
<span class=
"linenr"> 4385: </span>          end: advancePositionWithClone(node.loc.start, source, end)
<span class="linenr"> 4386: </span>        },
<span class=
"linenr"> 4387: </span>        id.isConstant ? ConstantTypes.CAN_STRINGIFY : ConstantTypes.NOT_CONSTANT
<span class="linenr"> 4388: </span>      )
<span class="linenr"> 4389: </span>    )
<span class="linenr"> 4390: </span>    <span class=
"org-keyword">if</span> (i === ids.length - <span class=
"org-highlight-numbers-number">1</span> &amp;& end &lt; rawExp.length) {
<span class=
"linenr"> 4391: </span>      children.push(rawExp.slice(end))
<span class="linenr"> 4392: </span>    }
<span class="linenr"> 4393: </span>  })
<span class="linenr"> 4394: </span>
<span class="linenr"> 4395: </span>  <span class=
"org-keyword">let</span> <span class="org-variable-name">ret</span>
<span class="linenr"> 4396: </span>  <span class=
"org-keyword">if</span> (children.length) {
<span class=
"linenr"> 4397: </span>    ret = createCompoundExpression(children, node.loc)
<span class="linenr"> 4398: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4399: </span>    ret = node
<span class="linenr"> 4400: </span>    ret.constType = bailConstant
<span class=
"linenr"> 4401: </span>      ? ConstantTypes.NOT_CONSTANT
<span class=
"linenr"> 4402: </span>      : ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 4403: </span>  }
<span class=
"linenr"> 4404: </span>  ret.identifiers = Object.keys(knownIds)
<span class="linenr"> 4405: </span>  <span class=
"org-keyword">return</span> ret
<span class="linenr"> 4406: </span>}
<span class="linenr"> 4407: </span>
<span class="linenr"> 4408: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">canPrefix</span>(<span class=
"org-variable-name">id</span>) {
<span class="linenr"> 4409: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip whitelisted globals</span>
<span class="linenr"> 4410: </span>  <span class=
"org-keyword">if</span> (isGloballyWhitelisted(id.name)) {
<span class="linenr"> 4411: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 4412: </span>  }
<span class="linenr"> 4413: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">special case for webpack compilation</span>
<span class="linenr"> 4414: </span>  <span class=
"org-keyword">if</span> (id.name === <span class=
"org-string">'require'</span>) {
<span class="linenr"> 4415: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 4416: </span>  }
<span class="linenr"> 4417: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 4418: </span>}
<span class="linenr"> 4419: </span>
<span class="linenr"> 4420: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">stringifyExpression</span>(<span class=
"org-variable-name">exp</span>) {
<span class="linenr"> 4421: </span>  <span class=
"org-keyword">if</span> (isString(exp)) {
<span class="linenr"> 4422: </span>    <span class=
"org-keyword">return</span> exp
<span class="linenr"> 4423: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (exp.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 4424: </span>    <span class=
"org-keyword">return</span> exp.content
<span class="linenr"> 4425: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4426: </span>    <span class=
"org-keyword">return</span> (exp.children)
<span class="linenr"> 4427: </span>      .map(stringifyExpression)
<span class="linenr"> 4428: </span>      .join(<span class=
"org-string">''</span>)
<span class="linenr"> 4429: </span>  }
<span class="linenr"> 4430: </span>}
<span class="linenr"> 4431: </span>
<span class="linenr"> 4432: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformSlotOutlet</span> = (node, context) =&gt; {
<span class="linenr"> 4433: </span>  <span class=
"org-keyword">if</span> (isSlotOutlet(node)) { <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;slot/&gt;</span>
<span class="linenr"> 4434: </span>    <span class=
"org-keyword">const</span> { children, loc } = node
<span class="linenr"> 4435: </span>    <span class=
"org-keyword">const</span> { slotName, slotProps } = processSlotOutlet(node, context)
<span class="linenr"> 4436: </span>
<span class="linenr"> 4437: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotArgs</span> = [
<span class=
"linenr"> 4438: </span>      context.prefixIdentifiers ? <span class="org-string">`_ctx.$slots`</span> : <span class="org-string">`$slots`</span>,
<span class="linenr"> 4439: </span>      slotName,
<span class="linenr"> 4440: </span>      <span class=
"org-string">'{}'</span>, <span class=
"org-comment-delimiter">//  </span><span class=
"org-comment">props</span>
<span class="linenr"> 4441: </span>      <span class=
"org-string">'undefined'</span>, <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">children</span>
<span class="linenr"> 4442: </span>      <span class=
"org-string">'true'</span>
<span class="linenr"> 4443: </span>    ]
<span class="linenr"> 4444: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">expectedLen</span> = <span class=
"org-highlight-numbers-number">2</span>
<span class="linenr"> 4445: </span>
<span class="linenr"> 4446: </span>    <span class=
"org-keyword">if</span> (slotProps) {
<span class="linenr"> 4447: </span>      slotArgs[<span class=
"org-highlight-numbers-number">2</span>] = slotProps
<span class="linenr"> 4448: </span>      expectedLen = <span class=
"org-highlight-numbers-number">3</span>
<span class="linenr"> 4449: </span>    }
<span class="linenr"> 4450: </span>
<span class="linenr"> 4451: </span>    <span class=
"org-keyword">if</span> (children.length) {
<span class="linenr"> 4452: </span>      slotArgs[<span class=
"org-highlight-numbers-number">3</span>] = createFunctionExpression([], children, <span class="org-constant">false</span>, <span class="org-constant">false</span>, loc)
<span class="linenr"> 4453: </span>      expectedLen = <span class=
"org-highlight-numbers-number">4</span>
<span class="linenr"> 4454: </span>    }
<span class="linenr"> 4455: </span>
<span class="linenr"> 4456: </span>    <span class=
"org-keyword">if</span> (context.scopeId &amp;& !context.slotted) {
<span class="linenr"> 4457: </span>      expectedLen = <span class=
"org-highlight-numbers-number">5</span>
<span class="linenr"> 4458: </span>    }
<span class=
"linenr"> 4459: </span>    slotArgs.splice(expectedLen) <span class="org-comment-delimiter">// </span><span class="org-comment">remove unused arguments</span>
<span class="linenr"> 4460: </span>
<span class="linenr"> 4461: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">-&gt; renderSlot($slots, slotName, props, children, true)</span>
<span class=
"linenr"> 4462: </span>    node.codegenNode = createCallExpression(
<span class=
"linenr"> 4463: </span>      context.helper(RENDER_SLOT), <span class="org-comment-delimiter">// </span><span class="org-comment">renderSlot</span>
<span class="linenr"> 4464: </span>      slotArgs,
<span class="linenr"> 4465: </span>      loc
<span class="linenr"> 4466: </span>    )
<span class="linenr"> 4467: </span>  }
<span class="linenr"> 4468: </span>}
<span class="linenr"> 4469: </span>
<span class="linenr"> 4470: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">processSlotOutlet</span>(
<span class="linenr"> 4471: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 4472: </span>  context
<span class="linenr"> 4473: </span>) {
<span class="linenr"> 4474: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">slotName</span> = <span class=
"org-string">`"default"`</span>
<span class="linenr"> 4475: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">slotProps</span> = <span class=
"org-constant">undefined</span>
<span class="linenr"> 4476: </span>
<span class="linenr"> 4477: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">nonNameProps</span> = [] <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">无名插槽</span>
<span class="linenr"> 4478: </span>  logg(<span class=
"org-string">`processSlotOutlet| props.length = ${node.props.length}`</span>)
<span class="linenr"> 4479: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr"> 4480: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = node.props[i]
<span class="linenr"> 4481: </span>    logg(<span class=
"org-string">`processSlotOutlet| props[${i}]`</span>, p)
<span class="linenr"> 4482: </span>    <span class=
"org-keyword">if</span> (p.type === NodeTypes.ATTRIBUTE) { <span class="org-comment-delimiter">// </span><span class="org-comment">静态 &lt;slot name="xxx"/&gt;</span>
<span class="linenr"> 4483: </span>      <span class=
"org-keyword">if</span> (p.value) {
<span class="linenr"> 4484: </span>        <span class=
"org-keyword">if</span> (p.name === <span class=
"org-string">'name'</span>) {
<span class=
"linenr"> 4485: </span>          slotName = JSON.stringify(p.value.content)
<span class="linenr"> 4486: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4487: </span>          p.name = camelize(p.name)
<span class="linenr"> 4488: </span>          nonNameProps.push(p)
<span class="linenr"> 4489: </span>        }
<span class="linenr"> 4490: </span>      }
<span class="linenr"> 4491: </span>    } <span class=
"org-keyword">else</span> { <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">动态 &lt;slot :name="xxx"/&gt;</span>
<span class="linenr"> 4492: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">动态插槽 &lt;slot v-bind:name="slotName"/&gt;</span>
<span class="linenr"> 4493: </span>      <span class=
"org-keyword">if</span> (p.name === <span class=
"org-string">'bind'</span> &amp;& isStaticArgOf(p.arg, <span class=
"org-string">'name'</span>)) {
<span class="linenr"> 4494: </span>        <span class=
"org-keyword">if</span> (p.exp) slotName = p.exp
<span class="linenr"> 4495: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4496: </span>        <span class=
"org-keyword">if</span> (p.name === <span class=
"org-string">'bind'</span> &amp;& p.arg &amp;& isStaticExp(p.arg)) {
<span class=
"linenr"> 4497: </span>          p.arg.content = camelize(p.arg.content)
<span class="linenr"> 4498: </span>        }
<span class="linenr"> 4499: </span>        nonNameProps.push(p)
<span class="linenr"> 4500: </span>      }
<span class="linenr"> 4501: </span>    }
<span class="linenr"> 4502: </span>  }
<span class="linenr"> 4503: </span>
<span class="linenr"> 4504: </span>  logg(<span class=
"org-string">`processSlotOutlet| nonNameProps.length=${nonNameProps.length}`</span>)
<span class="linenr"> 4505: </span>  <span class=
"org-keyword">if</span> (nonNameProps.length &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 4506: </span>    <span class=
"org-keyword">const</span> { props, directives } = buildProps(node, context, nonNameProps)
<span class="linenr"> 4507: </span>    slotProps = props
<span class="linenr"> 4508: </span>
<span class="linenr"> 4509: </span>    <span class=
"org-keyword">if</span> (directives.length) {
<span class="linenr"> 4510: </span>      logg(<span class=
"org-string">'[ERROR] X_V_SLOT_UNEXPECTED_DIRECTIVE_ON_SLOT_OUTLET'</span>)
<span class="linenr"> 4511: </span>    }
<span class="linenr"> 4512: </span>  }
<span class="linenr"> 4513: </span>
<span class="linenr"> 4514: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 4515: </span>    slotName,
<span class="linenr"> 4516: </span>    slotProps
<span class="linenr"> 4517: </span>  }
<span class="linenr"> 4518: </span>}
<span class="linenr"> 4519: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Merge adjacent text nodes and expressions into a single expression</span>
<span class="linenr"> 4520: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">e.g. &lt;div&gt;abc {{ d }} {{ e }}&lt;/div&gt; should have a single expression node as child.</span>
<span class="linenr"> 4521: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformText</span> = (node, context) =&gt; {
<span class="linenr"> 4522: </span>  <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 4523: </span>    node.type === NodeTypes.ROOT ||
<span class=
"linenr"> 4524: </span>    node.type === NodeTypes.ELEMENT ||
<span class=
"linenr"> 4525: </span>    node.type === NodeTypes.FOR ||
<span class=
"linenr"> 4526: </span>    node.type === NodeTypes.IF_BRANCH
<span class="linenr"> 4527: </span>  ) {
<span class="linenr"> 4528: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">perform the transform on node exit so that all expressions have already</span>
<span class="linenr"> 4529: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">been processed.</span>
<span class="linenr"> 4530: </span>    <span class=
"org-keyword">return</span> () =&gt; {
<span class="linenr"> 4531: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">children</span> = node.children
<span class="linenr"> 4532: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">currentContainer</span> = <span class=
"org-constant">undefined</span>
<span class="linenr"> 4533: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasText</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 4534: </span>
<span class="linenr"> 4535: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; children.length; i++) {
<span class="linenr"> 4536: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = children[i]
<span class="linenr"> 4537: </span>        <span class=
"org-keyword">if</span> (isText(child)) {
<span class="linenr"> 4538: </span>          hasText = <span class=
"org-constant">true</span>
<span class="linenr"> 4539: </span>          <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">j</span> = i + <span class=
"org-highlight-numbers-number">1</span>; j &lt; children.length; j++) {
<span class="linenr"> 4540: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">next</span> = children[j]
<span class="linenr"> 4541: </span>            <span class=
"org-keyword">if</span> (isText(next)) {
<span class="linenr"> 4542: </span>              <span class=
"org-keyword">if</span> (!currentContainer) {
<span class=
"linenr"> 4543: </span>                currentContainer = children[i] = {
<span class=
"linenr"> 4544: </span>                  type: NodeTypes.COMPOUND_EXPRESSION,
<span class=
"linenr"> 4545: </span>                  loc: child.loc,
<span class=
"linenr"> 4546: </span>                  children: [child]
<span class="linenr"> 4547: </span>                }
<span class="linenr"> 4548: </span>              }
<span class="linenr"> 4549: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">merge adjacent text node into current</span>
<span class=
"linenr"> 4550: </span>              currentContainer.children.push(<span class="org-string">` + `</span>, next)
<span class=
"linenr"> 4551: </span>              children.splice(j, <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 4552: </span>              j--
<span class="linenr"> 4553: </span>            } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4554: </span>              currentContainer = <span class="org-constant">undefined</span>
<span class="linenr"> 4555: </span>              <span class=
"org-keyword">break</span>
<span class="linenr"> 4556: </span>            }
<span class="linenr"> 4557: </span>          }
<span class="linenr"> 4558: </span>        }
<span class="linenr"> 4559: </span>      }
<span class="linenr"> 4560: </span>
<span class="linenr"> 4561: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 4562: </span>        !hasText ||
<span class="linenr"> 4563: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if this is a plain element with a single text child, leave it</span>
<span class="linenr"> 4564: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">as-is since the runtime has dedicated fast path for this by directly</span>
<span class="linenr"> 4565: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">setting textContent of the element.</span>
<span class="linenr"> 4566: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for component root it's always normalized anyway.</span>
<span class=
"linenr"> 4567: </span>        (children.length === <span class=
"org-highlight-numbers-number">1</span> &amp;&
<span class=
"linenr"> 4568: </span>          (node.type === NodeTypes.ROOT ||
<span class=
"linenr"> 4569: </span>            (node.type === NodeTypes.ELEMENT &amp;&
<span class=
"linenr"> 4570: </span>              node.tagType === ElementTypes.ELEMENT &amp;&
<span class="linenr"> 4571: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#3756</span>
<span class="linenr"> 4572: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">custom directives can potentially add DOM elements arbitrarily,</span>
<span class="linenr"> 4573: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we need to avoid setting textContent of the element at runtime</span>
<span class="linenr"> 4574: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">to avoid accidentally overwriting the DOM elements added</span>
<span class="linenr"> 4575: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">by the user through custom directives.</span>
<span class="linenr"> 4576: </span>              !node.props.find(
<span class="linenr"> 4577: </span>                p =&gt;
<span class=
"linenr"> 4578: </span>                  p.type === NodeTypes.DIRECTIVE &amp;&
<span class=
"linenr"> 4579: </span>                  !context.directiveTransforms[p.name]
<span class="linenr"> 4580: </span>              ))))
<span class="linenr"> 4581: </span>      ) {
<span class="linenr"> 4582: </span>        <span class=
"org-keyword">return</span>
<span class="linenr"> 4583: </span>      }
<span class="linenr"> 4584: </span>
<span class="linenr"> 4585: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">pre-convert text nodes into createTextVNode(text) calls to avoid</span>
<span class="linenr"> 4586: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">runtime normalization.</span>
<span class="linenr"> 4587: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; children.length; i++) {
<span class="linenr"> 4588: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = children[i]
<span class="linenr"> 4589: </span>        <span class=
"org-keyword">if</span> (isText(child) || child.type === NodeTypes.COMPOUND_EXPRESSION) {
<span class="linenr"> 4590: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">callArgs</span> = []
<span class="linenr"> 4591: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">createTextVNode defaults to single whitespace, so if it is a</span>
<span class="linenr"> 4592: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">single space the code could be an empty call to save bytes.</span>
<span class="linenr"> 4593: </span>          <span class=
"org-keyword">if</span> (child.type !== NodeTypes.TEXT || child.content !== <span class="org-string">' '</span>) {
<span class="linenr"> 4594: </span>            callArgs.push(child)
<span class="linenr"> 4595: </span>          }
<span class="linenr"> 4596: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">mark dynamic text with flag so it gets patched inside a block</span>
<span class="linenr"> 4597: </span>          <span class=
"org-keyword">if</span> (
<span class="linenr"> 4598: </span>            !context.ssr &amp;&
<span class=
"linenr"> 4599: </span>            getConstantType(child, context) === ConstantTypes.NOT_CONSTANT
<span class="linenr"> 4600: </span>          ) {
<span class="linenr"> 4601: </span>            callArgs.push(
<span class="linenr"> 4602: </span>              PatchFlags.TEXT +
<span class=
"linenr"> 4603: </span>                (__DEV__ ? <span class=
"org-string">` /* ${PatchFlagNames[PatchFlags.TEXT]} */`</span> : <span class="org-string">``</span>)
<span class="linenr"> 4604: </span>            )
<span class="linenr"> 4605: </span>          }
<span class="linenr"> 4606: </span>          children[i] = {
<span class=
"linenr"> 4607: </span>            type: NodeTypes.TEXT_CALL,
<span class="linenr"> 4608: </span>            content: child,
<span class="linenr"> 4609: </span>            loc: child.loc,
<span class=
"linenr"> 4610: </span>            codegenNode: createCallExpression(
<span class=
"linenr"> 4611: </span>              context.helper(CREATE_TEXT),
<span class="linenr"> 4612: </span>              callArgs
<span class="linenr"> 4613: </span>            )
<span class="linenr"> 4614: </span>          }
<span class="linenr"> 4615: </span>        }
<span class="linenr"> 4616: </span>      }
<span class="linenr"> 4617: </span>    }
<span class="linenr"> 4618: </span>  }
<span class="linenr"> 4619: </span>}
<span class="linenr"> 4620: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-bind without arg is handled directly in ./transformElements.ts due to it affecting</span>
<span class="linenr"> 4621: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">codegen for the entire props object. This transform here is only for v-bind</span>
<span class="linenr"> 4622: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">*with* args.</span>
<span class="linenr"> 4623: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformBind</span> = (dir, _node, context) =&gt; {
<span class="linenr"> 4624: </span>  <span class=
"org-keyword">const</span> { exp, modifiers, loc } = dir
<span class="linenr"> 4625: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">arg</span> = dir.arg
<span class="linenr"> 4626: </span>
<span class="linenr"> 4627: </span>  <span class=
"org-keyword">if</span> (arg.type !== NodeTypes.SIMPLE_EXPRESSION) {
<span class=
"linenr"> 4628: </span>    arg.children.unshift(<span class=
"org-string">`(`</span>)
<span class=
"linenr"> 4629: </span>    arg.children.push(<span class=
"org-string">`) || ""`</span>)
<span class="linenr"> 4630: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (!arg.isStatic) {
<span class="linenr"> 4631: </span>    arg.content = <span class=
"org-string">`${arg.content} || ""`</span>
<span class="linenr"> 4632: </span>  }
<span class="linenr"> 4633: </span>
<span class="linenr"> 4634: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">.sync is replaced by v-model:arg</span>
<span class="linenr"> 4635: </span>  <span class=
"org-keyword">if</span> (modifiers.includes(<span class=
"org-string">'camel'</span>)) {
<span class="linenr"> 4636: </span>    <span class=
"org-keyword">if</span> (arg.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 4637: </span>      <span class=
"org-keyword">if</span> (arg.isStatic) {
<span class=
"linenr"> 4638: </span>        arg.content = camelize(arg.content)
<span class="linenr"> 4639: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4640: </span>        arg.content = <span class=
"org-string">`${context.helperString(CAMELIZE)}(${arg.content})`</span>
<span class="linenr"> 4641: </span>      }
<span class="linenr"> 4642: </span>    } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4643: </span>      arg.children.unshift(<span class=
"org-string">`${context.helperString(CAMELIZE)}(`</span>)
<span class=
"linenr"> 4644: </span>      arg.children.push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 4645: </span>    }
<span class="linenr"> 4646: </span>  }
<span class="linenr"> 4647: </span>
<span class="linenr"> 4648: </span>  <span class=
"org-keyword">if</span> (!context.inSSR) {
<span class="linenr"> 4649: </span>    <span class=
"org-keyword">if</span> (modifiers.includes(<span class=
"org-string">'prop'</span>)) {
<span class=
"linenr"> 4650: </span>      injectPrefix(arg, <span class=
"org-string">'.'</span>)
<span class="linenr"> 4651: </span>    }
<span class="linenr"> 4652: </span>    <span class=
"org-keyword">if</span> (modifiers.includes(<span class=
"org-string">'attr'</span>)) {
<span class=
"linenr"> 4653: </span>      injectPrefix(arg, <span class=
"org-string">'^'</span>)
<span class="linenr"> 4654: </span>    }
<span class="linenr"> 4655: </span>  }
<span class="linenr"> 4656: </span>
<span class="linenr"> 4657: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 4658: </span>    !exp ||
<span class=
"linenr"> 4659: </span>    (exp.type === NodeTypes.SIMPLE_EXPRESSION &amp;& !exp.content.trim())
<span class="linenr"> 4660: </span>  ) {
<span class="linenr"> 4661: </span>    logg(<span class=
"org-string">`transformBind v-bind no expression`</span>)
<span class="linenr"> 4662: </span>    <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 4663: </span>      props: [createObjectProperty(arg, createSimpleExpression(<span class="org-string">''</span>, <span class="org-constant">true</span>, loc))]
<span class="linenr"> 4664: </span>    }
<span class="linenr"> 4665: </span>  }
<span class="linenr"> 4666: </span>
<span class="linenr"> 4667: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 4668: </span>    props: [createObjectProperty(arg, exp)]
<span class="linenr"> 4669: </span>  }
<span class="linenr"> 4670: </span>}
<span class="linenr"> 4671: </span>
<span class="linenr"> 4672: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">injectPrefix</span> = (arg, prefix) =&gt; {
<span class="linenr"> 4673: </span>  <span class=
"org-keyword">if</span> (arg.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 4674: </span>    <span class=
"org-keyword">if</span> (arg.isStatic) {
<span class=
"linenr"> 4675: </span>      arg.content = prefix + arg.content
<span class="linenr"> 4676: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4677: </span>      arg.content = <span class=
"org-string">`\`${prefix}\${${arg.content}}\``</span>
<span class="linenr"> 4678: </span>    }
<span class="linenr"> 4679: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4680: </span>    arg.children.unshift(<span class=
"org-string">`'${prefix}' + (`</span>)
<span class=
"linenr"> 4681: </span>    arg.children.push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 4682: </span>  }
<span class="linenr"> 4683: </span>}
<span class="linenr"> 4684: </span>
<span class="linenr"> 4685: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformFor</span> = createStructuralDirectiveTransform(
<span class="linenr"> 4686: </span>  <span class=
"org-string">'for'</span>,
<span class="linenr"> 4687: </span>  (node, dir, context) =&gt; {
<span class="linenr"> 4688: </span>    <span class=
"org-keyword">const</span> { helper, removeHelper } = context
<span class="linenr"> 4689: </span>    <span class=
"org-keyword">return</span> processFor(node, dir, context, forNode =&gt; {
<span class="linenr"> 4690: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">create the loop render function expression now, and add the</span>
<span class="linenr"> 4691: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">iterator on exit after all children have been traversed</span>
<span class="linenr"> 4692: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">renderExp</span> = createCallExpression(helper(RENDER_LIST), [
<span class="linenr"> 4693: </span>        forNode.source
<span class="linenr"> 4694: </span>      ])
<span class="linenr"> 4695: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isTemplate</span> = isTemplateNode(node)
<span class="linenr"> 4696: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">memo</span> = findDir(node, <span class=
"org-string">'memo'</span>)
<span class="linenr"> 4697: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyProp</span> = findProp(node, <span class=
"org-string">`key`</span>)
<span class="linenr"> 4698: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyExp</span> =
<span class="linenr"> 4699: </span>        keyProp &amp;&
<span class=
"linenr"> 4700: </span>        (keyProp.type === NodeTypes.ATTRIBUTE
<span class=
"linenr"> 4701: </span>          ? createSimpleExpression(keyProp.value.content, <span class="org-constant">true</span>)
<span class="linenr"> 4702: </span>          : keyProp.exp)
<span class="linenr"> 4703: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyProperty</span> = keyProp ? createObjectProperty(<span class="org-string">`key`</span>, keyExp) : <span class="org-constant">null</span>
<span class="linenr"> 4704: </span>
<span class="linenr"> 4705: </span>      <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& isTemplate) {
<span class="linenr"> 4706: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#2085 / #5288 process :key and v-memo expressions need to be</span>
<span class="linenr"> 4707: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">processed on `&lt;template v-for&gt;`. In this case the node is discarded</span>
<span class="linenr"> 4708: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">and never traversed so its binding expressions won't be processed</span>
<span class="linenr"> 4709: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">by the normal transforms.</span>
<span class="linenr"> 4710: </span>        <span class=
"org-keyword">if</span> (memo) {
<span class=
"linenr"> 4711: </span>          memo.exp = processExpression(
<span class="linenr"> 4712: </span>            memo.exp ,
<span class="linenr"> 4713: </span>            context
<span class="linenr"> 4714: </span>          )
<span class="linenr"> 4715: </span>        }
<span class="linenr"> 4716: </span>        <span class=
"org-keyword">if</span> (keyProperty &amp;& keyProp.type !== NodeTypes.ATTRIBUTE) {
<span class=
"linenr"> 4717: </span>          keyProperty.value = processExpression(
<span class="linenr"> 4718: </span>            keyProperty.value ,
<span class="linenr"> 4719: </span>            context
<span class="linenr"> 4720: </span>          )
<span class="linenr"> 4721: </span>        }
<span class="linenr"> 4722: </span>      }
<span class="linenr"> 4723: </span>
<span class="linenr"> 4724: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isStableFragment</span> =
<span class=
"linenr"> 4725: </span>        forNode.source.type === NodeTypes.SIMPLE_EXPRESSION &amp;&
<span class=
"linenr"> 4726: </span>        forNode.source.constType &gt; ConstantTypes.NOT_CONSTANT
<span class="linenr"> 4727: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">fragmentFlag</span> = isStableFragment
<span class=
"linenr"> 4728: </span>        ? PatchFlags.STABLE_FRAGMENT
<span class="linenr"> 4729: </span>        : keyProp
<span class=
"linenr"> 4730: </span>        ? PatchFlags.KEYED_FRAGMENT
<span class=
"linenr"> 4731: </span>        : PatchFlags.UNKEYED_FRAGMENT
<span class="linenr"> 4732: </span>
<span class=
"linenr"> 4733: </span>      forNode.codegenNode = createVNodeCall(
<span class="linenr"> 4734: </span>        context,
<span class="linenr"> 4735: </span>        helper(FRAGMENT),
<span class="linenr"> 4736: </span>        <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4737: </span>        renderExp,
<span class="linenr"> 4738: </span>        fragmentFlag +
<span class=
"linenr"> 4739: </span>          (__DEV__ ? <span class="org-string">` /* ${PatchFlagNames[fragmentFlag]} */`</span> : <span class="org-string">``</span>),
<span class="linenr"> 4740: </span>        <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4741: </span>        <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4742: </span>        <span class=
"org-constant">true</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">isBlock</span><span class=
"org-comment-delimiter"> */</span>,
<span class=
"linenr"> 4743: </span>        !isStableFragment <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">disableTracking</span><span class=
"org-comment-delimiter"> */</span>,
<span class="linenr"> 4744: </span>        <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">isComponent</span><span class=
"org-comment-delimiter"> */</span>,
<span class="linenr"> 4745: </span>        node.loc
<span class="linenr"> 4746: </span>      )
<span class="linenr"> 4747: </span>
<span class="linenr"> 4748: </span>      <span class=
"org-keyword">return</span> () =&gt; {
<span class="linenr"> 4749: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">finish the codegen now that all children have been traversed</span>
<span class="linenr"> 4750: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">childBlock</span>
<span class="linenr"> 4751: </span>        <span class=
"org-keyword">const</span> { children } = forNode
<span class="linenr"> 4752: </span>
<span class="linenr"> 4753: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check &lt;template v-for&gt; key placement</span>
<span class="linenr"> 4754: </span>        <span class=
"org-keyword">if</span> ((__DEV__ || !__BROWSER__) &amp;& isTemplate) {
<span class=
"linenr"> 4755: </span>          node.children.some(c =&gt; {
<span class="linenr"> 4756: </span>            <span class=
"org-keyword">if</span> (c.type === NodeTypes.ELEMENT) {
<span class="linenr"> 4757: </span>              <span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> = findProp(c, <span class=
"org-string">'key'</span>)
<span class="linenr"> 4758: </span>              <span class=
"org-keyword">if</span> (key) {
<span class=
"linenr"> 4759: </span>                logg(<span class="org-string">`transformFor - key on template`</span>)
<span class="linenr"> 4760: </span>                <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 4761: </span>              }
<span class="linenr"> 4762: </span>            }
<span class="linenr"> 4763: </span>          })
<span class="linenr"> 4764: </span>        }
<span class="linenr"> 4765: </span>
<span class="linenr"> 4766: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">needFragmentWrapper</span> =
<span class=
"linenr"> 4767: </span>          children.length !== <span class=
"org-highlight-numbers-number">1</span> || children[<span class=
"org-highlight-numbers-number">0</span>].type !== NodeTypes.ELEMENT
<span class="linenr"> 4768: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotOutlet</span> = isSlotOutlet(node)
<span class="linenr"> 4769: </span>          ? node
<span class="linenr"> 4770: </span>          : isTemplate &amp;&
<span class=
"linenr"> 4771: </span>            node.children.length === <span class="org-highlight-numbers-number">1</span> &amp;&
<span class=
"linenr"> 4772: </span>            isSlotOutlet(node.children[<span class="org-highlight-numbers-number">0</span>])
<span class=
"linenr"> 4773: </span>          ? node.children[<span class=
"org-highlight-numbers-number">0</span>] <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">api-extractor somehow fails to infer this</span>
<span class="linenr"> 4774: </span>          : <span class=
"org-constant">null</span>
<span class="linenr"> 4775: </span>
<span class="linenr"> 4776: </span>        <span class=
"org-keyword">if</span> (slotOutlet) {
<span class="linenr"> 4777: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;slot v-for="..."&gt; or &lt;template v-for="..."&gt;&lt;slot/&gt;&lt;/template&gt;</span>
<span class=
"linenr"> 4778: </span>          childBlock = slotOutlet.codegenNode
<span class="linenr"> 4779: </span>          <span class=
"org-keyword">if</span> (isTemplate &amp;& keyProperty) {
<span class="linenr"> 4780: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;template v-for="..." :key="..."&gt;&lt;slot/&gt;&lt;/template&gt;</span>
<span class="linenr"> 4781: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we need to inject the key to the renderSlot() call.</span>
<span class="linenr"> 4782: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the props for renderSlot is passed as the 3rd argument.</span>
<span class=
"linenr"> 4783: </span>            injectProp(childBlock, keyProperty, context)
<span class="linenr"> 4784: </span>          }
<span class="linenr"> 4785: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (needFragmentWrapper) {
<span class="linenr"> 4786: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;template v-for="..."&gt; with text or multi-elements</span>
<span class="linenr"> 4787: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">should generate a fragment block for each loop</span>
<span class=
"linenr"> 4788: </span>          childBlock = createVNodeCall(
<span class="linenr"> 4789: </span>            context,
<span class="linenr"> 4790: </span>            helper(FRAGMENT),
<span class=
"linenr"> 4791: </span>            keyProperty ? createObjectExpression([keyProperty]) : <span class="org-constant">undefined</span>,
<span class="linenr"> 4792: </span>            node.children,
<span class=
"linenr"> 4793: </span>            PatchFlags.STABLE_FRAGMENT +
<span class="linenr"> 4794: </span>              (__DEV__
<span class="linenr"> 4795: </span>                ? <span class=
"org-string">` /* ${PatchFlagNames[PatchFlags.STABLE_FRAGMENT]} */`</span>
<span class="linenr"> 4796: </span>                : <span class=
"org-string">``</span>),
<span class="linenr"> 4797: </span>            <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4798: </span>            <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4799: </span>            <span class=
"org-constant">true</span>,
<span class="linenr"> 4800: </span>            <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4801: </span>            <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">isComponent</span><span class=
"org-comment-delimiter"> */</span>
<span class="linenr"> 4802: </span>          )
<span class="linenr"> 4803: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4804: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Normal element v-for. Directly use the child's codegenNode</span>
<span class="linenr"> 4805: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">but mark it as a block.</span>
<span class=
"linenr"> 4806: </span>          childBlock = children[<span class=
"org-highlight-numbers-number">0</span>].codegenNode
<span class="linenr"> 4807: </span>          <span class=
"org-keyword">if</span> (isTemplate &amp;& keyProperty) {
<span class=
"linenr"> 4808: </span>            injectProp(childBlock, keyProperty, context)
<span class="linenr"> 4809: </span>          }
<span class="linenr"> 4810: </span>          <span class=
"org-keyword">if</span> (childBlock.isBlock !== !isStableFragment) {
<span class="linenr"> 4811: </span>            <span class=
"org-keyword">if</span> (childBlock.isBlock) {
<span class="linenr"> 4812: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">switch from block to vnode</span>
<span class=
"linenr"> 4813: </span>              removeHelper(OPEN_BLOCK)
<span class="linenr"> 4814: </span>              removeHelper(
<span class=
"linenr"> 4815: </span>                getVNodeBlockHelper(context.inSSR, childBlock.isComponent)
<span class="linenr"> 4816: </span>              )
<span class="linenr"> 4817: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4818: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">switch from vnode to block</span>
<span class="linenr"> 4819: </span>              removeHelper(
<span class=
"linenr"> 4820: </span>                getVNodeHelper(context.inSSR, childBlock.isComponent)
<span class="linenr"> 4821: </span>              )
<span class="linenr"> 4822: </span>            }
<span class="linenr"> 4823: </span>          }
<span class=
"linenr"> 4824: </span>          childBlock.isBlock = !isStableFragment
<span class="linenr"> 4825: </span>          <span class=
"org-keyword">if</span> (childBlock.isBlock) {
<span class="linenr"> 4826: </span>            helper(OPEN_BLOCK)
<span class=
"linenr"> 4827: </span>            helper(getVNodeBlockHelper(context.inSSR, childBlock.isComponent))
<span class="linenr"> 4828: </span>          } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4829: </span>            helper(getVNodeHelper(context.inSSR, childBlock.isComponent))
<span class="linenr"> 4830: </span>          }
<span class="linenr"> 4831: </span>        }
<span class="linenr"> 4832: </span>
<span class="linenr"> 4833: </span>        <span class=
"org-keyword">if</span> (memo) {
<span class="linenr"> 4834: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">loop</span> = createFunctionExpression(
<span class=
"linenr"> 4835: </span>            createForLoopParams(forNode.parseResult, [
<span class=
"linenr"> 4836: </span>              createSimpleExpression(<span class="org-string">`_cached`</span>)
<span class="linenr"> 4837: </span>            ])
<span class="linenr"> 4838: </span>          )
<span class=
"linenr"> 4839: </span>          loop.body = createBlockStatement([
<span class=
"linenr"> 4840: </span>            createCompoundExpression([<span class="org-string">`const _memo = (`</span>, memo.exp, <span class="org-string">`)`</span>]),
<span class=
"linenr"> 4841: </span>            createCompoundExpression([
<span class="linenr"> 4842: </span>              <span class=
"org-string">`if (_cached`</span>,
<span class=
"linenr"> 4843: </span>              ...(keyExp ? [<span class=
"org-string">` &amp;& _cached.key === `</span>, keyExp] : []),
<span class="linenr"> 4844: </span>              <span class=
"org-string">` &amp;& ${context.helperString(</span>
<span class="linenr"> 4845: </span><span class=
"org-string">                IS_MEMO_SAME</span>
<span class="linenr"> 4846: </span><span class=
"org-string">              )}(_cached, _memo)) return _cached`</span>
<span class="linenr"> 4847: </span>            ]),
<span class=
"linenr"> 4848: </span>            createCompoundExpression([<span class="org-string">`const _item = `</span>, childBlock]),
<span class=
"linenr"> 4849: </span>            createSimpleExpression(<span class="org-string">`_item.memo = _memo`</span>),
<span class=
"linenr"> 4850: </span>            createSimpleExpression(<span class="org-string">`return _item`</span>)
<span class="linenr"> 4851: </span>          ])
<span class="linenr"> 4852: </span>          renderExp.<span class=
"org-constant">arguments</span>.push(
<span class="linenr"> 4853: </span>            loop,
<span class=
"linenr"> 4854: </span>            createSimpleExpression(<span class="org-string">`_cache`</span>),
<span class=
"linenr"> 4855: </span>            createSimpleExpression(String(context.cached++))
<span class="linenr"> 4856: </span>          )
<span class="linenr"> 4857: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4858: </span>          renderExp.<span class=
"org-constant">arguments</span>.push(
<span class=
"linenr"> 4859: </span>            createFunctionExpression(
<span class=
"linenr"> 4860: </span>              createForLoopParams(forNode.parseResult),
<span class="linenr"> 4861: </span>              childBlock,
<span class="linenr"> 4862: </span>              <span class=
"org-constant">true</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">force newline</span><span class=
"org-comment-delimiter"> */</span>
<span class="linenr"> 4863: </span>            )
<span class="linenr"> 4864: </span>          )
<span class="linenr"> 4865: </span>        }
<span class="linenr"> 4866: </span>      }
<span class="linenr"> 4867: </span>    })
<span class="linenr"> 4868: </span>  }
<span class="linenr"> 4869: </span>)
<span class="linenr"> 4870: </span>
<span class="linenr"> 4871: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">target-agnostic transform used for both Client and SSR</span>
<span class="linenr"> 4872: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">processFor</span>(
<span class="linenr"> 4873: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 4874: </span>  <span class=
"org-variable-name">dir</span>,
<span class="linenr"> 4875: </span>  <span class=
"org-variable-name">context</span>,
<span class="linenr"> 4876: </span>  processCodegen
<span class="linenr"> 4877: </span>) {
<span class="linenr"> 4878: </span>  <span class=
"org-keyword">if</span> (!dir.exp) {
<span class="linenr"> 4879: </span>    logg(<span class=
"org-string">`processFor - dir.exp is null`</span>)
<span class="linenr"> 4880: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 4881: </span>  }
<span class="linenr"> 4882: </span>
<span class="linenr"> 4883: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parseResult</span> = parseForExpression(
<span class="linenr"> 4884: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">can only be simple expression because vFor transform is applied</span>
<span class="linenr"> 4885: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">before expression transform.</span>
<span class="linenr"> 4886: </span>    dir.exp,
<span class="linenr"> 4887: </span>    context
<span class="linenr"> 4888: </span>  )
<span class="linenr"> 4889: </span>
<span class="linenr"> 4890: </span>  <span class=
"org-keyword">if</span> (!parseResult) {
<span class="linenr"> 4891: </span>    logg(<span class=
"org-string">`processFor - parseResult is null`</span>)
<span class="linenr"> 4892: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 4893: </span>  }
<span class="linenr"> 4894: </span>
<span class="linenr"> 4895: </span>  <span class=
"org-keyword">const</span> { addIdentifiers, removeIdentifiers, scopes } = context
<span class="linenr"> 4896: </span>  <span class=
"org-keyword">const</span> { source, value, key, index } = parseResult
<span class="linenr"> 4897: </span>
<span class="linenr"> 4898: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">forNode</span> = {
<span class="linenr"> 4899: </span>    type: NodeTypes.FOR,
<span class="linenr"> 4900: </span>    loc: dir.loc,
<span class="linenr"> 4901: </span>    source,
<span class="linenr"> 4902: </span>    valueAlias: value,
<span class="linenr"> 4903: </span>    keyAlias: key,
<span class="linenr"> 4904: </span>    objectIndexAlias: index,
<span class="linenr"> 4905: </span>    parseResult,
<span class=
"linenr"> 4906: </span>    children: isTemplateNode(node) ? node.children : [node]
<span class="linenr"> 4907: </span>  }
<span class="linenr"> 4908: </span>
<span class="linenr"> 4909: </span>  context.replaceNode(forNode)
<span class="linenr"> 4910: </span>
<span class="linenr"> 4911: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">bookkeeping</span>
<span class="linenr"> 4912: </span>  scopes.vFor++
<span class="linenr"> 4913: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class="linenr"> 4914: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">scope management</span>
<span class="linenr"> 4915: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject identifiers to context</span>
<span class=
"linenr"> 4916: </span>    value &amp;& addIdentifiers(value)
<span class=
"linenr"> 4917: </span>    key &amp;& addIdentifiers(key)
<span class=
"linenr"> 4918: </span>    index &amp;& addIdentifiers(index)
<span class="linenr"> 4919: </span>  }
<span class="linenr"> 4920: </span>
<span class="linenr"> 4921: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">onExit</span> = processCodegen &amp;& processCodegen(forNode)
<span class="linenr"> 4922: </span>
<span class="linenr"> 4923: </span>  <span class=
"org-keyword">return</span> () =&gt; {
<span class="linenr"> 4924: </span>    scopes.vFor--
<span class="linenr"> 4925: </span>    <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 4926: </span>      value &amp;& removeIdentifiers(value)
<span class=
"linenr"> 4927: </span>      key &amp;& removeIdentifiers(key)
<span class=
"linenr"> 4928: </span>      index &amp;& removeIdentifiers(index)
<span class="linenr"> 4929: </span>    }
<span class="linenr"> 4930: </span>    <span class=
"org-keyword">if</span> (onExit) onExit()
<span class="linenr"> 4931: </span>  }
<span class="linenr"> 4932: </span>}
<span class="linenr"> 4933: </span>
<span class="linenr"> 4934: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">forAliasRE</span> = <span class=
"org-string">/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/</span>
<span class="linenr"> 4935: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">This regex doesn't cover the case if key or index aliases have destructuring,</span>
<span class="linenr"> 4936: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">but those do not make sense in the first place, so this works in practice.</span>
<span class="linenr"> 4937: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">forIteratorRE</span> = <span class=
"org-string">/,([^,\}\]]*)(?:,([^,\}\]]*))?$/</span>
<span class="linenr"> 4938: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">stripParensRE</span> = <span class=
"org-string">/^\(|\)$/</span>g
<span class="linenr"> 4939: </span>
<span class="linenr"> 4940: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseForExpression</span>(
<span class="linenr"> 4941: </span>  <span class=
"org-variable-name">input</span>,
<span class="linenr"> 4942: </span>  context
<span class="linenr"> 4943: </span>) {
<span class="linenr"> 4944: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">loc</span> = input.loc
<span class="linenr"> 4945: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exp</span> = input.content
<span class="linenr"> 4946: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">inMatch</span> = exp.match(forAliasRE)
<span class="linenr"> 4947: </span>  <span class=
"org-keyword">if</span> (!inMatch) <span class=
"org-keyword">return</span>
<span class="linenr"> 4948: </span>
<span class="linenr"> 4949: </span>  <span class=
"org-keyword">const</span> [, <span class=
"org-variable-name">LHS</span>, <span class=
"org-variable-name">RHS</span>] = inMatch
<span class="linenr"> 4950: </span>
<span class="linenr"> 4951: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">result</span> = {
<span class=
"linenr"> 4952: </span>    source: createAliasExpression(
<span class="linenr"> 4953: </span>      loc,
<span class="linenr"> 4954: </span>      RHS.trim(),
<span class=
"linenr"> 4955: </span>      exp.indexOf(RHS, LHS.length)
<span class="linenr"> 4956: </span>    ),
<span class="linenr"> 4957: </span>    value: <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4958: </span>    key: <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4959: </span>    index: <span class=
"org-constant">undefined</span>
<span class="linenr"> 4960: </span>  }
<span class="linenr"> 4961: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 4962: </span>    result.source = processExpression(
<span class="linenr"> 4963: </span>      result.source,
<span class="linenr"> 4964: </span>      context
<span class="linenr"> 4965: </span>    )
<span class="linenr"> 4966: </span>  }
<span class="linenr"> 4967: </span>
<span class="linenr"> 4968: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">valueContent</span> = LHS.trim().replace(stripParensRE, <span class="org-string">''</span>).trim()
<span class="linenr"> 4969: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">trimmedOffset</span> = LHS.indexOf(valueContent)
<span class="linenr"> 4970: </span>
<span class="linenr"> 4971: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">iteratorMatch</span> = valueContent.match(forIteratorRE)
<span class="linenr"> 4972: </span>  <span class=
"org-keyword">if</span> (iteratorMatch) {
<span class=
"linenr"> 4973: </span>    valueContent = valueContent.replace(forIteratorRE, <span class="org-string">''</span>).trim()
<span class="linenr"> 4974: </span>
<span class="linenr"> 4975: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyContent</span> = iteratorMatch[<span class=
"org-highlight-numbers-number">1</span>].trim()
<span class="linenr"> 4976: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">keyOffset</span>
<span class="linenr"> 4977: </span>    <span class=
"org-keyword">if</span> (keyContent) {
<span class=
"linenr"> 4978: </span>      keyOffset = exp.indexOf(keyContent, trimmedOffset + valueContent.length)
<span class=
"linenr"> 4979: </span>      result.key = createAliasExpression(loc, keyContent, keyOffset)
<span class="linenr"> 4980: </span>      <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 4981: </span>        result.key = processExpression(result.key, context, <span class="org-constant">true</span>)
<span class="linenr"> 4982: </span>      }
<span class="linenr"> 4983: </span>    }
<span class="linenr"> 4984: </span>
<span class="linenr"> 4985: </span>    <span class=
"org-keyword">if</span> (iteratorMatch[<span class=
"org-highlight-numbers-number">2</span>]) {
<span class="linenr"> 4986: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">indexContent</span> = iteratorMatch[<span class="org-highlight-numbers-number">2</span>].trim()
<span class="linenr"> 4987: </span>
<span class="linenr"> 4988: </span>      <span class=
"org-keyword">if</span> (indexContent) {
<span class=
"linenr"> 4989: </span>        result.index = createAliasExpression(
<span class="linenr"> 4990: </span>          loc,
<span class="linenr"> 4991: </span>          indexContent,
<span class="linenr"> 4992: </span>          exp.indexOf(
<span class="linenr"> 4993: </span>            indexContent,
<span class="linenr"> 4994: </span>            result.key
<span class=
"linenr"> 4995: </span>              ? keyOffset + keyContent.length
<span class=
"linenr"> 4996: </span>              : trimmedOffset + valueContent.length
<span class="linenr"> 4997: </span>          )
<span class="linenr"> 4998: </span>        )
<span class="linenr"> 4999: </span>        <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 5000: </span>          result.index = processExpression(result.index, context, <span class="org-constant">true</span>)
<span class="linenr"> 5001: </span>        }
<span class="linenr"> 5002: </span>      }
<span class="linenr"> 5003: </span>    }
<span class="linenr"> 5004: </span>  }
<span class="linenr"> 5005: </span>
<span class="linenr"> 5006: </span>  <span class=
"org-keyword">if</span> (valueContent) {
<span class=
"linenr"> 5007: </span>    result.value = createAliasExpression(loc, valueContent, trimmedOffset)
<span class="linenr"> 5008: </span>    <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 5009: </span>      result.value = processExpression(result.value, context, <span class="org-constant">true</span>)
<span class="linenr"> 5010: </span>    }
<span class="linenr"> 5011: </span>  }
<span class="linenr"> 5012: </span>
<span class="linenr"> 5013: </span>  <span class=
"org-keyword">return</span> result
<span class="linenr"> 5014: </span>}
<span class="linenr"> 5015: </span>
<span class="linenr"> 5016: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createAliasExpression</span>(
<span class="linenr"> 5017: </span>  <span class=
"org-variable-name">range</span>,
<span class="linenr"> 5018: </span>  <span class=
"org-variable-name">content</span>,
<span class="linenr"> 5019: </span>  offset
<span class="linenr"> 5020: </span>) {
<span class="linenr"> 5021: </span>  <span class=
"org-keyword">return</span> createSimpleExpression(
<span class="linenr"> 5022: </span>    content,
<span class="linenr"> 5023: </span>    <span class=
"org-constant">false</span>,
<span class=
"linenr"> 5024: </span>    getInnerRange(range, offset, content.length)
<span class="linenr"> 5025: </span>  )
<span class="linenr"> 5026: </span>}
<span class="linenr"> 5027: </span>
<span class="linenr"> 5028: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createForLoopParams</span>(
<span class="linenr"> 5029: </span>  { value, key, index },
<span class="linenr"> 5030: </span>  memoArgs = []
<span class="linenr"> 5031: </span>) {
<span class="linenr"> 5032: </span>  <span class=
"org-keyword">return</span> createParamsList([value, key, index, ...memoArgs])
<span class="linenr"> 5033: </span>}
<span class="linenr"> 5034: </span>
<span class="linenr"> 5035: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createParamsList</span>(<span class=
"org-variable-name">args</span>) {
<span class="linenr"> 5036: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = args.length
<span class="linenr"> 5037: </span>  <span class=
"org-keyword">while</span> (i--) {
<span class="linenr"> 5038: </span>    <span class=
"org-keyword">if</span> (args[i]) <span class=
"org-keyword">break</span>
<span class="linenr"> 5039: </span>  }
<span class="linenr"> 5040: </span>  <span class=
"org-keyword">return</span> args
<span class="linenr"> 5041: </span>    .slice(<span class=
"org-highlight-numbers-number">0</span>, i + <span class=
"org-highlight-numbers-number">1</span>)
<span class=
"linenr"> 5042: </span>    .map((arg, i) =&gt; arg || createSimpleExpression(<span class="org-string">`_`</span>.repeat(i + <span class="org-highlight-numbers-number">1</span>), <span class="org-constant">false</span>))
<span class="linenr"> 5043: </span>}
<span class="linenr"> 5044: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">processIf</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">dir</span>, <span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">processCodegen</span>) {
<span class="linenr"> 5045: </span>  logg(<span class=
"org-string">'processIf - node - dir'</span>, node, dir)
<span class="linenr"> 5046: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 5047: </span>    dir.name !== <span class=
"org-string">'else'</span> &amp;&
<span class=
"linenr"> 5048: </span>    (!dir.exp || !dir.exp.content.trim())
<span class="linenr"> 5049: </span>  ) {
<span class="linenr"> 5050: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">loc</span> = dir.exp ? dir.exp.loc : node.loc
<span class="linenr"> 5051: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;div v-if&gt;&lt;/div&gt; 没有指令值的情况，默认值为 true</span>
<span class=
"linenr"> 5052: </span>    dir.exp = createSimpleExpression(<span class="org-string">`true`</span>, <span class="org-constant">false</span>, loc)
<span class="linenr"> 5053: </span>  }
<span class="linenr"> 5054: </span>
<span class="linenr"> 5055: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers &amp;& dir.exp) {
<span class="linenr"> 5056: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">dir.exp can only be simple expression because vIf transform is applied</span>
<span class="linenr"> 5057: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">before expression transform.</span>
<span class=
"linenr"> 5058: </span>    dir.exp = processExpression(dir.exp, context)
<span class="linenr"> 5059: </span>  }
<span class="linenr"> 5060: </span>
<span class="linenr"> 5061: </span>  <span class=
"org-keyword">if</span> (dir.name === <span class=
"org-string">'if'</span>) { <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-if</span>
<span class="linenr"> 5062: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">branch</span> = createIfBranch(node, dir)
<span class="linenr"> 5063: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ifNode</span> = {
<span class="linenr"> 5064: </span>      type: NodeTypes.IF,
<span class="linenr"> 5065: </span>      loc: node.loc,
<span class="linenr"> 5066: </span>      branches: [branch]
<span class="linenr"> 5067: </span>    }
<span class="linenr"> 5068: </span>    context.replaceNode(ifNode)
<span class="linenr"> 5069: </span>    <span class=
"org-keyword">if</span> (processCodegen) {
<span class="linenr"> 5070: </span>      <span class=
"org-keyword">return</span> processCodegen(ifNode, branch, <span class="org-constant">true</span>)
<span class="linenr"> 5071: </span>    }
<span class="linenr"> 5072: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5073: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">locate the adjacent v-if</span>
<span class="linenr"> 5074: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">siblings</span> = context.parent.children
<span class="linenr"> 5075: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">comments</span> = []
<span class="linenr"> 5076: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = siblings.indexOf(node)
<span class="linenr"> 5077: </span>    <span class=
"org-keyword">while</span> (i-- &gt;= -<span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 5078: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">sibling</span> = siblings[i]
<span class="linenr"> 5079: </span>
<span class="linenr"> 5080: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">空行，空文本</span>
<span class="linenr"> 5081: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 5082: </span>        sibling &amp;&
<span class=
"linenr"> 5083: </span>        sibling.type === NodeTypes.TEXT &amp;&
<span class=
"linenr"> 5084: </span>        !sibling.content.trim().length
<span class="linenr"> 5085: </span>      ) {
<span class=
"linenr"> 5086: </span>        context.removeNode(sibling)
<span class="linenr"> 5087: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 5088: </span>      }
<span class="linenr"> 5089: </span>
<span class="linenr"> 5090: </span>      <span class=
"org-keyword">if</span> (sibling &amp;& sibling.type === NodeTypes.IF) {
<span class="linenr"> 5091: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">这里会将原本的结点删除，而是用新组装的 if 结构(包含else-if, else 分支的结构，node.branches[...])</span>
<span class="linenr"> 5092: </span>        context.removeNode()
<span class="linenr"> 5093: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">branch</span> = createIfBranch(node, dir)
<span class=
"linenr"> 5094: </span>        sibling.branches.push(branch)
<span class="linenr"> 5095: </span>
<span class="linenr"> 5096: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">onExit</span> = processCodegen &amp;& processCodegen(sibling, branch, <span class="org-constant">false</span>)
<span class="linenr"> 5097: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">这里需要手动触发一次遍历，因为上面将原本的分支节点从原来的节点树中删除了</span>
<span class=
"linenr"> 5098: </span>        traverseNode(branch, context)
<span class="linenr"> 5099: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">回溯结束后执行收集到的 transformXxx 函数</span>
<span class="linenr"> 5100: </span>        <span class=
"org-keyword">if</span> (onExit) onExit()
<span class="linenr"> 5101: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">make sure to reset currentNode after traversal to indicate this</span>
<span class="linenr"> 5102: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">node has been removed.</span>
<span class=
"linenr"> 5103: </span>        context.currentNode = <span class=
"org-constant">null</span>
<span class="linenr"> 5104: </span>      }
<span class="linenr"> 5105: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 5106: </span>    }
<span class="linenr"> 5107: </span>  }
<span class="linenr"> 5108: </span>}
<span class="linenr"> 5109: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createIfBranch</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">dir</span>) {
<span class="linenr"> 5110: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 5111: </span>    type: NodeTypes.IF_BRANCH,
<span class="linenr"> 5112: </span>    loc: node.loc,
<span class=
"linenr"> 5113: </span>    condition: dir.name === <span class=
"org-string">'else'</span> ? <span class=
"org-constant">undefined</span> : dir.exp,
<span class="linenr"> 5114: </span>    children:
<span class=
"linenr"> 5115: </span>      node.tagType === ElementTypes.TEMPLATE &amp;& !findDir(node, <span class="org-string">'for'</span>)
<span class="linenr"> 5116: </span>        ? node.children
<span class="linenr"> 5117: </span>        : [node],
<span class=
"linenr"> 5118: </span>    userKey: findProp(node, <span class=
"org-string">`key`</span>)
<span class="linenr"> 5119: </span>  }
<span class="linenr"> 5120: </span>}
<span class="linenr"> 5121: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createCodegenNodeForBranch</span>(<span class=
"org-variable-name">branch</span>, <span class=
"org-variable-name">keyIndex</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 5122: </span>  <span class=
"org-keyword">if</span> (branch.condition) {
<span class="linenr"> 5123: </span>    <span class=
"org-keyword">return</span> createConditionalExpression(
<span class="linenr"> 5124: </span>      branch.condition,
<span class=
"linenr"> 5125: </span>      createChildrenCodegenNode(branch, keyIndex, context),
<span class="linenr"> 5126: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">这里是考虑到只有 v-if 的情况，因为 v-if 指令最后都会被解析成三目运算符形式</span>
<span class="linenr"> 5127: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">如： &lt;div v-if="foo"/&gt;&lt;div v-else/&gt; =&gt; foo ? ... : ...</span>
<span class="linenr"> 5128: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">如： &lt;div v-if="foo"/&gt;&lt;div v-else-if="bar"/&gt;&lt;div v-else/&gt; =&gt; foo ? ... : bar ? ... : ...</span>
<span class="linenr"> 5129: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">所以必需得要有一个 v-else，如果没有的话就相当于是 `foo ? ...` 这样的语句是不合法的</span>
<span class="linenr"> 5130: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">因此这里在判断没有 v-else 分支的情况时默认给它创建了个注释节点</span>
<span class=
"linenr"> 5131: </span>      createCallExpression(context.helper(CREATE_COMMENT), [
<span class="linenr"> 5132: </span>        __DEV__ ? <span class=
"org-string">'"v-if"'</span> : <span class=
"org-string">'""'</span>,
<span class="linenr"> 5133: </span>        <span class=
"org-string">'true'</span>
<span class="linenr"> 5134: </span>      ])
<span class="linenr"> 5135: </span>    )
<span class="linenr"> 5136: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5137: </span>    <span class=
"org-keyword">return</span> createChildrenCodegenNode(branch, keyIndex, context)
<span class="linenr"> 5138: </span>  }
<span class="linenr"> 5139: </span>}
<span class="linenr"> 5140: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createChildrenCodegenNode</span>(<span class=
"org-variable-name">branch</span>, <span class=
"org-variable-name">keyIndex</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 5141: </span>  <span class=
"org-keyword">const</span> { helper } = context
<span class="linenr"> 5142: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyProperty</span> = createObjectProperty(
<span class="linenr"> 5143: </span>    <span class=
"org-string">`key`</span>,
<span class="linenr"> 5144: </span>    createSimpleExpression(
<span class="linenr"> 5145: </span>      <span class=
"org-string">`${keyIndex}`</span>,
<span class="linenr"> 5146: </span>      <span class=
"org-constant">false</span>,
<span class="linenr"> 5147: </span>      locStub,
<span class="linenr"> 5148: </span>      ConstantTypes.CAN_HOIST
<span class="linenr"> 5149: </span>    )
<span class="linenr"> 5150: </span>  )
<span class="linenr"> 5151: </span>  <span class=
"org-keyword">const</span> { children } = branch
<span class="linenr"> 5152: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">firstChild</span> = children[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 5153: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">needFragmentWrapper</span> =
<span class=
"linenr"> 5154: </span>    children.length !== <span class=
"org-highlight-numbers-number">1</span> || firstChild.type !== NodeTypes.ELEMENT
<span class="linenr"> 5155: </span>  <span class=
"org-keyword">if</span> (needFragmentWrapper) {
<span class="linenr"> 5156: </span>    <span class=
"org-keyword">if</span> (children.length === <span class=
"org-highlight-numbers-number">1</span> &amp;& firstChild.type === NodeTypes.FOR) {
<span class="linenr"> 5157: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">optimize away nested fragments when child is a ForNode</span>
<span class="linenr"> 5158: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">vnodeCall</span> = firstChild.codegenNode
<span class=
"linenr"> 5159: </span>      injectProp(vnodeCall, keyProperty, context)
<span class="linenr"> 5160: </span>      <span class=
"org-keyword">return</span> vnodeCall
<span class="linenr"> 5161: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5162: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">patchFlag</span> = PatchFlags.STABLE_FRAGMENT
<span class="linenr"> 5163: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">patchFlagText</span> = PatchFlagNames[PatchFlags.STABLE_FRAGMENT]
<span class="linenr"> 5164: </span>
<span class="linenr"> 5165: </span>      <span class=
"org-keyword">return</span> createVNodeCall(
<span class="linenr"> 5166: </span>        context,
<span class="linenr"> 5167: </span>        helper(FRAGMENT),
<span class=
"linenr"> 5168: </span>        createObjectExpression([keyProperty]),
<span class="linenr"> 5169: </span>        children,
<span class=
"linenr"> 5170: </span>        patchFlag + (__DEV__ ? <span class=
"org-string">` /* ${patchFlagText} */`</span> : <span class=
"org-string">``</span>),
<span class="linenr"> 5171: </span>        <span class=
"org-constant">undefined</span>,
<span class="linenr"> 5172: </span>        <span class=
"org-constant">undefined</span>,
<span class="linenr"> 5173: </span>        <span class=
"org-constant">true</span>,
<span class="linenr"> 5174: </span>        <span class=
"org-constant">false</span>,
<span class="linenr"> 5175: </span>        <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">isComponent</span><span class=
"org-comment-delimiter"> */</span>,
<span class="linenr"> 5176: </span>        branch.loc
<span class="linenr"> 5177: </span>      )
<span class="linenr"> 5178: </span>    }
<span class="linenr"> 5179: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5180: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ret</span> = firstChild.codegenNode
<span class="linenr"> 5181: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">vnodeCall</span> = getMemoedVNodeCall(ret)
<span class="linenr"> 5182: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Change createVNode to createBlock.</span>
<span class="linenr"> 5183: </span>    <span class=
"org-keyword">if</span> (vnodeCall.type === NodeTypes.VNODE_CALL) {
<span class=
"linenr"> 5184: </span>      makeBlock(vnodeCall, context)
<span class="linenr"> 5185: </span>    }
<span class="linenr"> 5186: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject branch key</span>
<span class=
"linenr"> 5187: </span>    injectProp(vnodeCall, keyProperty, context)
<span class="linenr"> 5188: </span>    <span class=
"org-keyword">return</span> ret
<span class="linenr"> 5189: </span>  }
<span class="linenr"> 5190: </span>}
<span class="linenr"> 5191: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isSameKey</span>(<span class=
"org-variable-name">a</span>, <span class=
"org-variable-name">b</span>) {
<span class="linenr"> 5192: </span>  <span class=
"org-keyword">if</span> (!a || a.type !== b.type) {
<span class="linenr"> 5193: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 5194: </span>  }
<span class="linenr"> 5195: </span>  <span class=
"org-keyword">if</span> (a.type === NodeTypes.ATTRIBUTE) {
<span class="linenr"> 5196: </span>    <span class=
"org-keyword">if</span> (a.value.content !== b.value.content) {
<span class="linenr"> 5197: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 5198: </span>    }
<span class="linenr"> 5199: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5200: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">directive</span>
<span class="linenr"> 5201: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exp</span> = a.exp
<span class="linenr"> 5202: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">branchExp</span> = b.exp
<span class="linenr"> 5203: </span>    <span class=
"org-keyword">if</span> (exp.type !== branchExp.type) {
<span class="linenr"> 5204: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 5205: </span>    }
<span class="linenr"> 5206: </span>    <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 5207: </span>      exp.type !== NodeTypes.SIMPLE_EXPRESSION ||
<span class=
"linenr"> 5208: </span>      exp.isStatic !== branchExp.isStatic ||
<span class=
"linenr"> 5209: </span>      exp.content !== branchExp.content
<span class="linenr"> 5210: </span>    ) {
<span class="linenr"> 5211: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 5212: </span>    }
<span class="linenr"> 5213: </span>  }
<span class="linenr"> 5214: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 5215: </span>}
<span class="linenr"> 5216: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getParentCondition</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr"> 5217: </span>  <span class=
"org-keyword">while</span> (<span class=
"org-constant">true</span>) {
<span class="linenr"> 5218: </span>    <span class=
"org-keyword">if</span> (node.type === NodeTypes.JS_CONDITIONAL_EXPRESSION) {
<span class="linenr"> 5219: </span>      <span class=
"org-keyword">if</span> (node.alternate.type === NodeTypes.JS_CONDITIONAL_EXPRESSION) {
<span class="linenr"> 5220: </span>        node = node.alternate
<span class="linenr"> 5221: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5222: </span>        <span class=
"org-keyword">return</span> node
<span class="linenr"> 5223: </span>      }
<span class="linenr"> 5224: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === NodeTypes.JS_CACHE_EXPRESSION) {
<span class="linenr"> 5225: </span>      node = node.value
<span class="linenr"> 5226: </span>    }
<span class="linenr"> 5227: </span>  }
<span class="linenr"> 5228: </span>}
<span class="linenr"> 5229: </span>
<span class="linenr"> 5230: </span>
<span class="linenr"> 5231: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformIf</span> = createStructuralDirectiveTransform(
<span class="linenr"> 5232: </span>  <span class=
"org-string">/^(if|else|else-if)$/</span>,
<span class="linenr"> 5233: </span>  (node, dir, context) =&gt; {
<span class="linenr"> 5234: </span>    <span class=
"org-keyword">return</span> processIf(node, dir, context, (ifNode, branch, isRoot) =&gt; {
<span class="linenr"> 5235: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">siblings</span> = context.parent.children
<span class="linenr"> 5236: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if...else if...else 都处于同级渲染</span>
<span class="linenr"> 5237: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = siblings.indexOf(ifNode)
<span class="linenr"> 5238: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">key</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 5239: </span>      <span class=
"org-keyword">while</span> (i-- &gt;= <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 5240: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">sibling</span> = siblings[i]
<span class="linenr"> 5241: </span>        <span class=
"org-keyword">if</span> (sibling &amp;& sibling.type === NodeTypes.IF) {
<span class=
"linenr"> 5242: </span>          key += sibling.branches.length
<span class="linenr"> 5243: </span>        }
<span class="linenr"> 5244: </span>      }
<span class="linenr"> 5245: </span>
<span class="linenr"> 5246: </span>      logg(<span class=
"org-string">'transformIf'</span>, ifNode, { isRoot, branch })
<span class="linenr"> 5247: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">退出时的回调，当所有 children 被遍历转换完成时被调用生成 codegenNode</span>
<span class="linenr"> 5248: </span>      <span class=
"org-keyword">return</span> () =&gt; {
<span class="linenr"> 5249: </span>        <span class=
"org-keyword">if</span> (isRoot) { <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-if</span>
<span class=
"linenr"> 5250: </span>          ifNode.codegenNode = createCodegenNodeForBranch(
<span class="linenr"> 5251: </span>            branch, key, context
<span class="linenr"> 5252: </span>          )
<span class="linenr"> 5253: </span>          logg(<span class=
"org-string">'transformIf - isRoot - v-if'</span>, ifNode)
<span class="linenr"> 5254: </span>        } <span class=
"org-keyword">else</span> { <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-else, v-else-if</span>
<span class="linenr"> 5255: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">将 v-else-* 分枝挂到 v-if 节点下面</span>
<span class="linenr"> 5256: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parentCondition</span> = getParentCondition(ifNode.codegenNode)
<span class=
"linenr"> 5257: </span>          parentCondition.alternate = createCodegenNodeForBranch(
<span class=
"linenr"> 5258: </span>            branch, key + ifNode.branches.length - <span class="org-highlight-numbers-number">1</span>,
<span class="linenr"> 5259: </span>            context
<span class="linenr"> 5260: </span>          )
<span class="linenr"> 5261: </span>          logg(<span class=
"org-string">'transformIf - v-else-*'</span>, ifNode)
<span class="linenr"> 5262: </span>        }
<span class="linenr"> 5263: </span>      }
<span class="linenr"> 5264: </span>
<span class="linenr"> 5265: </span>    })
<span class="linenr"> 5266: </span>  }
<span class="linenr"> 5267: </span>)
<span class="linenr"> 5268: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">memoSeen</span> = <span class=
"org-keyword">new</span> <span class="org-type">WeakSet</span>()
<span class="linenr"> 5269: </span>
<span class="linenr"> 5270: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformMemo</span> = (node, context) =&gt; {
<span class="linenr"> 5271: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.ELEMENT) {
<span class="linenr"> 5272: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">dir</span> = findDir(node, <span class=
"org-string">'memo'</span>)
<span class="linenr"> 5273: </span>    <span class=
"org-keyword">if</span> (!dir || memoSeen.has(node)) {
<span class="linenr"> 5274: </span>      <span class=
"org-keyword">return</span>
<span class="linenr"> 5275: </span>    }
<span class="linenr"> 5276: </span>    memoSeen.add(node)
<span class="linenr"> 5277: </span>    <span class=
"org-keyword">return</span> () =&gt; {
<span class="linenr"> 5278: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">codegenNode</span> = node.codegenNode || context.currentNode.codegenNode
<span class="linenr"> 5279: </span>      <span class=
"org-keyword">if</span> (codegenNode &amp;& codegenNode.type === NodeTypes.VNODE_CALL) {
<span class="linenr"> 5280: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">non-component sub tree should be turned into a block</span>
<span class="linenr"> 5281: </span>        <span class=
"org-keyword">if</span> (node.tagType !== ElementTypes.COMPONENT) {
<span class=
"linenr"> 5282: </span>          makeBlock(codegenNode, context)
<span class="linenr"> 5283: </span>        }
<span class=
"linenr"> 5284: </span>        node.codegenNode = createCallExpression(context.helper(WITH_MEMO), [
<span class="linenr"> 5285: </span>          dir.exp,
<span class=
"linenr"> 5286: </span>          createFunctionExpression(<span class="org-constant">undefined</span>, codegenNode),
<span class="linenr"> 5287: </span>          <span class=
"org-string">`_cache`</span>,
<span class=
"linenr"> 5288: </span>          String(context.cached++)
<span class="linenr"> 5289: </span>        ])
<span class="linenr"> 5290: </span>      }
<span class="linenr"> 5291: </span>    }
<span class="linenr"> 5292: </span>  }
<span class="linenr"> 5293: </span>}
<span class="linenr"> 5294: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformModel</span> = (dir, node, context) =&gt; {
<span class="linenr"> 5295: </span>  <span class=
"org-keyword">const</span> { exp, arg } = dir
<span class="linenr"> 5296: </span>  <span class=
"org-keyword">if</span> (!exp) {
<span class="linenr"> 5297: </span>    logg(<span class=
"org-string">`transformModel no exp`</span>)
<span class="linenr"> 5298: </span>    <span class=
"org-keyword">return</span> createTransformProps()
<span class="linenr"> 5299: </span>  }
<span class="linenr"> 5300: </span>
<span class="linenr"> 5301: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rawExp</span> = exp.loc.source
<span class="linenr"> 5302: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">expString</span> =
<span class=
"linenr"> 5303: </span>    exp.type === NodeTypes.SIMPLE_EXPRESSION ? exp.content : rawExp
<span class="linenr"> 5304: </span>
<span class="linenr"> 5305: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">im SFC &lt;script setup&gt; inline mode, the exp may have been transformed into</span>
<span class="linenr"> 5306: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">_unref(exp)</span>
<span class="linenr"> 5307: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bindingType</span> = context.bindingMetadata[rawExp]
<span class="linenr"> 5308: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">maybeRef</span> =
<span class="linenr"> 5309: </span>    !__BROWSER__ &amp;&
<span class="linenr"> 5310: </span>    context.inline &amp;&
<span class="linenr"> 5311: </span>    bindingType &amp;&
<span class=
"linenr"> 5312: </span>    bindingType !== BindingTypes.SETUP_CONST
<span class="linenr"> 5313: </span>
<span class="linenr"> 5314: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 5315: </span>    !expString.trim() ||
<span class=
"linenr"> 5316: </span>    (!isMemberExpression(expString, context) &amp;& !maybeRef)
<span class="linenr"> 5317: </span>  ) {
<span class="linenr"> 5318: </span>    <span class=
"org-keyword">return</span> createTransformProps()
<span class="linenr"> 5319: </span>  }
<span class="linenr"> 5320: </span>
<span class="linenr"> 5321: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 5322: </span>    !__BROWSER__ &amp;&
<span class=
"linenr"> 5323: </span>    context.prefixIdentifiers &amp;&
<span class=
"linenr"> 5324: </span>    isSimpleIdentifier(expString) &amp;&
<span class=
"linenr"> 5325: </span>    context.identifiers[expString]
<span class="linenr"> 5326: </span>  ) {
<span class="linenr"> 5327: </span>    <span class=
"org-keyword">return</span> createTransformProps()
<span class="linenr"> 5328: </span>  }
<span class="linenr"> 5329: </span>
<span class="linenr"> 5330: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">propName</span> = arg ? arg : createSimpleExpression(<span class="org-string">'modelValue'</span>, <span class="org-constant">true</span>)
<span class="linenr"> 5331: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">eventName</span> = arg
<span class="linenr"> 5332: </span>    ? isStaticExp(arg)
<span class="linenr"> 5333: </span>      ? <span class=
"org-string">`onUpdate:${arg.content}`</span>
<span class=
"linenr"> 5334: </span>      : createCompoundExpression([<span class="org-string">'"onUpdate:" + '</span>, arg])
<span class="linenr"> 5335: </span>    : <span class=
"org-string">`onUpdate:modelValue`</span>
<span class="linenr"> 5336: </span>
<span class="linenr"> 5337: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">assignmentExp</span>
<span class="linenr"> 5338: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">eventArg</span> = context.isTS ? <span class=
"org-string">`($event: any)`</span> : <span class=
"org-string">`$event`</span>
<span class="linenr"> 5339: </span>  <span class=
"org-keyword">if</span> (maybeRef) {
<span class="linenr"> 5340: </span>    <span class=
"org-keyword">if</span> (bindingType === BindingTypes.SETUP_REF) {
<span class="linenr"> 5341: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-model used on known ref.</span>
<span class=
"linenr"> 5342: </span>      assignmentExp = createCompoundExpression([
<span class="linenr"> 5343: </span>        <span class=
"org-string">`${eventArg} =&gt; ((`</span>,
<span class=
"linenr"> 5344: </span>        createSimpleExpression(rawExp, <span class="org-constant">false</span>, exp.loc),
<span class="linenr"> 5345: </span>        <span class=
"org-string">`).value = $event)`</span>
<span class="linenr"> 5346: </span>      ])
<span class="linenr"> 5347: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5348: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-model used on a potentially ref binding in &lt;script setup&gt; inline mode.</span>
<span class="linenr"> 5349: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the assignment needs to check whether the binding is actually a ref.</span>
<span class="linenr"> 5350: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">altAssignment</span> =
<span class=
"linenr"> 5351: </span>        bindingType === BindingTypes.SETUP_LET ? <span class="org-string">`${rawExp} = $event`</span> : <span class="org-string">`null`</span>
<span class=
"linenr"> 5352: </span>      assignmentExp = createCompoundExpression([
<span class="linenr"> 5353: </span>        <span class=
"org-string">`${eventArg} =&gt; (${context.helperString(IS_REF)}(${rawExp}) ? (`</span>,
<span class=
"linenr"> 5354: </span>        createSimpleExpression(rawExp, <span class="org-constant">false</span>, exp.loc),
<span class="linenr"> 5355: </span>        <span class=
"org-string">`).value = $event : ${altAssignment})`</span>
<span class="linenr"> 5356: </span>      ])
<span class="linenr"> 5357: </span>    }
<span class="linenr"> 5358: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 5359: </span>    assignmentExp = createCompoundExpression([
<span class="linenr"> 5360: </span>      <span class=
"org-string">`${eventArg} =&gt; ((`</span>,
<span class="linenr"> 5361: </span>      exp,
<span class="linenr"> 5362: </span>      <span class=
"org-string">`) = $event)`</span>
<span class="linenr"> 5363: </span>    ])
<span class="linenr"> 5364: </span>  }
<span class="linenr"> 5365: </span>
<span class="linenr"> 5366: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">props</span> = [
<span class="linenr"> 5367: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">modelValue: foo</span>
<span class=
"linenr"> 5368: </span>    createObjectProperty(propName, dir.exp),
<span class="linenr"> 5369: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">"onUpdate:modelValue": $event =&gt; (foo = $event)</span>
<span class=
"linenr"> 5370: </span>    createObjectProperty(eventName, assignmentExp)
<span class="linenr"> 5371: </span>  ]
<span class="linenr"> 5372: </span>
<span class="linenr"> 5373: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">cache v-model handler if applicable (when it doesn't refer any scope vars)</span>
<span class="linenr"> 5374: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 5375: </span>    !__BROWSER__ &amp;&
<span class=
"linenr"> 5376: </span>    context.prefixIdentifiers &amp;&
<span class="linenr"> 5377: </span>    !context.inVOnce &amp;&
<span class="linenr"> 5378: </span>    context.cacheHandlers &amp;&
<span class=
"linenr"> 5379: </span>    !hasScopeRef(exp, context.identifiers)
<span class="linenr"> 5380: </span>  ) {
<span class="linenr"> 5381: </span>    props[<span class=
"org-highlight-numbers-number">1</span>].value = context.cache(props[<span class="org-highlight-numbers-number">1</span>].value)
<span class="linenr"> 5382: </span>  }
<span class="linenr"> 5383: </span>
<span class="linenr"> 5384: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">modelModifiers: { foo: true, "bar-baz": true }</span>
<span class="linenr"> 5385: </span>  <span class=
"org-keyword">if</span> (dir.modifiers.length &amp;& node.tagType === ElementTypes.COMPONENT) {
<span class="linenr"> 5386: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">modifiers</span> = dir.modifiers
<span class=
"linenr"> 5387: </span>      .map(m =&gt; (isSimpleIdentifier(m) ? m : JSON.stringify(m)) + <span class="org-string">`: true`</span>)
<span class="linenr"> 5388: </span>      .join(<span class=
"org-string">`, `</span>)
<span class="linenr"> 5389: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">modifiersKey</span> = arg
<span class="linenr"> 5390: </span>      ? isStaticExp(arg)
<span class="linenr"> 5391: </span>        ? <span class=
"org-string">`${arg.content}Modifiers`</span>
<span class=
"linenr"> 5392: </span>        : createCompoundExpression([arg, <span class="org-string">' + "Modifiers"'</span>])
<span class="linenr"> 5393: </span>      : <span class=
"org-string">`modelModifiers`</span>
<span class="linenr"> 5394: </span>    props.push(
<span class="linenr"> 5395: </span>      createObjectProperty(
<span class="linenr"> 5396: </span>        modifiersKey,
<span class="linenr"> 5397: </span>        createSimpleExpression(
<span class="linenr"> 5398: </span>          <span class=
"org-string">`{ ${modifiers} }`</span>,
<span class="linenr"> 5399: </span>          <span class=
"org-constant">false</span>,
<span class="linenr"> 5400: </span>          dir.loc,
<span class=
"linenr"> 5401: </span>          ConstantTypes.CAN_HOIST
<span class="linenr"> 5402: </span>        )
<span class="linenr"> 5403: </span>      )
<span class="linenr"> 5404: </span>    )
<span class="linenr"> 5405: </span>  }
<span class="linenr"> 5406: </span>
<span class="linenr"> 5407: </span>  <span class=
"org-keyword">return</span> createTransformProps(props)
<span class="linenr"> 5408: </span>}
<span class="linenr"> 5409: </span>
<span class="linenr"> 5410: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createTransformProps</span>(<span class=
"org-variable-name">props</span> = []) {
<span class="linenr"> 5411: </span>  <span class=
"org-keyword">return</span> { props }
<span class="linenr"> 5412: </span>}
<span class="linenr"> 5413: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">函数表达式正则, @click="fnExp"</span>
<span class="linenr"> 5414: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">fnExpRE</span> =
<span class="linenr"> 5415: </span>  <span class=
"org-string">/^\s*([\w$_]+|(async\s*)?\([^)]*?\))\s*=&gt;|^\s*(async\s+)?function(?:\s+[\w$]+)?\s*\(/</span>
<span class="linenr"> 5416: </span>
<span class="linenr"> 5417: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformOn</span> = (
<span class="linenr"> 5418: </span>  dir,
<span class="linenr"> 5419: </span>  node,
<span class="linenr"> 5420: </span>  context,
<span class="linenr"> 5421: </span>  augmentor
<span class="linenr"> 5422: </span>) =&gt; {
<span class="linenr"> 5423: </span>  <span class=
"org-keyword">const</span> { loc, modifiers, arg } = dir
<span class="linenr"> 5424: </span>
<span class="linenr"> 5425: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">eventName</span>
<span class="linenr"> 5426: </span>  <span class=
"org-keyword">if</span> (arg.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 5427: </span>    <span class=
"org-keyword">if</span> (arg.isStatic) {
<span class="linenr"> 5428: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">rawName</span> = arg.content
<span class="linenr"> 5429: </span>
<span class="linenr"> 5430: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">将事件名转成驼峰式</span>
<span class=
"linenr"> 5431: </span>      eventName = createSimpleExpression(
<span class=
"linenr"> 5432: </span>        toHandlerKey(camelize(rawName)),
<span class="linenr"> 5433: </span>        <span class=
"org-constant">true</span>,
<span class="linenr"> 5434: </span>        arg.loc
<span class="linenr"> 5435: </span>      )
<span class="linenr"> 5436: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5437: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#2388 toHandlerKey 将事件名转成 onXxx, 如：eventName -&gt; onEventName</span>
<span class=
"linenr"> 5438: </span>      eventName = createCompoundExpression([
<span class="linenr"> 5439: </span>        <span class=
"org-string">`${context.helperString(TO_HANDLER_KEY)}(`</span>,
<span class="linenr"> 5440: </span>        arg,
<span class="linenr"> 5441: </span>        <span class=
"org-string">`)`</span>
<span class="linenr"> 5442: </span>      ])
<span class="linenr"> 5443: </span>    }
<span class="linenr"> 5444: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5445: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">already a compound expression.</span>
<span class="linenr"> 5446: </span>
<span class="linenr"> 5447: </span>    eventName = arg
<span class=
"linenr"> 5448: </span>    eventName.children.unshift(<span class=
"org-string">`${context.helperString(TO_HANDLER_KEY)}(`</span>)
<span class=
"linenr"> 5449: </span>    eventName.children.push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 5450: </span>  }
<span class="linenr"> 5451: </span>
<span class="linenr"> 5452: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">handler processing, 事件表达式内容</span>
<span class="linenr"> 5453: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">exp</span> = dir.exp
<span class="linenr"> 5454: </span>  <span class=
"org-keyword">if</span> (exp &amp;& !exp.content.trim()) {
<span class="linenr"> 5455: </span>    exp = <span class=
"org-constant">undefined</span>
<span class="linenr"> 5456: </span>  }
<span class="linenr"> 5457: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">事件处理函数缓存</span>
<span class="linenr"> 5458: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">shouldCache</span> = context.cacheHandlers &amp;& !exp &amp;& !context.inVOnce
<span class="linenr"> 5459: </span>  <span class=
"org-keyword">if</span> (exp) {
<span class="linenr"> 5460: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isMemberExp</span> = isMemberExpression(exp.content, context)
<span class="linenr"> 5461: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isInlineStatement</span> = !(isMemberExp || fnExpRE.test(exp.content))
<span class="linenr"> 5462: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hasMultipleStatements</span> = exp.content.includes(<span class="org-string">`;`</span>)
<span class="linenr"> 5463: </span>
<span class="linenr"> 5464: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">process the expression since it's been skipped</span>
<span class="linenr"> 5465: </span>    <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 5466: </span>      isInlineStatement &amp;& context.addIdentifiers(<span class="org-string">`$event`</span>)
<span class=
"linenr"> 5467: </span>      exp = dir.exp = processExpression(
<span class="linenr"> 5468: </span>        exp,
<span class="linenr"> 5469: </span>        context,
<span class="linenr"> 5470: </span>        <span class=
"org-constant">false</span>,
<span class="linenr"> 5471: </span>        hasMultipleStatements
<span class="linenr"> 5472: </span>      )
<span class=
"linenr"> 5473: </span>      isInlineStatement &amp;& context.removeIdentifiers(<span class="org-string">`$event`</span>)
<span class="linenr"> 5474: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">with scope analysis, the function is hoistable if it has no reference</span>
<span class="linenr"> 5475: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">to scope variables.</span>
<span class="linenr"> 5476: </span>      shouldCache =
<span class=
"linenr"> 5477: </span>        context.cacheHandlers &amp;&
<span class="linenr"> 5478: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">unnecessary to cache inside v-once</span>
<span class="linenr"> 5479: </span>        !context.inVOnce &amp;&
<span class="linenr"> 5480: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">runtime constants don't need to be cached</span>
<span class="linenr"> 5481: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">(this is analyzed by compileScript in SFC &lt;script setup&gt;)</span>
<span class=
"linenr"> 5482: </span>        !(exp.type === NodeTypes.SIMPLE_EXPRESSION &amp;& exp.constType &gt; <span class="org-highlight-numbers-number">0</span>) &amp;&
<span class="linenr"> 5483: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#1541 bail if this is a member exp handler passed to a component -</span>
<span class="linenr"> 5484: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we need to use the original function to preserve arity,</span>
<span class="linenr"> 5485: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">e.g. &lt;transition&gt; relies on checking cb.length to determine</span>
<span class="linenr"> 5486: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">transition end handling. Inline function is ok since its arity</span>
<span class="linenr"> 5487: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">is preserved even when cached.</span>
<span class=
"linenr"> 5488: </span>        !(isMemberExp &amp;& node.tagType === ElementTypes.COMPONENT) &amp;&
<span class="linenr"> 5489: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">bail if the function references closure variables (v-for, v-slot)</span>
<span class="linenr"> 5490: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">it must be passed fresh to avoid stale values.</span>
<span class=
"linenr"> 5491: </span>        !hasScopeRef(exp, context.identifiers)
<span class="linenr"> 5492: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">If the expression is optimizable and is a member expression pointing</span>
<span class="linenr"> 5493: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">to a function, turn it into invocation (and wrap in an arrow function</span>
<span class="linenr"> 5494: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">below) so that it always accesses the latest value when called - thus</span>
<span class="linenr"> 5495: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">avoiding the need to be patched.</span>
<span class="linenr"> 5496: </span>      <span class=
"org-keyword">if</span> (shouldCache &amp;& isMemberExp) {
<span class="linenr"> 5497: </span>        <span class=
"org-keyword">if</span> (exp.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class=
"linenr"> 5498: </span>          exp.content = <span class=
"org-string">`${exp.content} &amp;& ${exp.content}(...args)`</span>
<span class="linenr"> 5499: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 5500: </span>          exp.children = [...exp.children, <span class="org-string">` &amp;& `</span>, ...exp.children, <span class="org-string">`(...args)`</span>]
<span class="linenr"> 5501: </span>        }
<span class="linenr"> 5502: </span>      }
<span class="linenr"> 5503: </span>    }
<span class="linenr"> 5504: </span>
<span class="linenr"> 5505: </span>    <span class=
"org-keyword">if</span> (isInlineStatement || (shouldCache &amp;& isMemberExp)) {
<span class="linenr"> 5506: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">wrap inline statement in a function expression</span>
<span class="linenr"> 5507: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">($event) =&gt; statement</span>
<span class="linenr"> 5508: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">(...args) =&gt; { statement1;statement2 }</span>
<span class=
"linenr"> 5509: </span>      exp = createCompoundExpression([
<span class="linenr"> 5510: </span>        <span class=
"org-string">`${</span>
<span class="linenr"> 5511: </span><span class=
"org-string">          isInlineStatement</span>
<span class="linenr"> 5512: </span><span class=
"org-string">            ? `</span>$event<span class=
"org-string">`</span>
<span class="linenr"> 5513: </span><span class=
"org-string">            : `</span>(...args)<span class=
"org-string">`</span>
<span class="linenr"> 5514: </span><span class=
"org-string">        } =&gt; ${hasMultipleStatements ? `</span>{<span class="org-string">` : `</span>(<span class="org-string">`}`</span>,
<span class="linenr"> 5515: </span>        exp,
<span class=
"linenr"> 5516: </span>        hasMultipleStatements ? <span class=
"org-string">`}`</span> : <span class="org-string">`)`</span>
<span class="linenr"> 5517: </span>      ])
<span class="linenr"> 5518: </span>    }
<span class="linenr"> 5519: </span>  }
<span class="linenr"> 5520: </span>
<span class="linenr"> 5521: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">ret</span> = {
<span class="linenr"> 5522: </span>    props: [
<span class="linenr"> 5523: </span>      createObjectProperty(
<span class="linenr"> 5524: </span>        eventName,
<span class=
"linenr"> 5525: </span>        exp || createSimpleExpression(<span class="org-string">`() =&gt; {}`</span>, <span class="org-constant">false</span>, loc)
<span class="linenr"> 5526: </span>      )
<span class="linenr"> 5527: </span>    ]
<span class="linenr"> 5528: </span>  }
<span class="linenr"> 5529: </span>
<span class="linenr"> 5530: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">apply extended compiler augmentor</span>
<span class="linenr"> 5531: </span>  <span class=
"org-keyword">if</span> (augmentor) {
<span class="linenr"> 5532: </span>    ret = augmentor(ret)
<span class="linenr"> 5533: </span>  }
<span class="linenr"> 5534: </span>
<span class="linenr"> 5535: </span>  <span class=
"org-keyword">if</span> (shouldCache) {
<span class="linenr"> 5536: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">cache handlers so that it's always the same handler being passed down.</span>
<span class="linenr"> 5537: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">this avoids unnecessary re-renders when users use inline handlers on</span>
<span class="linenr"> 5538: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">components.</span>
<span class="linenr"> 5539: </span>    ret.props[<span class=
"org-highlight-numbers-number">0</span>].value = context.cache(ret.props[<span class="org-highlight-numbers-number">0</span>].value)
<span class="linenr"> 5540: </span>  }
<span class="linenr"> 5541: </span>
<span class="linenr"> 5542: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">mark the key as handler for props normalization check</span>
<span class=
"linenr"> 5543: </span>  ret.props.forEach(p =&gt; (p.key.isHandlerKey = <span class="org-constant">true</span>))
<span class="linenr"> 5544: </span>  <span class=
"org-keyword">return</span> ret
<span class="linenr"> 5545: </span>}
<span class="linenr"> 5546: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">seen</span> = <span class=
"org-keyword">new</span> <span class="org-type">WeakSet</span>()
<span class="linenr"> 5547: </span>
<span class="linenr"> 5548: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformOnce</span> = (node, context) =&gt; {
<span class="linenr"> 5549: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.ELEMENT &amp;& findDir(node, <span class="org-string">'once'</span>, <span class="org-constant">true</span>)) {
<span class="linenr"> 5550: </span>    <span class=
"org-keyword">if</span> (seen.has(node) || context.inVOnce) {
<span class="linenr"> 5551: </span>      logg(<span class=
"org-string">`transformOnce node has seen`</span>)
<span class="linenr"> 5552: </span>      <span class=
"org-keyword">return</span>
<span class="linenr"> 5553: </span>    }
<span class="linenr"> 5554: </span>    seen.add(node)
<span class=
"linenr"> 5555: </span>    context.inVOnce = <span class=
"org-constant">true</span>
<span class=
"linenr"> 5556: </span>    context.helper(SET_BLOCK_TRACKING)
<span class="linenr"> 5557: </span>    <span class=
"org-keyword">return</span> () =&gt; {
<span class=
"linenr"> 5558: </span>      context.inVOnce = <span class=
"org-constant">false</span>
<span class="linenr"> 5559: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">cur</span> = context.currentNode
<span class="linenr"> 5560: </span>      <span class=
"org-keyword">if</span> (cur.codegenNode) {
<span class=
"linenr"> 5561: </span>        cur.codegenNode = context.cache(cur.codegenNode, <span class="org-constant">true</span> <span class="org-comment-delimiter">/* </span><span class="org-comment">isVNode</span><span class="org-comment-delimiter"> */</span>)
<span class="linenr"> 5562: </span>      }
<span class="linenr"> 5563: </span>    }
<span class="linenr"> 5564: </span>  }
<span class="linenr"> 5565: </span>}
<span class="linenr"> 5566: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Important: since this function uses Node.js only dependencies, it should</span>
<span class="linenr"> 5567: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">always be used with a leading !__BROWSER__ check so that it can be</span>
<span class="linenr"> 5568: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">tree-shaken from the browser build.</span>
<span class="linenr"> 5569: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">processExpression</span>(
<span class="linenr"> 5570: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 5571: </span>  <span class=
"org-variable-name">context</span>,
<span class="linenr"> 5572: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">some expressions like v-slot props & v-for aliases should be parsed as</span>
<span class="linenr"> 5573: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">function params</span>
<span class="linenr"> 5574: </span>  asParams = <span class=
"org-constant">false</span>,
<span class="linenr"> 5575: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-on handler values may contain multiple statements</span>
<span class="linenr"> 5576: </span>  asRawStatements = <span class=
"org-constant">false</span>,
<span class=
"linenr"> 5577: </span>  localVars = Object.create(context.identifiers)
<span class="linenr"> 5578: </span>) {
<span class="linenr"> 5579: </span>  <span class=
"org-keyword">if</span> (__BROWSER__) {
<span class="linenr"> 5580: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 5581: </span>  }
<span class="linenr"> 5582: </span>
<span class="linenr"> 5583: </span>  <span class=
"org-keyword">if</span> (!context.prefixIdentifiers || !node.content.trim()) {
<span class="linenr"> 5584: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 5585: </span>  }
<span class="linenr"> 5586: </span>
<span class="linenr"> 5587: </span>  <span class=
"org-keyword">const</span> { inline, bindingMetadata } = context
<span class="linenr"> 5588: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rewriteIdentifier</span> = (raw, parent, id) =&gt; {
<span class="linenr"> 5589: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = hasOwn(bindingMetadata, raw) &amp;& bindingMetadata[raw]
<span class="linenr"> 5590: </span>    <span class=
"org-keyword">if</span> (inline) {
<span class="linenr"> 5591: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x = y</span>
<span class="linenr"> 5592: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isAssignmentLVal</span> =
<span class=
"linenr"> 5593: </span>        parent &amp;& parent.type === <span class="org-string">'AssignmentExpression'</span> &amp;& parent.left === id
<span class="linenr"> 5594: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x++</span>
<span class="linenr"> 5595: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isUpdateArg</span> =
<span class=
"linenr"> 5596: </span>        parent &amp;& parent.type === <span class="org-string">'UpdateExpression'</span> &amp;& parent.argument === id
<span class="linenr"> 5597: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">({ x } = y)</span>
<span class="linenr"> 5598: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDestructureAssignment</span> =
<span class=
"linenr"> 5599: </span>        parent &amp;& isInDestructureAssignment(parent, parentStack)
<span class="linenr"> 5600: </span>
<span class="linenr"> 5601: </span>      <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_CONST || localVars[raw]) {
<span class="linenr"> 5602: </span>        <span class=
"org-keyword">return</span> raw
<span class="linenr"> 5603: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_REF) {
<span class="linenr"> 5604: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`${raw}.value`</span>
<span class="linenr"> 5605: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_MAYBE_REF) {
<span class="linenr"> 5606: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">const binding that may or may not be ref</span>
<span class="linenr"> 5607: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if it's not a ref, then assignments don't make sense -</span>
<span class="linenr"> 5608: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">so we ignore the non-ref assignment case and generate code</span>
<span class="linenr"> 5609: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">that assumes the value to be a ref for more efficiency</span>
<span class="linenr"> 5610: </span>        <span class=
"org-keyword">return</span> isAssignmentLVal || isUpdateArg || isDestructureAssignment
<span class="linenr"> 5611: </span>          ? <span class=
"org-string">`${raw}.value`</span>
<span class="linenr"> 5612: </span>          : <span class=
"org-string">`${context.helperString(UNREF)}(${raw})`</span>
<span class="linenr"> 5613: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_LET) {
<span class="linenr"> 5614: </span>        <span class=
"org-keyword">if</span> (isAssignmentLVal) {
<span class="linenr"> 5615: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let binding.</span>
<span class="linenr"> 5616: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">this is a bit more tricky as we need to cover the case where</span>
<span class="linenr"> 5617: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let is a local non-ref value, and we need to replicate the</span>
<span class="linenr"> 5618: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">right hand side value.</span>
<span class="linenr"> 5619: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x = y --&gt; isRef(x) ? x.value = y : x = y</span>
<span class="linenr"> 5620: </span>          <span class=
"org-keyword">const</span> { right: rVal, operator } = parent
<span class="linenr"> 5621: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rExp</span> = rawExp.slice(rVal.start - <span class="org-highlight-numbers-number">1</span>, rVal.end - <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 5622: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rExpString</span> = stringifyExpression(
<span class="linenr"> 5623: </span>            processExpression(
<span class=
"linenr"> 5624: </span>              createSimpleExpression(rExp, <span class="org-constant">false</span>),
<span class="linenr"> 5625: </span>              context,
<span class="linenr"> 5626: </span>              <span class=
"org-constant">false</span>,
<span class="linenr"> 5627: </span>              <span class=
"org-constant">false</span>,
<span class="linenr"> 5628: </span>              knownIds
<span class="linenr"> 5629: </span>            )
<span class="linenr"> 5630: </span>          )
<span class="linenr"> 5631: </span>          <span class=
"org-keyword">return</span> <span class=
"org-string">`${context.helperString(IS_REF)}(${raw})${``} ? ${raw}.value ${operator} ${rExpString} : ${raw}`</span>
<span class="linenr"> 5632: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isUpdateArg) {
<span class="linenr"> 5633: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">make id replace parent in the code range so the raw update operator</span>
<span class="linenr"> 5634: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">is removed</span>
<span class=
"linenr"> 5635: </span>          id.start = parent.start
<span class="linenr"> 5636: </span>          id.end = parent.end
<span class="linenr"> 5637: </span>          <span class=
"org-keyword">const</span> { prefix: isPrefix, operator } = parent
<span class="linenr"> 5638: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prefix</span> = isPrefix ? operator : <span class="org-string">``</span>
<span class="linenr"> 5639: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">postfix</span> = isPrefix ? <span class=
"org-string">``</span> : operator
<span class="linenr"> 5640: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let binding.</span>
<span class="linenr"> 5641: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x++ --&gt; isRef(a) ? a.value++ : a++</span>
<span class="linenr"> 5642: </span>          <span class=
"org-keyword">return</span> <span class=
"org-string">`${context.helperString(IS_REF)}(${raw})${``} ? ${prefix}${raw}.value${postfix} : ${prefix}${raw}${postfix}`</span>
<span class="linenr"> 5643: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isDestructureAssignment) {
<span class="linenr"> 5644: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO</span></span></span>
<span class="linenr"> 5645: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let binding in a destructure assignment - it's very tricky to</span>
<span class="linenr"> 5646: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">handle both possible cases here without altering the original</span>
<span class="linenr"> 5647: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">structure of the code, so we just assume it's not a ref here</span>
<span class="linenr"> 5648: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for now</span>
<span class="linenr"> 5649: </span>          <span class=
"org-keyword">return</span> raw
<span class="linenr"> 5650: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5651: </span>          <span class=
"org-keyword">return</span> <span class=
"org-string">`${context.helperString(UNREF)}(${raw})`</span>
<span class="linenr"> 5652: </span>        }
<span class="linenr"> 5653: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.PROPS) {
<span class="linenr"> 5654: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">use __props which is generated by compileScript so in ts mode</span>
<span class="linenr"> 5655: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">it gets correct type</span>
<span class="linenr"> 5656: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`__props.${raw}`</span>
<span class="linenr"> 5657: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.PROPS_ALIASED) {
<span class="linenr"> 5658: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">prop with a different local alias (from defineProps() destructure)</span>
<span class="linenr"> 5659: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`__props.${bindingMetadata.__propsAliases[raw]}`</span>
<span class="linenr"> 5660: </span>      }
<span class="linenr"> 5661: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5662: </span>      <span class=
"org-keyword">if</span> (type &amp;& type.startsWith(<span class=
"org-string">'setup'</span>)) {
<span class="linenr"> 5663: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">setup bindings in non-inline mode</span>
<span class="linenr"> 5664: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`$setup.${raw}`</span>
<span class="linenr"> 5665: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.PROPS_ALIASED) {
<span class="linenr"> 5666: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`$props.${bindingMetadata.__propsAliases[raw]}`</span>
<span class="linenr"> 5667: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type) {
<span class="linenr"> 5668: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`$${type}.${raw}`</span>
<span class="linenr"> 5669: </span>      }
<span class="linenr"> 5670: </span>    }
<span class="linenr"> 5671: </span>
<span class="linenr"> 5672: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">fallback to ctx</span>
<span class="linenr"> 5673: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`_ctx.${raw}`</span>
<span class="linenr"> 5674: </span>  }
<span class="linenr"> 5675: </span>
<span class="linenr"> 5676: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">fast path if expression is a simple identifier.</span>
<span class="linenr"> 5677: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rawExp</span> = node.content
<span class="linenr"> 5678: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">bail constant on parens (function invocation) and dot (member access)</span>
<span class="linenr"> 5679: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bailConstant</span> = rawExp.indexOf(<span class="org-string">`(`</span>) &gt; -<span class="org-highlight-numbers-number">1</span> || rawExp.indexOf(<span class="org-string">'.'</span>) &gt; <span class="org-highlight-numbers-number">0</span>
<span class="linenr"> 5680: </span>
<span class="linenr"> 5681: </span>  <span class=
"org-keyword">if</span> (isSimpleIdentifier(rawExp)) {
<span class="linenr"> 5682: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isScopeVarReference</span> = context.identifiers[rawExp]
<span class="linenr"> 5683: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isAllowedGlobal</span> = isGloballyWhitelisted(rawExp)
<span class="linenr"> 5684: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isLiteral</span> = isLiteralWhitelisted(rawExp)
<span class="linenr"> 5685: </span>    <span class=
"org-keyword">if</span> (!asParams &amp;& !isScopeVarReference &amp;& !isAllowedGlobal &amp;& !isLiteral) {
<span class="linenr"> 5686: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">const bindings exposed from setup can be skipped for patching but</span>
<span class="linenr"> 5687: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">cannot be hoisted to module scope</span>
<span class="linenr"> 5688: </span>      <span class=
"org-keyword">if</span> (bindingMetadata[node.content] === BindingTypes.SETUP_CONST) {
<span class=
"linenr"> 5689: </span>        node.constType = ConstantTypes.CAN_SKIP_PATCH
<span class="linenr"> 5690: </span>      }
<span class=
"linenr"> 5691: </span>      node.content = rewriteIdentifier(rawExp)
<span class="linenr"> 5692: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (!isScopeVarReference) {
<span class="linenr"> 5693: </span>      <span class=
"org-keyword">if</span> (isLiteral) {
<span class=
"linenr"> 5694: </span>        node.constType = ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 5695: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 5696: </span>        node.constType = ConstantTypes.CAN_HOIST
<span class="linenr"> 5697: </span>      }
<span class="linenr"> 5698: </span>    }
<span class="linenr"> 5699: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 5700: </span>  }
<span class="linenr"> 5701: </span>
<span class="linenr"> 5702: </span>  <span class=
"org-keyword">let</span> <span class="org-variable-name">ast</span>
<span class="linenr"> 5703: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">exp needs to be parsed differently:</span>
<span class="linenr"> 5704: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. Multiple inline statements (v-on, with presence of `;`): parse as raw</span>
<span class="linenr"> 5705: </span>  <span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">exp, but make sure to pad with spaces for consistent ranges</span>
<span class="linenr"> 5706: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. Expressions: wrap with parens (for e.g. object expressions)</span>
<span class="linenr"> 5707: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">3. Function arguments (v-for, v-slot): place in a function argument position</span>
<span class="linenr"> 5708: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = asRawStatements
<span class="linenr"> 5709: </span>    ? <span class=
"org-string">` ${rawExp} `</span>
<span class="linenr"> 5710: </span>    : <span class=
"org-string">`(${rawExp})${asParams ? `</span>=&gt;{}<span class=
"org-string">` : ``}`</span>
<span class="linenr"> 5711: </span>  <span class=
"org-keyword">try</span> {
<span class=
"linenr"> 5712: </span>    ast = babelParser.parse(source, {
<span class=
"linenr"> 5713: </span>      plugins: context.expressionPlugins
<span class="linenr"> 5714: </span>    }).program
<span class="linenr"> 5715: </span>  } <span class=
"org-keyword">catch</span> (e) {
<span class="linenr"> 5716: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 5717: </span>  }
<span class="linenr"> 5718: </span>
<span class="linenr"> 5719: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ids</span>= []
<span class="linenr"> 5720: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parentStack</span> = []
<span class="linenr"> 5721: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">knownIds</span> = Object.create(context.identifiers)
<span class="linenr"> 5722: </span>
<span class="linenr"> 5723: </span>  walkIdentifiers(
<span class="linenr"> 5724: </span>    ast,
<span class=
"linenr"> 5725: </span>    (node, parent, _, isReferenced, isLocal) =&gt; {
<span class="linenr"> 5726: </span>      <span class=
"org-keyword">if</span> (isStaticPropertyKey(node, parent)) {
<span class="linenr"> 5727: </span>        <span class=
"org-keyword">return</span>
<span class="linenr"> 5728: </span>      }
<span class="linenr"> 5729: </span>
<span class="linenr"> 5730: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">needPrefix</span> = isReferenced &amp;& canPrefix(node)
<span class="linenr"> 5731: </span>      <span class=
"org-keyword">if</span> (needPrefix &amp;& !isLocal) {
<span class="linenr"> 5732: </span>        <span class=
"org-keyword">if</span> (isStaticProperty(parent) &amp;& parent.shorthand) {
<span class="linenr"> 5733: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">property shorthand like { foo }, we need to add the key since</span>
<span class="linenr"> 5734: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we rewrite the value</span>
<span class=
"linenr"> 5735: </span>          node.prefix = <span class=
"org-string">`${node.name}: `</span>
<span class="linenr"> 5736: </span>        }
<span class=
"linenr"> 5737: </span>        node.name = rewriteIdentifier(node.name, parent, node)
<span class="linenr"> 5738: </span>        ids.push(node)
<span class="linenr"> 5739: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5740: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">The identifier is considered constant unless it's pointing to a</span>
<span class="linenr"> 5741: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">local scope variable (a v-for alias, or a v-slot prop)</span>
<span class="linenr"> 5742: </span>        <span class=
"org-keyword">if</span> (!(needPrefix &amp;& isLocal) &amp;& !bailConstant) {
<span class=
"linenr"> 5743: </span>          node.isConstant = <span class=
"org-constant">true</span>
<span class="linenr"> 5744: </span>        }
<span class="linenr"> 5745: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">also generate sub-expressions for other identifiers for better</span>
<span class="linenr"> 5746: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">source map support. (except for property keys which are static)</span>
<span class="linenr"> 5747: </span>        ids.push(node)
<span class="linenr"> 5748: </span>      }
<span class="linenr"> 5749: </span>    },
<span class="linenr"> 5750: </span>    <span class=
"org-constant">true</span>, <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">invoke on ALL identifiers</span>
<span class="linenr"> 5751: </span>    parentStack,
<span class="linenr"> 5752: </span>    knownIds
<span class="linenr"> 5753: </span>  )
<span class="linenr"> 5754: </span>
<span class="linenr"> 5755: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">We break up the compound expression into an array of strings and sub</span>
<span class="linenr"> 5756: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">expressions (for identifiers that have been prefixed). In codegen, if</span>
<span class="linenr"> 5757: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">an ExpressionNode has the `.children` property, it will be used instead of</span>
<span class="linenr"> 5758: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">`.content`.</span>
<span class="linenr"> 5759: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">children</span> = []
<span class=
"linenr"> 5760: </span>  ids.sort((a, b) =&gt; a.start - b.start)
<span class="linenr"> 5761: </span>  ids.forEach((id, i) =&gt; {
<span class="linenr"> 5762: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">range is offset by -1 due to the wrapping parens when parsed</span>
<span class="linenr"> 5763: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = id.start - <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 5764: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">end</span> = id.end - <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 5765: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">last</span> = ids[i - <span class=
"org-highlight-numbers-number">1</span>]
<span class="linenr"> 5766: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">leadingText</span> = rawExp.slice(last ? last.end - <span class="org-highlight-numbers-number">1</span> : <span class="org-highlight-numbers-number">0</span>, start)
<span class="linenr"> 5767: </span>    <span class=
"org-keyword">if</span> (leadingText.length || id.prefix) {
<span class=
"linenr"> 5768: </span>      children.push(leadingText + (id.prefix || <span class="org-string">``</span>))
<span class="linenr"> 5769: </span>    }
<span class="linenr"> 5770: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = rawExp.slice(start, end)
<span class="linenr"> 5771: </span>    children.push(
<span class="linenr"> 5772: </span>      createSimpleExpression(
<span class="linenr"> 5773: </span>        id.name,
<span class="linenr"> 5774: </span>        <span class=
"org-constant">false</span>,
<span class="linenr"> 5775: </span>        {
<span class="linenr"> 5776: </span>          source,
<span class=
"linenr"> 5777: </span>          start: advancePositionWithClone(node.loc.start, source, start),
<span class=
"linenr"> 5778: </span>          end: advancePositionWithClone(node.loc.start, source, end)
<span class="linenr"> 5779: </span>        },
<span class=
"linenr"> 5780: </span>        id.isConstant ? ConstantTypes.CAN_STRINGIFY : ConstantTypes.NOT_CONSTANT
<span class="linenr"> 5781: </span>      )
<span class="linenr"> 5782: </span>    )
<span class="linenr"> 5783: </span>    <span class=
"org-keyword">if</span> (i === ids.length - <span class=
"org-highlight-numbers-number">1</span> &amp;& end &lt; rawExp.length) {
<span class=
"linenr"> 5784: </span>      children.push(rawExp.slice(end))
<span class="linenr"> 5785: </span>    }
<span class="linenr"> 5786: </span>  })
<span class="linenr"> 5787: </span>
<span class="linenr"> 5788: </span>  <span class=
"org-keyword">let</span> <span class="org-variable-name">ret</span>
<span class="linenr"> 5789: </span>  <span class=
"org-keyword">if</span> (children.length) {
<span class=
"linenr"> 5790: </span>    ret = createCompoundExpression(children, node.loc)
<span class="linenr"> 5791: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5792: </span>    ret = node
<span class="linenr"> 5793: </span>    ret.constType = bailConstant
<span class=
"linenr"> 5794: </span>      ? ConstantTypes.NOT_CONSTANT
<span class=
"linenr"> 5795: </span>      : ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 5796: </span>  }
<span class=
"linenr"> 5797: </span>  ret.identifiers = Object.keys(knownIds)
<span class="linenr"> 5798: </span>  <span class=
"org-keyword">return</span> ret
<span class="linenr"> 5799: </span>}
<span class="linenr"> 5800: </span>
<span class="linenr"> 5801: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">canPrefix</span>(<span class=
"org-variable-name">id</span>) {
<span class="linenr"> 5802: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip whitelisted globals</span>
<span class="linenr"> 5803: </span>  <span class=
"org-keyword">if</span> (isGloballyWhitelisted(id.name)) {
<span class="linenr"> 5804: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 5805: </span>  }
<span class="linenr"> 5806: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">special case for webpack compilation</span>
<span class="linenr"> 5807: </span>  <span class=
"org-keyword">if</span> (id.name === <span class=
"org-string">'require'</span>) {
<span class="linenr"> 5808: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 5809: </span>  }
<span class="linenr"> 5810: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 5811: </span>}
<span class="linenr"> 5812: </span>
<span class="linenr"> 5813: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">stringifyExpression</span>(<span class=
"org-variable-name">exp</span>){
<span class="linenr"> 5814: </span>  <span class=
"org-keyword">if</span> (isString(exp)) {
<span class="linenr"> 5815: </span>    <span class=
"org-keyword">return</span> exp
<span class="linenr"> 5816: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (exp.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 5817: </span>    <span class=
"org-keyword">return</span> exp.content
<span class="linenr"> 5818: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5819: </span>    <span class=
"org-keyword">return</span> exp.children.map(stringifyExpression).join(<span class="org-string">''</span>)
<span class="linenr"> 5820: </span>  }
<span class="linenr"> 5821: </span>}
<span class="linenr"> 5822: </span>
<span class="linenr"> 5823: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createRoot</span>(<span class=
"org-variable-name">children</span>, <span class=
"org-variable-name">loc</span> = <span class=
"org-variable-name">locStub</span>) {
<span class="linenr"> 5824: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 5825: </span>    type: NodeTypes.ROOT,
<span class="linenr"> 5826: </span>    children,
<span class="linenr"> 5827: </span>    helpers: [],
<span class="linenr"> 5828: </span>    components: [],
<span class="linenr"> 5829: </span>    directives: [],
<span class="linenr"> 5830: </span>    hoists: [],
<span class="linenr"> 5831: </span>    imports: [],
<span class="linenr"> 5832: </span>    cached: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 5833: </span>    temps: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 5834: </span>    codegenNode: <span class=
"org-constant">undefined</span>,
<span class="linenr"> 5835: </span>    loc
<span class="linenr"> 5836: </span>  }
<span class="linenr"> 5837: </span>}
<span class="linenr"> 5838: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createVNodeCall</span>(
<span class="linenr"> 5839: </span>  <span class=
"org-variable-name">context</span>,
<span class="linenr"> 5840: </span>  <span class=
"org-variable-name">tag</span>,
<span class="linenr"> 5841: </span>  <span class=
"org-variable-name">props</span>,
<span class="linenr"> 5842: </span>  <span class=
"org-variable-name">children</span>,
<span class="linenr"> 5843: </span>  <span class=
"org-variable-name">patchFlag</span>,
<span class="linenr"> 5844: </span>  <span class=
"org-variable-name">dynamicProps</span>,
<span class="linenr"> 5845: </span>  <span class=
"org-variable-name">directives</span>,
<span class="linenr"> 5846: </span>  isBlock = <span class=
"org-constant">false</span>,
<span class="linenr"> 5847: </span>  disableTracking = <span class=
"org-constant">false</span>,
<span class="linenr"> 5848: </span>  isComponent = <span class=
"org-constant">false</span>,
<span class="linenr"> 5849: </span>  loc = locStub
<span class="linenr"> 5850: </span>) {
<span class="linenr"> 5851: </span>  <span class=
"org-keyword">if</span> (context) {
<span class="linenr"> 5852: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">单个子节点用 block</span>
<span class="linenr"> 5853: </span>    <span class=
"org-keyword">if</span> (isBlock) {
<span class="linenr"> 5854: </span>      context.helper(OPEN_BLOCK)
<span class=
"linenr"> 5855: </span>      context.helper(getVNodeBlockHelper(context.inSSR, isComponent))
<span class="linenr"> 5856: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5857: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">多个节节点用 fragment</span>
<span class=
"linenr"> 5858: </span>      context.helper(getVNodeHelper(context.inSSR, isComponent))
<span class="linenr"> 5859: </span>    }
<span class="linenr"> 5860: </span>    <span class=
"org-keyword">if</span> (directives) {
<span class=
"linenr"> 5861: </span>      context.helper(WITH_DIRECTIVES)
<span class="linenr"> 5862: </span>    }
<span class="linenr"> 5863: </span>  }
<span class="linenr"> 5864: </span>
<span class="linenr"> 5865: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 5866: </span>    type: NodeTypes.VNODE_CALL,
<span class="linenr"> 5867: </span>    tag,
<span class="linenr"> 5868: </span>    props,
<span class="linenr"> 5869: </span>    children,
<span class="linenr"> 5870: </span>    patchFlag,
<span class="linenr"> 5871: </span>    dynamicProps,
<span class="linenr"> 5872: </span>    directives,
<span class="linenr"> 5873: </span>    isBlock,
<span class="linenr"> 5874: </span>    disableTracking,
<span class="linenr"> 5875: </span>    isComponent,
<span class="linenr"> 5876: </span>    loc
<span class="linenr"> 5877: </span>  }
<span class="linenr"> 5878: </span>}
<span class="linenr"> 5879: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createArrayExpression</span>(<span class=
"org-variable-name">elements</span>, <span class=
"org-variable-name">loc</span> = <span class=
"org-variable-name">locStub</span>) {
<span class="linenr"> 5880: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5881: </span>    type: NodeTypes.JS_ARRAY_EXPRESSION,
<span class="linenr"> 5882: </span>    loc,
<span class="linenr"> 5883: </span>    elements
<span class="linenr"> 5884: </span>  }
<span class="linenr"> 5885: </span>}
<span class="linenr"> 5886: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createObjectExpression</span>(<span class=
"org-variable-name">properties</span>, <span class=
"org-variable-name">loc</span> = <span class=
"org-variable-name">locStub</span>) {
<span class="linenr"> 5887: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5888: </span>    type: NodeTypes.JS_OBJECT_EXPRESSION,
<span class="linenr"> 5889: </span>    loc,
<span class="linenr"> 5890: </span>    properties
<span class="linenr"> 5891: </span>  }
<span class="linenr"> 5892: </span>}
<span class="linenr"> 5893: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createObjectProperty</span>(<span class=
"org-variable-name">key</span>, <span class=
"org-variable-name">value</span>) {
<span class="linenr"> 5894: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 5895: </span>    type: NodeTypes.JS_PROPERTY,
<span class="linenr"> 5896: </span>    loc: locStub,
<span class=
"linenr"> 5897: </span>    key: isString(key) ? createSimpleExpression(key, <span class="org-constant">true</span>) : key,
<span class="linenr"> 5898: </span>    value
<span class="linenr"> 5899: </span>  }
<span class="linenr"> 5900: </span>}
<span class="linenr"> 5901: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createSimpleExpression</span>(
<span class="linenr"> 5902: </span>  <span class=
"org-variable-name">content</span>,
<span class="linenr"> 5903: </span>  isStatic = <span class=
"org-constant">false</span>,
<span class="linenr"> 5904: </span>  loc  = locStub,
<span class=
"linenr"> 5905: </span>  constType = ConstantTypes.NOT_CONSTANT
<span class="linenr"> 5906: </span>) {
<span class="linenr"> 5907: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5908: </span>    type: NodeTypes.SIMPLE_EXPRESSION,
<span class="linenr"> 5909: </span>    loc,
<span class="linenr"> 5910: </span>    content,
<span class="linenr"> 5911: </span>    isStatic,
<span class=
"linenr"> 5912: </span>    constType: isStatic ? ConstantTypes.CAN_STRINGIFY : constType
<span class="linenr"> 5913: </span>  }
<span class="linenr"> 5914: </span>}
<span class="linenr"> 5915: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createInterpolation</span>(<span class=
"org-variable-name">content</span>, <span class=
"org-variable-name">loc</span>) {
<span class="linenr"> 5916: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5917: </span>    type: NodeTypes.INTERPOLATION,
<span class="linenr"> 5918: </span>    loc,
<span class="linenr"> 5919: </span>    content: isString(content)
<span class=
"linenr"> 5920: </span>      ? createSimpleExpression(content, <span class="org-constant">false</span>, loc)
<span class="linenr"> 5921: </span>      : content
<span class="linenr"> 5922: </span>  }
<span class="linenr"> 5923: </span>}
<span class="linenr"> 5924: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createCompoundExpression</span>(<span class=
"org-variable-name">children</span>, <span class=
"org-variable-name">loc</span> = <span class=
"org-variable-name">locStub</span>) {
<span class="linenr"> 5925: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5926: </span>    type: NodeTypes.COMPOUND_EXPRESSION,
<span class="linenr"> 5927: </span>    loc,
<span class="linenr"> 5928: </span>    children
<span class="linenr"> 5929: </span>  }
<span class="linenr"> 5930: </span>}
<span class="linenr"> 5931: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createCallExpression</span>(<span class=
"org-variable-name">callee</span>, <span class=
"org-variable-name">args</span> = [], <span class=
"org-variable-name">loc</span> = <span class=
"org-variable-name">locStub</span>) {
<span class="linenr"> 5932: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5933: </span>    type: NodeTypes.JS_CALL_EXPRESSION,
<span class="linenr"> 5934: </span>    loc,
<span class="linenr"> 5935: </span>    callee,
<span class="linenr"> 5936: </span>    <span class=
"org-constant">arguments</span>: args
<span class="linenr"> 5937: </span>  }
<span class="linenr"> 5938: </span>}
<span class="linenr"> 5939: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createFunctionExpression</span>(
<span class="linenr"> 5940: </span>  <span class=
"org-variable-name">params</span>,
<span class="linenr"> 5941: </span>  returns = <span class=
"org-constant">undefined</span>,
<span class="linenr"> 5942: </span>  newline = <span class=
"org-constant">false</span>,
<span class="linenr"> 5943: </span>  isSlot = <span class=
"org-constant">false</span>,
<span class="linenr"> 5944: </span>  loc = locStub
<span class="linenr"> 5945: </span>) {
<span class="linenr"> 5946: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5947: </span>    type: NodeTypes.JS_FUNCTION_EXPRESSION,
<span class="linenr"> 5948: </span>    params,
<span class="linenr"> 5949: </span>    returns,
<span class="linenr"> 5950: </span>    newline,
<span class="linenr"> 5951: </span>    isSlot,
<span class="linenr"> 5952: </span>    loc
<span class="linenr"> 5953: </span>  }
<span class="linenr"> 5954: </span>}
<span class="linenr"> 5955: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createConditionalExpression</span>(
<span class="linenr"> 5956: </span>  <span class=
"org-variable-name">test</span>,
<span class="linenr"> 5957: </span>  <span class=
"org-variable-name">consequent</span>,
<span class="linenr"> 5958: </span>  <span class=
"org-variable-name">alternate</span>,
<span class="linenr"> 5959: </span>  newline = <span class=
"org-constant">true</span>
<span class="linenr"> 5960: </span>) {
<span class="linenr"> 5961: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5962: </span>    type: NodeTypes.JS_CONDITIONAL_EXPRESSION,
<span class="linenr"> 5963: </span>    test,
<span class="linenr"> 5964: </span>    consequent,
<span class="linenr"> 5965: </span>    alternate,
<span class="linenr"> 5966: </span>    newline,
<span class="linenr"> 5967: </span>    loc: locStub
<span class="linenr"> 5968: </span>  }
<span class="linenr"> 5969: </span>}
<span class="linenr"> 5970: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createCacheExpression</span>(
<span class="linenr"> 5971: </span>  <span class=
"org-variable-name">index</span>,
<span class="linenr"> 5972: </span>  <span class=
"org-variable-name">value</span>,
<span class="linenr"> 5973: </span>  isVNode = <span class=
"org-constant">false</span>
<span class="linenr"> 5974: </span>) {
<span class="linenr"> 5975: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5976: </span>    type: NodeTypes.JS_CACHE_EXPRESSION,
<span class="linenr"> 5977: </span>    index,
<span class="linenr"> 5978: </span>    value,
<span class="linenr"> 5979: </span>    isVNode,
<span class="linenr"> 5980: </span>    loc: locStub
<span class="linenr"> 5981: </span>  }
<span class="linenr"> 5982: </span>}
<span class="linenr"> 5983: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createBlockStatement</span>(<span class=
"org-variable-name">body</span>) {
<span class="linenr"> 5984: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5985: </span>    type: NodeTypes.JS_BLOCK_STATEMENT,
<span class="linenr"> 5986: </span>    body,
<span class="linenr"> 5987: </span>    loc: locStub
<span class="linenr"> 5988: </span>  }
<span class="linenr"> 5989: </span>}
<span class="linenr"> 5990: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createTemplateLiteral</span>(<span class=
"org-variable-name">elements</span>) {
<span class="linenr"> 5991: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5992: </span>    type: NodeTypes.JS_TEMPLATE_LITERAL,
<span class="linenr"> 5993: </span>    elements,
<span class="linenr"> 5994: </span>    loc: locStub
<span class="linenr"> 5995: </span>  }
<span class="linenr"> 5996: </span>}
<span class="linenr"> 5997: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createIfStatement</span>(<span class=
"org-variable-name">test</span>, <span class=
"org-variable-name">consequent</span>, <span class=
"org-variable-name">alternate</span>) {
<span class="linenr"> 5998: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5999: </span>    type: NodeTypes.JS_IF_STATEMENT,
<span class="linenr"> 6000: </span>    test,
<span class="linenr"> 6001: </span>    consequent,
<span class="linenr"> 6002: </span>    alternate,
<span class="linenr"> 6003: </span>    loc: locStub
<span class="linenr"> 6004: </span>  }
<span class="linenr"> 6005: </span>}
<span class="linenr"> 6006: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createAssignmentExpression</span>(<span class=
"org-variable-name">left</span>, <span class=
"org-variable-name">right</span>) {
<span class="linenr"> 6007: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 6008: </span>    type: NodeTypes.JS_ASSIGNMENT_EXPRESSION,
<span class="linenr"> 6009: </span>    left,
<span class="linenr"> 6010: </span>    right,
<span class="linenr"> 6011: </span>    loc: locStub
<span class="linenr"> 6012: </span>  }
<span class="linenr"> 6013: </span>}
<span class="linenr"> 6014: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createSequenceExpression</span>(<span class=
"org-variable-name">expressions</span>) {
<span class="linenr"> 6015: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 6016: </span>    type: NodeTypes.JS_SEQUENCE_EXPRESSION,
<span class="linenr"> 6017: </span>    expressions,
<span class="linenr"> 6018: </span>    loc: locStub
<span class="linenr"> 6019: </span>  }
<span class="linenr"> 6020: </span>}
<span class="linenr"> 6021: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createReturnStatement</span>(<span class=
"org-variable-name">returns</span>) {
<span class="linenr"> 6022: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 6023: </span>    type: NodeTypes.JS_RETURN_STATEMENT,
<span class="linenr"> 6024: </span>    returns,
<span class="linenr"> 6025: </span>    loc: locStub
<span class="linenr"> 6026: </span>  }
<span class="linenr"> 6027: </span>}
<span class="linenr"> 6028: </span>
<span class="linenr"> 6029: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">transform</span>(<span class=
"org-variable-name">root</span>, <span class=
"org-variable-name">options</span>) {
<span class="linenr"> 6030: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">transform 上下文</span>
<span class="linenr"> 6031: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">context</span> = createTransformContext(root, options)
<span class="linenr"> 6032: </span>
<span class="linenr"> 6033: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">递归遍历整个 ast root 树，最终为每颗子树生成 codegenNode</span>
<span class="linenr"> 6034: </span>  traverseNode(root, context)
<span class="linenr"> 6035: </span>
<span class="linenr"> 6036: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">静态提升处理</span>
<span class="linenr"> 6037: </span>  <span class=
"org-keyword">if</span> (options.hoistStatic) {
<span class="linenr"> 6038: </span>    hoistStatic(root, context)
<span class="linenr"> 6039: </span>  }
<span class="linenr"> 6040: </span>
<span class="linenr"> 6041: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">创建 root codegenNode 代码</span>
<span class="linenr"> 6042: </span>  <span class=
"org-keyword">if</span> (!options.ssr) {
<span class=
"linenr"> 6043: </span>    createRootCodegen(root, context)
<span class="linenr"> 6044: </span>  }
<span class="linenr"> 6045: </span>
<span class="linenr"> 6046: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">finalize meta information</span>
<span class=
"linenr"> 6047: </span>  root.helpers = [...context.helpers.keys()]
<span class=
"linenr"> 6048: </span>  root.components = [...context.components]
<span class=
"linenr"> 6049: </span>  root.directives = [...context.directives]
<span class="linenr"> 6050: </span>  root.imports = context.imports
<span class="linenr"> 6051: </span>  root.hoists = context.hoists
<span class="linenr"> 6052: </span>  root.temps = context.temps
<span class="linenr"> 6053: </span>  root.cached = context.cached
<span class="linenr"> 6054: </span>}
<span class="linenr"> 6055: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getBaseTransformPreset</span>(<span class=
"org-variable-name">prefixIdentifiers</span>) {
<span class="linenr"> 6056: </span>  <span class=
"org-keyword">return</span> [
<span class="linenr"> 6057: </span>    [
<span class="linenr"> 6058: </span>      transformOnce,
<span class="linenr"> 6059: </span>      transformIf,
<span class="linenr"> 6060: </span>      transformMemo,
<span class="linenr"> 6061: </span>      transformFor,
<span class=
"linenr"> 6062: </span>      ...(!__BROWSER__ &amp;& prefixIdentifiers
<span class="linenr"> 6063: </span>        ? [
<span class="linenr"> 6064: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">order is important</span>
<span class="linenr"> 6065: </span>            trackVForSlotScopes,
<span class="linenr"> 6066: </span>            transformExpression
<span class="linenr"> 6067: </span>          ]
<span class=
"linenr"> 6068: </span>        : __BROWSER__ &amp;& __DEV__
<span class="linenr"> 6069: </span>        ? [transformExpression]
<span class="linenr"> 6070: </span>        : []),
<span class="linenr"> 6071: </span>      transformSlotOutlet,
<span class="linenr"> 6072: </span>      transformElement,
<span class="linenr"> 6073: </span>      trackSlotScopes,
<span class="linenr"> 6074: </span>      transformText
<span class="linenr"> 6075: </span>    ],
<span class="linenr"> 6076: </span>    {
<span class="linenr"> 6077: </span>      on: transformOn,
<span class="linenr"> 6078: </span>      bind: transformBind,
<span class="linenr"> 6079: </span>      model: transformModel
<span class="linenr"> 6080: </span>    }
<span class="linenr"> 6081: </span>  ]
<span class="linenr"> 6082: </span>}
<span class="linenr"> 6083: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">PURE_ANNOTATION</span> = <span class=
"org-string">`/*#__PURE__*/`</span>
<span class="linenr"> 6084: </span>
<span class="linenr"> 6085: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isText$1</span>(<span class=
"org-variable-name">n</span>) {
<span class="linenr"> 6086: </span>  <span class=
"org-keyword">return</span> (
<span class="linenr"> 6087: </span>    isString(n) ||
<span class=
"linenr"> 6088: </span>    n.type === NodeTypes.SIMPLE_EXPRESSION ||
<span class="linenr"> 6089: </span>    n.type === NodeTypes.TEXT ||
<span class=
"linenr"> 6090: </span>    n.type === NodeTypes.INTERPOLATION ||
<span class=
"linenr"> 6091: </span>    n.type === NodeTypes.COMPOUND_EXPRESSION
<span class="linenr"> 6092: </span>  )
<span class="linenr"> 6093: </span>}
<span class="linenr"> 6094: </span>
<span class="linenr"> 6095: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">过滤掉后面空值参数fn(a, b, c, null, undefined, '') =&gt; fn(a,b,c)</span>
<span class="linenr"> 6096: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genNullableArgs</span>(<span class=
"org-variable-name">args</span>) {
<span class="linenr"> 6097: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = args.length
<span class="linenr"> 6098: </span>  <span class=
"org-keyword">while</span> (i--) {
<span class="linenr"> 6099: </span>    <span class=
"org-keyword">if</span> (args[i] != <span class=
"org-constant">null</span>) <span class="org-keyword">break</span>
<span class="linenr"> 6100: </span>  }
<span class="linenr"> 6101: </span>  <span class=
"org-keyword">return</span> args.slice(<span class=
"org-highlight-numbers-number">0</span>, i + <span class=
"org-highlight-numbers-number">1</span>).map(arg =&gt; arg || <span class="org-string">`null`</span>)
<span class="linenr"> 6102: </span>}
<span class="linenr"> 6103: </span>
<span class="linenr"> 6104: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">生成对象的 key 值，可能是个表达式，如： { [a + b + c]: value }</span>
<span class="linenr"> 6105: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genExpressionAsPropertyKey</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6106: </span>  <span class=
"org-keyword">const</span> { push } = context
<span class="linenr"> 6107: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.COMPOUND_EXPRESSION) {
<span class="linenr"> 6108: </span>    push(<span class=
"org-string">`[`</span>)
<span class=
"linenr"> 6109: </span>    genCompoundExpression(node, context)
<span class="linenr"> 6110: </span>    push(<span class=
"org-string">`]`</span>)
<span class="linenr"> 6111: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.isStatic) {
<span class="linenr"> 6112: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">only quote keys if necessary</span>
<span class="linenr"> 6113: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">text</span> = isSimpleIdentifier(node.content)
<span class="linenr"> 6114: </span>      ? node.content
<span class=
"linenr"> 6115: </span>      : JSON.stringify(node.content)
<span class="linenr"> 6116: </span>    push(text, node)
<span class="linenr"> 6117: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6118: </span>    push(<span class=
"org-string">`[${node.content}]`</span>, node)
<span class="linenr"> 6119: </span>  }
<span class="linenr"> 6120: </span>}
<span class="linenr"> 6121: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createCodegenContext</span>(
<span class="linenr"> 6122: </span>  <span class=
"org-variable-name">ast</span>,
<span class="linenr"> 6123: </span>  {
<span class="linenr"> 6124: </span>    mode = <span class=
"org-string">'function'</span>,
<span class=
"linenr"> 6125: </span>    prefixIdentifiers = mode === <span class="org-string">'module'</span>,
<span class="linenr"> 6126: </span>    sourceMap = <span class=
"org-constant">false</span>,
<span class="linenr"> 6127: </span>    filename = <span class=
"org-string">`template.vue.html`</span>,
<span class="linenr"> 6128: </span>    scopeId = <span class=
"org-constant">null</span>,
<span class=
"linenr"> 6129: </span>    optimizeImports = <span class=
"org-constant">false</span>,
<span class=
"linenr"> 6130: </span>    runtimeGlobalName = <span class=
"org-string">`Vue`</span>,
<span class=
"linenr"> 6131: </span>    runtimeModuleName = <span class=
"org-string">`vue`</span>,
<span class=
"linenr"> 6132: </span>    ssrRuntimeModuleName = <span class=
"org-string">'vue/server-renderer'</span>,
<span class="linenr"> 6133: </span>    ssr = <span class=
"org-constant">false</span>,
<span class="linenr"> 6134: </span>    isTS = <span class=
"org-constant">false</span>,
<span class="linenr"> 6135: </span>    inSSR = <span class=
"org-constant">false</span>
<span class="linenr"> 6136: </span>  }
<span class="linenr"> 6137: </span>) {
<span class="linenr"> 6138: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">context</span> = {
<span class="linenr"> 6139: </span>    mode,
<span class="linenr"> 6140: </span>    prefixIdentifiers,
<span class="linenr"> 6141: </span>    sourceMap,
<span class="linenr"> 6142: </span>    filename,
<span class="linenr"> 6143: </span>    scopeId,
<span class="linenr"> 6144: </span>    optimizeImports,
<span class="linenr"> 6145: </span>    runtimeGlobalName,
<span class="linenr"> 6146: </span>    runtimeModuleName,
<span class="linenr"> 6147: </span>    ssrRuntimeModuleName,
<span class="linenr"> 6148: </span>    ssr,
<span class="linenr"> 6149: </span>    isTS,
<span class="linenr"> 6150: </span>    inSSR,
<span class="linenr"> 6151: </span>    source: ast.loc.source,
<span class="linenr"> 6152: </span>    code: <span class=
"org-string">``</span>,
<span class="linenr"> 6153: </span>    column: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr"> 6154: </span>    line: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr"> 6155: </span>    offset: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 6156: </span>    indentLevel: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 6157: </span>    pure: <span class=
"org-constant">false</span>,
<span class="linenr"> 6158: </span>    map: <span class=
"org-constant">undefined</span>,
<span class="linenr"> 6159: </span>    helper(key) {
<span class="linenr"> 6160: </span>      <span class=
"org-keyword">return</span> <span class=
"org-string">`_${helperNameMap[key]}`</span>
<span class="linenr"> 6161: </span>    },
<span class="linenr"> 6162: </span>    push(code, node) {
<span class="linenr"> 6163: </span>      context.code += code
<span class="linenr"> 6164: </span>      <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.map) {
<span class="linenr"> 6165: </span>        <span class=
"org-keyword">if</span> (node) {
<span class="linenr"> 6166: </span>          <span class=
"org-keyword">let</span> <span class=
"org-variable-name">name</span>
<span class="linenr"> 6167: </span>          <span class=
"org-keyword">if</span> (node.type === NodeTypes.SIMPLE_EXPRESSION &amp;& !node.isStatic) {
<span class="linenr"> 6168: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">content</span> = node.content.replace(<span class="org-string">/^_ctx\./</span>, <span class="org-string">''</span>)
<span class="linenr"> 6169: </span>            <span class=
"org-keyword">if</span> (content !== node.content &amp;& isSimpleIdentifier(content)) {
<span class="linenr"> 6170: </span>              name = content
<span class="linenr"> 6171: </span>            }
<span class="linenr"> 6172: </span>          }
<span class=
"linenr"> 6173: </span>          addMapping(node.loc.start, name)
<span class="linenr"> 6174: </span>        }
<span class=
"linenr"> 6175: </span>        advancePositionWithMutation(context, code)
<span class="linenr"> 6176: </span>        <span class=
"org-keyword">if</span> (node &amp;& node.loc !== locStub) {
<span class=
"linenr"> 6177: </span>          addMapping(node.loc.end)
<span class="linenr"> 6178: </span>        }
<span class="linenr"> 6179: </span>      }
<span class="linenr"> 6180: </span>    },
<span class="linenr"> 6181: </span>    indent() {
<span class=
"linenr"> 6182: </span>      newline(++context.indentLevel)
<span class="linenr"> 6183: </span>    },
<span class=
"linenr"> 6184: </span>    deindent(withoutNewLine = <span class=
"org-constant">false</span>) {
<span class="linenr"> 6185: </span>      <span class=
"org-keyword">if</span> (withoutNewLine) {
<span class="linenr"> 6186: </span>        --context.indentLevel
<span class="linenr"> 6187: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 6188: </span>        newline(--context.indentLevel)
<span class="linenr"> 6189: </span>      }
<span class="linenr"> 6190: </span>    },
<span class="linenr"> 6191: </span>    newline() {
<span class=
"linenr"> 6192: </span>      newline(context.indentLevel)
<span class="linenr"> 6193: </span>    }
<span class="linenr"> 6194: </span>  }
<span class="linenr"> 6195: </span>
<span class="linenr"> 6196: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">newline</span>(<span class=
"org-variable-name">n</span>) {
<span class="linenr"> 6197: </span>    context.push(<span class=
"org-string">'\n'</span> + <span class=
"org-string">`  `</span>.repeat(n))
<span class="linenr"> 6198: </span>  }
<span class="linenr"> 6199: </span>
<span class="linenr"> 6200: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">addMapping</span>(<span class=
"org-variable-name">loc</span>, <span class=
"org-variable-name">name</span>) {
<span class="linenr"> 6201: </span>    context.map.addMapping({
<span class="linenr"> 6202: </span>      name,
<span class="linenr"> 6203: </span>      source: context.filename,
<span class="linenr"> 6204: </span>      original: {
<span class="linenr"> 6205: </span>        line: loc.line,
<span class=
"linenr"> 6206: </span>        column: loc.column - <span class=
"org-highlight-numbers-number">1</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">source-map column is 0 based</span>
<span class="linenr"> 6207: </span>      },
<span class="linenr"> 6208: </span>      generated: {
<span class="linenr"> 6209: </span>        line: context.line,
<span class=
"linenr"> 6210: </span>        column: context.column - <span class="org-highlight-numbers-number">1</span>
<span class="linenr"> 6211: </span>      }
<span class="linenr"> 6212: </span>    })
<span class="linenr"> 6213: </span>  }
<span class="linenr"> 6214: </span>
<span class="linenr"> 6215: </span>  <span class=
"org-keyword">return</span> context
<span class="linenr"> 6216: </span>}
<span class="linenr"> 6217: </span>
<span class="linenr"> 6218: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genModulePreamble</span>(<span class=
"org-variable-name">ast</span>, <span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">genScopeId</span>, <span class=
"org-variable-name">inline</span>) {
<span class="linenr"> 6219: </span>  <span class=
"org-keyword">const</span> {
<span class="linenr"> 6220: </span>    push,
<span class="linenr"> 6221: </span>    newline,
<span class="linenr"> 6222: </span>    optimizeImports,
<span class="linenr"> 6223: </span>    runtimeModuleName,
<span class="linenr"> 6224: </span>    ssrRuntimeModuleName
<span class="linenr"> 6225: </span>  } = context
<span class="linenr"> 6226: </span>
<span class="linenr"> 6227: </span>  <span class=
"org-keyword">if</span> (genScopeId &amp;& ast.hoists.length) {
<span class=
"linenr"> 6228: </span>    ast.helpers.push(PUSH_SCOPE_ID, POP_SCOPE_ID)
<span class="linenr"> 6229: </span>  }
<span class="linenr"> 6230: </span>
<span class="linenr"> 6231: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">generate import statements for helpers</span>
<span class="linenr"> 6232: </span>  <span class=
"org-keyword">if</span> (ast.helpers.length) {
<span class="linenr"> 6233: </span>    <span class=
"org-keyword">if</span> (optimizeImports) {
<span class="linenr"> 6234: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">when bundled with webpack with code-split, calling an import binding</span>
<span class="linenr"> 6235: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">as a function leads to it being wrapped with `Object(a.b)` or `(0,a.b)`,</span>
<span class="linenr"> 6236: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">incurring both payload size increase and potential perf overhead.</span>
<span class="linenr"> 6237: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">therefore we assign the imports to variables (which is a constant ~50b</span>
<span class="linenr"> 6238: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">cost per-component instead of scaling with template size)</span>
<span class="linenr"> 6239: </span>      push(
<span class="linenr"> 6240: </span>        <span class=
"org-string">`import { ${ast.helpers</span>
<span class="linenr"> 6241: </span><span class=
"org-string">          .map(s =&gt; helperNameMap[s])</span>
<span class="linenr"> 6242: </span><span class=
"org-string">          .join(', ')} } from ${JSON.stringify(runtimeModuleName)}\n`</span>
<span class="linenr"> 6243: </span>      )
<span class="linenr"> 6244: </span>      push(
<span class="linenr"> 6245: </span>        <span class=
"org-string">`\n// Binding optimization for webpack code-split\nconst ${ast.helpers</span>
<span class="linenr"> 6246: </span><span class=
"org-string">          .map(s =&gt; `</span>_${helperNameMap[s]} = ${helperNameMap[s]}<span class="org-string">`)</span>
<span class="linenr"> 6247: </span><span class=
"org-string">          .join(', ')}\n`</span>
<span class="linenr"> 6248: </span>      )
<span class="linenr"> 6249: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6250: </span>      push(
<span class="linenr"> 6251: </span>        <span class=
"org-string">`import { ${ast.helpers</span>
<span class="linenr"> 6252: </span><span class=
"org-string">          .map(s =&gt; `</span>${helperNameMap[s]} as _${helperNameMap[s]}<span class="org-string">`)</span>
<span class="linenr"> 6253: </span><span class=
"org-string">          .join(', ')} } from ${JSON.stringify(runtimeModuleName)}\n`</span>
<span class="linenr"> 6254: </span>      )
<span class="linenr"> 6255: </span>    }
<span class="linenr"> 6256: </span>  }
<span class="linenr"> 6257: </span>
<span class="linenr"> 6258: </span>  <span class=
"org-keyword">if</span> (ast.ssrHelpers &amp;& ast.ssrHelpers.length) {
<span class="linenr"> 6259: </span>    push(
<span class="linenr"> 6260: </span>      <span class=
"org-string">`import { ${ast.ssrHelpers</span>
<span class="linenr"> 6261: </span><span class=
"org-string">        .map(s =&gt; `</span>${helperNameMap[s]} as _${helperNameMap[s]}<span class="org-string">`)</span>
<span class="linenr"> 6262: </span><span class=
"org-string">        .join(', ')} } from "${ssrRuntimeModuleName}"\n`</span>
<span class="linenr"> 6263: </span>    )
<span class="linenr"> 6264: </span>  }
<span class="linenr"> 6265: </span>
<span class="linenr"> 6266: </span>  <span class=
"org-keyword">if</span> (ast.imports.length) {
<span class=
"linenr"> 6267: </span>    genImports(ast.imports, context)
<span class="linenr"> 6268: </span>    newline()
<span class="linenr"> 6269: </span>  }
<span class="linenr"> 6270: </span>
<span class="linenr"> 6271: </span>  genHoists(ast.hoists, context)
<span class="linenr"> 6272: </span>  newline()
<span class="linenr"> 6273: </span>
<span class="linenr"> 6274: </span>  <span class=
"org-keyword">if</span> (!inline) {
<span class="linenr"> 6275: </span>    push(<span class=
"org-string">`export `</span>)
<span class="linenr"> 6276: </span>  }
<span class="linenr"> 6277: </span>}
<span class="linenr"> 6278: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genImports</span>(<span class=
"org-variable-name">importsOptions</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6279: </span>  <span class=
"org-keyword">if</span> (!importsOptions.length) {
<span class="linenr"> 6280: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 6281: </span>  }
<span class=
"linenr"> 6282: </span>  importsOptions.forEach(imports =&gt; {
<span class="linenr"> 6283: </span>    context.push(<span class=
"org-string">`import `</span>)
<span class=
"linenr"> 6284: </span>    genNode(imports.exp, context)
<span class="linenr"> 6285: </span>    context.push(<span class=
"org-string">` from '${imports.path}'`</span>)
<span class="linenr"> 6286: </span>    context.newline()
<span class="linenr"> 6287: </span>  })
<span class="linenr"> 6288: </span>}
<span class="linenr"> 6289: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genFunctionPreamble</span>(<span class=
"org-variable-name">ast</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6290: </span>  <span class=
"org-keyword">const</span> {
<span class="linenr"> 6291: </span>    ssr,
<span class="linenr"> 6292: </span>    prefixIdentifiers,
<span class="linenr"> 6293: </span>    push,
<span class="linenr"> 6294: </span>    newline,
<span class="linenr"> 6295: </span>    runtimeModuleName,
<span class="linenr"> 6296: </span>    runtimeGlobalName,
<span class="linenr"> 6297: </span>    ssrRuntimeModuleName
<span class="linenr"> 6298: </span>  } = context
<span class="linenr"> 6299: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">VueBinding</span> =
<span class="linenr"> 6300: </span>    !__BROWSER__ &amp;& ssr
<span class="linenr"> 6301: </span>      ? <span class=
"org-string">`require(${JSON.stringify(runtimeModuleName)})`</span>
<span class="linenr"> 6302: </span>      : runtimeGlobalName
<span class="linenr"> 6303: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">aliasHelper</span> = (s) =&gt; <span class=
"org-string">`${helperNameMap[s]}: _${helperNameMap[s]}`</span>
<span class="linenr"> 6304: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Generate const declaration for helpers</span>
<span class="linenr"> 6305: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">In prefix mode, we place the const declaration at top so it's done</span>
<span class="linenr"> 6306: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">only once; But if we not prefixing, we place the declaration inside the</span>
<span class="linenr"> 6307: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">with block so it doesn't incur the `in` check cost for every helper access.</span>
<span class="linenr"> 6308: </span>  <span class=
"org-keyword">if</span> (ast.helpers.length &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 6309: </span>    <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& prefixIdentifiers) {
<span class="linenr"> 6310: </span>      push(
<span class="linenr"> 6311: </span>        <span class=
"org-string">`const { ${ast.helpers.map(aliasHelper).join(', ')} } = ${VueBinding}\n`</span>
<span class="linenr"> 6312: </span>      )
<span class="linenr"> 6313: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6314: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">"with" mode.</span>
<span class="linenr"> 6315: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">save Vue in a separate variable to avoid collision</span>
<span class="linenr"> 6316: </span>      push(<span class=
"org-string">`const _Vue = ${VueBinding}\n`</span>)
<span class="linenr"> 6317: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in "with" mode, helpers are declared inside the with block to avoid</span>
<span class="linenr"> 6318: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">has check cost, but hoists are lifted out of the function - we need</span>
<span class="linenr"> 6319: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">to provide the helper here.</span>
<span class="linenr"> 6320: </span>      <span class=
"org-keyword">if</span> (ast.hoists.length) {
<span class="linenr"> 6321: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">staticHelpers</span> = [
<span class="linenr"> 6322: </span>          CREATE_VNODE,
<span class="linenr"> 6323: </span>          CREATE_ELEMENT_VNODE,
<span class="linenr"> 6324: </span>          CREATE_COMMENT,
<span class="linenr"> 6325: </span>          CREATE_TEXT,
<span class="linenr"> 6326: </span>          CREATE_STATIC
<span class="linenr"> 6327: </span>        ]
<span class=
"linenr"> 6328: </span>          .filter(helper =&gt; ast.helpers.includes(helper))
<span class="linenr"> 6329: </span>          .map(aliasHelper)
<span class="linenr"> 6330: </span>          .join(<span class=
"org-string">', '</span>)
<span class="linenr"> 6331: </span>        push(<span class=
"org-string">`const { ${staticHelpers} } = _Vue\n`</span>)
<span class="linenr"> 6332: </span>      }
<span class="linenr"> 6333: </span>    }
<span class="linenr"> 6334: </span>  }
<span class="linenr"> 6335: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">generate variables for ssr helpers</span>
<span class="linenr"> 6336: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& ast.ssrHelpers &amp;& ast.ssrHelpers.length) {
<span class="linenr"> 6337: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">ssr guarantees prefixIdentifier: true</span>
<span class="linenr"> 6338: </span>    push(
<span class="linenr"> 6339: </span>      <span class=
"org-string">`const { ${ast.ssrHelpers</span>
<span class="linenr"> 6340: </span><span class=
"org-string">        .map(aliasHelper)</span>
<span class="linenr"> 6341: </span><span class=
"org-string">        .join(', ')} } = require("${ssrRuntimeModuleName}")\n`</span>
<span class="linenr"> 6342: </span>    )
<span class="linenr"> 6343: </span>  }
<span class="linenr"> 6344: </span>  genHoists(ast.hoists, context)
<span class="linenr"> 6345: </span>  newline()
<span class="linenr"> 6346: </span>  push(<span class=
"org-string">`return `</span>)
<span class="linenr"> 6347: </span>}
<span class="linenr"> 6348: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genHoists</span>(<span class=
"org-variable-name">hoists</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6349: </span>  <span class=
"org-keyword">if</span> (!hoists.length) {
<span class="linenr"> 6350: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 6351: </span>  }
<span class="linenr"> 6352: </span>  context.pure = <span class=
"org-constant">true</span>
<span class="linenr"> 6353: </span>  <span class=
"org-keyword">const</span> { push, newline, helper, scopeId, mode } = context
<span class="linenr"> 6354: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">genScopeId</span> = !__BROWSER__ &amp;& scopeId != <span class="org-constant">null</span> &amp;& mode !== <span class="org-string">'function'</span>
<span class="linenr"> 6355: </span>  newline()
<span class="linenr"> 6356: </span>
<span class="linenr"> 6357: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">generate inlined withScopeId helper</span>
<span class="linenr"> 6358: </span>  <span class=
"org-keyword">if</span> (genScopeId) {
<span class="linenr"> 6359: </span>    push(
<span class="linenr"> 6360: </span>      <span class=
"org-string">`const _withScopeId = n =&gt; (${helper(</span>
<span class="linenr"> 6361: </span><span class=
"org-string">        PUSH_SCOPE_ID</span>
<span class="linenr"> 6362: </span><span class=
"org-string">      )}("${scopeId}"),n=n(),${helper(POP_SCOPE_ID)}(),n)`</span>
<span class="linenr"> 6363: </span>    )
<span class="linenr"> 6364: </span>    newline()
<span class="linenr"> 6365: </span>  }
<span class="linenr"> 6366: </span>
<span class="linenr"> 6367: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; hoists.length; i++) {
<span class="linenr"> 6368: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exp</span> = hoists[i]
<span class="linenr"> 6369: </span>    <span class=
"org-keyword">if</span> (exp) {
<span class="linenr"> 6370: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">needScopeIdWrapper</span> = genScopeId &amp;& exp.type === NodeTypes.VNODE_CALL
<span class="linenr"> 6371: </span>      push(
<span class="linenr"> 6372: </span>        <span class=
"org-string">`const _hoisted_${i + 1} = ${</span>
<span class="linenr"> 6373: </span><span class=
"org-string">          needScopeIdWrapper ? `</span>${PURE_ANNOTATION} _withScopeId(() =&gt; <span class="org-string">` : ``</span>
<span class="linenr"> 6374: </span><span class=
"org-string">        }`</span>
<span class="linenr"> 6375: </span>      )
<span class="linenr"> 6376: </span>      genNode(exp, context)
<span class="linenr"> 6377: </span>      <span class=
"org-keyword">if</span> (needScopeIdWrapper) {
<span class="linenr"> 6378: </span>        push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6379: </span>      }
<span class="linenr"> 6380: </span>      newline()
<span class="linenr"> 6381: </span>    }
<span class="linenr"> 6382: </span>  }
<span class="linenr"> 6383: </span>
<span class="linenr"> 6384: </span>  context.pure = <span class=
"org-constant">false</span>
<span class="linenr"> 6385: </span>}
<span class="linenr"> 6386: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">type = 'component' | 'directive' | 'filter'</span>
<span class="linenr"> 6387: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genAssets</span>(<span class=
"org-variable-name">assets</span>, <span class=
"org-variable-name">type</span>, { <span class=
"org-variable-name">helper</span>, <span class=
"org-variable-name">push</span>, <span class=
"org-variable-name">newline</span>, <span class=
"org-variable-name">isTS</span> }) {
<span class="linenr"> 6388: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">resolver</span> = helper(
<span class="linenr"> 6389: </span>    type === <span class=
"org-string">'component'</span>
<span class="linenr"> 6390: </span>      ? RESOLVE_COMPONENT
<span class="linenr"> 6391: </span>      : RESOLVE_DIRECTIVE
<span class="linenr"> 6392: </span>  )
<span class="linenr"> 6393: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; assets.length; i++) {
<span class="linenr"> 6394: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">id</span> = assets[i]
<span class="linenr"> 6395: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">potential component implicit self-reference inferred from SFC filename</span>
<span class="linenr"> 6396: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">maybeSelfReference</span> = id.endsWith(<span class="org-string">'__self'</span>)
<span class="linenr"> 6397: </span>    <span class=
"org-keyword">if</span> (maybeSelfReference) {
<span class="linenr"> 6398: </span>      id = id.slice(<span class=
"org-highlight-numbers-number">0</span>, -<span class=
"org-highlight-numbers-number">6</span>)
<span class="linenr"> 6399: </span>    }
<span class="linenr"> 6400: </span>    push(
<span class="linenr"> 6401: </span>      <span class=
"org-string">`const ${toValidAssetId(id, type)} = ${resolver}(${JSON.stringify(id)}${</span>
<span class="linenr"> 6402: </span><span class=
"org-string">        maybeSelfReference ? `</span>, <span class=
"org-constant">true</span><span class="org-string">` : ``</span>
<span class="linenr"> 6403: </span><span class=
"org-string">      })${isTS ? `</span>!<span class=
"org-string">` : ``}`</span>
<span class="linenr"> 6404: </span>    )
<span class="linenr"> 6405: </span>    <span class=
"org-keyword">if</span> (i &lt; assets.length - <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 6406: </span>      newline()
<span class="linenr"> 6407: </span>    }
<span class="linenr"> 6408: </span>  }
<span class="linenr"> 6409: </span>}
<span class="linenr"> 6410: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genText</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class=
"linenr"> 6411: </span>  context.push(JSON.stringify(node.content), node)
<span class="linenr"> 6412: </span>}
<span class="linenr"> 6413: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6414: </span>  <span class=
"org-keyword">const</span> { content, isStatic } = node
<span class=
"linenr"> 6415: </span>  context.push(isStatic ? JSON.stringify(content) : content, node)
<span class="linenr"> 6416: </span>}
<span class="linenr"> 6417: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genInterpolation</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6418: </span>  <span class=
"org-keyword">const</span> { push, helper, pure } = context
<span class="linenr"> 6419: </span>  <span class=
"org-keyword">if</span> (pure) push(PURE_ANNOTATION)
<span class="linenr"> 6420: </span>  push(<span class=
"org-string">`${helper(TO_DISPLAY_STRING)}(`</span>)
<span class="linenr"> 6421: </span>  genNode(node.content, context)
<span class="linenr"> 6422: </span>  push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6423: </span>}
<span class="linenr"> 6424: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genCompoundExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6425: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.children.length; i++) {
<span class="linenr"> 6426: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = node.children[i]
<span class="linenr"> 6427: </span>    <span class=
"org-keyword">if</span> (isString(child)) {
<span class="linenr"> 6428: </span>      context.push(child)
<span class="linenr"> 6429: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6430: </span>      genNode(child, context)
<span class="linenr"> 6431: </span>    }
<span class="linenr"> 6432: </span>  }
<span class="linenr"> 6433: </span>}
<span class="linenr"> 6434: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genComment</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6435: </span>  <span class=
"org-keyword">const</span> { push, helper, pure } = context
<span class="linenr"> 6436: </span>  <span class=
"org-keyword">if</span> (pure) {
<span class="linenr"> 6437: </span>    push(PURE_ANNOTATION)
<span class="linenr"> 6438: </span>  }
<span class="linenr"> 6439: </span>  push(<span class=
"org-string">`${helper(CREATE_COMMENT)}(${JSON.stringify(node.content)})`</span>, node)
<span class="linenr"> 6440: </span>}
<span class="linenr"> 6441: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genVNodeCall</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6442: </span>  <span class=
"org-keyword">const</span> { push, helper, pure } = context
<span class="linenr"> 6443: </span>  <span class=
"org-keyword">const</span> {
<span class="linenr"> 6444: </span>    tag,
<span class="linenr"> 6445: </span>    props,
<span class="linenr"> 6446: </span>    children,
<span class="linenr"> 6447: </span>    patchFlag,
<span class="linenr"> 6448: </span>    dynamicProps,
<span class="linenr"> 6449: </span>    directives,
<span class="linenr"> 6450: </span>    isBlock,
<span class="linenr"> 6451: </span>    disableTracking,
<span class="linenr"> 6452: </span>    isComponent
<span class="linenr"> 6453: </span>  } = node
<span class="linenr"> 6454: </span>  <span class=
"org-keyword">if</span> (directives) {
<span class=
"linenr"> 6455: </span>    push(helper(WITH_DIRECTIVES) + <span class="org-string">`(`</span>)
<span class="linenr"> 6456: </span>  }
<span class="linenr"> 6457: </span>  <span class=
"org-keyword">if</span> (isBlock) {
<span class="linenr"> 6458: </span>    push(<span class=
"org-string">`(${helper(OPEN_BLOCK)}(${disableTracking ? `</span><span class="org-constant">true</span><span class="org-string">` : ``}), `</span>)
<span class="linenr"> 6459: </span>  }
<span class="linenr"> 6460: </span>  <span class=
"org-keyword">if</span> (pure) {
<span class="linenr"> 6461: </span>    push(PURE_ANNOTATION)
<span class="linenr"> 6462: </span>  }
<span class="linenr"> 6463: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">callHelper</span> = isBlock
<span class=
"linenr"> 6464: </span>    ? getVNodeBlockHelper(context.inSSR, isComponent)
<span class=
"linenr"> 6465: </span>    : getVNodeHelper(context.inSSR, isComponent)
<span class=
"linenr"> 6466: </span>  push(helper(callHelper) + <span class=
"org-string">`(`</span>, node)
<span class="linenr"> 6467: </span>  genNodeList(
<span class=
"linenr"> 6468: </span>    genNullableArgs([tag, props, children, patchFlag, dynamicProps]),
<span class="linenr"> 6469: </span>    context
<span class="linenr"> 6470: </span>  )
<span class="linenr"> 6471: </span>  push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6472: </span>  <span class=
"org-keyword">if</span> (isBlock) {
<span class="linenr"> 6473: </span>    push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6474: </span>  }
<span class="linenr"> 6475: </span>  <span class=
"org-keyword">if</span> (directives) {
<span class="linenr"> 6476: </span>    push(<span class=
"org-string">`, `</span>)
<span class="linenr"> 6477: </span>    genNode(directives, context)
<span class="linenr"> 6478: </span>    push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6479: </span>  }
<span class="linenr"> 6480: </span>}
<span class="linenr"> 6481: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">JavaScript</span>
<span class="linenr"> 6482: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genCallExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6483: </span>  <span class=
"org-keyword">const</span> { push, helper, pure } = context
<span class="linenr"> 6484: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">callee</span> = isString(node.callee) ? node.callee : helper(node.callee)
<span class="linenr"> 6485: </span>  <span class=
"org-keyword">if</span> (pure) {
<span class="linenr"> 6486: </span>    push(PURE_ANNOTATION)
<span class="linenr"> 6487: </span>  }
<span class="linenr"> 6488: </span>  push(callee + <span class=
"org-string">`(`</span>, node)
<span class="linenr"> 6489: </span>  genNodeList(node.<span class=
"org-constant">arguments</span>, context)
<span class="linenr"> 6490: </span>  push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6491: </span>}
<span class="linenr"> 6492: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genObjectExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6493: </span>  <span class=
"org-keyword">const</span> { push, indent, deindent, newline } = context
<span class="linenr"> 6494: </span>  <span class=
"org-keyword">const</span> { properties } = node
<span class="linenr"> 6495: </span>  <span class=
"org-keyword">if</span> (!properties.length) {
<span class="linenr"> 6496: </span>    push(<span class=
"org-string">`{}`</span>, node)
<span class="linenr"> 6497: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 6498: </span>  }
<span class="linenr"> 6499: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">multilines</span> =
<span class=
"linenr"> 6500: </span>    properties.length &gt; <span class=
"org-highlight-numbers-number">1</span> ||
<span class=
"linenr"> 6501: </span>    ((!__BROWSER__ || __DEV__) &amp;&
<span class=
"linenr"> 6502: </span>      properties.some(p =&gt; p.value.type !== NodeTypes.SIMPLE_EXPRESSION))
<span class="linenr"> 6503: </span>  push(multilines ? <span class=
"org-string">`{`</span> : <span class="org-string">`{ `</span>)
<span class="linenr"> 6504: </span>  multilines &amp;& indent()
<span class="linenr"> 6505: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; properties.length; i++) {
<span class="linenr"> 6506: </span>    <span class=
"org-keyword">const</span> { key, value } = properties[i]
<span class="linenr"> 6507: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">key</span>
<span class=
"linenr"> 6508: </span>    genExpressionAsPropertyKey(key, context)
<span class="linenr"> 6509: </span>    push(<span class=
"org-string">`: `</span>)
<span class="linenr"> 6510: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">value</span>
<span class="linenr"> 6511: </span>    genNode(value, context)
<span class="linenr"> 6512: </span>    <span class=
"org-keyword">if</span> (i &lt; properties.length - <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 6513: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">will only reach this if it's multilines</span>
<span class="linenr"> 6514: </span>      push(<span class=
"org-string">`,`</span>)
<span class="linenr"> 6515: </span>      newline()
<span class="linenr"> 6516: </span>    }
<span class="linenr"> 6517: </span>  }
<span class="linenr"> 6518: </span>  multilines &amp;& deindent()
<span class="linenr"> 6519: </span>  push(multilines ? <span class=
"org-string">`}`</span> : <span class="org-string">` }`</span>)
<span class="linenr"> 6520: </span>}
<span class="linenr"> 6521: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genArrayExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class=
"linenr"> 6522: </span>  genNodeListAsArray(node.elements, context)
<span class="linenr"> 6523: </span>}
<span class="linenr"> 6524: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genFunctionExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6525: </span>  <span class=
"org-keyword">const</span> { push, indent, deindent } = context
<span class="linenr"> 6526: </span>  <span class=
"org-keyword">const</span> { params, returns, body, newline, isSlot } = node
<span class="linenr"> 6527: </span>  <span class=
"org-keyword">if</span> (isSlot) {
<span class="linenr"> 6528: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">wrap slot functions with owner context</span>
<span class="linenr"> 6529: </span>    push(<span class=
"org-string">`_${helperNameMap[WITH_CTX]}(`</span>)
<span class="linenr"> 6530: </span>  }
<span class="linenr"> 6531: </span>  push(<span class=
"org-string">`(`</span>, node)
<span class="linenr"> 6532: </span>  <span class=
"org-keyword">if</span> (isArray(params)) {
<span class="linenr"> 6533: </span>    genNodeList(params, context)
<span class="linenr"> 6534: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (params) {
<span class="linenr"> 6535: </span>    genNode(params, context)
<span class="linenr"> 6536: </span>  }
<span class="linenr"> 6537: </span>  push(<span class=
"org-string">`) =&gt; `</span>)
<span class="linenr"> 6538: </span>  <span class=
"org-keyword">if</span> (newline || body) {
<span class="linenr"> 6539: </span>    push(<span class=
"org-string">`{`</span>)
<span class="linenr"> 6540: </span>    indent()
<span class="linenr"> 6541: </span>  }
<span class="linenr"> 6542: </span>  <span class=
"org-keyword">if</span> (returns) {
<span class="linenr"> 6543: </span>    <span class=
"org-keyword">if</span> (newline) {
<span class="linenr"> 6544: </span>      push(<span class=
"org-string">`return `</span>)
<span class="linenr"> 6545: </span>    }
<span class="linenr"> 6546: </span>    <span class=
"org-keyword">if</span> (isArray(returns)) {
<span class=
"linenr"> 6547: </span>      genNodeListAsArray(returns, context)
<span class="linenr"> 6548: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6549: </span>      genNode(returns, context)
<span class="linenr"> 6550: </span>    }
<span class="linenr"> 6551: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (body) {
<span class="linenr"> 6552: </span>    genNode(body, context)
<span class="linenr"> 6553: </span>  }
<span class="linenr"> 6554: </span>  <span class=
"org-keyword">if</span> (newline || body) {
<span class="linenr"> 6555: </span>    deindent()
<span class="linenr"> 6556: </span>    push(<span class=
"org-string">`}`</span>)
<span class="linenr"> 6557: </span>  }
<span class="linenr"> 6558: </span>  <span class=
"org-keyword">if</span> (isSlot) {
<span class="linenr"> 6559: </span>    push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6560: </span>  }
<span class="linenr"> 6561: </span>}
<span class="linenr"> 6562: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genConditionalExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6563: </span>  <span class=
"org-keyword">const</span> { test, consequent, alternate, newline: needNewline } = node
<span class="linenr"> 6564: </span>  <span class=
"org-keyword">const</span> { push, indent, deindent, newline } = context
<span class="linenr"> 6565: </span>  <span class=
"org-keyword">if</span> (test.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 6566: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">needsParens</span> = !isSimpleIdentifier(test.content)
<span class=
"linenr"> 6567: </span>    needsParens &amp;& push(<span class=
"org-string">`(`</span>)
<span class="linenr"> 6568: </span>    genExpression(test, context)
<span class=
"linenr"> 6569: </span>    needsParens &amp;& push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6570: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6571: </span>    push(<span class=
"org-string">`(`</span>)
<span class="linenr"> 6572: </span>    genNode(test, context)
<span class="linenr"> 6573: </span>    push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6574: </span>  }
<span class="linenr"> 6575: </span>  needNewline &amp;& indent()
<span class="linenr"> 6576: </span>  context.indentLevel++
<span class=
"linenr"> 6577: </span>  needNewline || push(<span class=
"org-string">` `</span>)
<span class="linenr"> 6578: </span>  push(<span class=
"org-string">`? `</span>)
<span class="linenr"> 6579: </span>  genNode(consequent, context)
<span class="linenr"> 6580: </span>  context.indentLevel--
<span class="linenr"> 6581: </span>  needNewline &amp;& newline()
<span class=
"linenr"> 6582: </span>  needNewline || push(<span class=
"org-string">` `</span>)
<span class="linenr"> 6583: </span>  push(<span class=
"org-string">`: `</span>)
<span class="linenr"> 6584: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isNested</span> = alternate.type === NodeTypes.JS_CONDITIONAL_EXPRESSION
<span class="linenr"> 6585: </span>  <span class=
"org-keyword">if</span> (!isNested) {
<span class="linenr"> 6586: </span>    context.indentLevel++
<span class="linenr"> 6587: </span>  }
<span class="linenr"> 6588: </span>  genNode(alternate, context)
<span class="linenr"> 6589: </span>  <span class=
"org-keyword">if</span> (!isNested) {
<span class="linenr"> 6590: </span>    context.indentLevel--
<span class="linenr"> 6591: </span>  }
<span class=
"linenr"> 6592: </span>  needNewline &amp;& deindent(<span class=
"org-constant">true</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">without newline</span><span class=
"org-comment-delimiter"> */</span>)
<span class="linenr"> 6593: </span>}
<span class="linenr"> 6594: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genCacheExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6595: </span>  <span class=
"org-keyword">const</span> { push, helper, indent, deindent, newline } = context
<span class="linenr"> 6596: </span>  push(<span class=
"org-string">`_cache[${node.index}] || (`</span>)
<span class="linenr"> 6597: </span>  <span class=
"org-keyword">if</span> (node.isVNode) {
<span class="linenr"> 6598: </span>    indent()
<span class="linenr"> 6599: </span>    push(<span class=
"org-string">`${helper(SET_BLOCK_TRACKING)}(-1),`</span>)
<span class="linenr"> 6600: </span>    newline()
<span class="linenr"> 6601: </span>  }
<span class="linenr"> 6602: </span>  push(<span class=
"org-string">`_cache[${node.index}] = `</span>)
<span class="linenr"> 6603: </span>  genNode(node.value, context)
<span class="linenr"> 6604: </span>  <span class=
"org-keyword">if</span> (node.isVNode) {
<span class="linenr"> 6605: </span>    push(<span class=
"org-string">`,`</span>)
<span class="linenr"> 6606: </span>    newline()
<span class="linenr"> 6607: </span>    push(<span class=
"org-string">`${helper(SET_BLOCK_TRACKING)}(1),`</span>)
<span class="linenr"> 6608: </span>    newline()
<span class="linenr"> 6609: </span>    push(<span class=
"org-string">`_cache[${node.index}]`</span>)
<span class="linenr"> 6610: </span>    deindent()
<span class="linenr"> 6611: </span>  }
<span class="linenr"> 6612: </span>  push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6613: </span>}
<span class="linenr"> 6614: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genNodeList</span>(<span class=
"org-variable-name">nodes</span>, <span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">multilines</span> = <span class=
"org-constant">false</span>, <span class=
"org-variable-name">comma</span> = <span class=
"org-constant">true</span>) {
<span class="linenr"> 6615: </span>  <span class=
"org-keyword">const</span> { push, newline } = context
<span class="linenr"> 6616: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; nodes.length; i++) {
<span class="linenr"> 6617: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> = nodes[i]
<span class="linenr"> 6618: </span>    <span class=
"org-keyword">if</span> (isString(node)) {
<span class="linenr"> 6619: </span>      push(node)
<span class="linenr"> 6620: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isArray(node)) {
<span class=
"linenr"> 6621: </span>      genNodeListAsArray(node, context)
<span class="linenr"> 6622: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6623: </span>      genNode(node, context)
<span class="linenr"> 6624: </span>    }
<span class="linenr"> 6625: </span>    <span class=
"org-keyword">if</span> (i &lt; nodes.length - <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 6626: </span>      <span class=
"org-keyword">if</span> (multilines) {
<span class=
"linenr"> 6627: </span>        comma &amp;& push(<span class=
"org-string">','</span>)
<span class="linenr"> 6628: </span>        newline()
<span class="linenr"> 6629: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 6630: </span>        comma &amp;& push(<span class=
"org-string">', '</span>)
<span class="linenr"> 6631: </span>      }
<span class="linenr"> 6632: </span>    }
<span class="linenr"> 6633: </span>  }
<span class="linenr"> 6634: </span>}
<span class="linenr"> 6635: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genTemplateLiteral</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6636: </span>  <span class=
"org-keyword">const</span> { push, indent, deindent } = context
<span class="linenr"> 6637: </span>  push(<span class=
"org-string">'`'</span>)
<span class="linenr"> 6638: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">l</span> = node.elements.length
<span class="linenr"> 6639: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">multilines</span> = l &gt; <span class=
"org-highlight-numbers-number">3</span>
<span class="linenr"> 6640: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; l; i++) {
<span class="linenr"> 6641: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">e</span> = node.elements[i]
<span class="linenr"> 6642: </span>    <span class=
"org-keyword">if</span> (isString(e)) {
<span class=
"linenr"> 6643: </span>      push(e.replace(<span class="org-string">/(`|\$|\\)/</span>g, <span class="org-string">'\\$1'</span>))
<span class="linenr"> 6644: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6645: </span>      push(<span class=
"org-string">'${'</span>)
<span class="linenr"> 6646: </span>      <span class=
"org-keyword">if</span> (multilines) indent()
<span class="linenr"> 6647: </span>      genNode(e, context)
<span class="linenr"> 6648: </span>      <span class=
"org-keyword">if</span> (multilines) deindent()
<span class="linenr"> 6649: </span>      push(<span class=
"org-string">'}'</span>)
<span class="linenr"> 6650: </span>    }
<span class="linenr"> 6651: </span>  }
<span class="linenr"> 6652: </span>  push(<span class=
"org-string">'`'</span>)
<span class="linenr"> 6653: </span>}
<span class="linenr"> 6654: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genIfStatement</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6655: </span>  <span class=
"org-keyword">const</span> { push, indent, deindent } = context
<span class="linenr"> 6656: </span>  <span class=
"org-keyword">const</span> { test, consequent, alternate } = node
<span class="linenr"> 6657: </span>  push(<span class=
"org-string">`if (`</span>)
<span class="linenr"> 6658: </span>  genNode(test, context)
<span class="linenr"> 6659: </span>  push(<span class=
"org-string">`) {`</span>)
<span class="linenr"> 6660: </span>  indent()
<span class="linenr"> 6661: </span>  genNode(consequent, context)
<span class="linenr"> 6662: </span>  deindent()
<span class="linenr"> 6663: </span>  push(<span class=
"org-string">`}`</span>)
<span class="linenr"> 6664: </span>  <span class=
"org-keyword">if</span> (alternate) {
<span class="linenr"> 6665: </span>    push(<span class=
"org-string">` else `</span>)
<span class="linenr"> 6666: </span>    <span class=
"org-keyword">if</span> (alternate.type === NodeTypes.JS_IF_STATEMENT) {
<span class=
"linenr"> 6667: </span>      genIfStatement(alternate, context)
<span class="linenr"> 6668: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6669: </span>      push(<span class=
"org-string">`{`</span>)
<span class="linenr"> 6670: </span>      indent()
<span class=
"linenr"> 6671: </span>      genNode(alternate, context)
<span class="linenr"> 6672: </span>      deindent()
<span class="linenr"> 6673: </span>      push(<span class=
"org-string">`}`</span>)
<span class="linenr"> 6674: </span>    }
<span class="linenr"> 6675: </span>  }
<span class="linenr"> 6676: </span>}
<span class="linenr"> 6677: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genAssignmentExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6678: </span>  genNode(node.left, context)
<span class="linenr"> 6679: </span>  context.push(<span class=
"org-string">` = `</span>)
<span class="linenr"> 6680: </span>  genNode(node.right, context)
<span class="linenr"> 6681: </span>}
<span class="linenr"> 6682: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genSequenceExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6683: </span>  context.push(<span class=
"org-string">`(`</span>)
<span class=
"linenr"> 6684: </span>  genNodeList(node.expressions, context)
<span class="linenr"> 6685: </span>  context.push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6686: </span>}
<span class="linenr"> 6687: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genReturnStatement</span>({ returns }, context) {
<span class="linenr"> 6688: </span>  context.push(<span class=
"org-string">`return `</span>)
<span class="linenr"> 6689: </span>  <span class=
"org-keyword">if</span> (isArray(returns)) {
<span class=
"linenr"> 6690: </span>    genNodeListAsArray(returns, context)
<span class="linenr"> 6691: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6692: </span>    genNode(returns, context)
<span class="linenr"> 6693: </span>  }
<span class="linenr"> 6694: </span>}
<span class="linenr"> 6695: </span>
<span class="linenr"> 6696: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genNode</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6697: </span>  <span class=
"org-keyword">if</span> (isString(node)) {
<span class="linenr"> 6698: </span>    context.push(node)
<span class="linenr"> 6699: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 6700: </span>  }
<span class="linenr"> 6701: </span>  <span class=
"org-keyword">if</span> (isSymbol(node)) {
<span class=
"linenr"> 6702: </span>    context.push(context.helper(node))
<span class="linenr"> 6703: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 6704: </span>  }
<span class="linenr"> 6705: </span>  <span class=
"org-keyword">switch</span> (node.type) {
<span class="linenr"> 6706: </span>    <span class=
"org-keyword">case</span> NodeTypes.ELEMENT:
<span class="linenr"> 6707: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF:
<span class="linenr"> 6708: </span>    <span class=
"org-keyword">case</span> NodeTypes.FOR:
<span class=
"linenr"> 6709: </span>      genNode(node.codegenNode, context)
<span class="linenr"> 6710: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6711: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT:
<span class="linenr"> 6712: </span>      genText(node, context)
<span class="linenr"> 6713: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6714: </span>    <span class=
"org-keyword">case</span> NodeTypes.SIMPLE_EXPRESSION:
<span class=
"linenr"> 6715: </span>      genExpression(node, context)
<span class="linenr"> 6716: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6717: </span>    <span class=
"org-keyword">case</span> NodeTypes.INTERPOLATION:
<span class=
"linenr"> 6718: </span>      genInterpolation(node, context)
<span class="linenr"> 6719: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6720: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT_CALL:
<span class=
"linenr"> 6721: </span>      genNode(node.codegenNode, context)
<span class="linenr"> 6722: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6723: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMPOUND_EXPRESSION:
<span class=
"linenr"> 6724: </span>      genCompoundExpression(node, context)
<span class="linenr"> 6725: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6726: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMMENT:
<span class="linenr"> 6727: </span>      genComment(node, context)
<span class="linenr"> 6728: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6729: </span>    <span class=
"org-keyword">case</span> NodeTypes.VNODE_CALL:
<span class=
"linenr"> 6730: </span>      genVNodeCall(node, context)
<span class="linenr"> 6731: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6732: </span>
<span class="linenr"> 6733: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_CALL_EXPRESSION:
<span class=
"linenr"> 6734: </span>      genCallExpression(node, context)
<span class="linenr"> 6735: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6736: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_OBJECT_EXPRESSION:
<span class=
"linenr"> 6737: </span>      genObjectExpression(node, context)
<span class="linenr"> 6738: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6739: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_ARRAY_EXPRESSION:
<span class=
"linenr"> 6740: </span>      genArrayExpression(node, context)
<span class="linenr"> 6741: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6742: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_FUNCTION_EXPRESSION:
<span class=
"linenr"> 6743: </span>      genFunctionExpression(node, context)
<span class="linenr"> 6744: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6745: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_CONDITIONAL_EXPRESSION:
<span class=
"linenr"> 6746: </span>      genConditionalExpression(node, context)
<span class="linenr"> 6747: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6748: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_CACHE_EXPRESSION:
<span class=
"linenr"> 6749: </span>      genCacheExpression(node, context)
<span class="linenr"> 6750: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6751: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_BLOCK_STATEMENT:
<span class=
"linenr"> 6752: </span>      genNodeList(node.body, context, <span class="org-constant">true</span>, <span class="org-constant">false</span>)
<span class="linenr"> 6753: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6754: </span>
<span class="linenr"> 6755: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">SSR only types</span>
<span class="linenr"> 6756: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_TEMPLATE_LITERAL:
<span class=
"linenr"> 6757: </span>      !__BROWSER__ &amp;& genTemplateLiteral(node, context)
<span class="linenr"> 6758: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6759: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_IF_STATEMENT:
<span class=
"linenr"> 6760: </span>      !__BROWSER__ &amp;& genIfStatement(node, context)
<span class="linenr"> 6761: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6762: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_ASSIGNMENT_EXPRESSION:
<span class=
"linenr"> 6763: </span>      !__BROWSER__ &amp;& genAssignmentExpression(node, context)
<span class="linenr"> 6764: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6765: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_SEQUENCE_EXPRESSION:
<span class=
"linenr"> 6766: </span>      !__BROWSER__ &amp;& genSequenceExpression(node, context)
<span class="linenr"> 6767: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6768: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_RETURN_STATEMENT:
<span class=
"linenr"> 6769: </span>      !__BROWSER__ &amp;& genReturnStatement(node, context)
<span class="linenr"> 6770: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6771: </span>
<span class="linenr"> 6772: </span>    <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">istanbul ignore next</span><span class=
"org-comment-delimiter"> */</span>
<span class="linenr"> 6773: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF_BRANCH:
<span class="linenr"> 6774: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">noop</span>
<span class="linenr"> 6775: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6776: </span>    <span class=
"org-keyword">default</span>:
<span class="linenr"> 6777: </span>      logg(<span class=
"org-string">`unhandled codegen node type: ${node.type}`</span>)
<span class="linenr"> 6778: </span>  }
<span class="linenr"> 6779: </span>}
<span class="linenr"> 6780: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genNodeListAsArray</span>(<span class=
"org-variable-name">nodes</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6781: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">multilines</span> =
<span class=
"linenr"> 6782: </span>    nodes.length &gt; <span class=
"org-highlight-numbers-number">3</span> ||
<span class=
"linenr"> 6783: </span>    ((!__BROWSER__ || __DEV__) &amp;& nodes.some(n =&gt; isArray(n) || !isText(n)))
<span class="linenr"> 6784: </span>  context.push(<span class=
"org-string">`[`</span>)
<span class=
"linenr"> 6785: </span>  multilines &amp;& context.indent()
<span class=
"linenr"> 6786: </span>  genNodeList(nodes, context, multilines)
<span class=
"linenr"> 6787: </span>  multilines &amp;& context.deindent()
<span class="linenr"> 6788: </span>  context.push(<span class=
"org-string">`]`</span>)
<span class="linenr"> 6789: </span>}
<span class="linenr"> 6790: </span>
<span class="linenr"> 6791: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">generate</span>(<span class=
"org-variable-name">ast</span>, <span class=
"org-variable-name">options</span> = {}) {
<span class="linenr"> 6792: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">context</span> = createCodegenContext(ast, options)
<span class="linenr"> 6793: </span>  <span class=
"org-keyword">if</span> (options.onContextCreated) options.onContextCreated(context)
<span class="linenr"> 6794: </span>  <span class=
"org-keyword">const</span> {
<span class="linenr"> 6795: </span>    mode,
<span class="linenr"> 6796: </span>    push,
<span class="linenr"> 6797: </span>    prefixIdentifiers,
<span class="linenr"> 6798: </span>    indent,
<span class="linenr"> 6799: </span>    deindent,
<span class="linenr"> 6800: </span>    newline,
<span class="linenr"> 6801: </span>    scopeId,
<span class="linenr"> 6802: </span>    ssr
<span class="linenr"> 6803: </span>  } = context
<span class="linenr"> 6804: </span>
<span class="linenr"> 6805: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hasHelpers</span> = ast.helpers.length &gt; <span class="org-highlight-numbers-number">0</span>
<span class="linenr"> 6806: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">useWithBlock</span> = !prefixIdentifiers &amp;& mode !== <span class="org-string">'module'</span>
<span class="linenr"> 6807: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">genScopeId</span> = !__BROWSER__ &amp;& scopeId != <span class="org-constant">null</span> &amp;& mode === <span class="org-string">'module'</span>
<span class="linenr"> 6808: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSetupInlined</span> = !__BROWSER__ &amp;& !!options.inline
<span class="linenr"> 6809: </span>
<span class="linenr"> 6810: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">preambles</span>
<span class="linenr"> 6811: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in setup() inline mode, the preamble is generated in a sub context</span>
<span class="linenr"> 6812: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">and returned separately.</span>
<span class="linenr"> 6813: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">preambleContext</span> = isSetupInlined
<span class=
"linenr"> 6814: </span>    ? createCodegenContext(ast, options)
<span class="linenr"> 6815: </span>    : context
<span class="linenr"> 6816: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& mode === <span class=
"org-string">'module'</span>) {
<span class=
"linenr"> 6817: </span>    genModulePreamble(ast, preambleContext, genScopeId, isSetupInlined)
<span class="linenr"> 6818: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 6819: </span>    genFunctionPreamble(ast, preambleContext)
<span class="linenr"> 6820: </span>  }
<span class="linenr"> 6821: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">enter render function</span>
<span class="linenr"> 6822: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">functionName</span> = ssr ? <span class=
"org-string">`ssrRender`</span> : <span class=
"org-string">`render`</span>
<span class="linenr"> 6823: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">args</span> = ssr ? [<span class=
"org-string">'_ctx'</span>, <span class=
"org-string">'_push'</span>, <span class=
"org-string">'_parent'</span>, <span class=
"org-string">'_attrs'</span>] : [<span class=
"org-string">'_ctx'</span>, <span class=
"org-string">'_cache'</span>]
<span class="linenr"> 6824: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& options.bindingMetadata &amp;& !options.inline) {
<span class="linenr"> 6825: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">binding optimization args</span>
<span class="linenr"> 6826: </span>    args.push(<span class=
"org-string">'$props'</span>, <span class=
"org-string">'$setup'</span>, <span class=
"org-string">'$data'</span>, <span class=
"org-string">'$options'</span>)
<span class="linenr"> 6827: </span>  }
<span class="linenr"> 6828: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">signature</span> =
<span class=
"linenr"> 6829: </span>    !__BROWSER__ &amp;& options.isTS
<span class=
"linenr"> 6830: </span>      ? args.map(arg =&gt; <span class=
"org-string">`${arg}: any`</span>).join(<span class=
"org-string">','</span>)
<span class="linenr"> 6831: </span>      : args.join(<span class=
"org-string">', '</span>)
<span class="linenr"> 6832: </span>
<span class="linenr"> 6833: </span>  <span class=
"org-keyword">if</span> (isSetupInlined) {
<span class="linenr"> 6834: </span>    push(<span class=
"org-string">`(${signature}) =&gt; {`</span>)
<span class="linenr"> 6835: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6836: </span>    push(<span class=
"org-string">`function ${functionName}(${signature}) {`</span>)
<span class="linenr"> 6837: </span>  }
<span class="linenr"> 6838: </span>  indent()
<span class="linenr"> 6839: </span>
<span class="linenr"> 6840: </span>  <span class=
"org-keyword">if</span> (useWithBlock) {
<span class="linenr"> 6841: </span>    push(<span class=
"org-string">`with (_ctx) {`</span>)
<span class="linenr"> 6842: </span>    indent()
<span class="linenr"> 6843: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">function mode const declarations should be inside with block</span>
<span class="linenr"> 6844: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">also they should be renamed to avoid collision with user properties</span>
<span class="linenr"> 6845: </span>    <span class=
"org-keyword">if</span> (hasHelpers) {
<span class="linenr"> 6846: </span>      push(
<span class="linenr"> 6847: </span>        <span class=
"org-string">`const { ${ast.helpers</span>
<span class="linenr"> 6848: </span><span class=
"org-string">          .map(s =&gt; `</span>${helperNameMap[s]}: _${helperNameMap[s]}<span class="org-string">`)</span>
<span class="linenr"> 6849: </span><span class=
"org-string">          .join(', ')} } = _Vue`</span>
<span class="linenr"> 6850: </span>      )
<span class="linenr"> 6851: </span>      push(<span class=
"org-string">`\n`</span>)
<span class="linenr"> 6852: </span>      newline()
<span class="linenr"> 6853: </span>    }
<span class="linenr"> 6854: </span>  }
<span class="linenr"> 6855: </span>
<span class="linenr"> 6856: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">generate asset resolution statements</span>
<span class="linenr"> 6857: </span>  <span class=
"org-keyword">if</span> (ast.components.length) {
<span class=
"linenr"> 6858: </span>    genAssets(ast.components, <span class=
"org-string">'component'</span>, context)
<span class="linenr"> 6859: </span>    <span class=
"org-keyword">if</span> (ast.directives.length || ast.temps &gt; <span class="org-highlight-numbers-number">0</span>) {
<span class="linenr"> 6860: </span>      newline()
<span class="linenr"> 6861: </span>    }
<span class="linenr"> 6862: </span>  }
<span class="linenr"> 6863: </span>  <span class=
"org-keyword">if</span> (ast.directives.length) {
<span class=
"linenr"> 6864: </span>    genAssets(ast.directives, <span class=
"org-string">'directive'</span>, context)
<span class="linenr"> 6865: </span>    <span class=
"org-keyword">if</span> (ast.temps &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 6866: </span>      newline()
<span class="linenr"> 6867: </span>    }
<span class="linenr"> 6868: </span>  }
<span class="linenr"> 6869: </span>
<span class="linenr"> 6870: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">临时变量</span>
<span class="linenr"> 6871: </span>  <span class=
"org-keyword">if</span> (ast.temps &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 6872: </span>    push(<span class=
"org-string">`let `</span>)
<span class="linenr"> 6873: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; ast.temps; i++) {
<span class="linenr"> 6874: </span>      push(<span class=
"org-string">`${i &gt; 0 ? `</span>, <span class=
"org-string">` : ``}_temp${i}`</span>)
<span class="linenr"> 6875: </span>    }
<span class="linenr"> 6876: </span>  }
<span class="linenr"> 6877: </span>  <span class=
"org-keyword">if</span> (ast.components.length || ast.directives.length || ast.temps) {
<span class="linenr"> 6878: </span>    push(<span class=
"org-string">`\n`</span>)
<span class="linenr"> 6879: </span>    newline()
<span class="linenr"> 6880: </span>  }
<span class="linenr"> 6881: </span>
<span class="linenr"> 6882: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">generate the VNode tree expression</span>
<span class="linenr"> 6883: </span>  <span class=
"org-keyword">if</span> (!ssr) {
<span class="linenr"> 6884: </span>    push(<span class=
"org-string">`return `</span>)
<span class="linenr"> 6885: </span>  }
<span class="linenr"> 6886: </span>  <span class=
"org-keyword">if</span> (ast.codegenNode) {
<span class=
"linenr"> 6887: </span>    genNode(ast.codegenNode, context)
<span class="linenr"> 6888: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6889: </span>    push(<span class=
"org-string">`null`</span>)
<span class="linenr"> 6890: </span>  }
<span class="linenr"> 6891: </span>
<span class="linenr"> 6892: </span>  <span class=
"org-keyword">if</span> (useWithBlock) {
<span class="linenr"> 6893: </span>    deindent()
<span class="linenr"> 6894: </span>    push(<span class=
"org-string">`}`</span>)
<span class="linenr"> 6895: </span>  }
<span class="linenr"> 6896: </span>
<span class="linenr"> 6897: </span>  deindent()
<span class="linenr"> 6898: </span>  push(<span class=
"org-string">`}`</span>)
<span class="linenr"> 6899: </span>
<span class="linenr"> 6900: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 6901: </span>    ast,
<span class="linenr"> 6902: </span>    code: context.code,
<span class=
"linenr"> 6903: </span>    preamble: isSetupInlined ? preambleContext.code : <span class="org-string">``</span>,
<span class="linenr"> 6904: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">SourceMapGenerator does have toJSON() method but it's not in the types</span>
<span class=
"linenr"> 6905: </span>    map: context.map ? context.map.toJSON() : <span class="org-constant">undefined</span>
<span class="linenr"> 6906: </span>  }
<span class="linenr"> 6907: </span>}
<span class="linenr"> 6908: </span>
<span class="linenr"> 6909: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">baseCompile</span>(<span class=
"org-variable-name">template</span>, <span class=
"org-variable-name">options</span> = {}) {
<span class="linenr"> 6910: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isModuleMode</span> = options.mode === <span class="org-string">'module'</span>
<span class="linenr"> 6911: </span>
<span class="linenr"> 6912: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prefixIdentifiers</span> =
<span class=
"linenr"> 6913: </span>    !__BROWSER__ &amp;& (options.prefixIdentifiers === <span class="org-constant">true</span> || isModuleMode)
<span class="linenr"> 6914: </span>
<span class="linenr"> 6915: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ast</span> = isString(template) ? baseParse(template, options) : template
<span class="linenr"> 6916: </span>  <span class=
"org-keyword">const</span> [<span class=
"org-variable-name">nodeTransforms</span>, <span class=
"org-variable-name">directiveTransforms</span>] = getBaseTransformPreset(prefixIdentifiers)
<span class="linenr"> 6917: </span>
<span class="linenr"> 6918: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">转换出每个节点的 codegenNode</span>
<span class="linenr"> 6919: </span>  transform(
<span class="linenr"> 6920: </span>    ast,
<span class="linenr"> 6921: </span>    extend({}, options, {
<span class="linenr"> 6922: </span>      prefixIdentifiers,
<span class="linenr"> 6923: </span>      nodeTransforms: [
<span class="linenr"> 6924: </span>        ...nodeTransforms,
<span class=
"linenr"> 6925: </span>        ...(options.nodeTransforms || []) <span class="org-comment-delimiter">// </span><span class="org-comment">user transforms</span>
<span class="linenr"> 6926: </span>      ],
<span class=
"linenr"> 6927: </span>      directiveTransforms: extend(
<span class="linenr"> 6928: </span>        {},
<span class="linenr"> 6929: </span>        directiveTransforms,
<span class=
"linenr"> 6930: </span>        options.directiveTransforms || {} <span class="org-comment-delimiter">// </span><span class="org-comment">user transforms</span>
<span class="linenr"> 6931: </span>      )
<span class="linenr"> 6932: </span>    })
<span class="linenr"> 6933: </span>  )
<span class="linenr"> 6934: </span>
<span class="linenr"> 6935: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">生成 codegen</span>
<span class="linenr"> 6936: </span>  <span class=
"org-keyword">return</span> generate(ast, extend({}, options, { prefixIdentifiers }))
<span class="linenr"> 6937: </span>}
<span class="linenr"> 6938: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">namedCharacterReferences</span> = {
<span class="linenr"> 6939: </span>  <span class=
"org-string">"GT"</span>: <span class="org-string">"&gt;"</span>,
<span class="linenr"> 6940: </span>  <span class=
"org-string">"gt"</span>: <span class="org-string">"&gt;"</span>,
<span class="linenr"> 6941: </span>  <span class=
"org-string">"LT"</span>: <span class="org-string">"&lt;"</span>,
<span class="linenr"> 6942: </span>  <span class=
"org-string">"lt"</span>: <span class="org-string">"&lt;"</span>,
<span class="linenr"> 6943: </span>  <span class=
"org-string">"ac;"</span>: <span class="org-string">"∾"</span>,
<span class="linenr"> 6944: </span>  <span class=
"org-string">"af;"</span>: <span class="org-string">"⁡"</span>,
<span class="linenr"> 6945: </span>  <span class=
"org-string">"AMP"</span>: <span class="org-string">"&amp;"</span>,
<span class="linenr"> 6946: </span>  <span class=
"org-string">"amp"</span>: <span class="org-string">"&amp;"</span>,
<span class="linenr"> 6947: </span>  <span class=
"org-string">"ap;"</span>: <span class="org-string">"≈"</span>,
<span class="linenr"> 6948: </span>  <span class=
"org-string">"DD;"</span>: <span class="org-string">"ⅅ"</span>,
<span class="linenr"> 6949: </span>  <span class=
"org-string">"dd;"</span>: <span class="org-string">"ⅆ"</span>,
<span class="linenr"> 6950: </span>  <span class=
"org-string">"deg"</span>: <span class="org-string">"°"</span>,
<span class="linenr"> 6951: </span>  <span class=
"org-string">"ee;"</span>: <span class="org-string">"ⅇ"</span>,
<span class="linenr"> 6952: </span>  <span class=
"org-string">"eg;"</span>: <span class="org-string">"⪚"</span>,
<span class="linenr"> 6953: </span>  <span class=
"org-string">"el;"</span>: <span class="org-string">"⪙"</span>,
<span class="linenr"> 6954: </span>  <span class=
"org-string">"ETH"</span>: <span class="org-string">"Ð"</span>,
<span class="linenr"> 6955: </span>  <span class=
"org-string">"eth"</span>: <span class="org-string">"ð"</span>,
<span class="linenr"> 6956: </span>  <span class=
"org-string">"gE;"</span>: <span class="org-string">"≧"</span>,
<span class="linenr"> 6957: </span>  <span class=
"org-string">"ge;"</span>: <span class="org-string">"≥"</span>,
<span class="linenr"> 6958: </span>  <span class=
"org-string">"Gg;"</span>: <span class="org-string">"⋙"</span>,
<span class="linenr"> 6959: </span>  <span class=
"org-string">"gg;"</span>: <span class="org-string">"≫"</span>,
<span class="linenr"> 6960: </span>  <span class=
"org-string">"gl;"</span>: <span class="org-string">"≷"</span>,
<span class="linenr"> 6961: </span>  <span class=
"org-string">"GT;"</span>: <span class="org-string">"&gt;"</span>,
<span class="linenr"> 6962: </span>  <span class=
"org-string">"Gt;"</span>: <span class="org-string">"≫"</span>,
<span class="linenr"> 6963: </span>  <span class=
"org-string">"gt;"</span>: <span class="org-string">"&gt;"</span>,
<span class="linenr"> 6964: </span>  <span class=
"org-string">"ic;"</span>: <span class="org-string">"⁣"</span>,
<span class="linenr"> 6965: </span>  <span class=
"org-string">"ii;"</span>: <span class="org-string">"ⅈ"</span>,
<span class="linenr"> 6966: </span>  <span class=
"org-string">"Im;"</span>: <span class="org-string">"ℑ"</span>,
<span class="linenr"> 6967: </span>  <span class=
"org-string">"in;"</span>: <span class="org-string">"∈"</span>,
<span class="linenr"> 6968: </span>  <span class=
"org-string">"it;"</span>: <span class="org-string">"⁢"</span>,
<span class="linenr"> 6969: </span>  <span class=
"org-string">"lE;"</span>: <span class="org-string">"≦"</span>,
<span class="linenr"> 6970: </span>  <span class=
"org-string">"le;"</span>: <span class="org-string">"≤"</span>,
<span class="linenr"> 6971: </span>  <span class=
"org-string">"lg;"</span>: <span class="org-string">"≶"</span>,
<span class="linenr"> 6972: </span>  <span class=
"org-string">"Ll;"</span>: <span class="org-string">"⋘"</span>,
<span class="linenr"> 6973: </span>  <span class=
"org-string">"ll;"</span>: <span class="org-string">"≪"</span>,
<span class="linenr"> 6974: </span>  <span class=
"org-string">"LT;"</span>: <span class="org-string">"&lt;"</span>,
<span class="linenr"> 6975: </span>  <span class=
"org-string">"Lt;"</span>: <span class="org-string">"≪"</span>,
<span class="linenr"> 6976: </span>  <span class=
"org-string">"lt;"</span>: <span class="org-string">"&lt;"</span>,
<span class="linenr"> 6977: </span>  <span class=
"org-string">"mp;"</span>: <span class="org-string">"∓"</span>,
<span class="linenr"> 6978: </span>  <span class=
"org-string">"Mu;"</span>: <span class="org-string">"Μ"</span>,
<span class="linenr"> 6979: </span>  <span class=
"org-string">"mu;"</span>: <span class="org-string">"μ"</span>,
<span class="linenr"> 6980: </span>  <span class=
"org-string">"ne;"</span>: <span class="org-string">"≠"</span>,
<span class="linenr"> 6981: </span>  <span class=
"org-string">"ni;"</span>: <span class="org-string">"∋"</span>,
<span class="linenr"> 6982: </span>  <span class=
"org-string">"not"</span>: <span class="org-string">"¬"</span>,
<span class="linenr"> 6983: </span>  <span class=
"org-string">"Nu;"</span>: <span class="org-string">"Ν"</span>,
<span class="linenr"> 6984: </span>  <span class=
"org-string">"nu;"</span>: <span class="org-string">"ν"</span>,
<span class="linenr"> 6985: </span>  <span class=
"org-string">"Or;"</span>: <span class="org-string">"⩔"</span>,
<span class="linenr"> 6986: </span>  <span class=
"org-string">"or;"</span>: <span class="org-string">"∨"</span>,
<span class="linenr"> 6987: </span>  <span class=
"org-string">"oS;"</span>: <span class="org-string">"Ⓢ"</span>,
<span class="linenr"> 6988: </span>  <span class=
"org-string">"Pi;"</span>: <span class="org-string">"Π"</span>,
<span class="linenr"> 6989: </span>  <span class=
"org-string">"pi;"</span>: <span class="org-string">"π"</span>,
<span class="linenr"> 6990: </span>  <span class=
"org-string">"pm;"</span>: <span class="org-string">"±"</span>,
<span class="linenr"> 6991: </span>  <span class=
"org-string">"Pr;"</span>: <span class="org-string">"⪻"</span>,
<span class="linenr"> 6992: </span>  <span class=
"org-string">"pr;"</span>: <span class="org-string">"≺"</span>,
<span class="linenr"> 6993: </span>  <span class=
"org-string">"Re;"</span>: <span class="org-string">"ℜ"</span>,
<span class="linenr"> 6994: </span>  <span class=
"org-string">"REG"</span>: <span class="org-string">"®"</span>,
<span class="linenr"> 6995: </span>  <span class=
"org-string">"reg"</span>: <span class="org-string">"®"</span>,
<span class="linenr"> 6996: </span>  <span class=
"org-string">"rx;"</span>: <span class="org-string">"℞"</span>,
<span class="linenr"> 6997: </span>  <span class=
"org-string">"Sc;"</span>: <span class="org-string">"⪼"</span>,
<span class="linenr"> 6998: </span>  <span class=
"org-string">"sc;"</span>: <span class="org-string">"≻"</span>,
<span class="linenr"> 6999: </span>  <span class=
"org-string">"shy"</span>: <span class="org-string">"­"</span>,
<span class="linenr"> 7000: </span>  <span class=
"org-string">"uml"</span>: <span class="org-string">"¨"</span>,
<span class="linenr"> 7001: </span>  <span class=
"org-string">"wp;"</span>: <span class="org-string">"℘"</span>,
<span class="linenr"> 7002: </span>  <span class=
"org-string">"wr;"</span>: <span class="org-string">"≀"</span>,
<span class="linenr"> 7003: </span>  <span class=
"org-string">"Xi;"</span>: <span class="org-string">"Ξ"</span>,
<span class="linenr"> 7004: </span>  <span class=
"org-string">"xi;"</span>: <span class="org-string">"ξ"</span>,
<span class="linenr"> 7005: </span>  <span class=
"org-string">"yen"</span>: <span class="org-string">"¥"</span>,
<span class="linenr"> 7006: </span>  <span class=
"org-string">"acd;"</span>: <span class="org-string">"∿"</span>,
<span class="linenr"> 7007: </span>  <span class=
"org-string">"acE;"</span>: <span class="org-string">"∾̳"</span>,
<span class="linenr"> 7008: </span>  <span class=
"org-string">"Acy;"</span>: <span class="org-string">"А"</span>,
<span class="linenr"> 7009: </span>  <span class=
"org-string">"acy;"</span>: <span class="org-string">"а"</span>,
<span class="linenr"> 7010: </span>  <span class=
"org-string">"Afr;"</span>: <span class="org-string">"𝔄"</span>,
<span class="linenr"> 7011: </span>  <span class=
"org-string">"afr;"</span>: <span class="org-string">"𝔞"</span>,
<span class="linenr"> 7012: </span>  <span class=
"org-string">"AMP;"</span>: <span class=
"org-string">"&amp;"</span>,
<span class="linenr"> 7013: </span>  <span class=
"org-string">"amp;"</span>: <span class=
"org-string">"&amp;"</span>,
<span class="linenr"> 7014: </span>  <span class=
"org-string">"And;"</span>: <span class="org-string">"⩓"</span>,
<span class="linenr"> 7015: </span>  <span class=
"org-string">"and;"</span>: <span class="org-string">"∧"</span>,
<span class="linenr"> 7016: </span>  <span class=
"org-string">"ang;"</span>: <span class="org-string">"∠"</span>,
<span class="linenr"> 7017: </span>  <span class=
"org-string">"apE;"</span>: <span class="org-string">"⩰"</span>,
<span class="linenr"> 7018: </span>  <span class=
"org-string">"ape;"</span>: <span class="org-string">"≊"</span>,
<span class="linenr"> 7019: </span>  <span class=
"org-string">"ast;"</span>: <span class="org-string">"*"</span>,
<span class="linenr"> 7020: </span>  <span class=
"org-string">"Auml"</span>: <span class="org-string">"Ä"</span>,
<span class="linenr"> 7021: </span>  <span class=
"org-string">"auml"</span>: <span class="org-string">"ä"</span>,
<span class="linenr"> 7022: </span>  <span class=
"org-string">"Bcy;"</span>: <span class="org-string">"Б"</span>,
<span class="linenr"> 7023: </span>  <span class=
"org-string">"bcy;"</span>: <span class="org-string">"б"</span>,
<span class="linenr"> 7024: </span>  <span class=
"org-string">"Bfr;"</span>: <span class="org-string">"𝔅"</span>,
<span class="linenr"> 7025: </span>  <span class=
"org-string">"bfr;"</span>: <span class="org-string">"𝔟"</span>,
<span class="linenr"> 7026: </span>  <span class=
"org-string">"bne;"</span>: <span class="org-string">"=⃥"</span>,
<span class="linenr"> 7027: </span>  <span class=
"org-string">"bot;"</span>: <span class="org-string">"⊥"</span>,
<span class="linenr"> 7028: </span>  <span class=
"org-string">"Cap;"</span>: <span class="org-string">"⋒"</span>,
<span class="linenr"> 7029: </span>  <span class=
"org-string">"cap;"</span>: <span class="org-string">"∩"</span>,
<span class="linenr"> 7030: </span>  <span class=
"org-string">"cent"</span>: <span class="org-string">"¢"</span>,
<span class="linenr"> 7031: </span>  <span class=
"org-string">"Cfr;"</span>: <span class="org-string">"ℭ"</span>,
<span class="linenr"> 7032: </span>  <span class=
"org-string">"cfr;"</span>: <span class="org-string">"𝔠"</span>,
<span class="linenr"> 7033: </span>  <span class=
"org-string">"Chi;"</span>: <span class="org-string">"Χ"</span>,
<span class="linenr"> 7034: </span>  <span class=
"org-string">"chi;"</span>: <span class="org-string">"χ"</span>,
<span class="linenr"> 7035: </span>  <span class=
"org-string">"cir;"</span>: <span class="org-string">"○"</span>,
<span class="linenr"> 7036: </span>  <span class=
"org-string">"COPY"</span>: <span class="org-string">"©"</span>,
<span class="linenr"> 7037: </span>  <span class=
"org-string">"copy"</span>: <span class="org-string">"©"</span>,
<span class="linenr"> 7038: </span>  <span class=
"org-string">"Cup;"</span>: <span class="org-string">"⋓"</span>,
<span class="linenr"> 7039: </span>  <span class=
"org-string">"cup;"</span>: <span class="org-string">"∪"</span>,
<span class="linenr"> 7040: </span>  <span class=
"org-string">"Dcy;"</span>: <span class="org-string">"Д"</span>,
<span class="linenr"> 7041: </span>  <span class=
"org-string">"dcy;"</span>: <span class="org-string">"д"</span>,
<span class="linenr"> 7042: </span>  <span class=
"org-string">"deg;"</span>: <span class="org-string">"°"</span>,
<span class="linenr"> 7043: </span>  <span class=
"org-string">"Del;"</span>: <span class="org-string">"∇"</span>,
<span class="linenr"> 7044: </span>  <span class=
"org-string">"Dfr;"</span>: <span class="org-string">"𝔇"</span>,
<span class="linenr"> 7045: </span>  <span class=
"org-string">"dfr;"</span>: <span class="org-string">"𝔡"</span>,
<span class="linenr"> 7046: </span>  <span class=
"org-string">"die;"</span>: <span class="org-string">"¨"</span>,
<span class="linenr"> 7047: </span>  <span class=
"org-string">"div;"</span>: <span class="org-string">"÷"</span>,
<span class="linenr"> 7048: </span>  <span class=
"org-string">"Dot;"</span>: <span class="org-string">"¨"</span>,
<span class="linenr"> 7049: </span>  <span class=
"org-string">"dot;"</span>: <span class="org-string">"˙"</span>,
<span class="linenr"> 7050: </span>  <span class=
"org-string">"Ecy;"</span>: <span class="org-string">"Э"</span>,
<span class="linenr"> 7051: </span>  <span class=
"org-string">"ecy;"</span>: <span class="org-string">"э"</span>,
<span class="linenr"> 7052: </span>  <span class=
"org-string">"Efr;"</span>: <span class="org-string">"𝔈"</span>,
<span class="linenr"> 7053: </span>  <span class=
"org-string">"efr;"</span>: <span class="org-string">"𝔢"</span>,
<span class="linenr"> 7054: </span>  <span class=
"org-string">"egs;"</span>: <span class="org-string">"⪖"</span>,
<span class="linenr"> 7055: </span>  <span class=
"org-string">"ell;"</span>: <span class="org-string">"ℓ"</span>,
<span class="linenr"> 7056: </span>  <span class=
"org-string">"els;"</span>: <span class="org-string">"⪕"</span>,
<span class="linenr"> 7057: </span>  <span class=
"org-string">"ENG;"</span>: <span class="org-string">"Ŋ"</span>,
<span class="linenr"> 7058: </span>  <span class=
"org-string">"eng;"</span>: <span class="org-string">"ŋ"</span>,
<span class="linenr"> 7059: </span>  <span class=
"org-string">"Eta;"</span>: <span class="org-string">"Η"</span>,
<span class="linenr"> 7060: </span>  <span class=
"org-string">"eta;"</span>: <span class="org-string">"η"</span>,
<span class="linenr"> 7061: </span>  <span class=
"org-string">"ETH;"</span>: <span class="org-string">"Ð"</span>,
<span class="linenr"> 7062: </span>  <span class=
"org-string">"eth;"</span>: <span class="org-string">"ð"</span>,
<span class="linenr"> 7063: </span>  <span class=
"org-string">"Euml"</span>: <span class="org-string">"Ë"</span>,
<span class="linenr"> 7064: </span>  <span class=
"org-string">"euml"</span>: <span class="org-string">"ë"</span>,
<span class="linenr"> 7065: </span>  <span class=
"org-string">"Fcy;"</span>: <span class="org-string">"Ф"</span>,
<span class="linenr"> 7066: </span>  <span class=
"org-string">"fcy;"</span>: <span class="org-string">"ф"</span>,
<span class="linenr"> 7067: </span>  <span class=
"org-string">"Ffr;"</span>: <span class="org-string">"𝔉"</span>,
<span class="linenr"> 7068: </span>  <span class=
"org-string">"ffr;"</span>: <span class="org-string">"𝔣"</span>,
<span class="linenr"> 7069: </span>  <span class=
"org-string">"gap;"</span>: <span class="org-string">"⪆"</span>,
<span class="linenr"> 7070: </span>  <span class=
"org-string">"Gcy;"</span>: <span class="org-string">"Г"</span>,
<span class="linenr"> 7071: </span>  <span class=
"org-string">"gcy;"</span>: <span class="org-string">"г"</span>,
<span class="linenr"> 7072: </span>  <span class=
"org-string">"gEl;"</span>: <span class="org-string">"⪌"</span>,
<span class="linenr"> 7073: </span>  <span class=
"org-string">"gel;"</span>: <span class="org-string">"⋛"</span>,
<span class="linenr"> 7074: </span>  <span class=
"org-string">"geq;"</span>: <span class="org-string">"≥"</span>,
<span class="linenr"> 7075: </span>  <span class=
"org-string">"ges;"</span>: <span class="org-string">"⩾"</span>,
<span class="linenr"> 7076: </span>  <span class=
"org-string">"Gfr;"</span>: <span class="org-string">"𝔊"</span>,
<span class="linenr"> 7077: </span>  <span class=
"org-string">"gfr;"</span>: <span class="org-string">"𝔤"</span>,
<span class="linenr"> 7078: </span>  <span class=
"org-string">"ggg;"</span>: <span class="org-string">"⋙"</span>,
<span class="linenr"> 7079: </span>  <span class=
"org-string">"gla;"</span>: <span class="org-string">"⪥"</span>,
<span class="linenr"> 7080: </span>  <span class=
"org-string">"glE;"</span>: <span class="org-string">"⪒"</span>,
<span class="linenr"> 7081: </span>  <span class=
"org-string">"glj;"</span>: <span class="org-string">"⪤"</span>,
<span class="linenr"> 7082: </span>  <span class=
"org-string">"gnE;"</span>: <span class="org-string">"≩"</span>,
<span class="linenr"> 7083: </span>  <span class=
"org-string">"gne;"</span>: <span class="org-string">"⪈"</span>,
<span class="linenr"> 7084: </span>  <span class=
"org-string">"Hat;"</span>: <span class="org-string">"^"</span>,
<span class="linenr"> 7085: </span>  <span class=
"org-string">"Hfr;"</span>: <span class="org-string">"ℌ"</span>,
<span class="linenr"> 7086: </span>  <span class=
"org-string">"hfr;"</span>: <span class="org-string">"𝔥"</span>,
<span class="linenr"> 7087: </span>  <span class=
"org-string">"Icy;"</span>: <span class="org-string">"И"</span>,
<span class="linenr"> 7088: </span>  <span class=
"org-string">"icy;"</span>: <span class="org-string">"и"</span>,
<span class="linenr"> 7089: </span>  <span class=
"org-string">"iff;"</span>: <span class="org-string">"⇔"</span>,
<span class="linenr"> 7090: </span>  <span class=
"org-string">"Ifr;"</span>: <span class="org-string">"ℑ"</span>,
<span class="linenr"> 7091: </span>  <span class=
"org-string">"ifr;"</span>: <span class="org-string">"𝔦"</span>,
<span class="linenr"> 7092: </span>  <span class=
"org-string">"Int;"</span>: <span class="org-string">"∬"</span>,
<span class="linenr"> 7093: </span>  <span class=
"org-string">"int;"</span>: <span class="org-string">"∫"</span>,
<span class="linenr"> 7094: </span>  <span class=
"org-string">"Iuml"</span>: <span class="org-string">"Ï"</span>,
<span class="linenr"> 7095: </span>  <span class=
"org-string">"iuml"</span>: <span class="org-string">"ï"</span>,
<span class="linenr"> 7096: </span>  <span class=
"org-string">"Jcy;"</span>: <span class="org-string">"Й"</span>,
<span class="linenr"> 7097: </span>  <span class=
"org-string">"jcy;"</span>: <span class="org-string">"й"</span>,
<span class="linenr"> 7098: </span>  <span class=
"org-string">"Jfr;"</span>: <span class="org-string">"𝔍"</span>,
<span class="linenr"> 7099: </span>  <span class=
"org-string">"jfr;"</span>: <span class="org-string">"𝔧"</span>,
<span class="linenr"> 7100: </span>  <span class=
"org-string">"Kcy;"</span>: <span class="org-string">"К"</span>,
<span class="linenr"> 7101: </span>  <span class=
"org-string">"kcy;"</span>: <span class="org-string">"к"</span>,
<span class="linenr"> 7102: </span>  <span class=
"org-string">"Kfr;"</span>: <span class="org-string">"𝔎"</span>,
<span class="linenr"> 7103: </span>  <span class=
"org-string">"kfr;"</span>: <span class="org-string">"𝔨"</span>,
<span class="linenr"> 7104: </span>  <span class=
"org-string">"lap;"</span>: <span class="org-string">"⪅"</span>,
<span class="linenr"> 7105: </span>  <span class=
"org-string">"lat;"</span>: <span class="org-string">"⪫"</span>,
<span class="linenr"> 7106: </span>  <span class=
"org-string">"Lcy;"</span>: <span class="org-string">"Л"</span>,
<span class="linenr"> 7107: </span>  <span class=
"org-string">"lcy;"</span>: <span class="org-string">"л"</span>,
<span class="linenr"> 7108: </span>  <span class=
"org-string">"lEg;"</span>: <span class="org-string">"⪋"</span>,
<span class="linenr"> 7109: </span>  <span class=
"org-string">"leg;"</span>: <span class="org-string">"⋚"</span>,
<span class="linenr"> 7110: </span>  <span class=
"org-string">"leq;"</span>: <span class="org-string">"≤"</span>,
<span class="linenr"> 7111: </span>  <span class=
"org-string">"les;"</span>: <span class="org-string">"⩽"</span>,
<span class="linenr"> 7112: </span>  <span class=
"org-string">"Lfr;"</span>: <span class="org-string">"𝔏"</span>,
<span class="linenr"> 7113: </span>  <span class=
"org-string">"lfr;"</span>: <span class="org-string">"𝔩"</span>,
<span class="linenr"> 7114: </span>  <span class=
"org-string">"lgE;"</span>: <span class="org-string">"⪑"</span>,
<span class="linenr"> 7115: </span>  <span class=
"org-string">"lnE;"</span>: <span class="org-string">"≨"</span>,
<span class="linenr"> 7116: </span>  <span class=
"org-string">"lne;"</span>: <span class="org-string">"⪇"</span>,
<span class="linenr"> 7117: </span>  <span class=
"org-string">"loz;"</span>: <span class="org-string">"◊"</span>,
<span class="linenr"> 7118: </span>  <span class=
"org-string">"lrm;"</span>: <span class="org-string">"‎"</span>,
<span class="linenr"> 7119: </span>  <span class=
"org-string">"Lsh;"</span>: <span class="org-string">"↰"</span>,
<span class="linenr"> 7120: </span>  <span class=
"org-string">"lsh;"</span>: <span class="org-string">"↰"</span>,
<span class="linenr"> 7121: </span>  <span class=
"org-string">"macr"</span>: <span class="org-string">"¯"</span>,
<span class="linenr"> 7122: </span>  <span class=
"org-string">"Map;"</span>: <span class="org-string">"⤅"</span>,
<span class="linenr"> 7123: </span>  <span class=
"org-string">"map;"</span>: <span class="org-string">"↦"</span>,
<span class="linenr"> 7124: </span>  <span class=
"org-string">"Mcy;"</span>: <span class="org-string">"М"</span>,
<span class="linenr"> 7125: </span>  <span class=
"org-string">"mcy;"</span>: <span class="org-string">"м"</span>,
<span class="linenr"> 7126: </span>  <span class=
"org-string">"Mfr;"</span>: <span class="org-string">"𝔐"</span>,
<span class="linenr"> 7127: </span>  <span class=
"org-string">"mfr;"</span>: <span class="org-string">"𝔪"</span>,
<span class="linenr"> 7128: </span>  <span class=
"org-string">"mho;"</span>: <span class="org-string">"℧"</span>,
<span class="linenr"> 7129: </span>  <span class=
"org-string">"mid;"</span>: <span class="org-string">"∣"</span>,
<span class="linenr"> 7130: </span>  <span class=
"org-string">"nap;"</span>: <span class="org-string">"≉"</span>,
<span class="linenr"> 7131: </span>  <span class=
"org-string">"nbsp"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 7132: </span>  <span class=
"org-string">"Ncy;"</span>: <span class="org-string">"Н"</span>,
<span class="linenr"> 7133: </span>  <span class=
"org-string">"ncy;"</span>: <span class="org-string">"н"</span>,
<span class="linenr"> 7134: </span>  <span class=
"org-string">"Nfr;"</span>: <span class="org-string">"𝔑"</span>,
<span class="linenr"> 7135: </span>  <span class=
"org-string">"nfr;"</span>: <span class="org-string">"𝔫"</span>,
<span class="linenr"> 7136: </span>  <span class=
"org-string">"ngE;"</span>: <span class="org-string">"≧̸"</span>,
<span class="linenr"> 7137: </span>  <span class=
"org-string">"nge;"</span>: <span class="org-string">"≱"</span>,
<span class="linenr"> 7138: </span>  <span class=
"org-string">"nGg;"</span>: <span class="org-string">"⋙̸"</span>,
<span class="linenr"> 7139: </span>  <span class=
"org-string">"nGt;"</span>: <span class="org-string">"≫⃒"</span>,
<span class="linenr"> 7140: </span>  <span class=
"org-string">"ngt;"</span>: <span class="org-string">"≯"</span>,
<span class="linenr"> 7141: </span>  <span class=
"org-string">"nis;"</span>: <span class="org-string">"⋼"</span>,
<span class="linenr"> 7142: </span>  <span class=
"org-string">"niv;"</span>: <span class="org-string">"∋"</span>,
<span class="linenr"> 7143: </span>  <span class=
"org-string">"nlE;"</span>: <span class="org-string">"≦̸"</span>,
<span class="linenr"> 7144: </span>  <span class=
"org-string">"nle;"</span>: <span class="org-string">"≰"</span>,
<span class="linenr"> 7145: </span>  <span class=
"org-string">"nLl;"</span>: <span class="org-string">"⋘̸"</span>,
<span class="linenr"> 7146: </span>  <span class=
"org-string">"nLt;"</span>: <span class="org-string">"≪⃒"</span>,
<span class="linenr"> 7147: </span>  <span class=
"org-string">"nlt;"</span>: <span class="org-string">"≮"</span>,
<span class="linenr"> 7148: </span>  <span class=
"org-string">"Not;"</span>: <span class="org-string">"⫬"</span>,
<span class="linenr"> 7149: </span>  <span class=
"org-string">"not;"</span>: <span class="org-string">"¬"</span>,
<span class="linenr"> 7150: </span>  <span class=
"org-string">"npr;"</span>: <span class="org-string">"⊀"</span>,
<span class="linenr"> 7151: </span>  <span class=
"org-string">"nsc;"</span>: <span class="org-string">"⊁"</span>,
<span class="linenr"> 7152: </span>  <span class=
"org-string">"num;"</span>: <span class="org-string">"#"</span>,
<span class="linenr"> 7153: </span>  <span class=
"org-string">"Ocy;"</span>: <span class="org-string">"О"</span>,
<span class="linenr"> 7154: </span>  <span class=
"org-string">"ocy;"</span>: <span class="org-string">"о"</span>,
<span class="linenr"> 7155: </span>  <span class=
"org-string">"Ofr;"</span>: <span class="org-string">"𝔒"</span>,
<span class="linenr"> 7156: </span>  <span class=
"org-string">"ofr;"</span>: <span class="org-string">"𝔬"</span>,
<span class="linenr"> 7157: </span>  <span class=
"org-string">"ogt;"</span>: <span class="org-string">"⧁"</span>,
<span class="linenr"> 7158: </span>  <span class=
"org-string">"ohm;"</span>: <span class="org-string">"Ω"</span>,
<span class="linenr"> 7159: </span>  <span class=
"org-string">"olt;"</span>: <span class="org-string">"⧀"</span>,
<span class="linenr"> 7160: </span>  <span class=
"org-string">"ord;"</span>: <span class="org-string">"⩝"</span>,
<span class="linenr"> 7161: </span>  <span class=
"org-string">"ordf"</span>: <span class="org-string">"ª"</span>,
<span class="linenr"> 7162: </span>  <span class=
"org-string">"ordm"</span>: <span class="org-string">"º"</span>,
<span class="linenr"> 7163: </span>  <span class=
"org-string">"orv;"</span>: <span class="org-string">"⩛"</span>,
<span class="linenr"> 7164: </span>  <span class=
"org-string">"Ouml"</span>: <span class="org-string">"Ö"</span>,
<span class="linenr"> 7165: </span>  <span class=
"org-string">"ouml"</span>: <span class="org-string">"ö"</span>,
<span class="linenr"> 7166: </span>  <span class=
"org-string">"par;"</span>: <span class="org-string">"∥"</span>,
<span class="linenr"> 7167: </span>  <span class=
"org-string">"para"</span>: <span class="org-string">"¶"</span>,
<span class="linenr"> 7168: </span>  <span class=
"org-string">"Pcy;"</span>: <span class="org-string">"П"</span>,
<span class="linenr"> 7169: </span>  <span class=
"org-string">"pcy;"</span>: <span class="org-string">"п"</span>,
<span class="linenr"> 7170: </span>  <span class=
"org-string">"Pfr;"</span>: <span class="org-string">"𝔓"</span>,
<span class="linenr"> 7171: </span>  <span class=
"org-string">"pfr;"</span>: <span class="org-string">"𝔭"</span>,
<span class="linenr"> 7172: </span>  <span class=
"org-string">"Phi;"</span>: <span class="org-string">"Φ"</span>,
<span class="linenr"> 7173: </span>  <span class=
"org-string">"phi;"</span>: <span class="org-string">"φ"</span>,
<span class="linenr"> 7174: </span>  <span class=
"org-string">"piv;"</span>: <span class="org-string">"ϖ"</span>,
<span class="linenr"> 7175: </span>  <span class=
"org-string">"prE;"</span>: <span class="org-string">"⪳"</span>,
<span class="linenr"> 7176: </span>  <span class=
"org-string">"pre;"</span>: <span class="org-string">"⪯"</span>,
<span class="linenr"> 7177: </span>  <span class=
"org-string">"Psi;"</span>: <span class="org-string">"Ψ"</span>,
<span class="linenr"> 7178: </span>  <span class=
"org-string">"psi;"</span>: <span class="org-string">"ψ"</span>,
<span class="linenr"> 7179: </span>  <span class=
"org-string">"Qfr;"</span>: <span class="org-string">"𝔔"</span>,
<span class="linenr"> 7180: </span>  <span class=
"org-string">"qfr;"</span>: <span class="org-string">"𝔮"</span>,
<span class="linenr"> 7181: </span>  <span class=
"org-string">"QUOT"</span>: <span class="org-string">"\""</span>,
<span class="linenr"> 7182: </span>  <span class=
"org-string">"quot"</span>: <span class="org-string">"\""</span>,
<span class="linenr"> 7183: </span>  <span class=
"org-string">"Rcy;"</span>: <span class="org-string">"Р"</span>,
<span class="linenr"> 7184: </span>  <span class=
"org-string">"rcy;"</span>: <span class="org-string">"р"</span>,
<span class="linenr"> 7185: </span>  <span class=
"org-string">"REG;"</span>: <span class="org-string">"®"</span>,
<span class="linenr"> 7186: </span>  <span class=
"org-string">"reg;"</span>: <span class="org-string">"®"</span>,
<span class="linenr"> 7187: </span>  <span class=
"org-string">"Rfr;"</span>: <span class="org-string">"ℜ"</span>,
<span class="linenr"> 7188: </span>  <span class=
"org-string">"rfr;"</span>: <span class="org-string">"𝔯"</span>,
<span class="linenr"> 7189: </span>  <span class=
"org-string">"Rho;"</span>: <span class="org-string">"Ρ"</span>,
<span class="linenr"> 7190: </span>  <span class=
"org-string">"rho;"</span>: <span class="org-string">"ρ"</span>,
<span class="linenr"> 7191: </span>  <span class=
"org-string">"rlm;"</span>: <span class="org-string">"‏"</span>,
<span class="linenr"> 7192: </span>  <span class=
"org-string">"Rsh;"</span>: <span class="org-string">"↱"</span>,
<span class="linenr"> 7193: </span>  <span class=
"org-string">"rsh;"</span>: <span class="org-string">"↱"</span>,
<span class="linenr"> 7194: </span>  <span class=
"org-string">"scE;"</span>: <span class="org-string">"⪴"</span>,
<span class="linenr"> 7195: </span>  <span class=
"org-string">"sce;"</span>: <span class="org-string">"⪰"</span>,
<span class="linenr"> 7196: </span>  <span class=
"org-string">"Scy;"</span>: <span class="org-string">"С"</span>,
<span class="linenr"> 7197: </span>  <span class=
"org-string">"scy;"</span>: <span class="org-string">"с"</span>,
<span class="linenr"> 7198: </span>  <span class=
"org-string">"sect"</span>: <span class="org-string">"§"</span>,
<span class="linenr"> 7199: </span>  <span class=
"org-string">"Sfr;"</span>: <span class="org-string">"𝔖"</span>,
<span class="linenr"> 7200: </span>  <span class=
"org-string">"sfr;"</span>: <span class="org-string">"𝔰"</span>,
<span class="linenr"> 7201: </span>  <span class=
"org-string">"shy;"</span>: <span class="org-string">"­"</span>,
<span class="linenr"> 7202: </span>  <span class=
"org-string">"sim;"</span>: <span class="org-string">"∼"</span>,
<span class="linenr"> 7203: </span>  <span class=
"org-string">"smt;"</span>: <span class="org-string">"⪪"</span>,
<span class="linenr"> 7204: </span>  <span class=
"org-string">"sol;"</span>: <span class="org-string">"/"</span>,
<span class="linenr"> 7205: </span>  <span class=
"org-string">"squ;"</span>: <span class="org-string">"□"</span>,
<span class="linenr"> 7206: </span>  <span class=
"org-string">"Sub;"</span>: <span class="org-string">"⋐"</span>,
<span class="linenr"> 7207: </span>  <span class=
"org-string">"sub;"</span>: <span class="org-string">"⊂"</span>,
<span class="linenr"> 7208: </span>  <span class=
"org-string">"Sum;"</span>: <span class="org-string">"∑"</span>,
<span class="linenr"> 7209: </span>  <span class=
"org-string">"sum;"</span>: <span class="org-string">"∑"</span>,
<span class="linenr"> 7210: </span>  <span class=
"org-string">"Sup;"</span>: <span class="org-string">"⋑"</span>,
<span class="linenr"> 7211: </span>  <span class=
"org-string">"sup;"</span>: <span class="org-string">"⊃"</span>,
<span class="linenr"> 7212: </span>  <span class=
"org-string">"sup1"</span>: <span class="org-string">"¹"</span>,
<span class="linenr"> 7213: </span>  <span class=
"org-string">"sup2"</span>: <span class="org-string">"²"</span>,
<span class="linenr"> 7214: </span>  <span class=
"org-string">"sup3"</span>: <span class="org-string">"³"</span>,
<span class="linenr"> 7215: </span>  <span class=
"org-string">"Tab;"</span>: <span class="org-string">"\t"</span>,
<span class="linenr"> 7216: </span>  <span class=
"org-string">"Tau;"</span>: <span class="org-string">"Τ"</span>,
<span class="linenr"> 7217: </span>  <span class=
"org-string">"tau;"</span>: <span class="org-string">"τ"</span>,
<span class="linenr"> 7218: </span>  <span class=
"org-string">"Tcy;"</span>: <span class="org-string">"Т"</span>,
<span class="linenr"> 7219: </span>  <span class=
"org-string">"tcy;"</span>: <span class="org-string">"т"</span>,
<span class="linenr"> 7220: </span>  <span class=
"org-string">"Tfr;"</span>: <span class="org-string">"𝔗"</span>,
<span class="linenr"> 7221: </span>  <span class=
"org-string">"tfr;"</span>: <span class="org-string">"𝔱"</span>,
<span class="linenr"> 7222: </span>  <span class=
"org-string">"top;"</span>: <span class="org-string">"⊤"</span>,
<span class="linenr"> 7223: </span>  <span class=
"org-string">"Ucy;"</span>: <span class="org-string">"У"</span>,
<span class="linenr"> 7224: </span>  <span class=
"org-string">"ucy;"</span>: <span class="org-string">"у"</span>,
<span class="linenr"> 7225: </span>  <span class=
"org-string">"Ufr;"</span>: <span class="org-string">"𝔘"</span>,
<span class="linenr"> 7226: </span>  <span class=
"org-string">"ufr;"</span>: <span class="org-string">"𝔲"</span>,
<span class="linenr"> 7227: </span>  <span class=
"org-string">"uml;"</span>: <span class="org-string">"¨"</span>,
<span class="linenr"> 7228: </span>  <span class=
"org-string">"Uuml"</span>: <span class="org-string">"Ü"</span>,
<span class="linenr"> 7229: </span>  <span class=
"org-string">"uuml"</span>: <span class="org-string">"ü"</span>,
<span class="linenr"> 7230: </span>  <span class=
"org-string">"Vcy;"</span>: <span class="org-string">"В"</span>,
<span class="linenr"> 7231: </span>  <span class=
"org-string">"vcy;"</span>: <span class="org-string">"в"</span>,
<span class="linenr"> 7232: </span>  <span class=
"org-string">"Vee;"</span>: <span class="org-string">"⋁"</span>,
<span class="linenr"> 7233: </span>  <span class=
"org-string">"vee;"</span>: <span class="org-string">"∨"</span>,
<span class="linenr"> 7234: </span>  <span class=
"org-string">"Vfr;"</span>: <span class="org-string">"𝔙"</span>,
<span class="linenr"> 7235: </span>  <span class=
"org-string">"vfr;"</span>: <span class="org-string">"𝔳"</span>,
<span class="linenr"> 7236: </span>  <span class=
"org-string">"Wfr;"</span>: <span class="org-string">"𝔚"</span>,
<span class="linenr"> 7237: </span>  <span class=
"org-string">"wfr;"</span>: <span class="org-string">"𝔴"</span>,
<span class="linenr"> 7238: </span>  <span class=
"org-string">"Xfr;"</span>: <span class="org-string">"𝔛"</span>,
<span class="linenr"> 7239: </span>  <span class=
"org-string">"xfr;"</span>: <span class="org-string">"𝔵"</span>,
<span class="linenr"> 7240: </span>  <span class=
"org-string">"Ycy;"</span>: <span class="org-string">"Ы"</span>,
<span class="linenr"> 7241: </span>  <span class=
"org-string">"ycy;"</span>: <span class="org-string">"ы"</span>,
<span class="linenr"> 7242: </span>  <span class=
"org-string">"yen;"</span>: <span class="org-string">"¥"</span>,
<span class="linenr"> 7243: </span>  <span class=
"org-string">"Yfr;"</span>: <span class="org-string">"𝔜"</span>,
<span class="linenr"> 7244: </span>  <span class=
"org-string">"yfr;"</span>: <span class="org-string">"𝔶"</span>,
<span class="linenr"> 7245: </span>  <span class=
"org-string">"yuml"</span>: <span class="org-string">"ÿ"</span>,
<span class="linenr"> 7246: </span>  <span class=
"org-string">"Zcy;"</span>: <span class="org-string">"З"</span>,
<span class="linenr"> 7247: </span>  <span class=
"org-string">"zcy;"</span>: <span class="org-string">"з"</span>,
<span class="linenr"> 7248: </span>  <span class=
"org-string">"Zfr;"</span>: <span class="org-string">"ℨ"</span>,
<span class="linenr"> 7249: </span>  <span class=
"org-string">"zfr;"</span>: <span class="org-string">"𝔷"</span>,
<span class="linenr"> 7250: </span>  <span class=
"org-string">"zwj;"</span>: <span class="org-string">"‍"</span>,
<span class="linenr"> 7251: </span>  <span class=
"org-string">"Acirc"</span>: <span class="org-string">"Â"</span>,
<span class="linenr"> 7252: </span>  <span class=
"org-string">"acirc"</span>: <span class="org-string">"â"</span>,
<span class="linenr"> 7253: </span>  <span class=
"org-string">"acute"</span>: <span class="org-string">"´"</span>,
<span class="linenr"> 7254: </span>  <span class=
"org-string">"AElig"</span>: <span class="org-string">"Æ"</span>,
<span class="linenr"> 7255: </span>  <span class=
"org-string">"aelig"</span>: <span class="org-string">"æ"</span>,
<span class="linenr"> 7256: </span>  <span class=
"org-string">"andd;"</span>: <span class="org-string">"⩜"</span>,
<span class="linenr"> 7257: </span>  <span class=
"org-string">"andv;"</span>: <span class="org-string">"⩚"</span>,
<span class="linenr"> 7258: </span>  <span class=
"org-string">"ange;"</span>: <span class="org-string">"⦤"</span>,
<span class="linenr"> 7259: </span>  <span class=
"org-string">"Aopf;"</span>: <span class="org-string">"𝔸"</span>,
<span class="linenr"> 7260: </span>  <span class=
"org-string">"aopf;"</span>: <span class="org-string">"𝕒"</span>,
<span class="linenr"> 7261: </span>  <span class=
"org-string">"apid;"</span>: <span class="org-string">"≋"</span>,
<span class="linenr"> 7262: </span>  <span class=
"org-string">"apos;"</span>: <span class="org-string">"'"</span>,
<span class="linenr"> 7263: </span>  <span class=
"org-string">"Aring"</span>: <span class="org-string">"Å"</span>,
<span class="linenr"> 7264: </span>  <span class=
"org-string">"aring"</span>: <span class="org-string">"å"</span>,
<span class="linenr"> 7265: </span>  <span class=
"org-string">"Ascr;"</span>: <span class="org-string">"𝒜"</span>,
<span class="linenr"> 7266: </span>  <span class=
"org-string">"ascr;"</span>: <span class="org-string">"𝒶"</span>,
<span class="linenr"> 7267: </span>  <span class=
"org-string">"Auml;"</span>: <span class="org-string">"Ä"</span>,
<span class="linenr"> 7268: </span>  <span class=
"org-string">"auml;"</span>: <span class="org-string">"ä"</span>,
<span class="linenr"> 7269: </span>  <span class=
"org-string">"Barv;"</span>: <span class="org-string">"⫧"</span>,
<span class="linenr"> 7270: </span>  <span class=
"org-string">"bbrk;"</span>: <span class="org-string">"⎵"</span>,
<span class="linenr"> 7271: </span>  <span class=
"org-string">"Beta;"</span>: <span class="org-string">"Β"</span>,
<span class="linenr"> 7272: </span>  <span class=
"org-string">"beta;"</span>: <span class="org-string">"β"</span>,
<span class="linenr"> 7273: </span>  <span class=
"org-string">"beth;"</span>: <span class="org-string">"ℶ"</span>,
<span class="linenr"> 7274: </span>  <span class=
"org-string">"bNot;"</span>: <span class="org-string">"⫭"</span>,
<span class="linenr"> 7275: </span>  <span class=
"org-string">"bnot;"</span>: <span class="org-string">"⌐"</span>,
<span class="linenr"> 7276: </span>  <span class=
"org-string">"Bopf;"</span>: <span class="org-string">"𝔹"</span>,
<span class="linenr"> 7277: </span>  <span class=
"org-string">"bopf;"</span>: <span class="org-string">"𝕓"</span>,
<span class="linenr"> 7278: </span>  <span class=
"org-string">"boxH;"</span>: <span class="org-string">"═"</span>,
<span class="linenr"> 7279: </span>  <span class=
"org-string">"boxh;"</span>: <span class="org-string">"─"</span>,
<span class="linenr"> 7280: </span>  <span class=
"org-string">"boxV;"</span>: <span class="org-string">"║"</span>,
<span class="linenr"> 7281: </span>  <span class=
"org-string">"boxv;"</span>: <span class="org-string">"│"</span>,
<span class="linenr"> 7282: </span>  <span class=
"org-string">"Bscr;"</span>: <span class="org-string">"ℬ"</span>,
<span class="linenr"> 7283: </span>  <span class=
"org-string">"bscr;"</span>: <span class="org-string">"𝒷"</span>,
<span class="linenr"> 7284: </span>  <span class=
"org-string">"bsim;"</span>: <span class="org-string">"∽"</span>,
<span class="linenr"> 7285: </span>  <span class=
"org-string">"bsol;"</span>: <span class="org-string">"\\"</span>,
<span class="linenr"> 7286: </span>  <span class=
"org-string">"bull;"</span>: <span class="org-string">"•"</span>,
<span class="linenr"> 7287: </span>  <span class=
"org-string">"bump;"</span>: <span class="org-string">"≎"</span>,
<span class="linenr"> 7288: </span>  <span class=
"org-string">"caps;"</span>: <span class="org-string">"∩︀"</span>,
<span class="linenr"> 7289: </span>  <span class=
"org-string">"Cdot;"</span>: <span class="org-string">"Ċ"</span>,
<span class="linenr"> 7290: </span>  <span class=
"org-string">"cdot;"</span>: <span class="org-string">"ċ"</span>,
<span class="linenr"> 7291: </span>  <span class=
"org-string">"cedil"</span>: <span class="org-string">"¸"</span>,
<span class="linenr"> 7292: </span>  <span class=
"org-string">"cent;"</span>: <span class="org-string">"¢"</span>,
<span class="linenr"> 7293: </span>  <span class=
"org-string">"CHcy;"</span>: <span class="org-string">"Ч"</span>,
<span class="linenr"> 7294: </span>  <span class=
"org-string">"chcy;"</span>: <span class="org-string">"ч"</span>,
<span class="linenr"> 7295: </span>  <span class=
"org-string">"circ;"</span>: <span class="org-string">"ˆ"</span>,
<span class="linenr"> 7296: </span>  <span class=
"org-string">"cirE;"</span>: <span class="org-string">"⧃"</span>,
<span class="linenr"> 7297: </span>  <span class=
"org-string">"cire;"</span>: <span class="org-string">"≗"</span>,
<span class="linenr"> 7298: </span>  <span class=
"org-string">"comp;"</span>: <span class="org-string">"∁"</span>,
<span class="linenr"> 7299: </span>  <span class=
"org-string">"cong;"</span>: <span class="org-string">"≅"</span>,
<span class="linenr"> 7300: </span>  <span class=
"org-string">"Copf;"</span>: <span class="org-string">"ℂ"</span>,
<span class="linenr"> 7301: </span>  <span class=
"org-string">"copf;"</span>: <span class="org-string">"𝕔"</span>,
<span class="linenr"> 7302: </span>  <span class=
"org-string">"COPY;"</span>: <span class="org-string">"©"</span>,
<span class="linenr"> 7303: </span>  <span class=
"org-string">"copy;"</span>: <span class="org-string">"©"</span>,
<span class="linenr"> 7304: </span>  <span class=
"org-string">"Cscr;"</span>: <span class="org-string">"𝒞"</span>,
<span class="linenr"> 7305: </span>  <span class=
"org-string">"cscr;"</span>: <span class="org-string">"𝒸"</span>,
<span class="linenr"> 7306: </span>  <span class=
"org-string">"csub;"</span>: <span class="org-string">"⫏"</span>,
<span class="linenr"> 7307: </span>  <span class=
"org-string">"csup;"</span>: <span class="org-string">"⫐"</span>,
<span class="linenr"> 7308: </span>  <span class=
"org-string">"cups;"</span>: <span class="org-string">"∪︀"</span>,
<span class="linenr"> 7309: </span>  <span class=
"org-string">"Darr;"</span>: <span class="org-string">"↡"</span>,
<span class="linenr"> 7310: </span>  <span class=
"org-string">"dArr;"</span>: <span class="org-string">"⇓"</span>,
<span class="linenr"> 7311: </span>  <span class=
"org-string">"darr;"</span>: <span class="org-string">"↓"</span>,
<span class="linenr"> 7312: </span>  <span class=
"org-string">"dash;"</span>: <span class="org-string">"‐"</span>,
<span class="linenr"> 7313: </span>  <span class=
"org-string">"dHar;"</span>: <span class="org-string">"⥥"</span>,
<span class="linenr"> 7314: </span>  <span class=
"org-string">"diam;"</span>: <span class="org-string">"⋄"</span>,
<span class="linenr"> 7315: </span>  <span class=
"org-string">"DJcy;"</span>: <span class="org-string">"Ђ"</span>,
<span class="linenr"> 7316: </span>  <span class=
"org-string">"djcy;"</span>: <span class="org-string">"ђ"</span>,
<span class="linenr"> 7317: </span>  <span class=
"org-string">"Dopf;"</span>: <span class="org-string">"𝔻"</span>,
<span class="linenr"> 7318: </span>  <span class=
"org-string">"dopf;"</span>: <span class="org-string">"𝕕"</span>,
<span class="linenr"> 7319: </span>  <span class=
"org-string">"Dscr;"</span>: <span class="org-string">"𝒟"</span>,
<span class="linenr"> 7320: </span>  <span class=
"org-string">"dscr;"</span>: <span class="org-string">"𝒹"</span>,
<span class="linenr"> 7321: </span>  <span class=
"org-string">"DScy;"</span>: <span class="org-string">"Ѕ"</span>,
<span class="linenr"> 7322: </span>  <span class=
"org-string">"dscy;"</span>: <span class="org-string">"ѕ"</span>,
<span class="linenr"> 7323: </span>  <span class=
"org-string">"dsol;"</span>: <span class="org-string">"⧶"</span>,
<span class="linenr"> 7324: </span>  <span class=
"org-string">"dtri;"</span>: <span class="org-string">"▿"</span>,
<span class="linenr"> 7325: </span>  <span class=
"org-string">"DZcy;"</span>: <span class="org-string">"Џ"</span>,
<span class="linenr"> 7326: </span>  <span class=
"org-string">"dzcy;"</span>: <span class="org-string">"џ"</span>,
<span class="linenr"> 7327: </span>  <span class=
"org-string">"ecir;"</span>: <span class="org-string">"≖"</span>,
<span class="linenr"> 7328: </span>  <span class=
"org-string">"Ecirc"</span>: <span class="org-string">"Ê"</span>,
<span class="linenr"> 7329: </span>  <span class=
"org-string">"ecirc"</span>: <span class="org-string">"ê"</span>,
<span class="linenr"> 7330: </span>  <span class=
"org-string">"Edot;"</span>: <span class="org-string">"Ė"</span>,
<span class="linenr"> 7331: </span>  <span class=
"org-string">"eDot;"</span>: <span class="org-string">"≑"</span>,
<span class="linenr"> 7332: </span>  <span class=
"org-string">"edot;"</span>: <span class="org-string">"ė"</span>,
<span class="linenr"> 7333: </span>  <span class=
"org-string">"emsp;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 7334: </span>  <span class=
"org-string">"ensp;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 7335: </span>  <span class=
"org-string">"Eopf;"</span>: <span class="org-string">"𝔼"</span>,
<span class="linenr"> 7336: </span>  <span class=
"org-string">"eopf;"</span>: <span class="org-string">"𝕖"</span>,
<span class="linenr"> 7337: </span>  <span class=
"org-string">"epar;"</span>: <span class="org-string">"⋕"</span>,
<span class="linenr"> 7338: </span>  <span class=
"org-string">"epsi;"</span>: <span class="org-string">"ε"</span>,
<span class="linenr"> 7339: </span>  <span class=
"org-string">"Escr;"</span>: <span class="org-string">"ℰ"</span>,
<span class="linenr"> 7340: </span>  <span class=
"org-string">"escr;"</span>: <span class="org-string">"ℯ"</span>,
<span class="linenr"> 7341: </span>  <span class=
"org-string">"Esim;"</span>: <span class="org-string">"⩳"</span>,
<span class="linenr"> 7342: </span>  <span class=
"org-string">"esim;"</span>: <span class="org-string">"≂"</span>,
<span class="linenr"> 7343: </span>  <span class=
"org-string">"Euml;"</span>: <span class="org-string">"Ë"</span>,
<span class="linenr"> 7344: </span>  <span class=
"org-string">"euml;"</span>: <span class="org-string">"ë"</span>,
<span class="linenr"> 7345: </span>  <span class=
"org-string">"euro;"</span>: <span class="org-string">"€"</span>,
<span class="linenr"> 7346: </span>  <span class=
"org-string">"excl;"</span>: <span class="org-string">"!"</span>,
<span class="linenr"> 7347: </span>  <span class=
"org-string">"flat;"</span>: <span class="org-string">"♭"</span>,
<span class="linenr"> 7348: </span>  <span class=
"org-string">"fnof;"</span>: <span class="org-string">"ƒ"</span>,
<span class="linenr"> 7349: </span>  <span class=
"org-string">"Fopf;"</span>: <span class="org-string">"𝔽"</span>,
<span class="linenr"> 7350: </span>  <span class=
"org-string">"fopf;"</span>: <span class="org-string">"𝕗"</span>,
<span class="linenr"> 7351: </span>  <span class=
"org-string">"fork;"</span>: <span class="org-string">"⋔"</span>,
<span class="linenr"> 7352: </span>  <span class=
"org-string">"Fscr;"</span>: <span class="org-string">"ℱ"</span>,
<span class="linenr"> 7353: </span>  <span class=
"org-string">"fscr;"</span>: <span class="org-string">"𝒻"</span>,
<span class="linenr"> 7354: </span>  <span class=
"org-string">"Gdot;"</span>: <span class="org-string">"Ġ"</span>,
<span class="linenr"> 7355: </span>  <span class=
"org-string">"gdot;"</span>: <span class="org-string">"ġ"</span>,
<span class="linenr"> 7356: </span>  <span class=
"org-string">"geqq;"</span>: <span class="org-string">"≧"</span>,
<span class="linenr"> 7357: </span>  <span class=
"org-string">"gesl;"</span>: <span class="org-string">"⋛︀"</span>,
<span class="linenr"> 7358: </span>  <span class=
"org-string">"GJcy;"</span>: <span class="org-string">"Ѓ"</span>,
<span class="linenr"> 7359: </span>  <span class=
"org-string">"gjcy;"</span>: <span class="org-string">"ѓ"</span>,
<span class="linenr"> 7360: </span>  <span class=
"org-string">"gnap;"</span>: <span class="org-string">"⪊"</span>,
<span class="linenr"> 7361: </span>  <span class=
"org-string">"gneq;"</span>: <span class="org-string">"⪈"</span>,
<span class="linenr"> 7362: </span>  <span class=
"org-string">"Gopf;"</span>: <span class="org-string">"𝔾"</span>,
<span class="linenr"> 7363: </span>  <span class=
"org-string">"gopf;"</span>: <span class="org-string">"𝕘"</span>,
<span class="linenr"> 7364: </span>  <span class=
"org-string">"Gscr;"</span>: <span class="org-string">"𝒢"</span>,
<span class="linenr"> 7365: </span>  <span class=
"org-string">"gscr;"</span>: <span class="org-string">"ℊ"</span>,
<span class="linenr"> 7366: </span>  <span class=
"org-string">"gsim;"</span>: <span class="org-string">"≳"</span>,
<span class="linenr"> 7367: </span>  <span class=
"org-string">"gtcc;"</span>: <span class="org-string">"⪧"</span>,
<span class="linenr"> 7368: </span>  <span class=
"org-string">"gvnE;"</span>: <span class="org-string">"≩︀"</span>,
<span class="linenr"> 7369: </span>  <span class=
"org-string">"half;"</span>: <span class="org-string">"½"</span>,
<span class="linenr"> 7370: </span>  <span class=
"org-string">"hArr;"</span>: <span class="org-string">"⇔"</span>,
<span class="linenr"> 7371: </span>  <span class=
"org-string">"harr;"</span>: <span class="org-string">"↔"</span>,
<span class="linenr"> 7372: </span>  <span class=
"org-string">"hbar;"</span>: <span class="org-string">"ℏ"</span>,
<span class="linenr"> 7373: </span>  <span class=
"org-string">"Hopf;"</span>: <span class="org-string">"ℍ"</span>,
<span class="linenr"> 7374: </span>  <span class=
"org-string">"hopf;"</span>: <span class="org-string">"𝕙"</span>,
<span class="linenr"> 7375: </span>  <span class=
"org-string">"Hscr;"</span>: <span class="org-string">"ℋ"</span>,
<span class="linenr"> 7376: </span>  <span class=
"org-string">"hscr;"</span>: <span class="org-string">"𝒽"</span>,
<span class="linenr"> 7377: </span>  <span class=
"org-string">"Icirc"</span>: <span class="org-string">"Î"</span>,
<span class="linenr"> 7378: </span>  <span class=
"org-string">"icirc"</span>: <span class="org-string">"î"</span>,
<span class="linenr"> 7379: </span>  <span class=
"org-string">"Idot;"</span>: <span class="org-string">"İ"</span>,
<span class="linenr"> 7380: </span>  <span class=
"org-string">"IEcy;"</span>: <span class="org-string">"Е"</span>,
<span class="linenr"> 7381: </span>  <span class=
"org-string">"iecy;"</span>: <span class="org-string">"е"</span>,
<span class="linenr"> 7382: </span>  <span class=
"org-string">"iexcl"</span>: <span class="org-string">"¡"</span>,
<span class="linenr"> 7383: </span>  <span class=
"org-string">"imof;"</span>: <span class="org-string">"⊷"</span>,
<span class="linenr"> 7384: </span>  <span class=
"org-string">"IOcy;"</span>: <span class="org-string">"Ё"</span>,
<span class="linenr"> 7385: </span>  <span class=
"org-string">"iocy;"</span>: <span class="org-string">"ё"</span>,
<span class="linenr"> 7386: </span>  <span class=
"org-string">"Iopf;"</span>: <span class="org-string">"𝕀"</span>,
<span class="linenr"> 7387: </span>  <span class=
"org-string">"iopf;"</span>: <span class="org-string">"𝕚"</span>,
<span class="linenr"> 7388: </span>  <span class=
"org-string">"Iota;"</span>: <span class="org-string">"Ι"</span>,
<span class="linenr"> 7389: </span>  <span class=
"org-string">"iota;"</span>: <span class="org-string">"ι"</span>,
<span class="linenr"> 7390: </span>  <span class=
"org-string">"Iscr;"</span>: <span class="org-string">"ℐ"</span>,
<span class="linenr"> 7391: </span>  <span class=
"org-string">"iscr;"</span>: <span class="org-string">"𝒾"</span>,
<span class="linenr"> 7392: </span>  <span class=
"org-string">"isin;"</span>: <span class="org-string">"∈"</span>,
<span class="linenr"> 7393: </span>  <span class=
"org-string">"Iuml;"</span>: <span class="org-string">"Ï"</span>,
<span class="linenr"> 7394: </span>  <span class=
"org-string">"iuml;"</span>: <span class="org-string">"ï"</span>,
<span class="linenr"> 7395: </span>  <span class=
"org-string">"Jopf;"</span>: <span class="org-string">"𝕁"</span>,
<span class="linenr"> 7396: </span>  <span class=
"org-string">"jopf;"</span>: <span class="org-string">"𝕛"</span>,
<span class="linenr"> 7397: </span>  <span class=
"org-string">"Jscr;"</span>: <span class="org-string">"𝒥"</span>,
<span class="linenr"> 7398: </span>  <span class=
"org-string">"jscr;"</span>: <span class="org-string">"𝒿"</span>,
<span class="linenr"> 7399: </span>  <span class=
"org-string">"KHcy;"</span>: <span class="org-string">"Х"</span>,
<span class="linenr"> 7400: </span>  <span class=
"org-string">"khcy;"</span>: <span class="org-string">"х"</span>,
<span class="linenr"> 7401: </span>  <span class=
"org-string">"KJcy;"</span>: <span class="org-string">"Ќ"</span>,
<span class="linenr"> 7402: </span>  <span class=
"org-string">"kjcy;"</span>: <span class="org-string">"ќ"</span>,
<span class="linenr"> 7403: </span>  <span class=
"org-string">"Kopf;"</span>: <span class="org-string">"𝕂"</span>,
<span class="linenr"> 7404: </span>  <span class=
"org-string">"kopf;"</span>: <span class="org-string">"𝕜"</span>,
<span class="linenr"> 7405: </span>  <span class=
"org-string">"Kscr;"</span>: <span class="org-string">"𝒦"</span>,
<span class="linenr"> 7406: </span>  <span class=
"org-string">"kscr;"</span>: <span class="org-string">"𝓀"</span>,
<span class="linenr"> 7407: </span>  <span class=
"org-string">"Lang;"</span>: <span class="org-string">"⟪"</span>,
<span class="linenr"> 7408: </span>  <span class=
"org-string">"lang;"</span>: <span class="org-string">"⟨"</span>,
<span class="linenr"> 7409: </span>  <span class=
"org-string">"laquo"</span>: <span class="org-string">"«"</span>,
<span class="linenr"> 7410: </span>  <span class=
"org-string">"Larr;"</span>: <span class="org-string">"↞"</span>,
<span class="linenr"> 7411: </span>  <span class=
"org-string">"lArr;"</span>: <span class="org-string">"⇐"</span>,
<span class="linenr"> 7412: </span>  <span class=
"org-string">"larr;"</span>: <span class="org-string">"←"</span>,
<span class="linenr"> 7413: </span>  <span class=
"org-string">"late;"</span>: <span class="org-string">"⪭"</span>,
<span class="linenr"> 7414: </span>  <span class=
"org-string">"lcub;"</span>: <span class="org-string">"{"</span>,
<span class="linenr"> 7415: </span>  <span class=
"org-string">"ldca;"</span>: <span class="org-string">"⤶"</span>,
<span class="linenr"> 7416: </span>  <span class=
"org-string">"ldsh;"</span>: <span class="org-string">"↲"</span>,
<span class="linenr"> 7417: </span>  <span class=
"org-string">"leqq;"</span>: <span class="org-string">"≦"</span>,
<span class="linenr"> 7418: </span>  <span class=
"org-string">"lesg;"</span>: <span class="org-string">"⋚︀"</span>,
<span class="linenr"> 7419: </span>  <span class=
"org-string">"lHar;"</span>: <span class="org-string">"⥢"</span>,
<span class="linenr"> 7420: </span>  <span class=
"org-string">"LJcy;"</span>: <span class="org-string">"Љ"</span>,
<span class="linenr"> 7421: </span>  <span class=
"org-string">"ljcy;"</span>: <span class="org-string">"љ"</span>,
<span class="linenr"> 7422: </span>  <span class=
"org-string">"lnap;"</span>: <span class="org-string">"⪉"</span>,
<span class="linenr"> 7423: </span>  <span class=
"org-string">"lneq;"</span>: <span class="org-string">"⪇"</span>,
<span class="linenr"> 7424: </span>  <span class=
"org-string">"Lopf;"</span>: <span class="org-string">"𝕃"</span>,
<span class="linenr"> 7425: </span>  <span class=
"org-string">"lopf;"</span>: <span class="org-string">"𝕝"</span>,
<span class="linenr"> 7426: </span>  <span class=
"org-string">"lozf;"</span>: <span class="org-string">"⧫"</span>,
<span class="linenr"> 7427: </span>  <span class=
"org-string">"lpar;"</span>: <span class="org-string">"("</span>,
<span class="linenr"> 7428: </span>  <span class=
"org-string">"Lscr;"</span>: <span class="org-string">"ℒ"</span>,
<span class="linenr"> 7429: </span>  <span class=
"org-string">"lscr;"</span>: <span class="org-string">"𝓁"</span>,
<span class="linenr"> 7430: </span>  <span class=
"org-string">"lsim;"</span>: <span class="org-string">"≲"</span>,
<span class="linenr"> 7431: </span>  <span class=
"org-string">"lsqb;"</span>: <span class="org-string">"["</span>,
<span class="linenr"> 7432: </span>  <span class=
"org-string">"ltcc;"</span>: <span class="org-string">"⪦"</span>,
<span class="linenr"> 7433: </span>  <span class=
"org-string">"ltri;"</span>: <span class="org-string">"◃"</span>,
<span class="linenr"> 7434: </span>  <span class=
"org-string">"lvnE;"</span>: <span class="org-string">"≨︀"</span>,
<span class="linenr"> 7435: </span>  <span class=
"org-string">"macr;"</span>: <span class="org-string">"¯"</span>,
<span class="linenr"> 7436: </span>  <span class=
"org-string">"male;"</span>: <span class="org-string">"♂"</span>,
<span class="linenr"> 7437: </span>  <span class=
"org-string">"malt;"</span>: <span class="org-string">"✠"</span>,
<span class="linenr"> 7438: </span>  <span class=
"org-string">"micro"</span>: <span class="org-string">"µ"</span>,
<span class="linenr"> 7439: </span>  <span class=
"org-string">"mlcp;"</span>: <span class="org-string">"⫛"</span>,
<span class="linenr"> 7440: </span>  <span class=
"org-string">"mldr;"</span>: <span class="org-string">"…"</span>,
<span class="linenr"> 7441: </span>  <span class=
"org-string">"Mopf;"</span>: <span class="org-string">"𝕄"</span>,
<span class="linenr"> 7442: </span>  <span class=
"org-string">"mopf;"</span>: <span class="org-string">"𝕞"</span>,
<span class="linenr"> 7443: </span>  <span class=
"org-string">"Mscr;"</span>: <span class="org-string">"ℳ"</span>,
<span class="linenr"> 7444: </span>  <span class=
"org-string">"mscr;"</span>: <span class="org-string">"𝓂"</span>,
<span class="linenr"> 7445: </span>  <span class=
"org-string">"nang;"</span>: <span class="org-string">"∠⃒"</span>,
<span class="linenr"> 7446: </span>  <span class=
"org-string">"napE;"</span>: <span class="org-string">"⩰̸"</span>,
<span class="linenr"> 7447: </span>  <span class=
"org-string">"nbsp;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 7448: </span>  <span class=
"org-string">"ncap;"</span>: <span class="org-string">"⩃"</span>,
<span class="linenr"> 7449: </span>  <span class=
"org-string">"ncup;"</span>: <span class="org-string">"⩂"</span>,
<span class="linenr"> 7450: </span>  <span class=
"org-string">"ngeq;"</span>: <span class="org-string">"≱"</span>,
<span class="linenr"> 7451: </span>  <span class=
"org-string">"nges;"</span>: <span class="org-string">"⩾̸"</span>,
<span class="linenr"> 7452: </span>  <span class=
"org-string">"ngtr;"</span>: <span class="org-string">"≯"</span>,
<span class="linenr"> 7453: </span>  <span class=
"org-string">"nGtv;"</span>: <span class="org-string">"≫̸"</span>,
<span class="linenr"> 7454: </span>  <span class=
"org-string">"nisd;"</span>: <span class="org-string">"⋺"</span>,
<span class="linenr"> 7455: </span>  <span class=
"org-string">"NJcy;"</span>: <span class="org-string">"Њ"</span>,
<span class="linenr"> 7456: </span>  <span class=
"org-string">"njcy;"</span>: <span class="org-string">"њ"</span>,
<span class="linenr"> 7457: </span>  <span class=
"org-string">"nldr;"</span>: <span class="org-string">"‥"</span>,
<span class="linenr"> 7458: </span>  <span class=
"org-string">"nleq;"</span>: <span class="org-string">"≰"</span>,
<span class="linenr"> 7459: </span>  <span class=
"org-string">"nles;"</span>: <span class="org-string">"⩽̸"</span>,
<span class="linenr"> 7460: </span>  <span class=
"org-string">"nLtv;"</span>: <span class="org-string">"≪̸"</span>,
<span class="linenr"> 7461: </span>  <span class=
"org-string">"nmid;"</span>: <span class="org-string">"∤"</span>,
<span class="linenr"> 7462: </span>  <span class=
"org-string">"Nopf;"</span>: <span class="org-string">"ℕ"</span>,
<span class="linenr"> 7463: </span>  <span class=
"org-string">"nopf;"</span>: <span class="org-string">"𝕟"</span>,
<span class="linenr"> 7464: </span>  <span class=
"org-string">"npar;"</span>: <span class="org-string">"∦"</span>,
<span class="linenr"> 7465: </span>  <span class=
"org-string">"npre;"</span>: <span class="org-string">"⪯̸"</span>,
<span class="linenr"> 7466: </span>  <span class=
"org-string">"nsce;"</span>: <span class="org-string">"⪰̸"</span>,
<span class="linenr"> 7467: </span>  <span class=
"org-string">"Nscr;"</span>: <span class="org-string">"𝒩"</span>,
<span class="linenr"> 7468: </span>  <span class=
"org-string">"nscr;"</span>: <span class="org-string">"𝓃"</span>,
<span class="linenr"> 7469: </span>  <span class=
"org-string">"nsim;"</span>: <span class="org-string">"≁"</span>,
<span class="linenr"> 7470: </span>  <span class=
"org-string">"nsub;"</span>: <span class="org-string">"⊄"</span>,
<span class="linenr"> 7471: </span>  <span class=
"org-string">"nsup;"</span>: <span class="org-string">"⊅"</span>,
<span class="linenr"> 7472: </span>  <span class=
"org-string">"ntgl;"</span>: <span class="org-string">"≹"</span>,
<span class="linenr"> 7473: </span>  <span class=
"org-string">"ntlg;"</span>: <span class="org-string">"≸"</span>,
<span class="linenr"> 7474: </span>  <span class=
"org-string">"nvap;"</span>: <span class="org-string">"≍⃒"</span>,
<span class="linenr"> 7475: </span>  <span class=
"org-string">"nvge;"</span>: <span class="org-string">"≥⃒"</span>,
<span class="linenr"> 7476: </span>  <span class=
"org-string">"nvgt;"</span>: <span class=
"org-string">"&gt;⃒"</span>,
<span class="linenr"> 7477: </span>  <span class=
"org-string">"nvle;"</span>: <span class="org-string">"≤⃒"</span>,
<span class="linenr"> 7478: </span>  <span class=
"org-string">"nvlt;"</span>: <span class=
"org-string">"&lt;⃒"</span>,
<span class="linenr"> 7479: </span>  <span class=
"org-string">"oast;"</span>: <span class="org-string">"⊛"</span>,
<span class="linenr"> 7480: </span>  <span class=
"org-string">"ocir;"</span>: <span class="org-string">"⊚"</span>,
<span class="linenr"> 7481: </span>  <span class=
"org-string">"Ocirc"</span>: <span class="org-string">"Ô"</span>,
<span class="linenr"> 7482: </span>  <span class=
"org-string">"ocirc"</span>: <span class="org-string">"ô"</span>,
<span class="linenr"> 7483: </span>  <span class=
"org-string">"odiv;"</span>: <span class="org-string">"⨸"</span>,
<span class="linenr"> 7484: </span>  <span class=
"org-string">"odot;"</span>: <span class="org-string">"⊙"</span>,
<span class="linenr"> 7485: </span>  <span class=
"org-string">"ogon;"</span>: <span class="org-string">"˛"</span>,
<span class="linenr"> 7486: </span>  <span class=
"org-string">"oint;"</span>: <span class="org-string">"∮"</span>,
<span class="linenr"> 7487: </span>  <span class=
"org-string">"omid;"</span>: <span class="org-string">"⦶"</span>,
<span class="linenr"> 7488: </span>  <span class=
"org-string">"Oopf;"</span>: <span class="org-string">"𝕆"</span>,
<span class="linenr"> 7489: </span>  <span class=
"org-string">"oopf;"</span>: <span class="org-string">"𝕠"</span>,
<span class="linenr"> 7490: </span>  <span class=
"org-string">"opar;"</span>: <span class="org-string">"⦷"</span>,
<span class="linenr"> 7491: </span>  <span class=
"org-string">"ordf;"</span>: <span class="org-string">"ª"</span>,
<span class="linenr"> 7492: </span>  <span class=
"org-string">"ordm;"</span>: <span class="org-string">"º"</span>,
<span class="linenr"> 7493: </span>  <span class=
"org-string">"oror;"</span>: <span class="org-string">"⩖"</span>,
<span class="linenr"> 7494: </span>  <span class=
"org-string">"Oscr;"</span>: <span class="org-string">"𝒪"</span>,
<span class="linenr"> 7495: </span>  <span class=
"org-string">"oscr;"</span>: <span class="org-string">"ℴ"</span>,
<span class="linenr"> 7496: </span>  <span class=
"org-string">"osol;"</span>: <span class="org-string">"⊘"</span>,
<span class="linenr"> 7497: </span>  <span class=
"org-string">"Ouml;"</span>: <span class="org-string">"Ö"</span>,
<span class="linenr"> 7498: </span>  <span class=
"org-string">"ouml;"</span>: <span class="org-string">"ö"</span>,
<span class="linenr"> 7499: </span>  <span class=
"org-string">"para;"</span>: <span class="org-string">"¶"</span>,
<span class="linenr"> 7500: </span>  <span class=
"org-string">"part;"</span>: <span class="org-string">"∂"</span>,
<span class="linenr"> 7501: </span>  <span class=
"org-string">"perp;"</span>: <span class="org-string">"⊥"</span>,
<span class="linenr"> 7502: </span>  <span class=
"org-string">"phiv;"</span>: <span class="org-string">"ϕ"</span>,
<span class="linenr"> 7503: </span>  <span class=
"org-string">"plus;"</span>: <span class="org-string">"+"</span>,
<span class="linenr"> 7504: </span>  <span class=
"org-string">"Popf;"</span>: <span class="org-string">"ℙ"</span>,
<span class="linenr"> 7505: </span>  <span class=
"org-string">"popf;"</span>: <span class="org-string">"𝕡"</span>,
<span class="linenr"> 7506: </span>  <span class=
"org-string">"pound"</span>: <span class="org-string">"£"</span>,
<span class="linenr"> 7507: </span>  <span class=
"org-string">"prap;"</span>: <span class="org-string">"⪷"</span>,
<span class="linenr"> 7508: </span>  <span class=
"org-string">"prec;"</span>: <span class="org-string">"≺"</span>,
<span class="linenr"> 7509: </span>  <span class=
"org-string">"prnE;"</span>: <span class="org-string">"⪵"</span>,
<span class="linenr"> 7510: </span>  <span class=
"org-string">"prod;"</span>: <span class="org-string">"∏"</span>,
<span class="linenr"> 7511: </span>  <span class=
"org-string">"prop;"</span>: <span class="org-string">"∝"</span>,
<span class="linenr"> 7512: </span>  <span class=
"org-string">"Pscr;"</span>: <span class="org-string">"𝒫"</span>,
<span class="linenr"> 7513: </span>  <span class=
"org-string">"pscr;"</span>: <span class="org-string">"𝓅"</span>,
<span class="linenr"> 7514: </span>  <span class=
"org-string">"qint;"</span>: <span class="org-string">"⨌"</span>,
<span class="linenr"> 7515: </span>  <span class=
"org-string">"Qopf;"</span>: <span class="org-string">"ℚ"</span>,
<span class="linenr"> 7516: </span>  <span class=
"org-string">"qopf;"</span>: <span class="org-string">"𝕢"</span>,
<span class="linenr"> 7517: </span>  <span class=
"org-string">"Qscr;"</span>: <span class="org-string">"𝒬"</span>,
<span class="linenr"> 7518: </span>  <span class=
"org-string">"qscr;"</span>: <span class="org-string">"𝓆"</span>,
<span class="linenr"> 7519: </span>  <span class=
"org-string">"QUOT;"</span>: <span class="org-string">"\""</span>,
<span class="linenr"> 7520: </span>  <span class=
"org-string">"quot;"</span>: <span class="org-string">"\""</span>,
<span class="linenr"> 7521: </span>  <span class=
"org-string">"race;"</span>: <span class="org-string">"∽̱"</span>,
<span class="linenr"> 7522: </span>  <span class=
"org-string">"Rang;"</span>: <span class="org-string">"⟫"</span>,
<span class="linenr"> 7523: </span>  <span class=
"org-string">"rang;"</span>: <span class="org-string">"⟩"</span>,
<span class="linenr"> 7524: </span>  <span class=
"org-string">"raquo"</span>: <span class="org-string">"»"</span>,
<span class="linenr"> 7525: </span>  <span class=
"org-string">"Rarr;"</span>: <span class="org-string">"↠"</span>,
<span class="linenr"> 7526: </span>  <span class=
"org-string">"rArr;"</span>: <span class="org-string">"⇒"</span>,
<span class="linenr"> 7527: </span>  <span class=
"org-string">"rarr;"</span>: <span class="org-string">"→"</span>,
<span class="linenr"> 7528: </span>  <span class=
"org-string">"rcub;"</span>: <span class="org-string">"}"</span>,
<span class="linenr"> 7529: </span>  <span class=
"org-string">"rdca;"</span>: <span class="org-string">"⤷"</span>,
<span class="linenr"> 7530: </span>  <span class=
"org-string">"rdsh;"</span>: <span class="org-string">"↳"</span>,
<span class="linenr"> 7531: </span>  <span class=
"org-string">"real;"</span>: <span class="org-string">"ℜ"</span>,
<span class="linenr"> 7532: </span>  <span class=
"org-string">"rect;"</span>: <span class="org-string">"▭"</span>,
<span class="linenr"> 7533: </span>  <span class=
"org-string">"rHar;"</span>: <span class="org-string">"⥤"</span>,
<span class="linenr"> 7534: </span>  <span class=
"org-string">"rhov;"</span>: <span class="org-string">"ϱ"</span>,
<span class="linenr"> 7535: </span>  <span class=
"org-string">"ring;"</span>: <span class="org-string">"˚"</span>,
<span class="linenr"> 7536: </span>  <span class=
"org-string">"Ropf;"</span>: <span class="org-string">"ℝ"</span>,
<span class="linenr"> 7537: </span>  <span class=
"org-string">"ropf;"</span>: <span class="org-string">"𝕣"</span>,
<span class="linenr"> 7538: </span>  <span class=
"org-string">"rpar;"</span>: <span class="org-string">")"</span>,
<span class="linenr"> 7539: </span>  <span class=
"org-string">"Rscr;"</span>: <span class="org-string">"ℛ"</span>,
<span class="linenr"> 7540: </span>  <span class=
"org-string">"rscr;"</span>: <span class="org-string">"𝓇"</span>,
<span class="linenr"> 7541: </span>  <span class=
"org-string">"rsqb;"</span>: <span class="org-string">"]"</span>,
<span class="linenr"> 7542: </span>  <span class=
"org-string">"rtri;"</span>: <span class="org-string">"▹"</span>,
<span class="linenr"> 7543: </span>  <span class=
"org-string">"scap;"</span>: <span class="org-string">"⪸"</span>,
<span class="linenr"> 7544: </span>  <span class=
"org-string">"scnE;"</span>: <span class="org-string">"⪶"</span>,
<span class="linenr"> 7545: </span>  <span class=
"org-string">"sdot;"</span>: <span class="org-string">"⋅"</span>,
<span class="linenr"> 7546: </span>  <span class=
"org-string">"sect;"</span>: <span class="org-string">"§"</span>,
<span class="linenr"> 7547: </span>  <span class=
"org-string">"semi;"</span>: <span class="org-string">";"</span>,
<span class="linenr"> 7548: </span>  <span class=
"org-string">"sext;"</span>: <span class="org-string">"✶"</span>,
<span class="linenr"> 7549: </span>  <span class=
"org-string">"SHcy;"</span>: <span class="org-string">"Ш"</span>,
<span class="linenr"> 7550: </span>  <span class=
"org-string">"shcy;"</span>: <span class="org-string">"ш"</span>,
<span class="linenr"> 7551: </span>  <span class=
"org-string">"sime;"</span>: <span class="org-string">"≃"</span>,
<span class="linenr"> 7552: </span>  <span class=
"org-string">"simg;"</span>: <span class="org-string">"⪞"</span>,
<span class="linenr"> 7553: </span>  <span class=
"org-string">"siml;"</span>: <span class="org-string">"⪝"</span>,
<span class="linenr"> 7554: </span>  <span class=
"org-string">"smid;"</span>: <span class="org-string">"∣"</span>,
<span class="linenr"> 7555: </span>  <span class=
"org-string">"smte;"</span>: <span class="org-string">"⪬"</span>,
<span class="linenr"> 7556: </span>  <span class=
"org-string">"solb;"</span>: <span class="org-string">"⧄"</span>,
<span class="linenr"> 7557: </span>  <span class=
"org-string">"Sopf;"</span>: <span class="org-string">"𝕊"</span>,
<span class="linenr"> 7558: </span>  <span class=
"org-string">"sopf;"</span>: <span class="org-string">"𝕤"</span>,
<span class="linenr"> 7559: </span>  <span class=
"org-string">"spar;"</span>: <span class="org-string">"∥"</span>,
<span class="linenr"> 7560: </span>  <span class=
"org-string">"Sqrt;"</span>: <span class="org-string">"√"</span>,
<span class="linenr"> 7561: </span>  <span class=
"org-string">"squf;"</span>: <span class="org-string">"▪"</span>,
<span class="linenr"> 7562: </span>  <span class=
"org-string">"Sscr;"</span>: <span class="org-string">"𝒮"</span>,
<span class="linenr"> 7563: </span>  <span class=
"org-string">"sscr;"</span>: <span class="org-string">"𝓈"</span>,
<span class="linenr"> 7564: </span>  <span class=
"org-string">"Star;"</span>: <span class="org-string">"⋆"</span>,
<span class="linenr"> 7565: </span>  <span class=
"org-string">"star;"</span>: <span class="org-string">"☆"</span>,
<span class="linenr"> 7566: </span>  <span class=
"org-string">"subE;"</span>: <span class="org-string">"⫅"</span>,
<span class="linenr"> 7567: </span>  <span class=
"org-string">"sube;"</span>: <span class="org-string">"⊆"</span>,
<span class="linenr"> 7568: </span>  <span class=
"org-string">"succ;"</span>: <span class="org-string">"≻"</span>,
<span class="linenr"> 7569: </span>  <span class=
"org-string">"sung;"</span>: <span class="org-string">"♪"</span>,
<span class="linenr"> 7570: </span>  <span class=
"org-string">"sup1;"</span>: <span class="org-string">"¹"</span>,
<span class="linenr"> 7571: </span>  <span class=
"org-string">"sup2;"</span>: <span class="org-string">"²"</span>,
<span class="linenr"> 7572: </span>  <span class=
"org-string">"sup3;"</span>: <span class="org-string">"³"</span>,
<span class="linenr"> 7573: </span>  <span class=
"org-string">"supE;"</span>: <span class="org-string">"⫆"</span>,
<span class="linenr"> 7574: </span>  <span class=
"org-string">"supe;"</span>: <span class="org-string">"⊇"</span>,
<span class="linenr"> 7575: </span>  <span class=
"org-string">"szlig"</span>: <span class="org-string">"ß"</span>,
<span class="linenr"> 7576: </span>  <span class=
"org-string">"tbrk;"</span>: <span class="org-string">"⎴"</span>,
<span class="linenr"> 7577: </span>  <span class=
"org-string">"tdot;"</span>: <span class="org-string">"⃛"</span>,
<span class="linenr"> 7578: </span>  <span class=
"org-string">"THORN"</span>: <span class="org-string">"Þ"</span>,
<span class="linenr"> 7579: </span>  <span class=
"org-string">"thorn"</span>: <span class="org-string">"þ"</span>,
<span class="linenr"> 7580: </span>  <span class=
"org-string">"times"</span>: <span class="org-string">"×"</span>,
<span class="linenr"> 7581: </span>  <span class=
"org-string">"tint;"</span>: <span class="org-string">"∭"</span>,
<span class="linenr"> 7582: </span>  <span class=
"org-string">"toea;"</span>: <span class="org-string">"⤨"</span>,
<span class="linenr"> 7583: </span>  <span class=
"org-string">"Topf;"</span>: <span class="org-string">"𝕋"</span>,
<span class="linenr"> 7584: </span>  <span class=
"org-string">"topf;"</span>: <span class="org-string">"𝕥"</span>,
<span class="linenr"> 7585: </span>  <span class=
"org-string">"tosa;"</span>: <span class="org-string">"⤩"</span>,
<span class="linenr"> 7586: </span>  <span class=
"org-string">"trie;"</span>: <span class="org-string">"≜"</span>,
<span class="linenr"> 7587: </span>  <span class=
"org-string">"Tscr;"</span>: <span class="org-string">"𝒯"</span>,
<span class="linenr"> 7588: </span>  <span class=
"org-string">"tscr;"</span>: <span class="org-string">"𝓉"</span>,
<span class="linenr"> 7589: </span>  <span class=
"org-string">"TScy;"</span>: <span class="org-string">"Ц"</span>,
<span class="linenr"> 7590: </span>  <span class=
"org-string">"tscy;"</span>: <span class="org-string">"ц"</span>,
<span class="linenr"> 7591: </span>  <span class=
"org-string">"Uarr;"</span>: <span class="org-string">"↟"</span>,
<span class="linenr"> 7592: </span>  <span class=
"org-string">"uArr;"</span>: <span class="org-string">"⇑"</span>,
<span class="linenr"> 7593: </span>  <span class=
"org-string">"uarr;"</span>: <span class="org-string">"↑"</span>,
<span class="linenr"> 7594: </span>  <span class=
"org-string">"Ucirc"</span>: <span class="org-string">"Û"</span>,
<span class="linenr"> 7595: </span>  <span class=
"org-string">"ucirc"</span>: <span class="org-string">"û"</span>,
<span class="linenr"> 7596: </span>  <span class=
"org-string">"uHar;"</span>: <span class="org-string">"⥣"</span>,
<span class="linenr"> 7597: </span>  <span class=
"org-string">"Uopf;"</span>: <span class="org-string">"𝕌"</span>,
<span class="linenr"> 7598: </span>  <span class=
"org-string">"uopf;"</span>: <span class="org-string">"𝕦"</span>,
<span class="linenr"> 7599: </span>  <span class=
"org-string">"Upsi;"</span>: <span class="org-string">"ϒ"</span>,
<span class="linenr"> 7600: </span>  <span class=
"org-string">"upsi;"</span>: <span class="org-string">"υ"</span>,
<span class="linenr"> 7601: </span>  <span class=
"org-string">"Uscr;"</span>: <span class="org-string">"𝒰"</span>,
<span class="linenr"> 7602: </span>  <span class=
"org-string">"uscr;"</span>: <span class="org-string">"𝓊"</span>,
<span class="linenr"> 7603: </span>  <span class=
"org-string">"utri;"</span>: <span class="org-string">"▵"</span>,
<span class="linenr"> 7604: </span>  <span class=
"org-string">"Uuml;"</span>: <span class="org-string">"Ü"</span>,
<span class="linenr"> 7605: </span>  <span class=
"org-string">"uuml;"</span>: <span class="org-string">"ü"</span>,
<span class="linenr"> 7606: </span>  <span class=
"org-string">"vArr;"</span>: <span class="org-string">"⇕"</span>,
<span class="linenr"> 7607: </span>  <span class=
"org-string">"varr;"</span>: <span class="org-string">"↕"</span>,
<span class="linenr"> 7608: </span>  <span class=
"org-string">"Vbar;"</span>: <span class="org-string">"⫫"</span>,
<span class="linenr"> 7609: </span>  <span class=
"org-string">"vBar;"</span>: <span class="org-string">"⫨"</span>,
<span class="linenr"> 7610: </span>  <span class=
"org-string">"Vert;"</span>: <span class="org-string">"‖"</span>,
<span class="linenr"> 7611: </span>  <span class=
"org-string">"vert;"</span>: <span class="org-string">"|"</span>,
<span class="linenr"> 7612: </span>  <span class=
"org-string">"Vopf;"</span>: <span class="org-string">"𝕍"</span>,
<span class="linenr"> 7613: </span>  <span class=
"org-string">"vopf;"</span>: <span class="org-string">"𝕧"</span>,
<span class="linenr"> 7614: </span>  <span class=
"org-string">"Vscr;"</span>: <span class="org-string">"𝒱"</span>,
<span class="linenr"> 7615: </span>  <span class=
"org-string">"vscr;"</span>: <span class="org-string">"𝓋"</span>,
<span class="linenr"> 7616: </span>  <span class=
"org-string">"Wopf;"</span>: <span class="org-string">"𝕎"</span>,
<span class="linenr"> 7617: </span>  <span class=
"org-string">"wopf;"</span>: <span class="org-string">"𝕨"</span>,
<span class="linenr"> 7618: </span>  <span class=
"org-string">"Wscr;"</span>: <span class="org-string">"𝒲"</span>,
<span class="linenr"> 7619: </span>  <span class=
"org-string">"wscr;"</span>: <span class="org-string">"𝓌"</span>,
<span class="linenr"> 7620: </span>  <span class=
"org-string">"xcap;"</span>: <span class="org-string">"⋂"</span>,
<span class="linenr"> 7621: </span>  <span class=
"org-string">"xcup;"</span>: <span class="org-string">"⋃"</span>,
<span class="linenr"> 7622: </span>  <span class=
"org-string">"xmap;"</span>: <span class="org-string">"⟼"</span>,
<span class="linenr"> 7623: </span>  <span class=
"org-string">"xnis;"</span>: <span class="org-string">"⋻"</span>,
<span class="linenr"> 7624: </span>  <span class=
"org-string">"Xopf;"</span>: <span class="org-string">"𝕏"</span>,
<span class="linenr"> 7625: </span>  <span class=
"org-string">"xopf;"</span>: <span class="org-string">"𝕩"</span>,
<span class="linenr"> 7626: </span>  <span class=
"org-string">"Xscr;"</span>: <span class="org-string">"𝒳"</span>,
<span class="linenr"> 7627: </span>  <span class=
"org-string">"xscr;"</span>: <span class="org-string">"𝓍"</span>,
<span class="linenr"> 7628: </span>  <span class=
"org-string">"xvee;"</span>: <span class="org-string">"⋁"</span>,
<span class="linenr"> 7629: </span>  <span class=
"org-string">"YAcy;"</span>: <span class="org-string">"Я"</span>,
<span class="linenr"> 7630: </span>  <span class=
"org-string">"yacy;"</span>: <span class="org-string">"я"</span>,
<span class="linenr"> 7631: </span>  <span class=
"org-string">"YIcy;"</span>: <span class="org-string">"Ї"</span>,
<span class="linenr"> 7632: </span>  <span class=
"org-string">"yicy;"</span>: <span class="org-string">"ї"</span>,
<span class="linenr"> 7633: </span>  <span class=
"org-string">"Yopf;"</span>: <span class="org-string">"𝕐"</span>,
<span class="linenr"> 7634: </span>  <span class=
"org-string">"yopf;"</span>: <span class="org-string">"𝕪"</span>,
<span class="linenr"> 7635: </span>  <span class=
"org-string">"Yscr;"</span>: <span class="org-string">"𝒴"</span>,
<span class="linenr"> 7636: </span>  <span class=
"org-string">"yscr;"</span>: <span class="org-string">"𝓎"</span>,
<span class="linenr"> 7637: </span>  <span class=
"org-string">"YUcy;"</span>: <span class="org-string">"Ю"</span>,
<span class="linenr"> 7638: </span>  <span class=
"org-string">"yucy;"</span>: <span class="org-string">"ю"</span>,
<span class="linenr"> 7639: </span>  <span class=
"org-string">"Yuml;"</span>: <span class="org-string">"Ÿ"</span>,
<span class="linenr"> 7640: </span>  <span class=
"org-string">"yuml;"</span>: <span class="org-string">"ÿ"</span>,
<span class="linenr"> 7641: </span>  <span class=
"org-string">"Zdot;"</span>: <span class="org-string">"Ż"</span>,
<span class="linenr"> 7642: </span>  <span class=
"org-string">"zdot;"</span>: <span class="org-string">"ż"</span>,
<span class="linenr"> 7643: </span>  <span class=
"org-string">"Zeta;"</span>: <span class="org-string">"Ζ"</span>,
<span class="linenr"> 7644: </span>  <span class=
"org-string">"zeta;"</span>: <span class="org-string">"ζ"</span>,
<span class="linenr"> 7645: </span>  <span class=
"org-string">"ZHcy;"</span>: <span class="org-string">"Ж"</span>,
<span class="linenr"> 7646: </span>  <span class=
"org-string">"zhcy;"</span>: <span class="org-string">"ж"</span>,
<span class="linenr"> 7647: </span>  <span class=
"org-string">"Zopf;"</span>: <span class="org-string">"ℤ"</span>,
<span class="linenr"> 7648: </span>  <span class=
"org-string">"zopf;"</span>: <span class="org-string">"𝕫"</span>,
<span class="linenr"> 7649: </span>  <span class=
"org-string">"Zscr;"</span>: <span class="org-string">"𝒵"</span>,
<span class="linenr"> 7650: </span>  <span class=
"org-string">"zscr;"</span>: <span class="org-string">"𝓏"</span>,
<span class="linenr"> 7651: </span>  <span class=
"org-string">"zwnj;"</span>: <span class="org-string">"‌"</span>,
<span class="linenr"> 7652: </span>  <span class=
"org-string">"Aacute"</span>: <span class="org-string">"Á"</span>,
<span class="linenr"> 7653: </span>  <span class=
"org-string">"aacute"</span>: <span class="org-string">"á"</span>,
<span class="linenr"> 7654: </span>  <span class=
"org-string">"Acirc;"</span>: <span class="org-string">"Â"</span>,
<span class="linenr"> 7655: </span>  <span class=
"org-string">"acirc;"</span>: <span class="org-string">"â"</span>,
<span class="linenr"> 7656: </span>  <span class=
"org-string">"acute;"</span>: <span class="org-string">"´"</span>,
<span class="linenr"> 7657: </span>  <span class=
"org-string">"AElig;"</span>: <span class="org-string">"Æ"</span>,
<span class="linenr"> 7658: </span>  <span class=
"org-string">"aelig;"</span>: <span class="org-string">"æ"</span>,
<span class="linenr"> 7659: </span>  <span class=
"org-string">"Agrave"</span>: <span class="org-string">"À"</span>,
<span class="linenr"> 7660: </span>  <span class=
"org-string">"agrave"</span>: <span class="org-string">"à"</span>,
<span class="linenr"> 7661: </span>  <span class=
"org-string">"aleph;"</span>: <span class="org-string">"ℵ"</span>,
<span class="linenr"> 7662: </span>  <span class=
"org-string">"Alpha;"</span>: <span class="org-string">"Α"</span>,
<span class="linenr"> 7663: </span>  <span class=
"org-string">"alpha;"</span>: <span class="org-string">"α"</span>,
<span class="linenr"> 7664: </span>  <span class=
"org-string">"Amacr;"</span>: <span class="org-string">"Ā"</span>,
<span class="linenr"> 7665: </span>  <span class=
"org-string">"amacr;"</span>: <span class="org-string">"ā"</span>,
<span class="linenr"> 7666: </span>  <span class=
"org-string">"amalg;"</span>: <span class="org-string">"⨿"</span>,
<span class="linenr"> 7667: </span>  <span class=
"org-string">"angle;"</span>: <span class="org-string">"∠"</span>,
<span class="linenr"> 7668: </span>  <span class=
"org-string">"angrt;"</span>: <span class="org-string">"∟"</span>,
<span class="linenr"> 7669: </span>  <span class=
"org-string">"angst;"</span>: <span class="org-string">"Å"</span>,
<span class="linenr"> 7670: </span>  <span class=
"org-string">"Aogon;"</span>: <span class="org-string">"Ą"</span>,
<span class="linenr"> 7671: </span>  <span class=
"org-string">"aogon;"</span>: <span class="org-string">"ą"</span>,
<span class="linenr"> 7672: </span>  <span class=
"org-string">"Aring;"</span>: <span class="org-string">"Å"</span>,
<span class="linenr"> 7673: </span>  <span class=
"org-string">"aring;"</span>: <span class="org-string">"å"</span>,
<span class="linenr"> 7674: </span>  <span class=
"org-string">"asymp;"</span>: <span class="org-string">"≈"</span>,
<span class="linenr"> 7675: </span>  <span class=
"org-string">"Atilde"</span>: <span class="org-string">"Ã"</span>,
<span class="linenr"> 7676: </span>  <span class=
"org-string">"atilde"</span>: <span class="org-string">"ã"</span>,
<span class="linenr"> 7677: </span>  <span class=
"org-string">"awint;"</span>: <span class="org-string">"⨑"</span>,
<span class="linenr"> 7678: </span>  <span class=
"org-string">"bcong;"</span>: <span class="org-string">"≌"</span>,
<span class="linenr"> 7679: </span>  <span class=
"org-string">"bdquo;"</span>: <span class="org-string">"„"</span>,
<span class="linenr"> 7680: </span>  <span class=
"org-string">"bepsi;"</span>: <span class="org-string">"϶"</span>,
<span class="linenr"> 7681: </span>  <span class=
"org-string">"blank;"</span>: <span class="org-string">"␣"</span>,
<span class="linenr"> 7682: </span>  <span class=
"org-string">"blk12;"</span>: <span class="org-string">"▒"</span>,
<span class="linenr"> 7683: </span>  <span class=
"org-string">"blk14;"</span>: <span class="org-string">"░"</span>,
<span class="linenr"> 7684: </span>  <span class=
"org-string">"blk34;"</span>: <span class="org-string">"▓"</span>,
<span class="linenr"> 7685: </span>  <span class=
"org-string">"block;"</span>: <span class="org-string">"█"</span>,
<span class="linenr"> 7686: </span>  <span class=
"org-string">"boxDL;"</span>: <span class="org-string">"╗"</span>,
<span class="linenr"> 7687: </span>  <span class=
"org-string">"boxDl;"</span>: <span class="org-string">"╖"</span>,
<span class="linenr"> 7688: </span>  <span class=
"org-string">"boxdL;"</span>: <span class="org-string">"╕"</span>,
<span class="linenr"> 7689: </span>  <span class=
"org-string">"boxdl;"</span>: <span class="org-string">"┐"</span>,
<span class="linenr"> 7690: </span>  <span class=
"org-string">"boxDR;"</span>: <span class="org-string">"╔"</span>,
<span class="linenr"> 7691: </span>  <span class=
"org-string">"boxDr;"</span>: <span class="org-string">"╓"</span>,
<span class="linenr"> 7692: </span>  <span class=
"org-string">"boxdR;"</span>: <span class="org-string">"╒"</span>,
<span class="linenr"> 7693: </span>  <span class=
"org-string">"boxdr;"</span>: <span class="org-string">"┌"</span>,
<span class="linenr"> 7694: </span>  <span class=
"org-string">"boxHD;"</span>: <span class="org-string">"╦"</span>,
<span class="linenr"> 7695: </span>  <span class=
"org-string">"boxHd;"</span>: <span class="org-string">"╤"</span>,
<span class="linenr"> 7696: </span>  <span class=
"org-string">"boxhD;"</span>: <span class="org-string">"╥"</span>,
<span class="linenr"> 7697: </span>  <span class=
"org-string">"boxhd;"</span>: <span class="org-string">"┬"</span>,
<span class="linenr"> 7698: </span>  <span class=
"org-string">"boxHU;"</span>: <span class="org-string">"╩"</span>,
<span class="linenr"> 7699: </span>  <span class=
"org-string">"boxHu;"</span>: <span class="org-string">"╧"</span>,
<span class="linenr"> 7700: </span>  <span class=
"org-string">"boxhU;"</span>: <span class="org-string">"╨"</span>,
<span class="linenr"> 7701: </span>  <span class=
"org-string">"boxhu;"</span>: <span class="org-string">"┴"</span>,
<span class="linenr"> 7702: </span>  <span class=
"org-string">"boxUL;"</span>: <span class="org-string">"╝"</span>,
<span class="linenr"> 7703: </span>  <span class=
"org-string">"boxUl;"</span>: <span class="org-string">"╜"</span>,
<span class="linenr"> 7704: </span>  <span class=
"org-string">"boxuL;"</span>: <span class="org-string">"╛"</span>,
<span class="linenr"> 7705: </span>  <span class=
"org-string">"boxul;"</span>: <span class="org-string">"┘"</span>,
<span class="linenr"> 7706: </span>  <span class=
"org-string">"boxUR;"</span>: <span class="org-string">"╚"</span>,
<span class="linenr"> 7707: </span>  <span class=
"org-string">"boxUr;"</span>: <span class="org-string">"╙"</span>,
<span class="linenr"> 7708: </span>  <span class=
"org-string">"boxuR;"</span>: <span class="org-string">"╘"</span>,
<span class="linenr"> 7709: </span>  <span class=
"org-string">"boxur;"</span>: <span class="org-string">"└"</span>,
<span class="linenr"> 7710: </span>  <span class=
"org-string">"boxVH;"</span>: <span class="org-string">"╬"</span>,
<span class="linenr"> 7711: </span>  <span class=
"org-string">"boxVh;"</span>: <span class="org-string">"╫"</span>,
<span class="linenr"> 7712: </span>  <span class=
"org-string">"boxvH;"</span>: <span class="org-string">"╪"</span>,
<span class="linenr"> 7713: </span>  <span class=
"org-string">"boxvh;"</span>: <span class="org-string">"┼"</span>,
<span class="linenr"> 7714: </span>  <span class=
"org-string">"boxVL;"</span>: <span class="org-string">"╣"</span>,
<span class="linenr"> 7715: </span>  <span class=
"org-string">"boxVl;"</span>: <span class="org-string">"╢"</span>,
<span class="linenr"> 7716: </span>  <span class=
"org-string">"boxvL;"</span>: <span class="org-string">"╡"</span>,
<span class="linenr"> 7717: </span>  <span class=
"org-string">"boxvl;"</span>: <span class="org-string">"┤"</span>,
<span class="linenr"> 7718: </span>  <span class=
"org-string">"boxVR;"</span>: <span class="org-string">"╠"</span>,
<span class="linenr"> 7719: </span>  <span class=
"org-string">"boxVr;"</span>: <span class="org-string">"╟"</span>,
<span class="linenr"> 7720: </span>  <span class=
"org-string">"boxvR;"</span>: <span class="org-string">"╞"</span>,
<span class="linenr"> 7721: </span>  <span class=
"org-string">"boxvr;"</span>: <span class="org-string">"├"</span>,
<span class="linenr"> 7722: </span>  <span class=
"org-string">"Breve;"</span>: <span class="org-string">"˘"</span>,
<span class="linenr"> 7723: </span>  <span class=
"org-string">"breve;"</span>: <span class="org-string">"˘"</span>,
<span class="linenr"> 7724: </span>  <span class=
"org-string">"brvbar"</span>: <span class="org-string">"¦"</span>,
<span class="linenr"> 7725: </span>  <span class=
"org-string">"bsemi;"</span>: <span class="org-string">"⁏"</span>,
<span class="linenr"> 7726: </span>  <span class=
"org-string">"bsime;"</span>: <span class="org-string">"⋍"</span>,
<span class="linenr"> 7727: </span>  <span class=
"org-string">"bsolb;"</span>: <span class="org-string">"⧅"</span>,
<span class="linenr"> 7728: </span>  <span class=
"org-string">"bumpE;"</span>: <span class="org-string">"⪮"</span>,
<span class="linenr"> 7729: </span>  <span class=
"org-string">"bumpe;"</span>: <span class="org-string">"≏"</span>,
<span class="linenr"> 7730: </span>  <span class=
"org-string">"caret;"</span>: <span class="org-string">"⁁"</span>,
<span class="linenr"> 7731: </span>  <span class=
"org-string">"caron;"</span>: <span class="org-string">"ˇ"</span>,
<span class="linenr"> 7732: </span>  <span class=
"org-string">"ccaps;"</span>: <span class="org-string">"⩍"</span>,
<span class="linenr"> 7733: </span>  <span class=
"org-string">"Ccedil"</span>: <span class="org-string">"Ç"</span>,
<span class="linenr"> 7734: </span>  <span class=
"org-string">"ccedil"</span>: <span class="org-string">"ç"</span>,
<span class="linenr"> 7735: </span>  <span class=
"org-string">"Ccirc;"</span>: <span class="org-string">"Ĉ"</span>,
<span class="linenr"> 7736: </span>  <span class=
"org-string">"ccirc;"</span>: <span class="org-string">"ĉ"</span>,
<span class="linenr"> 7737: </span>  <span class=
"org-string">"ccups;"</span>: <span class="org-string">"⩌"</span>,
<span class="linenr"> 7738: </span>  <span class=
"org-string">"cedil;"</span>: <span class="org-string">"¸"</span>,
<span class="linenr"> 7739: </span>  <span class=
"org-string">"check;"</span>: <span class="org-string">"✓"</span>,
<span class="linenr"> 7740: </span>  <span class=
"org-string">"clubs;"</span>: <span class="org-string">"♣"</span>,
<span class="linenr"> 7741: </span>  <span class=
"org-string">"Colon;"</span>: <span class="org-string">"∷"</span>,
<span class="linenr"> 7742: </span>  <span class=
"org-string">"colon;"</span>: <span class="org-string">":"</span>,
<span class="linenr"> 7743: </span>  <span class=
"org-string">"comma;"</span>: <span class="org-string">","</span>,
<span class="linenr"> 7744: </span>  <span class=
"org-string">"crarr;"</span>: <span class="org-string">"↵"</span>,
<span class="linenr"> 7745: </span>  <span class=
"org-string">"Cross;"</span>: <span class="org-string">"⨯"</span>,
<span class="linenr"> 7746: </span>  <span class=
"org-string">"cross;"</span>: <span class="org-string">"✗"</span>,
<span class="linenr"> 7747: </span>  <span class=
"org-string">"csube;"</span>: <span class="org-string">"⫑"</span>,
<span class="linenr"> 7748: </span>  <span class=
"org-string">"csupe;"</span>: <span class="org-string">"⫒"</span>,
<span class="linenr"> 7749: </span>  <span class=
"org-string">"ctdot;"</span>: <span class="org-string">"⋯"</span>,
<span class="linenr"> 7750: </span>  <span class=
"org-string">"cuepr;"</span>: <span class="org-string">"⋞"</span>,
<span class="linenr"> 7751: </span>  <span class=
"org-string">"cuesc;"</span>: <span class="org-string">"⋟"</span>,
<span class="linenr"> 7752: </span>  <span class=
"org-string">"cupor;"</span>: <span class="org-string">"⩅"</span>,
<span class="linenr"> 7753: </span>  <span class=
"org-string">"curren"</span>: <span class="org-string">"¤"</span>,
<span class="linenr"> 7754: </span>  <span class=
"org-string">"cuvee;"</span>: <span class="org-string">"⋎"</span>,
<span class="linenr"> 7755: </span>  <span class=
"org-string">"cuwed;"</span>: <span class="org-string">"⋏"</span>,
<span class="linenr"> 7756: </span>  <span class=
"org-string">"cwint;"</span>: <span class="org-string">"∱"</span>,
<span class="linenr"> 7757: </span>  <span class=
"org-string">"Dashv;"</span>: <span class="org-string">"⫤"</span>,
<span class="linenr"> 7758: </span>  <span class=
"org-string">"dashv;"</span>: <span class="org-string">"⊣"</span>,
<span class="linenr"> 7759: </span>  <span class=
"org-string">"dblac;"</span>: <span class="org-string">"˝"</span>,
<span class="linenr"> 7760: </span>  <span class=
"org-string">"ddarr;"</span>: <span class="org-string">"⇊"</span>,
<span class="linenr"> 7761: </span>  <span class=
"org-string">"Delta;"</span>: <span class="org-string">"Δ"</span>,
<span class="linenr"> 7762: </span>  <span class=
"org-string">"delta;"</span>: <span class="org-string">"δ"</span>,
<span class="linenr"> 7763: </span>  <span class=
"org-string">"dharl;"</span>: <span class="org-string">"⇃"</span>,
<span class="linenr"> 7764: </span>  <span class=
"org-string">"dharr;"</span>: <span class="org-string">"⇂"</span>,
<span class="linenr"> 7765: </span>  <span class=
"org-string">"diams;"</span>: <span class="org-string">"♦"</span>,
<span class="linenr"> 7766: </span>  <span class=
"org-string">"disin;"</span>: <span class="org-string">"⋲"</span>,
<span class="linenr"> 7767: </span>  <span class=
"org-string">"divide"</span>: <span class="org-string">"÷"</span>,
<span class="linenr"> 7768: </span>  <span class=
"org-string">"doteq;"</span>: <span class="org-string">"≐"</span>,
<span class="linenr"> 7769: </span>  <span class=
"org-string">"dtdot;"</span>: <span class="org-string">"⋱"</span>,
<span class="linenr"> 7770: </span>  <span class=
"org-string">"dtrif;"</span>: <span class="org-string">"▾"</span>,
<span class="linenr"> 7771: </span>  <span class=
"org-string">"duarr;"</span>: <span class="org-string">"⇵"</span>,
<span class="linenr"> 7772: </span>  <span class=
"org-string">"duhar;"</span>: <span class="org-string">"⥯"</span>,
<span class="linenr"> 7773: </span>  <span class=
"org-string">"Eacute"</span>: <span class="org-string">"É"</span>,
<span class="linenr"> 7774: </span>  <span class=
"org-string">"eacute"</span>: <span class="org-string">"é"</span>,
<span class="linenr"> 7775: </span>  <span class=
"org-string">"Ecirc;"</span>: <span class="org-string">"Ê"</span>,
<span class="linenr"> 7776: </span>  <span class=
"org-string">"ecirc;"</span>: <span class="org-string">"ê"</span>,
<span class="linenr"> 7777: </span>  <span class=
"org-string">"eDDot;"</span>: <span class="org-string">"⩷"</span>,
<span class="linenr"> 7778: </span>  <span class=
"org-string">"efDot;"</span>: <span class="org-string">"≒"</span>,
<span class="linenr"> 7779: </span>  <span class=
"org-string">"Egrave"</span>: <span class="org-string">"È"</span>,
<span class="linenr"> 7780: </span>  <span class=
"org-string">"egrave"</span>: <span class="org-string">"è"</span>,
<span class="linenr"> 7781: </span>  <span class=
"org-string">"Emacr;"</span>: <span class="org-string">"Ē"</span>,
<span class="linenr"> 7782: </span>  <span class=
"org-string">"emacr;"</span>: <span class="org-string">"ē"</span>,
<span class="linenr"> 7783: </span>  <span class=
"org-string">"empty;"</span>: <span class="org-string">"∅"</span>,
<span class="linenr"> 7784: </span>  <span class=
"org-string">"Eogon;"</span>: <span class="org-string">"Ę"</span>,
<span class="linenr"> 7785: </span>  <span class=
"org-string">"eogon;"</span>: <span class="org-string">"ę"</span>,
<span class="linenr"> 7786: </span>  <span class=
"org-string">"eplus;"</span>: <span class="org-string">"⩱"</span>,
<span class="linenr"> 7787: </span>  <span class=
"org-string">"epsiv;"</span>: <span class="org-string">"ϵ"</span>,
<span class="linenr"> 7788: </span>  <span class=
"org-string">"eqsim;"</span>: <span class="org-string">"≂"</span>,
<span class="linenr"> 7789: </span>  <span class=
"org-string">"Equal;"</span>: <span class="org-string">"⩵"</span>,
<span class="linenr"> 7790: </span>  <span class=
"org-string">"equiv;"</span>: <span class="org-string">"≡"</span>,
<span class="linenr"> 7791: </span>  <span class=
"org-string">"erarr;"</span>: <span class="org-string">"⥱"</span>,
<span class="linenr"> 7792: </span>  <span class=
"org-string">"erDot;"</span>: <span class="org-string">"≓"</span>,
<span class="linenr"> 7793: </span>  <span class=
"org-string">"esdot;"</span>: <span class="org-string">"≐"</span>,
<span class="linenr"> 7794: </span>  <span class=
"org-string">"exist;"</span>: <span class="org-string">"∃"</span>,
<span class="linenr"> 7795: </span>  <span class=
"org-string">"fflig;"</span>: <span class="org-string">"ﬀ"</span>,
<span class="linenr"> 7796: </span>  <span class=
"org-string">"filig;"</span>: <span class="org-string">"ﬁ"</span>,
<span class="linenr"> 7797: </span>  <span class=
"org-string">"fjlig;"</span>: <span class="org-string">"fj"</span>,
<span class="linenr"> 7798: </span>  <span class=
"org-string">"fllig;"</span>: <span class="org-string">"ﬂ"</span>,
<span class="linenr"> 7799: </span>  <span class=
"org-string">"fltns;"</span>: <span class="org-string">"▱"</span>,
<span class="linenr"> 7800: </span>  <span class=
"org-string">"forkv;"</span>: <span class="org-string">"⫙"</span>,
<span class="linenr"> 7801: </span>  <span class=
"org-string">"frac12"</span>: <span class="org-string">"½"</span>,
<span class="linenr"> 7802: </span>  <span class=
"org-string">"frac14"</span>: <span class="org-string">"¼"</span>,
<span class="linenr"> 7803: </span>  <span class=
"org-string">"frac34"</span>: <span class="org-string">"¾"</span>,
<span class="linenr"> 7804: </span>  <span class=
"org-string">"frasl;"</span>: <span class="org-string">"⁄"</span>,
<span class="linenr"> 7805: </span>  <span class=
"org-string">"frown;"</span>: <span class="org-string">"⌢"</span>,
<span class="linenr"> 7806: </span>  <span class=
"org-string">"Gamma;"</span>: <span class="org-string">"Γ"</span>,
<span class="linenr"> 7807: </span>  <span class=
"org-string">"gamma;"</span>: <span class="org-string">"γ"</span>,
<span class="linenr"> 7808: </span>  <span class=
"org-string">"Gcirc;"</span>: <span class="org-string">"Ĝ"</span>,
<span class="linenr"> 7809: </span>  <span class=
"org-string">"gcirc;"</span>: <span class="org-string">"ĝ"</span>,
<span class="linenr"> 7810: </span>  <span class=
"org-string">"gescc;"</span>: <span class="org-string">"⪩"</span>,
<span class="linenr"> 7811: </span>  <span class=
"org-string">"gimel;"</span>: <span class="org-string">"ℷ"</span>,
<span class="linenr"> 7812: </span>  <span class=
"org-string">"gneqq;"</span>: <span class="org-string">"≩"</span>,
<span class="linenr"> 7813: </span>  <span class=
"org-string">"gnsim;"</span>: <span class="org-string">"⋧"</span>,
<span class="linenr"> 7814: </span>  <span class=
"org-string">"grave;"</span>: <span class="org-string">"`"</span>,
<span class="linenr"> 7815: </span>  <span class=
"org-string">"gsime;"</span>: <span class="org-string">"⪎"</span>,
<span class="linenr"> 7816: </span>  <span class=
"org-string">"gsiml;"</span>: <span class="org-string">"⪐"</span>,
<span class="linenr"> 7817: </span>  <span class=
"org-string">"gtcir;"</span>: <span class="org-string">"⩺"</span>,
<span class="linenr"> 7818: </span>  <span class=
"org-string">"gtdot;"</span>: <span class="org-string">"⋗"</span>,
<span class="linenr"> 7819: </span>  <span class=
"org-string">"Hacek;"</span>: <span class="org-string">"ˇ"</span>,
<span class="linenr"> 7820: </span>  <span class=
"org-string">"harrw;"</span>: <span class="org-string">"↭"</span>,
<span class="linenr"> 7821: </span>  <span class=
"org-string">"Hcirc;"</span>: <span class="org-string">"Ĥ"</span>,
<span class="linenr"> 7822: </span>  <span class=
"org-string">"hcirc;"</span>: <span class="org-string">"ĥ"</span>,
<span class="linenr"> 7823: </span>  <span class=
"org-string">"hoarr;"</span>: <span class="org-string">"⇿"</span>,
<span class="linenr"> 7824: </span>  <span class=
"org-string">"Iacute"</span>: <span class="org-string">"Í"</span>,
<span class="linenr"> 7825: </span>  <span class=
"org-string">"iacute"</span>: <span class="org-string">"í"</span>,
<span class="linenr"> 7826: </span>  <span class=
"org-string">"Icirc;"</span>: <span class="org-string">"Î"</span>,
<span class="linenr"> 7827: </span>  <span class=
"org-string">"icirc;"</span>: <span class="org-string">"î"</span>,
<span class="linenr"> 7828: </span>  <span class=
"org-string">"iexcl;"</span>: <span class="org-string">"¡"</span>,
<span class="linenr"> 7829: </span>  <span class=
"org-string">"Igrave"</span>: <span class="org-string">"Ì"</span>,
<span class="linenr"> 7830: </span>  <span class=
"org-string">"igrave"</span>: <span class="org-string">"ì"</span>,
<span class="linenr"> 7831: </span>  <span class=
"org-string">"iiint;"</span>: <span class="org-string">"∭"</span>,
<span class="linenr"> 7832: </span>  <span class=
"org-string">"iiota;"</span>: <span class="org-string">"℩"</span>,
<span class="linenr"> 7833: </span>  <span class=
"org-string">"IJlig;"</span>: <span class="org-string">"Ĳ"</span>,
<span class="linenr"> 7834: </span>  <span class=
"org-string">"ijlig;"</span>: <span class="org-string">"ĳ"</span>,
<span class="linenr"> 7835: </span>  <span class=
"org-string">"Imacr;"</span>: <span class="org-string">"Ī"</span>,
<span class="linenr"> 7836: </span>  <span class=
"org-string">"imacr;"</span>: <span class="org-string">"ī"</span>,
<span class="linenr"> 7837: </span>  <span class=
"org-string">"image;"</span>: <span class="org-string">"ℑ"</span>,
<span class="linenr"> 7838: </span>  <span class=
"org-string">"imath;"</span>: <span class="org-string">"ı"</span>,
<span class="linenr"> 7839: </span>  <span class=
"org-string">"imped;"</span>: <span class="org-string">"Ƶ"</span>,
<span class="linenr"> 7840: </span>  <span class=
"org-string">"infin;"</span>: <span class="org-string">"∞"</span>,
<span class="linenr"> 7841: </span>  <span class=
"org-string">"Iogon;"</span>: <span class="org-string">"Į"</span>,
<span class="linenr"> 7842: </span>  <span class=
"org-string">"iogon;"</span>: <span class="org-string">"į"</span>,
<span class="linenr"> 7843: </span>  <span class=
"org-string">"iprod;"</span>: <span class="org-string">"⨼"</span>,
<span class="linenr"> 7844: </span>  <span class=
"org-string">"iquest"</span>: <span class="org-string">"¿"</span>,
<span class="linenr"> 7845: </span>  <span class=
"org-string">"isinE;"</span>: <span class="org-string">"⋹"</span>,
<span class="linenr"> 7846: </span>  <span class=
"org-string">"isins;"</span>: <span class="org-string">"⋴"</span>,
<span class="linenr"> 7847: </span>  <span class=
"org-string">"isinv;"</span>: <span class="org-string">"∈"</span>,
<span class="linenr"> 7848: </span>  <span class=
"org-string">"Iukcy;"</span>: <span class="org-string">"І"</span>,
<span class="linenr"> 7849: </span>  <span class=
"org-string">"iukcy;"</span>: <span class="org-string">"і"</span>,
<span class="linenr"> 7850: </span>  <span class=
"org-string">"Jcirc;"</span>: <span class="org-string">"Ĵ"</span>,
<span class="linenr"> 7851: </span>  <span class=
"org-string">"jcirc;"</span>: <span class="org-string">"ĵ"</span>,
<span class="linenr"> 7852: </span>  <span class=
"org-string">"jmath;"</span>: <span class="org-string">"ȷ"</span>,
<span class="linenr"> 7853: </span>  <span class=
"org-string">"Jukcy;"</span>: <span class="org-string">"Є"</span>,
<span class="linenr"> 7854: </span>  <span class=
"org-string">"jukcy;"</span>: <span class="org-string">"є"</span>,
<span class="linenr"> 7855: </span>  <span class=
"org-string">"Kappa;"</span>: <span class="org-string">"Κ"</span>,
<span class="linenr"> 7856: </span>  <span class=
"org-string">"kappa;"</span>: <span class="org-string">"κ"</span>,
<span class="linenr"> 7857: </span>  <span class=
"org-string">"lAarr;"</span>: <span class="org-string">"⇚"</span>,
<span class="linenr"> 7858: </span>  <span class=
"org-string">"langd;"</span>: <span class="org-string">"⦑"</span>,
<span class="linenr"> 7859: </span>  <span class=
"org-string">"laquo;"</span>: <span class="org-string">"«"</span>,
<span class="linenr"> 7860: </span>  <span class=
"org-string">"larrb;"</span>: <span class="org-string">"⇤"</span>,
<span class="linenr"> 7861: </span>  <span class=
"org-string">"lates;"</span>: <span class="org-string">"⪭︀"</span>,
<span class="linenr"> 7862: </span>  <span class=
"org-string">"lBarr;"</span>: <span class="org-string">"⤎"</span>,
<span class="linenr"> 7863: </span>  <span class=
"org-string">"lbarr;"</span>: <span class="org-string">"⤌"</span>,
<span class="linenr"> 7864: </span>  <span class=
"org-string">"lbbrk;"</span>: <span class="org-string">"❲"</span>,
<span class="linenr"> 7865: </span>  <span class=
"org-string">"lbrke;"</span>: <span class="org-string">"⦋"</span>,
<span class="linenr"> 7866: </span>  <span class=
"org-string">"lceil;"</span>: <span class="org-string">"⌈"</span>,
<span class="linenr"> 7867: </span>  <span class=
"org-string">"ldquo;"</span>: <span class="org-string">"“"</span>,
<span class="linenr"> 7868: </span>  <span class=
"org-string">"lescc;"</span>: <span class="org-string">"⪨"</span>,
<span class="linenr"> 7869: </span>  <span class=
"org-string">"lhard;"</span>: <span class="org-string">"↽"</span>,
<span class="linenr"> 7870: </span>  <span class=
"org-string">"lharu;"</span>: <span class="org-string">"↼"</span>,
<span class="linenr"> 7871: </span>  <span class=
"org-string">"lhblk;"</span>: <span class="org-string">"▄"</span>,
<span class="linenr"> 7872: </span>  <span class=
"org-string">"llarr;"</span>: <span class="org-string">"⇇"</span>,
<span class="linenr"> 7873: </span>  <span class=
"org-string">"lltri;"</span>: <span class="org-string">"◺"</span>,
<span class="linenr"> 7874: </span>  <span class=
"org-string">"lneqq;"</span>: <span class="org-string">"≨"</span>,
<span class="linenr"> 7875: </span>  <span class=
"org-string">"lnsim;"</span>: <span class="org-string">"⋦"</span>,
<span class="linenr"> 7876: </span>  <span class=
"org-string">"loang;"</span>: <span class="org-string">"⟬"</span>,
<span class="linenr"> 7877: </span>  <span class=
"org-string">"loarr;"</span>: <span class="org-string">"⇽"</span>,
<span class="linenr"> 7878: </span>  <span class=
"org-string">"lobrk;"</span>: <span class="org-string">"⟦"</span>,
<span class="linenr"> 7879: </span>  <span class=
"org-string">"lopar;"</span>: <span class="org-string">"⦅"</span>,
<span class="linenr"> 7880: </span>  <span class=
"org-string">"lrarr;"</span>: <span class="org-string">"⇆"</span>,
<span class="linenr"> 7881: </span>  <span class=
"org-string">"lrhar;"</span>: <span class="org-string">"⇋"</span>,
<span class="linenr"> 7882: </span>  <span class=
"org-string">"lrtri;"</span>: <span class="org-string">"⊿"</span>,
<span class="linenr"> 7883: </span>  <span class=
"org-string">"lsime;"</span>: <span class="org-string">"⪍"</span>,
<span class="linenr"> 7884: </span>  <span class=
"org-string">"lsimg;"</span>: <span class="org-string">"⪏"</span>,
<span class="linenr"> 7885: </span>  <span class=
"org-string">"lsquo;"</span>: <span class="org-string">"‘"</span>,
<span class="linenr"> 7886: </span>  <span class=
"org-string">"ltcir;"</span>: <span class="org-string">"⩹"</span>,
<span class="linenr"> 7887: </span>  <span class=
"org-string">"ltdot;"</span>: <span class="org-string">"⋖"</span>,
<span class="linenr"> 7888: </span>  <span class=
"org-string">"ltrie;"</span>: <span class="org-string">"⊴"</span>,
<span class="linenr"> 7889: </span>  <span class=
"org-string">"ltrif;"</span>: <span class="org-string">"◂"</span>,
<span class="linenr"> 7890: </span>  <span class=
"org-string">"mdash;"</span>: <span class="org-string">"—"</span>,
<span class="linenr"> 7891: </span>  <span class=
"org-string">"mDDot;"</span>: <span class="org-string">"∺"</span>,
<span class="linenr"> 7892: </span>  <span class=
"org-string">"micro;"</span>: <span class="org-string">"µ"</span>,
<span class="linenr"> 7893: </span>  <span class=
"org-string">"middot"</span>: <span class="org-string">"·"</span>,
<span class="linenr"> 7894: </span>  <span class=
"org-string">"minus;"</span>: <span class="org-string">"−"</span>,
<span class="linenr"> 7895: </span>  <span class=
"org-string">"mumap;"</span>: <span class="org-string">"⊸"</span>,
<span class="linenr"> 7896: </span>  <span class=
"org-string">"nabla;"</span>: <span class="org-string">"∇"</span>,
<span class="linenr"> 7897: </span>  <span class=
"org-string">"napid;"</span>: <span class="org-string">"≋̸"</span>,
<span class="linenr"> 7898: </span>  <span class=
"org-string">"napos;"</span>: <span class="org-string">"ŉ"</span>,
<span class="linenr"> 7899: </span>  <span class=
"org-string">"natur;"</span>: <span class="org-string">"♮"</span>,
<span class="linenr"> 7900: </span>  <span class=
"org-string">"nbump;"</span>: <span class="org-string">"≎̸"</span>,
<span class="linenr"> 7901: </span>  <span class=
"org-string">"ncong;"</span>: <span class="org-string">"≇"</span>,
<span class="linenr"> 7902: </span>  <span class=
"org-string">"ndash;"</span>: <span class="org-string">"–"</span>,
<span class="linenr"> 7903: </span>  <span class=
"org-string">"neArr;"</span>: <span class="org-string">"⇗"</span>,
<span class="linenr"> 7904: </span>  <span class=
"org-string">"nearr;"</span>: <span class="org-string">"↗"</span>,
<span class="linenr"> 7905: </span>  <span class=
"org-string">"nedot;"</span>: <span class="org-string">"≐̸"</span>,
<span class="linenr"> 7906: </span>  <span class=
"org-string">"nesim;"</span>: <span class="org-string">"≂̸"</span>,
<span class="linenr"> 7907: </span>  <span class=
"org-string">"ngeqq;"</span>: <span class="org-string">"≧̸"</span>,
<span class="linenr"> 7908: </span>  <span class=
"org-string">"ngsim;"</span>: <span class="org-string">"≵"</span>,
<span class="linenr"> 7909: </span>  <span class=
"org-string">"nhArr;"</span>: <span class="org-string">"⇎"</span>,
<span class="linenr"> 7910: </span>  <span class=
"org-string">"nharr;"</span>: <span class="org-string">"↮"</span>,
<span class="linenr"> 7911: </span>  <span class=
"org-string">"nhpar;"</span>: <span class="org-string">"⫲"</span>,
<span class="linenr"> 7912: </span>  <span class=
"org-string">"nlArr;"</span>: <span class="org-string">"⇍"</span>,
<span class="linenr"> 7913: </span>  <span class=
"org-string">"nlarr;"</span>: <span class="org-string">"↚"</span>,
<span class="linenr"> 7914: </span>  <span class=
"org-string">"nleqq;"</span>: <span class="org-string">"≦̸"</span>,
<span class="linenr"> 7915: </span>  <span class=
"org-string">"nless;"</span>: <span class="org-string">"≮"</span>,
<span class="linenr"> 7916: </span>  <span class=
"org-string">"nlsim;"</span>: <span class="org-string">"≴"</span>,
<span class="linenr"> 7917: </span>  <span class=
"org-string">"nltri;"</span>: <span class="org-string">"⋪"</span>,
<span class="linenr"> 7918: </span>  <span class=
"org-string">"notin;"</span>: <span class="org-string">"∉"</span>,
<span class="linenr"> 7919: </span>  <span class=
"org-string">"notni;"</span>: <span class="org-string">"∌"</span>,
<span class="linenr"> 7920: </span>  <span class=
"org-string">"npart;"</span>: <span class="org-string">"∂̸"</span>,
<span class="linenr"> 7921: </span>  <span class=
"org-string">"nprec;"</span>: <span class="org-string">"⊀"</span>,
<span class="linenr"> 7922: </span>  <span class=
"org-string">"nrArr;"</span>: <span class="org-string">"⇏"</span>,
<span class="linenr"> 7923: </span>  <span class=
"org-string">"nrarr;"</span>: <span class="org-string">"↛"</span>,
<span class="linenr"> 7924: </span>  <span class=
"org-string">"nrtri;"</span>: <span class="org-string">"⋫"</span>,
<span class="linenr"> 7925: </span>  <span class=
"org-string">"nsime;"</span>: <span class="org-string">"≄"</span>,
<span class="linenr"> 7926: </span>  <span class=
"org-string">"nsmid;"</span>: <span class="org-string">"∤"</span>,
<span class="linenr"> 7927: </span>  <span class=
"org-string">"nspar;"</span>: <span class="org-string">"∦"</span>,
<span class="linenr"> 7928: </span>  <span class=
"org-string">"nsubE;"</span>: <span class="org-string">"⫅̸"</span>,
<span class="linenr"> 7929: </span>  <span class=
"org-string">"nsube;"</span>: <span class="org-string">"⊈"</span>,
<span class="linenr"> 7930: </span>  <span class=
"org-string">"nsucc;"</span>: <span class="org-string">"⊁"</span>,
<span class="linenr"> 7931: </span>  <span class=
"org-string">"nsupE;"</span>: <span class="org-string">"⫆̸"</span>,
<span class="linenr"> 7932: </span>  <span class=
"org-string">"nsupe;"</span>: <span class="org-string">"⊉"</span>,
<span class="linenr"> 7933: </span>  <span class=
"org-string">"Ntilde"</span>: <span class="org-string">"Ñ"</span>,
<span class="linenr"> 7934: </span>  <span class=
"org-string">"ntilde"</span>: <span class="org-string">"ñ"</span>,
<span class="linenr"> 7935: </span>  <span class=
"org-string">"numsp;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 7936: </span>  <span class=
"org-string">"nvsim;"</span>: <span class="org-string">"∼⃒"</span>,
<span class="linenr"> 7937: </span>  <span class=
"org-string">"nwArr;"</span>: <span class="org-string">"⇖"</span>,
<span class="linenr"> 7938: </span>  <span class=
"org-string">"nwarr;"</span>: <span class="org-string">"↖"</span>,
<span class="linenr"> 7939: </span>  <span class=
"org-string">"Oacute"</span>: <span class="org-string">"Ó"</span>,
<span class="linenr"> 7940: </span>  <span class=
"org-string">"oacute"</span>: <span class="org-string">"ó"</span>,
<span class="linenr"> 7941: </span>  <span class=
"org-string">"Ocirc;"</span>: <span class="org-string">"Ô"</span>,
<span class="linenr"> 7942: </span>  <span class=
"org-string">"ocirc;"</span>: <span class="org-string">"ô"</span>,
<span class="linenr"> 7943: </span>  <span class=
"org-string">"odash;"</span>: <span class="org-string">"⊝"</span>,
<span class="linenr"> 7944: </span>  <span class=
"org-string">"OElig;"</span>: <span class="org-string">"Œ"</span>,
<span class="linenr"> 7945: </span>  <span class=
"org-string">"oelig;"</span>: <span class="org-string">"œ"</span>,
<span class="linenr"> 7946: </span>  <span class=
"org-string">"ofcir;"</span>: <span class="org-string">"⦿"</span>,
<span class="linenr"> 7947: </span>  <span class=
"org-string">"Ograve"</span>: <span class="org-string">"Ò"</span>,
<span class="linenr"> 7948: </span>  <span class=
"org-string">"ograve"</span>: <span class="org-string">"ò"</span>,
<span class="linenr"> 7949: </span>  <span class=
"org-string">"ohbar;"</span>: <span class="org-string">"⦵"</span>,
<span class="linenr"> 7950: </span>  <span class=
"org-string">"olarr;"</span>: <span class="org-string">"↺"</span>,
<span class="linenr"> 7951: </span>  <span class=
"org-string">"olcir;"</span>: <span class="org-string">"⦾"</span>,
<span class="linenr"> 7952: </span>  <span class=
"org-string">"oline;"</span>: <span class="org-string">"‾"</span>,
<span class="linenr"> 7953: </span>  <span class=
"org-string">"Omacr;"</span>: <span class="org-string">"Ō"</span>,
<span class="linenr"> 7954: </span>  <span class=
"org-string">"omacr;"</span>: <span class="org-string">"ō"</span>,
<span class="linenr"> 7955: </span>  <span class=
"org-string">"Omega;"</span>: <span class="org-string">"Ω"</span>,
<span class="linenr"> 7956: </span>  <span class=
"org-string">"omega;"</span>: <span class="org-string">"ω"</span>,
<span class="linenr"> 7957: </span>  <span class=
"org-string">"operp;"</span>: <span class="org-string">"⦹"</span>,
<span class="linenr"> 7958: </span>  <span class=
"org-string">"oplus;"</span>: <span class="org-string">"⊕"</span>,
<span class="linenr"> 7959: </span>  <span class=
"org-string">"orarr;"</span>: <span class="org-string">"↻"</span>,
<span class="linenr"> 7960: </span>  <span class=
"org-string">"order;"</span>: <span class="org-string">"ℴ"</span>,
<span class="linenr"> 7961: </span>  <span class=
"org-string">"Oslash"</span>: <span class="org-string">"Ø"</span>,
<span class="linenr"> 7962: </span>  <span class=
"org-string">"oslash"</span>: <span class="org-string">"ø"</span>,
<span class="linenr"> 7963: </span>  <span class=
"org-string">"Otilde"</span>: <span class="org-string">"Õ"</span>,
<span class="linenr"> 7964: </span>  <span class=
"org-string">"otilde"</span>: <span class="org-string">"õ"</span>,
<span class="linenr"> 7965: </span>  <span class=
"org-string">"ovbar;"</span>: <span class="org-string">"⌽"</span>,
<span class="linenr"> 7966: </span>  <span class=
"org-string">"parsl;"</span>: <span class="org-string">"⫽"</span>,
<span class="linenr"> 7967: </span>  <span class=
"org-string">"phone;"</span>: <span class="org-string">"☎"</span>,
<span class="linenr"> 7968: </span>  <span class=
"org-string">"plusb;"</span>: <span class="org-string">"⊞"</span>,
<span class="linenr"> 7969: </span>  <span class=
"org-string">"pluse;"</span>: <span class="org-string">"⩲"</span>,
<span class="linenr"> 7970: </span>  <span class=
"org-string">"plusmn"</span>: <span class="org-string">"±"</span>,
<span class="linenr"> 7971: </span>  <span class=
"org-string">"pound;"</span>: <span class="org-string">"£"</span>,
<span class="linenr"> 7972: </span>  <span class=
"org-string">"prcue;"</span>: <span class="org-string">"≼"</span>,
<span class="linenr"> 7973: </span>  <span class=
"org-string">"Prime;"</span>: <span class="org-string">"″"</span>,
<span class="linenr"> 7974: </span>  <span class=
"org-string">"prime;"</span>: <span class="org-string">"′"</span>,
<span class="linenr"> 7975: </span>  <span class=
"org-string">"prnap;"</span>: <span class="org-string">"⪹"</span>,
<span class="linenr"> 7976: </span>  <span class=
"org-string">"prsim;"</span>: <span class="org-string">"≾"</span>,
<span class="linenr"> 7977: </span>  <span class=
"org-string">"quest;"</span>: <span class="org-string">"?"</span>,
<span class="linenr"> 7978: </span>  <span class=
"org-string">"rAarr;"</span>: <span class="org-string">"⇛"</span>,
<span class="linenr"> 7979: </span>  <span class=
"org-string">"radic;"</span>: <span class="org-string">"√"</span>,
<span class="linenr"> 7980: </span>  <span class=
"org-string">"rangd;"</span>: <span class="org-string">"⦒"</span>,
<span class="linenr"> 7981: </span>  <span class=
"org-string">"range;"</span>: <span class="org-string">"⦥"</span>,
<span class="linenr"> 7982: </span>  <span class=
"org-string">"raquo;"</span>: <span class="org-string">"»"</span>,
<span class="linenr"> 7983: </span>  <span class=
"org-string">"rarrb;"</span>: <span class="org-string">"⇥"</span>,
<span class="linenr"> 7984: </span>  <span class=
"org-string">"rarrc;"</span>: <span class="org-string">"⤳"</span>,
<span class="linenr"> 7985: </span>  <span class=
"org-string">"rarrw;"</span>: <span class="org-string">"↝"</span>,
<span class="linenr"> 7986: </span>  <span class=
"org-string">"ratio;"</span>: <span class="org-string">"∶"</span>,
<span class="linenr"> 7987: </span>  <span class=
"org-string">"RBarr;"</span>: <span class="org-string">"⤐"</span>,
<span class="linenr"> 7988: </span>  <span class=
"org-string">"rBarr;"</span>: <span class="org-string">"⤏"</span>,
<span class="linenr"> 7989: </span>  <span class=
"org-string">"rbarr;"</span>: <span class="org-string">"⤍"</span>,
<span class="linenr"> 7990: </span>  <span class=
"org-string">"rbbrk;"</span>: <span class="org-string">"❳"</span>,
<span class="linenr"> 7991: </span>  <span class=
"org-string">"rbrke;"</span>: <span class="org-string">"⦌"</span>,
<span class="linenr"> 7992: </span>  <span class=
"org-string">"rceil;"</span>: <span class="org-string">"⌉"</span>,
<span class="linenr"> 7993: </span>  <span class=
"org-string">"rdquo;"</span>: <span class="org-string">"”"</span>,
<span class="linenr"> 7994: </span>  <span class=
"org-string">"reals;"</span>: <span class="org-string">"ℝ"</span>,
<span class="linenr"> 7995: </span>  <span class=
"org-string">"rhard;"</span>: <span class="org-string">"⇁"</span>,
<span class="linenr"> 7996: </span>  <span class=
"org-string">"rharu;"</span>: <span class="org-string">"⇀"</span>,
<span class="linenr"> 7997: </span>  <span class=
"org-string">"rlarr;"</span>: <span class="org-string">"⇄"</span>,
<span class="linenr"> 7998: </span>  <span class=
"org-string">"rlhar;"</span>: <span class="org-string">"⇌"</span>,
<span class="linenr"> 7999: </span>  <span class=
"org-string">"rnmid;"</span>: <span class="org-string">"⫮"</span>,
<span class="linenr"> 8000: </span>  <span class=
"org-string">"roang;"</span>: <span class="org-string">"⟭"</span>,
<span class="linenr"> 8001: </span>  <span class=
"org-string">"roarr;"</span>: <span class="org-string">"⇾"</span>,
<span class="linenr"> 8002: </span>  <span class=
"org-string">"robrk;"</span>: <span class="org-string">"⟧"</span>,
<span class="linenr"> 8003: </span>  <span class=
"org-string">"ropar;"</span>: <span class="org-string">"⦆"</span>,
<span class="linenr"> 8004: </span>  <span class=
"org-string">"rrarr;"</span>: <span class="org-string">"⇉"</span>,
<span class="linenr"> 8005: </span>  <span class=
"org-string">"rsquo;"</span>: <span class="org-string">"’"</span>,
<span class="linenr"> 8006: </span>  <span class=
"org-string">"rtrie;"</span>: <span class="org-string">"⊵"</span>,
<span class="linenr"> 8007: </span>  <span class=
"org-string">"rtrif;"</span>: <span class="org-string">"▸"</span>,
<span class="linenr"> 8008: </span>  <span class=
"org-string">"sbquo;"</span>: <span class="org-string">"‚"</span>,
<span class="linenr"> 8009: </span>  <span class=
"org-string">"sccue;"</span>: <span class="org-string">"≽"</span>,
<span class="linenr"> 8010: </span>  <span class=
"org-string">"Scirc;"</span>: <span class="org-string">"Ŝ"</span>,
<span class="linenr"> 8011: </span>  <span class=
"org-string">"scirc;"</span>: <span class="org-string">"ŝ"</span>,
<span class="linenr"> 8012: </span>  <span class=
"org-string">"scnap;"</span>: <span class="org-string">"⪺"</span>,
<span class="linenr"> 8013: </span>  <span class=
"org-string">"scsim;"</span>: <span class="org-string">"≿"</span>,
<span class="linenr"> 8014: </span>  <span class=
"org-string">"sdotb;"</span>: <span class="org-string">"⊡"</span>,
<span class="linenr"> 8015: </span>  <span class=
"org-string">"sdote;"</span>: <span class="org-string">"⩦"</span>,
<span class="linenr"> 8016: </span>  <span class=
"org-string">"seArr;"</span>: <span class="org-string">"⇘"</span>,
<span class="linenr"> 8017: </span>  <span class=
"org-string">"searr;"</span>: <span class="org-string">"↘"</span>,
<span class="linenr"> 8018: </span>  <span class=
"org-string">"setmn;"</span>: <span class="org-string">"∖"</span>,
<span class="linenr"> 8019: </span>  <span class=
"org-string">"sharp;"</span>: <span class="org-string">"♯"</span>,
<span class="linenr"> 8020: </span>  <span class=
"org-string">"Sigma;"</span>: <span class="org-string">"Σ"</span>,
<span class="linenr"> 8021: </span>  <span class=
"org-string">"sigma;"</span>: <span class="org-string">"σ"</span>,
<span class="linenr"> 8022: </span>  <span class=
"org-string">"simeq;"</span>: <span class="org-string">"≃"</span>,
<span class="linenr"> 8023: </span>  <span class=
"org-string">"simgE;"</span>: <span class="org-string">"⪠"</span>,
<span class="linenr"> 8024: </span>  <span class=
"org-string">"simlE;"</span>: <span class="org-string">"⪟"</span>,
<span class="linenr"> 8025: </span>  <span class=
"org-string">"simne;"</span>: <span class="org-string">"≆"</span>,
<span class="linenr"> 8026: </span>  <span class=
"org-string">"slarr;"</span>: <span class="org-string">"←"</span>,
<span class="linenr"> 8027: </span>  <span class=
"org-string">"smile;"</span>: <span class="org-string">"⌣"</span>,
<span class="linenr"> 8028: </span>  <span class=
"org-string">"smtes;"</span>: <span class="org-string">"⪬︀"</span>,
<span class="linenr"> 8029: </span>  <span class=
"org-string">"sqcap;"</span>: <span class="org-string">"⊓"</span>,
<span class="linenr"> 8030: </span>  <span class=
"org-string">"sqcup;"</span>: <span class="org-string">"⊔"</span>,
<span class="linenr"> 8031: </span>  <span class=
"org-string">"sqsub;"</span>: <span class="org-string">"⊏"</span>,
<span class="linenr"> 8032: </span>  <span class=
"org-string">"sqsup;"</span>: <span class="org-string">"⊐"</span>,
<span class="linenr"> 8033: </span>  <span class=
"org-string">"srarr;"</span>: <span class="org-string">"→"</span>,
<span class="linenr"> 8034: </span>  <span class=
"org-string">"starf;"</span>: <span class="org-string">"★"</span>,
<span class="linenr"> 8035: </span>  <span class=
"org-string">"strns;"</span>: <span class="org-string">"¯"</span>,
<span class="linenr"> 8036: </span>  <span class=
"org-string">"subnE;"</span>: <span class="org-string">"⫋"</span>,
<span class="linenr"> 8037: </span>  <span class=
"org-string">"subne;"</span>: <span class="org-string">"⊊"</span>,
<span class="linenr"> 8038: </span>  <span class=
"org-string">"supnE;"</span>: <span class="org-string">"⫌"</span>,
<span class="linenr"> 8039: </span>  <span class=
"org-string">"supne;"</span>: <span class="org-string">"⊋"</span>,
<span class="linenr"> 8040: </span>  <span class=
"org-string">"swArr;"</span>: <span class="org-string">"⇙"</span>,
<span class="linenr"> 8041: </span>  <span class=
"org-string">"swarr;"</span>: <span class="org-string">"↙"</span>,
<span class="linenr"> 8042: </span>  <span class=
"org-string">"szlig;"</span>: <span class="org-string">"ß"</span>,
<span class="linenr"> 8043: </span>  <span class=
"org-string">"Theta;"</span>: <span class="org-string">"Θ"</span>,
<span class="linenr"> 8044: </span>  <span class=
"org-string">"theta;"</span>: <span class="org-string">"θ"</span>,
<span class="linenr"> 8045: </span>  <span class=
"org-string">"thkap;"</span>: <span class="org-string">"≈"</span>,
<span class="linenr"> 8046: </span>  <span class=
"org-string">"THORN;"</span>: <span class="org-string">"Þ"</span>,
<span class="linenr"> 8047: </span>  <span class=
"org-string">"thorn;"</span>: <span class="org-string">"þ"</span>,
<span class="linenr"> 8048: </span>  <span class=
"org-string">"Tilde;"</span>: <span class="org-string">"∼"</span>,
<span class="linenr"> 8049: </span>  <span class=
"org-string">"tilde;"</span>: <span class="org-string">"˜"</span>,
<span class="linenr"> 8050: </span>  <span class=
"org-string">"times;"</span>: <span class="org-string">"×"</span>,
<span class="linenr"> 8051: </span>  <span class=
"org-string">"TRADE;"</span>: <span class="org-string">"™"</span>,
<span class="linenr"> 8052: </span>  <span class=
"org-string">"trade;"</span>: <span class="org-string">"™"</span>,
<span class="linenr"> 8053: </span>  <span class=
"org-string">"trisb;"</span>: <span class="org-string">"⧍"</span>,
<span class="linenr"> 8054: </span>  <span class=
"org-string">"TSHcy;"</span>: <span class="org-string">"Ћ"</span>,
<span class="linenr"> 8055: </span>  <span class=
"org-string">"tshcy;"</span>: <span class="org-string">"ћ"</span>,
<span class="linenr"> 8056: </span>  <span class=
"org-string">"twixt;"</span>: <span class="org-string">"≬"</span>,
<span class="linenr"> 8057: </span>  <span class=
"org-string">"Uacute"</span>: <span class="org-string">"Ú"</span>,
<span class="linenr"> 8058: </span>  <span class=
"org-string">"uacute"</span>: <span class="org-string">"ú"</span>,
<span class="linenr"> 8059: </span>  <span class=
"org-string">"Ubrcy;"</span>: <span class="org-string">"Ў"</span>,
<span class="linenr"> 8060: </span>  <span class=
"org-string">"ubrcy;"</span>: <span class="org-string">"ў"</span>,
<span class="linenr"> 8061: </span>  <span class=
"org-string">"Ucirc;"</span>: <span class="org-string">"Û"</span>,
<span class="linenr"> 8062: </span>  <span class=
"org-string">"ucirc;"</span>: <span class="org-string">"û"</span>,
<span class="linenr"> 8063: </span>  <span class=
"org-string">"udarr;"</span>: <span class="org-string">"⇅"</span>,
<span class="linenr"> 8064: </span>  <span class=
"org-string">"udhar;"</span>: <span class="org-string">"⥮"</span>,
<span class="linenr"> 8065: </span>  <span class=
"org-string">"Ugrave"</span>: <span class="org-string">"Ù"</span>,
<span class="linenr"> 8066: </span>  <span class=
"org-string">"ugrave"</span>: <span class="org-string">"ù"</span>,
<span class="linenr"> 8067: </span>  <span class=
"org-string">"uharl;"</span>: <span class="org-string">"↿"</span>,
<span class="linenr"> 8068: </span>  <span class=
"org-string">"uharr;"</span>: <span class="org-string">"↾"</span>,
<span class="linenr"> 8069: </span>  <span class=
"org-string">"uhblk;"</span>: <span class="org-string">"▀"</span>,
<span class="linenr"> 8070: </span>  <span class=
"org-string">"ultri;"</span>: <span class="org-string">"◸"</span>,
<span class="linenr"> 8071: </span>  <span class=
"org-string">"Umacr;"</span>: <span class="org-string">"Ū"</span>,
<span class="linenr"> 8072: </span>  <span class=
"org-string">"umacr;"</span>: <span class="org-string">"ū"</span>,
<span class="linenr"> 8073: </span>  <span class=
"org-string">"Union;"</span>: <span class="org-string">"⋃"</span>,
<span class="linenr"> 8074: </span>  <span class=
"org-string">"Uogon;"</span>: <span class="org-string">"Ų"</span>,
<span class="linenr"> 8075: </span>  <span class=
"org-string">"uogon;"</span>: <span class="org-string">"ų"</span>,
<span class="linenr"> 8076: </span>  <span class=
"org-string">"uplus;"</span>: <span class="org-string">"⊎"</span>,
<span class="linenr"> 8077: </span>  <span class=
"org-string">"upsih;"</span>: <span class="org-string">"ϒ"</span>,
<span class="linenr"> 8078: </span>  <span class=
"org-string">"UpTee;"</span>: <span class="org-string">"⊥"</span>,
<span class="linenr"> 8079: </span>  <span class=
"org-string">"Uring;"</span>: <span class="org-string">"Ů"</span>,
<span class="linenr"> 8080: </span>  <span class=
"org-string">"uring;"</span>: <span class="org-string">"ů"</span>,
<span class="linenr"> 8081: </span>  <span class=
"org-string">"urtri;"</span>: <span class="org-string">"◹"</span>,
<span class="linenr"> 8082: </span>  <span class=
"org-string">"utdot;"</span>: <span class="org-string">"⋰"</span>,
<span class="linenr"> 8083: </span>  <span class=
"org-string">"utrif;"</span>: <span class="org-string">"▴"</span>,
<span class="linenr"> 8084: </span>  <span class=
"org-string">"uuarr;"</span>: <span class="org-string">"⇈"</span>,
<span class="linenr"> 8085: </span>  <span class=
"org-string">"varpi;"</span>: <span class="org-string">"ϖ"</span>,
<span class="linenr"> 8086: </span>  <span class=
"org-string">"vBarv;"</span>: <span class="org-string">"⫩"</span>,
<span class="linenr"> 8087: </span>  <span class=
"org-string">"VDash;"</span>: <span class="org-string">"⊫"</span>,
<span class="linenr"> 8088: </span>  <span class=
"org-string">"Vdash;"</span>: <span class="org-string">"⊩"</span>,
<span class="linenr"> 8089: </span>  <span class=
"org-string">"vDash;"</span>: <span class="org-string">"⊨"</span>,
<span class="linenr"> 8090: </span>  <span class=
"org-string">"vdash;"</span>: <span class="org-string">"⊢"</span>,
<span class="linenr"> 8091: </span>  <span class=
"org-string">"veeeq;"</span>: <span class="org-string">"≚"</span>,
<span class="linenr"> 8092: </span>  <span class=
"org-string">"vltri;"</span>: <span class="org-string">"⊲"</span>,
<span class="linenr"> 8093: </span>  <span class=
"org-string">"vnsub;"</span>: <span class="org-string">"⊂⃒"</span>,
<span class="linenr"> 8094: </span>  <span class=
"org-string">"vnsup;"</span>: <span class="org-string">"⊃⃒"</span>,
<span class="linenr"> 8095: </span>  <span class=
"org-string">"vprop;"</span>: <span class="org-string">"∝"</span>,
<span class="linenr"> 8096: </span>  <span class=
"org-string">"vrtri;"</span>: <span class="org-string">"⊳"</span>,
<span class="linenr"> 8097: </span>  <span class=
"org-string">"Wcirc;"</span>: <span class="org-string">"Ŵ"</span>,
<span class="linenr"> 8098: </span>  <span class=
"org-string">"wcirc;"</span>: <span class="org-string">"ŵ"</span>,
<span class="linenr"> 8099: </span>  <span class=
"org-string">"Wedge;"</span>: <span class="org-string">"⋀"</span>,
<span class="linenr"> 8100: </span>  <span class=
"org-string">"wedge;"</span>: <span class="org-string">"∧"</span>,
<span class="linenr"> 8101: </span>  <span class=
"org-string">"xcirc;"</span>: <span class="org-string">"◯"</span>,
<span class="linenr"> 8102: </span>  <span class=
"org-string">"xdtri;"</span>: <span class="org-string">"▽"</span>,
<span class="linenr"> 8103: </span>  <span class=
"org-string">"xhArr;"</span>: <span class="org-string">"⟺"</span>,
<span class="linenr"> 8104: </span>  <span class=
"org-string">"xharr;"</span>: <span class="org-string">"⟷"</span>,
<span class="linenr"> 8105: </span>  <span class=
"org-string">"xlArr;"</span>: <span class="org-string">"⟸"</span>,
<span class="linenr"> 8106: </span>  <span class=
"org-string">"xlarr;"</span>: <span class="org-string">"⟵"</span>,
<span class="linenr"> 8107: </span>  <span class=
"org-string">"xodot;"</span>: <span class="org-string">"⨀"</span>,
<span class="linenr"> 8108: </span>  <span class=
"org-string">"xrArr;"</span>: <span class="org-string">"⟹"</span>,
<span class="linenr"> 8109: </span>  <span class=
"org-string">"xrarr;"</span>: <span class="org-string">"⟶"</span>,
<span class="linenr"> 8110: </span>  <span class=
"org-string">"xutri;"</span>: <span class="org-string">"△"</span>,
<span class="linenr"> 8111: </span>  <span class=
"org-string">"Yacute"</span>: <span class="org-string">"Ý"</span>,
<span class="linenr"> 8112: </span>  <span class=
"org-string">"yacute"</span>: <span class="org-string">"ý"</span>,
<span class="linenr"> 8113: </span>  <span class=
"org-string">"Ycirc;"</span>: <span class="org-string">"Ŷ"</span>,
<span class="linenr"> 8114: </span>  <span class=
"org-string">"ycirc;"</span>: <span class="org-string">"ŷ"</span>,
<span class="linenr"> 8115: </span>  <span class=
"org-string">"Aacute;"</span>: <span class="org-string">"Á"</span>,
<span class="linenr"> 8116: </span>  <span class=
"org-string">"aacute;"</span>: <span class="org-string">"á"</span>,
<span class="linenr"> 8117: </span>  <span class=
"org-string">"Abreve;"</span>: <span class="org-string">"Ă"</span>,
<span class="linenr"> 8118: </span>  <span class=
"org-string">"abreve;"</span>: <span class="org-string">"ă"</span>,
<span class="linenr"> 8119: </span>  <span class=
"org-string">"Agrave;"</span>: <span class="org-string">"À"</span>,
<span class="linenr"> 8120: </span>  <span class=
"org-string">"agrave;"</span>: <span class="org-string">"à"</span>,
<span class="linenr"> 8121: </span>  <span class=
"org-string">"andand;"</span>: <span class="org-string">"⩕"</span>,
<span class="linenr"> 8122: </span>  <span class=
"org-string">"angmsd;"</span>: <span class="org-string">"∡"</span>,
<span class="linenr"> 8123: </span>  <span class=
"org-string">"angsph;"</span>: <span class="org-string">"∢"</span>,
<span class="linenr"> 8124: </span>  <span class=
"org-string">"apacir;"</span>: <span class="org-string">"⩯"</span>,
<span class="linenr"> 8125: </span>  <span class=
"org-string">"approx;"</span>: <span class="org-string">"≈"</span>,
<span class="linenr"> 8126: </span>  <span class=
"org-string">"Assign;"</span>: <span class="org-string">"≔"</span>,
<span class="linenr"> 8127: </span>  <span class=
"org-string">"Atilde;"</span>: <span class="org-string">"Ã"</span>,
<span class="linenr"> 8128: </span>  <span class=
"org-string">"atilde;"</span>: <span class="org-string">"ã"</span>,
<span class="linenr"> 8129: </span>  <span class=
"org-string">"barvee;"</span>: <span class="org-string">"⊽"</span>,
<span class="linenr"> 8130: </span>  <span class=
"org-string">"Barwed;"</span>: <span class="org-string">"⌆"</span>,
<span class="linenr"> 8131: </span>  <span class=
"org-string">"barwed;"</span>: <span class="org-string">"⌅"</span>,
<span class="linenr"> 8132: </span>  <span class=
"org-string">"becaus;"</span>: <span class="org-string">"∵"</span>,
<span class="linenr"> 8133: </span>  <span class=
"org-string">"bernou;"</span>: <span class="org-string">"ℬ"</span>,
<span class="linenr"> 8134: </span>  <span class=
"org-string">"bigcap;"</span>: <span class="org-string">"⋂"</span>,
<span class="linenr"> 8135: </span>  <span class=
"org-string">"bigcup;"</span>: <span class="org-string">"⋃"</span>,
<span class="linenr"> 8136: </span>  <span class=
"org-string">"bigvee;"</span>: <span class="org-string">"⋁"</span>,
<span class="linenr"> 8137: </span>  <span class=
"org-string">"bkarow;"</span>: <span class="org-string">"⤍"</span>,
<span class="linenr"> 8138: </span>  <span class=
"org-string">"bottom;"</span>: <span class="org-string">"⊥"</span>,
<span class="linenr"> 8139: </span>  <span class=
"org-string">"bowtie;"</span>: <span class="org-string">"⋈"</span>,
<span class="linenr"> 8140: </span>  <span class=
"org-string">"boxbox;"</span>: <span class="org-string">"⧉"</span>,
<span class="linenr"> 8141: </span>  <span class=
"org-string">"bprime;"</span>: <span class="org-string">"‵"</span>,
<span class="linenr"> 8142: </span>  <span class=
"org-string">"brvbar;"</span>: <span class="org-string">"¦"</span>,
<span class="linenr"> 8143: </span>  <span class=
"org-string">"bullet;"</span>: <span class="org-string">"•"</span>,
<span class="linenr"> 8144: </span>  <span class=
"org-string">"Bumpeq;"</span>: <span class="org-string">"≎"</span>,
<span class="linenr"> 8145: </span>  <span class=
"org-string">"bumpeq;"</span>: <span class="org-string">"≏"</span>,
<span class="linenr"> 8146: </span>  <span class=
"org-string">"Cacute;"</span>: <span class="org-string">"Ć"</span>,
<span class="linenr"> 8147: </span>  <span class=
"org-string">"cacute;"</span>: <span class="org-string">"ć"</span>,
<span class="linenr"> 8148: </span>  <span class=
"org-string">"capand;"</span>: <span class="org-string">"⩄"</span>,
<span class="linenr"> 8149: </span>  <span class=
"org-string">"capcap;"</span>: <span class="org-string">"⩋"</span>,
<span class="linenr"> 8150: </span>  <span class=
"org-string">"capcup;"</span>: <span class="org-string">"⩇"</span>,
<span class="linenr"> 8151: </span>  <span class=
"org-string">"capdot;"</span>: <span class="org-string">"⩀"</span>,
<span class="linenr"> 8152: </span>  <span class=
"org-string">"Ccaron;"</span>: <span class="org-string">"Č"</span>,
<span class="linenr"> 8153: </span>  <span class=
"org-string">"ccaron;"</span>: <span class="org-string">"č"</span>,
<span class="linenr"> 8154: </span>  <span class=
"org-string">"Ccedil;"</span>: <span class="org-string">"Ç"</span>,
<span class="linenr"> 8155: </span>  <span class=
"org-string">"ccedil;"</span>: <span class="org-string">"ç"</span>,
<span class="linenr"> 8156: </span>  <span class=
"org-string">"circeq;"</span>: <span class="org-string">"≗"</span>,
<span class="linenr"> 8157: </span>  <span class=
"org-string">"cirmid;"</span>: <span class="org-string">"⫯"</span>,
<span class="linenr"> 8158: </span>  <span class=
"org-string">"Colone;"</span>: <span class="org-string">"⩴"</span>,
<span class="linenr"> 8159: </span>  <span class=
"org-string">"colone;"</span>: <span class="org-string">"≔"</span>,
<span class="linenr"> 8160: </span>  <span class=
"org-string">"commat;"</span>: <span class="org-string">"@"</span>,
<span class="linenr"> 8161: </span>  <span class=
"org-string">"compfn;"</span>: <span class="org-string">"∘"</span>,
<span class="linenr"> 8162: </span>  <span class=
"org-string">"Conint;"</span>: <span class="org-string">"∯"</span>,
<span class="linenr"> 8163: </span>  <span class=
"org-string">"conint;"</span>: <span class="org-string">"∮"</span>,
<span class="linenr"> 8164: </span>  <span class=
"org-string">"coprod;"</span>: <span class="org-string">"∐"</span>,
<span class="linenr"> 8165: </span>  <span class=
"org-string">"copysr;"</span>: <span class="org-string">"℗"</span>,
<span class="linenr"> 8166: </span>  <span class=
"org-string">"cularr;"</span>: <span class="org-string">"↶"</span>,
<span class="linenr"> 8167: </span>  <span class=
"org-string">"CupCap;"</span>: <span class="org-string">"≍"</span>,
<span class="linenr"> 8168: </span>  <span class=
"org-string">"cupcap;"</span>: <span class="org-string">"⩆"</span>,
<span class="linenr"> 8169: </span>  <span class=
"org-string">"cupcup;"</span>: <span class="org-string">"⩊"</span>,
<span class="linenr"> 8170: </span>  <span class=
"org-string">"cupdot;"</span>: <span class="org-string">"⊍"</span>,
<span class="linenr"> 8171: </span>  <span class=
"org-string">"curarr;"</span>: <span class="org-string">"↷"</span>,
<span class="linenr"> 8172: </span>  <span class=
"org-string">"curren;"</span>: <span class="org-string">"¤"</span>,
<span class="linenr"> 8173: </span>  <span class=
"org-string">"cylcty;"</span>: <span class="org-string">"⌭"</span>,
<span class="linenr"> 8174: </span>  <span class=
"org-string">"Dagger;"</span>: <span class="org-string">"‡"</span>,
<span class="linenr"> 8175: </span>  <span class=
"org-string">"dagger;"</span>: <span class="org-string">"†"</span>,
<span class="linenr"> 8176: </span>  <span class=
"org-string">"daleth;"</span>: <span class="org-string">"ℸ"</span>,
<span class="linenr"> 8177: </span>  <span class=
"org-string">"Dcaron;"</span>: <span class="org-string">"Ď"</span>,
<span class="linenr"> 8178: </span>  <span class=
"org-string">"dcaron;"</span>: <span class="org-string">"ď"</span>,
<span class="linenr"> 8179: </span>  <span class=
"org-string">"dfisht;"</span>: <span class="org-string">"⥿"</span>,
<span class="linenr"> 8180: </span>  <span class=
"org-string">"divide;"</span>: <span class="org-string">"÷"</span>,
<span class="linenr"> 8181: </span>  <span class=
"org-string">"divonx;"</span>: <span class="org-string">"⋇"</span>,
<span class="linenr"> 8182: </span>  <span class=
"org-string">"dlcorn;"</span>: <span class="org-string">"⌞"</span>,
<span class="linenr"> 8183: </span>  <span class=
"org-string">"dlcrop;"</span>: <span class="org-string">"⌍"</span>,
<span class="linenr"> 8184: </span>  <span class=
"org-string">"dollar;"</span>: <span class="org-string">"$"</span>,
<span class="linenr"> 8185: </span>  <span class=
"org-string">"DotDot;"</span>: <span class="org-string">"⃜"</span>,
<span class="linenr"> 8186: </span>  <span class=
"org-string">"drcorn;"</span>: <span class="org-string">"⌟"</span>,
<span class="linenr"> 8187: </span>  <span class=
"org-string">"drcrop;"</span>: <span class="org-string">"⌌"</span>,
<span class="linenr"> 8188: </span>  <span class=
"org-string">"Dstrok;"</span>: <span class="org-string">"Đ"</span>,
<span class="linenr"> 8189: </span>  <span class=
"org-string">"dstrok;"</span>: <span class="org-string">"đ"</span>,
<span class="linenr"> 8190: </span>  <span class=
"org-string">"Eacute;"</span>: <span class="org-string">"É"</span>,
<span class="linenr"> 8191: </span>  <span class=
"org-string">"eacute;"</span>: <span class="org-string">"é"</span>,
<span class="linenr"> 8192: </span>  <span class=
"org-string">"easter;"</span>: <span class="org-string">"⩮"</span>,
<span class="linenr"> 8193: </span>  <span class=
"org-string">"Ecaron;"</span>: <span class="org-string">"Ě"</span>,
<span class="linenr"> 8194: </span>  <span class=
"org-string">"ecaron;"</span>: <span class="org-string">"ě"</span>,
<span class="linenr"> 8195: </span>  <span class=
"org-string">"ecolon;"</span>: <span class="org-string">"≕"</span>,
<span class="linenr"> 8196: </span>  <span class=
"org-string">"Egrave;"</span>: <span class="org-string">"È"</span>,
<span class="linenr"> 8197: </span>  <span class=
"org-string">"egrave;"</span>: <span class="org-string">"è"</span>,
<span class="linenr"> 8198: </span>  <span class=
"org-string">"egsdot;"</span>: <span class="org-string">"⪘"</span>,
<span class="linenr"> 8199: </span>  <span class=
"org-string">"elsdot;"</span>: <span class="org-string">"⪗"</span>,
<span class="linenr"> 8200: </span>  <span class=
"org-string">"emptyv;"</span>: <span class="org-string">"∅"</span>,
<span class="linenr"> 8201: </span>  <span class=
"org-string">"emsp13;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 8202: </span>  <span class=
"org-string">"emsp14;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 8203: </span>  <span class=
"org-string">"eparsl;"</span>: <span class="org-string">"⧣"</span>,
<span class="linenr"> 8204: </span>  <span class=
"org-string">"eqcirc;"</span>: <span class="org-string">"≖"</span>,
<span class="linenr"> 8205: </span>  <span class=
"org-string">"equals;"</span>: <span class="org-string">"="</span>,
<span class="linenr"> 8206: </span>  <span class=
"org-string">"equest;"</span>: <span class="org-string">"≟"</span>,
<span class="linenr"> 8207: </span>  <span class=
"org-string">"Exists;"</span>: <span class="org-string">"∃"</span>,
<span class="linenr"> 8208: </span>  <span class=
"org-string">"female;"</span>: <span class="org-string">"♀"</span>,
<span class="linenr"> 8209: </span>  <span class=
"org-string">"ffilig;"</span>: <span class="org-string">"ﬃ"</span>,
<span class="linenr"> 8210: </span>  <span class=
"org-string">"ffllig;"</span>: <span class="org-string">"ﬄ"</span>,
<span class="linenr"> 8211: </span>  <span class=
"org-string">"ForAll;"</span>: <span class="org-string">"∀"</span>,
<span class="linenr"> 8212: </span>  <span class=
"org-string">"forall;"</span>: <span class="org-string">"∀"</span>,
<span class="linenr"> 8213: </span>  <span class=
"org-string">"frac12;"</span>: <span class="org-string">"½"</span>,
<span class="linenr"> 8214: </span>  <span class=
"org-string">"frac13;"</span>: <span class="org-string">"⅓"</span>,
<span class="linenr"> 8215: </span>  <span class=
"org-string">"frac14;"</span>: <span class="org-string">"¼"</span>,
<span class="linenr"> 8216: </span>  <span class=
"org-string">"frac15;"</span>: <span class="org-string">"⅕"</span>,
<span class="linenr"> 8217: </span>  <span class=
"org-string">"frac16;"</span>: <span class="org-string">"⅙"</span>,
<span class="linenr"> 8218: </span>  <span class=
"org-string">"frac18;"</span>: <span class="org-string">"⅛"</span>,
<span class="linenr"> 8219: </span>  <span class=
"org-string">"frac23;"</span>: <span class="org-string">"⅔"</span>,
<span class="linenr"> 8220: </span>  <span class=
"org-string">"frac25;"</span>: <span class="org-string">"⅖"</span>,
<span class="linenr"> 8221: </span>  <span class=
"org-string">"frac34;"</span>: <span class="org-string">"¾"</span>,
<span class="linenr"> 8222: </span>  <span class=
"org-string">"frac35;"</span>: <span class="org-string">"⅗"</span>,
<span class="linenr"> 8223: </span>  <span class=
"org-string">"frac38;"</span>: <span class="org-string">"⅜"</span>,
<span class="linenr"> 8224: </span>  <span class=
"org-string">"frac45;"</span>: <span class="org-string">"⅘"</span>,
<span class="linenr"> 8225: </span>  <span class=
"org-string">"frac56;"</span>: <span class="org-string">"⅚"</span>,
<span class="linenr"> 8226: </span>  <span class=
"org-string">"frac58;"</span>: <span class="org-string">"⅝"</span>,
<span class="linenr"> 8227: </span>  <span class=
"org-string">"frac78;"</span>: <span class="org-string">"⅞"</span>,
<span class="linenr"> 8228: </span>  <span class=
"org-string">"gacute;"</span>: <span class="org-string">"ǵ"</span>,
<span class="linenr"> 8229: </span>  <span class=
"org-string">"Gammad;"</span>: <span class="org-string">"Ϝ"</span>,
<span class="linenr"> 8230: </span>  <span class=
"org-string">"gammad;"</span>: <span class="org-string">"ϝ"</span>,
<span class="linenr"> 8231: </span>  <span class=
"org-string">"Gbreve;"</span>: <span class="org-string">"Ğ"</span>,
<span class="linenr"> 8232: </span>  <span class=
"org-string">"gbreve;"</span>: <span class="org-string">"ğ"</span>,
<span class="linenr"> 8233: </span>  <span class=
"org-string">"Gcedil;"</span>: <span class="org-string">"Ģ"</span>,
<span class="linenr"> 8234: </span>  <span class=
"org-string">"gesdot;"</span>: <span class="org-string">"⪀"</span>,
<span class="linenr"> 8235: </span>  <span class=
"org-string">"gesles;"</span>: <span class="org-string">"⪔"</span>,
<span class="linenr"> 8236: </span>  <span class=
"org-string">"gtlPar;"</span>: <span class="org-string">"⦕"</span>,
<span class="linenr"> 8237: </span>  <span class=
"org-string">"gtrarr;"</span>: <span class="org-string">"⥸"</span>,
<span class="linenr"> 8238: </span>  <span class=
"org-string">"gtrdot;"</span>: <span class="org-string">"⋗"</span>,
<span class="linenr"> 8239: </span>  <span class=
"org-string">"gtrsim;"</span>: <span class="org-string">"≳"</span>,
<span class="linenr"> 8240: </span>  <span class=
"org-string">"hairsp;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 8241: </span>  <span class=
"org-string">"hamilt;"</span>: <span class="org-string">"ℋ"</span>,
<span class="linenr"> 8242: </span>  <span class=
"org-string">"HARDcy;"</span>: <span class="org-string">"Ъ"</span>,
<span class="linenr"> 8243: </span>  <span class=
"org-string">"hardcy;"</span>: <span class="org-string">"ъ"</span>,
<span class="linenr"> 8244: </span>  <span class=
"org-string">"hearts;"</span>: <span class="org-string">"♥"</span>,
<span class="linenr"> 8245: </span>  <span class=
"org-string">"hellip;"</span>: <span class="org-string">"…"</span>,
<span class="linenr"> 8246: </span>  <span class=
"org-string">"hercon;"</span>: <span class="org-string">"⊹"</span>,
<span class="linenr"> 8247: </span>  <span class=
"org-string">"homtht;"</span>: <span class="org-string">"∻"</span>,
<span class="linenr"> 8248: </span>  <span class=
"org-string">"horbar;"</span>: <span class="org-string">"―"</span>,
<span class="linenr"> 8249: </span>  <span class=
"org-string">"hslash;"</span>: <span class="org-string">"ℏ"</span>,
<span class="linenr"> 8250: </span>  <span class=
"org-string">"Hstrok;"</span>: <span class="org-string">"Ħ"</span>,
<span class="linenr"> 8251: </span>  <span class=
"org-string">"hstrok;"</span>: <span class="org-string">"ħ"</span>,
<span class="linenr"> 8252: </span>  <span class=
"org-string">"hybull;"</span>: <span class="org-string">"⁃"</span>,
<span class="linenr"> 8253: </span>  <span class=
"org-string">"hyphen;"</span>: <span class="org-string">"‐"</span>,
<span class="linenr"> 8254: </span>  <span class=
"org-string">"Iacute;"</span>: <span class="org-string">"Í"</span>,
<span class="linenr"> 8255: </span>  <span class=
"org-string">"iacute;"</span>: <span class="org-string">"í"</span>,
<span class="linenr"> 8256: </span>  <span class=
"org-string">"Igrave;"</span>: <span class="org-string">"Ì"</span>,
<span class="linenr"> 8257: </span>  <span class=
"org-string">"igrave;"</span>: <span class="org-string">"ì"</span>,
<span class="linenr"> 8258: </span>  <span class=
"org-string">"iiiint;"</span>: <span class="org-string">"⨌"</span>,
<span class="linenr"> 8259: </span>  <span class=
"org-string">"iinfin;"</span>: <span class="org-string">"⧜"</span>,
<span class="linenr"> 8260: </span>  <span class=
"org-string">"incare;"</span>: <span class="org-string">"℅"</span>,
<span class="linenr"> 8261: </span>  <span class=
"org-string">"inodot;"</span>: <span class="org-string">"ı"</span>,
<span class="linenr"> 8262: </span>  <span class=
"org-string">"intcal;"</span>: <span class="org-string">"⊺"</span>,
<span class="linenr"> 8263: </span>  <span class=
"org-string">"iquest;"</span>: <span class="org-string">"¿"</span>,
<span class="linenr"> 8264: </span>  <span class=
"org-string">"isinsv;"</span>: <span class="org-string">"⋳"</span>,
<span class="linenr"> 8265: </span>  <span class=
"org-string">"Itilde;"</span>: <span class="org-string">"Ĩ"</span>,
<span class="linenr"> 8266: </span>  <span class=
"org-string">"itilde;"</span>: <span class="org-string">"ĩ"</span>,
<span class="linenr"> 8267: </span>  <span class=
"org-string">"Jsercy;"</span>: <span class="org-string">"Ј"</span>,
<span class="linenr"> 8268: </span>  <span class=
"org-string">"jsercy;"</span>: <span class="org-string">"ј"</span>,
<span class="linenr"> 8269: </span>  <span class=
"org-string">"kappav;"</span>: <span class="org-string">"ϰ"</span>,
<span class="linenr"> 8270: </span>  <span class=
"org-string">"Kcedil;"</span>: <span class="org-string">"Ķ"</span>,
<span class="linenr"> 8271: </span>  <span class=
"org-string">"kcedil;"</span>: <span class="org-string">"ķ"</span>,
<span class="linenr"> 8272: </span>  <span class=
"org-string">"kgreen;"</span>: <span class="org-string">"ĸ"</span>,
<span class="linenr"> 8273: </span>  <span class=
"org-string">"Lacute;"</span>: <span class="org-string">"Ĺ"</span>,
<span class="linenr"> 8274: </span>  <span class=
"org-string">"lacute;"</span>: <span class="org-string">"ĺ"</span>,
<span class="linenr"> 8275: </span>  <span class=
"org-string">"lagran;"</span>: <span class="org-string">"ℒ"</span>,
<span class="linenr"> 8276: </span>  <span class=
"org-string">"Lambda;"</span>: <span class="org-string">"Λ"</span>,
<span class="linenr"> 8277: </span>  <span class=
"org-string">"lambda;"</span>: <span class="org-string">"λ"</span>,
<span class="linenr"> 8278: </span>  <span class=
"org-string">"langle;"</span>: <span class="org-string">"⟨"</span>,
<span class="linenr"> 8279: </span>  <span class=
"org-string">"larrfs;"</span>: <span class="org-string">"⤝"</span>,
<span class="linenr"> 8280: </span>  <span class=
"org-string">"larrhk;"</span>: <span class="org-string">"↩"</span>,
<span class="linenr"> 8281: </span>  <span class=
"org-string">"larrlp;"</span>: <span class="org-string">"↫"</span>,
<span class="linenr"> 8282: </span>  <span class=
"org-string">"larrpl;"</span>: <span class="org-string">"⤹"</span>,
<span class="linenr"> 8283: </span>  <span class=
"org-string">"larrtl;"</span>: <span class="org-string">"↢"</span>,
<span class="linenr"> 8284: </span>  <span class=
"org-string">"lAtail;"</span>: <span class="org-string">"⤛"</span>,
<span class="linenr"> 8285: </span>  <span class=
"org-string">"latail;"</span>: <span class="org-string">"⤙"</span>,
<span class="linenr"> 8286: </span>  <span class=
"org-string">"lbrace;"</span>: <span class="org-string">"{"</span>,
<span class="linenr"> 8287: </span>  <span class=
"org-string">"lbrack;"</span>: <span class="org-string">"["</span>,
<span class="linenr"> 8288: </span>  <span class=
"org-string">"Lcaron;"</span>: <span class="org-string">"Ľ"</span>,
<span class="linenr"> 8289: </span>  <span class=
"org-string">"lcaron;"</span>: <span class="org-string">"ľ"</span>,
<span class="linenr"> 8290: </span>  <span class=
"org-string">"Lcedil;"</span>: <span class="org-string">"Ļ"</span>,
<span class="linenr"> 8291: </span>  <span class=
"org-string">"lcedil;"</span>: <span class="org-string">"ļ"</span>,
<span class="linenr"> 8292: </span>  <span class=
"org-string">"ldquor;"</span>: <span class="org-string">"„"</span>,
<span class="linenr"> 8293: </span>  <span class=
"org-string">"lesdot;"</span>: <span class="org-string">"⩿"</span>,
<span class="linenr"> 8294: </span>  <span class=
"org-string">"lesges;"</span>: <span class="org-string">"⪓"</span>,
<span class="linenr"> 8295: </span>  <span class=
"org-string">"lfisht;"</span>: <span class="org-string">"⥼"</span>,
<span class="linenr"> 8296: </span>  <span class=
"org-string">"lfloor;"</span>: <span class="org-string">"⌊"</span>,
<span class="linenr"> 8297: </span>  <span class=
"org-string">"lharul;"</span>: <span class="org-string">"⥪"</span>,
<span class="linenr"> 8298: </span>  <span class=
"org-string">"llhard;"</span>: <span class="org-string">"⥫"</span>,
<span class="linenr"> 8299: </span>  <span class=
"org-string">"Lmidot;"</span>: <span class="org-string">"Ŀ"</span>,
<span class="linenr"> 8300: </span>  <span class=
"org-string">"lmidot;"</span>: <span class="org-string">"ŀ"</span>,
<span class="linenr"> 8301: </span>  <span class=
"org-string">"lmoust;"</span>: <span class="org-string">"⎰"</span>,
<span class="linenr"> 8302: </span>  <span class=
"org-string">"loplus;"</span>: <span class="org-string">"⨭"</span>,
<span class="linenr"> 8303: </span>  <span class=
"org-string">"lowast;"</span>: <span class="org-string">"∗"</span>,
<span class="linenr"> 8304: </span>  <span class=
"org-string">"lowbar;"</span>: <span class="org-string">"_"</span>,
<span class="linenr"> 8305: </span>  <span class=
"org-string">"lparlt;"</span>: <span class="org-string">"⦓"</span>,
<span class="linenr"> 8306: </span>  <span class=
"org-string">"lrhard;"</span>: <span class="org-string">"⥭"</span>,
<span class="linenr"> 8307: </span>  <span class=
"org-string">"lsaquo;"</span>: <span class="org-string">"‹"</span>,
<span class="linenr"> 8308: </span>  <span class=
"org-string">"lsquor;"</span>: <span class="org-string">"‚"</span>,
<span class="linenr"> 8309: </span>  <span class=
"org-string">"Lstrok;"</span>: <span class="org-string">"Ł"</span>,
<span class="linenr"> 8310: </span>  <span class=
"org-string">"lstrok;"</span>: <span class="org-string">"ł"</span>,
<span class="linenr"> 8311: </span>  <span class=
"org-string">"lthree;"</span>: <span class="org-string">"⋋"</span>,
<span class="linenr"> 8312: </span>  <span class=
"org-string">"ltimes;"</span>: <span class="org-string">"⋉"</span>,
<span class="linenr"> 8313: </span>  <span class=
"org-string">"ltlarr;"</span>: <span class="org-string">"⥶"</span>,
<span class="linenr"> 8314: </span>  <span class=
"org-string">"ltrPar;"</span>: <span class="org-string">"⦖"</span>,
<span class="linenr"> 8315: </span>  <span class=
"org-string">"mapsto;"</span>: <span class="org-string">"↦"</span>,
<span class="linenr"> 8316: </span>  <span class=
"org-string">"marker;"</span>: <span class="org-string">"▮"</span>,
<span class="linenr"> 8317: </span>  <span class=
"org-string">"mcomma;"</span>: <span class="org-string">"⨩"</span>,
<span class="linenr"> 8318: </span>  <span class=
"org-string">"midast;"</span>: <span class="org-string">"*"</span>,
<span class="linenr"> 8319: </span>  <span class=
"org-string">"midcir;"</span>: <span class="org-string">"⫰"</span>,
<span class="linenr"> 8320: </span>  <span class=
"org-string">"middot;"</span>: <span class="org-string">"·"</span>,
<span class="linenr"> 8321: </span>  <span class=
"org-string">"minusb;"</span>: <span class="org-string">"⊟"</span>,
<span class="linenr"> 8322: </span>  <span class=
"org-string">"minusd;"</span>: <span class="org-string">"∸"</span>,
<span class="linenr"> 8323: </span>  <span class=
"org-string">"mnplus;"</span>: <span class="org-string">"∓"</span>,
<span class="linenr"> 8324: </span>  <span class=
"org-string">"models;"</span>: <span class="org-string">"⊧"</span>,
<span class="linenr"> 8325: </span>  <span class=
"org-string">"mstpos;"</span>: <span class="org-string">"∾"</span>,
<span class="linenr"> 8326: </span>  <span class=
"org-string">"Nacute;"</span>: <span class="org-string">"Ń"</span>,
<span class="linenr"> 8327: </span>  <span class=
"org-string">"nacute;"</span>: <span class="org-string">"ń"</span>,
<span class="linenr"> 8328: </span>  <span class=
"org-string">"nbumpe;"</span>: <span class=
"org-string">"≏̸"</span>,
<span class="linenr"> 8329: </span>  <span class=
"org-string">"Ncaron;"</span>: <span class="org-string">"Ň"</span>,
<span class="linenr"> 8330: </span>  <span class=
"org-string">"ncaron;"</span>: <span class="org-string">"ň"</span>,
<span class="linenr"> 8331: </span>  <span class=
"org-string">"Ncedil;"</span>: <span class="org-string">"Ņ"</span>,
<span class="linenr"> 8332: </span>  <span class=
"org-string">"ncedil;"</span>: <span class="org-string">"ņ"</span>,
<span class="linenr"> 8333: </span>  <span class=
"org-string">"nearhk;"</span>: <span class="org-string">"⤤"</span>,
<span class="linenr"> 8334: </span>  <span class=
"org-string">"nequiv;"</span>: <span class="org-string">"≢"</span>,
<span class="linenr"> 8335: </span>  <span class=
"org-string">"nesear;"</span>: <span class="org-string">"⤨"</span>,
<span class="linenr"> 8336: </span>  <span class=
"org-string">"nexist;"</span>: <span class="org-string">"∄"</span>,
<span class="linenr"> 8337: </span>  <span class=
"org-string">"nltrie;"</span>: <span class="org-string">"⋬"</span>,
<span class="linenr"> 8338: </span>  <span class=
"org-string">"notinE;"</span>: <span class=
"org-string">"⋹̸"</span>,
<span class="linenr"> 8339: </span>  <span class=
"org-string">"nparsl;"</span>: <span class=
"org-string">"⫽⃥"</span>,
<span class="linenr"> 8340: </span>  <span class=
"org-string">"nprcue;"</span>: <span class="org-string">"⋠"</span>,
<span class="linenr"> 8341: </span>  <span class=
"org-string">"nrarrc;"</span>: <span class=
"org-string">"⤳̸"</span>,
<span class="linenr"> 8342: </span>  <span class=
"org-string">"nrarrw;"</span>: <span class=
"org-string">"↝̸"</span>,
<span class="linenr"> 8343: </span>  <span class=
"org-string">"nrtrie;"</span>: <span class="org-string">"⋭"</span>,
<span class="linenr"> 8344: </span>  <span class=
"org-string">"nsccue;"</span>: <span class="org-string">"⋡"</span>,
<span class="linenr"> 8345: </span>  <span class=
"org-string">"nsimeq;"</span>: <span class="org-string">"≄"</span>,
<span class="linenr"> 8346: </span>  <span class=
"org-string">"Ntilde;"</span>: <span class="org-string">"Ñ"</span>,
<span class="linenr"> 8347: </span>  <span class=
"org-string">"ntilde;"</span>: <span class="org-string">"ñ"</span>,
<span class="linenr"> 8348: </span>  <span class=
"org-string">"numero;"</span>: <span class="org-string">"№"</span>,
<span class="linenr"> 8349: </span>  <span class=
"org-string">"nVDash;"</span>: <span class="org-string">"⊯"</span>,
<span class="linenr"> 8350: </span>  <span class=
"org-string">"nVdash;"</span>: <span class="org-string">"⊮"</span>,
<span class="linenr"> 8351: </span>  <span class=
"org-string">"nvDash;"</span>: <span class="org-string">"⊭"</span>,
<span class="linenr"> 8352: </span>  <span class=
"org-string">"nvdash;"</span>: <span class="org-string">"⊬"</span>,
<span class="linenr"> 8353: </span>  <span class=
"org-string">"nvHarr;"</span>: <span class="org-string">"⤄"</span>,
<span class="linenr"> 8354: </span>  <span class=
"org-string">"nvlArr;"</span>: <span class="org-string">"⤂"</span>,
<span class="linenr"> 8355: </span>  <span class=
"org-string">"nvrArr;"</span>: <span class="org-string">"⤃"</span>,
<span class="linenr"> 8356: </span>  <span class=
"org-string">"nwarhk;"</span>: <span class="org-string">"⤣"</span>,
<span class="linenr"> 8357: </span>  <span class=
"org-string">"nwnear;"</span>: <span class="org-string">"⤧"</span>,
<span class="linenr"> 8358: </span>  <span class=
"org-string">"Oacute;"</span>: <span class="org-string">"Ó"</span>,
<span class="linenr"> 8359: </span>  <span class=
"org-string">"oacute;"</span>: <span class="org-string">"ó"</span>,
<span class="linenr"> 8360: </span>  <span class=
"org-string">"Odblac;"</span>: <span class="org-string">"Ő"</span>,
<span class="linenr"> 8361: </span>  <span class=
"org-string">"odblac;"</span>: <span class="org-string">"ő"</span>,
<span class="linenr"> 8362: </span>  <span class=
"org-string">"odsold;"</span>: <span class="org-string">"⦼"</span>,
<span class="linenr"> 8363: </span>  <span class=
"org-string">"Ograve;"</span>: <span class="org-string">"Ò"</span>,
<span class="linenr"> 8364: </span>  <span class=
"org-string">"ograve;"</span>: <span class="org-string">"ò"</span>,
<span class="linenr"> 8365: </span>  <span class=
"org-string">"ominus;"</span>: <span class="org-string">"⊖"</span>,
<span class="linenr"> 8366: </span>  <span class=
"org-string">"origof;"</span>: <span class="org-string">"⊶"</span>,
<span class="linenr"> 8367: </span>  <span class=
"org-string">"Oslash;"</span>: <span class="org-string">"Ø"</span>,
<span class="linenr"> 8368: </span>  <span class=
"org-string">"oslash;"</span>: <span class="org-string">"ø"</span>,
<span class="linenr"> 8369: </span>  <span class=
"org-string">"Otilde;"</span>: <span class="org-string">"Õ"</span>,
<span class="linenr"> 8370: </span>  <span class=
"org-string">"otilde;"</span>: <span class="org-string">"õ"</span>,
<span class="linenr"> 8371: </span>  <span class=
"org-string">"Otimes;"</span>: <span class="org-string">"⨷"</span>,
<span class="linenr"> 8372: </span>  <span class=
"org-string">"otimes;"</span>: <span class="org-string">"⊗"</span>,
<span class="linenr"> 8373: </span>  <span class=
"org-string">"parsim;"</span>: <span class="org-string">"⫳"</span>,
<span class="linenr"> 8374: </span>  <span class=
"org-string">"percnt;"</span>: <span class="org-string">"%"</span>,
<span class="linenr"> 8375: </span>  <span class=
"org-string">"period;"</span>: <span class="org-string">"."</span>,
<span class="linenr"> 8376: </span>  <span class=
"org-string">"permil;"</span>: <span class="org-string">"‰"</span>,
<span class="linenr"> 8377: </span>  <span class=
"org-string">"phmmat;"</span>: <span class="org-string">"ℳ"</span>,
<span class="linenr"> 8378: </span>  <span class=
"org-string">"planck;"</span>: <span class="org-string">"ℏ"</span>,
<span class="linenr"> 8379: </span>  <span class=
"org-string">"plankv;"</span>: <span class="org-string">"ℏ"</span>,
<span class="linenr"> 8380: </span>  <span class=
"org-string">"plusdo;"</span>: <span class="org-string">"∔"</span>,
<span class="linenr"> 8381: </span>  <span class=
"org-string">"plusdu;"</span>: <span class="org-string">"⨥"</span>,
<span class="linenr"> 8382: </span>  <span class=
"org-string">"plusmn;"</span>: <span class="org-string">"±"</span>,
<span class="linenr"> 8383: </span>  <span class=
"org-string">"preceq;"</span>: <span class="org-string">"⪯"</span>,
<span class="linenr"> 8384: </span>  <span class=
"org-string">"primes;"</span>: <span class="org-string">"ℙ"</span>,
<span class="linenr"> 8385: </span>  <span class=
"org-string">"prnsim;"</span>: <span class="org-string">"⋨"</span>,
<span class="linenr"> 8386: </span>  <span class=
"org-string">"propto;"</span>: <span class="org-string">"∝"</span>,
<span class="linenr"> 8387: </span>  <span class=
"org-string">"prurel;"</span>: <span class="org-string">"⊰"</span>,
<span class="linenr"> 8388: </span>  <span class=
"org-string">"puncsp;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 8389: </span>  <span class=
"org-string">"qprime;"</span>: <span class="org-string">"⁗"</span>,
<span class="linenr"> 8390: </span>  <span class=
"org-string">"Racute;"</span>: <span class="org-string">"Ŕ"</span>,
<span class="linenr"> 8391: </span>  <span class=
"org-string">"racute;"</span>: <span class="org-string">"ŕ"</span>,
<span class="linenr"> 8392: </span>  <span class=
"org-string">"rangle;"</span>: <span class="org-string">"⟩"</span>,
<span class="linenr"> 8393: </span>  <span class=
"org-string">"rarrap;"</span>: <span class="org-string">"⥵"</span>,
<span class="linenr"> 8394: </span>  <span class=
"org-string">"rarrfs;"</span>: <span class="org-string">"⤞"</span>,
<span class="linenr"> 8395: </span>  <span class=
"org-string">"rarrhk;"</span>: <span class="org-string">"↪"</span>,
<span class="linenr"> 8396: </span>  <span class=
"org-string">"rarrlp;"</span>: <span class="org-string">"↬"</span>,
<span class="linenr"> 8397: </span>  <span class=
"org-string">"rarrpl;"</span>: <span class="org-string">"⥅"</span>,
<span class="linenr"> 8398: </span>  <span class=
"org-string">"Rarrtl;"</span>: <span class="org-string">"⤖"</span>,
<span class="linenr"> 8399: </span>  <span class=
"org-string">"rarrtl;"</span>: <span class="org-string">"↣"</span>,
<span class="linenr"> 8400: </span>  <span class=
"org-string">"rAtail;"</span>: <span class="org-string">"⤜"</span>,
<span class="linenr"> 8401: </span>  <span class=
"org-string">"ratail;"</span>: <span class="org-string">"⤚"</span>,
<span class="linenr"> 8402: </span>  <span class=
"org-string">"rbrace;"</span>: <span class="org-string">"}"</span>,
<span class="linenr"> 8403: </span>  <span class=
"org-string">"rbrack;"</span>: <span class="org-string">"]"</span>,
<span class="linenr"> 8404: </span>  <span class=
"org-string">"Rcaron;"</span>: <span class="org-string">"Ř"</span>,
<span class="linenr"> 8405: </span>  <span class=
"org-string">"rcaron;"</span>: <span class="org-string">"ř"</span>,
<span class="linenr"> 8406: </span>  <span class=
"org-string">"Rcedil;"</span>: <span class="org-string">"Ŗ"</span>,
<span class="linenr"> 8407: </span>  <span class=
"org-string">"rcedil;"</span>: <span class="org-string">"ŗ"</span>,
<span class="linenr"> 8408: </span>  <span class=
"org-string">"rdquor;"</span>: <span class="org-string">"”"</span>,
<span class="linenr"> 8409: </span>  <span class=
"org-string">"rfisht;"</span>: <span class="org-string">"⥽"</span>,
<span class="linenr"> 8410: </span>  <span class=
"org-string">"rfloor;"</span>: <span class="org-string">"⌋"</span>,
<span class="linenr"> 8411: </span>  <span class=
"org-string">"rharul;"</span>: <span class="org-string">"⥬"</span>,
<span class="linenr"> 8412: </span>  <span class=
"org-string">"rmoust;"</span>: <span class="org-string">"⎱"</span>,
<span class="linenr"> 8413: </span>  <span class=
"org-string">"roplus;"</span>: <span class="org-string">"⨮"</span>,
<span class="linenr"> 8414: </span>  <span class=
"org-string">"rpargt;"</span>: <span class="org-string">"⦔"</span>,
<span class="linenr"> 8415: </span>  <span class=
"org-string">"rsaquo;"</span>: <span class="org-string">"›"</span>,
<span class="linenr"> 8416: </span>  <span class=
"org-string">"rsquor;"</span>: <span class="org-string">"’"</span>,
<span class="linenr"> 8417: </span>  <span class=
"org-string">"rthree;"</span>: <span class="org-string">"⋌"</span>,
<span class="linenr"> 8418: </span>  <span class=
"org-string">"rtimes;"</span>: <span class="org-string">"⋊"</span>,
<span class="linenr"> 8419: </span>  <span class=
"org-string">"Sacute;"</span>: <span class="org-string">"Ś"</span>,
<span class="linenr"> 8420: </span>  <span class=
"org-string">"sacute;"</span>: <span class="org-string">"ś"</span>,
<span class="linenr"> 8421: </span>  <span class=
"org-string">"Scaron;"</span>: <span class="org-string">"Š"</span>,
<span class="linenr"> 8422: </span>  <span class=
"org-string">"scaron;"</span>: <span class="org-string">"š"</span>,
<span class="linenr"> 8423: </span>  <span class=
"org-string">"Scedil;"</span>: <span class="org-string">"Ş"</span>,
<span class="linenr"> 8424: </span>  <span class=
"org-string">"scedil;"</span>: <span class="org-string">"ş"</span>,
<span class="linenr"> 8425: </span>  <span class=
"org-string">"scnsim;"</span>: <span class="org-string">"⋩"</span>,
<span class="linenr"> 8426: </span>  <span class=
"org-string">"searhk;"</span>: <span class="org-string">"⤥"</span>,
<span class="linenr"> 8427: </span>  <span class=
"org-string">"seswar;"</span>: <span class="org-string">"⤩"</span>,
<span class="linenr"> 8428: </span>  <span class=
"org-string">"sfrown;"</span>: <span class="org-string">"⌢"</span>,
<span class="linenr"> 8429: </span>  <span class=
"org-string">"SHCHcy;"</span>: <span class="org-string">"Щ"</span>,
<span class="linenr"> 8430: </span>  <span class=
"org-string">"shchcy;"</span>: <span class="org-string">"щ"</span>,
<span class="linenr"> 8431: </span>  <span class=
"org-string">"sigmaf;"</span>: <span class="org-string">"ς"</span>,
<span class="linenr"> 8432: </span>  <span class=
"org-string">"sigmav;"</span>: <span class="org-string">"ς"</span>,
<span class="linenr"> 8433: </span>  <span class=
"org-string">"simdot;"</span>: <span class="org-string">"⩪"</span>,
<span class="linenr"> 8434: </span>  <span class=
"org-string">"smashp;"</span>: <span class="org-string">"⨳"</span>,
<span class="linenr"> 8435: </span>  <span class=
"org-string">"SOFTcy;"</span>: <span class="org-string">"Ь"</span>,
<span class="linenr"> 8436: </span>  <span class=
"org-string">"softcy;"</span>: <span class="org-string">"ь"</span>,
<span class="linenr"> 8437: </span>  <span class=
"org-string">"solbar;"</span>: <span class="org-string">"⌿"</span>,
<span class="linenr"> 8438: </span>  <span class=
"org-string">"spades;"</span>: <span class="org-string">"♠"</span>,
<span class="linenr"> 8439: </span>  <span class=
"org-string">"sqcaps;"</span>: <span class=
"org-string">"⊓︀"</span>,
<span class="linenr"> 8440: </span>  <span class=
"org-string">"sqcups;"</span>: <span class=
"org-string">"⊔︀"</span>,
<span class="linenr"> 8441: </span>  <span class=
"org-string">"sqsube;"</span>: <span class="org-string">"⊑"</span>,
<span class="linenr"> 8442: </span>  <span class=
"org-string">"sqsupe;"</span>: <span class="org-string">"⊒"</span>,
<span class="linenr"> 8443: </span>  <span class=
"org-string">"Square;"</span>: <span class="org-string">"□"</span>,
<span class="linenr"> 8444: </span>  <span class=
"org-string">"square;"</span>: <span class="org-string">"□"</span>,
<span class="linenr"> 8445: </span>  <span class=
"org-string">"squarf;"</span>: <span class="org-string">"▪"</span>,
<span class="linenr"> 8446: </span>  <span class=
"org-string">"ssetmn;"</span>: <span class="org-string">"∖"</span>,
<span class="linenr"> 8447: </span>  <span class=
"org-string">"ssmile;"</span>: <span class="org-string">"⌣"</span>,
<span class="linenr"> 8448: </span>  <span class=
"org-string">"sstarf;"</span>: <span class="org-string">"⋆"</span>,
<span class="linenr"> 8449: </span>  <span class=
"org-string">"subdot;"</span>: <span class="org-string">"⪽"</span>,
<span class="linenr"> 8450: </span>  <span class=
"org-string">"Subset;"</span>: <span class="org-string">"⋐"</span>,
<span class="linenr"> 8451: </span>  <span class=
"org-string">"subset;"</span>: <span class="org-string">"⊂"</span>,
<span class="linenr"> 8452: </span>  <span class=
"org-string">"subsim;"</span>: <span class="org-string">"⫇"</span>,
<span class="linenr"> 8453: </span>  <span class=
"org-string">"subsub;"</span>: <span class="org-string">"⫕"</span>,
<span class="linenr"> 8454: </span>  <span class=
"org-string">"subsup;"</span>: <span class="org-string">"⫓"</span>,
<span class="linenr"> 8455: </span>  <span class=
"org-string">"succeq;"</span>: <span class="org-string">"⪰"</span>,
<span class="linenr"> 8456: </span>  <span class=
"org-string">"supdot;"</span>: <span class="org-string">"⪾"</span>,
<span class="linenr"> 8457: </span>  <span class=
"org-string">"Supset;"</span>: <span class="org-string">"⋑"</span>,
<span class="linenr"> 8458: </span>  <span class=
"org-string">"supset;"</span>: <span class="org-string">"⊃"</span>,
<span class="linenr"> 8459: </span>  <span class=
"org-string">"supsim;"</span>: <span class="org-string">"⫈"</span>,
<span class="linenr"> 8460: </span>  <span class=
"org-string">"supsub;"</span>: <span class="org-string">"⫔"</span>,
<span class="linenr"> 8461: </span>  <span class=
"org-string">"supsup;"</span>: <span class="org-string">"⫖"</span>,
<span class="linenr"> 8462: </span>  <span class=
"org-string">"swarhk;"</span>: <span class="org-string">"⤦"</span>,
<span class="linenr"> 8463: </span>  <span class=
"org-string">"swnwar;"</span>: <span class="org-string">"⤪"</span>,
<span class="linenr"> 8464: </span>  <span class=
"org-string">"target;"</span>: <span class="org-string">"⌖"</span>,
<span class="linenr"> 8465: </span>  <span class=
"org-string">"Tcaron;"</span>: <span class="org-string">"Ť"</span>,
<span class="linenr"> 8466: </span>  <span class=
"org-string">"tcaron;"</span>: <span class="org-string">"ť"</span>,
<span class="linenr"> 8467: </span>  <span class=
"org-string">"Tcedil;"</span>: <span class="org-string">"Ţ"</span>,
<span class="linenr"> 8468: </span>  <span class=
"org-string">"tcedil;"</span>: <span class="org-string">"ţ"</span>,
<span class="linenr"> 8469: </span>  <span class=
"org-string">"telrec;"</span>: <span class="org-string">"⌕"</span>,
<span class="linenr"> 8470: </span>  <span class=
"org-string">"there4;"</span>: <span class="org-string">"∴"</span>,
<span class="linenr"> 8471: </span>  <span class=
"org-string">"thetav;"</span>: <span class="org-string">"ϑ"</span>,
<span class="linenr"> 8472: </span>  <span class=
"org-string">"thinsp;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 8473: </span>  <span class=
"org-string">"thksim;"</span>: <span class="org-string">"∼"</span>,
<span class="linenr"> 8474: </span>  <span class=
"org-string">"timesb;"</span>: <span class="org-string">"⊠"</span>,
<span class="linenr"> 8475: </span>  <span class=
"org-string">"timesd;"</span>: <span class="org-string">"⨰"</span>,
<span class="linenr"> 8476: </span>  <span class=
"org-string">"topbot;"</span>: <span class="org-string">"⌶"</span>,
<span class="linenr"> 8477: </span>  <span class=
"org-string">"topcir;"</span>: <span class="org-string">"⫱"</span>,
<span class="linenr"> 8478: </span>  <span class=
"org-string">"tprime;"</span>: <span class="org-string">"‴"</span>,
<span class="linenr"> 8479: </span>  <span class=
"org-string">"tridot;"</span>: <span class="org-string">"◬"</span>,
<span class="linenr"> 8480: </span>  <span class=
"org-string">"Tstrok;"</span>: <span class="org-string">"Ŧ"</span>,
<span class="linenr"> 8481: </span>  <span class=
"org-string">"tstrok;"</span>: <span class="org-string">"ŧ"</span>,
<span class="linenr"> 8482: </span>  <span class=
"org-string">"Uacute;"</span>: <span class="org-string">"Ú"</span>,
<span class="linenr"> 8483: </span>  <span class=
"org-string">"uacute;"</span>: <span class="org-string">"ú"</span>,
<span class="linenr"> 8484: </span>  <span class=
"org-string">"Ubreve;"</span>: <span class="org-string">"Ŭ"</span>,
<span class="linenr"> 8485: </span>  <span class=
"org-string">"ubreve;"</span>: <span class="org-string">"ŭ"</span>,
<span class="linenr"> 8486: </span>  <span class=
"org-string">"Udblac;"</span>: <span class="org-string">"Ű"</span>,
<span class="linenr"> 8487: </span>  <span class=
"org-string">"udblac;"</span>: <span class="org-string">"ű"</span>,
<span class="linenr"> 8488: </span>  <span class=
"org-string">"ufisht;"</span>: <span class="org-string">"⥾"</span>,
<span class="linenr"> 8489: </span>  <span class=
"org-string">"Ugrave;"</span>: <span class="org-string">"Ù"</span>,
<span class="linenr"> 8490: </span>  <span class=
"org-string">"ugrave;"</span>: <span class="org-string">"ù"</span>,
<span class="linenr"> 8491: </span>  <span class=
"org-string">"ulcorn;"</span>: <span class="org-string">"⌜"</span>,
<span class="linenr"> 8492: </span>  <span class=
"org-string">"ulcrop;"</span>: <span class="org-string">"⌏"</span>,
<span class="linenr"> 8493: </span>  <span class=
"org-string">"urcorn;"</span>: <span class="org-string">"⌝"</span>,
<span class="linenr"> 8494: </span>  <span class=
"org-string">"urcrop;"</span>: <span class="org-string">"⌎"</span>,
<span class="linenr"> 8495: </span>  <span class=
"org-string">"Utilde;"</span>: <span class="org-string">"Ũ"</span>,
<span class="linenr"> 8496: </span>  <span class=
"org-string">"utilde;"</span>: <span class="org-string">"ũ"</span>,
<span class="linenr"> 8497: </span>  <span class=
"org-string">"vangrt;"</span>: <span class="org-string">"⦜"</span>,
<span class="linenr"> 8498: </span>  <span class=
"org-string">"varphi;"</span>: <span class="org-string">"ϕ"</span>,
<span class="linenr"> 8499: </span>  <span class=
"org-string">"varrho;"</span>: <span class="org-string">"ϱ"</span>,
<span class="linenr"> 8500: </span>  <span class=
"org-string">"Vdashl;"</span>: <span class="org-string">"⫦"</span>,
<span class="linenr"> 8501: </span>  <span class=
"org-string">"veebar;"</span>: <span class="org-string">"⊻"</span>,
<span class="linenr"> 8502: </span>  <span class=
"org-string">"vellip;"</span>: <span class="org-string">"⋮"</span>,
<span class="linenr"> 8503: </span>  <span class=
"org-string">"Verbar;"</span>: <span class="org-string">"‖"</span>,
<span class="linenr"> 8504: </span>  <span class=
"org-string">"verbar;"</span>: <span class="org-string">"|"</span>,
<span class="linenr"> 8505: </span>  <span class=
"org-string">"vsubnE;"</span>: <span class=
"org-string">"⫋︀"</span>,
<span class="linenr"> 8506: </span>  <span class=
"org-string">"vsubne;"</span>: <span class=
"org-string">"⊊︀"</span>,
<span class="linenr"> 8507: </span>  <span class=
"org-string">"vsupnE;"</span>: <span class=
"org-string">"⫌︀"</span>,
<span class="linenr"> 8508: </span>  <span class=
"org-string">"vsupne;"</span>: <span class=
"org-string">"⊋︀"</span>,
<span class="linenr"> 8509: </span>  <span class=
"org-string">"Vvdash;"</span>: <span class="org-string">"⊪"</span>,
<span class="linenr"> 8510: </span>  <span class=
"org-string">"wedbar;"</span>: <span class="org-string">"⩟"</span>,
<span class="linenr"> 8511: </span>  <span class=
"org-string">"wedgeq;"</span>: <span class="org-string">"≙"</span>,
<span class="linenr"> 8512: </span>  <span class=
"org-string">"weierp;"</span>: <span class="org-string">"℘"</span>,
<span class="linenr"> 8513: </span>  <span class=
"org-string">"wreath;"</span>: <span class="org-string">"≀"</span>,
<span class="linenr"> 8514: </span>  <span class=
"org-string">"xoplus;"</span>: <span class="org-string">"⨁"</span>,
<span class="linenr"> 8515: </span>  <span class=
"org-string">"xotime;"</span>: <span class="org-string">"⨂"</span>,
<span class="linenr"> 8516: </span>  <span class=
"org-string">"xsqcup;"</span>: <span class="org-string">"⨆"</span>,
<span class="linenr"> 8517: </span>  <span class=
"org-string">"xuplus;"</span>: <span class="org-string">"⨄"</span>,
<span class="linenr"> 8518: </span>  <span class=
"org-string">"xwedge;"</span>: <span class="org-string">"⋀"</span>,
<span class="linenr"> 8519: </span>  <span class=
"org-string">"Yacute;"</span>: <span class="org-string">"Ý"</span>,
<span class="linenr"> 8520: </span>  <span class=
"org-string">"yacute;"</span>: <span class="org-string">"ý"</span>,
<span class="linenr"> 8521: </span>  <span class=
"org-string">"Zacute;"</span>: <span class="org-string">"Ź"</span>,
<span class="linenr"> 8522: </span>  <span class=
"org-string">"zacute;"</span>: <span class="org-string">"ź"</span>,
<span class="linenr"> 8523: </span>  <span class=
"org-string">"Zcaron;"</span>: <span class="org-string">"Ž"</span>,
<span class="linenr"> 8524: </span>  <span class=
"org-string">"zcaron;"</span>: <span class="org-string">"ž"</span>,
<span class="linenr"> 8525: </span>  <span class=
"org-string">"zeetrf;"</span>: <span class="org-string">"ℨ"</span>,
<span class="linenr"> 8526: </span>  <span class=
"org-string">"alefsym;"</span>: <span class=
"org-string">"ℵ"</span>,
<span class="linenr"> 8527: </span>  <span class=
"org-string">"angrtvb;"</span>: <span class=
"org-string">"⊾"</span>,
<span class="linenr"> 8528: </span>  <span class=
"org-string">"angzarr;"</span>: <span class=
"org-string">"⍼"</span>,
<span class="linenr"> 8529: </span>  <span class=
"org-string">"asympeq;"</span>: <span class=
"org-string">"≍"</span>,
<span class="linenr"> 8530: </span>  <span class=
"org-string">"backsim;"</span>: <span class=
"org-string">"∽"</span>,
<span class="linenr"> 8531: </span>  <span class=
"org-string">"Because;"</span>: <span class=
"org-string">"∵"</span>,
<span class="linenr"> 8532: </span>  <span class=
"org-string">"because;"</span>: <span class=
"org-string">"∵"</span>,
<span class="linenr"> 8533: </span>  <span class=
"org-string">"bemptyv;"</span>: <span class=
"org-string">"⦰"</span>,
<span class="linenr"> 8534: </span>  <span class=
"org-string">"between;"</span>: <span class=
"org-string">"≬"</span>,
<span class="linenr"> 8535: </span>  <span class=
"org-string">"bigcirc;"</span>: <span class=
"org-string">"◯"</span>,
<span class="linenr"> 8536: </span>  <span class=
"org-string">"bigodot;"</span>: <span class=
"org-string">"⨀"</span>,
<span class="linenr"> 8537: </span>  <span class=
"org-string">"bigstar;"</span>: <span class=
"org-string">"★"</span>,
<span class="linenr"> 8538: </span>  <span class=
"org-string">"bnequiv;"</span>: <span class=
"org-string">"≡⃥"</span>,
<span class="linenr"> 8539: </span>  <span class=
"org-string">"boxplus;"</span>: <span class=
"org-string">"⊞"</span>,
<span class="linenr"> 8540: </span>  <span class=
"org-string">"Cayleys;"</span>: <span class=
"org-string">"ℭ"</span>,
<span class="linenr"> 8541: </span>  <span class=
"org-string">"Cconint;"</span>: <span class=
"org-string">"∰"</span>,
<span class="linenr"> 8542: </span>  <span class=
"org-string">"ccupssm;"</span>: <span class=
"org-string">"⩐"</span>,
<span class="linenr"> 8543: </span>  <span class=
"org-string">"Cedilla;"</span>: <span class=
"org-string">"¸"</span>,
<span class="linenr"> 8544: </span>  <span class=
"org-string">"cemptyv;"</span>: <span class=
"org-string">"⦲"</span>,
<span class="linenr"> 8545: </span>  <span class=
"org-string">"cirscir;"</span>: <span class=
"org-string">"⧂"</span>,
<span class="linenr"> 8546: </span>  <span class=
"org-string">"coloneq;"</span>: <span class=
"org-string">"≔"</span>,
<span class="linenr"> 8547: </span>  <span class=
"org-string">"congdot;"</span>: <span class=
"org-string">"⩭"</span>,
<span class="linenr"> 8548: </span>  <span class=
"org-string">"cudarrl;"</span>: <span class=
"org-string">"⤸"</span>,
<span class="linenr"> 8549: </span>  <span class=
"org-string">"cudarrr;"</span>: <span class=
"org-string">"⤵"</span>,
<span class="linenr"> 8550: </span>  <span class=
"org-string">"cularrp;"</span>: <span class=
"org-string">"⤽"</span>,
<span class="linenr"> 8551: </span>  <span class=
"org-string">"curarrm;"</span>: <span class=
"org-string">"⤼"</span>,
<span class="linenr"> 8552: </span>  <span class=
"org-string">"dbkarow;"</span>: <span class=
"org-string">"⤏"</span>,
<span class="linenr"> 8553: </span>  <span class=
"org-string">"ddagger;"</span>: <span class=
"org-string">"‡"</span>,
<span class="linenr"> 8554: </span>  <span class=
"org-string">"ddotseq;"</span>: <span class=
"org-string">"⩷"</span>,
<span class="linenr"> 8555: </span>  <span class=
"org-string">"demptyv;"</span>: <span class=
"org-string">"⦱"</span>,
<span class="linenr"> 8556: </span>  <span class=
"org-string">"Diamond;"</span>: <span class=
"org-string">"⋄"</span>,
<span class="linenr"> 8557: </span>  <span class=
"org-string">"diamond;"</span>: <span class=
"org-string">"⋄"</span>,
<span class="linenr"> 8558: </span>  <span class=
"org-string">"digamma;"</span>: <span class=
"org-string">"ϝ"</span>,
<span class="linenr"> 8559: </span>  <span class=
"org-string">"dotplus;"</span>: <span class=
"org-string">"∔"</span>,
<span class="linenr"> 8560: </span>  <span class=
"org-string">"DownTee;"</span>: <span class=
"org-string">"⊤"</span>,
<span class="linenr"> 8561: </span>  <span class=
"org-string">"dwangle;"</span>: <span class=
"org-string">"⦦"</span>,
<span class="linenr"> 8562: </span>  <span class=
"org-string">"Element;"</span>: <span class=
"org-string">"∈"</span>,
<span class="linenr"> 8563: </span>  <span class=
"org-string">"Epsilon;"</span>: <span class=
"org-string">"Ε"</span>,
<span class="linenr"> 8564: </span>  <span class=
"org-string">"epsilon;"</span>: <span class=
"org-string">"ε"</span>,
<span class="linenr"> 8565: </span>  <span class=
"org-string">"eqcolon;"</span>: <span class=
"org-string">"≕"</span>,
<span class="linenr"> 8566: </span>  <span class=
"org-string">"equivDD;"</span>: <span class=
"org-string">"⩸"</span>,
<span class="linenr"> 8567: </span>  <span class=
"org-string">"gesdoto;"</span>: <span class=
"org-string">"⪂"</span>,
<span class="linenr"> 8568: </span>  <span class=
"org-string">"gtquest;"</span>: <span class=
"org-string">"⩼"</span>,
<span class="linenr"> 8569: </span>  <span class=
"org-string">"gtrless;"</span>: <span class=
"org-string">"≷"</span>,
<span class="linenr"> 8570: </span>  <span class=
"org-string">"harrcir;"</span>: <span class=
"org-string">"⥈"</span>,
<span class="linenr"> 8571: </span>  <span class=
"org-string">"Implies;"</span>: <span class=
"org-string">"⇒"</span>,
<span class="linenr"> 8572: </span>  <span class=
"org-string">"intprod;"</span>: <span class=
"org-string">"⨼"</span>,
<span class="linenr"> 8573: </span>  <span class=
"org-string">"isindot;"</span>: <span class=
"org-string">"⋵"</span>,
<span class="linenr"> 8574: </span>  <span class=
"org-string">"larrbfs;"</span>: <span class=
"org-string">"⤟"</span>,
<span class="linenr"> 8575: </span>  <span class=
"org-string">"larrsim;"</span>: <span class=
"org-string">"⥳"</span>,
<span class="linenr"> 8576: </span>  <span class=
"org-string">"lbrksld;"</span>: <span class=
"org-string">"⦏"</span>,
<span class="linenr"> 8577: </span>  <span class=
"org-string">"lbrkslu;"</span>: <span class=
"org-string">"⦍"</span>,
<span class="linenr"> 8578: </span>  <span class=
"org-string">"ldrdhar;"</span>: <span class=
"org-string">"⥧"</span>,
<span class="linenr"> 8579: </span>  <span class=
"org-string">"LeftTee;"</span>: <span class=
"org-string">"⊣"</span>,
<span class="linenr"> 8580: </span>  <span class=
"org-string">"lesdoto;"</span>: <span class=
"org-string">"⪁"</span>,
<span class="linenr"> 8581: </span>  <span class=
"org-string">"lessdot;"</span>: <span class=
"org-string">"⋖"</span>,
<span class="linenr"> 8582: </span>  <span class=
"org-string">"lessgtr;"</span>: <span class=
"org-string">"≶"</span>,
<span class="linenr"> 8583: </span>  <span class=
"org-string">"lesssim;"</span>: <span class=
"org-string">"≲"</span>,
<span class="linenr"> 8584: </span>  <span class=
"org-string">"lotimes;"</span>: <span class=
"org-string">"⨴"</span>,
<span class="linenr"> 8585: </span>  <span class=
"org-string">"lozenge;"</span>: <span class=
"org-string">"◊"</span>,
<span class="linenr"> 8586: </span>  <span class=
"org-string">"ltquest;"</span>: <span class=
"org-string">"⩻"</span>,
<span class="linenr"> 8587: </span>  <span class=
"org-string">"luruhar;"</span>: <span class=
"org-string">"⥦"</span>,
<span class="linenr"> 8588: </span>  <span class=
"org-string">"maltese;"</span>: <span class=
"org-string">"✠"</span>,
<span class="linenr"> 8589: </span>  <span class=
"org-string">"minusdu;"</span>: <span class=
"org-string">"⨪"</span>,
<span class="linenr"> 8590: </span>  <span class=
"org-string">"napprox;"</span>: <span class=
"org-string">"≉"</span>,
<span class="linenr"> 8591: </span>  <span class=
"org-string">"natural;"</span>: <span class=
"org-string">"♮"</span>,
<span class="linenr"> 8592: </span>  <span class=
"org-string">"nearrow;"</span>: <span class=
"org-string">"↗"</span>,
<span class="linenr"> 8593: </span>  <span class=
"org-string">"NewLine;"</span>: <span class=
"org-string">"\n"</span>,
<span class="linenr"> 8594: </span>  <span class=
"org-string">"nexists;"</span>: <span class=
"org-string">"∄"</span>,
<span class="linenr"> 8595: </span>  <span class=
"org-string">"NoBreak;"</span>: <span class=
"org-string">"⁠"</span>,
<span class="linenr"> 8596: </span>  <span class=
"org-string">"notinva;"</span>: <span class=
"org-string">"∉"</span>,
<span class="linenr"> 8597: </span>  <span class=
"org-string">"notinvb;"</span>: <span class=
"org-string">"⋷"</span>,
<span class="linenr"> 8598: </span>  <span class=
"org-string">"notinvc;"</span>: <span class=
"org-string">"⋶"</span>,
<span class="linenr"> 8599: </span>  <span class=
"org-string">"NotLess;"</span>: <span class=
"org-string">"≮"</span>,
<span class="linenr"> 8600: </span>  <span class=
"org-string">"notniva;"</span>: <span class=
"org-string">"∌"</span>,
<span class="linenr"> 8601: </span>  <span class=
"org-string">"notnivb;"</span>: <span class=
"org-string">"⋾"</span>,
<span class="linenr"> 8602: </span>  <span class=
"org-string">"notnivc;"</span>: <span class=
"org-string">"⋽"</span>,
<span class="linenr"> 8603: </span>  <span class=
"org-string">"npolint;"</span>: <span class=
"org-string">"⨔"</span>,
<span class="linenr"> 8604: </span>  <span class=
"org-string">"npreceq;"</span>: <span class=
"org-string">"⪯̸"</span>,
<span class="linenr"> 8605: </span>  <span class=
"org-string">"nsqsube;"</span>: <span class=
"org-string">"⋢"</span>,
<span class="linenr"> 8606: </span>  <span class=
"org-string">"nsqsupe;"</span>: <span class=
"org-string">"⋣"</span>,
<span class="linenr"> 8607: </span>  <span class=
"org-string">"nsubset;"</span>: <span class=
"org-string">"⊂⃒"</span>,
<span class="linenr"> 8608: </span>  <span class=
"org-string">"nsucceq;"</span>: <span class=
"org-string">"⪰̸"</span>,
<span class="linenr"> 8609: </span>  <span class=
"org-string">"nsupset;"</span>: <span class=
"org-string">"⊃⃒"</span>,
<span class="linenr"> 8610: </span>  <span class=
"org-string">"nvinfin;"</span>: <span class=
"org-string">"⧞"</span>,
<span class="linenr"> 8611: </span>  <span class=
"org-string">"nvltrie;"</span>: <span class=
"org-string">"⊴⃒"</span>,
<span class="linenr"> 8612: </span>  <span class=
"org-string">"nvrtrie;"</span>: <span class=
"org-string">"⊵⃒"</span>,
<span class="linenr"> 8613: </span>  <span class=
"org-string">"nwarrow;"</span>: <span class=
"org-string">"↖"</span>,
<span class="linenr"> 8614: </span>  <span class=
"org-string">"olcross;"</span>: <span class=
"org-string">"⦻"</span>,
<span class="linenr"> 8615: </span>  <span class=
"org-string">"Omicron;"</span>: <span class=
"org-string">"Ο"</span>,
<span class="linenr"> 8616: </span>  <span class=
"org-string">"omicron;"</span>: <span class=
"org-string">"ο"</span>,
<span class="linenr"> 8617: </span>  <span class=
"org-string">"orderof;"</span>: <span class=
"org-string">"ℴ"</span>,
<span class="linenr"> 8618: </span>  <span class=
"org-string">"orslope;"</span>: <span class=
"org-string">"⩗"</span>,
<span class="linenr"> 8619: </span>  <span class=
"org-string">"OverBar;"</span>: <span class=
"org-string">"‾"</span>,
<span class="linenr"> 8620: </span>  <span class=
"org-string">"pertenk;"</span>: <span class=
"org-string">"‱"</span>,
<span class="linenr"> 8621: </span>  <span class=
"org-string">"planckh;"</span>: <span class=
"org-string">"ℎ"</span>,
<span class="linenr"> 8622: </span>  <span class=
"org-string">"pluscir;"</span>: <span class=
"org-string">"⨢"</span>,
<span class="linenr"> 8623: </span>  <span class=
"org-string">"plussim;"</span>: <span class=
"org-string">"⨦"</span>,
<span class="linenr"> 8624: </span>  <span class=
"org-string">"plustwo;"</span>: <span class=
"org-string">"⨧"</span>,
<span class="linenr"> 8625: </span>  <span class=
"org-string">"precsim;"</span>: <span class=
"org-string">"≾"</span>,
<span class="linenr"> 8626: </span>  <span class=
"org-string">"Product;"</span>: <span class=
"org-string">"∏"</span>,
<span class="linenr"> 8627: </span>  <span class=
"org-string">"quatint;"</span>: <span class=
"org-string">"⨖"</span>,
<span class="linenr"> 8628: </span>  <span class=
"org-string">"questeq;"</span>: <span class=
"org-string">"≟"</span>,
<span class="linenr"> 8629: </span>  <span class=
"org-string">"rarrbfs;"</span>: <span class=
"org-string">"⤠"</span>,
<span class="linenr"> 8630: </span>  <span class=
"org-string">"rarrsim;"</span>: <span class=
"org-string">"⥴"</span>,
<span class="linenr"> 8631: </span>  <span class=
"org-string">"rbrksld;"</span>: <span class=
"org-string">"⦎"</span>,
<span class="linenr"> 8632: </span>  <span class=
"org-string">"rbrkslu;"</span>: <span class=
"org-string">"⦐"</span>,
<span class="linenr"> 8633: </span>  <span class=
"org-string">"rdldhar;"</span>: <span class=
"org-string">"⥩"</span>,
<span class="linenr"> 8634: </span>  <span class=
"org-string">"realine;"</span>: <span class=
"org-string">"ℛ"</span>,
<span class="linenr"> 8635: </span>  <span class=
"org-string">"rotimes;"</span>: <span class=
"org-string">"⨵"</span>,
<span class="linenr"> 8636: </span>  <span class=
"org-string">"ruluhar;"</span>: <span class=
"org-string">"⥨"</span>,
<span class="linenr"> 8637: </span>  <span class=
"org-string">"searrow;"</span>: <span class=
"org-string">"↘"</span>,
<span class="linenr"> 8638: </span>  <span class=
"org-string">"simplus;"</span>: <span class=
"org-string">"⨤"</span>,
<span class="linenr"> 8639: </span>  <span class=
"org-string">"simrarr;"</span>: <span class=
"org-string">"⥲"</span>,
<span class="linenr"> 8640: </span>  <span class=
"org-string">"subedot;"</span>: <span class=
"org-string">"⫃"</span>,
<span class="linenr"> 8641: </span>  <span class=
"org-string">"submult;"</span>: <span class=
"org-string">"⫁"</span>,
<span class="linenr"> 8642: </span>  <span class=
"org-string">"subplus;"</span>: <span class=
"org-string">"⪿"</span>,
<span class="linenr"> 8643: </span>  <span class=
"org-string">"subrarr;"</span>: <span class=
"org-string">"⥹"</span>,
<span class="linenr"> 8644: </span>  <span class=
"org-string">"succsim;"</span>: <span class=
"org-string">"≿"</span>,
<span class="linenr"> 8645: </span>  <span class=
"org-string">"supdsub;"</span>: <span class=
"org-string">"⫘"</span>,
<span class="linenr"> 8646: </span>  <span class=
"org-string">"supedot;"</span>: <span class=
"org-string">"⫄"</span>,
<span class="linenr"> 8647: </span>  <span class=
"org-string">"suphsol;"</span>: <span class=
"org-string">"⟉"</span>,
<span class="linenr"> 8648: </span>  <span class=
"org-string">"suphsub;"</span>: <span class=
"org-string">"⫗"</span>,
<span class="linenr"> 8649: </span>  <span class=
"org-string">"suplarr;"</span>: <span class=
"org-string">"⥻"</span>,
<span class="linenr"> 8650: </span>  <span class=
"org-string">"supmult;"</span>: <span class=
"org-string">"⫂"</span>,
<span class="linenr"> 8651: </span>  <span class=
"org-string">"supplus;"</span>: <span class=
"org-string">"⫀"</span>,
<span class="linenr"> 8652: </span>  <span class=
"org-string">"swarrow;"</span>: <span class=
"org-string">"↙"</span>,
<span class="linenr"> 8653: </span>  <span class=
"org-string">"topfork;"</span>: <span class=
"org-string">"⫚"</span>,
<span class="linenr"> 8654: </span>  <span class=
"org-string">"triplus;"</span>: <span class=
"org-string">"⨹"</span>,
<span class="linenr"> 8655: </span>  <span class=
"org-string">"tritime;"</span>: <span class=
"org-string">"⨻"</span>,
<span class="linenr"> 8656: </span>  <span class=
"org-string">"UpArrow;"</span>: <span class=
"org-string">"↑"</span>,
<span class="linenr"> 8657: </span>  <span class=
"org-string">"Uparrow;"</span>: <span class=
"org-string">"⇑"</span>,
<span class="linenr"> 8658: </span>  <span class=
"org-string">"uparrow;"</span>: <span class=
"org-string">"↑"</span>,
<span class="linenr"> 8659: </span>  <span class=
"org-string">"Upsilon;"</span>: <span class=
"org-string">"Υ"</span>,
<span class="linenr"> 8660: </span>  <span class=
"org-string">"upsilon;"</span>: <span class=
"org-string">"υ"</span>,
<span class="linenr"> 8661: </span>  <span class=
"org-string">"uwangle;"</span>: <span class=
"org-string">"⦧"</span>,
<span class="linenr"> 8662: </span>  <span class=
"org-string">"vzigzag;"</span>: <span class=
"org-string">"⦚"</span>,
<span class="linenr"> 8663: </span>  <span class=
"org-string">"zigrarr;"</span>: <span class=
"org-string">"⇝"</span>,
<span class="linenr"> 8664: </span>  <span class=
"org-string">"andslope;"</span>: <span class=
"org-string">"⩘"</span>,
<span class="linenr"> 8665: </span>  <span class=
"org-string">"angmsdaa;"</span>: <span class=
"org-string">"⦨"</span>,
<span class="linenr"> 8666: </span>  <span class=
"org-string">"angmsdab;"</span>: <span class=
"org-string">"⦩"</span>,
<span class="linenr"> 8667: </span>  <span class=
"org-string">"angmsdac;"</span>: <span class=
"org-string">"⦪"</span>,
<span class="linenr"> 8668: </span>  <span class=
"org-string">"angmsdad;"</span>: <span class=
"org-string">"⦫"</span>,
<span class="linenr"> 8669: </span>  <span class=
"org-string">"angmsdae;"</span>: <span class=
"org-string">"⦬"</span>,
<span class="linenr"> 8670: </span>  <span class=
"org-string">"angmsdaf;"</span>: <span class=
"org-string">"⦭"</span>,
<span class="linenr"> 8671: </span>  <span class=
"org-string">"angmsdag;"</span>: <span class=
"org-string">"⦮"</span>,
<span class="linenr"> 8672: </span>  <span class=
"org-string">"angmsdah;"</span>: <span class=
"org-string">"⦯"</span>,
<span class="linenr"> 8673: </span>  <span class=
"org-string">"angrtvbd;"</span>: <span class=
"org-string">"⦝"</span>,
<span class="linenr"> 8674: </span>  <span class=
"org-string">"approxeq;"</span>: <span class=
"org-string">"≊"</span>,
<span class="linenr"> 8675: </span>  <span class=
"org-string">"awconint;"</span>: <span class=
"org-string">"∳"</span>,
<span class="linenr"> 8676: </span>  <span class=
"org-string">"backcong;"</span>: <span class=
"org-string">"≌"</span>,
<span class="linenr"> 8677: </span>  <span class=
"org-string">"barwedge;"</span>: <span class=
"org-string">"⌅"</span>,
<span class="linenr"> 8678: </span>  <span class=
"org-string">"bbrktbrk;"</span>: <span class=
"org-string">"⎶"</span>,
<span class="linenr"> 8679: </span>  <span class=
"org-string">"bigoplus;"</span>: <span class=
"org-string">"⨁"</span>,
<span class="linenr"> 8680: </span>  <span class=
"org-string">"bigsqcup;"</span>: <span class=
"org-string">"⨆"</span>,
<span class="linenr"> 8681: </span>  <span class=
"org-string">"biguplus;"</span>: <span class=
"org-string">"⨄"</span>,
<span class="linenr"> 8682: </span>  <span class=
"org-string">"bigwedge;"</span>: <span class=
"org-string">"⋀"</span>,
<span class="linenr"> 8683: </span>  <span class=
"org-string">"boxminus;"</span>: <span class=
"org-string">"⊟"</span>,
<span class="linenr"> 8684: </span>  <span class=
"org-string">"boxtimes;"</span>: <span class=
"org-string">"⊠"</span>,
<span class="linenr"> 8685: </span>  <span class=
"org-string">"bsolhsub;"</span>: <span class=
"org-string">"⟈"</span>,
<span class="linenr"> 8686: </span>  <span class=
"org-string">"capbrcup;"</span>: <span class=
"org-string">"⩉"</span>,
<span class="linenr"> 8687: </span>  <span class=
"org-string">"circledR;"</span>: <span class=
"org-string">"®"</span>,
<span class="linenr"> 8688: </span>  <span class=
"org-string">"circledS;"</span>: <span class=
"org-string">"Ⓢ"</span>,
<span class="linenr"> 8689: </span>  <span class=
"org-string">"cirfnint;"</span>: <span class=
"org-string">"⨐"</span>,
<span class="linenr"> 8690: </span>  <span class=
"org-string">"clubsuit;"</span>: <span class=
"org-string">"♣"</span>,
<span class="linenr"> 8691: </span>  <span class=
"org-string">"cupbrcap;"</span>: <span class=
"org-string">"⩈"</span>,
<span class="linenr"> 8692: </span>  <span class=
"org-string">"curlyvee;"</span>: <span class=
"org-string">"⋎"</span>,
<span class="linenr"> 8693: </span>  <span class=
"org-string">"cwconint;"</span>: <span class=
"org-string">"∲"</span>,
<span class="linenr"> 8694: </span>  <span class=
"org-string">"DDotrahd;"</span>: <span class=
"org-string">"⤑"</span>,
<span class="linenr"> 8695: </span>  <span class=
"org-string">"doteqdot;"</span>: <span class=
"org-string">"≑"</span>,
<span class="linenr"> 8696: </span>  <span class=
"org-string">"DotEqual;"</span>: <span class=
"org-string">"≐"</span>,
<span class="linenr"> 8697: </span>  <span class=
"org-string">"dotminus;"</span>: <span class=
"org-string">"∸"</span>,
<span class="linenr"> 8698: </span>  <span class=
"org-string">"drbkarow;"</span>: <span class=
"org-string">"⤐"</span>,
<span class="linenr"> 8699: </span>  <span class=
"org-string">"dzigrarr;"</span>: <span class=
"org-string">"⟿"</span>,
<span class="linenr"> 8700: </span>  <span class=
"org-string">"elinters;"</span>: <span class=
"org-string">"⏧"</span>,
<span class="linenr"> 8701: </span>  <span class=
"org-string">"emptyset;"</span>: <span class=
"org-string">"∅"</span>,
<span class="linenr"> 8702: </span>  <span class=
"org-string">"eqvparsl;"</span>: <span class=
"org-string">"⧥"</span>,
<span class="linenr"> 8703: </span>  <span class=
"org-string">"fpartint;"</span>: <span class=
"org-string">"⨍"</span>,
<span class="linenr"> 8704: </span>  <span class=
"org-string">"geqslant;"</span>: <span class=
"org-string">"⩾"</span>,
<span class="linenr"> 8705: </span>  <span class=
"org-string">"gesdotol;"</span>: <span class=
"org-string">"⪄"</span>,
<span class="linenr"> 8706: </span>  <span class=
"org-string">"gnapprox;"</span>: <span class=
"org-string">"⪊"</span>,
<span class="linenr"> 8707: </span>  <span class=
"org-string">"hksearow;"</span>: <span class=
"org-string">"⤥"</span>,
<span class="linenr"> 8708: </span>  <span class=
"org-string">"hkswarow;"</span>: <span class=
"org-string">"⤦"</span>,
<span class="linenr"> 8709: </span>  <span class=
"org-string">"imagline;"</span>: <span class=
"org-string">"ℐ"</span>,
<span class="linenr"> 8710: </span>  <span class=
"org-string">"imagpart;"</span>: <span class=
"org-string">"ℑ"</span>,
<span class="linenr"> 8711: </span>  <span class=
"org-string">"infintie;"</span>: <span class=
"org-string">"⧝"</span>,
<span class="linenr"> 8712: </span>  <span class=
"org-string">"integers;"</span>: <span class=
"org-string">"ℤ"</span>,
<span class="linenr"> 8713: </span>  <span class=
"org-string">"Integral;"</span>: <span class=
"org-string">"∫"</span>,
<span class="linenr"> 8714: </span>  <span class=
"org-string">"intercal;"</span>: <span class=
"org-string">"⊺"</span>,
<span class="linenr"> 8715: </span>  <span class=
"org-string">"intlarhk;"</span>: <span class=
"org-string">"⨗"</span>,
<span class="linenr"> 8716: </span>  <span class=
"org-string">"laemptyv;"</span>: <span class=
"org-string">"⦴"</span>,
<span class="linenr"> 8717: </span>  <span class=
"org-string">"ldrushar;"</span>: <span class=
"org-string">"⥋"</span>,
<span class="linenr"> 8718: </span>  <span class=
"org-string">"leqslant;"</span>: <span class=
"org-string">"⩽"</span>,
<span class="linenr"> 8719: </span>  <span class=
"org-string">"lesdotor;"</span>: <span class=
"org-string">"⪃"</span>,
<span class="linenr"> 8720: </span>  <span class=
"org-string">"LessLess;"</span>: <span class=
"org-string">"⪡"</span>,
<span class="linenr"> 8721: </span>  <span class=
"org-string">"llcorner;"</span>: <span class=
"org-string">"⌞"</span>,
<span class="linenr"> 8722: </span>  <span class=
"org-string">"lnapprox;"</span>: <span class=
"org-string">"⪉"</span>,
<span class="linenr"> 8723: </span>  <span class=
"org-string">"lrcorner;"</span>: <span class=
"org-string">"⌟"</span>,
<span class="linenr"> 8724: </span>  <span class=
"org-string">"lurdshar;"</span>: <span class=
"org-string">"⥊"</span>,
<span class="linenr"> 8725: </span>  <span class=
"org-string">"mapstoup;"</span>: <span class=
"org-string">"↥"</span>,
<span class="linenr"> 8726: </span>  <span class=
"org-string">"multimap;"</span>: <span class=
"org-string">"⊸"</span>,
<span class="linenr"> 8727: </span>  <span class=
"org-string">"naturals;"</span>: <span class=
"org-string">"ℕ"</span>,
<span class="linenr"> 8728: </span>  <span class=
"org-string">"ncongdot;"</span>: <span class=
"org-string">"⩭̸"</span>,
<span class="linenr"> 8729: </span>  <span class=
"org-string">"NotEqual;"</span>: <span class=
"org-string">"≠"</span>,
<span class="linenr"> 8730: </span>  <span class=
"org-string">"notindot;"</span>: <span class=
"org-string">"⋵̸"</span>,
<span class="linenr"> 8731: </span>  <span class=
"org-string">"NotTilde;"</span>: <span class=
"org-string">"≁"</span>,
<span class="linenr"> 8732: </span>  <span class=
"org-string">"otimesas;"</span>: <span class=
"org-string">"⨶"</span>,
<span class="linenr"> 8733: </span>  <span class=
"org-string">"parallel;"</span>: <span class=
"org-string">"∥"</span>,
<span class="linenr"> 8734: </span>  <span class=
"org-string">"PartialD;"</span>: <span class=
"org-string">"∂"</span>,
<span class="linenr"> 8735: </span>  <span class=
"org-string">"plusacir;"</span>: <span class=
"org-string">"⨣"</span>,
<span class="linenr"> 8736: </span>  <span class=
"org-string">"pointint;"</span>: <span class=
"org-string">"⨕"</span>,
<span class="linenr"> 8737: </span>  <span class=
"org-string">"Precedes;"</span>: <span class=
"org-string">"≺"</span>,
<span class="linenr"> 8738: </span>  <span class=
"org-string">"precneqq;"</span>: <span class=
"org-string">"⪵"</span>,
<span class="linenr"> 8739: </span>  <span class=
"org-string">"precnsim;"</span>: <span class=
"org-string">"⋨"</span>,
<span class="linenr"> 8740: </span>  <span class=
"org-string">"profalar;"</span>: <span class=
"org-string">"⌮"</span>,
<span class="linenr"> 8741: </span>  <span class=
"org-string">"profline;"</span>: <span class=
"org-string">"⌒"</span>,
<span class="linenr"> 8742: </span>  <span class=
"org-string">"profsurf;"</span>: <span class=
"org-string">"⌓"</span>,
<span class="linenr"> 8743: </span>  <span class=
"org-string">"raemptyv;"</span>: <span class=
"org-string">"⦳"</span>,
<span class="linenr"> 8744: </span>  <span class=
"org-string">"realpart;"</span>: <span class=
"org-string">"ℜ"</span>,
<span class="linenr"> 8745: </span>  <span class=
"org-string">"RightTee;"</span>: <span class=
"org-string">"⊢"</span>,
<span class="linenr"> 8746: </span>  <span class=
"org-string">"rppolint;"</span>: <span class=
"org-string">"⨒"</span>,
<span class="linenr"> 8747: </span>  <span class=
"org-string">"rtriltri;"</span>: <span class=
"org-string">"⧎"</span>,
<span class="linenr"> 8748: </span>  <span class=
"org-string">"scpolint;"</span>: <span class=
"org-string">"⨓"</span>,
<span class="linenr"> 8749: </span>  <span class=
"org-string">"setminus;"</span>: <span class=
"org-string">"∖"</span>,
<span class="linenr"> 8750: </span>  <span class=
"org-string">"shortmid;"</span>: <span class=
"org-string">"∣"</span>,
<span class="linenr"> 8751: </span>  <span class=
"org-string">"smeparsl;"</span>: <span class=
"org-string">"⧤"</span>,
<span class="linenr"> 8752: </span>  <span class=
"org-string">"sqsubset;"</span>: <span class=
"org-string">"⊏"</span>,
<span class="linenr"> 8753: </span>  <span class=
"org-string">"sqsupset;"</span>: <span class=
"org-string">"⊐"</span>,
<span class="linenr"> 8754: </span>  <span class=
"org-string">"subseteq;"</span>: <span class=
"org-string">"⊆"</span>,
<span class="linenr"> 8755: </span>  <span class=
"org-string">"Succeeds;"</span>: <span class=
"org-string">"≻"</span>,
<span class="linenr"> 8756: </span>  <span class=
"org-string">"succneqq;"</span>: <span class=
"org-string">"⪶"</span>,
<span class="linenr"> 8757: </span>  <span class=
"org-string">"succnsim;"</span>: <span class=
"org-string">"⋩"</span>,
<span class="linenr"> 8758: </span>  <span class=
"org-string">"SuchThat;"</span>: <span class=
"org-string">"∋"</span>,
<span class="linenr"> 8759: </span>  <span class=
"org-string">"Superset;"</span>: <span class=
"org-string">"⊃"</span>,
<span class="linenr"> 8760: </span>  <span class=
"org-string">"supseteq;"</span>: <span class=
"org-string">"⊇"</span>,
<span class="linenr"> 8761: </span>  <span class=
"org-string">"thetasym;"</span>: <span class=
"org-string">"ϑ"</span>,
<span class="linenr"> 8762: </span>  <span class=
"org-string">"thicksim;"</span>: <span class=
"org-string">"∼"</span>,
<span class="linenr"> 8763: </span>  <span class=
"org-string">"timesbar;"</span>: <span class=
"org-string">"⨱"</span>,
<span class="linenr"> 8764: </span>  <span class=
"org-string">"triangle;"</span>: <span class=
"org-string">"▵"</span>,
<span class="linenr"> 8765: </span>  <span class=
"org-string">"triminus;"</span>: <span class=
"org-string">"⨺"</span>,
<span class="linenr"> 8766: </span>  <span class=
"org-string">"trpezium;"</span>: <span class=
"org-string">"⏢"</span>,
<span class="linenr"> 8767: </span>  <span class=
"org-string">"Uarrocir;"</span>: <span class=
"org-string">"⥉"</span>,
<span class="linenr"> 8768: </span>  <span class=
"org-string">"ulcorner;"</span>: <span class=
"org-string">"⌜"</span>,
<span class="linenr"> 8769: </span>  <span class=
"org-string">"UnderBar;"</span>: <span class=
"org-string">"_"</span>,
<span class="linenr"> 8770: </span>  <span class=
"org-string">"urcorner;"</span>: <span class=
"org-string">"⌝"</span>,
<span class="linenr"> 8771: </span>  <span class=
"org-string">"varkappa;"</span>: <span class=
"org-string">"ϰ"</span>,
<span class="linenr"> 8772: </span>  <span class=
"org-string">"varsigma;"</span>: <span class=
"org-string">"ς"</span>,
<span class="linenr"> 8773: </span>  <span class=
"org-string">"vartheta;"</span>: <span class=
"org-string">"ϑ"</span>,
<span class="linenr"> 8774: </span>  <span class=
"org-string">"backprime;"</span>: <span class=
"org-string">"‵"</span>,
<span class="linenr"> 8775: </span>  <span class=
"org-string">"backsimeq;"</span>: <span class=
"org-string">"⋍"</span>,
<span class="linenr"> 8776: </span>  <span class=
"org-string">"Backslash;"</span>: <span class=
"org-string">"∖"</span>,
<span class="linenr"> 8777: </span>  <span class=
"org-string">"bigotimes;"</span>: <span class=
"org-string">"⨂"</span>,
<span class="linenr"> 8778: </span>  <span class=
"org-string">"CenterDot;"</span>: <span class=
"org-string">"·"</span>,
<span class="linenr"> 8779: </span>  <span class=
"org-string">"centerdot;"</span>: <span class=
"org-string">"·"</span>,
<span class="linenr"> 8780: </span>  <span class=
"org-string">"checkmark;"</span>: <span class=
"org-string">"✓"</span>,
<span class="linenr"> 8781: </span>  <span class=
"org-string">"CircleDot;"</span>: <span class=
"org-string">"⊙"</span>,
<span class="linenr"> 8782: </span>  <span class=
"org-string">"complexes;"</span>: <span class=
"org-string">"ℂ"</span>,
<span class="linenr"> 8783: </span>  <span class=
"org-string">"Congruent;"</span>: <span class=
"org-string">"≡"</span>,
<span class="linenr"> 8784: </span>  <span class=
"org-string">"Coproduct;"</span>: <span class=
"org-string">"∐"</span>,
<span class="linenr"> 8785: </span>  <span class=
"org-string">"dotsquare;"</span>: <span class=
"org-string">"⊡"</span>,
<span class="linenr"> 8786: </span>  <span class=
"org-string">"DoubleDot;"</span>: <span class=
"org-string">"¨"</span>,
<span class="linenr"> 8787: </span>  <span class=
"org-string">"DownArrow;"</span>: <span class=
"org-string">"↓"</span>,
<span class="linenr"> 8788: </span>  <span class=
"org-string">"Downarrow;"</span>: <span class=
"org-string">"⇓"</span>,
<span class="linenr"> 8789: </span>  <span class=
"org-string">"downarrow;"</span>: <span class=
"org-string">"↓"</span>,
<span class="linenr"> 8790: </span>  <span class=
"org-string">"DownBreve;"</span>: <span class=
"org-string">"̑"</span>,
<span class="linenr"> 8791: </span>  <span class=
"org-string">"gtrapprox;"</span>: <span class=
"org-string">"⪆"</span>,
<span class="linenr"> 8792: </span>  <span class=
"org-string">"gtreqless;"</span>: <span class=
"org-string">"⋛"</span>,
<span class="linenr"> 8793: </span>  <span class=
"org-string">"gvertneqq;"</span>: <span class=
"org-string">"≩︀"</span>,
<span class="linenr"> 8794: </span>  <span class=
"org-string">"heartsuit;"</span>: <span class=
"org-string">"♥"</span>,
<span class="linenr"> 8795: </span>  <span class=
"org-string">"HumpEqual;"</span>: <span class=
"org-string">"≏"</span>,
<span class="linenr"> 8796: </span>  <span class=
"org-string">"LeftArrow;"</span>: <span class=
"org-string">"←"</span>,
<span class="linenr"> 8797: </span>  <span class=
"org-string">"Leftarrow;"</span>: <span class=
"org-string">"⇐"</span>,
<span class="linenr"> 8798: </span>  <span class=
"org-string">"leftarrow;"</span>: <span class=
"org-string">"←"</span>,
<span class="linenr"> 8799: </span>  <span class=
"org-string">"LeftFloor;"</span>: <span class=
"org-string">"⌊"</span>,
<span class="linenr"> 8800: </span>  <span class=
"org-string">"lesseqgtr;"</span>: <span class=
"org-string">"⋚"</span>,
<span class="linenr"> 8801: </span>  <span class=
"org-string">"LessTilde;"</span>: <span class=
"org-string">"≲"</span>,
<span class="linenr"> 8802: </span>  <span class=
"org-string">"lvertneqq;"</span>: <span class=
"org-string">"≨︀"</span>,
<span class="linenr"> 8803: </span>  <span class=
"org-string">"Mellintrf;"</span>: <span class=
"org-string">"ℳ"</span>,
<span class="linenr"> 8804: </span>  <span class=
"org-string">"MinusPlus;"</span>: <span class=
"org-string">"∓"</span>,
<span class="linenr"> 8805: </span>  <span class=
"org-string">"ngeqslant;"</span>: <span class=
"org-string">"⩾̸"</span>,
<span class="linenr"> 8806: </span>  <span class=
"org-string">"nleqslant;"</span>: <span class=
"org-string">"⩽̸"</span>,
<span class="linenr"> 8807: </span>  <span class=
"org-string">"NotCupCap;"</span>: <span class=
"org-string">"≭"</span>,
<span class="linenr"> 8808: </span>  <span class=
"org-string">"NotExists;"</span>: <span class=
"org-string">"∄"</span>,
<span class="linenr"> 8809: </span>  <span class=
"org-string">"NotSubset;"</span>: <span class=
"org-string">"⊂⃒"</span>,
<span class="linenr"> 8810: </span>  <span class=
"org-string">"nparallel;"</span>: <span class=
"org-string">"∦"</span>,
<span class="linenr"> 8811: </span>  <span class=
"org-string">"nshortmid;"</span>: <span class=
"org-string">"∤"</span>,
<span class="linenr"> 8812: </span>  <span class=
"org-string">"nsubseteq;"</span>: <span class=
"org-string">"⊈"</span>,
<span class="linenr"> 8813: </span>  <span class=
"org-string">"nsupseteq;"</span>: <span class=
"org-string">"⊉"</span>,
<span class="linenr"> 8814: </span>  <span class=
"org-string">"OverBrace;"</span>: <span class=
"org-string">"⏞"</span>,
<span class="linenr"> 8815: </span>  <span class=
"org-string">"pitchfork;"</span>: <span class=
"org-string">"⋔"</span>,
<span class="linenr"> 8816: </span>  <span class=
"org-string">"PlusMinus;"</span>: <span class=
"org-string">"±"</span>,
<span class="linenr"> 8817: </span>  <span class=
"org-string">"rationals;"</span>: <span class=
"org-string">"ℚ"</span>,
<span class="linenr"> 8818: </span>  <span class=
"org-string">"spadesuit;"</span>: <span class=
"org-string">"♠"</span>,
<span class="linenr"> 8819: </span>  <span class=
"org-string">"subseteqq;"</span>: <span class=
"org-string">"⫅"</span>,
<span class="linenr"> 8820: </span>  <span class=
"org-string">"subsetneq;"</span>: <span class=
"org-string">"⊊"</span>,
<span class="linenr"> 8821: </span>  <span class=
"org-string">"supseteqq;"</span>: <span class=
"org-string">"⫆"</span>,
<span class="linenr"> 8822: </span>  <span class=
"org-string">"supsetneq;"</span>: <span class=
"org-string">"⊋"</span>,
<span class="linenr"> 8823: </span>  <span class=
"org-string">"Therefore;"</span>: <span class=
"org-string">"∴"</span>,
<span class="linenr"> 8824: </span>  <span class=
"org-string">"therefore;"</span>: <span class=
"org-string">"∴"</span>,
<span class="linenr"> 8825: </span>  <span class=
"org-string">"ThinSpace;"</span>: <span class=
"org-string">" "</span>,
<span class="linenr"> 8826: </span>  <span class=
"org-string">"triangleq;"</span>: <span class=
"org-string">"≜"</span>,
<span class="linenr"> 8827: </span>  <span class=
"org-string">"TripleDot;"</span>: <span class=
"org-string">"⃛"</span>,
<span class="linenr"> 8828: </span>  <span class=
"org-string">"UnionPlus;"</span>: <span class=
"org-string">"⊎"</span>,
<span class="linenr"> 8829: </span>  <span class=
"org-string">"varpropto;"</span>: <span class=
"org-string">"∝"</span>,
<span class="linenr"> 8830: </span>  <span class=
"org-string">"Bernoullis;"</span>: <span class=
"org-string">"ℬ"</span>,
<span class="linenr"> 8831: </span>  <span class=
"org-string">"circledast;"</span>: <span class=
"org-string">"⊛"</span>,
<span class="linenr"> 8832: </span>  <span class=
"org-string">"CirclePlus;"</span>: <span class=
"org-string">"⊕"</span>,
<span class="linenr"> 8833: </span>  <span class=
"org-string">"complement;"</span>: <span class=
"org-string">"∁"</span>,
<span class="linenr"> 8834: </span>  <span class=
"org-string">"curlywedge;"</span>: <span class=
"org-string">"⋏"</span>,
<span class="linenr"> 8835: </span>  <span class=
"org-string">"eqslantgtr;"</span>: <span class=
"org-string">"⪖"</span>,
<span class="linenr"> 8836: </span>  <span class=
"org-string">"EqualTilde;"</span>: <span class=
"org-string">"≂"</span>,
<span class="linenr"> 8837: </span>  <span class=
"org-string">"Fouriertrf;"</span>: <span class=
"org-string">"ℱ"</span>,
<span class="linenr"> 8838: </span>  <span class=
"org-string">"gtreqqless;"</span>: <span class=
"org-string">"⪌"</span>,
<span class="linenr"> 8839: </span>  <span class=
"org-string">"ImaginaryI;"</span>: <span class=
"org-string">"ⅈ"</span>,
<span class="linenr"> 8840: </span>  <span class=
"org-string">"Laplacetrf;"</span>: <span class=
"org-string">"ℒ"</span>,
<span class="linenr"> 8841: </span>  <span class=
"org-string">"LeftVector;"</span>: <span class=
"org-string">"↼"</span>,
<span class="linenr"> 8842: </span>  <span class=
"org-string">"lessapprox;"</span>: <span class=
"org-string">"⪅"</span>,
<span class="linenr"> 8843: </span>  <span class=
"org-string">"lesseqqgtr;"</span>: <span class=
"org-string">"⪋"</span>,
<span class="linenr"> 8844: </span>  <span class=
"org-string">"Lleftarrow;"</span>: <span class=
"org-string">"⇚"</span>,
<span class="linenr"> 8845: </span>  <span class=
"org-string">"lmoustache;"</span>: <span class=
"org-string">"⎰"</span>,
<span class="linenr"> 8846: </span>  <span class=
"org-string">"longmapsto;"</span>: <span class=
"org-string">"⟼"</span>,
<span class="linenr"> 8847: </span>  <span class=
"org-string">"mapstodown;"</span>: <span class=
"org-string">"↧"</span>,
<span class="linenr"> 8848: </span>  <span class=
"org-string">"mapstoleft;"</span>: <span class=
"org-string">"↤"</span>,
<span class="linenr"> 8849: </span>  <span class=
"org-string">"nLeftarrow;"</span>: <span class=
"org-string">"⇍"</span>,
<span class="linenr"> 8850: </span>  <span class=
"org-string">"nleftarrow;"</span>: <span class=
"org-string">"↚"</span>,
<span class="linenr"> 8851: </span>  <span class=
"org-string">"NotElement;"</span>: <span class=
"org-string">"∉"</span>,
<span class="linenr"> 8852: </span>  <span class=
"org-string">"NotGreater;"</span>: <span class=
"org-string">"≯"</span>,
<span class="linenr"> 8853: </span>  <span class=
"org-string">"nsubseteqq;"</span>: <span class=
"org-string">"⫅̸"</span>,
<span class="linenr"> 8854: </span>  <span class=
"org-string">"nsupseteqq;"</span>: <span class=
"org-string">"⫆̸"</span>,
<span class="linenr"> 8855: </span>  <span class=
"org-string">"precapprox;"</span>: <span class=
"org-string">"⪷"</span>,
<span class="linenr"> 8856: </span>  <span class=
"org-string">"Proportion;"</span>: <span class=
"org-string">"∷"</span>,
<span class="linenr"> 8857: </span>  <span class=
"org-string">"RightArrow;"</span>: <span class=
"org-string">"→"</span>,
<span class="linenr"> 8858: </span>  <span class=
"org-string">"Rightarrow;"</span>: <span class=
"org-string">"⇒"</span>,
<span class="linenr"> 8859: </span>  <span class=
"org-string">"rightarrow;"</span>: <span class=
"org-string">"→"</span>,
<span class="linenr"> 8860: </span>  <span class=
"org-string">"RightFloor;"</span>: <span class=
"org-string">"⌋"</span>,
<span class="linenr"> 8861: </span>  <span class=
"org-string">"rmoustache;"</span>: <span class=
"org-string">"⎱"</span>,
<span class="linenr"> 8862: </span>  <span class=
"org-string">"sqsubseteq;"</span>: <span class=
"org-string">"⊑"</span>,
<span class="linenr"> 8863: </span>  <span class=
"org-string">"sqsupseteq;"</span>: <span class=
"org-string">"⊒"</span>,
<span class="linenr"> 8864: </span>  <span class=
"org-string">"subsetneqq;"</span>: <span class=
"org-string">"⫋"</span>,
<span class="linenr"> 8865: </span>  <span class=
"org-string">"succapprox;"</span>: <span class=
"org-string">"⪸"</span>,
<span class="linenr"> 8866: </span>  <span class=
"org-string">"supsetneqq;"</span>: <span class=
"org-string">"⫌"</span>,
<span class="linenr"> 8867: </span>  <span class=
"org-string">"ThickSpace;"</span>: <span class=
"org-string">"  "</span>,
<span class="linenr"> 8868: </span>  <span class=
"org-string">"TildeEqual;"</span>: <span class=
"org-string">"≃"</span>,
<span class="linenr"> 8869: </span>  <span class=
"org-string">"TildeTilde;"</span>: <span class=
"org-string">"≈"</span>,
<span class="linenr"> 8870: </span>  <span class=
"org-string">"UnderBrace;"</span>: <span class=
"org-string">"⏟"</span>,
<span class="linenr"> 8871: </span>  <span class=
"org-string">"UpArrowBar;"</span>: <span class=
"org-string">"⤒"</span>,
<span class="linenr"> 8872: </span>  <span class=
"org-string">"UpTeeArrow;"</span>: <span class=
"org-string">"↥"</span>,
<span class="linenr"> 8873: </span>  <span class=
"org-string">"upuparrows;"</span>: <span class=
"org-string">"⇈"</span>,
<span class="linenr"> 8874: </span>  <span class=
"org-string">"varepsilon;"</span>: <span class=
"org-string">"ϵ"</span>,
<span class="linenr"> 8875: </span>  <span class=
"org-string">"varnothing;"</span>: <span class=
"org-string">"∅"</span>,
<span class="linenr"> 8876: </span>  <span class=
"org-string">"backepsilon;"</span>: <span class=
"org-string">"϶"</span>,
<span class="linenr"> 8877: </span>  <span class=
"org-string">"blacksquare;"</span>: <span class=
"org-string">"▪"</span>,
<span class="linenr"> 8878: </span>  <span class=
"org-string">"circledcirc;"</span>: <span class=
"org-string">"⊚"</span>,
<span class="linenr"> 8879: </span>  <span class=
"org-string">"circleddash;"</span>: <span class=
"org-string">"⊝"</span>,
<span class="linenr"> 8880: </span>  <span class=
"org-string">"CircleMinus;"</span>: <span class=
"org-string">"⊖"</span>,
<span class="linenr"> 8881: </span>  <span class=
"org-string">"CircleTimes;"</span>: <span class=
"org-string">"⊗"</span>,
<span class="linenr"> 8882: </span>  <span class=
"org-string">"curlyeqprec;"</span>: <span class=
"org-string">"⋞"</span>,
<span class="linenr"> 8883: </span>  <span class=
"org-string">"curlyeqsucc;"</span>: <span class=
"org-string">"⋟"</span>,
<span class="linenr"> 8884: </span>  <span class=
"org-string">"diamondsuit;"</span>: <span class=
"org-string">"♦"</span>,
<span class="linenr"> 8885: </span>  <span class=
"org-string">"eqslantless;"</span>: <span class=
"org-string">"⪕"</span>,
<span class="linenr"> 8886: </span>  <span class=
"org-string">"Equilibrium;"</span>: <span class=
"org-string">"⇌"</span>,
<span class="linenr"> 8887: </span>  <span class=
"org-string">"expectation;"</span>: <span class=
"org-string">"ℰ"</span>,
<span class="linenr"> 8888: </span>  <span class=
"org-string">"GreaterLess;"</span>: <span class=
"org-string">"≷"</span>,
<span class="linenr"> 8889: </span>  <span class=
"org-string">"LeftCeiling;"</span>: <span class=
"org-string">"⌈"</span>,
<span class="linenr"> 8890: </span>  <span class=
"org-string">"LessGreater;"</span>: <span class=
"org-string">"≶"</span>,
<span class="linenr"> 8891: </span>  <span class=
"org-string">"MediumSpace;"</span>: <span class=
"org-string">" "</span>,
<span class="linenr"> 8892: </span>  <span class=
"org-string">"NotLessLess;"</span>: <span class=
"org-string">"≪̸"</span>,
<span class="linenr"> 8893: </span>  <span class=
"org-string">"NotPrecedes;"</span>: <span class=
"org-string">"⊀"</span>,
<span class="linenr"> 8894: </span>  <span class=
"org-string">"NotSucceeds;"</span>: <span class=
"org-string">"⊁"</span>,
<span class="linenr"> 8895: </span>  <span class=
"org-string">"NotSuperset;"</span>: <span class=
"org-string">"⊃⃒"</span>,
<span class="linenr"> 8896: </span>  <span class=
"org-string">"nRightarrow;"</span>: <span class=
"org-string">"⇏"</span>,
<span class="linenr"> 8897: </span>  <span class=
"org-string">"nrightarrow;"</span>: <span class=
"org-string">"↛"</span>,
<span class="linenr"> 8898: </span>  <span class=
"org-string">"OverBracket;"</span>: <span class=
"org-string">"⎴"</span>,
<span class="linenr"> 8899: </span>  <span class=
"org-string">"preccurlyeq;"</span>: <span class=
"org-string">"≼"</span>,
<span class="linenr"> 8900: </span>  <span class=
"org-string">"precnapprox;"</span>: <span class=
"org-string">"⪹"</span>,
<span class="linenr"> 8901: </span>  <span class=
"org-string">"quaternions;"</span>: <span class=
"org-string">"ℍ"</span>,
<span class="linenr"> 8902: </span>  <span class=
"org-string">"RightVector;"</span>: <span class=
"org-string">"⇀"</span>,
<span class="linenr"> 8903: </span>  <span class=
"org-string">"Rrightarrow;"</span>: <span class=
"org-string">"⇛"</span>,
<span class="linenr"> 8904: </span>  <span class=
"org-string">"RuleDelayed;"</span>: <span class=
"org-string">"⧴"</span>,
<span class="linenr"> 8905: </span>  <span class=
"org-string">"SmallCircle;"</span>: <span class=
"org-string">"∘"</span>,
<span class="linenr"> 8906: </span>  <span class=
"org-string">"SquareUnion;"</span>: <span class=
"org-string">"⊔"</span>,
<span class="linenr"> 8907: </span>  <span class=
"org-string">"straightphi;"</span>: <span class=
"org-string">"ϕ"</span>,
<span class="linenr"> 8908: </span>  <span class=
"org-string">"SubsetEqual;"</span>: <span class=
"org-string">"⊆"</span>,
<span class="linenr"> 8909: </span>  <span class=
"org-string">"succcurlyeq;"</span>: <span class=
"org-string">"≽"</span>,
<span class="linenr"> 8910: </span>  <span class=
"org-string">"succnapprox;"</span>: <span class=
"org-string">"⪺"</span>,
<span class="linenr"> 8911: </span>  <span class=
"org-string">"thickapprox;"</span>: <span class=
"org-string">"≈"</span>,
<span class="linenr"> 8912: </span>  <span class=
"org-string">"UpDownArrow;"</span>: <span class=
"org-string">"↕"</span>,
<span class="linenr"> 8913: </span>  <span class=
"org-string">"Updownarrow;"</span>: <span class=
"org-string">"⇕"</span>,
<span class="linenr"> 8914: </span>  <span class=
"org-string">"updownarrow;"</span>: <span class=
"org-string">"↕"</span>,
<span class="linenr"> 8915: </span>  <span class=
"org-string">"VerticalBar;"</span>: <span class=
"org-string">"∣"</span>,
<span class="linenr"> 8916: </span>  <span class=
"org-string">"blacklozenge;"</span>: <span class=
"org-string">"⧫"</span>,
<span class="linenr"> 8917: </span>  <span class=
"org-string">"DownArrowBar;"</span>: <span class=
"org-string">"⤓"</span>,
<span class="linenr"> 8918: </span>  <span class=
"org-string">"DownTeeArrow;"</span>: <span class=
"org-string">"↧"</span>,
<span class="linenr"> 8919: </span>  <span class=
"org-string">"ExponentialE;"</span>: <span class=
"org-string">"ⅇ"</span>,
<span class="linenr"> 8920: </span>  <span class=
"org-string">"exponentiale;"</span>: <span class=
"org-string">"ⅇ"</span>,
<span class="linenr"> 8921: </span>  <span class=
"org-string">"GreaterEqual;"</span>: <span class=
"org-string">"≥"</span>,
<span class="linenr"> 8922: </span>  <span class=
"org-string">"GreaterTilde;"</span>: <span class=
"org-string">"≳"</span>,
<span class="linenr"> 8923: </span>  <span class=
"org-string">"HilbertSpace;"</span>: <span class=
"org-string">"ℋ"</span>,
<span class="linenr"> 8924: </span>  <span class=
"org-string">"HumpDownHump;"</span>: <span class=
"org-string">"≎"</span>,
<span class="linenr"> 8925: </span>  <span class=
"org-string">"Intersection;"</span>: <span class=
"org-string">"⋂"</span>,
<span class="linenr"> 8926: </span>  <span class=
"org-string">"LeftArrowBar;"</span>: <span class=
"org-string">"⇤"</span>,
<span class="linenr"> 8927: </span>  <span class=
"org-string">"LeftTeeArrow;"</span>: <span class=
"org-string">"↤"</span>,
<span class="linenr"> 8928: </span>  <span class=
"org-string">"LeftTriangle;"</span>: <span class=
"org-string">"⊲"</span>,
<span class="linenr"> 8929: </span>  <span class=
"org-string">"LeftUpVector;"</span>: <span class=
"org-string">"↿"</span>,
<span class="linenr"> 8930: </span>  <span class=
"org-string">"NotCongruent;"</span>: <span class=
"org-string">"≢"</span>,
<span class="linenr"> 8931: </span>  <span class=
"org-string">"NotHumpEqual;"</span>: <span class=
"org-string">"≏̸"</span>,
<span class="linenr"> 8932: </span>  <span class=
"org-string">"NotLessEqual;"</span>: <span class=
"org-string">"≰"</span>,
<span class="linenr"> 8933: </span>  <span class=
"org-string">"NotLessTilde;"</span>: <span class=
"org-string">"≴"</span>,
<span class="linenr"> 8934: </span>  <span class=
"org-string">"Proportional;"</span>: <span class=
"org-string">"∝"</span>,
<span class="linenr"> 8935: </span>  <span class=
"org-string">"RightCeiling;"</span>: <span class=
"org-string">"⌉"</span>,
<span class="linenr"> 8936: </span>  <span class=
"org-string">"risingdotseq;"</span>: <span class=
"org-string">"≓"</span>,
<span class="linenr"> 8937: </span>  <span class=
"org-string">"RoundImplies;"</span>: <span class=
"org-string">"⥰"</span>,
<span class="linenr"> 8938: </span>  <span class=
"org-string">"ShortUpArrow;"</span>: <span class=
"org-string">"↑"</span>,
<span class="linenr"> 8939: </span>  <span class=
"org-string">"SquareSubset;"</span>: <span class=
"org-string">"⊏"</span>,
<span class="linenr"> 8940: </span>  <span class=
"org-string">"triangledown;"</span>: <span class=
"org-string">"▿"</span>,
<span class="linenr"> 8941: </span>  <span class=
"org-string">"triangleleft;"</span>: <span class=
"org-string">"◃"</span>,
<span class="linenr"> 8942: </span>  <span class=
"org-string">"UnderBracket;"</span>: <span class=
"org-string">"⎵"</span>,
<span class="linenr"> 8943: </span>  <span class=
"org-string">"varsubsetneq;"</span>: <span class=
"org-string">"⊊︀"</span>,
<span class="linenr"> 8944: </span>  <span class=
"org-string">"varsupsetneq;"</span>: <span class=
"org-string">"⊋︀"</span>,
<span class="linenr"> 8945: </span>  <span class=
"org-string">"VerticalLine;"</span>: <span class=
"org-string">"|"</span>,
<span class="linenr"> 8946: </span>  <span class=
"org-string">"ApplyFunction;"</span>: <span class=
"org-string">"⁡"</span>,
<span class="linenr"> 8947: </span>  <span class=
"org-string">"bigtriangleup;"</span>: <span class=
"org-string">"△"</span>,
<span class="linenr"> 8948: </span>  <span class=
"org-string">"blacktriangle;"</span>: <span class=
"org-string">"▴"</span>,
<span class="linenr"> 8949: </span>  <span class=
"org-string">"DifferentialD;"</span>: <span class=
"org-string">"ⅆ"</span>,
<span class="linenr"> 8950: </span>  <span class=
"org-string">"divideontimes;"</span>: <span class=
"org-string">"⋇"</span>,
<span class="linenr"> 8951: </span>  <span class=
"org-string">"DoubleLeftTee;"</span>: <span class=
"org-string">"⫤"</span>,
<span class="linenr"> 8952: </span>  <span class=
"org-string">"DoubleUpArrow;"</span>: <span class=
"org-string">"⇑"</span>,
<span class="linenr"> 8953: </span>  <span class=
"org-string">"fallingdotseq;"</span>: <span class=
"org-string">"≒"</span>,
<span class="linenr"> 8954: </span>  <span class=
"org-string">"hookleftarrow;"</span>: <span class=
"org-string">"↩"</span>,
<span class="linenr"> 8955: </span>  <span class=
"org-string">"leftarrowtail;"</span>: <span class=
"org-string">"↢"</span>,
<span class="linenr"> 8956: </span>  <span class=
"org-string">"leftharpoonup;"</span>: <span class=
"org-string">"↼"</span>,
<span class="linenr"> 8957: </span>  <span class=
"org-string">"LeftTeeVector;"</span>: <span class=
"org-string">"⥚"</span>,
<span class="linenr"> 8958: </span>  <span class=
"org-string">"LeftVectorBar;"</span>: <span class=
"org-string">"⥒"</span>,
<span class="linenr"> 8959: </span>  <span class=
"org-string">"LessFullEqual;"</span>: <span class=
"org-string">"≦"</span>,
<span class="linenr"> 8960: </span>  <span class=
"org-string">"LongLeftArrow;"</span>: <span class=
"org-string">"⟵"</span>,
<span class="linenr"> 8961: </span>  <span class=
"org-string">"Longleftarrow;"</span>: <span class=
"org-string">"⟸"</span>,
<span class="linenr"> 8962: </span>  <span class=
"org-string">"longleftarrow;"</span>: <span class=
"org-string">"⟵"</span>,
<span class="linenr"> 8963: </span>  <span class=
"org-string">"looparrowleft;"</span>: <span class=
"org-string">"↫"</span>,
<span class="linenr"> 8964: </span>  <span class=
"org-string">"measuredangle;"</span>: <span class=
"org-string">"∡"</span>,
<span class="linenr"> 8965: </span>  <span class=
"org-string">"NotEqualTilde;"</span>: <span class=
"org-string">"≂̸"</span>,
<span class="linenr"> 8966: </span>  <span class=
"org-string">"NotTildeEqual;"</span>: <span class=
"org-string">"≄"</span>,
<span class="linenr"> 8967: </span>  <span class=
"org-string">"NotTildeTilde;"</span>: <span class=
"org-string">"≉"</span>,
<span class="linenr"> 8968: </span>  <span class=
"org-string">"ntriangleleft;"</span>: <span class=
"org-string">"⋪"</span>,
<span class="linenr"> 8969: </span>  <span class=
"org-string">"Poincareplane;"</span>: <span class=
"org-string">"ℌ"</span>,
<span class="linenr"> 8970: </span>  <span class=
"org-string">"PrecedesEqual;"</span>: <span class=
"org-string">"⪯"</span>,
<span class="linenr"> 8971: </span>  <span class=
"org-string">"PrecedesTilde;"</span>: <span class=
"org-string">"≾"</span>,
<span class="linenr"> 8972: </span>  <span class=
"org-string">"RightArrowBar;"</span>: <span class=
"org-string">"⇥"</span>,
<span class="linenr"> 8973: </span>  <span class=
"org-string">"RightTeeArrow;"</span>: <span class=
"org-string">"↦"</span>,
<span class="linenr"> 8974: </span>  <span class=
"org-string">"RightTriangle;"</span>: <span class=
"org-string">"⊳"</span>,
<span class="linenr"> 8975: </span>  <span class=
"org-string">"RightUpVector;"</span>: <span class=
"org-string">"↾"</span>,
<span class="linenr"> 8976: </span>  <span class=
"org-string">"shortparallel;"</span>: <span class=
"org-string">"∥"</span>,
<span class="linenr"> 8977: </span>  <span class=
"org-string">"smallsetminus;"</span>: <span class=
"org-string">"∖"</span>,
<span class="linenr"> 8978: </span>  <span class=
"org-string">"SucceedsEqual;"</span>: <span class=
"org-string">"⪰"</span>,
<span class="linenr"> 8979: </span>  <span class=
"org-string">"SucceedsTilde;"</span>: <span class=
"org-string">"≿"</span>,
<span class="linenr"> 8980: </span>  <span class=
"org-string">"SupersetEqual;"</span>: <span class=
"org-string">"⊇"</span>,
<span class="linenr"> 8981: </span>  <span class=
"org-string">"triangleright;"</span>: <span class=
"org-string">"▹"</span>,
<span class="linenr"> 8982: </span>  <span class=
"org-string">"UpEquilibrium;"</span>: <span class=
"org-string">"⥮"</span>,
<span class="linenr"> 8983: </span>  <span class=
"org-string">"upharpoonleft;"</span>: <span class=
"org-string">"↿"</span>,
<span class="linenr"> 8984: </span>  <span class=
"org-string">"varsubsetneqq;"</span>: <span class=
"org-string">"⫋︀"</span>,
<span class="linenr"> 8985: </span>  <span class=
"org-string">"varsupsetneqq;"</span>: <span class=
"org-string">"⫌︀"</span>,
<span class="linenr"> 8986: </span>  <span class=
"org-string">"VerticalTilde;"</span>: <span class=
"org-string">"≀"</span>,
<span class="linenr"> 8987: </span>  <span class=
"org-string">"VeryThinSpace;"</span>: <span class=
"org-string">" "</span>,
<span class="linenr"> 8988: </span>  <span class=
"org-string">"curvearrowleft;"</span>: <span class=
"org-string">"↶"</span>,
<span class="linenr"> 8989: </span>  <span class=
"org-string">"DiacriticalDot;"</span>: <span class=
"org-string">"˙"</span>,
<span class="linenr"> 8990: </span>  <span class=
"org-string">"doublebarwedge;"</span>: <span class=
"org-string">"⌆"</span>,
<span class="linenr"> 8991: </span>  <span class=
"org-string">"DoubleRightTee;"</span>: <span class=
"org-string">"⊨"</span>,
<span class="linenr"> 8992: </span>  <span class=
"org-string">"downdownarrows;"</span>: <span class=
"org-string">"⇊"</span>,
<span class="linenr"> 8993: </span>  <span class=
"org-string">"DownLeftVector;"</span>: <span class=
"org-string">"↽"</span>,
<span class="linenr"> 8994: </span>  <span class=
"org-string">"GreaterGreater;"</span>: <span class=
"org-string">"⪢"</span>,
<span class="linenr"> 8995: </span>  <span class=
"org-string">"hookrightarrow;"</span>: <span class=
"org-string">"↪"</span>,
<span class="linenr"> 8996: </span>  <span class=
"org-string">"HorizontalLine;"</span>: <span class=
"org-string">"─"</span>,
<span class="linenr"> 8997: </span>  <span class=
"org-string">"InvisibleComma;"</span>: <span class=
"org-string">"⁣"</span>,
<span class="linenr"> 8998: </span>  <span class=
"org-string">"InvisibleTimes;"</span>: <span class=
"org-string">"⁢"</span>,
<span class="linenr"> 8999: </span>  <span class=
"org-string">"LeftDownVector;"</span>: <span class=
"org-string">"⇃"</span>,
<span class="linenr"> 9000: </span>  <span class=
"org-string">"leftleftarrows;"</span>: <span class=
"org-string">"⇇"</span>,
<span class="linenr"> 9001: </span>  <span class=
"org-string">"LeftRightArrow;"</span>: <span class=
"org-string">"↔"</span>,
<span class="linenr"> 9002: </span>  <span class=
"org-string">"Leftrightarrow;"</span>: <span class=
"org-string">"⇔"</span>,
<span class="linenr"> 9003: </span>  <span class=
"org-string">"leftrightarrow;"</span>: <span class=
"org-string">"↔"</span>,
<span class="linenr"> 9004: </span>  <span class=
"org-string">"leftthreetimes;"</span>: <span class=
"org-string">"⋋"</span>,
<span class="linenr"> 9005: </span>  <span class=
"org-string">"LessSlantEqual;"</span>: <span class=
"org-string">"⩽"</span>,
<span class="linenr"> 9006: </span>  <span class=
"org-string">"LongRightArrow;"</span>: <span class=
"org-string">"⟶"</span>,
<span class="linenr"> 9007: </span>  <span class=
"org-string">"Longrightarrow;"</span>: <span class=
"org-string">"⟹"</span>,
<span class="linenr"> 9008: </span>  <span class=
"org-string">"longrightarrow;"</span>: <span class=
"org-string">"⟶"</span>,
<span class="linenr"> 9009: </span>  <span class=
"org-string">"looparrowright;"</span>: <span class=
"org-string">"↬"</span>,
<span class="linenr"> 9010: </span>  <span class=
"org-string">"LowerLeftArrow;"</span>: <span class=
"org-string">"↙"</span>,
<span class="linenr"> 9011: </span>  <span class=
"org-string">"NestedLessLess;"</span>: <span class=
"org-string">"≪"</span>,
<span class="linenr"> 9012: </span>  <span class=
"org-string">"NotGreaterLess;"</span>: <span class=
"org-string">"≹"</span>,
<span class="linenr"> 9013: </span>  <span class=
"org-string">"NotLessGreater;"</span>: <span class=
"org-string">"≸"</span>,
<span class="linenr"> 9014: </span>  <span class=
"org-string">"NotSubsetEqual;"</span>: <span class=
"org-string">"⊈"</span>,
<span class="linenr"> 9015: </span>  <span class=
"org-string">"NotVerticalBar;"</span>: <span class=
"org-string">"∤"</span>,
<span class="linenr"> 9016: </span>  <span class=
"org-string">"nshortparallel;"</span>: <span class=
"org-string">"∦"</span>,
<span class="linenr"> 9017: </span>  <span class=
"org-string">"ntriangleright;"</span>: <span class=
"org-string">"⋫"</span>,
<span class="linenr"> 9018: </span>  <span class=
"org-string">"OpenCurlyQuote;"</span>: <span class=
"org-string">"‘"</span>,
<span class="linenr"> 9019: </span>  <span class=
"org-string">"ReverseElement;"</span>: <span class=
"org-string">"∋"</span>,
<span class="linenr"> 9020: </span>  <span class=
"org-string">"rightarrowtail;"</span>: <span class=
"org-string">"↣"</span>,
<span class="linenr"> 9021: </span>  <span class=
"org-string">"rightharpoonup;"</span>: <span class=
"org-string">"⇀"</span>,
<span class="linenr"> 9022: </span>  <span class=
"org-string">"RightTeeVector;"</span>: <span class=
"org-string">"⥛"</span>,
<span class="linenr"> 9023: </span>  <span class=
"org-string">"RightVectorBar;"</span>: <span class=
"org-string">"⥓"</span>,
<span class="linenr"> 9024: </span>  <span class=
"org-string">"ShortDownArrow;"</span>: <span class=
"org-string">"↓"</span>,
<span class="linenr"> 9025: </span>  <span class=
"org-string">"ShortLeftArrow;"</span>: <span class=
"org-string">"←"</span>,
<span class="linenr"> 9026: </span>  <span class=
"org-string">"SquareSuperset;"</span>: <span class=
"org-string">"⊐"</span>,
<span class="linenr"> 9027: </span>  <span class=
"org-string">"TildeFullEqual;"</span>: <span class=
"org-string">"≅"</span>,
<span class="linenr"> 9028: </span>  <span class=
"org-string">"trianglelefteq;"</span>: <span class=
"org-string">"⊴"</span>,
<span class="linenr"> 9029: </span>  <span class=
"org-string">"upharpoonright;"</span>: <span class=
"org-string">"↾"</span>,
<span class="linenr"> 9030: </span>  <span class=
"org-string">"UpperLeftArrow;"</span>: <span class=
"org-string">"↖"</span>,
<span class="linenr"> 9031: </span>  <span class=
"org-string">"ZeroWidthSpace;"</span>: <span class=
"org-string">"​"</span>,
<span class="linenr"> 9032: </span>  <span class=
"org-string">"bigtriangledown;"</span>: <span class=
"org-string">"▽"</span>,
<span class="linenr"> 9033: </span>  <span class=
"org-string">"circlearrowleft;"</span>: <span class=
"org-string">"↺"</span>,
<span class="linenr"> 9034: </span>  <span class=
"org-string">"CloseCurlyQuote;"</span>: <span class=
"org-string">"’"</span>,
<span class="linenr"> 9035: </span>  <span class=
"org-string">"ContourIntegral;"</span>: <span class=
"org-string">"∮"</span>,
<span class="linenr"> 9036: </span>  <span class=
"org-string">"curvearrowright;"</span>: <span class=
"org-string">"↷"</span>,
<span class="linenr"> 9037: </span>  <span class=
"org-string">"DoubleDownArrow;"</span>: <span class=
"org-string">"⇓"</span>,
<span class="linenr"> 9038: </span>  <span class=
"org-string">"DoubleLeftArrow;"</span>: <span class=
"org-string">"⇐"</span>,
<span class="linenr"> 9039: </span>  <span class=
"org-string">"downharpoonleft;"</span>: <span class=
"org-string">"⇃"</span>,
<span class="linenr"> 9040: </span>  <span class=
"org-string">"DownRightVector;"</span>: <span class=
"org-string">"⇁"</span>,
<span class="linenr"> 9041: </span>  <span class=
"org-string">"leftharpoondown;"</span>: <span class=
"org-string">"↽"</span>,
<span class="linenr"> 9042: </span>  <span class=
"org-string">"leftrightarrows;"</span>: <span class=
"org-string">"⇆"</span>,
<span class="linenr"> 9043: </span>  <span class=
"org-string">"LeftRightVector;"</span>: <span class=
"org-string">"⥎"</span>,
<span class="linenr"> 9044: </span>  <span class=
"org-string">"LeftTriangleBar;"</span>: <span class=
"org-string">"⧏"</span>,
<span class="linenr"> 9045: </span>  <span class=
"org-string">"LeftUpTeeVector;"</span>: <span class=
"org-string">"⥠"</span>,
<span class="linenr"> 9046: </span>  <span class=
"org-string">"LeftUpVectorBar;"</span>: <span class=
"org-string">"⥘"</span>,
<span class="linenr"> 9047: </span>  <span class=
"org-string">"LowerRightArrow;"</span>: <span class=
"org-string">"↘"</span>,
<span class="linenr"> 9048: </span>  <span class=
"org-string">"nLeftrightarrow;"</span>: <span class=
"org-string">"⇎"</span>,
<span class="linenr"> 9049: </span>  <span class=
"org-string">"nleftrightarrow;"</span>: <span class=
"org-string">"↮"</span>,
<span class="linenr"> 9050: </span>  <span class=
"org-string">"NotGreaterEqual;"</span>: <span class=
"org-string">"≱"</span>,
<span class="linenr"> 9051: </span>  <span class=
"org-string">"NotGreaterTilde;"</span>: <span class=
"org-string">"≵"</span>,
<span class="linenr"> 9052: </span>  <span class=
"org-string">"NotHumpDownHump;"</span>: <span class=
"org-string">"≎̸"</span>,
<span class="linenr"> 9053: </span>  <span class=
"org-string">"NotLeftTriangle;"</span>: <span class=
"org-string">"⋪"</span>,
<span class="linenr"> 9054: </span>  <span class=
"org-string">"NotSquareSubset;"</span>: <span class=
"org-string">"⊏̸"</span>,
<span class="linenr"> 9055: </span>  <span class=
"org-string">"ntrianglelefteq;"</span>: <span class=
"org-string">"⋬"</span>,
<span class="linenr"> 9056: </span>  <span class=
"org-string">"OverParenthesis;"</span>: <span class=
"org-string">"⏜"</span>,
<span class="linenr"> 9057: </span>  <span class=
"org-string">"RightDownVector;"</span>: <span class=
"org-string">"⇂"</span>,
<span class="linenr"> 9058: </span>  <span class=
"org-string">"rightleftarrows;"</span>: <span class=
"org-string">"⇄"</span>,
<span class="linenr"> 9059: </span>  <span class=
"org-string">"rightsquigarrow;"</span>: <span class=
"org-string">"↝"</span>,
<span class="linenr"> 9060: </span>  <span class=
"org-string">"rightthreetimes;"</span>: <span class=
"org-string">"⋌"</span>,
<span class="linenr"> 9061: </span>  <span class=
"org-string">"ShortRightArrow;"</span>: <span class=
"org-string">"→"</span>,
<span class="linenr"> 9062: </span>  <span class=
"org-string">"straightepsilon;"</span>: <span class=
"org-string">"ϵ"</span>,
<span class="linenr"> 9063: </span>  <span class=
"org-string">"trianglerighteq;"</span>: <span class=
"org-string">"⊵"</span>,
<span class="linenr"> 9064: </span>  <span class=
"org-string">"UpperRightArrow;"</span>: <span class=
"org-string">"↗"</span>,
<span class="linenr"> 9065: </span>  <span class=
"org-string">"vartriangleleft;"</span>: <span class=
"org-string">"⊲"</span>,
<span class="linenr"> 9066: </span>  <span class=
"org-string">"circlearrowright;"</span>: <span class=
"org-string">"↻"</span>,
<span class="linenr"> 9067: </span>  <span class=
"org-string">"DiacriticalAcute;"</span>: <span class=
"org-string">"´"</span>,
<span class="linenr"> 9068: </span>  <span class=
"org-string">"DiacriticalGrave;"</span>: <span class=
"org-string">"`"</span>,
<span class="linenr"> 9069: </span>  <span class=
"org-string">"DiacriticalTilde;"</span>: <span class=
"org-string">"˜"</span>,
<span class="linenr"> 9070: </span>  <span class=
"org-string">"DoubleRightArrow;"</span>: <span class=
"org-string">"⇒"</span>,
<span class="linenr"> 9071: </span>  <span class=
"org-string">"DownArrowUpArrow;"</span>: <span class=
"org-string">"⇵"</span>,
<span class="linenr"> 9072: </span>  <span class=
"org-string">"downharpoonright;"</span>: <span class=
"org-string">"⇂"</span>,
<span class="linenr"> 9073: </span>  <span class=
"org-string">"EmptySmallSquare;"</span>: <span class=
"org-string">"◻"</span>,
<span class="linenr"> 9074: </span>  <span class=
"org-string">"GreaterEqualLess;"</span>: <span class=
"org-string">"⋛"</span>,
<span class="linenr"> 9075: </span>  <span class=
"org-string">"GreaterFullEqual;"</span>: <span class=
"org-string">"≧"</span>,
<span class="linenr"> 9076: </span>  <span class=
"org-string">"LeftAngleBracket;"</span>: <span class=
"org-string">"⟨"</span>,
<span class="linenr"> 9077: </span>  <span class=
"org-string">"LeftUpDownVector;"</span>: <span class=
"org-string">"⥑"</span>,
<span class="linenr"> 9078: </span>  <span class=
"org-string">"LessEqualGreater;"</span>: <span class=
"org-string">"⋚"</span>,
<span class="linenr"> 9079: </span>  <span class=
"org-string">"NonBreakingSpace;"</span>: <span class=
"org-string">" "</span>,
<span class="linenr"> 9080: </span>  <span class=
"org-string">"NotPrecedesEqual;"</span>: <span class=
"org-string">"⪯̸"</span>,
<span class="linenr"> 9081: </span>  <span class=
"org-string">"NotRightTriangle;"</span>: <span class=
"org-string">"⋫"</span>,
<span class="linenr"> 9082: </span>  <span class=
"org-string">"NotSucceedsEqual;"</span>: <span class=
"org-string">"⪰̸"</span>,
<span class="linenr"> 9083: </span>  <span class=
"org-string">"NotSucceedsTilde;"</span>: <span class=
"org-string">"≿̸"</span>,
<span class="linenr"> 9084: </span>  <span class=
"org-string">"NotSupersetEqual;"</span>: <span class=
"org-string">"⊉"</span>,
<span class="linenr"> 9085: </span>  <span class=
"org-string">"ntrianglerighteq;"</span>: <span class=
"org-string">"⋭"</span>,
<span class="linenr"> 9086: </span>  <span class=
"org-string">"rightharpoondown;"</span>: <span class=
"org-string">"⇁"</span>,
<span class="linenr"> 9087: </span>  <span class=
"org-string">"rightrightarrows;"</span>: <span class=
"org-string">"⇉"</span>,
<span class="linenr"> 9088: </span>  <span class=
"org-string">"RightTriangleBar;"</span>: <span class=
"org-string">"⧐"</span>,
<span class="linenr"> 9089: </span>  <span class=
"org-string">"RightUpTeeVector;"</span>: <span class=
"org-string">"⥜"</span>,
<span class="linenr"> 9090: </span>  <span class=
"org-string">"RightUpVectorBar;"</span>: <span class=
"org-string">"⥔"</span>,
<span class="linenr"> 9091: </span>  <span class=
"org-string">"twoheadleftarrow;"</span>: <span class=
"org-string">"↞"</span>,
<span class="linenr"> 9092: </span>  <span class=
"org-string">"UnderParenthesis;"</span>: <span class=
"org-string">"⏝"</span>,
<span class="linenr"> 9093: </span>  <span class=
"org-string">"UpArrowDownArrow;"</span>: <span class=
"org-string">"⇅"</span>,
<span class="linenr"> 9094: </span>  <span class=
"org-string">"vartriangleright;"</span>: <span class=
"org-string">"⊳"</span>,
<span class="linenr"> 9095: </span>  <span class=
"org-string">"blacktriangledown;"</span>: <span class=
"org-string">"▾"</span>,
<span class="linenr"> 9096: </span>  <span class=
"org-string">"blacktriangleleft;"</span>: <span class=
"org-string">"◂"</span>,
<span class="linenr"> 9097: </span>  <span class=
"org-string">"DoubleUpDownArrow;"</span>: <span class=
"org-string">"⇕"</span>,
<span class="linenr"> 9098: </span>  <span class=
"org-string">"DoubleVerticalBar;"</span>: <span class=
"org-string">"∥"</span>,
<span class="linenr"> 9099: </span>  <span class=
"org-string">"DownLeftTeeVector;"</span>: <span class=
"org-string">"⥞"</span>,
<span class="linenr"> 9100: </span>  <span class=
"org-string">"DownLeftVectorBar;"</span>: <span class=
"org-string">"⥖"</span>,
<span class="linenr"> 9101: </span>  <span class=
"org-string">"FilledSmallSquare;"</span>: <span class=
"org-string">"◼"</span>,
<span class="linenr"> 9102: </span>  <span class=
"org-string">"GreaterSlantEqual;"</span>: <span class=
"org-string">"⩾"</span>,
<span class="linenr"> 9103: </span>  <span class=
"org-string">"LeftDoubleBracket;"</span>: <span class=
"org-string">"⟦"</span>,
<span class="linenr"> 9104: </span>  <span class=
"org-string">"LeftDownTeeVector;"</span>: <span class=
"org-string">"⥡"</span>,
<span class="linenr"> 9105: </span>  <span class=
"org-string">"LeftDownVectorBar;"</span>: <span class=
"org-string">"⥙"</span>,
<span class="linenr"> 9106: </span>  <span class=
"org-string">"leftrightharpoons;"</span>: <span class=
"org-string">"⇋"</span>,
<span class="linenr"> 9107: </span>  <span class=
"org-string">"LeftTriangleEqual;"</span>: <span class=
"org-string">"⊴"</span>,
<span class="linenr"> 9108: </span>  <span class=
"org-string">"NegativeThinSpace;"</span>: <span class=
"org-string">"​"</span>,
<span class="linenr"> 9109: </span>  <span class=
"org-string">"NotGreaterGreater;"</span>: <span class=
"org-string">"≫̸"</span>,
<span class="linenr"> 9110: </span>  <span class=
"org-string">"NotLessSlantEqual;"</span>: <span class=
"org-string">"⩽̸"</span>,
<span class="linenr"> 9111: </span>  <span class=
"org-string">"NotNestedLessLess;"</span>: <span class=
"org-string">"⪡̸"</span>,
<span class="linenr"> 9112: </span>  <span class=
"org-string">"NotReverseElement;"</span>: <span class=
"org-string">"∌"</span>,
<span class="linenr"> 9113: </span>  <span class=
"org-string">"NotSquareSuperset;"</span>: <span class=
"org-string">"⊐̸"</span>,
<span class="linenr"> 9114: </span>  <span class=
"org-string">"NotTildeFullEqual;"</span>: <span class=
"org-string">"≇"</span>,
<span class="linenr"> 9115: </span>  <span class=
"org-string">"RightAngleBracket;"</span>: <span class=
"org-string">"⟩"</span>,
<span class="linenr"> 9116: </span>  <span class=
"org-string">"rightleftharpoons;"</span>: <span class=
"org-string">"⇌"</span>,
<span class="linenr"> 9117: </span>  <span class=
"org-string">"RightUpDownVector;"</span>: <span class=
"org-string">"⥏"</span>,
<span class="linenr"> 9118: </span>  <span class=
"org-string">"SquareSubsetEqual;"</span>: <span class=
"org-string">"⊑"</span>,
<span class="linenr"> 9119: </span>  <span class=
"org-string">"twoheadrightarrow;"</span>: <span class=
"org-string">"↠"</span>,
<span class="linenr"> 9120: </span>  <span class=
"org-string">"VerticalSeparator;"</span>: <span class=
"org-string">"❘"</span>,
<span class="linenr"> 9121: </span>  <span class=
"org-string">"blacktriangleright;"</span>: <span class=
"org-string">"▸"</span>,
<span class="linenr"> 9122: </span>  <span class=
"org-string">"DownRightTeeVector;"</span>: <span class=
"org-string">"⥟"</span>,
<span class="linenr"> 9123: </span>  <span class=
"org-string">"DownRightVectorBar;"</span>: <span class=
"org-string">"⥗"</span>,
<span class="linenr"> 9124: </span>  <span class=
"org-string">"LongLeftRightArrow;"</span>: <span class=
"org-string">"⟷"</span>,
<span class="linenr"> 9125: </span>  <span class=
"org-string">"Longleftrightarrow;"</span>: <span class=
"org-string">"⟺"</span>,
<span class="linenr"> 9126: </span>  <span class=
"org-string">"longleftrightarrow;"</span>: <span class=
"org-string">"⟷"</span>,
<span class="linenr"> 9127: </span>  <span class=
"org-string">"NegativeThickSpace;"</span>: <span class=
"org-string">"​"</span>,
<span class="linenr"> 9128: </span>  <span class=
"org-string">"NotLeftTriangleBar;"</span>: <span class=
"org-string">"⧏̸"</span>,
<span class="linenr"> 9129: </span>  <span class=
"org-string">"PrecedesSlantEqual;"</span>: <span class=
"org-string">"≼"</span>,
<span class="linenr"> 9130: </span>  <span class=
"org-string">"ReverseEquilibrium;"</span>: <span class=
"org-string">"⇋"</span>,
<span class="linenr"> 9131: </span>  <span class=
"org-string">"RightDoubleBracket;"</span>: <span class=
"org-string">"⟧"</span>,
<span class="linenr"> 9132: </span>  <span class=
"org-string">"RightDownTeeVector;"</span>: <span class=
"org-string">"⥝"</span>,
<span class="linenr"> 9133: </span>  <span class=
"org-string">"RightDownVectorBar;"</span>: <span class=
"org-string">"⥕"</span>,
<span class="linenr"> 9134: </span>  <span class=
"org-string">"RightTriangleEqual;"</span>: <span class=
"org-string">"⊵"</span>,
<span class="linenr"> 9135: </span>  <span class=
"org-string">"SquareIntersection;"</span>: <span class=
"org-string">"⊓"</span>,
<span class="linenr"> 9136: </span>  <span class=
"org-string">"SucceedsSlantEqual;"</span>: <span class=
"org-string">"≽"</span>,
<span class="linenr"> 9137: </span>  <span class=
"org-string">"DoubleLongLeftArrow;"</span>: <span class=
"org-string">"⟸"</span>,
<span class="linenr"> 9138: </span>  <span class=
"org-string">"DownLeftRightVector;"</span>: <span class=
"org-string">"⥐"</span>,
<span class="linenr"> 9139: </span>  <span class=
"org-string">"LeftArrowRightArrow;"</span>: <span class=
"org-string">"⇆"</span>,
<span class="linenr"> 9140: </span>  <span class=
"org-string">"leftrightsquigarrow;"</span>: <span class=
"org-string">"↭"</span>,
<span class="linenr"> 9141: </span>  <span class=
"org-string">"NegativeMediumSpace;"</span>: <span class=
"org-string">"​"</span>,
<span class="linenr"> 9142: </span>  <span class=
"org-string">"NotGreaterFullEqual;"</span>: <span class=
"org-string">"≧̸"</span>,
<span class="linenr"> 9143: </span>  <span class=
"org-string">"NotRightTriangleBar;"</span>: <span class=
"org-string">"⧐̸"</span>,
<span class="linenr"> 9144: </span>  <span class=
"org-string">"RightArrowLeftArrow;"</span>: <span class=
"org-string">"⇄"</span>,
<span class="linenr"> 9145: </span>  <span class=
"org-string">"SquareSupersetEqual;"</span>: <span class=
"org-string">"⊒"</span>,
<span class="linenr"> 9146: </span>  <span class=
"org-string">"CapitalDifferentialD;"</span>: <span class=
"org-string">"ⅅ"</span>,
<span class="linenr"> 9147: </span>  <span class=
"org-string">"DoubleLeftRightArrow;"</span>: <span class=
"org-string">"⇔"</span>,
<span class="linenr"> 9148: </span>  <span class=
"org-string">"DoubleLongRightArrow;"</span>: <span class=
"org-string">"⟹"</span>,
<span class="linenr"> 9149: </span>  <span class=
"org-string">"EmptyVerySmallSquare;"</span>: <span class=
"org-string">"▫"</span>,
<span class="linenr"> 9150: </span>  <span class=
"org-string">"NestedGreaterGreater;"</span>: <span class=
"org-string">"≫"</span>,
<span class="linenr"> 9151: </span>  <span class=
"org-string">"NotDoubleVerticalBar;"</span>: <span class=
"org-string">"∦"</span>,
<span class="linenr"> 9152: </span>  <span class=
"org-string">"NotGreaterSlantEqual;"</span>: <span class=
"org-string">"⩾̸"</span>,
<span class="linenr"> 9153: </span>  <span class=
"org-string">"NotLeftTriangleEqual;"</span>: <span class=
"org-string">"⋬"</span>,
<span class="linenr"> 9154: </span>  <span class=
"org-string">"NotSquareSubsetEqual;"</span>: <span class=
"org-string">"⋢"</span>,
<span class="linenr"> 9155: </span>  <span class=
"org-string">"OpenCurlyDoubleQuote;"</span>: <span class=
"org-string">"“"</span>,
<span class="linenr"> 9156: </span>  <span class=
"org-string">"ReverseUpEquilibrium;"</span>: <span class=
"org-string">"⥯"</span>,
<span class="linenr"> 9157: </span>  <span class=
"org-string">"CloseCurlyDoubleQuote;"</span>: <span class=
"org-string">"”"</span>,
<span class="linenr"> 9158: </span>  <span class=
"org-string">"DoubleContourIntegral;"</span>: <span class=
"org-string">"∯"</span>,
<span class="linenr"> 9159: </span>  <span class=
"org-string">"FilledVerySmallSquare;"</span>: <span class=
"org-string">"▪"</span>,
<span class="linenr"> 9160: </span>  <span class=
"org-string">"NegativeVeryThinSpace;"</span>: <span class=
"org-string">"​"</span>,
<span class="linenr"> 9161: </span>  <span class=
"org-string">"NotPrecedesSlantEqual;"</span>: <span class=
"org-string">"⋠"</span>,
<span class="linenr"> 9162: </span>  <span class=
"org-string">"NotRightTriangleEqual;"</span>: <span class=
"org-string">"⋭"</span>,
<span class="linenr"> 9163: </span>  <span class=
"org-string">"NotSucceedsSlantEqual;"</span>: <span class=
"org-string">"⋡"</span>,
<span class="linenr"> 9164: </span>  <span class=
"org-string">"DiacriticalDoubleAcute;"</span>: <span class=
"org-string">"˝"</span>,
<span class="linenr"> 9165: </span>  <span class=
"org-string">"NotSquareSupersetEqual;"</span>: <span class=
"org-string">"⋣"</span>,
<span class="linenr"> 9166: </span>  <span class=
"org-string">"NotNestedGreaterGreater;"</span>: <span class=
"org-string">"⪢̸"</span>,
<span class="linenr"> 9167: </span>  <span class=
"org-string">"ClockwiseContourIntegral;"</span>: <span class=
"org-string">"∲"</span>,
<span class="linenr"> 9168: </span>  <span class=
"org-string">"DoubleLongLeftRightArrow;"</span>: <span class=
"org-string">"⟺"</span>,
<span class="linenr"> 9169: </span>  <span class=
"org-string">"CounterClockwiseContourIntegral;"</span>: <span class="org-string">"∳"</span>
<span class="linenr"> 9170: </span>}
<span class="linenr"> 9171: </span>
<span class="linenr"> 9172: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">decodeHtml</span> = (rawText, asAttr) =&gt; {
<span class="linenr"> 9173: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">offset</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 9174: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">end</span> = rawText.length
<span class="linenr"> 9175: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">decodedText</span> = <span class=
"org-string">''</span>
<span class="linenr"> 9176: </span>
<span class="linenr"> 9177: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">advance</span>(<span class=
"org-variable-name">length</span>) {
<span class="linenr"> 9178: </span>    offset += length
<span class=
"linenr"> 9179: </span>    rawText = rawText.slice(length)
<span class="linenr"> 9180: </span>  }
<span class="linenr"> 9181: </span>
<span class="linenr"> 9182: </span>  <span class=
"org-keyword">while</span> (offset &lt; end) {
<span class="linenr"> 9183: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">head</span> = <span class=
"org-string">/&amp;(?:#x?)?/</span>i.exec(rawText)
<span class="linenr"> 9184: </span>    <span class=
"org-keyword">if</span> (!head || offset + head.index &gt;= end) {
<span class="linenr"> 9185: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">remaining</span> = end - offset
<span class=
"linenr"> 9186: </span>      decodedText += rawText.slice(<span class="org-highlight-numbers-number">0</span>, remaining)
<span class="linenr"> 9187: </span>      advance(remaining)
<span class="linenr"> 9188: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 9189: </span>    }
<span class="linenr"> 9190: </span>
<span class="linenr"> 9191: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Advance to the "&amp;".</span>
<span class=
"linenr"> 9192: </span>    decodedText += rawText.slice(<span class="org-highlight-numbers-number">0</span>, head.index)
<span class="linenr"> 9193: </span>    advance(head.index)
<span class="linenr"> 9194: </span>
<span class="linenr"> 9195: </span>    <span class=
"org-keyword">if</span> (head[<span class=
"org-highlight-numbers-number">0</span>] === <span class=
"org-string">'&amp;'</span>) {
<span class="linenr"> 9196: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Named character reference.</span>
<span class="linenr"> 9197: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">name</span> = <span class=
"org-string">''</span>
<span class="linenr"> 9198: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">value</span> = <span class=
"org-constant">undefined</span>
<span class="linenr"> 9199: </span>      <span class=
"org-keyword">if</span> (<span class=
"org-string">/[0-9a-z]/</span>i.test(rawText[<span class=
"org-highlight-numbers-number">1</span>])) {
<span class="linenr"> 9200: </span>        <span class=
"org-keyword">if</span> (!maxCRNameLength) {
<span class=
"linenr"> 9201: </span>          maxCRNameLength = Object.keys(namedCharacterReferences).reduce(
<span class=
"linenr"> 9202: </span>            (max, name) =&gt; Math.max(max, name.length),
<span class="linenr"> 9203: </span>            <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 9204: </span>          )
<span class="linenr"> 9205: </span>        }
<span class="linenr"> 9206: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">length</span> = maxCRNameLength; !value &amp;& length &gt; <span class="org-highlight-numbers-number">0</span>; --length) {
<span class=
"linenr"> 9207: </span>          name = rawText.slice(<span class=
"org-highlight-numbers-number">1</span>, <span class=
"org-highlight-numbers-number">1</span> + length)
<span class=
"linenr"> 9208: </span>          value = namedCharacterReferences[name]
<span class="linenr"> 9209: </span>        }
<span class="linenr"> 9210: </span>        <span class=
"org-keyword">if</span> (value) {
<span class="linenr"> 9211: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">semi</span> = name.endsWith(<span class=
"org-string">';'</span>)
<span class="linenr"> 9212: </span>          <span class=
"org-keyword">if</span> (
<span class="linenr"> 9213: </span>            asAttr &amp;&
<span class="linenr"> 9214: </span>            !semi &amp;&
<span class="linenr"> 9215: </span>            /[=a-z0-<span class=
"org-highlight-numbers-number">9</span>]/i.test(rawText[name.length + <span class="org-highlight-numbers-number">1</span>] || <span class="org-string">''</span>)
<span class="linenr"> 9216: </span>          ) {
<span class=
"linenr"> 9217: </span>            decodedText += <span class=
"org-string">'&amp;'</span> + name
<span class="linenr"> 9218: </span>            advance(<span class=
"org-highlight-numbers-number">1</span> + name.length)
<span class="linenr"> 9219: </span>          } <span class=
"org-keyword">else</span> {
<span class="linenr"> 9220: </span>            decodedText += value
<span class="linenr"> 9221: </span>            advance(<span class=
"org-highlight-numbers-number">1</span> + name.length)
<span class="linenr"> 9222: </span>          }
<span class="linenr"> 9223: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 9224: </span>          decodedText += <span class=
"org-string">'&amp;'</span> + name
<span class="linenr"> 9225: </span>          advance(<span class=
"org-highlight-numbers-number">1</span> + name.length)
<span class="linenr"> 9226: </span>        }
<span class="linenr"> 9227: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 9228: </span>        decodedText += <span class=
"org-string">'&amp;'</span>
<span class="linenr"> 9229: </span>        advance(<span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr"> 9230: </span>      }
<span class="linenr"> 9231: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 9232: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Numeric character reference.</span>
<span class="linenr"> 9233: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hex</span> = head[<span class=
"org-highlight-numbers-number">0</span>] === <span class=
"org-string">'&amp;#x'</span>
<span class="linenr"> 9234: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">pattern</span> = hex ? /^&amp;#x([<span class=
"org-highlight-numbers-number">0</span>-9a-f]+);?/i : <span class=
"org-string">/^&amp;#([0-9]+);?/</span>
<span class="linenr"> 9235: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">body</span> = pattern.exec(rawText)
<span class="linenr"> 9236: </span>      <span class=
"org-keyword">if</span> (!body) {
<span class=
"linenr"> 9237: </span>        decodedText += head[<span class=
"org-highlight-numbers-number">0</span>]
<span class=
"linenr"> 9238: </span>        advance(head[<span class="org-highlight-numbers-number">0</span>].length)
<span class="linenr"> 9239: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 9240: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">https://html.spec.whatwg.org/multipage/parsing.html#numeric-character-reference-end-state</span>
<span class="linenr"> 9241: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">cp</span> = Number.parseInt(body[<span class=
"org-highlight-numbers-number">1</span>], hex ? <span class=
"org-highlight-numbers-number">16</span> : <span class=
"org-highlight-numbers-number">10</span>)
<span class="linenr"> 9242: </span>        <span class=
"org-keyword">if</span> (cp === <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 9243: </span>          cp = 0xfffd
<span class="linenr"> 9244: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (cp &gt; 0x10ffff) {
<span class="linenr"> 9245: </span>          cp = 0xfffd
<span class="linenr"> 9246: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (cp &gt;= 0xd800 &amp;& cp &lt;= 0xdfff) {
<span class="linenr"> 9247: </span>          cp = 0xfffd
<span class="linenr"> 9248: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> ((cp &gt;= 0xfdd0 &amp;& cp &lt;= 0xfdef) || (cp & 0xfffe) === 0xfffe) {
<span class="linenr"> 9249: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">noop</span>
<span class="linenr"> 9250: </span>        } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr"> 9251: </span>          (cp &gt;= 0x01 &amp;& cp &lt;= 0x08) ||
<span class="linenr"> 9252: </span>          cp === 0x0b ||
<span class=
"linenr"> 9253: </span>          (cp &gt;= 0x0d &amp;& cp &lt;= 0x1f) ||
<span class=
"linenr"> 9254: </span>          (cp &gt;= 0x7f &amp;& cp &lt;= 0x9f)
<span class="linenr"> 9255: </span>        ) {
<span class=
"linenr"> 9256: </span>          cp = CCR_REPLACEMENTS[cp] || cp
<span class="linenr"> 9257: </span>        }
<span class=
"linenr"> 9258: </span>        decodedText += String.fromCodePoint(cp)
<span class=
"linenr"> 9259: </span>        advance(body[<span class="org-highlight-numbers-number">0</span>].length)
<span class="linenr"> 9260: </span>      }
<span class="linenr"> 9261: </span>    }
<span class="linenr"> 9262: </span>  }
<span class="linenr"> 9263: </span>  <span class=
"org-keyword">return</span> decodedText
<span class="linenr"> 9264: </span>}
<span class="linenr"> 9265: </span>
<span class="linenr"> 9266: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">https://html.spec.whatwg.org/multipage/parsing.html#numeric-character-reference-end-state</span>
<span class="linenr"> 9267: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CCR_REPLACEMENTS</span> = {
<span class="linenr"> 9268: </span>  0x80: 0x20ac,
<span class="linenr"> 9269: </span>  0x82: 0x201a,
<span class="linenr"> 9270: </span>  0x83: 0x0192,
<span class="linenr"> 9271: </span>  0x84: 0x201e,
<span class="linenr"> 9272: </span>  0x85: 0x2026,
<span class="linenr"> 9273: </span>  0x86: 0x2020,
<span class="linenr"> 9274: </span>  0x87: 0x2021,
<span class="linenr"> 9275: </span>  0x88: 0x02c6,
<span class="linenr"> 9276: </span>  0x89: 0x2030,
<span class="linenr"> 9277: </span>  0x8a: 0x0160,
<span class="linenr"> 9278: </span>  0x8b: 0x2039,
<span class="linenr"> 9279: </span>  0x8c: 0x0152,
<span class="linenr"> 9280: </span>  0x8e: 0x017d,
<span class="linenr"> 9281: </span>  0x91: 0x2018,
<span class="linenr"> 9282: </span>  0x92: 0x2019,
<span class="linenr"> 9283: </span>  0x93: 0x201c,
<span class="linenr"> 9284: </span>  0x94: 0x201d,
<span class="linenr"> 9285: </span>  0x95: 0x2022,
<span class="linenr"> 9286: </span>  0x96: 0x2013,
<span class="linenr"> 9287: </span>  0x97: 0x2014,
<span class="linenr"> 9288: </span>  0x98: 0x02dc,
<span class="linenr"> 9289: </span>  0x99: 0x2122,
<span class="linenr"> 9290: </span>  0x9a: 0x0161,
<span class="linenr"> 9291: </span>  0x9b: 0x203a,
<span class="linenr"> 9292: </span>  0x9c: 0x0153,
<span class="linenr"> 9293: </span>  0x9e: 0x017e,
<span class="linenr"> 9294: </span>  0x9f: 0x0178
<span class="linenr"> 9295: </span>}
<span class="linenr"> 9296: </span>
<span class="linenr"> 9297: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">decoder</span>
<span class="linenr"> 9298: </span>
<span class="linenr"> 9299: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">decodeHtmlBrowser</span>(<span class=
"org-variable-name">raw</span>, <span class=
"org-variable-name">asAttr</span> = <span class=
"org-constant">false</span>) {
<span class="linenr"> 9300: </span>  <span class=
"org-keyword">if</span> (!decoder) {
<span class=
"linenr"> 9301: </span>    decoder = document.createElement(<span class="org-string">'div'</span>)
<span class="linenr"> 9302: </span>  }
<span class="linenr"> 9303: </span>  <span class=
"org-keyword">if</span> (asAttr) {
<span class=
"linenr"> 9304: </span>    decoder.innerHTML = <span class=
"org-string">`&lt;div foo="${raw.replace(/"/g, '&amp;quot;')}"&gt;`</span>
<span class="linenr"> 9305: </span>    <span class=
"org-keyword">return</span> decoder.children[<span class=
"org-highlight-numbers-number">0</span>].getAttribute(<span class=
"org-string">'foo'</span>)
<span class="linenr"> 9306: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 9307: </span>    decoder.innerHTML = raw
<span class="linenr"> 9308: </span>    <span class=
"org-keyword">return</span> decoder.textContent
<span class="linenr"> 9309: </span>  }
<span class="linenr"> 9310: </span>}
<span class="linenr"> 9311: </span>
<span class="linenr"> 9312: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_MODEL_RADIO</span> = Symbol(__DEV__ ? <span class="org-string">`vModelRadio`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9313: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_MODEL_CHECKBOX</span> = Symbol(__DEV__ ? <span class="org-string">`vModelCheckbox`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9314: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_MODEL_TEXT</span> = Symbol(__DEV__ ? <span class="org-string">`vModelText`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9315: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_MODEL_SELECT</span> = Symbol(__DEV__ ? <span class="org-string">`vModelSelect`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9316: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_MODEL_DYNAMIC</span> = Symbol(__DEV__ ? <span class="org-string">`vModelDynamic`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9317: </span>
<span class="linenr"> 9318: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_ON_WITH_MODIFIERS</span> = Symbol(__DEV__ ? <span class="org-string">`vOnModifiersGuard`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9319: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_ON_WITH_KEYS</span> = Symbol(__DEV__ ? <span class="org-string">`vOnKeysGuard`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9320: </span>
<span class="linenr"> 9321: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_SHOW</span> = Symbol(__DEV__ ? <span class=
"org-string">`vShow`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9322: </span>
<span class="linenr"> 9323: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TRANSITION</span> = Symbol(__DEV__ ? <span class="org-string">`Transition`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9324: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TRANSITION_GROUP</span> = Symbol(__DEV__ ? <span class="org-string">`TransitionGroup`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9325: </span>
<span class="linenr"> 9326: </span>registerRuntimeHelpers({
<span class="linenr"> 9327: </span>  [V_MODEL_RADIO]: <span class=
"org-string">`vModelRadio`</span>,
<span class=
"linenr"> 9328: </span>  [V_MODEL_CHECKBOX]: <span class=
"org-string">`vModelCheckbox`</span>,
<span class="linenr"> 9329: </span>  [V_MODEL_TEXT]: <span class=
"org-string">`vModelText`</span>,
<span class="linenr"> 9330: </span>  [V_MODEL_SELECT]: <span class=
"org-string">`vModelSelect`</span>,
<span class=
"linenr"> 9331: </span>  [V_MODEL_DYNAMIC]: <span class="org-string">`vModelDynamic`</span>,
<span class=
"linenr"> 9332: </span>  [V_ON_WITH_MODIFIERS]: <span class=
"org-string">`withModifiers`</span>,
<span class="linenr"> 9333: </span>  [V_ON_WITH_KEYS]: <span class=
"org-string">`withKeys`</span>,
<span class="linenr"> 9334: </span>  [V_SHOW]: <span class=
"org-string">`vShow`</span>,
<span class="linenr"> 9335: </span>  [TRANSITION]: <span class=
"org-string">`Transition`</span>,
<span class=
"linenr"> 9336: </span>  [TRANSITION_GROUP]: <span class=
"org-string">`TransitionGroup`</span>
<span class="linenr"> 9337: </span>})
<span class="linenr"> 9338: </span>
<span class="linenr"> 9339: </span><span class="org-doc">/**</span>
<span class="linenr"> 9340: </span><span class=
"org-doc"> * On the client we only need to offer special cases for boolean attributes that</span>
<span class="linenr"> 9341: </span><span class=
"org-doc"> * have different names from their corresponding dom properties:</span>
<span class="linenr"> 9342: </span><span class=
"org-doc"> * - itemscope -&gt; N/A</span>
<span class="linenr"> 9343: </span><span class=
"org-doc"> * - allowfullscreen -&gt; allowFullscreen</span>
<span class="linenr"> 9344: </span><span class=
"org-doc"> * - formnovalidate -&gt; formNoValidate</span>
<span class="linenr"> 9345: </span><span class=
"org-doc"> * - ismap -&gt; isMap</span>
<span class="linenr"> 9346: </span><span class=
"org-doc"> * - nomodule -&gt; noModule</span>
<span class="linenr"> 9347: </span><span class=
"org-doc"> * - novalidate -&gt; noValidate</span>
<span class="linenr"> 9348: </span><span class=
"org-doc"> * - readonly -&gt; readOnly</span>
<span class="linenr"> 9349: </span><span class="org-doc"> */</span>
<span class="linenr"> 9350: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">specialBooleanAttrs</span> = <span class=
"org-string">`itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly`</span>
<span class="linenr"> 9351: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSpecialBooleanAttr</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(specialBooleanAttrs)
<span class="linenr"> 9352: </span>
<span class="linenr"> 9353: </span><span class="org-doc">/**</span>
<span class="linenr"> 9354: </span><span class=
"org-doc"> * The full list is needed during SSR to produce the correct initial markup.</span>
<span class="linenr"> 9355: </span><span class="org-doc"> */</span>
<span class="linenr"> 9356: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isBooleanAttr</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr"> 9357: </span>  specialBooleanAttrs +
<span class="linenr"> 9358: </span>    <span class=
"org-string">`,async,autofocus,autoplay,controls,default,defer,disabled,hidden,`</span> +
<span class="linenr"> 9359: </span>    <span class=
"org-string">`loop,open,required,reversed,scoped,seamless,`</span> +
<span class="linenr"> 9360: </span>    <span class=
"org-string">`checked,muted,multiple,selected`</span>
<span class="linenr"> 9361: </span>)
<span class="linenr"> 9362: </span>
<span class="linenr"> 9363: </span><span class="org-doc">/**</span>
<span class="linenr"> 9364: </span><span class=
"org-doc"> * Boolean attributes should be included if the value is truthy or ''.</span>
<span class="linenr"> 9365: </span><span class=
"org-doc"> * e.g. `&lt;select multiple&gt;` compiles to `{ multiple: '' }`</span>
<span class="linenr"> 9366: </span><span class="org-doc"> */</span>
<span class="linenr"> 9367: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">includeBooleanAttr</span>(<span class=
"org-variable-name">value</span>) {
<span class="linenr"> 9368: </span>  <span class=
"org-keyword">return</span> !!value || value === <span class=
"org-string">''</span>
<span class="linenr"> 9369: </span>}
<span class="linenr"> 9370: </span>
<span class="linenr"> 9371: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">unsafeAttrCharRE</span> = <span class=
"org-string">/[&gt;/="'\u0009\u000a\u000c\u0020]/</span>
<span class="linenr"> 9372: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">attrValidationCache</span> = {}
<span class="linenr"> 9373: </span>
<span class="linenr"> 9374: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isSSRSafeAttrName</span>(<span class=
"org-variable-name">name</span>) {
<span class="linenr"> 9375: </span>  <span class=
"org-keyword">if</span> (attrValidationCache.hasOwnProperty(name)) {
<span class="linenr"> 9376: </span>    <span class=
"org-keyword">return</span> attrValidationCache[name]
<span class="linenr"> 9377: </span>  }
<span class="linenr"> 9378: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isUnsafe</span> = unsafeAttrCharRE.test(name)
<span class="linenr"> 9379: </span>  <span class=
"org-keyword">if</span> (isUnsafe) {
<span class="linenr"> 9380: </span>    console.error(<span class=
"org-string">`unsafe attribute name: ${name}`</span>)
<span class="linenr"> 9381: </span>  }
<span class="linenr"> 9382: </span>  <span class=
"org-keyword">return</span> (attrValidationCache[name] = !isUnsafe)
<span class="linenr"> 9383: </span>}
<span class="linenr"> 9384: </span>
<span class="linenr"> 9385: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">propsToAttrMap</span> = {
<span class="linenr"> 9386: </span>  acceptCharset: <span class=
"org-string">'accept-charset'</span>,
<span class="linenr"> 9387: </span>  className: <span class=
"org-string">'class'</span>,
<span class="linenr"> 9388: </span>  htmlFor: <span class=
"org-string">'for'</span>,
<span class="linenr"> 9389: </span>  httpEquiv: <span class=
"org-string">'http-equiv'</span>
<span class="linenr"> 9390: </span>}
<span class="linenr"> 9391: </span>
<span class="linenr"> 9392: </span><span class="org-doc">/**</span>
<span class="linenr"> 9393: </span><span class=
"org-doc"> * CSS properties that accept plain numbers</span>
<span class="linenr"> 9394: </span><span class="org-doc"> */</span>
<span class="linenr"> 9395: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isNoUnitNumericStyleProp</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr"> 9396: </span>  <span class=
"org-string">`animation-iteration-count,border-image-outset,border-image-slice,`</span> +
<span class="linenr"> 9397: </span>    <span class=
"org-string">`border-image-width,box-flex,box-flex-group,box-ordinal-group,column-count,`</span> +
<span class="linenr"> 9398: </span>    <span class=
"org-string">`columns,flex,flex-grow,flex-positive,flex-shrink,flex-negative,flex-order,`</span> +
<span class="linenr"> 9399: </span>    <span class=
"org-string">`grid-row,grid-row-end,grid-row-span,grid-row-start,grid-column,`</span> +
<span class="linenr"> 9400: </span>    <span class=
"org-string">`grid-column-end,grid-column-span,grid-column-start,font-weight,line-clamp,`</span> +
<span class="linenr"> 9401: </span>    <span class=
"org-string">`line-height,opacity,order,orphans,tab-size,widows,z-index,zoom,`</span> +
<span class="linenr"> 9402: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">SVG</span>
<span class="linenr"> 9403: </span>    <span class=
"org-string">`fill-opacity,flood-opacity,stop-opacity,stroke-dasharray,stroke-dashoffset,`</span> +
<span class="linenr"> 9404: </span>    <span class=
"org-string">`stroke-miterlimit,stroke-opacity,stroke-width`</span>
<span class="linenr"> 9405: </span>)
<span class="linenr"> 9406: </span>
<span class="linenr"> 9407: </span><span class="org-doc">/**</span>
<span class="linenr"> 9408: </span><span class=
"org-doc"> * Known attributes, this is used for stringification of runtime static nodes</span>
<span class="linenr"> 9409: </span><span class=
"org-doc"> * so that we don't stringify bindings that cannot be set from HTML.</span>
<span class="linenr"> 9410: </span><span class=
"org-doc"> * Don't also forget to allow `data-*` and `aria-*`!</span>
<span class="linenr"> 9411: </span><span class=
"org-doc"> * Generated from https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes</span>
<span class="linenr"> 9412: </span><span class="org-doc"> */</span>
<span class="linenr"> 9413: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isKnownHtmlAttr</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr"> 9414: </span>  <span class=
"org-string">`accept,accept-charset,accesskey,action,align,allow,alt,async,`</span> +
<span class="linenr"> 9415: </span>    <span class=
"org-string">`autocapitalize,autocomplete,autofocus,autoplay,background,bgcolor,`</span> +
<span class="linenr"> 9416: </span>    <span class=
"org-string">`border,buffered,capture,challenge,charset,checked,cite,class,code,`</span> +
<span class="linenr"> 9417: </span>    <span class=
"org-string">`codebase,color,cols,colspan,content,contenteditable,contextmenu,controls,`</span> +
<span class="linenr"> 9418: </span>    <span class=
"org-string">`coords,crossorigin,csp,data,datetime,decoding,default,defer,dir,dirname,`</span> +
<span class="linenr"> 9419: </span>    <span class=
"org-string">`disabled,download,draggable,dropzone,enctype,enterkeyhint,for,form,`</span> +
<span class="linenr"> 9420: </span>    <span class=
"org-string">`formaction,formenctype,formmethod,formnovalidate,formtarget,headers,`</span> +
<span class="linenr"> 9421: </span>    <span class=
"org-string">`height,hidden,high,href,hreflang,http-equiv,icon,id,importance,integrity,`</span> +
<span class="linenr"> 9422: </span>    <span class=
"org-string">`ismap,itemprop,keytype,kind,label,lang,language,loading,list,loop,low,`</span> +
<span class="linenr"> 9423: </span>    <span class=
"org-string">`manifest,max,maxlength,minlength,media,min,multiple,muted,name,novalidate,`</span> +
<span class="linenr"> 9424: </span>    <span class=
"org-string">`open,optimum,pattern,ping,placeholder,poster,preload,radiogroup,readonly,`</span> +
<span class="linenr"> 9425: </span>    <span class=
"org-string">`referrerpolicy,rel,required,reversed,rows,rowspan,sandbox,scope,scoped,`</span> +
<span class="linenr"> 9426: </span>    <span class=
"org-string">`selected,shape,size,sizes,slot,span,spellcheck,src,srcdoc,srclang,srcset,`</span> +
<span class="linenr"> 9427: </span>    <span class=
"org-string">`start,step,style,summary,tabindex,target,title,translate,type,usemap,`</span> +
<span class="linenr"> 9428: </span>    <span class=
"org-string">`value,width,wrap`</span>
<span class="linenr"> 9429: </span>)
<span class="linenr"> 9430: </span>
<span class="linenr"> 9431: </span><span class="org-doc">/**</span>
<span class="linenr"> 9432: </span><span class=
"org-doc"> * Generated from https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute</span>
<span class="linenr"> 9433: </span><span class="org-doc"> */</span>
<span class="linenr"> 9434: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isKnownSvgAttr</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr"> 9435: </span>  <span class=
"org-string">`xmlns,accent-height,accumulate,additive,alignment-baseline,alphabetic,amplitude,`</span> +
<span class="linenr"> 9436: </span>    <span class=
"org-string">`arabic-form,ascent,attributeName,attributeType,azimuth,baseFrequency,`</span> +
<span class="linenr"> 9437: </span>    <span class=
"org-string">`baseline-shift,baseProfile,bbox,begin,bias,by,calcMode,cap-height,class,`</span> +
<span class="linenr"> 9438: </span>    <span class=
"org-string">`clip,clipPathUnits,clip-path,clip-rule,color,color-interpolation,`</span> +
<span class="linenr"> 9439: </span>    <span class=
"org-string">`color-interpolation-filters,color-profile,color-rendering,`</span> +
<span class="linenr"> 9440: </span>    <span class=
"org-string">`contentScriptType,contentStyleType,crossorigin,cursor,cx,cy,d,decelerate,`</span> +
<span class="linenr"> 9441: </span>    <span class=
"org-string">`descent,diffuseConstant,direction,display,divisor,dominant-baseline,dur,dx,`</span> +
<span class="linenr"> 9442: </span>    <span class=
"org-string">`dy,edgeMode,elevation,enable-background,end,exponent,fill,fill-opacity,`</span> +
<span class="linenr"> 9443: </span>    <span class=
"org-string">`fill-rule,filter,filterRes,filterUnits,flood-color,flood-opacity,`</span> +
<span class="linenr"> 9444: </span>    <span class=
"org-string">`font-family,font-size,font-size-adjust,font-stretch,font-style,`</span> +
<span class="linenr"> 9445: </span>    <span class=
"org-string">`font-variant,font-weight,format,from,fr,fx,fy,g1,g2,glyph-name,`</span> +
<span class="linenr"> 9446: </span>    <span class=
"org-string">`glyph-orientation-horizontal,glyph-orientation-vertical,glyphRef,`</span> +
<span class="linenr"> 9447: </span>    <span class=
"org-string">`gradientTransform,gradientUnits,hanging,height,href,hreflang,horiz-adv-x,`</span> +
<span class="linenr"> 9448: </span>    <span class=
"org-string">`horiz-origin-x,id,ideographic,image-rendering,in,in2,intercept,k,k1,k2,k3,`</span> +
<span class="linenr"> 9449: </span>    <span class=
"org-string">`k4,kernelMatrix,kernelUnitLength,kerning,keyPoints,keySplines,keyTimes,`</span> +
<span class="linenr"> 9450: </span>    <span class=
"org-string">`lang,lengthAdjust,letter-spacing,lighting-color,limitingConeAngle,local,`</span> +
<span class="linenr"> 9451: </span>    <span class=
"org-string">`marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,`</span> +
<span class="linenr"> 9452: </span>    <span class=
"org-string">`mask,maskContentUnits,maskUnits,mathematical,max,media,method,min,mode,`</span> +
<span class="linenr"> 9453: </span>    <span class=
"org-string">`name,numOctaves,offset,opacity,operator,order,orient,orientation,origin,`</span> +
<span class="linenr"> 9454: </span>    <span class=
"org-string">`overflow,overline-position,overline-thickness,panose-1,paint-order,path,`</span> +
<span class="linenr"> 9455: </span>    <span class=
"org-string">`pathLength,patternContentUnits,patternTransform,patternUnits,ping,`</span> +
<span class="linenr"> 9456: </span>    <span class=
"org-string">`pointer-events,points,pointsAtX,pointsAtY,pointsAtZ,preserveAlpha,`</span> +
<span class="linenr"> 9457: </span>    <span class=
"org-string">`preserveAspectRatio,primitiveUnits,r,radius,referrerPolicy,refX,refY,rel,`</span> +
<span class="linenr"> 9458: </span>    <span class=
"org-string">`rendering-intent,repeatCount,repeatDur,requiredExtensions,requiredFeatures,`</span> +
<span class="linenr"> 9459: </span>    <span class=
"org-string">`restart,result,rotate,rx,ry,scale,seed,shape-rendering,slope,spacing,`</span> +
<span class="linenr"> 9460: </span>    <span class=
"org-string">`specularConstant,specularExponent,speed,spreadMethod,startOffset,`</span> +
<span class="linenr"> 9461: </span>    <span class=
"org-string">`stdDeviation,stemh,stemv,stitchTiles,stop-color,stop-opacity,`</span> +
<span class="linenr"> 9462: </span>    <span class=
"org-string">`strikethrough-position,strikethrough-thickness,string,stroke,`</span> +
<span class="linenr"> 9463: </span>    <span class=
"org-string">`stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,`</span> +
<span class="linenr"> 9464: </span>    <span class=
"org-string">`stroke-miterlimit,stroke-opacity,stroke-width,style,surfaceScale,`</span> +
<span class="linenr"> 9465: </span>    <span class=
"org-string">`systemLanguage,tabindex,tableValues,target,targetX,targetY,text-anchor,`</span> +
<span class="linenr"> 9466: </span>    <span class=
"org-string">`text-decoration,text-rendering,textLength,to,transform,transform-origin,`</span> +
<span class="linenr"> 9467: </span>    <span class=
"org-string">`type,u1,u2,underline-position,underline-thickness,unicode,unicode-bidi,`</span> +
<span class="linenr"> 9468: </span>    <span class=
"org-string">`unicode-range,units-per-em,v-alphabetic,v-hanging,v-ideographic,`</span> +
<span class="linenr"> 9469: </span>    <span class=
"org-string">`v-mathematical,values,vector-effect,version,vert-adv-y,vert-origin-x,`</span> +
<span class="linenr"> 9470: </span>    <span class=
"org-string">`vert-origin-y,viewBox,viewTarget,visibility,width,widths,word-spacing,`</span> +
<span class="linenr"> 9471: </span>    <span class=
"org-string">`writing-mode,x,x-height,x1,x2,xChannelSelector,xlink:actuate,xlink:arcrole,`</span> +
<span class="linenr"> 9472: </span>    <span class=
"org-string">`xlink:href,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,`</span> +
<span class="linenr"> 9473: </span>    <span class=
"org-string">`xml:space,y,y1,y2,yChannelSelector,z,zoomAndPan`</span>
<span class="linenr"> 9474: </span>)
<span class="linenr"> 9475: </span>
<span class="linenr"> 9476: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">https://developer.mozilla.org/en-US/docs/Web/HTML/Element</span>
<span class="linenr"> 9477: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">HTML_TAGS</span> =
<span class="linenr"> 9478: </span>  <span class=
"org-string">'html,body,base,head,link,meta,style,title,address,article,aside,footer,'</span> +
<span class="linenr"> 9479: </span>  <span class=
"org-string">'header,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,'</span> +
<span class="linenr"> 9480: </span>  <span class=
"org-string">'figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,'</span> +
<span class="linenr"> 9481: </span>  <span class=
"org-string">'data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,'</span> +
<span class="linenr"> 9482: </span>  <span class=
"org-string">'time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,'</span> +
<span class="linenr"> 9483: </span>  <span class=
"org-string">'canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,'</span> +
<span class="linenr"> 9484: </span>  <span class=
"org-string">'th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,'</span> +
<span class="linenr"> 9485: </span>  <span class=
"org-string">'option,output,progress,select,textarea,details,dialog,menu,'</span> +
<span class="linenr"> 9486: </span>  <span class=
"org-string">'summary,template,blockquote,iframe,tfoot'</span>
<span class="linenr"> 9487: </span>
<span class="linenr"> 9488: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">https://developer.mozilla.org/en-US/docs/Web/SVG/Element</span>
<span class="linenr"> 9489: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">SVG_TAGS</span> =
<span class="linenr"> 9490: </span>  <span class=
"org-string">'svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,'</span> +
<span class="linenr"> 9491: </span>  <span class=
"org-string">'defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,'</span> +
<span class="linenr"> 9492: </span>  <span class=
"org-string">'feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,'</span> +
<span class="linenr"> 9493: </span>  <span class=
"org-string">'feDistanceLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,'</span> +
<span class="linenr"> 9494: </span>  <span class=
"org-string">'feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,'</span> +
<span class="linenr"> 9495: </span>  <span class=
"org-string">'fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,'</span> +
<span class="linenr"> 9496: </span>  <span class=
"org-string">'foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,'</span> +
<span class="linenr"> 9497: </span>  <span class=
"org-string">'mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,'</span> +
<span class="linenr"> 9498: </span>  <span class=
"org-string">'polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,'</span> +
<span class="linenr"> 9499: </span>  <span class=
"org-string">'text,textPath,title,tspan,unknown,use,view'</span>
<span class="linenr"> 9500: </span>
<span class="linenr"> 9501: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">VOID_TAGS</span> =
<span class="linenr"> 9502: </span>  <span class=
"org-string">'area,base,br,col,embed,hr,img,input,link,meta,param,source,track,wbr'</span>
<span class="linenr"> 9503: </span>
<span class="linenr"> 9504: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isHTMLTag</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(HTML_TAGS)
<span class="linenr"> 9505: </span><span class="org-doc">/**</span>
<span class="linenr"> 9506: </span><span class=
"org-doc"> * Compiler only.</span>
<span class="linenr"> 9507: </span><span class=
"org-doc"> * Do NOT use in runtime code paths unless behind `__DEV__` flag.</span>
<span class="linenr"> 9508: </span><span class="org-doc"> */</span>
<span class="linenr"> 9509: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSVGTag</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(SVG_TAGS)
<span class="linenr"> 9510: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isVoidTag</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(VOID_TAGS)
<span class="linenr"> 9511: </span>
<span class="linenr"> 9512: </span>
<span class="linenr"> 9513: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">normalizeStyle</span>(<span class=
"org-variable-name">value</span>) {
<span class="linenr"> 9514: </span>  <span class=
"org-keyword">if</span> (isArray(value)) {
<span class="linenr"> 9515: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">res</span> = {}
<span class="linenr"> 9516: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; value.length; i++) {
<span class="linenr"> 9517: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">item</span> = value[i]
<span class="linenr"> 9518: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">normalized</span> = isString(item)
<span class="linenr"> 9519: </span>        ? parseStringStyle(item)
<span class="linenr"> 9520: </span>        : normalizeStyle(item)
<span class="linenr"> 9521: </span>      <span class=
"org-keyword">if</span> (normalized) {
<span class="linenr"> 9522: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> normalized) {
<span class=
"linenr"> 9523: </span>          res[key] = normalized[key]
<span class="linenr"> 9524: </span>        }
<span class="linenr"> 9525: </span>      }
<span class="linenr"> 9526: </span>    }
<span class="linenr"> 9527: </span>    <span class=
"org-keyword">return</span> res
<span class="linenr"> 9528: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isString(value)) {
<span class="linenr"> 9529: </span>    <span class=
"org-keyword">return</span> value
<span class="linenr"> 9530: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isObject(value)) {
<span class="linenr"> 9531: </span>    <span class=
"org-keyword">return</span> value
<span class="linenr"> 9532: </span>  }
<span class="linenr"> 9533: </span>}
<span class="linenr"> 9534: </span>
<span class="linenr"> 9535: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">listDelimiterRE</span> = <span class=
"org-string">/;(?![^(]*\))/</span>g
<span class="linenr"> 9536: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">propertyDelimiterRE</span> = <span class=
"org-string">/:(.+)/</span>
<span class="linenr"> 9537: </span>
<span class="linenr"> 9538: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseStringStyle</span>(<span class=
"org-variable-name">cssText</span>) {
<span class="linenr"> 9539: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ret</span> = {}
<span class=
"linenr"> 9540: </span>  cssText.split(listDelimiterRE).forEach(item =&gt; {
<span class="linenr"> 9541: </span>    <span class=
"org-keyword">if</span> (item) {
<span class="linenr"> 9542: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">tmp</span> = item.split(propertyDelimiterRE)
<span class=
"linenr"> 9543: </span>      tmp.length &gt; <span class=
"org-highlight-numbers-number">1</span> &amp;& (ret[tmp[<span class="org-highlight-numbers-number">0</span>].trim()] = tmp[<span class="org-highlight-numbers-number">1</span>].trim())
<span class="linenr"> 9544: </span>    }
<span class="linenr"> 9545: </span>  })
<span class="linenr"> 9546: </span>  <span class=
"org-keyword">return</span> ret
<span class="linenr"> 9547: </span>}
<span class="linenr"> 9548: </span>
<span class="linenr"> 9549: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">stringifyStyle</span>(<span class=
"org-variable-name">styles</span>) {
<span class="linenr"> 9550: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">ret</span> = <span class="org-string">''</span>
<span class="linenr"> 9551: </span>  <span class=
"org-keyword">if</span> (!styles || isString(styles)) {
<span class="linenr"> 9552: </span>    <span class=
"org-keyword">return</span> ret
<span class="linenr"> 9553: </span>  }
<span class="linenr"> 9554: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> styles) {
<span class="linenr"> 9555: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">value</span> = styles[key]
<span class="linenr"> 9556: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">normalizedKey</span> = key.startsWith(<span class="org-string">`--`</span>) ? key : hyphenate(key)
<span class="linenr"> 9557: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr"> 9558: </span>      isString(value) ||
<span class="linenr"> 9559: </span>      (<span class=
"org-keyword">typeof</span> value === <span class=
"org-string">'number'</span> &amp;& isNoUnitNumericStyleProp(normalizedKey))
<span class="linenr"> 9560: </span>    ) {
<span class="linenr"> 9561: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">only render valid values</span>
<span class="linenr"> 9562: </span>      ret += <span class=
"org-string">`${normalizedKey}:${value};`</span>
<span class="linenr"> 9563: </span>    }
<span class="linenr"> 9564: </span>  }
<span class="linenr"> 9565: </span>  <span class=
"org-keyword">return</span> ret
<span class="linenr"> 9566: </span>}
<span class="linenr"> 9567: </span>
<span class="linenr"> 9568: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">normalizeClass</span>(<span class=
"org-variable-name">value</span>) {
<span class="linenr"> 9569: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">res</span> = <span class="org-string">''</span>
<span class="linenr"> 9570: </span>  <span class=
"org-keyword">if</span> (isString(value)) {
<span class="linenr"> 9571: </span>    res = value
<span class="linenr"> 9572: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isArray(value)) {
<span class="linenr"> 9573: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; value.length; i++) {
<span class="linenr"> 9574: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">normalized</span> = normalizeClass(value[i])
<span class="linenr"> 9575: </span>      <span class=
"org-keyword">if</span> (normalized) {
<span class=
"linenr"> 9576: </span>        res += normalized + <span class=
"org-string">' '</span>
<span class="linenr"> 9577: </span>      }
<span class="linenr"> 9578: </span>    }
<span class="linenr"> 9579: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isObject(value)) {
<span class="linenr"> 9580: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">name</span> <span class=
"org-keyword">in</span> value) {
<span class="linenr"> 9581: </span>      <span class=
"org-keyword">if</span> (value[name]) {
<span class=
"linenr"> 9582: </span>        res += name + <span class=
"org-string">' '</span>
<span class="linenr"> 9583: </span>      }
<span class="linenr"> 9584: </span>    }
<span class="linenr"> 9585: </span>  }
<span class="linenr"> 9586: </span>  <span class=
"org-keyword">return</span> res.trim()
<span class="linenr"> 9587: </span>}
<span class="linenr"> 9588: </span>
<span class="linenr"> 9589: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">normalizeProps</span>(<span class=
"org-variable-name">props</span>) {
<span class="linenr"> 9590: </span>  <span class=
"org-keyword">if</span> (!props) <span class=
"org-keyword">return</span> <span class="org-constant">null</span>
<span class="linenr"> 9591: </span>  <span class=
"org-keyword">let</span> { <span class=
"org-keyword">class</span>: klass, style } = props
<span class="linenr"> 9592: </span>  <span class=
"org-keyword">if</span> (klass &amp;& !isString(klass)) {
<span class="linenr"> 9593: </span>    props.<span class=
"org-keyword">class</span> = normalizeClass(klass)
<span class="linenr"> 9594: </span>  }
<span class="linenr"> 9595: </span>  <span class=
"org-keyword">if</span> (style) {
<span class=
"linenr"> 9596: </span>    props.style = normalizeStyle(style)
<span class="linenr"> 9597: </span>  }
<span class="linenr"> 9598: </span>  <span class=
"org-keyword">return</span> props
<span class="linenr"> 9599: </span>}
<span class="linenr"> 9600: </span>
<span class="linenr"> 9601: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">escapeRE</span> = <span class=
"org-string">/["'&amp;&lt;&gt;]/</span>
<span class="linenr"> 9602: </span>
<span class="linenr"> 9603: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">escapeHtml</span>(<span class=
"org-variable-name">string</span>) {
<span class="linenr"> 9604: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">str</span> = <span class=
"org-string">''</span> + string
<span class="linenr"> 9605: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">match</span> = escapeRE.exec(str)
<span class="linenr"> 9606: </span>
<span class="linenr"> 9607: </span>  <span class=
"org-keyword">if</span> (!match) {
<span class="linenr"> 9608: </span>    <span class=
"org-keyword">return</span> str
<span class="linenr"> 9609: </span>  }
<span class="linenr"> 9610: </span>
<span class="linenr"> 9611: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">html</span> = <span class=
"org-string">''</span>
<span class="linenr"> 9612: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">escaped</span>
<span class="linenr"> 9613: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">index</span>
<span class="linenr"> 9614: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">lastIndex</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 9615: </span>  <span class=
"org-keyword">for</span> (index = match.index; index &lt; str.length; index++) {
<span class="linenr"> 9616: </span>    <span class=
"org-keyword">switch</span> (str.charCodeAt(index)) {
<span class="linenr"> 9617: </span>      <span class=
"org-keyword">case</span> <span class=
"org-highlight-numbers-number">34</span>: <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">"</span>
<span class="linenr"> 9618: </span>        escaped = <span class=
"org-string">'&amp;quot;'</span>
<span class="linenr"> 9619: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 9620: </span>      <span class=
"org-keyword">case</span> <span class=
"org-highlight-numbers-number">38</span>: <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&</span>
<span class="linenr"> 9621: </span>        escaped = <span class=
"org-string">'&amp;amp;'</span>
<span class="linenr"> 9622: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 9623: </span>      <span class=
"org-keyword">case</span> <span class=
"org-highlight-numbers-number">39</span>: <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">'</span>
<span class="linenr"> 9624: </span>        escaped = <span class=
"org-string">'&amp;#39;'</span>
<span class="linenr"> 9625: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 9626: </span>      <span class=
"org-keyword">case</span> <span class=
"org-highlight-numbers-number">60</span>: <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;</span>
<span class="linenr"> 9627: </span>        escaped = <span class=
"org-string">'&amp;lt;'</span>
<span class="linenr"> 9628: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 9629: </span>      <span class=
"org-keyword">case</span> <span class=
"org-highlight-numbers-number">62</span>: <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&gt;</span>
<span class="linenr"> 9630: </span>        escaped = <span class=
"org-string">'&amp;gt;'</span>
<span class="linenr"> 9631: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 9632: </span>      <span class=
"org-keyword">default</span>:
<span class="linenr"> 9633: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 9634: </span>    }
<span class="linenr"> 9635: </span>
<span class="linenr"> 9636: </span>    <span class=
"org-keyword">if</span> (lastIndex !== index) {
<span class=
"linenr"> 9637: </span>      html += str.slice(lastIndex, index)
<span class="linenr"> 9638: </span>    }
<span class="linenr"> 9639: </span>
<span class=
"linenr"> 9640: </span>    lastIndex = index + <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 9641: </span>    html += escaped
<span class="linenr"> 9642: </span>  }
<span class="linenr"> 9643: </span>
<span class="linenr"> 9644: </span>  <span class=
"org-keyword">return</span> lastIndex !== index ? html + str.slice(lastIndex, index) : html
<span class="linenr"> 9645: </span>}
<span class="linenr"> 9646: </span>
<span class="linenr"> 9647: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">https://www.w3.org/TR/html52/syntax.html#comments</span>
<span class="linenr"> 9648: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">commentStripRE</span> = <span class=
"org-string">/^-?&gt;|&lt;!--|--&gt;|--!&gt;|&lt;!-$/</span>g
<span class="linenr"> 9649: </span>
<span class="linenr"> 9650: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">escapeHtmlComment</span>(<span class=
"org-variable-name">src</span>) {
<span class="linenr"> 9651: </span>  <span class=
"org-keyword">return</span> src.replace(commentStripRE, <span class="org-string">''</span>)
<span class="linenr"> 9652: </span>}
<span class="linenr"> 9653: </span>
<span class="linenr"> 9654: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">toDisplayString</span> = (val) =&gt; {
<span class="linenr"> 9655: </span>  <span class=
"org-keyword">return</span> isString(val)
<span class="linenr"> 9656: </span>    ? val
<span class="linenr"> 9657: </span>    : val == <span class=
"org-constant">null</span>
<span class="linenr"> 9658: </span>    ? <span class=
"org-string">''</span>
<span class="linenr"> 9659: </span>    : isArray(val) ||
<span class="linenr"> 9660: </span>      (isObject(val) &amp;&
<span class=
"linenr"> 9661: </span>        (val.toString === objectToString || !isFunction(val.toString)))
<span class=
"linenr"> 9662: </span>    ? JSON.stringify(val, replacer, <span class="org-highlight-numbers-number">2</span>)
<span class="linenr"> 9663: </span>    : String(val)
<span class="linenr"> 9664: </span>}
<span class="linenr"> 9665: </span>
<span class="linenr"> 9666: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">replacer</span> = (_key, val) =&gt; {
<span class="linenr"> 9667: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">can't use isRef here since @vue/shared has no deps</span>
<span class="linenr"> 9668: </span>  <span class=
"org-keyword">if</span> (val &amp;& val.__v_isRef) {
<span class="linenr"> 9669: </span>    <span class=
"org-keyword">return</span> replacer(_key, val.value)
<span class="linenr"> 9670: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isMap(val)) {
<span class="linenr"> 9671: </span>    <span class=
"org-keyword">return</span> {
<span class="linenr"> 9672: </span>      [<span class=
"org-string">`Map(${val.size})`</span>]: [...val.entries()].reduce((entries, [key, val]) =&gt; {
<span class="linenr"> 9673: </span>        ;entries[<span class=
"org-string">`${key} =&gt;`</span>] = val
<span class="linenr"> 9674: </span>        <span class=
"org-keyword">return</span> entries
<span class="linenr"> 9675: </span>      }, {})
<span class="linenr"> 9676: </span>    }
<span class="linenr"> 9677: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isSet(val)) {
<span class="linenr"> 9678: </span>    <span class=
"org-keyword">return</span> {
<span class="linenr"> 9679: </span>      [<span class=
"org-string">`Set(${val.size})`</span>]: [...val.values()]
<span class="linenr"> 9680: </span>    }
<span class="linenr"> 9681: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isObject(val) &amp;& !isArray(val) &amp;& !isPlainObject(val)) {
<span class="linenr"> 9682: </span>    <span class=
"org-keyword">return</span> String(val)
<span class="linenr"> 9683: </span>  }
<span class="linenr"> 9684: </span>  <span class=
"org-keyword">return</span> val
<span class="linenr"> 9685: </span>}
<span class="linenr"> 9686: </span>
<span class="linenr"> 9687: </span>
<span class="linenr"> 9688: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">noopDirectiveTransform</span> = () =&gt; ({ props: [] })
<span class="linenr"> 9689: </span>
<span class="linenr"> 9690: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isRawTextContainer</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr"> 9691: </span>  <span class=
"org-string">'style,iframe,script,noscript'</span>,
<span class="linenr"> 9692: </span>  <span class=
"org-constant">true</span>
<span class="linenr"> 9693: </span>)
<span class="linenr"> 9694: </span>
<span class="linenr"> 9695: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">DOMNamespaces</span> = {
<span class="linenr"> 9696: </span>  HTML: Namespaces.HTML,
<span class="linenr"> 9697: </span>  SVG: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr"> 9698: </span>  MATH_ML: <span class=
"org-highlight-numbers-number">2</span>
<span class="linenr"> 9699: </span>}
<span class="linenr"> 9700: </span>
<span class="linenr"> 9701: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">parserOptions</span> = {
<span class="linenr"> 9702: </span>  isVoidTag,
<span class=
"linenr"> 9703: </span>  isNativeTag: tag =&gt; isHTMLTag(tag) || isSVGTag(tag),
<span class=
"linenr"> 9704: </span>  isPreTag: tag =&gt; tag === <span class=
"org-string">'pre'</span>,
<span class=
"linenr"> 9705: </span>  decodeEntities: __BROWSER__ ? decodeHtmlBrowser : decodeHtml,
<span class="linenr"> 9706: </span>
<span class=
"linenr"> 9707: </span>  isBuiltInComponent: tag =&gt; {
<span class="linenr"> 9708: </span>    <span class=
"org-keyword">if</span> (isBuiltInType(tag, <span class=
"org-string">`Transition`</span>)) {
<span class="linenr"> 9709: </span>      <span class=
"org-keyword">return</span> TRANSITION
<span class="linenr"> 9710: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isBuiltInType(tag, <span class=
"org-string">`TransitionGroup`</span>)) {
<span class="linenr"> 9711: </span>      <span class=
"org-keyword">return</span> TRANSITION_GROUP
<span class="linenr"> 9712: </span>    }
<span class="linenr"> 9713: </span>  },
<span class="linenr"> 9714: </span>
<span class="linenr"> 9715: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">https://html.spec.whatwg.org/multipage/parsing.html#tree-construction-dispatcher</span>
<span class="linenr"> 9716: </span>  getNamespace(tag, parent) {
<span class="linenr"> 9717: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">ns</span> = parent ? parent.ns : DOMNamespaces.HTML
<span class="linenr"> 9718: </span>
<span class="linenr"> 9719: </span>    <span class=
"org-keyword">if</span> (parent &amp;& ns === DOMNamespaces.MATH_ML) {
<span class="linenr"> 9720: </span>      <span class=
"org-keyword">if</span> (parent.tag === <span class=
"org-string">'annotation-xml'</span>) {
<span class="linenr"> 9721: </span>        <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'svg'</span>) {
<span class="linenr"> 9722: </span>          <span class=
"org-keyword">return</span> DOMNamespaces.SVG
<span class="linenr"> 9723: </span>        }
<span class="linenr"> 9724: </span>        <span class=
"org-keyword">if</span> (
<span class="linenr"> 9725: </span>          parent.props.some(
<span class="linenr"> 9726: </span>            a =&gt;
<span class=
"linenr"> 9727: </span>              a.type === NodeTypes.ATTRIBUTE &amp;&
<span class=
"linenr"> 9728: </span>              a.name === <span class=
"org-string">'encoding'</span> &amp;&
<span class=
"linenr"> 9729: </span>              a.value != <span class=
"org-constant">null</span> &amp;&
<span class=
"linenr"> 9730: </span>              (a.value.content === <span class="org-string">'text/html'</span> ||
<span class=
"linenr"> 9731: </span>                a.value.content === <span class="org-string">'application/xhtml+xml'</span>)
<span class="linenr"> 9732: </span>          )
<span class="linenr"> 9733: </span>        ) {
<span class=
"linenr"> 9734: </span>          ns = DOMNamespaces.HTML
<span class="linenr"> 9735: </span>        }
<span class="linenr"> 9736: </span>      } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class="linenr"> 9737: </span>        <span class=
"org-string">/^m(?:[ions]|text)$/</span>.test(parent.tag) &amp;&
<span class="linenr"> 9738: </span>        tag !== <span class=
"org-string">'mglyph'</span> &amp;&
<span class="linenr"> 9739: </span>        tag !== <span class=
"org-string">'malignmark'</span>
<span class="linenr"> 9740: </span>      ) {
<span class="linenr"> 9741: </span>        ns = DOMNamespaces.HTML
<span class="linenr"> 9742: </span>      }
<span class="linenr"> 9743: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (parent &amp;& ns === DOMNamespaces.SVG) {
<span class="linenr"> 9744: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 9745: </span>        parent.tag === <span class=
"org-string">'foreignObject'</span> ||
<span class=
"linenr"> 9746: </span>        parent.tag === <span class=
"org-string">'desc'</span> ||
<span class=
"linenr"> 9747: </span>        parent.tag === <span class=
"org-string">'title'</span>
<span class="linenr"> 9748: </span>      ) {
<span class="linenr"> 9749: </span>        ns = DOMNamespaces.HTML
<span class="linenr"> 9750: </span>      }
<span class="linenr"> 9751: </span>    }
<span class="linenr"> 9752: </span>
<span class="linenr"> 9753: </span>    <span class=
"org-keyword">if</span> (ns === DOMNamespaces.HTML) {
<span class="linenr"> 9754: </span>      <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'svg'</span>) {
<span class="linenr"> 9755: </span>        <span class=
"org-keyword">return</span> DOMNamespaces.SVG
<span class="linenr"> 9756: </span>      }
<span class="linenr"> 9757: </span>      <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'math'</span>) {
<span class="linenr"> 9758: </span>        <span class=
"org-keyword">return</span> DOMNamespaces.MATH_ML
<span class="linenr"> 9759: </span>      }
<span class="linenr"> 9760: </span>    }
<span class="linenr"> 9761: </span>    <span class=
"org-keyword">return</span> ns
<span class="linenr"> 9762: </span>  },
<span class="linenr"> 9763: </span>
<span class="linenr"> 9764: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">https://html.spec.whatwg.org/multipage/parsing.html#parsing-html-fragments</span>
<span class="linenr"> 9765: </span>  getTextMode({ tag, ns }) {
<span class="linenr"> 9766: </span>    <span class=
"org-keyword">if</span> (ns === DOMNamespaces.HTML) {
<span class="linenr"> 9767: </span>      <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'textarea'</span> || tag === <span class=
"org-string">'title'</span>) {
<span class="linenr"> 9768: </span>        <span class=
"org-keyword">return</span> TextModes.RCDATA
<span class="linenr"> 9769: </span>      }
<span class="linenr"> 9770: </span>      <span class=
"org-keyword">if</span> (isRawTextContainer(tag)) {
<span class="linenr"> 9771: </span>        <span class=
"org-keyword">return</span> TextModes.RAWTEXT
<span class="linenr"> 9772: </span>      }
<span class="linenr"> 9773: </span>    }
<span class="linenr"> 9774: </span>    <span class=
"org-keyword">return</span> TextModes.DATA
<span class="linenr"> 9775: </span>  }
<span class="linenr"> 9776: </span>}
<span class="linenr"> 9777: </span>
<span class="linenr"> 9778: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">hasDynamicKeyVBind</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr"> 9779: </span>  <span class=
"org-keyword">return</span> node.props.some(
<span class="linenr"> 9780: </span>    p =&gt;
<span class=
"linenr"> 9781: </span>      p.type === NodeTypes.DIRECTIVE &amp;&
<span class="linenr"> 9782: </span>      p.name === <span class=
"org-string">'bind'</span> &amp;&
<span class="linenr"> 9783: </span>      (!p.arg || <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-bind="obj"</span>
<span class=
"linenr"> 9784: </span>        p.arg.type !== NodeTypes.SIMPLE_EXPRESSION || <span class="org-comment-delimiter">// </span><span class="org-comment">v-bind:[_ctx.foo]</span>
<span class=
"linenr"> 9785: </span>        !p.arg.isStatic) <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-bind:[foo]</span>
<span class="linenr"> 9786: </span>  )
<span class="linenr"> 9787: </span>}
<span class="linenr"> 9788: </span>
<span class="linenr"> 9789: </span>
<span class="linenr"> 9790: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">hasMultipleChildren</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr"> 9791: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#1352 filter out potential comment nodes.</span>
<span class="linenr"> 9792: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">children</span> = (node.children = node.children.filter(
<span class="linenr"> 9793: </span>    c =&gt;
<span class=
"linenr"> 9794: </span>      c.type !== NodeTypes.COMMENT &amp;&
<span class=
"linenr"> 9795: </span>      !(c.type === NodeTypes.TEXT &amp;& !c.content.trim())
<span class="linenr"> 9796: </span>  ))
<span class="linenr"> 9797: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = children[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 9798: </span>  <span class=
"org-keyword">return</span> (
<span class=
"linenr"> 9799: </span>    children.length !== <span class=
"org-highlight-numbers-number">1</span> ||
<span class=
"linenr"> 9800: </span>    child.type === NodeTypes.FOR ||
<span class=
"linenr"> 9801: </span>    (child.type === NodeTypes.IF &amp;& child.branches.some(hasMultipleChildren))
<span class="linenr"> 9802: </span>  )
<span class="linenr"> 9803: </span>}
<span class="linenr"> 9804: </span>
<span class="linenr"> 9805: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">warnTransitionChildren</span> = (node, context) =&gt; {
<span class="linenr"> 9806: </span>  <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 9807: </span>    node.type === NodeTypes.ELEMENT &amp;&
<span class=
"linenr"> 9808: </span>    node.tagType === ElementTypes.COMPONENT
<span class="linenr"> 9809: </span>  ) {
<span class="linenr"> 9810: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">component</span> = context.isBuiltInComponent(node.tag)
<span class="linenr"> 9811: </span>    <span class=
"org-keyword">if</span> (component === TRANSITION) {
<span class="linenr"> 9812: </span>      <span class=
"org-keyword">return</span> () =&gt; {
<span class="linenr"> 9813: </span>        <span class=
"org-keyword">if</span> (node.children.length &amp;& hasMultipleChildren(node)) {
<span class=
"linenr"> 9814: </span>          console.warn(<span class=
"org-string">`X_TRANSITION_INVALID_CHILDREN`</span>, node)
<span class="linenr"> 9815: </span>        }
<span class="linenr"> 9816: </span>      }
<span class="linenr"> 9817: </span>    }
<span class="linenr"> 9818: </span>  }
<span class="linenr"> 9819: </span>}
<span class="linenr"> 9820: </span>
<span class="linenr"> 9821: </span>
<span class="linenr"> 9822: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">ignoreSideEffectTags</span> = (node, context) =&gt; {
<span class="linenr"> 9823: </span>  <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 9824: </span>    node.type === NodeTypes.ELEMENT &amp;&
<span class=
"linenr"> 9825: </span>    node.tagType === ElementTypes.ELEMENT &amp;&
<span class="linenr"> 9826: </span>    (node.tag === <span class=
"org-string">'script'</span> || node.tag === <span class=
"org-string">'style'</span>)
<span class="linenr"> 9827: </span>  ) {
<span class="linenr"> 9828: </span>    console.warn(<span class=
"org-string">`X_IGNORED_SIDE_EFFECT_TAG`</span>)
<span class="linenr"> 9829: </span>    context.removeNode()
<span class="linenr"> 9830: </span>  }
<span class="linenr"> 9831: </span>}
<span class="linenr"> 9832: </span>
<span class="linenr"> 9833: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Parse inline CSS strings for static style attributes into an object.</span>
<span class="linenr"> 9834: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">This is a NodeTransform since it works on the static `style` attribute and</span>
<span class="linenr"> 9835: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">converts it into a dynamic equivalent:</span>
<span class="linenr"> 9836: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">style="color: red" -&gt; :style='{ "color": "red" }'</span>
<span class="linenr"> 9837: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">It is then processed by `transformElement` and included in the generated</span>
<span class="linenr"> 9838: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props.</span>
<span class="linenr"> 9839: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformStyleCD</span> = node =&gt; {
<span class="linenr"> 9840: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.ELEMENT) {
<span class=
"linenr"> 9841: </span>    node.props.forEach((p, i) =&gt; {
<span class="linenr"> 9842: </span>      <span class=
"org-keyword">if</span> (p.type === NodeTypes.ATTRIBUTE &amp;& p.name === <span class="org-string">'style'</span> &amp;& p.value) {
<span class="linenr"> 9843: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">replace p with an expression node</span>
<span class="linenr"> 9844: </span>        node.props[i] = {
<span class=
"linenr"> 9845: </span>          type: NodeTypes.DIRECTIVE,
<span class="linenr"> 9846: </span>          name: <span class=
"org-string">`bind`</span>,
<span class=
"linenr"> 9847: </span>          arg: createSimpleExpression(<span class="org-string">`style`</span>, <span class="org-constant">true</span>, p.loc),
<span class=
"linenr"> 9848: </span>          exp: parseInlineCSS(p.value.content, p.loc),
<span class="linenr"> 9849: </span>          modifiers: [],
<span class="linenr"> 9850: </span>          loc: p.loc
<span class="linenr"> 9851: </span>        }
<span class="linenr"> 9852: </span>      }
<span class="linenr"> 9853: </span>    })
<span class="linenr"> 9854: </span>  }
<span class="linenr"> 9855: </span>}
<span class="linenr"> 9856: </span>
<span class="linenr"> 9857: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">parseInlineCSS</span> = (cssText, loc) =&gt; {
<span class="linenr"> 9858: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">normalized</span> = parseStringStyle(cssText)
<span class="linenr"> 9859: </span>  <span class=
"org-keyword">return</span> createSimpleExpression(
<span class="linenr"> 9860: </span>    JSON.stringify(normalized),
<span class="linenr"> 9861: </span>    <span class=
"org-constant">false</span>,
<span class="linenr"> 9862: </span>    loc,
<span class="linenr"> 9863: </span>    ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 9864: </span>  )
<span class="linenr"> 9865: </span>}
<span class="linenr"> 9866: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformVHtml</span> = (dir, node, context) =&gt; {
<span class="linenr"> 9867: </span>  <span class=
"org-keyword">const</span> { exp, loc } = dir
<span class="linenr"> 9868: </span>  <span class=
"org-keyword">if</span> (!exp) {
<span class="linenr"> 9869: </span>    logg(<span class=
"org-string">"v-html no exp"</span>)
<span class="linenr"> 9870: </span>  }
<span class="linenr"> 9871: </span>  <span class=
"org-keyword">if</span> (node.children.length) {
<span class="linenr"> 9872: </span>    logg(<span class=
"org-string">'v-html can not has children'</span>)
<span class=
"linenr"> 9873: </span>    node.children.length = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 9874: </span>  }
<span class="linenr"> 9875: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 9876: </span>    props: [
<span class="linenr"> 9877: </span>      createObjectProperty(
<span class=
"linenr"> 9878: </span>        createSimpleExpression(<span class=
"org-string">`innerHTML`</span>, <span class=
"org-constant">true</span>, loc),
<span class=
"linenr"> 9879: </span>        exp || createSimpleExpression(<span class="org-string">''</span>, <span class="org-constant">true</span>)
<span class="linenr"> 9880: </span>      )
<span class="linenr"> 9881: </span>    ]
<span class="linenr"> 9882: </span>  }
<span class="linenr"> 9883: </span>}
<span class="linenr"> 9884: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformVText</span> = (dir, node, context) =&gt; {
<span class="linenr"> 9885: </span>  <span class=
"org-keyword">const</span> { exp, loc } = dir
<span class="linenr"> 9886: </span>  <span class=
"org-keyword">if</span> (!exp) {
<span class="linenr"> 9887: </span>    logg(<span class=
"org-string">'v-text no exp'</span>)
<span class="linenr"> 9888: </span>  }
<span class="linenr"> 9889: </span>  <span class=
"org-keyword">if</span> (node.children.length) {
<span class="linenr"> 9890: </span>    logg(<span class=
"org-string">'v-text can not have children'</span>)
<span class=
"linenr"> 9891: </span>    node.children.length = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 9892: </span>  }
<span class="linenr"> 9893: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 9894: </span>    props: [
<span class="linenr"> 9895: </span>      createObjectProperty(
<span class=
"linenr"> 9896: </span>        createSimpleExpression(<span class=
"org-string">`textContent`</span>, <span class=
"org-constant">true</span>),
<span class="linenr"> 9897: </span>        exp
<span class=
"linenr"> 9898: </span>          ? createCallExpression(
<span class=
"linenr"> 9899: </span>              context.helperString(TO_DISPLAY_STRING),
<span class="linenr"> 9900: </span>              [exp],
<span class="linenr"> 9901: </span>              loc
<span class="linenr"> 9902: </span>            )
<span class=
"linenr"> 9903: </span>          : createSimpleExpression(<span class="org-string">''</span>, <span class="org-constant">true</span>)
<span class="linenr"> 9904: </span>      )
<span class="linenr"> 9905: </span>    ]
<span class="linenr"> 9906: </span>  }
<span class="linenr"> 9907: </span>}
<span class="linenr"> 9908: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformModelCD</span> = (dir, node, context) =&gt; {
<span class="linenr"> 9909: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">baseResult</span> = transformModel(dir, node, context)
<span class="linenr"> 9910: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">base transform has errors OR component v-model (only need props)</span>
<span class="linenr"> 9911: </span>  <span class=
"org-keyword">if</span> (!baseResult.props.length || node.tagType === ElementTypes.COMPONENT) {
<span class="linenr"> 9912: </span>    <span class=
"org-keyword">return</span> baseResult
<span class="linenr"> 9913: </span>  }
<span class="linenr"> 9914: </span>
<span class="linenr"> 9915: </span>  <span class=
"org-keyword">if</span> (dir.arg) {
<span class="linenr"> 9916: </span>    logg(<span class=
"org-string">"transfromModelCD - X_V_MODEL_ARG_ON_ELEMENT"</span>)
<span class="linenr"> 9917: </span>  }
<span class="linenr"> 9918: </span>
<span class="linenr"> 9919: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">checkDuplicatedValue</span>() {
<span class="linenr"> 9920: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">value</span> = findProp(node, <span class=
"org-string">'value'</span>)
<span class="linenr"> 9921: </span>    <span class=
"org-keyword">if</span> (value) {
<span class="linenr"> 9922: </span>      logg(<span class=
"org-string">"transfromModelCD - X_V_MODEL_UNNECESSARY_VALUE"</span>)
<span class="linenr"> 9923: </span>    }
<span class="linenr"> 9924: </span>  }
<span class="linenr"> 9925: </span>
<span class="linenr"> 9926: </span>  <span class=
"org-keyword">const</span> { tag } = node
<span class="linenr"> 9927: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isCustomElement</span> = context.isCustomElement(tag)
<span class="linenr"> 9928: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 9929: </span>    tag === <span class=
"org-string">'input'</span> ||
<span class="linenr"> 9930: </span>    tag === <span class=
"org-string">'textarea'</span> ||
<span class="linenr"> 9931: </span>    tag === <span class=
"org-string">'select'</span> ||
<span class="linenr"> 9932: </span>    isCustomElement
<span class="linenr"> 9933: </span>  ) {
<span class="linenr"> 9934: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">directiveToUse</span> = V_MODEL_TEXT
<span class="linenr"> 9935: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">isInvalidType</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 9936: </span>    <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'input'</span> || isCustomElement) {
<span class="linenr"> 9937: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = findProp(node, <span class=
"org-string">`type`</span>)
<span class="linenr"> 9938: </span>      <span class=
"org-keyword">if</span> (type) {
<span class="linenr"> 9939: </span>        <span class=
"org-keyword">if</span> (type.type === NodeTypes.DIRECTIVE) {
<span class="linenr"> 9940: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">:type="foo"</span>
<span class=
"linenr"> 9941: </span>          directiveToUse = V_MODEL_DYNAMIC
<span class="linenr"> 9942: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type.value) {
<span class="linenr"> 9943: </span>          <span class=
"org-keyword">switch</span> (type.value.content) {
<span class="linenr"> 9944: </span>            <span class=
"org-keyword">case</span> <span class="org-string">'radio'</span>:
<span class=
"linenr"> 9945: </span>              directiveToUse = V_MODEL_RADIO
<span class="linenr"> 9946: </span>              <span class=
"org-keyword">break</span>
<span class="linenr"> 9947: </span>            <span class=
"org-keyword">case</span> <span class=
"org-string">'checkbox'</span>:
<span class=
"linenr"> 9948: </span>              directiveToUse = V_MODEL_CHECKBOX
<span class="linenr"> 9949: </span>              <span class=
"org-keyword">break</span>
<span class="linenr"> 9950: </span>            <span class=
"org-keyword">case</span> <span class="org-string">'file'</span>:
<span class=
"linenr"> 9951: </span>              isInvalidType = <span class=
"org-constant">true</span>
<span class="linenr"> 9952: </span>              logg(<span class=
"org-string">"[DOM]transformModel - X_V_MODEL_ON_FILE_INPUT_ELEMENT"</span>)
<span class="linenr"> 9953: </span>              <span class=
"org-keyword">break</span>
<span class="linenr"> 9954: </span>            <span class=
"org-keyword">default</span>:
<span class="linenr"> 9955: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">text type</span>
<span class=
"linenr"> 9956: </span>              __DEV__ &amp;& checkDuplicatedValue()
<span class="linenr"> 9957: </span>              <span class=
"org-keyword">break</span>
<span class="linenr"> 9958: </span>          }
<span class="linenr"> 9959: </span>        }
<span class="linenr"> 9960: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (hasDynamicKeyVBind(node)) {
<span class="linenr"> 9961: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">element has bindings with dynamic keys, which can possibly contain</span>
<span class="linenr"> 9962: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">"type".</span>
<span class=
"linenr"> 9963: </span>        directiveToUse = V_MODEL_DYNAMIC
<span class="linenr"> 9964: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 9965: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">text type</span>
<span class=
"linenr"> 9966: </span>        __DEV__ &amp;& checkDuplicatedValue()
<span class="linenr"> 9967: </span>      }
<span class="linenr"> 9968: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'select'</span>) {
<span class=
"linenr"> 9969: </span>      directiveToUse = V_MODEL_SELECT
<span class="linenr"> 9970: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 9971: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">textarea</span>
<span class=
"linenr"> 9972: </span>      __DEV__ &amp;& checkDuplicatedValue()
<span class="linenr"> 9973: </span>    }
<span class="linenr"> 9974: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject runtime directive</span>
<span class="linenr"> 9975: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">by returning the helper symbol via needRuntime</span>
<span class="linenr"> 9976: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the import will replaced a resolveDirective call.</span>
<span class="linenr"> 9977: </span>    <span class=
"org-keyword">if</span> (!isInvalidType) {
<span class=
"linenr"> 9978: </span>      baseResult.needRuntime = context.helper(directiveToUse)
<span class="linenr"> 9979: </span>    }
<span class="linenr"> 9980: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 9981: </span>    logg(<span class=
"org-string">"[DOM]transformModel - X_V_MODEL_ON_INVALID_ELEMENT"</span>)
<span class="linenr"> 9982: </span>  }
<span class="linenr"> 9983: </span>
<span class="linenr"> 9984: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">native vmodel doesn't need the `modelValue` props since they are also</span>
<span class="linenr"> 9985: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">passed to the runtime as `binding.value`. removing it reduces code size.</span>
<span class=
"linenr"> 9986: </span>  baseResult.props = baseResult.props.filter(
<span class="linenr"> 9987: </span>    p =&gt;
<span class="linenr"> 9988: </span>      !(
<span class=
"linenr"> 9989: </span>        p.key.type === NodeTypes.SIMPLE_EXPRESSION &amp;&
<span class=
"linenr"> 9990: </span>        p.key.content === <span class=
"org-string">'modelValue'</span>
<span class="linenr"> 9991: </span>      )
<span class="linenr"> 9992: </span>  )
<span class="linenr"> 9993: </span>
<span class="linenr"> 9994: </span>  <span class=
"org-keyword">return</span> baseResult
<span class="linenr"> 9995: </span>}
<span class="linenr"> 9996: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isEventOptionModifier</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(<span class=
"org-string">`passive,once,capture`</span>)
<span class="linenr"> 9997: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isNonKeyModifier</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr"> 9998: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">event propagation management</span>
<span class="linenr"> 9999: </span>  <span class=
"org-string">`stop,prevent,self,`</span> +
<span class="linenr">10000: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">system modifiers + exact</span>
<span class="linenr">10001: </span>    <span class=
"org-string">`ctrl,shift,alt,meta,exact,`</span> +
<span class="linenr">10002: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">mouse</span>
<span class="linenr">10003: </span>    <span class=
"org-string">`middle`</span>
<span class="linenr">10004: </span>)
<span class="linenr">10005: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">left & right could be mouse or key modifiers based on event type</span>
<span class="linenr">10006: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">maybeKeyModifier</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(<span class=
"org-string">'left,right'</span>)
<span class="linenr">10007: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isKeyboardEvent</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr">10008: </span>  <span class=
"org-string">`onkeyup,onkeydown,onkeypress`</span>,
<span class="linenr">10009: </span>  <span class=
"org-constant">true</span>
<span class="linenr">10010: </span>)
<span class="linenr">10011: </span>
<span class="linenr">10012: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">将修饰符分类</span>
<span class="linenr">10013: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">resolveModifiers</span> = (key, modifiers, context, loc) =&gt; {
<span class="linenr">10014: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyModifiers</span> = []
<span class="linenr">10015: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">nonKeyModifiers</span> = []
<span class="linenr">10016: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">eventOptionModifiers</span> = []
<span class="linenr">10017: </span>
<span class="linenr">10018: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; modifiers.length; i++) {
<span class="linenr">10019: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">modifier</span> = modifiers[i]
<span class="linenr">10020: </span>
<span class="linenr">10021: </span>    <span class=
"org-keyword">if</span> (isEventOptionModifier(modifier)) {
<span class="linenr">10022: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">eventOptionModifiers: modifiers for addEventListener() options,</span>
<span class="linenr">10023: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">e.g. .passive & .capture</span>
<span class=
"linenr">10024: </span>      eventOptionModifiers.push(modifier)
<span class="linenr">10025: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">10026: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">runtimeModifiers: modifiers that needs runtime guards</span>
<span class="linenr">10027: </span>      <span class=
"org-keyword">if</span> (maybeKeyModifier(modifier)) {
<span class="linenr">10028: </span>        <span class=
"org-keyword">if</span> (isStaticExp(key)) {
<span class="linenr">10029: </span>          <span class=
"org-keyword">if</span> (isKeyboardEvent(key.content)) {
<span class=
"linenr">10030: </span>            keyModifiers.push(modifier)
<span class="linenr">10031: </span>          } <span class=
"org-keyword">else</span> {
<span class=
"linenr">10032: </span>            nonKeyModifiers.push(modifier)
<span class="linenr">10033: </span>          }
<span class="linenr">10034: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr">10035: </span>          keyModifiers.push(modifier)
<span class=
"linenr">10036: </span>          nonKeyModifiers.push(modifier)
<span class="linenr">10037: </span>        }
<span class="linenr">10038: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">10039: </span>        <span class=
"org-keyword">if</span> (isNonKeyModifier(modifier)) {
<span class=
"linenr">10040: </span>          nonKeyModifiers.push(modifier)
<span class="linenr">10041: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr">10042: </span>          keyModifiers.push(modifier)
<span class="linenr">10043: </span>        }
<span class="linenr">10044: </span>      }
<span class="linenr">10045: </span>    }
<span class="linenr">10046: </span>  }
<span class="linenr">10047: </span>
<span class="linenr">10048: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr">10049: </span>    keyModifiers,
<span class="linenr">10050: </span>    nonKeyModifiers,
<span class="linenr">10051: </span>    eventOptionModifiers
<span class="linenr">10052: </span>  }
<span class="linenr">10053: </span>}
<span class="linenr">10054: </span>
<span class="linenr">10055: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">原生 click 事件</span>
<span class="linenr">10056: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformClick</span> = (key, event) =&gt; {
<span class="linenr">10057: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isStaticClick</span> =
<span class=
"linenr">10058: </span>    isStaticExp(key) &amp;& key.content.toLowerCase() === <span class="org-string">'onclick'</span>
<span class="linenr">10059: </span>  <span class=
"org-keyword">return</span> isStaticClick
<span class=
"linenr">10060: </span>    ? createSimpleExpression(event, <span class="org-constant">true</span>)
<span class=
"linenr">10061: </span>    : key.type !== NodeTypes.SIMPLE_EXPRESSION
<span class="linenr">10062: </span>    ? createCompoundExpression([
<span class="linenr">10063: </span>        <span class=
"org-string">`(`</span>,
<span class="linenr">10064: </span>        key,
<span class="linenr">10065: </span>        <span class=
"org-string">`) === "onClick" ? "${event}" : (`</span>,
<span class="linenr">10066: </span>        key,
<span class="linenr">10067: </span>        <span class=
"org-string">`)`</span>
<span class="linenr">10068: </span>      ])
<span class="linenr">10069: </span>    : key
<span class="linenr">10070: </span>}
<span class="linenr">10071: </span>
<span class="linenr">10072: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformOnCD</span> = (dir, node, context) =&gt; {
<span class="linenr">10073: </span>  <span class=
"org-keyword">return</span> transformOn(dir, node, context, baseResult =&gt; {
<span class="linenr">10074: </span>    <span class=
"org-keyword">const</span> { modifiers } = dir
<span class="linenr">10075: </span>    <span class=
"org-keyword">if</span> (!modifiers.length) <span class=
"org-keyword">return</span> baseResult
<span class="linenr">10076: </span>
<span class="linenr">10077: </span>    <span class=
"org-keyword">let</span> { key, value: handlerExp } = baseResult.props[<span class="org-highlight-numbers-number">0</span>]
<span class="linenr">10078: </span>    <span class=
"org-keyword">const</span> { keyModifiers, nonKeyModifiers, eventOptionModifiers } =
<span class=
"linenr">10079: </span>      resolveModifiers(key, modifiers, context, dir.loc)
<span class="linenr">10080: </span>
<span class="linenr">10081: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">normalize click.right and click.middle since they don't actually fire</span>
<span class="linenr">10082: </span>    <span class=
"org-keyword">if</span> (nonKeyModifiers.includes(<span class=
"org-string">'right'</span>)) {
<span class=
"linenr">10083: </span>      key = transformClick(key, <span class=
"org-string">`onContextmenu`</span>)
<span class="linenr">10084: </span>    }
<span class="linenr">10085: </span>    <span class=
"org-keyword">if</span> (nonKeyModifiers.includes(<span class=
"org-string">'middle'</span>)) {
<span class=
"linenr">10086: </span>      key = transformClick(key, <span class=
"org-string">`onMouseup`</span>)
<span class="linenr">10087: </span>    }
<span class="linenr">10088: </span>
<span class="linenr">10089: </span>    <span class=
"org-keyword">if</span> (nonKeyModifiers.length) {
<span class=
"linenr">10090: </span>      handlerExp = createCallExpression(context.helper(V_ON_WITH_MODIFIERS), [
<span class="linenr">10091: </span>        handlerExp,
<span class=
"linenr">10092: </span>        JSON.stringify(nonKeyModifiers)
<span class="linenr">10093: </span>      ])
<span class="linenr">10094: </span>    }
<span class="linenr">10095: </span>
<span class="linenr">10096: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr">10097: </span>      keyModifiers.length &amp;&
<span class="linenr">10098: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if event name is dynamic, always wrap with keys guard</span>
<span class=
"linenr">10099: </span>      (!isStaticExp(key) || isKeyboardEvent(key.content))
<span class="linenr">10100: </span>    ) {
<span class=
"linenr">10101: </span>      handlerExp = createCallExpression(context.helper(V_ON_WITH_KEYS), [
<span class="linenr">10102: </span>        handlerExp,
<span class=
"linenr">10103: </span>        JSON.stringify(keyModifiers)
<span class="linenr">10104: </span>      ])
<span class="linenr">10105: </span>    }
<span class="linenr">10106: </span>
<span class="linenr">10107: </span>    <span class=
"org-keyword">if</span> (eventOptionModifiers.length) {
<span class="linenr">10108: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">modifierPostfix</span> = eventOptionModifiers.map(capitalize).join(<span class="org-string">''</span>)
<span class="linenr">10109: </span>      key = isStaticExp(key)
<span class=
"linenr">10110: </span>        ? createSimpleExpression(<span class="org-string">`${key.content}${modifierPostfix}`</span>, <span class="org-constant">true</span>)
<span class=
"linenr">10111: </span>        : createCompoundExpression([<span class="org-string">`(`</span>, key, <span class="org-string">`) + "${modifierPostfix}"`</span>])
<span class="linenr">10112: </span>    }
<span class="linenr">10113: </span>
<span class="linenr">10114: </span>    <span class=
"org-keyword">return</span> {
<span class=
"linenr">10115: </span>      props: [createObjectProperty(key, handlerExp)]
<span class="linenr">10116: </span>    }
<span class="linenr">10117: </span>  })
<span class="linenr">10118: </span>}
<span class="linenr">10119: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformShowCD</span> = (dir, node, context) =&gt; {
<span class="linenr">10120: </span>  <span class=
"org-keyword">const</span> { exp, loc } = dir
<span class="linenr">10121: </span>  <span class=
"org-keyword">if</span> (!exp) {
<span class="linenr">10122: </span>    logg(<span class=
"org-string">'transformShowCD no exp.'</span>)
<span class="linenr">10123: </span>  }
<span class="linenr">10124: </span>
<span class="linenr">10125: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr">10126: </span>    props: [],
<span class=
"linenr">10127: </span>    needRuntime: context.helper(V_SHOW)
<span class="linenr">10128: </span>  }
<span class="linenr">10129: </span>}
<span class="linenr">10130: </span> <span class=
"org-keyword">const</span> <span class=
"org-variable-name">StringifyThresholds</span> = {
<span class=
"linenr">10131: </span>   ELEMENT_WITH_BINDING_COUNT: <span class=
"org-highlight-numbers-number">5</span>,
<span class="linenr">10132: </span>   NODE_COUNT: <span class=
"org-highlight-numbers-number">20</span>
<span class="linenr">10133: </span>}
<span class="linenr">10134: </span>
<span class="linenr">10135: </span><span class="org-doc">/**</span>
<span class="linenr">10136: </span><span class=
"org-doc"> * Regex for replacing placeholders for embedded constant variables</span>
<span class="linenr">10137: </span><span class=
"org-doc"> * (e.g. import URL string constants generated by compiler-sfc)</span>
<span class="linenr">10138: </span><span class="org-doc"> */</span>
<span class="linenr">10139: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">expReplaceRE</span> = <span class=
"org-string">/__VUE_EXP_START__(.*?)__VUE_EXP_END__/</span>g
<span class="linenr">10140: </span>
<span class="linenr">10141: </span><span class="org-doc">/**</span>
<span class="linenr">10142: </span><span class=
"org-doc"> * Turn eligible hoisted static trees into stringified static nodes, e.g.</span>
<span class="linenr">10143: </span><span class="org-doc"> *</span>
<span class="linenr">10144: </span><span class=
"org-doc"> * ```js</span>
<span class="linenr">10145: </span><span class=
"org-doc"> * const _hoisted_1 = createStaticVNode(`&lt;div class="foo"&gt;bar&lt;/div&gt;`)</span>
<span class="linenr">10146: </span><span class=
"org-doc"> * ```</span>
<span class="linenr">10147: </span><span class="org-doc"> *</span>
<span class="linenr">10148: </span><span class=
"org-doc"> * A single static vnode can contain stringified content for **multiple**</span>
<span class="linenr">10149: </span><span class=
"org-doc"> * consecutive nodes (element and plain text), called a "chunk".</span>
<span class="linenr">10150: </span><span class=
"org-doc"> * `@vue/runtime-dom` will create the content via innerHTML in a hidden</span>
<span class="linenr">10151: </span><span class=
"org-doc"> * container element and insert all the nodes in place. The call must also</span>
<span class="linenr">10152: </span><span class=
"org-doc"> * provide the number of nodes contained in the chunk so that during hydration</span>
<span class="linenr">10153: </span><span class=
"org-doc"> * we can know how many nodes the static vnode should adopt.</span>
<span class="linenr">10154: </span><span class="org-doc"> *</span>
<span class="linenr">10155: </span><span class=
"org-doc"> * The optimization scans a children list that contains hoisted nodes, and</span>
<span class="linenr">10156: </span><span class=
"org-doc"> * tries to find the largest chunk of consecutive hoisted nodes before running</span>
<span class="linenr">10157: </span><span class=
"org-doc"> * into a non-hoisted node or the end of the list. A chunk is then converted</span>
<span class="linenr">10158: </span><span class=
"org-doc"> * into a single static vnode and replaces the hoisted expression of the first</span>
<span class="linenr">10159: </span><span class=
"org-doc"> * node in the chunk. Other nodes in the chunk are considered "merged" and</span>
<span class="linenr">10160: </span><span class=
"org-doc"> * therefore removed from both the hoist list and the children array.</span>
<span class="linenr">10161: </span><span class="org-doc"> *</span>
<span class="linenr">10162: </span><span class=
"org-doc"> * This optimization is only performed in Node.js.</span>
<span class="linenr">10163: </span><span class="org-doc"> */</span>
<span class="linenr">10164: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">stringifyStatic</span> = (children, context, parent) =&gt; {
<span class="linenr">10165: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">bail stringification for slot content</span>
<span class="linenr">10166: </span>  <span class=
"org-keyword">if</span> (context.scopes.vSlot &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr">10167: </span>    <span class=
"org-keyword">return</span>
<span class="linenr">10168: </span>  }
<span class="linenr">10169: </span>
<span class="linenr">10170: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">nc</span> = <span class=
"org-highlight-numbers-number">0</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">current node count</span>
<span class="linenr">10171: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">ec</span> = <span class=
"org-highlight-numbers-number">0</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">current element with binding count</span>
<span class="linenr">10172: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">currentChunk</span> = []
<span class="linenr">10173: </span>
<span class="linenr">10174: </span>  logg(<span class=
"org-string">`stringifyStatic - children.length = ${children.length}`</span>)
<span class="linenr">10175: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">stringifyCurrentChunk</span> = (currentIndex) =&gt; {
<span class="linenr">10176: </span>    <span class=
"org-keyword">if</span> (
<span class=
"linenr">10177: </span>      nc &gt;= StringifyThresholds.NODE_COUNT ||
<span class=
"linenr">10178: </span>      ec &gt;= StringifyThresholds.ELEMENT_WITH_BINDING_COUNT
<span class="linenr">10179: </span>    ) {
<span class="linenr">10180: </span>      logg(<span class=
"org-string">`stringifyCurrentChunk - index = ${currentIndex}`</span>)
<span class="linenr">10181: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">combine all currently eligible nodes into a single static vnode call</span>
<span class="linenr">10182: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">staticCall</span> = createCallExpression(context.helper(CREATE_STATIC), [
<span class="linenr">10183: </span>        JSON.stringify(
<span class=
"linenr">10184: </span>          currentChunk.map(node =&gt; stringifyNode(node, context)).join(<span class="org-string">''</span>)
<span class=
"linenr">10185: </span>        ).replace(expReplaceRE, <span class=
"org-string">`" + $1 + "`</span>),
<span class="linenr">10186: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the 2nd argument indicates the number of DOM nodes this static vnode</span>
<span class="linenr">10187: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">will insert / hydrate</span>
<span class=
"linenr">10188: </span>        String(currentChunk.length)
<span class="linenr">10189: </span>      ])
<span class="linenr">10190: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">replace the first node's hoisted expression with the static vnode call</span>
<span class=
"linenr">10191: </span>      replaceHoist(currentChunk[<span class=
"org-highlight-numbers-number">0</span>], staticCall, context)
<span class="linenr">10192: </span>
<span class="linenr">10193: </span>      <span class=
"org-keyword">if</span> (currentChunk.length &gt; <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr">10194: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">1</span>; i &lt; currentChunk.length; i++) {
<span class="linenr">10195: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for the merged nodes, set their hoisted expression to null</span>
<span class=
"linenr">10196: </span>          replaceHoist(currentChunk[i], <span class="org-constant">null</span>, context)
<span class="linenr">10197: </span>        }
<span class="linenr">10198: </span>
<span class="linenr">10199: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">also remove merged nodes from children</span>
<span class="linenr">10200: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">deleteCount</span> = currentChunk.length - <span class="org-highlight-numbers-number">1</span>
<span class=
"linenr">10201: </span>        children.splice(currentIndex - currentChunk.length + <span class="org-highlight-numbers-number">1</span>, deleteCount)
<span class="linenr">10202: </span>        <span class=
"org-keyword">return</span> deleteCount
<span class="linenr">10203: </span>      }
<span class="linenr">10204: </span>    }
<span class="linenr">10205: </span>    <span class=
"org-keyword">return</span> <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">10206: </span>  }
<span class="linenr">10207: </span>
<span class="linenr">10208: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">10209: </span>  <span class=
"org-keyword">for</span> (; i &lt; children.length; i++) {
<span class="linenr">10210: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = children[i]
<span class="linenr">10211: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hoisted</span> = getHoistedNode(child)
<span class="linenr">10212: </span>    <span class=
"org-keyword">if</span> (hoisted) {
<span class="linenr">10213: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">presence of hoisted means child must be a stringifiable node</span>
<span class="linenr">10214: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> = child
<span class="linenr">10215: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">result</span> = analyzeNode(node)
<span class="linenr">10216: </span>      <span class=
"org-keyword">if</span> (result) {
<span class="linenr">10217: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">node is stringifiable, record state</span>
<span class=
"linenr">10218: </span>        nc += result[<span class="org-highlight-numbers-number">0</span>]
<span class=
"linenr">10219: </span>        ec += result[<span class="org-highlight-numbers-number">1</span>]
<span class="linenr">10220: </span>        currentChunk.push(node)
<span class="linenr">10221: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr">10222: </span>      }
<span class="linenr">10223: </span>    }
<span class="linenr">10224: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we only reach here if we ran into a node that is not stringifiable</span>
<span class="linenr">10225: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check if currently analyzed nodes meet criteria for stringification.</span>
<span class="linenr">10226: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">adjust iteration index</span>
<span class=
"linenr">10227: </span>    i -= stringifyCurrentChunk(i)
<span class="linenr">10228: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">reset state</span>
<span class="linenr">10229: </span>    nc = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">10230: </span>    ec = <span class=
"org-highlight-numbers-number">0</span>
<span class=
"linenr">10231: </span>    currentChunk.length = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">10232: </span>  }
<span class="linenr">10233: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in case the last node was also stringifiable</span>
<span class="linenr">10234: </span>  stringifyCurrentChunk(i)
<span class="linenr">10235: </span>}
<span class="linenr">10236: </span>
<span class="linenr">10237: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">getHoistedNode</span> = (node) =&gt;
<span class=
"linenr">10238: </span>  ((node.type === NodeTypes.ELEMENT &amp;& node.tagType === ElementTypes.ELEMENT) ||
<span class=
"linenr">10239: </span>    node.type == NodeTypes.TEXT_CALL) &amp;&
<span class="linenr">10240: </span>  node.codegenNode &amp;&
<span class=
"linenr">10241: </span>  node.codegenNode.type === NodeTypes.SIMPLE_EXPRESSION &amp;&
<span class="linenr">10242: </span>  node.codegenNode.hoisted
<span class="linenr">10243: </span>
<span class="linenr">10244: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">dataAriaRE</span> = <span class=
"org-string">/^(data|aria)-/</span>
<span class="linenr">10245: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isStringifiableAttr</span> = (name, ns) =&gt; {
<span class="linenr">10246: </span>  <span class=
"org-keyword">return</span> (
<span class="linenr">10247: </span>    (ns === DOMNamespaces.HTML
<span class="linenr">10248: </span>      ? isKnownHtmlAttr(name)
<span class="linenr">10249: </span>      : ns === DOMNamespaces.SVG
<span class="linenr">10250: </span>      ? isKnownSvgAttr(name)
<span class="linenr">10251: </span>      : <span class=
"org-constant">false</span>) || dataAriaRE.test(name)
<span class="linenr">10252: </span>  )
<span class="linenr">10253: </span>}
<span class="linenr">10254: </span>
<span class="linenr">10255: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">replaceHoist</span> = (node,replacement,context) =&gt; {
<span class="linenr">10256: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hoistToReplace</span> = node.codegenNode.hoisted
<span class=
"linenr">10257: </span>  context.hoists[context.hoists.indexOf(hoistToReplace)] = replacement
<span class="linenr">10258: </span>}
<span class="linenr">10259: </span>
<span class="linenr">10260: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isNonStringifiable</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr">10261: </span>  <span class=
"org-string">`caption,thead,tr,th,tbody,td,tfoot,colgroup,col`</span>
<span class="linenr">10262: </span>)
<span class="linenr">10263: </span>
<span class="linenr">10264: </span><span class="org-doc">/**</span>
<span class="linenr">10265: </span><span class=
"org-doc"> * for a hoisted node, analyze it and return:</span>
<span class="linenr">10266: </span><span class=
"org-doc"> * - false: bailed (contains non-stringifiable props or runtime constant)</span>
<span class="linenr">10267: </span><span class=
"org-doc"> * - [nc, ec] where</span>
<span class="linenr">10268: </span><span class=
"org-doc"> *   - nc is the number of nodes inside</span>
<span class="linenr">10269: </span><span class=
"org-doc"> *   - ec is the number of element with bindings inside</span>
<span class="linenr">10270: </span><span class="org-doc"> */</span>
<span class="linenr">10271: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">analyzeNode</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">10272: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.ELEMENT &amp;& isNonStringifiable(node.tag)) {
<span class="linenr">10273: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">10274: </span>  }
<span class="linenr">10275: </span>
<span class="linenr">10276: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.TEXT_CALL) {
<span class="linenr">10277: </span>    <span class=
"org-keyword">return</span> [<span class=
"org-highlight-numbers-number">1</span>, <span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr">10278: </span>  }
<span class="linenr">10279: </span>
<span class="linenr">10280: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">nc</span> = <span class=
"org-highlight-numbers-number">1</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">node count</span>
<span class="linenr">10281: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">ec</span> = node.props.length &gt; <span class=
"org-highlight-numbers-number">0</span> ? <span class=
"org-highlight-numbers-number">1</span> : <span class=
"org-highlight-numbers-number">0</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">element w/ binding count</span>
<span class="linenr">10282: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">bailed</span> = <span class=
"org-constant">false</span>
<span class="linenr">10283: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bail</span> = () =&gt; {
<span class="linenr">10284: </span>    bailed = <span class=
"org-constant">true</span>
<span class="linenr">10285: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">10286: </span>  }
<span class="linenr">10287: </span>
<span class="linenr">10288: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO:</span></span></span><span class=
"org-comment"> check for cases where using innerHTML will result in different</span>
<span class="linenr">10289: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">output compared to imperative node insertions.</span>
<span class="linenr">10290: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">probably only need to check for most common case</span>
<span class="linenr">10291: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">i.e. non-phrasing-content tags inside `&lt;p&gt;`</span>
<span class="linenr">10292: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">walk</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">10293: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr">10294: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = node.props[i]
<span class="linenr">10295: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">bail on non-attr bindings</span>
<span class="linenr">10296: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr">10297: </span>        p.type === NodeTypes.ATTRIBUTE &amp;&
<span class=
"linenr">10298: </span>        !isStringifiableAttr(p.name, node.ns)
<span class="linenr">10299: </span>      ) {
<span class="linenr">10300: </span>        <span class=
"org-keyword">return</span> bail()
<span class="linenr">10301: </span>      }
<span class="linenr">10302: </span>      <span class=
"org-keyword">if</span> (p.type === NodeTypes.DIRECTIVE &amp;& p.name === <span class="org-string">'bind'</span>) {
<span class="linenr">10303: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">bail on non-attr bindings</span>
<span class="linenr">10304: </span>        <span class=
"org-keyword">if</span> (
<span class="linenr">10305: </span>          p.arg &amp;&
<span class=
"linenr">10306: </span>          (p.arg.type === NodeTypes.COMPOUND_EXPRESSION ||
<span class=
"linenr">10307: </span>            (p.arg.isStatic &amp;& !isStringifiableAttr(p.arg.content, node.ns)))
<span class="linenr">10308: </span>        ) {
<span class="linenr">10309: </span>          <span class=
"org-keyword">return</span> bail()
<span class="linenr">10310: </span>        }
<span class="linenr">10311: </span>        <span class=
"org-keyword">if</span> (
<span class="linenr">10312: </span>          p.exp &amp;&
<span class=
"linenr">10313: </span>          (p.exp.type === NodeTypes.COMPOUND_EXPRESSION ||
<span class=
"linenr">10314: </span>            p.exp.constType &lt; ConstantTypes.CAN_STRINGIFY)
<span class="linenr">10315: </span>        ) {
<span class="linenr">10316: </span>          <span class=
"org-keyword">return</span> bail()
<span class="linenr">10317: </span>        }
<span class="linenr">10318: </span>      }
<span class="linenr">10319: </span>    }
<span class="linenr">10320: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.children.length; i++) {
<span class="linenr">10321: </span>      nc++
<span class="linenr">10322: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = node.children[i]
<span class="linenr">10323: </span>      <span class=
"org-keyword">if</span> (child.type === NodeTypes.ELEMENT) {
<span class="linenr">10324: </span>        <span class=
"org-keyword">if</span> (child.props.length &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr">10325: </span>          ec++
<span class="linenr">10326: </span>        }
<span class="linenr">10327: </span>        walk(child)
<span class="linenr">10328: </span>        <span class=
"org-keyword">if</span> (bailed) {
<span class="linenr">10329: </span>          <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">10330: </span>        }
<span class="linenr">10331: </span>      }
<span class="linenr">10332: </span>    }
<span class="linenr">10333: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">10334: </span>  }
<span class="linenr">10335: </span>
<span class="linenr">10336: </span>  <span class=
"org-keyword">return</span> walk(node) ? [nc, ec] : <span class=
"org-constant">false</span>
<span class="linenr">10337: </span>}
<span class="linenr">10338: </span>
<span class="linenr">10339: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">stringifyNode</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr">10340: </span>  <span class=
"org-keyword">if</span> (isString(node)) {
<span class="linenr">10341: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr">10342: </span>  }
<span class="linenr">10343: </span>  <span class=
"org-keyword">if</span> (isSymbol(node)) {
<span class="linenr">10344: </span>    <span class=
"org-keyword">return</span> <span class="org-string">``</span>
<span class="linenr">10345: </span>  }
<span class="linenr">10346: </span>  <span class=
"org-keyword">switch</span> (node.type) {
<span class="linenr">10347: </span>    <span class=
"org-keyword">case</span> NodeTypes.ELEMENT:
<span class="linenr">10348: </span>      <span class=
"org-keyword">return</span> stringifyElement(node, context)
<span class="linenr">10349: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT:
<span class="linenr">10350: </span>      <span class=
"org-keyword">return</span> escapeHtml(node.content)
<span class="linenr">10351: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMMENT:
<span class="linenr">10352: </span>      <span class=
"org-keyword">return</span> <span class=
"org-string">`&lt;!--${escapeHtml(node.content)}--&gt;`</span>
<span class="linenr">10353: </span>    <span class=
"org-keyword">case</span> NodeTypes.INTERPOLATION:
<span class="linenr">10354: </span>      <span class=
"org-keyword">return</span> escapeHtml(toDisplayString(evaluateConstant(node.content)))
<span class="linenr">10355: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMPOUND_EXPRESSION:
<span class="linenr">10356: </span>      <span class=
"org-keyword">return</span> escapeHtml(evaluateConstant(node))
<span class="linenr">10357: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT_CALL:
<span class="linenr">10358: </span>      <span class=
"org-keyword">return</span> stringifyNode(node.content, context)
<span class="linenr">10359: </span>    <span class=
"org-keyword">default</span>:
<span class="linenr">10360: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">static trees will not contain if/for nodes</span>
<span class="linenr">10361: </span>      <span class=
"org-keyword">return</span> <span class="org-string">''</span>
<span class="linenr">10362: </span>  }
<span class="linenr">10363: </span>}
<span class="linenr">10364: </span>
<span class="linenr">10365: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">stringifyElement</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr">10366: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">res</span> = <span class=
"org-string">`&lt;${node.tag}`</span>
<span class="linenr">10367: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr">10368: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = node.props[i]
<span class="linenr">10369: </span>    <span class=
"org-keyword">if</span> (p.type === NodeTypes.ATTRIBUTE) {
<span class="linenr">10370: </span>      res += <span class=
"org-string">` ${p.name}`</span>
<span class="linenr">10371: </span>      <span class=
"org-keyword">if</span> (p.value) {
<span class="linenr">10372: </span>        res += <span class=
"org-string">`="${escapeHtml(p.value.content)}"`</span>
<span class="linenr">10373: </span>      }
<span class="linenr">10374: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.type === NodeTypes.DIRECTIVE &amp;& p.name === <span class="org-string">'bind'</span>) {
<span class="linenr">10375: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exp</span> = p.exp
<span class="linenr">10376: </span>      <span class=
"org-keyword">if</span> (exp.content[<span class=
"org-highlight-numbers-number">0</span>] === <span class=
"org-string">'_'</span>) {
<span class="linenr">10377: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">internally generated string constant references</span>
<span class="linenr">10378: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">e.g. imported URL strings via compiler-sfc transformAssetUrl plugin</span>
<span class="linenr">10379: </span>        res += <span class=
"org-string">` ${p.arg.content}="__VUE_EXP_START__${</span>
<span class="linenr">10380: </span><span class=
"org-string">          exp.content</span>
<span class="linenr">10381: </span><span class=
"org-string">        }__VUE_EXP_END__"`</span>
<span class="linenr">10382: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr">10383: </span>      }
<span class="linenr">10384: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">constant v-bind, e.g. :foo="1"</span>
<span class="linenr">10385: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">evaluated</span> = evaluateConstant(exp)
<span class="linenr">10386: </span>      <span class=
"org-keyword">if</span> (evaluated != <span class=
"org-constant">null</span>) {
<span class="linenr">10387: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">arg</span> = p.arg &amp;& p.arg.content
<span class="linenr">10388: </span>        <span class=
"org-keyword">if</span> (arg === <span class=
"org-string">'class'</span>) {
<span class=
"linenr">10389: </span>          evaluated = normalizeClass(evaluated)
<span class="linenr">10390: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (arg === <span class=
"org-string">'style'</span>) {
<span class=
"linenr">10391: </span>          evaluated = stringifyStyle(normalizeStyle(evaluated))
<span class="linenr">10392: </span>        }
<span class="linenr">10393: </span>        res += <span class=
"org-string">` ${p.arg.content}="${escapeHtml(evaluated)}"`</span>
<span class="linenr">10394: </span>      }
<span class="linenr">10395: </span>    }
<span class="linenr">10396: </span>  }
<span class="linenr">10397: </span>  <span class=
"org-keyword">if</span> (context.scopeId) {
<span class="linenr">10398: </span>    res += <span class=
"org-string">` ${context.scopeId}`</span>
<span class="linenr">10399: </span>  }
<span class="linenr">10400: </span>  res += <span class=
"org-string">`&gt;`</span>
<span class="linenr">10401: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.children.length; i++) {
<span class=
"linenr">10402: </span>    res += stringifyNode(node.children[i], context)
<span class="linenr">10403: </span>  }
<span class="linenr">10404: </span>  <span class=
"org-keyword">if</span> (!isVoidTag(node.tag)) {
<span class="linenr">10405: </span>    res += <span class=
"org-string">`&lt;/${node.tag}&gt;`</span>
<span class="linenr">10406: </span>  }
<span class="linenr">10407: </span>  <span class=
"org-keyword">return</span> res
<span class="linenr">10408: </span>}
<span class="linenr">10409: </span>
<span class="linenr">10410: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">__UNSAFE__</span>
<span class="linenr">10411: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Reason: eval.</span>
<span class="linenr">10412: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">It's technically safe to eval because only constant expressions are possible</span>
<span class="linenr">10413: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">here, e.g. `{{ 1 }}` or `{{ 'foo' }}`</span>
<span class="linenr">10414: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in addition, constant exps bail on presence of parens so you can't even</span>
<span class="linenr">10415: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">run JSFuck in here. But we mark it unsafe for security review purposes.</span>
<span class="linenr">10416: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">(see compiler-core/src/transformExpressions)</span>
<span class="linenr">10417: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">evaluateConstant</span>(<span class=
"org-variable-name">exp</span>) {
<span class="linenr">10418: </span>  <span class=
"org-keyword">if</span> (exp.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr">10419: </span>    <span class=
"org-keyword">return</span> <span class=
"org-keyword">new</span> <span class=
"org-type">Function</span>(<span class=
"org-string">`return ${exp.content}`</span>)()
<span class="linenr">10420: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">10421: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">compound</span>
<span class="linenr">10422: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">res</span> = <span class="org-string">``</span>
<span class=
"linenr">10423: </span>    exp.children.forEach(c =&gt; {
<span class="linenr">10424: </span>      <span class=
"org-keyword">if</span> (isString(c) || isSymbol(c)) {
<span class="linenr">10425: </span>        <span class=
"org-keyword">return</span>
<span class="linenr">10426: </span>      }
<span class="linenr">10427: </span>      <span class=
"org-keyword">if</span> (c.type === NodeTypes.TEXT) {
<span class="linenr">10428: </span>        res += c.content
<span class="linenr">10429: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (c.type === NodeTypes.INTERPOLATION) {
<span class=
"linenr">10430: </span>        res += toDisplayString(evaluateConstant(c.content))
<span class="linenr">10431: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr">10432: </span>        res += evaluateConstant(c)
<span class="linenr">10433: </span>      }
<span class="linenr">10434: </span>    })
<span class="linenr">10435: </span>    <span class=
"org-keyword">return</span> res
<span class="linenr">10436: </span>  }
<span class="linenr">10437: </span>}
<span class="linenr">10438: </span>
<span class="linenr">10439: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">DOMDirectiveTransforms</span> = {
<span class="linenr">10440: </span>  cloak: noopDirectiveTransform,
<span class="linenr">10441: </span>  html: transformVHtml,
<span class="linenr">10442: </span>  text: transformVText,
<span class=
"linenr">10443: </span>  model: transformModelCD, <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">override compiler-core</span>
<span class=
"linenr">10444: </span>  on: transformOnCD, <span class="org-comment-delimiter">// </span><span class="org-comment">override compiler-core</span>
<span class="linenr">10445: </span>  show: transformShowCD
<span class="linenr">10446: </span>}
<span class="linenr">10447: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">DOMNodeTransforms</span> = [
<span class="linenr">10448: </span>  transformStyleCD,
<span class=
"linenr">10449: </span>  ...(__DEV__ ? [warnTransitionChildren] : [])
<span class="linenr">10450: </span>]
<span class="linenr">10451: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">compile</span>(<span class=
"org-variable-name">template</span>, <span class=
"org-variable-name">options</span> = {}) {
<span class="linenr">10452: </span>  <span class=
"org-keyword">return</span> baseCompile(
<span class="linenr">10453: </span>    template,
<span class=
"linenr">10454: </span>    extend({}, parserOptions, options, {
<span class="linenr">10455: </span>      nodeTransforms: [
<span class="linenr">10456: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">ignore &lt;script&gt; and &lt;tag&gt;</span>
<span class="linenr">10457: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">this is not put inside DOMNodeTransforms because that list is used</span>
<span class="linenr">10458: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">by compiler-ssr to generate vnode fallback branches</span>
<span class="linenr">10459: </span>        ignoreSideEffectTags,
<span class="linenr">10460: </span>        ...DOMNodeTransforms,
<span class=
"linenr">10461: </span>        ...(options.nodeTransforms || [])
<span class="linenr">10462: </span>      ],
<span class=
"linenr">10463: </span>      directiveTransforms: extend(
<span class="linenr">10464: </span>        {},
<span class="linenr">10465: </span>        DOMDirectiveTransforms,
<span class=
"linenr">10466: </span>        options.directiveTransforms || {}
<span class="linenr">10467: </span>      ),
<span class=
"linenr">10468: </span>      transformHoist: __BROWSER__ ? <span class="org-constant">null</span> : stringifyStatic
<span class="linenr">10469: </span>    })
<span class="linenr">10470: </span>  )
<span class="linenr">10471: </span>}
<span class="linenr">10472: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parse</span>(<span class=
"org-variable-name">template</span>, <span class=
"org-variable-name">options</span> = {}) {
<span class="linenr">10473: </span>  <span class=
"org-keyword">return</span> baseParse(template, extend({}, parserOptions, options))
<span class="linenr">10474: </span>}
</pre>
      </div>
    </details><br>
    <details class="code-details" style=
    "padding: 1em; background-color: #e5f5e5; /* background-color: pink; */ border-radius: 15px; color: hsl(157 75%); font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;">
      <summary>
        <strong><font face="Courier" size="3" color=
        "green">compiler-sfc</font></strong>
      </summary>
      <div class="org-src-container">
        <pre class="src src-js"><span class=
        "linenr">    1: </span><span class=
        "org-keyword">let</span> <span class=
        "org-variable-name">__BROWSER__</span> = <span class=
        "org-keyword">typeof</span> window !== <span class=
        "org-string">'undefined'</span>
<span class="linenr">    2: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">logs</span> = {}, <span class=
"org-variable-name">currentLogKey</span> = <span class=
"org-string">'cc'</span>
<span class="linenr">    3: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">w</span> = {}
<span class="linenr">    4: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">debugEle</span> = <span class=
"org-constant">null</span>
<span class="linenr">    5: </span><span class=
"org-keyword">if</span> (__BROWSER__) {
<span class="linenr">    6: </span>  w = <span class=
"org-keyword">typeof</span> window !== <span class=
"org-string">'undefined'</span> ? window : {}
<span class="linenr">    7: </span>}
<span class=
"linenr">    8: </span>w.log = (msg, isLine = <span class=
"org-constant">false</span>) =&gt; {
<span class="linenr">    9: </span>  <span class=
"org-keyword">if</span> (debugEle) {
<span class="linenr">   10: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">cls</span> = [<span class=
"org-string">'debug'</span>, isLine ? <span class=
"org-string">'line'</span> : <span class=
"org-string">''</span>].filter(Boolen)
<span class="linenr">   11: </span>    ele.innerHTML = <span class=
"org-string">`${debugEl.innerHTML}&lt;pre class="${cls.join(' ')}"&gt;&lt;code&gt;${</span>
<span class="linenr">   12: </span><span class=
"org-string">      typeof msg === 'object' ? syntaxHighlight(msg) : msg</span>
<span class="linenr">   13: </span><span class=
"org-string">    }&lt;/code&gt;&lt;/pre&gt;`</span>
<span class="linenr">   14: </span>    <span class=
"org-keyword">return</span> ele.innerHTML
<span class="linenr">   15: </span>  }
<span class="linenr">   16: </span>}
<span class="linenr">   17: </span>
<span class="linenr">   18: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">syntaxHighlight</span>(<span class=
"org-variable-name">json</span>) {
<span class="linenr">   19: </span>  <span class=
"org-keyword">if</span> (<span class=
"org-keyword">typeof</span> json != <span class=
"org-string">'string'</span>) {
<span class=
"linenr">   20: </span>    json = JSON.stringify(json, <span class=
"org-constant">undefined</span>, <span class=
"org-highlight-numbers-number">2</span>)
<span class="linenr">   21: </span>  }
<span class=
"linenr">   22: </span>  json = json.replace(<span class=
"org-string">/&amp;/</span>g, <span class=
"org-string">'&amp;amp;'</span>).replace(<span class=
"org-string">/&lt;/</span>g, <span class=
"org-string">'&amp;lt;'</span>).replace(<span class=
"org-string">/&gt;/</span>g, <span class=
"org-string">'&amp;gt;'</span>)
<span class="linenr">   23: </span>  <span class=
"org-keyword">return</span> json.replace(
<span class="linenr">   24: </span>    <span class=
"org-string">/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/</span>g,
<span class="linenr">   25: </span>    <span class=
"org-keyword">function</span> (<span class=
"org-variable-name">match</span>) {
<span class="linenr">   26: </span>      <span class=
"org-keyword">var</span> <span class=
"org-variable-name">cls</span> = <span class=
"org-string">'number'</span>
<span class="linenr">   27: </span>      <span class=
"org-keyword">if</span> (<span class=
"org-string">/^"/</span>.test(match)) {
<span class="linenr">   28: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-string">/:$/</span>.test(match)) {
<span class="linenr">   29: </span>          cls = <span class=
"org-string">'key'</span>
<span class="linenr">   30: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr">   31: </span>          cls = <span class=
"org-string">'string'</span>
<span class="linenr">   32: </span>        }
<span class="linenr">   33: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-string">/true|false/</span>.test(match)) {
<span class="linenr">   34: </span>        cls = <span class=
"org-string">'boolean'</span>
<span class="linenr">   35: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-string">/null/</span>.test(match)) {
<span class="linenr">   36: </span>        cls = <span class=
"org-string">'null'</span>
<span class="linenr">   37: </span>      }
<span class="linenr">   38: </span>      <span class=
"org-keyword">return</span> <span class=
"org-string">'&lt;span class="'</span> + cls + <span class=
"org-string">'"&gt;'</span> + match + <span class=
"org-string">'&lt;/span&gt;'</span>
<span class="linenr">   39: </span>    }
<span class="linenr">   40: </span>  )
<span class="linenr">   41: </span>}
<span class="linenr">   42: </span>
<span class="linenr">   43: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">babelParser</span>
<span class="linenr">   44: </span><span class=
"org-keyword">if</span> (!__BROWSER__) {
<span class=
"linenr">   45: </span>  babelParser = require(process.env.NODE_LIB + <span class="org-string">'/@babel/parser'</span>)
<span class="linenr">   46: </span>}
<span class="linenr">   47: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">The default decoder only provides escapes for characters reserved as part of</span>
<span class="linenr">   48: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the template syntax, and is only used if the custom renderer did not provide</span>
<span class="linenr">   49: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">a platform-specific decoder.</span>
<span class="linenr">   50: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">decodeRE</span> = <span class=
"org-string">/&amp;(gt|lt|amp|apos|quot);/</span>g
<span class="linenr">   51: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">decodeMap</span> = {
<span class="linenr">   52: </span>  gt: <span class=
"org-string">'&gt;'</span>,
<span class="linenr">   53: </span>  lt: <span class=
"org-string">'&lt;'</span>,
<span class="linenr">   54: </span>  amp: <span class=
"org-string">'&amp;'</span>,
<span class="linenr">   55: </span>  apos: <span class=
"org-string">"'"</span>,
<span class="linenr">   56: </span>  quot: <span class=
"org-string">'"'</span>
<span class="linenr">   57: </span>}
<span class="linenr">   58: </span>
<span class="linenr">   59: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">EMPTY_OBJ</span> = {}
<span class="linenr">   60: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">NO</span> = () =&gt; <span class=
"org-constant">false</span>
<span class="linenr">   61: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">NOOP</span> = () =&gt; {}
<span class="linenr">   62: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">locStub</span> = {
<span class="linenr">   63: </span>  source: <span class=
"org-string">''</span>,
<span class="linenr">   64: </span>  start: { line: <span class=
"org-highlight-numbers-number">1</span>, column: <span class=
"org-highlight-numbers-number">1</span>, offset: <span class=
"org-highlight-numbers-number">0</span> },
<span class="linenr">   65: </span>  end: { line: <span class=
"org-highlight-numbers-number">1</span>, column: <span class=
"org-highlight-numbers-number">1</span>, offset: <span class=
"org-highlight-numbers-number">0</span> }
<span class="linenr">   66: </span>}
<span class="linenr">   67: </span>
<span class="linenr">   68: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">ConstantTypes</span> = {
<span class="linenr">   69: </span>  NOT_CONSTANT: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr">   70: </span>  CAN_SKIP_PATCH: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr">   71: </span>  CAN_HOIST: <span class=
"org-highlight-numbers-number">2</span>,
<span class="linenr">   72: </span>  CAN_STRINGIFY: <span class=
"org-highlight-numbers-number">3</span>
<span class="linenr">   73: </span>}
<span class="linenr">   74: </span>
<span class="linenr">   75: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">ElementTypes</span> = {
<span class="linenr">   76: </span>  ELEMENT: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr">   77: </span>  COMPONENT: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr">   78: </span>  SLOT: <span class=
"org-highlight-numbers-number">2</span>,
<span class="linenr">   79: </span>  TEMPLATE: <span class=
"org-highlight-numbers-number">3</span>
<span class="linenr">   80: </span>}
<span class="linenr">   81: </span>
<span class="linenr">   82: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">Namespaces</span> = {
<span class="linenr">   83: </span>  HTML: <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">   84: </span>}
<span class="linenr">   85: </span>
<span class="linenr">   86: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">NodeTypes</span> = {
<span class="linenr">   87: </span>  ROOT: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr">   88: </span>  ELEMENT: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr">   89: </span>  TEXT: <span class=
"org-highlight-numbers-number">2</span>,
<span class="linenr">   90: </span>  COMMENT: <span class=
"org-highlight-numbers-number">3</span>,
<span class=
"linenr">   91: </span>  SIMPLE_EXPRESSION: <span class="org-highlight-numbers-number">4</span>,
<span class="linenr">   92: </span>  INTERPOLATION: <span class=
"org-highlight-numbers-number">5</span>,
<span class="linenr">   93: </span>  ATTRIBUTE: <span class=
"org-highlight-numbers-number">6</span>,
<span class="linenr">   94: </span>  DIRECTIVE: <span class=
"org-highlight-numbers-number">7</span>,
<span class="linenr">   95: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">containers</span>
<span class=
"linenr">   96: </span>  COMPOUND_EXPRESSION: <span class=
"org-highlight-numbers-number">8</span>,
<span class="linenr">   97: </span>  IF: <span class=
"org-highlight-numbers-number">9</span>,
<span class="linenr">   98: </span>  IF_BRANCH: <span class=
"org-highlight-numbers-number">10</span>,
<span class="linenr">   99: </span>  FOR: <span class=
"org-highlight-numbers-number">11</span>,
<span class="linenr">  100: </span>  TEXT_CALL: <span class=
"org-highlight-numbers-number">12</span>,
<span class="linenr">  101: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">codegen</span>
<span class="linenr">  102: </span>  VNODE_CALL: <span class=
"org-highlight-numbers-number">13</span>,
<span class=
"linenr">  103: </span>  JS_CALL_EXPRESSION: <span class=
"org-highlight-numbers-number">14</span>,
<span class=
"linenr">  104: </span>  JS_OBJECT_EXPRESSION: <span class=
"org-highlight-numbers-number">15</span>,
<span class="linenr">  105: </span>  JS_PROPERTY: <span class=
"org-highlight-numbers-number">16</span>,
<span class=
"linenr">  106: </span>  JS_ARRAY_EXPRESSION: <span class=
"org-highlight-numbers-number">17</span>,
<span class=
"linenr">  107: </span>  JS_FUNCTION_EXPRESSION: <span class=
"org-highlight-numbers-number">18</span>,
<span class=
"linenr">  108: </span>  JS_CONDITIONAL_EXPRESSION: <span class=
"org-highlight-numbers-number">19</span>,
<span class=
"linenr">  109: </span>  JS_CACHE_EXPRESSION: <span class=
"org-highlight-numbers-number">20</span>,
<span class="linenr">  110: </span>
<span class="linenr">  111: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">ssr codegen</span>
<span class=
"linenr">  112: </span>  JS_BLOCK_STATEMENT: <span class=
"org-highlight-numbers-number">21</span>,
<span class=
"linenr">  113: </span>  JS_TEMPLATE_LITERAL: <span class=
"org-highlight-numbers-number">22</span>,
<span class="linenr">  114: </span>  JS_IF_STATEMENT: <span class=
"org-highlight-numbers-number">23</span>,
<span class=
"linenr">  115: </span>  JS_ASSIGNMENT_EXPRESSION: <span class=
"org-highlight-numbers-number">24</span>,
<span class=
"linenr">  116: </span>  JS_SEQUENCE_EXPRESSION: <span class=
"org-highlight-numbers-number">25</span>,
<span class=
"linenr">  117: </span>  JS_RETURN_STATEMENT: <span class=
"org-highlight-numbers-number">26</span>
<span class="linenr">  118: </span>}
<span class="linenr">  119: </span>
<span class="linenr">  120: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">__DEV__</span> = <span class=
"org-constant">true</span>
<span class="linenr">  121: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">defaultParserOptions</span> = {
<span class="linenr">  122: </span>  delimiters: [<span class=
"org-string">`{{`</span>, <span class="org-string">`}}`</span>],
<span class=
"linenr">  123: </span>  getNamespace: () =&gt; Namespaces.HTML,
<span class=
"linenr">  124: </span>  getTextMode: () =&gt; TextModes.DATA,
<span class="linenr">  125: </span>  isVoidTag: NO,
<span class="linenr">  126: </span>  isPreTag: NO,
<span class="linenr">  127: </span>  isCustomElement: NO,
<span class=
"linenr">  128: </span>  decodeEntities: (rawText) =&gt; rawText.replace(decodeRE, (_, p1) =&gt; decodeMap[p1]),
<span class="linenr">  129: </span>  onError: defaultOnError,
<span class="linenr">  130: </span>  onWarn: defaultOnWarn,
<span class="linenr">  131: </span>  comments: __DEV__
<span class="linenr">  132: </span>}
<span class="linenr">  133: </span>
<span class="linenr">  134: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TagType</span> = {
<span class="linenr">  135: </span>  Start: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr">  136: </span>  End: <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr">  137: </span>}
<span class="linenr">  138: </span>
<span class="linenr">  139: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TextModes</span> = {
<span class="linenr">  140: </span>  DATA: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr">  141: </span>  RCDATA: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr">  142: </span>  RAWTEXT: <span class=
"org-highlight-numbers-number">2</span>,
<span class="linenr">  143: </span>  CDATA: <span class=
"org-highlight-numbers-number">3</span>,
<span class="linenr">  144: </span>  ATTRIBUTE_VALUE: <span class=
"org-highlight-numbers-number">4</span>
<span class="linenr">  145: </span>}
<span class="linenr">  146: </span>
<span class="linenr">  147: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">debugOn</span> = <span class=
"org-constant">true</span>
<span class="linenr">  148: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">log</span> = (fn, message) =&gt; {
<span class="linenr">  149: </span>  <span class=
"org-keyword">if</span> (debugOn) {
<span class="linenr">  150: </span>    <span class=
"org-keyword">if</span> (message === <span class=
"org-constant">undefined</span>) {
<span class="linenr">  151: </span>      console.log(fn)
<span class="linenr">  152: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">  153: </span>      console.log(<span class=
"org-string">`[${fn}] ${message}`</span>)
<span class="linenr">  154: </span>    }
<span class="linenr">  155: </span>  }
<span class="linenr">  156: </span>}
<span class="linenr">  157: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">logOn</span> = () =&gt; (debugOn = <span class=
"org-constant">true</span>)
<span class="linenr">  158: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">logOff</span> = () =&gt; (debugOn = <span class="org-constant">false</span>)
<span class="linenr">  159: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">logEnd</span> = (hint = <span class=
"org-string">"END"</span>) =&gt; {
<span class="linenr">  160: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">m</span> = <span class=
"org-string">`--------- ${hint} ---------`</span>
<span class="linenr">  161: </span>  <span class=
"org-keyword">if</span> (debugOn)
<span class="linenr">  162: </span>    pushLog(m, <span class=
"org-string">'title'</span>)
<span class="linenr">  163: </span>  <span class=
"org-keyword">return</span> m
<span class="linenr">  164: </span>}
<span class="linenr">  165: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">logBr</span> = () =&gt; console.log(<span class="org-string">"\n"</span>)
<span class="linenr">  166: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">debugTraverseOn</span> = <span class=
"org-constant">false</span>
<span class="linenr">  167: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">logTraverseOn</span> = () =&gt; (debugTraverseOn=<span class="org-constant">true</span>)
<span class="linenr">  168: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">logTraverseOff</span> = () =&gt; (debugTraverseOn=<span class="org-constant">false</span>)
<span class="linenr">  169: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">logg</span> = ( hint, ...msg ) =&gt; {
<span class="linenr">  170: </span>  <span class=
"org-keyword">if</span> (!debugTraverseOn &amp;& hint === <span class="org-string">'traverseNode'</span>) <span class="org-keyword">return</span>
<span class="linenr">  171: </span>  <span class=
"org-keyword">if</span> (debugOn) {
<span class="linenr">  172: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">m</span> = logEnd(hint)
<span class=
"linenr">  173: </span>    msg.forEach((m) =&gt; pushLog(m))
<span class="linenr">  174: </span>  }
<span class="linenr">  175: </span>}
<span class="linenr">  176: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">pushLog</span>(<span class=
"org-variable-name">m</span>, <span class=
"org-variable-name">type</span> = <span class=
"org-string">'normal'</span>) {
<span class=
"linenr">  177: </span>  ;( logs[currentLogKey] || (logs[currentLogKey] = [])).push({ value: m, type })
<span class="linenr">  178: </span>  log(m)
<span class="linenr">  179: </span>}
<span class="linenr">  180: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">clearLog</span>(<span class=
"org-variable-name">key</span>) {
<span class="linenr">  181: </span>  <span class=
"org-keyword">if</span> (key) {
<span class="linenr">  182: </span>    logs[key] = []
<span class="linenr">  183: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">  184: </span>    logs = {}
<span class="linenr">  185: </span>  }
<span class="linenr">  186: </span>}
<span class="linenr">  187: </span>
<span class="linenr">  188: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">extend</span> = Object.assign
<span class="linenr">  189: </span>
<span class="linenr">  190: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">defaultOnError</span>(<span class=
"org-variable-name">error</span>) {
<span class="linenr">  191: </span>  <span class=
"org-keyword">throw</span> error
<span class="linenr">  192: </span>}
<span class="linenr">  193: </span>
<span class="linenr">  194: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">defaultOnWarn</span>(<span class=
"org-variable-name">msg</span>) {
<span class=
"linenr">  195: </span>  __DEV__ &amp;& console.warn(<span class=
"org-string">`[Vue warn] ${msg.message}`</span>)
<span class="linenr">  196: </span>}
<span class="linenr">  197: </span>
<span class="linenr">  198: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">makeMap</span>(<span class=
"org-variable-name">str</span>, <span class=
"org-variable-name">expectsLowerCase</span>) {
<span class="linenr">  199: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">map</span> = Object.create(<span class=
"org-constant">null</span>)
<span class="linenr">  200: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">list</span> = str.split(<span class=
"org-string">','</span>)
<span class="linenr">  201: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; list.length; i++) {
<span class="linenr">  202: </span>    map[list[i]] = <span class=
"org-constant">true</span>
<span class="linenr">  203: </span>  }
<span class="linenr">  204: </span>  <span class=
"org-keyword">return</span> expectsLowerCase ? val =&gt; !!map[val.toLowerCase()] : val =&gt; !!map[val]
<span class="linenr">  205: </span>}
<span class="linenr">  206: </span>
<span class="linenr">  207: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">hasOwnProperty</span> = Object.<span class=
"org-constant">prototype</span>.hasOwnProperty
<span class="linenr">  208: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">hasOwn</span> = (val, key) =&gt; hasOwnProperty.call(val, key)
<span class="linenr">  209: </span>
<span class="linenr">  210: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isArray</span> = Array.isArray
<span class="linenr">  211: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isMap</span> = (val) =&gt; toTypeString(val) === <span class="org-string">'[object Map]'</span>
<span class="linenr">  212: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSet</span> = (val) =&gt; toTypeString(val) === <span class="org-string">'[object Set]'</span>
<span class="linenr">  213: </span>
<span class="linenr">  214: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDate</span> = (val) =&gt; val <span class=
"org-keyword">instanceof</span> <span class="org-type">Date</span>
<span class="linenr">  215: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isFunction</span> = (val) =&gt; <span class=
"org-keyword">typeof</span> val === <span class=
"org-string">'function'</span>
<span class="linenr">  216: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isString</span> = (val) =&gt; <span class=
"org-keyword">typeof</span> val === <span class=
"org-string">'string'</span>
<span class="linenr">  217: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSymbol</span> = (val) =&gt; <span class=
"org-keyword">typeof</span> val === <span class=
"org-string">'symbol'</span>
<span class="linenr">  218: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isObject</span> = (val) =&gt; val !== <span class="org-constant">null</span> &amp;& <span class="org-keyword">typeof</span> val === <span class="org-string">'object'</span>
<span class="linenr">  219: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">onRE</span> = <span class=
"org-string">/^on[^a-z]/</span>
<span class="linenr">  220: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isOn</span> = (key) =&gt; onRE.test(key)
<span class="linenr">  221: </span>
<span class="linenr">  222: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isPromise</span> = (val) =&gt; {
<span class="linenr">  223: </span>  <span class=
"org-keyword">return</span> isObject(val) &amp;& isFunction(val.then) &amp;& isFunction(val.<span class="org-keyword">catch</span>)
<span class="linenr">  224: </span>}
<span class="linenr">  225: </span>
<span class="linenr">  226: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">objectToString</span> = Object.<span class=
"org-constant">prototype</span>.toString
<span class="linenr">  227: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">toTypeString</span> = (value) =&gt; objectToString.call(value)
<span class="linenr">  228: </span>
<span class="linenr">  229: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">toRawType</span> = (value) =&gt; {
<span class="linenr">  230: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">extract "RawType" from strings like "[object RawType]"</span>
<span class="linenr">  231: </span>  <span class=
"org-keyword">return</span> toTypeString(value).slice(<span class=
"org-highlight-numbers-number">8</span>, -<span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr">  232: </span>}
<span class="linenr">  233: </span>
<span class="linenr">  234: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isText</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">  235: </span>  <span class=
"org-keyword">return</span> node.type === NodeTypes.INTERPOLATION || node.type === NodeTypes.TEXT
<span class="linenr">  236: </span>}
<span class="linenr">  237: </span>
<span class="linenr">  238: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isPlainObject</span> = (val) =&gt; toTypeString(val) === <span class="org-string">'[object Object]'</span>
<span class="linenr">  239: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isIntegerKey</span> = (key) =&gt;
<span class="linenr">  240: </span>  isString(key) &amp;&
<span class="linenr">  241: </span>  key !== <span class=
"org-string">'NaN'</span> &amp;&
<span class="linenr">  242: </span>  key[<span class=
"org-highlight-numbers-number">0</span>] !== <span class=
"org-string">'-'</span> &amp;&
<span class="linenr">  243: </span>  <span class=
"org-string">''</span> + parseInt(key, <span class=
"org-highlight-numbers-number">10</span>) === key
<span class="linenr">  244: </span>
<span class="linenr">  245: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isReservedProp</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr">  246: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the leading comma is intentional so empty string "" is also included</span>
<span class="linenr">  247: </span>  <span class=
"org-string">',key,ref,ref_for,ref_key,'</span> +
<span class="linenr">  248: </span>    <span class=
"org-string">'onVnodeBeforeMount,onVnodeMounted,'</span> +
<span class="linenr">  249: </span>    <span class=
"org-string">'onVnodeBeforeUpdate,onVnodeUpdated,'</span> +
<span class="linenr">  250: </span>    <span class=
"org-string">'onVnodeBeforeUnmount,onVnodeUnmounted'</span>
<span class="linenr">  251: </span>)
<span class="linenr">  252: </span>
<span class="linenr">  253: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">GLOBALS_WHITE_LISTED</span> =
<span class="linenr">  254: </span>  <span class=
"org-string">'Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,'</span> +
<span class="linenr">  255: </span>  <span class=
"org-string">'decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,'</span> +
<span class="linenr">  256: </span>  <span class=
"org-string">'Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt'</span>
<span class="linenr">  257: </span>
<span class="linenr">  258: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isGloballyWhitelisted</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(GLOBALS_WHITE_LISTED)
<span class="linenr">  259: </span>
<span class="linenr">  260: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">nonIdentifierRE</span> = <span class=
"org-string">/^\d|[^\$\w]/</span>
<span class="linenr">  261: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSimpleIdentifier</span> = (name) =&gt; !nonIdentifierRE.test(name)
<span class="linenr">  262: </span>
<span class="linenr">  263: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isBuiltInDirective</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr">  264: </span>  <span class=
"org-string">'bind,cloak,else-if,else,for,html,if,model,on,once,pre,show,slot,text,memo'</span>
<span class="linenr">  265: </span>)
<span class="linenr">  266: </span>
<span class="linenr">  267: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getCursor</span>(<span class=
"org-variable-name">context</span>) {
<span class="linenr">  268: </span>  <span class=
"org-keyword">const</span> { column, line, offset } = context
<span class="linenr">  269: </span>  <span class=
"org-keyword">return</span> { column, line, offset }
<span class="linenr">  270: </span>}
<span class="linenr">  271: </span>
<span class="linenr">  272: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getSelection</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">start</span>, <span class=
"org-variable-name">end</span>) {
<span class=
"linenr">  273: </span>  end = end || getCursor(context)
<span class="linenr">  274: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr">  275: </span>    start,
<span class="linenr">  276: </span>    end,
<span class=
"linenr">  277: </span>    source: context.originalSource.slice(start.offset, end.offset)
<span class="linenr">  278: </span>  }
<span class="linenr">  279: </span>}
<span class="linenr">  280: </span>
<span class="linenr">  281: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">last</span>(<span class=
"org-variable-name">xs</span>) {
<span class="linenr">  282: </span>  <span class=
"org-keyword">return</span> xs[xs.length - <span class=
"org-highlight-numbers-number">1</span>]
<span class="linenr">  283: </span>}
<span class="linenr">  284: </span>
<span class="linenr">  285: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">startsWith</span>(<span class=
"org-variable-name">source</span>, <span class=
"org-variable-name">searchString</span>) {
<span class="linenr">  286: </span>  <span class=
"org-keyword">return</span> source.startsWith(searchString)
<span class="linenr">  287: </span>}
<span class="linenr">  288: </span>
<span class="linenr">  289: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">advancePositionWithMutation</span>(<span class=
"org-variable-name">pos</span>, <span class=
"org-variable-name">source</span>, <span class=
"org-variable-name">numberOfCharacters</span> = <span class=
"org-variable-name">source</span>.<span class=
"org-variable-name">length</span>) {
<span class="linenr">  290: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">linesCount</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">  291: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">lastNewLinePos</span> = -<span class=
"org-highlight-numbers-number">1</span>
<span class="linenr">  292: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; numberOfCharacters; i++) {
<span class="linenr">  293: </span>    <span class=
"org-keyword">if</span> (source.charCodeAt(i) === <span class=
"org-highlight-numbers-number">10</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">newline char code</span><span class=
"org-comment-delimiter"> */</span>) {
<span class="linenr">  294: </span>      linesCount++
<span class="linenr">  295: </span>      lastNewLinePos = i
<span class="linenr">  296: </span>    }
<span class="linenr">  297: </span>  }
<span class="linenr">  298: </span>
<span class=
"linenr">  299: </span>  pos.offset += numberOfCharacters
<span class="linenr">  300: </span>  pos.line += linesCount
<span class="linenr">  301: </span>  pos.column =
<span class=
"linenr">  302: </span>    lastNewLinePos === -<span class=
"org-highlight-numbers-number">1</span>
<span class=
"linenr">  303: </span>      ? pos.column + numberOfCharacters
<span class=
"linenr">  304: </span>      : numberOfCharacters - lastNewLinePos
<span class="linenr">  305: </span>
<span class="linenr">  306: </span>  <span class=
"org-keyword">return</span> pos
<span class="linenr">  307: </span>}
<span class="linenr">  308: </span>
<span class="linenr">  309: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">advancePositionWithClone</span>(
<span class="linenr">  310: </span>  <span class=
"org-variable-name">pos</span>,
<span class="linenr">  311: </span>  <span class=
"org-variable-name">source</span>,
<span class=
"linenr">  312: </span>  numberOfCharacters = source.length
<span class="linenr">  313: </span>) {
<span class="linenr">  314: </span>  <span class=
"org-keyword">return</span> advancePositionWithMutation(
<span class="linenr">  315: </span>    extend({}, pos),
<span class="linenr">  316: </span>    source,
<span class="linenr">  317: </span>    numberOfCharacters
<span class="linenr">  318: </span>  )
<span class="linenr">  319: </span>}
<span class="linenr">  320: </span>
<span class="linenr">  321: </span>
<span class="linenr">  322: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">advanceBy</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">numberOfCharacters</span>) {
<span class="linenr">  323: </span>  <span class=
"org-keyword">const</span> { source } = context
<span class=
"linenr">  324: </span>  advancePositionWithMutation(context, source, numberOfCharacters)
<span class=
"linenr">  325: </span>  context.source = source.slice(numberOfCharacters)
<span class="linenr">  326: </span>}
<span class="linenr">  327: </span>
<span class="linenr">  328: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">advanceSpaces</span>(<span class=
"org-variable-name">context</span>) {
<span class="linenr">  329: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">match</span> = <span class=
"org-string">/^[\t\r\n\f ]+/</span>.exec(context.source)
<span class="linenr">  330: </span>  <span class=
"org-keyword">if</span> (match) {
<span class=
"linenr">  331: </span>    advanceBy(context, match[<span class=
"org-highlight-numbers-number">0</span>].length)
<span class="linenr">  332: </span>  }
<span class="linenr">  333: </span>}
<span class="linenr">  334: </span>
<span class="linenr">  335: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getNewPosition</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">start</span>, <span class=
"org-variable-name">numberOfCharacters</span>) {
<span class="linenr">  336: </span>  <span class=
"org-keyword">return</span> advancePositionWithClone(
<span class="linenr">  337: </span>    start,
<span class=
"linenr">  338: </span>    context.originalSource.slice(start.offset, numberOfCharacters),
<span class="linenr">  339: </span>    numberOfCharacters
<span class="linenr">  340: </span>  )
<span class="linenr">  341: </span>}
<span class="linenr">  342: </span>
<span class="linenr">  343: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">emitError</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">code</span>, <span class=
"org-variable-name">offset</span>, <span class=
"org-variable-name">loc</span> = <span class=
"org-variable-name">getCursor</span>(<span class=
"org-variable-name">context</span>)) {
<span class="linenr">  344: </span>  <span class=
"org-keyword">if</span> (offset) {
<span class="linenr">  345: </span>    loc.offset += offset
<span class="linenr">  346: </span>    loc.column += offset
<span class="linenr">  347: </span>  }
<span class="linenr">  348: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">ignore...</span>
<span class="linenr">  349: </span>}
<span class="linenr">  350: </span>
<span class="linenr">  351: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isEnd</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">mode</span>, <span class=
"org-variable-name">ancestors</span>) {
<span class="linenr">  352: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">s</span> = context.source
<span class="linenr">  353: </span>
<span class="linenr">  354: </span>  <span class=
"org-keyword">switch</span> (mode) {
<span class="linenr">  355: </span>    <span class=
"org-keyword">case</span> TextModes.DATA:
<span class="linenr">  356: </span>      <span class=
"org-keyword">if</span> (startsWith(s, <span class=
"org-string">'&lt;/'</span>)) {
<span class="linenr">  357: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO:</span></span></span><span class=
"org-comment"> probably bad performance</span>
<span class="linenr">  358: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = ancestors.length - <span class=
"org-highlight-numbers-number">1</span>; i &gt;= <span class=
"org-highlight-numbers-number">0</span>; --i) {
<span class="linenr">  359: </span>          <span class=
"org-keyword">if</span> (startsWithEndTagOpen(s, ancestors[i].tag)) {
<span class="linenr">  360: </span>            <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">  361: </span>          }
<span class="linenr">  362: </span>        }
<span class="linenr">  363: </span>      }
<span class="linenr">  364: </span>      <span class=
"org-keyword">break</span>
<span class="linenr">  365: </span>
<span class="linenr">  366: </span>    <span class=
"org-keyword">case</span> TextModes.RCDATA:
<span class="linenr">  367: </span>    <span class=
"org-keyword">case</span> TextModes.RAWTEXT: {
<span class="linenr">  368: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parent</span> = last(ancestors)
<span class="linenr">  369: </span>      <span class=
"org-keyword">if</span> (parent &amp;& startsWithEndTagOpen(s, parent.tag)) {
<span class="linenr">  370: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">  371: </span>      }
<span class="linenr">  372: </span>      <span class=
"org-keyword">break</span>
<span class="linenr">  373: </span>    }
<span class="linenr">  374: </span>
<span class="linenr">  375: </span>    <span class=
"org-keyword">case</span> TextModes.CDATA:
<span class="linenr">  376: </span>      <span class=
"org-keyword">if</span> (startsWith(s, <span class=
"org-string">']]&gt;'</span>)) {
<span class="linenr">  377: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">  378: </span>      }
<span class="linenr">  379: </span>      <span class=
"org-keyword">break</span>
<span class="linenr">  380: </span>  }
<span class="linenr">  381: </span>
<span class="linenr">  382: </span>  <span class=
"org-keyword">return</span> !s
<span class="linenr">  383: </span>}
<span class="linenr">  384: </span>
<span class="linenr">  385: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">startsWithEndTagOpen</span>(<span class=
"org-variable-name">source</span>, <span class=
"org-variable-name">tag</span>) {
<span class="linenr">  386: </span>  <span class=
"org-keyword">return</span> (
<span class=
"linenr">  387: </span>    startsWith(source, <span class=
"org-string">'&lt;/'</span>) &amp;&
<span class="linenr">  388: </span>    source.slice(<span class=
"org-highlight-numbers-number">2</span>, <span class=
"org-highlight-numbers-number">2</span> + tag.length).toLowerCase() === tag.toLowerCase() &amp;&
<span class=
"linenr">  389: </span>    /[\t\r\n\f /&gt;]/.test(source[<span class="org-highlight-numbers-number">2</span> + tag.length] || <span class="org-string">'&gt;'</span>)
<span class="linenr">  390: </span>  )
<span class="linenr">  391: </span>}
<span class="linenr">  392: </span>
<span class="linenr">  393: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">cacheStringFunction</span> = (fn) =&gt; {
<span class="linenr">  394: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">cache</span> = Object.create(<span class=
"org-constant">null</span>)
<span class="linenr">  395: </span>  <span class=
"org-keyword">return</span> ((str) =&gt; {
<span class="linenr">  396: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hit</span> = cache[str]
<span class="linenr">  397: </span>    <span class=
"org-keyword">return</span> hit || (cache[str] = fn(str))
<span class="linenr">  398: </span>  })
<span class="linenr">  399: </span>}
<span class="linenr">  400: </span>
<span class="linenr">  401: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">camelizeRE</span> = <span class=
"org-string">/-(\w)/</span>g
<span class="linenr">  402: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">camelize</span> = cacheStringFunction((str) =&gt; {
<span class="linenr">  403: </span>  <span class=
"org-keyword">return</span> str.replace(camelizeRE, (_, c) =&gt; (c ? c.toUpperCase() : <span class="org-string">''</span>))
<span class="linenr">  404: </span>})
<span class="linenr">  405: </span>
<span class="linenr">  406: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">hyphenateRE</span> = <span class=
"org-string">/\B([A-Z])/</span>g
<span class="linenr">  407: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">hyphenate</span> = cacheStringFunction((str) =&gt;
<span class=
"linenr">  408: </span>  str.replace(hyphenateRE, <span class=
"org-string">'-$1'</span>).toLowerCase()
<span class="linenr">  409: </span>)
<span class="linenr">  410: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">capitalize</span> = cacheStringFunction(
<span class=
"linenr">  411: </span>  (str) =&gt; str.charAt(<span class=
"org-highlight-numbers-number">0</span>).toUpperCase() + str.slice(<span class="org-highlight-numbers-number">1</span>)
<span class="linenr">  412: </span>)
<span class="linenr">  413: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">toHandlerKey</span> = cacheStringFunction((str) =&gt; str ? <span class="org-string">`on${capitalize(str)}`</span> : <span class="org-string">``</span>)
<span class="linenr">  414: </span>
<span class="linenr">  415: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isBuiltInType</span> = (tag, expected) =&gt; tag === expected || tag === hyphenate(expected)
<span class="linenr">  416: </span>
<span class="linenr">  417: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isCoreComponent</span>(<span class=
"org-variable-name">tag</span>) {
<span class="linenr">  418: </span>  <span class=
"org-keyword">if</span> (isBuiltInType(tag, <span class=
"org-string">'Teleport'</span>)) {
<span class="linenr">  419: </span>    <span class=
"org-keyword">return</span> TELEPORT
<span class="linenr">  420: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isBuiltInType(tag, <span class=
"org-string">'Suspense'</span>)) {
<span class="linenr">  421: </span>    <span class=
"org-keyword">return</span> SUSPENSE
<span class="linenr">  422: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isBuiltInType(tag, <span class=
"org-string">'KeepAlive'</span>)) {
<span class="linenr">  423: </span>    <span class=
"org-keyword">return</span> KEEP_ALIVE
<span class="linenr">  424: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isBuiltInType(tag, <span class=
"org-string">'BaseTransition'</span>)) {
<span class="linenr">  425: </span>    <span class=
"org-keyword">return</span> BASE_TRANSITION
<span class="linenr">  426: </span>  }
<span class="linenr">  427: </span>}
<span class="linenr">  428: </span>
<span class="linenr">  429: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSpecialTemplateDirective</span> = <span class="org-comment-delimiter">/*</span><span class="org-comment">#__PURE__</span><span class="org-comment-delimiter">*/</span> makeMap(
<span class="linenr">  430: </span>  <span class=
"org-string">`if,else,else-if,for,slot`</span>
<span class="linenr">  431: </span>)
<span class="linenr">  432: </span>
<span class="linenr">  433: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isComponent</span>(<span class=
"org-variable-name">tag</span>, <span class=
"org-variable-name">props</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr">  434: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">options</span> = context.options
<span class="linenr">  435: </span>  <span class=
"org-keyword">if</span> (options.isCustomElement(tag)) {
<span class="linenr">  436: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">  437: </span>  }
<span class="linenr">  438: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr">  439: </span>    tag === <span class=
"org-string">'component'</span> ||
<span class="linenr">  440: </span>    /^[A-Z]/.test(tag) ||
<span class="linenr">  441: </span>    isCoreComponent(tag) ||
<span class=
"linenr">  442: </span>    (options.isBuiltInComponent &amp;& options.isBuiltInComponent(tag)) ||
<span class=
"linenr">  443: </span>    (options.isNativeTag &amp;& !options.isNativeTag(tag))
<span class="linenr">  444: </span>  ) {
<span class="linenr">  445: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">  446: </span>  }
<span class="linenr">  447: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">at this point the tag should be a native tag, but check for potential "is"</span>
<span class="linenr">  448: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">casting</span>
<span class="linenr">  449: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; props.length; i++) {
<span class="linenr">  450: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = props[i]
<span class="linenr">  451: </span>    <span class=
"org-keyword">if</span> (p.type === NodeTypes.ATTRIBUTE) {
<span class="linenr">  452: </span>      <span class=
"org-keyword">if</span> (p.name === <span class=
"org-string">'is'</span> &amp;& p.value) {
<span class="linenr">  453: </span>        <span class=
"org-keyword">if</span> (p.value.content.startsWith(<span class=
"org-string">'vue:'</span>)) {
<span class="linenr">  454: </span>          <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">  455: </span>        }
<span class="linenr">  456: </span>      }
<span class="linenr">  457: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">  458: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">directive</span>
<span class="linenr">  459: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-is (</span><span class="org-comment"><span class=
"org-bold"><span class=
"org-warning">TODO</span></span></span><span class=
"org-comment"> Deprecate)</span>
<span class="linenr">  460: </span>      <span class=
"org-keyword">if</span> (p.name === <span class=
"org-string">'is'</span>) {
<span class="linenr">  461: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">  462: </span>      }
<span class="linenr">  463: </span>    }
<span class="linenr">  464: </span>  }
<span class="linenr">  465: </span>}
<span class="linenr">  466: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">pushNode</span>(<span class=
"org-variable-name">nodes</span>, <span class=
"org-variable-name">node</span>) {
<span class="linenr">  467: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.TEXT) {
<span class="linenr">  468: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prev</span> = last(nodes)
<span class="linenr">  469: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Merge if both this and the previous node are text and those are</span>
<span class="linenr">  470: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">consecutive. This happens for cases like "a &lt; b".</span>
<span class="linenr">  471: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr">  472: </span>      prev &amp;&
<span class=
"linenr">  473: </span>      prev.type === NodeTypes.TEXT &amp;&
<span class=
"linenr">  474: </span>      prev.loc.end.offset === node.loc.start.offset
<span class="linenr">  475: </span>    ) {
<span class=
"linenr">  476: </span>      prev.content += node.content
<span class=
"linenr">  477: </span>      prev.loc.end = node.loc.end
<span class=
"linenr">  478: </span>      prev.loc.source += node.loc.source
<span class="linenr">  479: </span>      <span class=
"org-keyword">return</span>
<span class="linenr">  480: </span>    }
<span class="linenr">  481: </span>  }
<span class="linenr">  482: </span>
<span class="linenr">  483: </span>  nodes.push(node)
<span class="linenr">  484: </span>}
<span class="linenr">  485: </span>
<span class="linenr">  486: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getVNodeHelper</span>(<span class=
"org-variable-name">ssr</span>, <span class=
"org-variable-name">isComponent</span>) {
<span class="linenr">  487: </span>  <span class=
"org-keyword">return</span> ssr || isComponent ? CREATE_VNODE : CREATE_ELEMENT_VNODE
<span class="linenr">  488: </span>}
<span class="linenr">  489: </span>
<span class="linenr">  490: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getVNodeBlockHelper</span>(<span class=
"org-variable-name">ssr</span>, <span class=
"org-variable-name">isComponent</span>) {
<span class="linenr">  491: </span>  <span class=
"org-keyword">return</span> ssr || isComponent ? CREATE_BLOCK : CREATE_ELEMENT_BLOCK
<span class="linenr">  492: </span>}
<span class="linenr">  493: </span>
<span class="linenr">  494: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isSingleElementRoot</span>(<span class=
"org-variable-name">root</span>, <span class=
"org-variable-name">child</span>) {
<span class="linenr">  495: </span>  <span class=
"org-keyword">const</span> { children } = root
<span class="linenr">  496: </span>  <span class=
"org-keyword">return</span> (
<span class=
"linenr">  497: </span>    children.length === <span class=
"org-highlight-numbers-number">1</span> &amp;&
<span class=
"linenr">  498: </span>    child.type === NodeTypes.ELEMENT &amp;&
<span class="linenr">  499: </span>    !isSlotOutlet(child)
<span class="linenr">  500: </span>  )
<span class="linenr">  501: </span>}
<span class="linenr">  502: </span>
<span class="linenr">  503: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isSlotOutlet</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">  504: </span>  <span class=
"org-keyword">return</span> node.type === NodeTypes.ELEMENT &amp;& node.tagType === ElementTypes.SLOT
<span class="linenr">  505: </span>}
<span class="linenr">  506: </span>
<span class="linenr">  507: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">findDir</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">name</span>, <span class=
"org-variable-name">allowEmpty</span> = <span class=
"org-constant">false</span>) {
<span class="linenr">  508: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr">  509: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = node.props[i]
<span class="linenr">  510: </span>    <span class=
"org-keyword">if</span> (
<span class=
"linenr">  511: </span>      p.type === NodeTypes.DIRECTIVE &amp;&
<span class=
"linenr">  512: </span>      (allowEmpty || p.exp) &amp;&
<span class=
"linenr">  513: </span>      (isString(name) ? p.name === name : name.test(p.name))
<span class="linenr">  514: </span>    ) {
<span class="linenr">  515: </span>      <span class=
"org-keyword">return</span> p
<span class="linenr">  516: </span>    }
<span class="linenr">  517: </span>  }
<span class="linenr">  518: </span>}
<span class="linenr">  519: </span>
<span class="linenr">  520: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">findProp</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">name</span>, <span class=
"org-variable-name">dynamicOnly</span> = <span class=
"org-constant">false</span>, <span class=
"org-variable-name">allowEmpty</span> = <span class=
"org-constant">false</span>) {
<span class="linenr">  521: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr">  522: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = node.props[i]
<span class="linenr">  523: </span>    <span class=
"org-keyword">if</span> (p.type === NodeTypes.ATTRIBUTE) {
<span class="linenr">  524: </span>      <span class=
"org-keyword">if</span> (dynamicOnly) <span class=
"org-keyword">continue</span>
<span class="linenr">  525: </span>      <span class=
"org-keyword">if</span> (p.name === name &amp;& (p.value || allowEmpty)) {
<span class="linenr">  526: </span>        <span class=
"org-keyword">return</span> p
<span class="linenr">  527: </span>      }
<span class="linenr">  528: </span>    } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class="linenr">  529: </span>      p.name === <span class=
"org-string">'bind'</span> &amp;&
<span class=
"linenr">  530: </span>      (p.exp || allowEmpty) &amp;&
<span class="linenr">  531: </span>      isStaticArgOf(p.arg, name)
<span class="linenr">  532: </span>    ) {
<span class="linenr">  533: </span>      <span class=
"org-keyword">return</span> p
<span class="linenr">  534: </span>    }
<span class="linenr">  535: </span>  }
<span class="linenr">  536: </span>}
<span class="linenr">  537: </span>
<span class="linenr">  538: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isStaticExp</span> = (p) =&gt; p.type === NodeTypes.SIMPLE_EXPRESSION &amp;& p.isStatic
<span class="linenr">  539: </span>
<span class="linenr">  540: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isStaticArgOf</span>(<span class=
"org-variable-name">arg</span>, <span class=
"org-variable-name">name</span>) {
<span class="linenr">  541: </span>  <span class=
"org-keyword">return</span> !!(arg &amp;& isStaticExp(arg) &amp;& arg.content === name)
<span class="linenr">  542: </span>}
<span class="linenr">  543: </span>
<span class="linenr">  544: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isVSlot</span>(<span class=
"org-variable-name">p</span>) {
<span class="linenr">  545: </span>  <span class=
"org-keyword">return</span> p.type === NodeTypes.DIRECTIVE &amp;& p.name === <span class="org-string">'slot'</span>
<span class="linenr">  546: </span>}
<span class="linenr">  547: </span>
<span class="linenr">  548: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getMemoedVNodeCall</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">  549: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.JS_CALL_EXPRESSION &amp;& node.callee === WITH_MEMO) {
<span class="linenr">  550: </span>    <span class=
"org-keyword">return</span> node.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">1</span>].returns
<span class="linenr">  551: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">  552: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr">  553: </span>  }
<span class="linenr">  554: </span>}
<span class="linenr">  555: </span>
<span class="linenr">  556: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getInnerRange</span>(<span class=
"org-variable-name">loc</span>, <span class=
"org-variable-name">offset</span>, <span class=
"org-variable-name">length</span>) {
<span class="linenr">  557: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = loc.source.slice(offset, offset + length)
<span class="linenr">  558: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">newLoc</span> = {
<span class="linenr">  559: </span>    source,
<span class=
"linenr">  560: </span>    start: advancePositionWithClone(loc.start, loc.source, offset),
<span class="linenr">  561: </span>    end: loc.end
<span class="linenr">  562: </span>  }
<span class="linenr">  563: </span>
<span class="linenr">  564: </span>  <span class=
"org-keyword">if</span> (length != <span class=
"org-constant">null</span>) {
<span class=
"linenr">  565: </span>    newLoc.end = advancePositionWithClone(
<span class="linenr">  566: </span>      loc.start,
<span class="linenr">  567: </span>      loc.source,
<span class="linenr">  568: </span>      offset + length
<span class="linenr">  569: </span>    )
<span class="linenr">  570: </span>  }
<span class="linenr">  571: </span>
<span class="linenr">  572: </span>  <span class=
"org-keyword">return</span> newLoc
<span class="linenr">  573: </span>}
<span class="linenr">  574: </span>
<span class="linenr">  575: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">toValidAssetId</span>(<span class=
"org-variable-name">name</span>, <span class=
"org-variable-name">type</span>) {
<span class="linenr">  576: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">see issue#4422, we need adding identifier on validAssetId if variable `name` has specific character</span>
<span class="linenr">  577: </span>  <span class=
"org-keyword">return</span> <span class=
"org-string">`_${type}_${name.replace(/[^\w]/g, (searchValue, replaceValue) =&gt; {</span>
<span class="linenr">  578: </span><span class=
"org-string">    return searchValue === '-' ? '_' : name.charCodeAt(replaceValue).toString()</span>
<span class="linenr">  579: </span><span class=
"org-string">  })}`</span>
<span class="linenr">  580: </span>}
<span class="linenr">  581: </span>
<span class="linenr">  582: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isTemplateNode</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">  583: </span>  <span class=
"org-keyword">return</span> (
<span class=
"linenr">  584: </span>    node.type === NodeTypes.ELEMENT &amp;& node.tagType === ElementTypes.TEMPLATE
<span class="linenr">  585: </span>  )
<span class="linenr">  586: </span>}
<span class="linenr">  587: </span>
<span class="linenr">  588: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">FRAGMENT</span> = Symbol(__DEV__ ? <span class=
"org-string">`Fragment`</span> : <span class=
"org-string">``</span>)
<span class="linenr">  589: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TELEPORT</span> = Symbol(__DEV__ ? <span class=
"org-string">`Teleport`</span> : <span class=
"org-string">``</span>)
<span class="linenr">  590: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">SUSPENSE</span> = Symbol(__DEV__ ? <span class=
"org-string">`Suspense`</span> : <span class=
"org-string">``</span>)
<span class="linenr">  591: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">KEEP_ALIVE</span> = Symbol(__DEV__ ? <span class="org-string">`KeepAlive`</span> : <span class="org-string">``</span>)
<span class="linenr">  592: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">BASE_TRANSITION</span> = Symbol(__DEV__ ? <span class="org-string">`BaseTransition`</span> : <span class="org-string">``</span>)
<span class="linenr">  593: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">OPEN_BLOCK</span> = Symbol(__DEV__ ? <span class="org-string">`openBlock`</span> : <span class="org-string">``</span>)
<span class="linenr">  594: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_BLOCK</span> = Symbol(__DEV__ ? <span class="org-string">`createBlock`</span> : <span class="org-string">``</span>)
<span class="linenr">  595: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_ELEMENT_BLOCK</span> = Symbol(__DEV__ ? <span class="org-string">`createElementBlock`</span> : <span class="org-string">``</span>)
<span class="linenr">  596: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_VNODE</span> = Symbol(__DEV__ ? <span class="org-string">`createVNode`</span> : <span class="org-string">``</span>)
<span class="linenr">  597: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_ELEMENT_VNODE</span> = Symbol(__DEV__ ? <span class="org-string">`createElementVNode`</span> : <span class="org-string">``</span>)
<span class="linenr">  598: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_COMMENT</span> = Symbol(__DEV__ ? <span class="org-string">`createCommentVNode`</span> : <span class="org-string">``</span>)
<span class="linenr">  599: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_TEXT</span> = Symbol(__DEV__ ? <span class="org-string">`createTextVNode`</span> : <span class="org-string">``</span>)
<span class="linenr">  600: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_STATIC</span> = Symbol(__DEV__ ? <span class="org-string">`createStaticVNode`</span> : <span class="org-string">``</span>)
<span class="linenr">  601: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">RESOLVE_COMPONENT</span> = Symbol(__DEV__ ? <span class="org-string">`resolveComponent`</span> : <span class="org-string">``</span>)
<span class="linenr">  602: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">RESOLVE_DYNAMIC_COMPONENT</span> = Symbol(
<span class="linenr">  603: </span>  __DEV__ ? <span class=
"org-string">`resolveDynamicComponent`</span> : <span class=
"org-string">``</span>
<span class="linenr">  604: </span>)
<span class="linenr">  605: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">RESOLVE_DIRECTIVE</span> = Symbol(__DEV__ ? <span class="org-string">`resolveDirective`</span> : <span class="org-string">``</span>)
<span class="linenr">  606: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">RESOLVE_FILTER</span> = Symbol(__DEV__ ? <span class="org-string">`resolveFilter`</span> : <span class="org-string">``</span>)
<span class="linenr">  607: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">WITH_DIRECTIVES</span> = Symbol(__DEV__ ? <span class="org-string">`withDirectives`</span> : <span class="org-string">``</span>)
<span class="linenr">  608: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">RENDER_LIST</span> = Symbol(__DEV__ ? <span class="org-string">`renderList`</span> : <span class="org-string">``</span>)
<span class="linenr">  609: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">RENDER_SLOT</span> = Symbol(__DEV__ ? <span class="org-string">`renderSlot`</span> : <span class="org-string">``</span>)
<span class="linenr">  610: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CREATE_SLOTS</span> = Symbol(__DEV__ ? <span class="org-string">`createSlots`</span> : <span class="org-string">``</span>)
<span class="linenr">  611: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TO_DISPLAY_STRING</span> = Symbol(__DEV__ ? <span class="org-string">`toDisplayString`</span> : <span class="org-string">``</span>)
<span class="linenr">  612: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">MERGE_PROPS</span> = Symbol(__DEV__ ? <span class="org-string">`mergeProps`</span> : <span class="org-string">``</span>)
<span class="linenr">  613: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">NORMALIZE_CLASS</span> = Symbol(__DEV__ ? <span class="org-string">`normalizeClass`</span> : <span class="org-string">``</span>)
<span class="linenr">  614: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">NORMALIZE_STYLE</span> = Symbol(__DEV__ ? <span class="org-string">`normalizeStyle`</span> : <span class="org-string">``</span>)
<span class="linenr">  615: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">NORMALIZE_PROPS</span> = Symbol(__DEV__ ? <span class="org-string">`normalizeProps`</span> : <span class="org-string">``</span>)
<span class="linenr">  616: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">GUARD_REACTIVE_PROPS</span> = Symbol(__DEV__ ? <span class="org-string">`guardReactiveProps`</span> : <span class="org-string">``</span>)
<span class="linenr">  617: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TO_HANDLERS</span> = Symbol(__DEV__ ? <span class="org-string">`toHandlers`</span> : <span class="org-string">``</span>)
<span class="linenr">  618: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CAMELIZE</span> = Symbol(__DEV__ ? <span class=
"org-string">`camelize`</span> : <span class=
"org-string">``</span>)
<span class="linenr">  619: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CAPITALIZE</span> = Symbol(__DEV__ ? <span class="org-string">`capitalize`</span> : <span class="org-string">``</span>)
<span class="linenr">  620: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TO_HANDLER_KEY</span> = Symbol(__DEV__ ? <span class="org-string">`toHandlerKey`</span> : <span class="org-string">``</span>)
<span class="linenr">  621: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">SET_BLOCK_TRACKING</span> = Symbol(__DEV__ ? <span class="org-string">`setBlockTracking`</span> : <span class="org-string">``</span>)
<span class="linenr">  622: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">PUSH_SCOPE_ID</span> = Symbol(__DEV__ ? <span class="org-string">`pushScopeId`</span> : <span class="org-string">``</span>)
<span class="linenr">  623: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">POP_SCOPE_ID</span> = Symbol(__DEV__ ? <span class="org-string">`popScopeId`</span> : <span class="org-string">``</span>)
<span class="linenr">  624: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">WITH_CTX</span> = Symbol(__DEV__ ? <span class=
"org-string">`withCtx`</span> : <span class="org-string">``</span>)
<span class="linenr">  625: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">UNREF</span> = Symbol(__DEV__ ? <span class=
"org-string">`unref`</span> : <span class="org-string">``</span>)
<span class="linenr">  626: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">IS_REF</span> = Symbol(__DEV__ ? <span class=
"org-string">`isRef`</span> : <span class="org-string">``</span>)
<span class="linenr">  627: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">WITH_MEMO</span> = Symbol(__DEV__ ? <span class="org-string">`withMemo`</span> : <span class="org-string">``</span>)
<span class="linenr">  628: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">IS_MEMO_SAME</span> = Symbol(__DEV__ ? <span class="org-string">`isMemoSame`</span> : <span class="org-string">``</span>)
<span class="linenr">  629: </span>
<span class="linenr">  630: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Name mapping for runtime helpers that need to be imported from 'vue' in</span>
<span class="linenr">  631: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">generated code. Make sure these are correctly exported in the runtime!</span>
<span class="linenr">  632: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Using `any` here because TS doesn't allow symbols as index type.</span>
<span class="linenr">  633: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">helperNameMap</span> = {
<span class="linenr">  634: </span>  [FRAGMENT]: <span class=
"org-string">`Fragment`</span>,
<span class="linenr">  635: </span>  [TELEPORT]: <span class=
"org-string">`Teleport`</span>,
<span class="linenr">  636: </span>  [SUSPENSE]: <span class=
"org-string">`Suspense`</span>,
<span class="linenr">  637: </span>  [KEEP_ALIVE]: <span class=
"org-string">`KeepAlive`</span>,
<span class=
"linenr">  638: </span>  [BASE_TRANSITION]: <span class="org-string">`BaseTransition`</span>,
<span class="linenr">  639: </span>  [OPEN_BLOCK]: <span class=
"org-string">`openBlock`</span>,
<span class="linenr">  640: </span>  [CREATE_BLOCK]: <span class=
"org-string">`createBlock`</span>,
<span class=
"linenr">  641: </span>  [CREATE_ELEMENT_BLOCK]: <span class=
"org-string">`createElementBlock`</span>,
<span class="linenr">  642: </span>  [CREATE_VNODE]: <span class=
"org-string">`createVNode`</span>,
<span class=
"linenr">  643: </span>  [CREATE_ELEMENT_VNODE]: <span class=
"org-string">`createElementVNode`</span>,
<span class="linenr">  644: </span>  [CREATE_COMMENT]: <span class=
"org-string">`createCommentVNode`</span>,
<span class="linenr">  645: </span>  [CREATE_TEXT]: <span class=
"org-string">`createTextVNode`</span>,
<span class="linenr">  646: </span>  [CREATE_STATIC]: <span class=
"org-string">`createStaticVNode`</span>,
<span class=
"linenr">  647: </span>  [RESOLVE_COMPONENT]: <span class=
"org-string">`resolveComponent`</span>,
<span class=
"linenr">  648: </span>  [RESOLVE_DYNAMIC_COMPONENT]: <span class=
"org-string">`resolveDynamicComponent`</span>,
<span class=
"linenr">  649: </span>  [RESOLVE_DIRECTIVE]: <span class=
"org-string">`resolveDirective`</span>,
<span class="linenr">  650: </span>  [RESOLVE_FILTER]: <span class=
"org-string">`resolveFilter`</span>,
<span class=
"linenr">  651: </span>  [WITH_DIRECTIVES]: <span class="org-string">`withDirectives`</span>,
<span class="linenr">  652: </span>  [RENDER_LIST]: <span class=
"org-string">`renderList`</span>,
<span class="linenr">  653: </span>  [RENDER_SLOT]: <span class=
"org-string">`renderSlot`</span>,
<span class="linenr">  654: </span>  [CREATE_SLOTS]: <span class=
"org-string">`createSlots`</span>,
<span class=
"linenr">  655: </span>  [TO_DISPLAY_STRING]: <span class=
"org-string">`toDisplayString`</span>,
<span class="linenr">  656: </span>  [MERGE_PROPS]: <span class=
"org-string">`mergeProps`</span>,
<span class=
"linenr">  657: </span>  [NORMALIZE_CLASS]: <span class="org-string">`normalizeClass`</span>,
<span class=
"linenr">  658: </span>  [NORMALIZE_STYLE]: <span class="org-string">`normalizeStyle`</span>,
<span class=
"linenr">  659: </span>  [NORMALIZE_PROPS]: <span class="org-string">`normalizeProps`</span>,
<span class=
"linenr">  660: </span>  [GUARD_REACTIVE_PROPS]: <span class=
"org-string">`guardReactiveProps`</span>,
<span class="linenr">  661: </span>  [TO_HANDLERS]: <span class=
"org-string">`toHandlers`</span>,
<span class="linenr">  662: </span>  [CAMELIZE]: <span class=
"org-string">`camelize`</span>,
<span class="linenr">  663: </span>  [CAPITALIZE]: <span class=
"org-string">`capitalize`</span>,
<span class="linenr">  664: </span>  [TO_HANDLER_KEY]: <span class=
"org-string">`toHandlerKey`</span>,
<span class=
"linenr">  665: </span>  [SET_BLOCK_TRACKING]: <span class=
"org-string">`setBlockTracking`</span>,
<span class="linenr">  666: </span>  [PUSH_SCOPE_ID]: <span class=
"org-string">`pushScopeId`</span>,
<span class="linenr">  667: </span>  [POP_SCOPE_ID]: <span class=
"org-string">`popScopeId`</span>,
<span class="linenr">  668: </span>  [WITH_CTX]: <span class=
"org-string">`withCtx`</span>,
<span class="linenr">  669: </span>  [UNREF]: <span class=
"org-string">`unref`</span>,
<span class="linenr">  670: </span>  [IS_REF]: <span class=
"org-string">`isRef`</span>,
<span class="linenr">  671: </span>  [WITH_MEMO]: <span class=
"org-string">`withMemo`</span>,
<span class="linenr">  672: </span>  [IS_MEMO_SAME]: <span class=
"org-string">`isMemoSame`</span>
<span class="linenr">  673: </span>}
<span class="linenr">  674: </span>
<span class="linenr">  675: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">registerRuntimeHelpers</span>(<span class=
"org-variable-name">helpers</span>) {
<span class=
"linenr">  676: </span>  Object.getOwnPropertySymbols(helpers).forEach(s =&gt; {
<span class=
"linenr">  677: </span>    helperNameMap[s] = helpers[s]
<span class="linenr">  678: </span>  })
<span class="linenr">  679: </span>}
<span class="linenr">  680: </span>
<span class="linenr">  681: </span>
<span class="linenr">  682: </span><span class="org-doc">/**</span>
<span class="linenr">  683: </span><span class=
"org-doc"> * Patch flags are optimization hints generated by the compiler.</span>
<span class="linenr">  684: </span><span class=
"org-doc"> * when a block with dynamicChildren is encountered during diff, the algorithm</span>
<span class="linenr">  685: </span><span class=
"org-doc"> * enters "optimized mode". In this mode, we know that the vdom is produced by</span>
<span class="linenr">  686: </span><span class=
"org-doc"> * a render function generated by the compiler, so the algorithm only needs to</span>
<span class="linenr">  687: </span><span class=
"org-doc"> * handle updates explicitly marked by these patch flags.</span>
<span class="linenr">  688: </span><span class="org-doc"> *</span>
<span class="linenr">  689: </span><span class=
"org-doc"> * Patch flags can be combined using the | bitwise operator and can be checked</span>
<span class="linenr">  690: </span><span class=
"org-doc"> * using the & operator, e.g.</span>
<span class="linenr">  691: </span><span class="org-doc"> *</span>
<span class="linenr">  692: </span><span class=
"org-doc"> * ```js</span>
<span class="linenr">  693: </span><span class=
"org-doc"> * const flag = TEXT | CLASS</span>
<span class="linenr">  694: </span><span class=
"org-doc"> * if (flag & TEXT) { ... }</span>
<span class="linenr">  695: </span><span class=
"org-doc"> * ```</span>
<span class="linenr">  696: </span><span class="org-doc"> *</span>
<span class="linenr">  697: </span><span class=
"org-doc"> * Check the `patchElement` function in '../../runtime-core/src/renderer.ts' to see how the</span>
<span class="linenr">  698: </span><span class=
"org-doc"> * flags are handled during diff.</span>
<span class="linenr">  699: </span><span class="org-doc"> */</span>
<span class="linenr">  700: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">PatchFlags</span> = {
<span class="linenr">  701: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  702: </span><span class=
"org-doc">   * Indicates an element with dynamic textContent (children fast path)</span>
<span class="linenr">  703: </span><span class=
"org-doc">   */</span>
<span class="linenr">  704: </span>  TEXT: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr">  705: </span>
<span class="linenr">  706: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  707: </span><span class=
"org-doc">   * Indicates an element with dynamic class binding.</span>
<span class="linenr">  708: </span><span class=
"org-doc">   */</span>
<span class="linenr">  709: </span>  CLASS: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr">  710: </span>
<span class="linenr">  711: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  712: </span><span class=
"org-doc">   * Indicates an element with dynamic style</span>
<span class="linenr">  713: </span><span class=
"org-doc">   * The compiler pre-compiles static string styles into static objects</span>
<span class="linenr">  714: </span><span class=
"org-doc">   * + detects and hoists inline static objects</span>
<span class="linenr">  715: </span><span class=
"org-doc">   * e.g. `style="color: red"` and `:style="{ color: 'red' }"` both get hoisted</span>
<span class="linenr">  716: </span><span class=
"org-doc">   * as:</span>
<span class="linenr">  717: </span><span class=
"org-doc">   * ```js</span>
<span class="linenr">  718: </span><span class=
"org-doc">   * const style = { color: 'red' }</span>
<span class="linenr">  719: </span><span class=
"org-doc">   * render() { return e('div', { style }) }</span>
<span class="linenr">  720: </span><span class=
"org-doc">   * ```</span>
<span class="linenr">  721: </span><span class=
"org-doc">   */</span>
<span class="linenr">  722: </span>  STYLE: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">2</span>,
<span class="linenr">  723: </span>
<span class="linenr">  724: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  725: </span><span class=
"org-doc">   * Indicates an element that has non-class/style dynamic props.</span>
<span class="linenr">  726: </span><span class=
"org-doc">   * Can also be on a component that has any dynamic props (includes</span>
<span class="linenr">  727: </span><span class=
"org-doc">   * class/style). when this flag is present, the vnode also has a dynamicProps</span>
<span class="linenr">  728: </span><span class=
"org-doc">   * array that contains the keys of the props that may change so the runtime</span>
<span class="linenr">  729: </span><span class=
"org-doc">   * can diff them faster (without having to worry about removed props)</span>
<span class="linenr">  730: </span><span class=
"org-doc">   */</span>
<span class="linenr">  731: </span>  PROPS: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">3</span>,
<span class="linenr">  732: </span>
<span class="linenr">  733: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  734: </span><span class=
"org-doc">   * Indicates an element with props with dynamic keys. When keys change, a full</span>
<span class="linenr">  735: </span><span class=
"org-doc">   * diff is always needed to remove the old key. This flag is mutually</span>
<span class="linenr">  736: </span><span class=
"org-doc">   * exclusive with CLASS, STYLE and PROPS.</span>
<span class="linenr">  737: </span><span class=
"org-doc">   */</span>
<span class="linenr">  738: </span>  FULL_PROPS: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">4</span>,
<span class="linenr">  739: </span>
<span class="linenr">  740: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  741: </span><span class=
"org-doc">   * Indicates an element with event listeners (which need to be attached</span>
<span class="linenr">  742: </span><span class=
"org-doc">   * during hydration)</span>
<span class="linenr">  743: </span><span class=
"org-doc">   */</span>
<span class="linenr">  744: </span>  HYDRATE_EVENTS: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">5</span>,
<span class="linenr">  745: </span>
<span class="linenr">  746: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  747: </span><span class=
"org-doc">   * Indicates a fragment whose children order doesn't change.</span>
<span class="linenr">  748: </span><span class=
"org-doc">   */</span>
<span class="linenr">  749: </span>  STABLE_FRAGMENT: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">6</span>,
<span class="linenr">  750: </span>
<span class="linenr">  751: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  752: </span><span class=
"org-doc">   * Indicates a fragment with keyed or partially keyed children</span>
<span class="linenr">  753: </span><span class=
"org-doc">   */</span>
<span class="linenr">  754: </span>  KEYED_FRAGMENT: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">7</span>,
<span class="linenr">  755: </span>
<span class="linenr">  756: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  757: </span><span class=
"org-doc">   * Indicates a fragment with unkeyed children.</span>
<span class="linenr">  758: </span><span class=
"org-doc">   */</span>
<span class="linenr">  759: </span>  UNKEYED_FRAGMENT: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">8</span>,
<span class="linenr">  760: </span>
<span class="linenr">  761: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  762: </span><span class=
"org-doc">   * Indicates an element that only needs non-props patching, e.g. ref or</span>
<span class="linenr">  763: </span><span class=
"org-doc">   * directives (onVnodeXXX hooks). since every patched vnode checks for refs</span>
<span class="linenr">  764: </span><span class=
"org-doc">   * and onVnodeXXX hooks, it simply marks the vnode so that a parent block</span>
<span class="linenr">  765: </span><span class=
"org-doc">   * will track it.</span>
<span class="linenr">  766: </span><span class=
"org-doc">   */</span>
<span class="linenr">  767: </span>  NEED_PATCH: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">9</span>,
<span class="linenr">  768: </span>
<span class="linenr">  769: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  770: </span><span class=
"org-doc">   * Indicates a component with dynamic slots (e.g. slot that references a v-for</span>
<span class="linenr">  771: </span><span class=
"org-doc">   * iterated value, or dynamic slot names).</span>
<span class="linenr">  772: </span><span class=
"org-doc">   * Components with this flag are always force updated.</span>
<span class="linenr">  773: </span><span class=
"org-doc">   */</span>
<span class="linenr">  774: </span>  DYNAMIC_SLOTS: <span class=
"org-highlight-numbers-number">1</span> &lt;&lt; <span class=
"org-highlight-numbers-number">10</span>,
<span class="linenr">  775: </span>
<span class="linenr">  776: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  777: </span><span class=
"org-doc">   * Indicates a fragment that was created only because the user has placed</span>
<span class="linenr">  778: </span><span class=
"org-doc">   * comments at the root level of a template. This is a dev-only flag since</span>
<span class="linenr">  779: </span><span class=
"org-doc">   * comments are stripped in production.</span>
<span class="linenr">  780: </span><span class=
"org-doc">   */</span>
<span class=
"linenr">  781: </span>  DEV_ROOT_FRAGMENT: <span class="org-highlight-numbers-number">1</span> &lt;&lt; <span class="org-highlight-numbers-number">11</span>,
<span class="linenr">  782: </span>
<span class="linenr">  783: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  784: </span><span class=
"org-doc">   * SPECIAL FLAGS -------------------------------------------------------------</span>
<span class="linenr">  785: </span><span class=
"org-doc">   * Special flags are negative integers. They are never matched against using</span>
<span class="linenr">  786: </span><span class=
"org-doc">   * bitwise operators (bitwise matching should only happen in branches where</span>
<span class="linenr">  787: </span><span class=
"org-doc">   * patchFlag &gt; 0), and are mutually exclusive. When checking for a special</span>
<span class="linenr">  788: </span><span class=
"org-doc">   * flag, simply check patchFlag === FLAG.</span>
<span class="linenr">  789: </span><span class=
"org-doc">   */</span>
<span class="linenr">  790: </span>
<span class="linenr">  791: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  792: </span><span class=
"org-doc">   * Indicates a hoisted static vnode. This is a hint for hydration to skip</span>
<span class="linenr">  793: </span><span class=
"org-doc">   * the entire sub tree since static content never needs to be updated.</span>
<span class="linenr">  794: </span><span class=
"org-doc">   */</span>
<span class="linenr">  795: </span>  HOISTED: -<span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr">  796: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  797: </span><span class=
"org-doc">   * A special flag that indicates that the diffing algorithm should bail out</span>
<span class="linenr">  798: </span><span class=
"org-doc">   * of optimized mode. For example, on block fragments created by renderSlot()</span>
<span class="linenr">  799: </span><span class=
"org-doc">   * when encountering non-compiler generated slots (i.e. manually written</span>
<span class="linenr">  800: </span><span class=
"org-doc">   * render functions, which should always be fully diffed)</span>
<span class="linenr">  801: </span><span class=
"org-doc">   * OR manually cloneVNodes</span>
<span class="linenr">  802: </span><span class=
"org-doc">   */</span>
<span class="linenr">  803: </span>  BAIL: -<span class=
"org-highlight-numbers-number">2</span>
<span class="linenr">  804: </span>}
<span class="linenr">  805: </span>
<span class="linenr">  806: </span><span class="org-doc">/**</span>
<span class="linenr">  807: </span><span class=
"org-doc"> * dev only flag -&gt; name mapping</span>
<span class="linenr">  808: </span><span class="org-doc"> */</span>
<span class="linenr">  809: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">PatchFlagNames</span> = {
<span class=
"linenr">  810: </span>  [PatchFlags.TEXT]: <span class="org-string">`TEXT`</span>,
<span class=
"linenr">  811: </span>  [PatchFlags.CLASS]: <span class=
"org-string">`CLASS`</span>,
<span class=
"linenr">  812: </span>  [PatchFlags.STYLE]: <span class=
"org-string">`STYLE`</span>,
<span class=
"linenr">  813: </span>  [PatchFlags.PROPS]: <span class=
"org-string">`PROPS`</span>,
<span class=
"linenr">  814: </span>  [PatchFlags.FULL_PROPS]: <span class=
"org-string">`FULL_PROPS`</span>,
<span class=
"linenr">  815: </span>  [PatchFlags.HYDRATE_EVENTS]: <span class=
"org-string">`HYDRATE_EVENTS`</span>,
<span class=
"linenr">  816: </span>  [PatchFlags.STABLE_FRAGMENT]: <span class=
"org-string">`STABLE_FRAGMENT`</span>,
<span class=
"linenr">  817: </span>  [PatchFlags.KEYED_FRAGMENT]: <span class=
"org-string">`KEYED_FRAGMENT`</span>,
<span class=
"linenr">  818: </span>  [PatchFlags.UNKEYED_FRAGMENT]: <span class="org-string">`UNKEYED_FRAGMENT`</span>,
<span class=
"linenr">  819: </span>  [PatchFlags.NEED_PATCH]: <span class=
"org-string">`NEED_PATCH`</span>,
<span class=
"linenr">  820: </span>  [PatchFlags.DYNAMIC_SLOTS]: <span class=
"org-string">`DYNAMIC_SLOTS`</span>,
<span class=
"linenr">  821: </span>  [PatchFlags.DEV_ROOT_FRAGMENT]: <span class="org-string">`DEV_ROOT_FRAGMENT`</span>,
<span class=
"linenr">  822: </span>  [PatchFlags.HOISTED]: <span class=
"org-string">`HOISTED`</span>,
<span class=
"linenr">  823: </span>  [PatchFlags.BAIL]: <span class="org-string">`BAIL`</span>
<span class="linenr">  824: </span>}
<span class="linenr">  825: </span>
<span class="linenr">  826: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genFlagText</span>(<span class=
"org-variable-name">flag</span>, <span class=
"org-variable-name">names</span> = <span class=
"org-variable-name">PatchFlagNames</span>) {
<span class="linenr">  827: </span>  <span class=
"org-keyword">if</span> (isArray(flag)) {
<span class="linenr">  828: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">f</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">  829: </span>    flag.forEach(ff =&gt; {
<span class="linenr">  830: </span>      f |= ff
<span class="linenr">  831: </span>    })
<span class="linenr">  832: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`${f} /* ${flag.map(f =&gt; names[f]).join(', ')} */`</span>
<span class="linenr">  833: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">  834: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`${flag} /* ${names[flag]} */`</span>
<span class="linenr">  835: </span>  }
<span class="linenr">  836: </span>}
<span class="linenr">  837: </span>
<span class="linenr">  838: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">propsHelperSet</span> = <span class=
"org-keyword">new</span> <span class=
"org-type">Set</span>([NORMALIZE_PROPS, GUARD_REACTIVE_PROPS])
<span class="linenr">  839: </span>
<span class="linenr">  840: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getUnnormalizedProps</span>(<span class=
"org-variable-name">props</span>, <span class=
"org-variable-name">callPath</span> = []) {
<span class="linenr">  841: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr">  842: </span>    props &amp;&
<span class="linenr">  843: </span>    !isString(props) &amp;&
<span class=
"linenr">  844: </span>    props.type === NodeTypes.JS_CALL_EXPRESSION
<span class="linenr">  845: </span>  ) {
<span class="linenr">  846: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">callee</span> = props.callee
<span class="linenr">  847: </span>    <span class=
"org-keyword">if</span> (!isString(callee) &amp;& propsHelperSet.has(callee)) {
<span class="linenr">  848: </span>      <span class=
"org-keyword">return</span> getUnnormalizedProps(
<span class="linenr">  849: </span>        props.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>],
<span class="linenr">  850: </span>        callPath.concat(props)
<span class="linenr">  851: </span>      )
<span class="linenr">  852: </span>    }
<span class="linenr">  853: </span>  }
<span class="linenr">  854: </span>  <span class=
"org-keyword">return</span> [props, callPath]
<span class="linenr">  855: </span>}
<span class="linenr">  856: </span>
<span class="linenr">  857: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">injectProp</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">prop</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr">  858: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsWithInjection</span>
<span class="linenr">  859: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  860: </span><span class=
"org-doc">   * 1. mergeProps(...)</span>
<span class="linenr">  861: </span><span class=
"org-doc">   * 2. toHandlers(...)</span>
<span class="linenr">  862: </span><span class=
"org-doc">   * 3. normalizeProps(...)</span>
<span class="linenr">  863: </span><span class=
"org-doc">   * 4. normalizeProps(guardReactiveProps(...))</span>
<span class="linenr">  864: </span><span class=
"org-doc">   *</span>
<span class="linenr">  865: </span><span class=
"org-doc">   * we need to get the real props before normalization</span>
<span class="linenr">  866: </span><span class=
"org-doc">   */</span>
<span class="linenr">  867: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">props</span> =
<span class=
"linenr">  868: </span>    node.type === NodeTypes.VNODE_CALL ? node.props : node.<span class="org-constant">arguments</span>[<span class="org-highlight-numbers-number">2</span>]
<span class="linenr">  869: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">callPath</span> = []
<span class="linenr">  870: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">parentCall</span>
<span class="linenr">  871: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr">  872: </span>    props &amp;&
<span class="linenr">  873: </span>    !isString(props) &amp;&
<span class=
"linenr">  874: </span>    props.type === NodeTypes.JS_CALL_EXPRESSION
<span class="linenr">  875: </span>  ) {
<span class="linenr">  876: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ret</span> = getUnnormalizedProps(props)
<span class="linenr">  877: </span>    props = ret[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr">  878: </span>    callPath = ret[<span class=
"org-highlight-numbers-number">1</span>]
<span class=
"linenr">  879: </span>    parentCall = callPath[callPath.length - <span class="org-highlight-numbers-number">1</span>]
<span class="linenr">  880: </span>  }
<span class="linenr">  881: </span>
<span class="linenr">  882: </span>  <span class=
"org-keyword">if</span> (props == <span class=
"org-constant">null</span> || isString(props)) {
<span class=
"linenr">  883: </span>    propsWithInjection = createObjectExpression([prop])
<span class="linenr">  884: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (props.type === NodeTypes.JS_CALL_EXPRESSION) {
<span class="linenr">  885: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">merged props... add ours</span>
<span class="linenr">  886: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">only inject key to object literal if it's the first argument so that</span>
<span class="linenr">  887: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if doesn't override user provided keys</span>
<span class="linenr">  888: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">first</span> = props.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>] | JSChildNode
<span class="linenr">  889: </span>    <span class=
"org-keyword">if</span> (!isString(first) &amp;& first.type === NodeTypes.JS_OBJECT_EXPRESSION) {
<span class=
"linenr">  890: </span>      first.properties.unshift(prop)
<span class="linenr">  891: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">  892: </span>      <span class=
"org-keyword">if</span> (props.callee === TO_HANDLERS) {
<span class="linenr">  893: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#2366</span>
<span class=
"linenr">  894: </span>        propsWithInjection = createCallExpression(context.helper(MERGE_PROPS), [
<span class=
"linenr">  895: </span>          createObjectExpression([prop]),
<span class="linenr">  896: </span>          props
<span class="linenr">  897: </span>        ])
<span class="linenr">  898: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">  899: </span>        props.<span class=
"org-constant">arguments</span>.unshift(createObjectExpression([prop]))
<span class="linenr">  900: </span>      }
<span class="linenr">  901: </span>    }
<span class=
"linenr">  902: </span>    !propsWithInjection &amp;& (propsWithInjection = props)
<span class="linenr">  903: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (props.type === NodeTypes.JS_OBJECT_EXPRESSION) {
<span class="linenr">  904: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">alreadyExists</span> = <span class=
"org-constant">false</span>
<span class="linenr">  905: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check existing key to avoid overriding user provided keys</span>
<span class="linenr">  906: </span>    <span class=
"org-keyword">if</span> (prop.key.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr">  907: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">propKeyName</span> = prop.key.content
<span class=
"linenr">  908: </span>      alreadyExists = props.properties.some(
<span class="linenr">  909: </span>        p =&gt;
<span class=
"linenr">  910: </span>          p.key.type === NodeTypes.SIMPLE_EXPRESSION &amp;&
<span class=
"linenr">  911: </span>          p.key.content === propKeyName
<span class="linenr">  912: </span>      )
<span class="linenr">  913: </span>    }
<span class="linenr">  914: </span>    <span class=
"org-keyword">if</span> (!alreadyExists) {
<span class=
"linenr">  915: </span>      props.properties.unshift(prop)
<span class="linenr">  916: </span>    }
<span class="linenr">  917: </span>    propsWithInjection = props
<span class="linenr">  918: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">  919: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">single v-bind with expression, return a merged replacement</span>
<span class=
"linenr">  920: </span>    propsWithInjection = createCallExpression(context.helper(MERGE_PROPS), [
<span class=
"linenr">  921: </span>      createObjectExpression([prop]),
<span class="linenr">  922: </span>      props
<span class="linenr">  923: </span>    ])
<span class="linenr">  924: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in the case of nested helper call, e.g. `normalizeProps(guardReactiveProps(props))`,</span>
<span class="linenr">  925: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">it will be rewritten as `normalizeProps(mergeProps({ key: 0 }, props))`,</span>
<span class="linenr">  926: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the `guardReactiveProps` will no longer be needed</span>
<span class="linenr">  927: </span>    <span class=
"org-keyword">if</span> (parentCall &amp;& parentCall.callee === GUARD_REACTIVE_PROPS) {
<span class=
"linenr">  928: </span>      parentCall = callPath[callPath.length - <span class="org-highlight-numbers-number">2</span>]
<span class="linenr">  929: </span>    }
<span class="linenr">  930: </span>  }
<span class="linenr">  931: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.VNODE_CALL) {
<span class="linenr">  932: </span>    <span class=
"org-keyword">if</span> (parentCall) {
<span class="linenr">  933: </span>      parentCall.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>] = propsWithInjection
<span class="linenr">  934: </span>    } <span class=
"org-keyword">else</span> {
<span class=
"linenr">  935: </span>      node.props = propsWithInjection
<span class="linenr">  936: </span>    }
<span class="linenr">  937: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">  938: </span>    <span class=
"org-keyword">if</span> (parentCall) {
<span class="linenr">  939: </span>      parentCall.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>] = propsWithInjection
<span class="linenr">  940: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">  941: </span>      node.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">2</span>] = propsWithInjection
<span class="linenr">  942: </span>    }
<span class="linenr">  943: </span>  }
<span class="linenr">  944: </span>}
<span class="linenr">  945: </span>
<span class="linenr">  946: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">BindingTypes</span> = {
<span class="linenr">  947: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  948: </span><span class=
"org-doc">   * returned from data()</span>
<span class="linenr">  949: </span><span class=
"org-doc">   */</span>
<span class="linenr">  950: </span>  DATA: <span class=
"org-string">'data'</span>,
<span class="linenr">  951: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  952: </span><span class=
"org-doc">   * declared as a prop</span>
<span class="linenr">  953: </span><span class=
"org-doc">   */</span>
<span class="linenr">  954: </span>  PROPS: <span class=
"org-string">'props'</span>,
<span class="linenr">  955: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  956: </span><span class=
"org-doc">   * a local alias of a `&lt;script setup&gt;` destructured prop.</span>
<span class="linenr">  957: </span><span class=
"org-doc">   * the original is stored in __propsAliases of the bindingMetadata object.</span>
<span class="linenr">  958: </span><span class=
"org-doc">   */</span>
<span class="linenr">  959: </span>  PROPS_ALIASED: <span class=
"org-string">'props-aliased'</span>,
<span class="linenr">  960: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  961: </span><span class=
"org-doc">   * a let binding (may or may not be a ref)</span>
<span class="linenr">  962: </span><span class=
"org-doc">   */</span>
<span class="linenr">  963: </span>  SETUP_LET: <span class=
"org-string">'setup-let'</span>,
<span class="linenr">  964: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  965: </span><span class=
"org-doc">   * a const binding that can never be a ref.</span>
<span class="linenr">  966: </span><span class=
"org-doc">   * these bindings don't need `unref()` calls when processed in inlined</span>
<span class="linenr">  967: </span><span class=
"org-doc">   * template expressions.</span>
<span class="linenr">  968: </span><span class=
"org-doc">   */</span>
<span class="linenr">  969: </span>  SETUP_CONST: <span class=
"org-string">'setup-const'</span>,
<span class="linenr">  970: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  971: </span><span class=
"org-doc">   * a const binding that may be a ref.</span>
<span class="linenr">  972: </span><span class=
"org-doc">   */</span>
<span class="linenr">  973: </span>  SETUP_MAYBE_REF: <span class=
"org-string">'setup-maybe-ref'</span>,
<span class="linenr">  974: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  975: </span><span class=
"org-doc">   * bindings that are guaranteed to be refs</span>
<span class="linenr">  976: </span><span class=
"org-doc">   */</span>
<span class="linenr">  977: </span>  SETUP_REF: <span class=
"org-string">'setup-ref'</span>,
<span class="linenr">  978: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">  979: </span><span class=
"org-doc">   * declared by other options, e.g. computed, inject</span>
<span class="linenr">  980: </span><span class=
"org-doc">   */</span>
<span class="linenr">  981: </span>  OPTIONS: <span class=
"org-string">'options'</span>
<span class="linenr">  982: </span>}
<span class="linenr">  983: </span>
<span class="linenr">  984: </span><span class=
"org-keyword">class</span> WalkerBase {
<span class="linenr">  985: </span>  constructor() {
<span class="linenr">  986: </span>    <span class=
"org-doc">/** @type {boolean} */</span>
<span class="linenr">  987: </span>    <span class=
"org-constant">this</span>.should_skip = <span class=
"org-constant">false</span>
<span class="linenr">  988: </span>
<span class="linenr">  989: </span>    <span class=
"org-doc">/** @type {boolean} */</span>
<span class="linenr">  990: </span>    <span class=
"org-constant">this</span>.should_remove = <span class=
"org-constant">false</span>
<span class="linenr">  991: </span>
<span class="linenr">  992: </span>    <span class=
"org-doc">/** @type {BaseNode | null} */</span>
<span class="linenr">  993: </span>    <span class=
"org-constant">this</span>.replacement = <span class=
"org-constant">null</span>
<span class="linenr">  994: </span>
<span class="linenr">  995: </span>    <span class=
"org-doc">/** @type {WalkerContext} */</span>
<span class="linenr">  996: </span>    <span class=
"org-constant">this</span>.context = {
<span class=
"linenr">  997: </span>      skip: () =&gt; (<span class=
"org-constant">this</span>.should_skip = <span class=
"org-constant">true</span>),
<span class=
"linenr">  998: </span>      remove: () =&gt; (<span class=
"org-constant">this</span>.should_remove = <span class=
"org-constant">true</span>),
<span class=
"linenr">  999: </span>      replace: (node) =&gt; (<span class=
"org-constant">this</span>.replacement = node)
<span class="linenr"> 1000: </span>    }
<span class="linenr"> 1001: </span>  }
<span class="linenr"> 1002: </span>
<span class=
"linenr"> 1003: </span>  replace(parent, prop, index, node) {
<span class="linenr"> 1004: </span>    <span class=
"org-keyword">if</span> (parent) {
<span class="linenr"> 1005: </span>      <span class=
"org-keyword">if</span> (index !== <span class=
"org-constant">null</span>) {
<span class=
"linenr"> 1006: </span>        parent[prop][index] = node
<span class="linenr"> 1007: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 1008: </span>        parent[prop] = node
<span class="linenr"> 1009: </span>      }
<span class="linenr"> 1010: </span>    }
<span class="linenr"> 1011: </span>  }
<span class="linenr"> 1012: </span>
<span class="linenr"> 1013: </span>  remove(parent, prop, index) {
<span class="linenr"> 1014: </span>    <span class=
"org-keyword">if</span> (parent) {
<span class="linenr"> 1015: </span>      <span class=
"org-keyword">if</span> (index !== <span class=
"org-constant">null</span>) {
<span class=
"linenr"> 1016: </span>        parent[prop].splice(index, <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 1017: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 1018: </span>        <span class=
"org-keyword">delete</span> parent[prop]
<span class="linenr"> 1019: </span>      }
<span class="linenr"> 1020: </span>    }
<span class="linenr"> 1021: </span>  }
<span class="linenr"> 1022: </span>}
<span class="linenr"> 1023: </span>
<span class="linenr"> 1024: </span><span class=
"org-keyword">class</span> SyncWalker <span class=
"org-keyword">extends</span> WalkerBase {
<span class="linenr"> 1025: </span>
<span class="linenr"> 1026: </span>  constructor(enter, leave) {
<span class="linenr"> 1027: </span>    <span class=
"org-keyword">super</span>()
<span class="linenr"> 1028: </span>
<span class="linenr"> 1029: </span>    <span class=
"org-doc">/** @type {SyncHandler} */</span>
<span class="linenr"> 1030: </span>    <span class=
"org-constant">this</span>.enter = enter
<span class="linenr"> 1031: </span>
<span class="linenr"> 1032: </span>    <span class=
"org-doc">/** @type {SyncHandler} */</span>
<span class="linenr"> 1033: </span>    <span class=
"org-constant">this</span>.leave = leave
<span class="linenr"> 1034: </span>  }
<span class="linenr"> 1035: </span>
<span class=
"linenr"> 1036: </span>  visit(node, parent, prop, index) {
<span class="linenr"> 1037: </span>    <span class=
"org-keyword">if</span> (node) {
<span class="linenr"> 1038: </span>      <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.enter) {
<span class="linenr"> 1039: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_should_skip</span> = <span class=
"org-constant">this</span>.should_skip
<span class="linenr"> 1040: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_should_remove</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1041: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_replacement</span> = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1042: </span>        <span class=
"org-constant">this</span>.should_skip = <span class=
"org-constant">false</span>
<span class="linenr"> 1043: </span>        <span class=
"org-constant">this</span>.should_remove = <span class=
"org-constant">false</span>
<span class="linenr"> 1044: </span>        <span class=
"org-constant">this</span>.replacement = <span class=
"org-constant">null</span>
<span class="linenr"> 1045: </span>
<span class="linenr"> 1046: </span>        <span class=
"org-constant">this</span>.enter.call(<span class=
"org-constant">this</span>.context, node, parent, prop, index)
<span class="linenr"> 1047: </span>
<span class="linenr"> 1048: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.replacement) {
<span class="linenr"> 1049: </span>          node = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1050: </span>          <span class=
"org-constant">this</span>.replace(parent, prop, index, node)
<span class="linenr"> 1051: </span>        }
<span class="linenr"> 1052: </span>
<span class="linenr"> 1053: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.should_remove) {
<span class="linenr"> 1054: </span>          <span class=
"org-constant">this</span>.remove(parent, prop, index)
<span class="linenr"> 1055: </span>        }
<span class="linenr"> 1056: </span>
<span class="linenr"> 1057: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">skipped</span> = <span class=
"org-constant">this</span>.should_skip
<span class="linenr"> 1058: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">removed</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1059: </span>
<span class="linenr"> 1060: </span>        <span class=
"org-constant">this</span>.should_skip = _should_skip
<span class="linenr"> 1061: </span>        <span class=
"org-constant">this</span>.should_remove = _should_remove
<span class="linenr"> 1062: </span>        <span class=
"org-constant">this</span>.replacement = _replacement
<span class="linenr"> 1063: </span>
<span class="linenr"> 1064: </span>        <span class=
"org-keyword">if</span> (skipped) <span class=
"org-keyword">return</span> node
<span class="linenr"> 1065: </span>        <span class=
"org-keyword">if</span> (removed) <span class=
"org-keyword">return</span> <span class="org-constant">null</span>
<span class="linenr"> 1066: </span>      }
<span class="linenr"> 1067: </span>
<span class="linenr"> 1068: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> node) {
<span class="linenr"> 1069: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">value</span> = node[key]
<span class="linenr"> 1070: </span>
<span class="linenr"> 1071: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-keyword">typeof</span> value !== <span class=
"org-string">'object'</span>) {
<span class="linenr"> 1072: </span>          <span class=
"org-keyword">continue</span>
<span class="linenr"> 1073: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (Array.isArray(value)) {
<span class="linenr"> 1074: </span>          <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; value.length; i += <span class="org-highlight-numbers-number">1</span>) {
<span class="linenr"> 1075: </span>            <span class=
"org-keyword">if</span> (value[i] !== <span class=
"org-constant">null</span> &amp;& <span class=
"org-keyword">typeof</span> value[i].type === <span class=
"org-string">'string'</span>) {
<span class="linenr"> 1076: </span>              <span class=
"org-keyword">if</span> (!<span class=
"org-constant">this</span>.visit(value[i], node, key, i)) {
<span class="linenr"> 1077: </span>                <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">removed</span>
<span class="linenr"> 1078: </span>                i--
<span class="linenr"> 1079: </span>              }
<span class="linenr"> 1080: </span>            }
<span class="linenr"> 1081: </span>          }
<span class="linenr"> 1082: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (value !== <span class=
"org-constant">null</span> &amp;& <span class=
"org-keyword">typeof</span> value.type === <span class=
"org-string">'string'</span>) {
<span class="linenr"> 1083: </span>          <span class=
"org-constant">this</span>.visit(value, node, key, <span class=
"org-constant">null</span>)
<span class="linenr"> 1084: </span>        }
<span class="linenr"> 1085: </span>      }
<span class="linenr"> 1086: </span>
<span class="linenr"> 1087: </span>      <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.leave) {
<span class="linenr"> 1088: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_replacement</span> = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1089: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_should_remove</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1090: </span>        <span class=
"org-constant">this</span>.replacement = <span class=
"org-constant">null</span>
<span class="linenr"> 1091: </span>        <span class=
"org-constant">this</span>.should_remove = <span class=
"org-constant">false</span>
<span class="linenr"> 1092: </span>
<span class="linenr"> 1093: </span>        <span class=
"org-constant">this</span>.leave.call(<span class=
"org-constant">this</span>.context, node, parent, prop, index)
<span class="linenr"> 1094: </span>
<span class="linenr"> 1095: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.replacement) {
<span class="linenr"> 1096: </span>          node = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1097: </span>          <span class=
"org-constant">this</span>.replace(parent, prop, index, node)
<span class="linenr"> 1098: </span>        }
<span class="linenr"> 1099: </span>
<span class="linenr"> 1100: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.should_remove) {
<span class="linenr"> 1101: </span>          <span class=
"org-constant">this</span>.remove(parent, prop, index)
<span class="linenr"> 1102: </span>        }
<span class="linenr"> 1103: </span>
<span class="linenr"> 1104: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">removed</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1105: </span>
<span class="linenr"> 1106: </span>        <span class=
"org-constant">this</span>.replacement = _replacement
<span class="linenr"> 1107: </span>        <span class=
"org-constant">this</span>.should_remove = _should_remove
<span class="linenr"> 1108: </span>
<span class="linenr"> 1109: </span>        <span class=
"org-keyword">if</span> (removed) <span class=
"org-keyword">return</span> <span class="org-constant">null</span>
<span class="linenr"> 1110: </span>      }
<span class="linenr"> 1111: </span>    }
<span class="linenr"> 1112: </span>
<span class="linenr"> 1113: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 1114: </span>  }
<span class="linenr"> 1115: </span>}
<span class="linenr"> 1116: </span>
<span class="linenr"> 1117: </span><span class=
"org-keyword">class</span> AsyncWalker <span class=
"org-keyword">extends</span> WalkerBase {
<span class="linenr"> 1118: </span>
<span class="linenr"> 1119: </span>  constructor(enter, leave) {
<span class="linenr"> 1120: </span>    <span class=
"org-keyword">super</span>()
<span class="linenr"> 1121: </span>
<span class="linenr"> 1122: </span>    <span class=
"org-doc">/** @type {AsyncHandler} */</span>
<span class="linenr"> 1123: </span>    <span class=
"org-constant">this</span>.enter = enter
<span class="linenr"> 1124: </span>
<span class="linenr"> 1125: </span>    <span class=
"org-doc">/** @type {AsyncHandler} */</span>
<span class="linenr"> 1126: </span>    <span class=
"org-constant">this</span>.leave = leave
<span class="linenr"> 1127: </span>  }
<span class="linenr"> 1128: </span>
<span class="linenr"> 1129: </span>  <span class=
"org-keyword">async</span> visit(node, parent, prop, index) {
<span class="linenr"> 1130: </span>    <span class=
"org-keyword">if</span> (node) {
<span class="linenr"> 1131: </span>      <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.enter) {
<span class="linenr"> 1132: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_should_skip</span> = <span class=
"org-constant">this</span>.should_skip
<span class="linenr"> 1133: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_should_remove</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1134: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_replacement</span> = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1135: </span>        <span class=
"org-constant">this</span>.should_skip = <span class=
"org-constant">false</span>
<span class="linenr"> 1136: </span>        <span class=
"org-constant">this</span>.should_remove = <span class=
"org-constant">false</span>
<span class="linenr"> 1137: </span>        <span class=
"org-constant">this</span>.replacement = <span class=
"org-constant">null</span>
<span class="linenr"> 1138: </span>
<span class="linenr"> 1139: </span>        <span class=
"org-keyword">await</span> <span class=
"org-constant">this</span>.enter.call(<span class=
"org-constant">this</span>.context, node, parent, prop, index)
<span class="linenr"> 1140: </span>
<span class="linenr"> 1141: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.replacement) {
<span class="linenr"> 1142: </span>          node = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1143: </span>          <span class=
"org-constant">this</span>.replace(parent, prop, index, node)
<span class="linenr"> 1144: </span>        }
<span class="linenr"> 1145: </span>
<span class="linenr"> 1146: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.should_remove) {
<span class="linenr"> 1147: </span>          <span class=
"org-constant">this</span>.remove(parent, prop, index)
<span class="linenr"> 1148: </span>        }
<span class="linenr"> 1149: </span>
<span class="linenr"> 1150: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">skipped</span> = <span class=
"org-constant">this</span>.should_skip
<span class="linenr"> 1151: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">removed</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1152: </span>
<span class="linenr"> 1153: </span>        <span class=
"org-constant">this</span>.should_skip = _should_skip
<span class="linenr"> 1154: </span>        <span class=
"org-constant">this</span>.should_remove = _should_remove
<span class="linenr"> 1155: </span>        <span class=
"org-constant">this</span>.replacement = _replacement
<span class="linenr"> 1156: </span>
<span class="linenr"> 1157: </span>        <span class=
"org-keyword">if</span> (skipped) <span class=
"org-keyword">return</span> node
<span class="linenr"> 1158: </span>        <span class=
"org-keyword">if</span> (removed) <span class=
"org-keyword">return</span> <span class="org-constant">null</span>
<span class="linenr"> 1159: </span>      }
<span class="linenr"> 1160: </span>
<span class="linenr"> 1161: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> node) {
<span class="linenr"> 1162: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">value</span> = node[key]
<span class="linenr"> 1163: </span>
<span class="linenr"> 1164: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-keyword">typeof</span> value !== <span class=
"org-string">'object'</span>) {
<span class="linenr"> 1165: </span>          <span class=
"org-keyword">continue</span>
<span class="linenr"> 1166: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (Array.isArray(value)) {
<span class="linenr"> 1167: </span>          <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; value.length; i += <span class="org-highlight-numbers-number">1</span>) {
<span class="linenr"> 1168: </span>            <span class=
"org-keyword">if</span> (value[i] !== <span class=
"org-constant">null</span> &amp;& <span class=
"org-keyword">typeof</span> value[i].type === <span class=
"org-string">'string'</span>) {
<span class="linenr"> 1169: </span>              <span class=
"org-keyword">if</span> (!(<span class=
"org-keyword">await</span> <span class=
"org-constant">this</span>.visit(value[i], node, key, i))) {
<span class="linenr"> 1170: </span>                <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">removed</span>
<span class="linenr"> 1171: </span>                i--
<span class="linenr"> 1172: </span>              }
<span class="linenr"> 1173: </span>            }
<span class="linenr"> 1174: </span>          }
<span class="linenr"> 1175: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (value !== <span class=
"org-constant">null</span> &amp;& <span class=
"org-keyword">typeof</span> value.type === <span class=
"org-string">'string'</span>) {
<span class="linenr"> 1176: </span>          <span class=
"org-keyword">await</span> <span class=
"org-constant">this</span>.visit(value, node, key, <span class=
"org-constant">null</span>)
<span class="linenr"> 1177: </span>        }
<span class="linenr"> 1178: </span>      }
<span class="linenr"> 1179: </span>
<span class="linenr"> 1180: </span>      <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.leave) {
<span class="linenr"> 1181: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_replacement</span> = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1182: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">_should_remove</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1183: </span>        <span class=
"org-constant">this</span>.replacement = <span class=
"org-constant">null</span>
<span class="linenr"> 1184: </span>        <span class=
"org-constant">this</span>.should_remove = <span class=
"org-constant">false</span>
<span class="linenr"> 1185: </span>
<span class="linenr"> 1186: </span>        <span class=
"org-keyword">await</span> <span class=
"org-constant">this</span>.leave.call(<span class=
"org-constant">this</span>.context, node, parent, prop, index)
<span class="linenr"> 1187: </span>
<span class="linenr"> 1188: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.replacement) {
<span class="linenr"> 1189: </span>          node = <span class=
"org-constant">this</span>.replacement
<span class="linenr"> 1190: </span>          <span class=
"org-constant">this</span>.replace(parent, prop, index, node)
<span class="linenr"> 1191: </span>        }
<span class="linenr"> 1192: </span>
<span class="linenr"> 1193: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-constant">this</span>.should_remove) {
<span class="linenr"> 1194: </span>          <span class=
"org-constant">this</span>.remove(parent, prop, index)
<span class="linenr"> 1195: </span>        }
<span class="linenr"> 1196: </span>
<span class="linenr"> 1197: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">removed</span> = <span class=
"org-constant">this</span>.should_remove
<span class="linenr"> 1198: </span>
<span class="linenr"> 1199: </span>        <span class=
"org-constant">this</span>.replacement = _replacement
<span class="linenr"> 1200: </span>        <span class=
"org-constant">this</span>.should_remove = _should_remove
<span class="linenr"> 1201: </span>
<span class="linenr"> 1202: </span>        <span class=
"org-keyword">if</span> (removed) <span class=
"org-keyword">return</span> <span class="org-constant">null</span>
<span class="linenr"> 1203: </span>      }
<span class="linenr"> 1204: </span>    }
<span class="linenr"> 1205: </span>
<span class="linenr"> 1206: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 1207: </span>  }
<span class="linenr"> 1208: </span>}
<span class="linenr"> 1209: </span>
<span class="linenr"> 1210: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">walk</span>(<span class=
"org-variable-name">ast</span>, { <span class=
"org-variable-name">enter</span>, <span class=
"org-variable-name">leave</span> }) {
<span class="linenr"> 1211: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">instance</span> = <span class=
"org-keyword">new</span> <span class=
"org-type">SyncWalker</span>(enter, leave)
<span class="linenr"> 1212: </span>  <span class=
"org-keyword">return</span> instance.visit(ast, <span class=
"org-constant">null</span>)
<span class="linenr"> 1213: </span>}
<span class="linenr"> 1214: </span>
<span class="linenr"> 1215: </span><span class=
"org-keyword">async</span> <span class=
"org-keyword">function</span> asyncWalk(<span class=
"org-variable-name">ast</span>, { <span class=
"org-variable-name">enter</span>, <span class=
"org-variable-name">leave</span> }) {
<span class="linenr"> 1216: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">instance</span> = <span class=
"org-keyword">new</span> <span class=
"org-type">AsyncWalker</span>(enter, leave)
<span class="linenr"> 1217: </span>  <span class=
"org-keyword">return</span> <span class=
"org-keyword">await</span> instance.visit(ast, <span class=
"org-constant">null</span>)
<span class="linenr"> 1218: </span>}
<span class="linenr"> 1219: </span>
<span class="linenr"> 1220: </span>
<span class="linenr"> 1221: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isInDestructureAssignment</span>(
<span class="linenr"> 1222: </span>  <span class=
"org-variable-name">parent</span>,
<span class="linenr"> 1223: </span>  parentStack
<span class="linenr"> 1224: </span>) {
<span class="linenr"> 1225: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 1226: </span>    parent &amp;&
<span class=
"linenr"> 1227: </span>    (parent.type === <span class="org-string">'ObjectProperty'</span> || parent.type === <span class="org-string">'ArrayPattern'</span>)
<span class="linenr"> 1228: </span>  ) {
<span class="linenr"> 1229: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = parentStack.length
<span class="linenr"> 1230: </span>    <span class=
"org-keyword">while</span> (i--) {
<span class="linenr"> 1231: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = parentStack[i]
<span class="linenr"> 1232: </span>      <span class=
"org-keyword">if</span> (p.type === <span class=
"org-string">'AssignmentExpression'</span>) {
<span class="linenr"> 1233: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1234: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.type !== <span class=
"org-string">'ObjectProperty'</span> &amp;& !p.type.endsWith(<span class="org-string">'Pattern'</span>)) {
<span class="linenr"> 1235: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 1236: </span>      }
<span class="linenr"> 1237: </span>    }
<span class="linenr"> 1238: </span>  }
<span class="linenr"> 1239: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1240: </span>}
<span class="linenr"> 1241: </span>
<span class="linenr"> 1242: </span>
<span class="linenr"> 1243: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">walkIdentifiers</span>(
<span class="linenr"> 1244: </span>  <span class=
"org-variable-name">root</span>,
<span class="linenr"> 1245: </span>  <span class=
"org-variable-name">onIdentifier</span>,
<span class="linenr"> 1246: </span>  includeAll = <span class=
"org-constant">false</span>,
<span class="linenr"> 1247: </span>  parentStack = [],
<span class=
"linenr"> 1248: </span>  knownIds = Object.create(<span class=
"org-constant">null</span>)
<span class="linenr"> 1249: </span>) {
<span class="linenr"> 1250: </span>  <span class=
"org-keyword">if</span> (__BROWSER__) {
<span class="linenr"> 1251: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 1252: </span>  }
<span class="linenr"> 1253: </span>
<span class="linenr"> 1254: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rootExp</span> =
<span class="linenr"> 1255: </span>    root.type === <span class=
"org-string">'Program'</span> &amp;&
<span class="linenr"> 1256: </span>    root.body[<span class=
"org-highlight-numbers-number">0</span>].type === <span class=
"org-string">'ExpressionStatement'</span> &amp;&
<span class="linenr"> 1257: </span>    root.body[<span class=
"org-highlight-numbers-number">0</span>].expression
<span class="linenr"> 1258: </span>
<span class="linenr"> 1259: </span>  walk(root, {
<span class="linenr"> 1260: </span>    enter(node, parent) {
<span class=
"linenr"> 1261: </span>      parent &amp;& parentStack.push(parent)
<span class="linenr"> 1262: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 1263: </span>        parent &amp;&
<span class=
"linenr"> 1264: </span>        parent.type.startsWith(<span class=
"org-string">'TS'</span>) &amp;&
<span class=
"linenr"> 1265: </span>        parent.type !== <span class=
"org-string">'TSAsExpression'</span> &amp;&
<span class=
"linenr"> 1266: </span>        parent.type !== <span class=
"org-string">'TSNonNullExpression'</span> &amp;&
<span class=
"linenr"> 1267: </span>        parent.type !== <span class=
"org-string">'TSTypeAssertion'</span>
<span class="linenr"> 1268: </span>      ) {
<span class="linenr"> 1269: </span>        <span class=
"org-keyword">return</span> <span class=
"org-constant">this</span>.skip()
<span class="linenr"> 1270: </span>      }
<span class="linenr"> 1271: </span>      <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr"> 1272: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isLocal</span> = !!knownIds[node.name]
<span class="linenr"> 1273: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isRefed</span> = isReferencedIdentifier(node, parent, parentStack)
<span class="linenr"> 1274: </span>        <span class=
"org-keyword">if</span> (includeAll || (isRefed &amp;& !isLocal)) {
<span class=
"linenr"> 1275: </span>          onIdentifier(node, parent, parentStack, isRefed, isLocal)
<span class="linenr"> 1276: </span>        }
<span class="linenr"> 1277: </span>      } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr"> 1278: </span>        node.type === <span class=
"org-string">'ObjectProperty'</span> &amp;&
<span class=
"linenr"> 1279: </span>        parent.type === <span class=
"org-string">'ObjectPattern'</span>
<span class="linenr"> 1280: </span>      ) {
<span class="linenr"> 1281: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">mark property in destructure pattern</span>
<span class=
"linenr"> 1282: </span>        node.inPattern = <span class=
"org-constant">true</span>
<span class="linenr"> 1283: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isFunctionType(node)) {
<span class="linenr"> 1284: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">walk function expressions and add its arguments to known identifiers</span>
<span class="linenr"> 1285: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">so that we don't prefix them</span>
<span class=
"linenr"> 1286: </span>        walkFunctionParams(node, id =&gt; markScopeIdentifier(node, id, knownIds))
<span class="linenr"> 1287: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'BlockStatement'</span>) {
<span class="linenr"> 1288: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#3445 record block-level local variables</span>
<span class=
"linenr"> 1289: </span>        walkBlockDeclarations(node, id =&gt;
<span class=
"linenr"> 1290: </span>          markScopeIdentifier(node, id, knownIds)
<span class="linenr"> 1291: </span>        )
<span class="linenr"> 1292: </span>      }
<span class="linenr"> 1293: </span>    },
<span class="linenr"> 1294: </span>    leave(node, parent) {
<span class=
"linenr"> 1295: </span>      parent &amp;& parentStack.pop()
<span class="linenr"> 1296: </span>      <span class=
"org-keyword">if</span> (node !== rootExp &amp;& node.scopeIds) {
<span class="linenr"> 1297: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">id</span> <span class=
"org-keyword">of</span> node.scopeIds) {
<span class="linenr"> 1298: </span>          knownIds[id]--
<span class="linenr"> 1299: </span>          <span class=
"org-keyword">if</span> (knownIds[id] === <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 1300: </span>            <span class=
"org-keyword">delete</span> knownIds[id]
<span class="linenr"> 1301: </span>          }
<span class="linenr"> 1302: </span>        }
<span class="linenr"> 1303: </span>      }
<span class="linenr"> 1304: </span>    }
<span class="linenr"> 1305: </span>  })
<span class="linenr"> 1306: </span>}
<span class="linenr"> 1307: </span>
<span class="linenr"> 1308: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isReferencedIdentifier</span>(
<span class="linenr"> 1309: </span>  <span class=
"org-variable-name">id</span>,
<span class="linenr"> 1310: </span>  <span class=
"org-variable-name">parent</span>,
<span class="linenr"> 1311: </span>  parentStack
<span class="linenr"> 1312: </span>) {
<span class="linenr"> 1313: </span>  <span class=
"org-keyword">if</span> (__BROWSER__) {
<span class="linenr"> 1314: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1315: </span>  }
<span class="linenr"> 1316: </span>
<span class="linenr"> 1317: </span>  <span class=
"org-keyword">if</span> (!parent) {
<span class="linenr"> 1318: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1319: </span>  }
<span class="linenr"> 1320: </span>
<span class="linenr"> 1321: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">is a special keyword but parsed as identifier</span>
<span class="linenr"> 1322: </span>  <span class=
"org-keyword">if</span> (id.name === <span class=
"org-string">'arguments'</span>) {
<span class="linenr"> 1323: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1324: </span>  }
<span class="linenr"> 1325: </span>
<span class="linenr"> 1326: </span>  <span class=
"org-keyword">if</span> (isReferenced(id, parent)) {
<span class="linenr"> 1327: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1328: </span>  }
<span class="linenr"> 1329: </span>
<span class="linenr"> 1330: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">babel's isReferenced check returns false for ids being assigned to, so we</span>
<span class="linenr"> 1331: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">need to cover those cases here</span>
<span class="linenr"> 1332: </span>  <span class=
"org-keyword">switch</span> (parent.type) {
<span class="linenr"> 1333: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'AssignmentExpression'</span>:
<span class="linenr"> 1334: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'AssignmentPattern'</span>:
<span class="linenr"> 1335: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1336: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ObjectPattern'</span>:
<span class="linenr"> 1337: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ArrayPattern'</span>:
<span class="linenr"> 1338: </span>      <span class=
"org-keyword">return</span> isInDestructureAssignment(parent, parentStack)
<span class="linenr"> 1339: </span>  }
<span class="linenr"> 1340: </span>
<span class="linenr"> 1341: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1342: </span>}
<span class="linenr"> 1343: </span>
<span class="linenr"> 1344: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isInDestructureAssignment</span>(
<span class="linenr"> 1345: </span>  <span class=
"org-variable-name">parent</span>,
<span class="linenr"> 1346: </span>  parentStack
<span class="linenr"> 1347: </span>) {
<span class="linenr"> 1348: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 1349: </span>    parent &amp;&
<span class=
"linenr"> 1350: </span>    (parent.type === <span class="org-string">'ObjectProperty'</span> || parent.type === <span class="org-string">'ArrayPattern'</span>)
<span class="linenr"> 1351: </span>  ) {
<span class="linenr"> 1352: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = parentStack.length
<span class="linenr"> 1353: </span>    <span class=
"org-keyword">while</span> (i--) {
<span class="linenr"> 1354: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = parentStack[i]
<span class="linenr"> 1355: </span>      <span class=
"org-keyword">if</span> (p.type === <span class=
"org-string">'AssignmentExpression'</span>) {
<span class="linenr"> 1356: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1357: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.type !== <span class=
"org-string">'ObjectProperty'</span> &amp;& !p.type.endsWith(<span class="org-string">'Pattern'</span>)) {
<span class="linenr"> 1358: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 1359: </span>      }
<span class="linenr"> 1360: </span>    }
<span class="linenr"> 1361: </span>  }
<span class="linenr"> 1362: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1363: </span>}
<span class="linenr"> 1364: </span>
<span class="linenr"> 1365: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">walkFunctionParams</span>(
<span class="linenr"> 1366: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 1367: </span>  onIdent
<span class="linenr"> 1368: </span>) {
<span class="linenr"> 1369: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> <span class=
"org-keyword">of</span> node.params) {
<span class="linenr"> 1370: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">id</span> <span class=
"org-keyword">of</span> extractIdentifiers(p)) {
<span class="linenr"> 1371: </span>      onIdent(id)
<span class="linenr"> 1372: </span>    }
<span class="linenr"> 1373: </span>  }
<span class="linenr"> 1374: </span>}
<span class="linenr"> 1375: </span>
<span class="linenr"> 1376: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">walkBlockDeclarations</span>(
<span class="linenr"> 1377: </span>  <span class=
"org-variable-name">block</span>,
<span class="linenr"> 1378: </span>  onIdent
<span class="linenr"> 1379: </span>) {
<span class="linenr"> 1380: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">stmt</span> <span class=
"org-keyword">of</span> block.body) {
<span class="linenr"> 1381: </span>    <span class=
"org-keyword">if</span> (stmt.type === <span class=
"org-string">'VariableDeclaration'</span>) {
<span class="linenr"> 1382: </span>      <span class=
"org-keyword">if</span> (stmt.declare) <span class=
"org-keyword">continue</span>
<span class="linenr"> 1383: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">decl</span> <span class=
"org-keyword">of</span> stmt.declarations) {
<span class="linenr"> 1384: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">id</span> <span class=
"org-keyword">of</span> extractIdentifiers(decl.id)) {
<span class="linenr"> 1385: </span>          onIdent(id)
<span class="linenr"> 1386: </span>        }
<span class="linenr"> 1387: </span>      }
<span class="linenr"> 1388: </span>    } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class="linenr"> 1389: </span>      stmt.type === <span class=
"org-string">'FunctionDeclaration'</span> ||
<span class="linenr"> 1390: </span>      stmt.type === <span class=
"org-string">'ClassDeclaration'</span>
<span class="linenr"> 1391: </span>    ) {
<span class="linenr"> 1392: </span>      <span class=
"org-keyword">if</span> (stmt.declare || !stmt.id) <span class=
"org-keyword">continue</span>
<span class="linenr"> 1393: </span>      onIdent(stmt.id)
<span class="linenr"> 1394: </span>    }
<span class="linenr"> 1395: </span>  }
<span class="linenr"> 1396: </span>}
<span class="linenr"> 1397: </span>
<span class="linenr"> 1398: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">extractIdentifiers</span>(
<span class="linenr"> 1399: </span>  <span class=
"org-variable-name">param</span>,
<span class="linenr"> 1400: </span>  nodes = []
<span class="linenr"> 1401: </span>) {
<span class="linenr"> 1402: </span>  <span class=
"org-keyword">switch</span> (param.type) {
<span class="linenr"> 1403: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'Identifier'</span>:
<span class="linenr"> 1404: </span>      nodes.push(param)
<span class="linenr"> 1405: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 1406: </span>
<span class="linenr"> 1407: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'MemberExpression'</span>:
<span class="linenr"> 1408: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">object</span> = param
<span class="linenr"> 1409: </span>      <span class=
"org-keyword">while</span> (object.type === <span class=
"org-string">'MemberExpression'</span>) {
<span class="linenr"> 1410: </span>        object = object.object
<span class="linenr"> 1411: </span>      }
<span class="linenr"> 1412: </span>      nodes.push(object)
<span class="linenr"> 1413: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 1414: </span>
<span class="linenr"> 1415: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ObjectPattern'</span>:
<span class="linenr"> 1416: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">prop</span> <span class=
"org-keyword">of</span> param.properties) {
<span class="linenr"> 1417: </span>        <span class=
"org-keyword">if</span> (prop.type === <span class=
"org-string">'RestElement'</span>) {
<span class=
"linenr"> 1418: </span>          extractIdentifiers(prop.argument, nodes)
<span class="linenr"> 1419: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 1420: </span>          extractIdentifiers(prop.value, nodes)
<span class="linenr"> 1421: </span>        }
<span class="linenr"> 1422: </span>      }
<span class="linenr"> 1423: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 1424: </span>
<span class="linenr"> 1425: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ArrayPattern'</span>:
<span class=
"linenr"> 1426: </span>      param.elements.forEach(element =&gt; {
<span class="linenr"> 1427: </span>        <span class=
"org-keyword">if</span> (element) extractIdentifiers(element, nodes)
<span class="linenr"> 1428: </span>      })
<span class="linenr"> 1429: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 1430: </span>
<span class="linenr"> 1431: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'RestElement'</span>:
<span class=
"linenr"> 1432: </span>      extractIdentifiers(param.argument, nodes)
<span class="linenr"> 1433: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 1434: </span>
<span class="linenr"> 1435: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'AssignmentPattern'</span>:
<span class=
"linenr"> 1436: </span>      extractIdentifiers(param.left, nodes)
<span class="linenr"> 1437: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 1438: </span>  }
<span class="linenr"> 1439: </span>
<span class="linenr"> 1440: </span>  <span class=
"org-keyword">return</span> nodes
<span class="linenr"> 1441: </span>}
<span class="linenr"> 1442: </span>
<span class="linenr"> 1443: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">markScopeIdentifier</span>(
<span class="linenr"> 1444: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 1445: </span>  <span class=
"org-variable-name">child</span>,
<span class="linenr"> 1446: </span>  knownIds
<span class="linenr"> 1447: </span>) {
<span class="linenr"> 1448: </span>  <span class=
"org-keyword">const</span> { name } = child
<span class="linenr"> 1449: </span>  <span class=
"org-keyword">if</span> (node.scopeIds &amp;& node.scopeIds.has(name)) {
<span class="linenr"> 1450: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 1451: </span>  }
<span class="linenr"> 1452: </span>  <span class=
"org-keyword">if</span> (name <span class=
"org-keyword">in</span> knownIds) {
<span class="linenr"> 1453: </span>    knownIds[name]++
<span class="linenr"> 1454: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 1455: </span>    knownIds[name] = <span class="org-highlight-numbers-number">1</span>
<span class="linenr"> 1456: </span>  }
<span class=
"linenr"> 1457: </span>  ;(node.scopeIds || (node.scopeIds = <span class="org-keyword">new</span> <span class="org-type">Set</span>())).add(name)
<span class="linenr"> 1458: </span>}
<span class="linenr"> 1459: </span>
<span class="linenr"> 1460: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isFunctionType</span> = (node) =&gt; {
<span class="linenr"> 1461: </span>  <span class=
"org-keyword">return</span> <span class=
"org-string">/Function(?:Expression|Declaration)$|Method$/</span>.test(node.type)
<span class="linenr"> 1462: </span>}
<span class="linenr"> 1463: </span>
<span class="linenr"> 1464: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isStaticProperty</span> = (node) =&gt;
<span class="linenr"> 1465: </span>  node &amp;&
<span class="linenr"> 1466: </span>  (node.type === <span class=
"org-string">'ObjectProperty'</span> || node.type === <span class=
"org-string">'ObjectMethod'</span>) &amp;&
<span class="linenr"> 1467: </span>  !node.computed
<span class="linenr"> 1468: </span>
<span class="linenr"> 1469: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isStaticPropertyKey</span> = (node, parent) =&gt; isStaticProperty(parent) &amp;& parent.key === node
<span class="linenr"> 1470: </span>
<span class="linenr"> 1471: </span><span class="org-doc">/**</span>
<span class="linenr"> 1472: </span><span class=
"org-doc"> * Copied from https://github.com/babel/babel/blob/main/packages/babel-types/src/validators/isReferenced.ts</span>
<span class="linenr"> 1473: </span><span class=
"org-doc"> * To avoid runtime dependency on @babel/types (which includes process references)</span>
<span class="linenr"> 1474: </span><span class=
"org-doc"> * This file should not change very often in babel but we may need to keep it</span>
<span class="linenr"> 1475: </span><span class=
"org-doc"> * up-to-date from time to time.</span>
<span class="linenr"> 1476: </span><span class="org-doc"> *</span>
<span class="linenr"> 1477: </span><span class=
"org-doc"> * https://github.com/babel/babel/blob/main/LICENSE</span>
<span class="linenr"> 1478: </span><span class="org-doc"> *</span>
<span class="linenr"> 1479: </span><span class="org-doc"> */</span>
<span class="linenr"> 1480: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isReferenced</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">parent</span>, <span class=
"org-variable-name">grandparent</span>) {
<span class="linenr"> 1481: </span>  <span class=
"org-keyword">switch</span> (parent.type) {
<span class="linenr"> 1482: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: PARENT[NODE]</span>
<span class="linenr"> 1483: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: NODE.child</span>
<span class="linenr"> 1484: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: parent.NODE</span>
<span class="linenr"> 1485: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'MemberExpression'</span>:
<span class="linenr"> 1486: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'OptionalMemberExpression'</span>:
<span class="linenr"> 1487: </span>      <span class=
"org-keyword">if</span> (parent.property === node) {
<span class="linenr"> 1488: </span>        <span class=
"org-keyword">return</span> !!parent.computed
<span class="linenr"> 1489: </span>      }
<span class="linenr"> 1490: </span>      <span class=
"org-keyword">return</span> parent.object === node
<span class="linenr"> 1491: </span>
<span class="linenr"> 1492: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'JSXMemberExpression'</span>:
<span class="linenr"> 1493: </span>      <span class=
"org-keyword">return</span> parent.object === node
<span class="linenr"> 1494: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: let NODE = init;</span>
<span class="linenr"> 1495: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: let id = NODE;</span>
<span class="linenr"> 1496: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'VariableDeclarator'</span>:
<span class="linenr"> 1497: </span>      <span class=
"org-keyword">return</span> parent.init === node
<span class="linenr"> 1498: </span>
<span class="linenr"> 1499: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: () =&gt; NODE</span>
<span class="linenr"> 1500: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: (NODE) =&gt; {}</span>
<span class="linenr"> 1501: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ArrowFunctionExpression'</span>:
<span class="linenr"> 1502: </span>      <span class=
"org-keyword">return</span> parent.body === node
<span class="linenr"> 1503: </span>
<span class="linenr"> 1504: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class { #NODE; }</span>
<span class="linenr"> 1505: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class { get #NODE() {} }</span>
<span class="linenr"> 1506: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class { #NODE() {} }</span>
<span class="linenr"> 1507: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class { fn() { return this.#NODE; } }</span>
<span class="linenr"> 1508: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'PrivateName'</span>:
<span class="linenr"> 1509: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1510: </span>
<span class="linenr"> 1511: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class { NODE() {} }</span>
<span class="linenr"> 1512: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: class { [NODE]() {} }</span>
<span class="linenr"> 1513: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class { foo(NODE) {} }</span>
<span class="linenr"> 1514: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ClassMethod'</span>:
<span class="linenr"> 1515: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ClassPrivateMethod'</span>:
<span class="linenr"> 1516: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ObjectMethod'</span>:
<span class="linenr"> 1517: </span>      <span class=
"org-keyword">if</span> (parent.key === node) {
<span class="linenr"> 1518: </span>        <span class=
"org-keyword">return</span> !!parent.computed
<span class="linenr"> 1519: </span>      }
<span class="linenr"> 1520: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1521: </span>
<span class="linenr"> 1522: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: { [NODE]: "" }</span>
<span class="linenr"> 1523: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: { NODE: "" }</span>
<span class="linenr"> 1524: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">depends: { NODE }</span>
<span class="linenr"> 1525: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">depends: { key: NODE }</span>
<span class="linenr"> 1526: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ObjectProperty'</span>:
<span class="linenr"> 1527: </span>      <span class=
"org-keyword">if</span> (parent.key === node) {
<span class="linenr"> 1528: </span>        <span class=
"org-keyword">return</span> !!parent.computed
<span class="linenr"> 1529: </span>      }
<span class="linenr"> 1530: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">parent.value === node</span>
<span class="linenr"> 1531: </span>      <span class=
"org-keyword">return</span> !grandparent || grandparent.type !== <span class="org-string">'ObjectPattern'</span>
<span class="linenr"> 1532: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class { NODE = value; }</span>
<span class="linenr"> 1533: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: class { [NODE] = value; }</span>
<span class="linenr"> 1534: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: class { key = NODE; }</span>
<span class="linenr"> 1535: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ClassProperty'</span>:
<span class="linenr"> 1536: </span>      <span class=
"org-keyword">if</span> (parent.key === node) {
<span class="linenr"> 1537: </span>        <span class=
"org-keyword">return</span> !!parent.computed
<span class="linenr"> 1538: </span>      }
<span class="linenr"> 1539: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1540: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ClassPrivateProperty'</span>:
<span class="linenr"> 1541: </span>      <span class=
"org-keyword">return</span> parent.key !== node
<span class="linenr"> 1542: </span>
<span class="linenr"> 1543: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: class NODE {}</span>
<span class="linenr"> 1544: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: class Foo extends NODE {}</span>
<span class="linenr"> 1545: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ClassDeclaration'</span>:
<span class="linenr"> 1546: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ClassExpression'</span>:
<span class="linenr"> 1547: </span>      <span class=
"org-keyword">return</span> parent.superClass === node
<span class="linenr"> 1548: </span>
<span class="linenr"> 1549: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: left = NODE;</span>
<span class="linenr"> 1550: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: NODE = right;</span>
<span class="linenr"> 1551: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'AssignmentExpression'</span>:
<span class="linenr"> 1552: </span>      <span class=
"org-keyword">return</span> parent.right === node
<span class="linenr"> 1553: </span>
<span class="linenr"> 1554: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: [NODE = foo] = [];</span>
<span class="linenr"> 1555: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: [foo = NODE] = [];</span>
<span class="linenr"> 1556: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'AssignmentPattern'</span>:
<span class="linenr"> 1557: </span>      <span class=
"org-keyword">return</span> parent.right === node
<span class="linenr"> 1558: </span>
<span class="linenr"> 1559: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: NODE: for (;;) {}</span>
<span class="linenr"> 1560: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'LabeledStatement'</span>:
<span class="linenr"> 1561: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1562: </span>
<span class="linenr"> 1563: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: try {} catch (NODE) {}</span>
<span class="linenr"> 1564: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'CatchClause'</span>:
<span class="linenr"> 1565: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1566: </span>
<span class="linenr"> 1567: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: function foo(...NODE) {}</span>
<span class="linenr"> 1568: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'RestElement'</span>:
<span class="linenr"> 1569: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1570: </span>
<span class="linenr"> 1571: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'BreakStatement'</span>:
<span class="linenr"> 1572: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ContinueStatement'</span>:
<span class="linenr"> 1573: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1574: </span>
<span class="linenr"> 1575: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: function NODE() {}</span>
<span class="linenr"> 1576: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: function foo(NODE) {}</span>
<span class="linenr"> 1577: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'FunctionDeclaration'</span>:
<span class="linenr"> 1578: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'FunctionExpression'</span>:
<span class="linenr"> 1579: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1580: </span>
<span class="linenr"> 1581: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: export NODE from "foo";</span>
<span class="linenr"> 1582: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: export * as NODE from "foo";</span>
<span class="linenr"> 1583: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ExportNamespaceSpecifier'</span>:
<span class="linenr"> 1584: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ExportDefaultSpecifier'</span>:
<span class="linenr"> 1585: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1586: </span>
<span class="linenr"> 1587: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: export { foo as NODE };</span>
<span class="linenr"> 1588: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: export { NODE as foo };</span>
<span class="linenr"> 1589: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: export { NODE as foo } from "foo";</span>
<span class="linenr"> 1590: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ExportSpecifier'</span>:
<span class="linenr"> 1591: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">@ts-expect-error</span>
<span class="linenr"> 1592: </span>      <span class=
"org-keyword">if</span> (grandparent?.source) {
<span class="linenr"> 1593: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1594: </span>      }
<span class="linenr"> 1595: </span>      <span class=
"org-keyword">return</span> parent.local === node
<span class="linenr"> 1596: </span>
<span class="linenr"> 1597: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: import NODE from "foo";</span>
<span class="linenr"> 1598: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: import * as NODE from "foo";</span>
<span class="linenr"> 1599: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: import { NODE as foo } from "foo";</span>
<span class="linenr"> 1600: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: import { foo as NODE } from "foo";</span>
<span class="linenr"> 1601: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: import NODE from "bar";</span>
<span class="linenr"> 1602: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ImportDefaultSpecifier'</span>:
<span class="linenr"> 1603: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ImportNamespaceSpecifier'</span>:
<span class="linenr"> 1604: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ImportSpecifier'</span>:
<span class="linenr"> 1605: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1606: </span>
<span class="linenr"> 1607: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: import "foo" assert { NODE: "json" }</span>
<span class="linenr"> 1608: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ImportAttribute'</span>:
<span class="linenr"> 1609: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1610: </span>
<span class="linenr"> 1611: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: &lt;div NODE="foo" /&gt;</span>
<span class="linenr"> 1612: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'JSXAttribute'</span>:
<span class="linenr"> 1613: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1614: </span>
<span class="linenr"> 1615: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: [NODE] = [];</span>
<span class="linenr"> 1616: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: ({ NODE }) = [];</span>
<span class="linenr"> 1617: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ObjectPattern'</span>:
<span class="linenr"> 1618: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ArrayPattern'</span>:
<span class="linenr"> 1619: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1620: </span>
<span class="linenr"> 1621: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: new.NODE</span>
<span class="linenr"> 1622: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: NODE.target</span>
<span class="linenr"> 1623: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'MetaProperty'</span>:
<span class="linenr"> 1624: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1625: </span>
<span class="linenr"> 1626: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: type X = { someProperty: NODE }</span>
<span class="linenr"> 1627: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: type X = { NODE: OtherType }</span>
<span class="linenr"> 1628: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ObjectTypeProperty'</span>:
<span class="linenr"> 1629: </span>      <span class=
"org-keyword">return</span> parent.key !== node
<span class="linenr"> 1630: </span>
<span class="linenr"> 1631: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: enum X { Foo = NODE }</span>
<span class="linenr"> 1632: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: enum X { NODE }</span>
<span class="linenr"> 1633: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSEnumMember'</span>:
<span class="linenr"> 1634: </span>      <span class=
"org-keyword">return</span> parent.id !== node
<span class="linenr"> 1635: </span>
<span class="linenr"> 1636: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">yes: { [NODE]: value }</span>
<span class="linenr"> 1637: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no: { NODE: value }</span>
<span class="linenr"> 1638: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSPropertySignature'</span>:
<span class="linenr"> 1639: </span>      <span class=
"org-keyword">if</span> (parent.key === node) {
<span class="linenr"> 1640: </span>        <span class=
"org-keyword">return</span> !!parent.computed
<span class="linenr"> 1641: </span>      }
<span class="linenr"> 1642: </span>
<span class="linenr"> 1643: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1644: </span>  }
<span class="linenr"> 1645: </span>
<span class="linenr"> 1646: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1647: </span>}
<span class="linenr"> 1648: </span>
<span class="linenr"> 1649: </span>
<span class="linenr"> 1650: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">validFirstIdentCharRE</span> = <span class=
"org-string">/[A-Za-z_$\xA0-\uFFFF]/</span>
<span class="linenr"> 1651: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">validIdentCharRE</span> = <span class=
"org-string">/[\.\?\w$\xA0-\uFFFF]/</span>
<span class="linenr"> 1652: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">whitespaceRE</span> = <span class=
"org-string">/\s+[.[]\s*|\s*[.[]\s+/</span>g
<span class="linenr"> 1653: </span>
<span class="linenr"> 1654: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">MemberExpLexState</span> = {
<span class="linenr"> 1655: </span>  inMemberExp: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 1656: </span>  inBrackets: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr"> 1657: </span>  inParens: <span class=
"org-highlight-numbers-number">2</span>,
<span class="linenr"> 1658: </span>  inString: <span class=
"org-highlight-numbers-number">3</span>
<span class="linenr"> 1659: </span>}
<span class="linenr"> 1660: </span>
<span class="linenr"> 1661: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isMemberExpressionBrowser</span> = path =&gt; {
<span class="linenr"> 1662: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">remove whitespaces around . or [ first</span>
<span class=
"linenr"> 1663: </span>  path = path.trim().replace(whitespaceRE, s =&gt; s.trim())
<span class="linenr"> 1664: </span>
<span class="linenr"> 1665: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">state</span> = MemberExpLexState.inMemberExp
<span class="linenr"> 1666: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">stateStack</span> = []
<span class="linenr"> 1667: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">currentOpenBracketCount</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 1668: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">currentOpenParensCount</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 1669: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">currentStringType</span> = <span class=
"org-constant">null</span>
<span class="linenr"> 1670: </span>
<span class="linenr"> 1671: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; path.length; i++) {
<span class="linenr"> 1672: </span>    <span class=
"org-keyword">const</span> <span class=
"org-type">char</span> = path.charAt(i)
<span class="linenr"> 1673: </span>    <span class=
"org-keyword">switch</span> (state) {
<span class="linenr"> 1674: </span>      <span class=
"org-keyword">case</span> MemberExpLexState.inMemberExp:
<span class="linenr"> 1675: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class="org-string">'['</span>) {
<span class="linenr"> 1676: </span>          stateStack.push(state)
<span class=
"linenr"> 1677: </span>          state = MemberExpLexState.inBrackets
<span class=
"linenr"> 1678: </span>          currentOpenBracketCount++
<span class="linenr"> 1679: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class="org-string">'('</span>) {
<span class="linenr"> 1680: </span>          stateStack.push(state)
<span class=
"linenr"> 1681: </span>          state = MemberExpLexState.inParens
<span class=
"linenr"> 1682: </span>          currentOpenParensCount++
<span class="linenr"> 1683: </span>        } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class="linenr"> 1684: </span>          !(i === <span class=
"org-highlight-numbers-number">0</span> ? validFirstIdentCharRE : validIdentCharRE).test(<span class="org-type">char</span>)
<span class="linenr"> 1685: </span>        ) {
<span class="linenr"> 1686: </span>          <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1687: </span>        }
<span class="linenr"> 1688: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 1689: </span>      <span class=
"org-keyword">case</span> MemberExpLexState.inBrackets:
<span class="linenr"> 1690: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class=
"org-string">`'`</span> || <span class=
"org-type">char</span> === <span class=
"org-string">`"`</span> || <span class=
"org-type">char</span> === <span class="org-string">'`'</span>) {
<span class="linenr"> 1691: </span>          stateStack.push(state)
<span class=
"linenr"> 1692: </span>          state = MemberExpLexState.inString
<span class=
"linenr"> 1693: </span>          currentStringType = <span class=
"org-type">char</span>
<span class="linenr"> 1694: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class="org-string">`[`</span>) {
<span class=
"linenr"> 1695: </span>          currentOpenBracketCount++
<span class="linenr"> 1696: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class="org-string">`]`</span>) {
<span class="linenr"> 1697: </span>          <span class=
"org-keyword">if</span> (!--currentOpenBracketCount) {
<span class=
"linenr"> 1698: </span>            state = stateStack.pop()
<span class="linenr"> 1699: </span>          }
<span class="linenr"> 1700: </span>        }
<span class="linenr"> 1701: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 1702: </span>      <span class=
"org-keyword">case</span> MemberExpLexState.inParens:
<span class="linenr"> 1703: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class=
"org-string">`'`</span> || <span class=
"org-type">char</span> === <span class=
"org-string">`"`</span> || <span class=
"org-type">char</span> === <span class="org-string">'`'</span>) {
<span class="linenr"> 1704: </span>          stateStack.push(state)
<span class=
"linenr"> 1705: </span>          state = MemberExpLexState.inString
<span class=
"linenr"> 1706: </span>          currentStringType = <span class=
"org-type">char</span>
<span class="linenr"> 1707: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class="org-string">`(`</span>) {
<span class=
"linenr"> 1708: </span>          currentOpenParensCount++
<span class="linenr"> 1709: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === <span class="org-string">`)`</span>) {
<span class="linenr"> 1710: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if the exp ends as a call then it should not be considered valid</span>
<span class="linenr"> 1711: </span>          <span class=
"org-keyword">if</span> (i === path.length - <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 1712: </span>            <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1713: </span>          }
<span class="linenr"> 1714: </span>          <span class=
"org-keyword">if</span> (!--currentOpenParensCount) {
<span class=
"linenr"> 1715: </span>            state = stateStack.pop()
<span class="linenr"> 1716: </span>          }
<span class="linenr"> 1717: </span>        }
<span class="linenr"> 1718: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 1719: </span>      <span class=
"org-keyword">case</span> MemberExpLexState.inString:
<span class="linenr"> 1720: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-type">char</span> === currentStringType) {
<span class=
"linenr"> 1721: </span>          state = stateStack.pop()
<span class=
"linenr"> 1722: </span>          currentStringType = <span class=
"org-constant">null</span>
<span class="linenr"> 1723: </span>        }
<span class="linenr"> 1724: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 1725: </span>    }
<span class="linenr"> 1726: </span>  }
<span class="linenr"> 1727: </span>  <span class=
"org-keyword">return</span> !currentOpenBracketCount &amp;& !currentOpenParensCount
<span class="linenr"> 1728: </span>}
<span class="linenr"> 1729: </span>
<span class="linenr"> 1730: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isMemberExpressionNode</span> = __BROWSER__
<span class="linenr"> 1731: </span>  ? NOOP
<span class="linenr"> 1732: </span>  : (path, context) =&gt; {
<span class="linenr"> 1733: </span>      <span class=
"org-keyword">try</span> {
<span class="linenr"> 1734: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">ret</span> = babelParser.parseExpression(path, {
<span class=
"linenr"> 1735: </span>          plugins: context.expressionPlugins
<span class="linenr"> 1736: </span>        })
<span class="linenr"> 1737: </span>        <span class=
"org-keyword">if</span> (ret.type === <span class=
"org-string">'TSAsExpression'</span> || ret.type === <span class=
"org-string">'TSTypeAssertion'</span>) {
<span class="linenr"> 1738: </span>          ret = ret.expression
<span class="linenr"> 1739: </span>        }
<span class="linenr"> 1740: </span>        <span class=
"org-keyword">return</span> (
<span class=
"linenr"> 1741: </span>          ret.type === <span class=
"org-string">'MemberExpression'</span> ||
<span class=
"linenr"> 1742: </span>          ret.type === <span class=
"org-string">'OptionalMemberExpression'</span> ||
<span class=
"linenr"> 1743: </span>          ret.type === <span class=
"org-string">'Identifier'</span>
<span class="linenr"> 1744: </span>        )
<span class="linenr"> 1745: </span>      } <span class=
"org-keyword">catch</span> (e) {
<span class="linenr"> 1746: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1747: </span>      }
<span class="linenr"> 1748: </span>    }
<span class="linenr"> 1749: </span>
<span class="linenr"> 1750: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isMemberExpression</span> = __BROWSER__
<span class="linenr"> 1751: </span>  ? isMemberExpressionBrowser
<span class="linenr"> 1752: </span>  : isMemberExpressionNode
<span class="linenr"> 1753: </span>
<span class="linenr"> 1754: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Check if a node contains expressions that reference current context scope ids</span>
<span class="linenr"> 1755: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">hasScopeRef</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">ids</span>) {
<span class="linenr"> 1756: </span>  <span class=
"org-keyword">if</span> (!node || Object.keys(ids).length === <span class="org-highlight-numbers-number">0</span>) {
<span class="linenr"> 1757: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1758: </span>  }
<span class="linenr"> 1759: </span>  <span class=
"org-keyword">switch</span> (node.type) {
<span class="linenr"> 1760: </span>    <span class=
"org-keyword">case</span> NodeTypes.ELEMENT:
<span class="linenr"> 1761: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr"> 1762: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = node.props[i]
<span class="linenr"> 1763: </span>        <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 1764: </span>          p.type === NodeTypes.DIRECTIVE &amp;&
<span class=
"linenr"> 1765: </span>          (hasScopeRef(p.arg, ids) || hasScopeRef(p.exp, ids))
<span class="linenr"> 1766: </span>        ) {
<span class="linenr"> 1767: </span>          <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1768: </span>        }
<span class="linenr"> 1769: </span>      }
<span class="linenr"> 1770: </span>      <span class=
"org-keyword">return</span> node.children.some(c =&gt; hasScopeRef(c, ids))
<span class="linenr"> 1771: </span>    <span class=
"org-keyword">case</span> NodeTypes.FOR:
<span class="linenr"> 1772: </span>      <span class=
"org-keyword">if</span> (hasScopeRef(node.source, ids)) {
<span class="linenr"> 1773: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1774: </span>      }
<span class="linenr"> 1775: </span>      <span class=
"org-keyword">return</span> node.children.some(c =&gt; hasScopeRef(c, ids))
<span class="linenr"> 1776: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF:
<span class="linenr"> 1777: </span>      <span class=
"org-keyword">return</span> node.branches.some(b =&gt; hasScopeRef(b, ids))
<span class="linenr"> 1778: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF_BRANCH:
<span class="linenr"> 1779: </span>      <span class=
"org-keyword">if</span> (hasScopeRef(node.condition, ids)) {
<span class="linenr"> 1780: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 1781: </span>      }
<span class="linenr"> 1782: </span>      <span class=
"org-keyword">return</span> node.children.some(c =&gt; hasScopeRef(c, ids))
<span class="linenr"> 1783: </span>    <span class=
"org-keyword">case</span> NodeTypes.SIMPLE_EXPRESSION:
<span class="linenr"> 1784: </span>      <span class=
"org-keyword">return</span> (
<span class="linenr"> 1785: </span>        !node.isStatic &amp;&
<span class=
"linenr"> 1786: </span>        isSimpleIdentifier(node.content) &amp;&
<span class="linenr"> 1787: </span>        !!ids[node.content]
<span class="linenr"> 1788: </span>      )
<span class="linenr"> 1789: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMPOUND_EXPRESSION:
<span class="linenr"> 1790: </span>      <span class=
"org-keyword">return</span> node.children.some(c =&gt; isObject(c) &amp;& hasScopeRef(c, ids))
<span class="linenr"> 1791: </span>    <span class=
"org-keyword">case</span> NodeTypes.INTERPOLATION:
<span class="linenr"> 1792: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT_CALL:
<span class="linenr"> 1793: </span>      <span class=
"org-keyword">return</span> hasScopeRef(node.content, ids)
<span class="linenr"> 1794: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT:
<span class="linenr"> 1795: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMMENT:
<span class="linenr"> 1796: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1797: </span>    <span class=
"org-keyword">default</span>:
<span class="linenr"> 1798: </span>      <span class=
"org-keyword">if</span> (__DEV__) {
<span class="linenr"> 1799: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exhaustiveCheck</span> = node
<span class="linenr"> 1800: </span>        exhaustiveCheck
<span class="linenr"> 1801: </span>      }
<span class="linenr"> 1802: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 1803: </span>  }
<span class="linenr"> 1804: </span>}
<span class="linenr"> 1805: </span>
<span class="linenr"> 1806: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">SlotFlags</span> = {
<span class="linenr"> 1807: </span>  <span class=
"org-doc">/**</span>
<span class="linenr"> 1808: </span><span class=
"org-doc">   * Stable slots that only reference slot props or context state. The slot</span>
<span class="linenr"> 1809: </span><span class=
"org-doc">   * can fully capture its own dependencies so when passed down the parent won't</span>
<span class="linenr"> 1810: </span><span class=
"org-doc">   * need to force the child to update.</span>
<span class="linenr"> 1811: </span><span class=
"org-doc">   */</span>
<span class="linenr"> 1812: </span>  STABLE: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr"> 1813: </span>  <span class=
"org-doc">/**</span>
<span class="linenr"> 1814: </span><span class=
"org-doc">   * Slots that reference scope variables (v-for or an outer slot prop), or</span>
<span class="linenr"> 1815: </span><span class=
"org-doc">   * has conditional structure (v-if, v-for). The parent will need to force</span>
<span class="linenr"> 1816: </span><span class=
"org-doc">   * the child to update because the slot does not fully capture its dependencies.</span>
<span class="linenr"> 1817: </span><span class=
"org-doc">   */</span>
<span class="linenr"> 1818: </span>  DYNAMIC: <span class=
"org-highlight-numbers-number">2</span>,
<span class="linenr"> 1819: </span>  <span class=
"org-doc">/**</span>
<span class="linenr"> 1820: </span><span class=
"org-doc">   * `&lt;slot/&gt;` being forwarded into a child component. Whether the parent needs</span>
<span class="linenr"> 1821: </span><span class=
"org-doc">   * to update the child is dependent on what kind of slots the parent itself</span>
<span class="linenr"> 1822: </span><span class=
"org-doc">   * received. This has to be refined at runtime, when the child's vnode</span>
<span class="linenr"> 1823: </span><span class=
"org-doc">   * is being created (in `normalizeChildren`)</span>
<span class="linenr"> 1824: </span><span class=
"org-doc">   */</span>
<span class="linenr"> 1825: </span>  FORWARDED: <span class=
"org-highlight-numbers-number">3</span>
<span class="linenr"> 1826: </span>}
<span class="linenr"> 1827: </span>
<span class="linenr"> 1828: </span><span class="org-doc">/**</span>
<span class="linenr"> 1829: </span><span class=
"org-doc"> * Dev only</span>
<span class="linenr"> 1830: </span><span class="org-doc"> */</span>
<span class="linenr"> 1831: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotFlagsText</span> = {
<span class=
"linenr"> 1832: </span>  [SlotFlags.STABLE]: <span class=
"org-string">'STABLE'</span>,
<span class=
"linenr"> 1833: </span>  [SlotFlags.DYNAMIC]: <span class=
"org-string">'DYNAMIC'</span>,
<span class=
"linenr"> 1834: </span>  [SlotFlags.FORWARDED]: <span class=
"org-string">'FORWARDED'</span>
<span class="linenr"> 1835: </span>}
<span class="linenr"> 1836: </span>
<span class="linenr"> 1837: </span>
<span class="linenr"> 1838: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createElementWithCodegen</span>(
<span class="linenr"> 1839: </span>  <span class=
"org-variable-name">tag</span>,
<span class="linenr"> 1840: </span>  <span class=
"org-variable-name">props</span>,
<span class="linenr"> 1841: </span>  <span class=
"org-variable-name">children</span>,
<span class="linenr"> 1842: </span>  <span class=
"org-variable-name">patchFlag</span>,
<span class="linenr"> 1843: </span>  dynamicProps
<span class="linenr"> 1844: </span>) {
<span class="linenr"> 1845: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 1846: </span>    type: NodeTypes.ELEMENT,
<span class="linenr"> 1847: </span>    loc: locStub,
<span class="linenr"> 1848: </span>    ns: Namespaces.HTML,
<span class="linenr"> 1849: </span>    tag: <span class=
"org-string">'div'</span>,
<span class=
"linenr"> 1850: </span>    tagType: ElementTypes.ELEMENT,
<span class="linenr"> 1851: </span>    isSelfClosing: <span class=
"org-constant">false</span>,
<span class="linenr"> 1852: </span>    props: [],
<span class="linenr"> 1853: </span>    children: [],
<span class="linenr"> 1854: </span>    codegenNode: {
<span class=
"linenr"> 1855: </span>      type: NodeTypes.VNODE_CALL,
<span class="linenr"> 1856: </span>      tag,
<span class="linenr"> 1857: </span>      props,
<span class="linenr"> 1858: </span>      children,
<span class="linenr"> 1859: </span>      patchFlag,
<span class="linenr"> 1860: </span>      dynamicProps,
<span class="linenr"> 1861: </span>      directives: <span class=
"org-constant">undefined</span>,
<span class="linenr"> 1862: </span>      isBlock: <span class=
"org-constant">false</span>,
<span class=
"linenr"> 1863: </span>      disableTracking: <span class=
"org-constant">false</span>,
<span class="linenr"> 1864: </span>      isComponent: <span class=
"org-constant">false</span>,
<span class="linenr"> 1865: </span>      loc: locStub
<span class="linenr"> 1866: </span>    }
<span class="linenr"> 1867: </span>  }
<span class="linenr"> 1868: </span>}
<span class="linenr"> 1869: </span>
<span class="linenr"> 1870: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createParserContext</span>(<span class=
"org-variable-name">content</span>, <span class=
"org-variable-name">rawOptions</span>) {
<span class="linenr"> 1871: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">options</span> = extend({}, defaultParserOptions)
<span class="linenr"> 1872: </span>
<span class="linenr"> 1873: </span>  <span class=
"org-keyword">let</span> <span class="org-variable-name">key</span>
<span class="linenr"> 1874: </span>  <span class=
"org-keyword">for</span> (key <span class=
"org-keyword">in</span> rawOptions) {
<span class="linenr"> 1875: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">@ts-ignore</span>
<span class="linenr"> 1876: </span>    options[key] =
<span class=
"linenr"> 1877: </span>      rawOptions[key] === <span class=
"org-constant">undefined</span>
<span class=
"linenr"> 1878: </span>        ? defaultParserOptions[key]
<span class="linenr"> 1879: </span>        : rawOptions[key]
<span class="linenr"> 1880: </span>  }
<span class="linenr"> 1881: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 1882: </span>    options,
<span class="linenr"> 1883: </span>    column: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr"> 1884: </span>    line: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr"> 1885: </span>    offset: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 1886: </span>    originalSource: content,
<span class="linenr"> 1887: </span>    source: content,
<span class="linenr"> 1888: </span>    inPre: <span class=
"org-constant">false</span>,
<span class="linenr"> 1889: </span>    inVPre: <span class=
"org-constant">false</span>,
<span class="linenr"> 1890: </span>    onWarn: options.onWarn
<span class="linenr"> 1891: </span>  }
<span class="linenr"> 1892: </span>}
<span class="linenr"> 1893: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createRoot</span>(<span class=
"org-variable-name">children</span>, <span class=
"org-variable-name">loc</span> = <span class=
"org-variable-name">locStub</span>) {
<span class="linenr"> 1894: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 1895: </span>    type: NodeTypes.ROOT,
<span class="linenr"> 1896: </span>    children,
<span class="linenr"> 1897: </span>    helpers: [],
<span class="linenr"> 1898: </span>    components: [],
<span class="linenr"> 1899: </span>    directives: [],
<span class="linenr"> 1900: </span>    hoists: [],
<span class="linenr"> 1901: </span>    imports: [],
<span class="linenr"> 1902: </span>    cached: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 1903: </span>    temps: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 1904: </span>    codegenNode: <span class=
"org-constant">undefined</span>,
<span class="linenr"> 1905: </span>    loc
<span class="linenr"> 1906: </span>  }
<span class="linenr"> 1907: </span>}
<span class="linenr"> 1908: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseChildren</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">mode</span>, <span class=
"org-variable-name">ancestors</span>) {
<span class="linenr"> 1909: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parent</span> = last(ancestors)
<span class="linenr"> 1910: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ns</span> = parent ? parent.ns : Namespaces.HTML
<span class="linenr"> 1911: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">nodes</span> = [] <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">-&gt; ancestors</span>
<span class="linenr"> 1912: </span>
<span class="linenr"> 1913: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. while -&gt; isEnd ? 游标不断往前走直接所以 source 都解析完成</span>
<span class="linenr"> 1914: </span>  <span class=
"org-keyword">while</span> (!isEnd(context, mode, ancestors)) {
<span class="linenr"> 1915: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">s</span> = context.source
<span class="linenr"> 1916: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">node</span> = <span class=
"org-constant">undefined</span>
<span class="linenr"> 1917: </span>
<span class="linenr"> 1918: </span>    <span class=
"org-keyword">if</span> (mode === TextModes.DATA || mode === TextModes.RCDATA) {
<span class="linenr"> 1919: </span>      <span class=
"org-keyword">if</span> (!context.inVPre &amp;& startsWith(s, context.options.delimiters[<span class="org-highlight-numbers-number">0</span>])) {
<span class="linenr"> 1920: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">'{{' 插值开始</span>
<span class=
"linenr"> 1921: </span>        node = parseInterpolation(context, mode)
<span class="linenr"> 1922: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (mode === TextModes.DATA &amp;& s[<span class="org-highlight-numbers-number">0</span>] === <span class="org-string">'&lt;'</span>) {
<span class="linenr"> 1923: </span>        <span class=
"org-keyword">if</span> (s[<span class=
"org-highlight-numbers-number">1</span>] === <span class=
"org-string">'/'</span>) {
<span class="linenr"> 1924: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">结束标签</span>
<span class="linenr"> 1925: </span>          <span class=
"org-keyword">if</span> (<span class=
"org-string">/[a-z]/</span>i.test(s[<span class=
"org-highlight-numbers-number">2</span>])) {
<span class="linenr"> 1926: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">异常结束，如：`&lt;div&gt;some text&lt;a`</span>
<span class=
"linenr"> 1927: </span>            emitError(context, <span class=
"org-string">'X_INVALID_END_TAG'</span>)
<span class=
"linenr"> 1928: </span>            parseTag(context, TagType.End, parent)
<span class="linenr"> 1929: </span>            <span class=
"org-keyword">continue</span>
<span class="linenr"> 1930: </span>          }
<span class="linenr"> 1931: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-string">/[a-z]/</span>i.test(s[<span class=
"org-highlight-numbers-number">1</span>])) {
<span class="linenr"> 1932: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">正常的开始标签</span>
<span class=
"linenr"> 1933: </span>          node = parseElement(context, ancestors)
<span class="linenr"> 1934: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2.x &lt;template&gt; 无指令兼容，这里就不实现了，重点关注 3.x 的代码</span>
<span class="linenr"> 1935: </span>        }
<span class="linenr"> 1936: </span>      }
<span class="linenr"> 1937: </span>    }
<span class="linenr"> 1938: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">以上都不是，说明应该是纯文本节点</span>
<span class="linenr"> 1939: </span>    <span class=
"org-keyword">if</span> (!node) {
<span class=
"linenr"> 1940: </span>      node = parseText(context, mode)
<span class="linenr"> 1941: </span>    }
<span class="linenr"> 1942: </span>
<span class="linenr"> 1943: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">用 pushNode 在其中合并相邻的文本节点</span>
<span class="linenr"> 1944: </span>    <span class=
"org-keyword">if</span> (isArray(node)) {
<span class="linenr"> 1945: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.length; i++) {
<span class="linenr"> 1946: </span>        pushNode(nodes, node[i])
<span class="linenr"> 1947: </span>      }
<span class="linenr"> 1948: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 1949: </span>      pushNode(nodes, node)
<span class="linenr"> 1950: </span>    }
<span class="linenr"> 1951: </span>  }
<span class="linenr"> 1952: </span>
<span class="linenr"> 1953: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. 合并相邻文本节点，空格处理，会将多个空格合并成一个空格</span>
<span class="linenr"> 1954: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">removedWhitespace</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 1955: </span>  <span class=
"org-keyword">if</span> (mode !== TextModes.RAWTEXT &amp;& mode !== TextModes.RCDATA) {
<span class=
"linenr"> 1956: </span>    removedWhitespace = _removeWhitespace(nodes, context)
<span class="linenr"> 1957: </span>  }
<span class="linenr"> 1958: </span>
<span class="linenr"> 1959: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">3. 最后返回解析后的节点树</span>
<span class="linenr"> 1960: </span>  <span class=
"org-keyword">return</span> removedWhitespace ? nodes.filter(Boolean) : nodes
<span class="linenr"> 1961: </span>}
<span class="linenr"> 1962: </span>
<span class="linenr"> 1963: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">_removeWhitespace</span>(<span class=
"org-variable-name">nodes</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 1964: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">removedWhitespace</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 1965: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">可以通过选项来指定是不是保留空格，否则多余的会合并成一个</span>
<span class="linenr"> 1966: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">shouldCondense</span> = context.options.whitespace !== <span class="org-string">'preserve'</span>
<span class="linenr"> 1967: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; nodes.length; i++) {
<span class="linenr"> 1968: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> = nodes[i]
<span class="linenr"> 1969: </span>    <span class=
"org-keyword">if</span> (!context.inPre &amp;& node.type === NodeTypes.TEXT) {
<span class="linenr"> 1970: </span>      <span class=
"org-keyword">if</span> (!<span class=
"org-string">/[^\t\r\n\f]/</span>.test(node.content)) {
<span class="linenr"> 1971: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prev</span> = nodes[i - <span class=
"org-highlight-numbers-number">1</span>]
<span class="linenr"> 1972: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">next</span> = nodes[i + <span class=
"org-highlight-numbers-number">1</span>]
<span class="linenr"> 1973: </span>
<span class="linenr"> 1974: </span>        <span class=
"org-keyword">if</span> (
<span class="linenr"> 1975: </span>          !prev ||
<span class="linenr"> 1976: </span>            !next ||
<span class=
"linenr"> 1977: </span>            (shouldCondense &amp;& (
<span class=
"linenr"> 1978: </span>              prev.type === NodeTypes.COMMENT || next.type === NodeTypes.COMMENT || (
<span class=
"linenr"> 1979: </span>                prev.type === NodeTypes.ELEMENT &amp;& next.type === NodeTypes.ELEMENT &amp;& <span class="org-string">/[\r\n]/</span>.test(node.content)
<span class="linenr"> 1980: </span>              )
<span class="linenr"> 1981: </span>            ))
<span class="linenr"> 1982: </span>        ) {
<span class=
"linenr"> 1983: </span>          removedWhitespace = <span class=
"org-constant">true</span>
<span class=
"linenr"> 1984: </span>          nodes[i] = <span class="org-constant">null</span>
<span class="linenr"> 1985: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr"> 1986: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">合并成一个</span>
<span class=
"linenr"> 1987: </span>          node.content = <span class=
"org-string">' '</span>
<span class="linenr"> 1988: </span>        }
<span class="linenr"> 1989: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (shouldCondense) {
<span class="linenr"> 1990: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">保留空格</span>
<span class=
"linenr"> 1991: </span>        node.content = node.content.replace(<span class="org-string">/[\t\r\n\f]+/</span>g, <span class="org-string">' '</span>)
<span class="linenr"> 1992: </span>      }
<span class="linenr"> 1993: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === NodeTypes.COMMENT &amp;& !context.options.comments) {
<span class="linenr"> 1994: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">可以通过配置删除注释节点</span>
<span class=
"linenr"> 1995: </span>      removedWhitespace = <span class=
"org-constant">true</span>
<span class="linenr"> 1996: </span>      nodes[i] = <span class=
"org-constant">null</span>
<span class="linenr"> 1997: </span>    }
<span class="linenr"> 1998: </span>  }
<span class="linenr"> 1999: </span>
<span class="linenr"> 2000: </span>  <span class=
"org-keyword">if</span> (context.inPre &amp;& parent &amp;& context.options.isPreTag(parent.tag)) {
<span class="linenr"> 2001: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">删除 &lt;pre&gt; 中的第一行的空行</span>
<span class="linenr"> 2002: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">first</span> = nodes[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 2003: </span>    <span class=
"org-keyword">if</span> (first &amp;& first.type === NodeTypes.TEXT) {
<span class=
"linenr"> 2004: </span>      first.content = first.content.replace(<span class="org-string">/^\r?\n/</span>, <span class="org-string">''</span>)
<span class="linenr"> 2005: </span>    }
<span class="linenr"> 2006: </span>  }
<span class="linenr"> 2007: </span>
<span class="linenr"> 2008: </span>  <span class=
"org-keyword">return</span> removedWhitespace
<span class="linenr"> 2009: </span>}
<span class="linenr"> 2010: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseElement</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">ancestors</span>) {
<span class="linenr"> 2011: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parent</span> = last(ancestors)
<span class="linenr"> 2012: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. 解析出开始标签</span>
<span class="linenr"> 2013: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">element</span> = parseTag(context, TagType.Start, parent)
<span class="linenr"> 2014: </span>
<span class="linenr"> 2015: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">自闭合的标签： &lt;div/&gt;</span>
<span class="linenr"> 2016: </span>  <span class=
"org-keyword">if</span> (element.isSelfClosing || context.options.isVoidTag(element.tag)) {
<span class="linenr"> 2017: </span>    <span class=
"org-keyword">return</span> element
<span class="linenr"> 2018: </span>  }
<span class="linenr"> 2019: </span>
<span class="linenr"> 2020: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">children</span>
<span class="linenr"> 2021: </span>  ancestors.push(element)
<span class="linenr"> 2022: </span>
<span class="linenr"> 2023: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">mode</span> = context.options.getTextMode(element, parent)
<span class="linenr"> 2024: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">递归解析子节点</span>
<span class="linenr"> 2025: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">children</span> = parseChildren(context, mode, ancestors)
<span class="linenr"> 2026: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">解析完出栈 [root, parent1, parent2, ...] 代表层级</span>
<span class="linenr"> 2027: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;root&gt;&lt;parent1&gt;&lt;parent2&gt;&lt;/parent&gt;&lt;parent1&gt;&lt;/root&gt; -&gt; 解析过程中通过</span>
<span class="linenr"> 2028: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">ancestors 来维护这个层级关系</span>
<span class="linenr"> 2029: </span>  ancestors.pop()
<span class="linenr"> 2030: </span>
<span class="linenr"> 2031: </span>  element.children = children
<span class="linenr"> 2032: </span>
<span class="linenr"> 2033: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. 解析结束标签</span>
<span class="linenr"> 2034: </span>  <span class=
"org-keyword">if</span> (startsWithEndTagOpen(context.source, element.tag)) {
<span class=
"linenr"> 2035: </span>    parseTag(context, TagType.End, parent)
<span class="linenr"> 2036: </span>  }
<span class="linenr"> 2037: </span>
<span class="linenr"> 2038: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">更新解析后节点在源码中的位置信息</span>
<span class=
"linenr"> 2039: </span>  element.loc = getSelection(context, element.loc.start)
<span class="linenr"> 2040: </span>
<span class="linenr"> 2041: </span>  <span class=
"org-keyword">return</span> element
<span class="linenr"> 2042: </span>}
<span class="linenr"> 2043: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseTag</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">type</span>, <span class=
"org-variable-name">parent</span>) {
<span class="linenr"> 2044: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. 开始标签</span>
<span class="linenr"> 2045: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = getCursor(context)
<span class="linenr"> 2046: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">合法标签的正则匹配</span>
<span class="linenr"> 2047: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">match</span> = <span class=
"org-string">/^&lt;\/?([a-z][^\t\r\n\f /&gt;]*)/</span>i.exec(context.source)
<span class="linenr"> 2048: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">tag</span> = match[<span class=
"org-highlight-numbers-number">1</span>]
<span class="linenr"> 2049: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ns</span> = context.options.getNamespace(tag, parent)
<span class="linenr"> 2050: </span>
<span class="linenr"> 2051: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">游标前进标签名长度的位置，如： &lt;div id="foo"&gt; -&gt; ` id="foo"&gt;`</span>
<span class=
"linenr"> 2052: </span>  advanceBy(context, match[<span class=
"org-highlight-numbers-number">0</span>].length)
<span class="linenr"> 2053: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">空格处理</span>
<span class="linenr"> 2054: </span>  advanceSpaces(context)
<span class="linenr"> 2055: </span>
<span class="linenr"> 2056: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">parse attributes</span>
<span class="linenr"> 2057: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">props</span> = parseAttributes(context, type)
<span class="linenr"> 2058: </span>
<span class="linenr"> 2059: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO</span></span></span><span class=
"org-comment"> v-pre 检测</span>
<span class="linenr"> 2060: </span>
<span class="linenr"> 2061: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. 闭合标签</span>
<span class="linenr"> 2062: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">isSelfClosing</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 2063: </span>  <span class=
"org-keyword">if</span> (context.source.length === <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 2064: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">非法情况, ignore</span>
<span class="linenr"> 2065: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 2066: </span>    isSelfClosing = startsWith(context.source, <span class="org-string">'/&gt;'</span>)
<span class=
"linenr"> 2067: </span>    advanceBy(context, isSelfClosing ? <span class="org-highlight-numbers-number">2</span> : <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 2068: </span>  }
<span class="linenr"> 2069: </span>
<span class="linenr"> 2070: </span>  <span class=
"org-keyword">if</span> (type === TagType.End) {
<span class="linenr"> 2071: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 2072: </span>  }
<span class="linenr"> 2073: </span>
<span class="linenr"> 2074: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">3. 分析出标签的类型</span>
<span class="linenr"> 2075: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">tagType</span> = ElementTypes.ELEMENT
<span class="linenr"> 2076: </span>  <span class=
"org-keyword">if</span> (!context.inVPre) {
<span class="linenr"> 2077: </span>    <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'slot'</span>) {
<span class=
"linenr"> 2078: </span>      tagType = ElementTypes.SLOT
<span class="linenr"> 2079: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'template'</span>) {
<span class="linenr"> 2080: </span>      <span class=
"org-keyword">if</span> (props.some(p =&gt; p.type === NodeTypes.DIRECTIVE &amp;& isSpecialTemplateDirective(p.name))) {
<span class=
"linenr"> 2081: </span>        tagType = ElementTypes.TEMPLATE
<span class="linenr"> 2082: </span>      }
<span class="linenr"> 2083: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isComponent(tag, props, context)) {
<span class=
"linenr"> 2084: </span>      tagType = ElementTypes.COMPONENT
<span class="linenr"> 2085: </span>    }
<span class="linenr"> 2086: </span>  }
<span class="linenr"> 2087: </span>
<span class="linenr"> 2088: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 2089: </span>    type: NodeTypes.ELEMENT,
<span class="linenr"> 2090: </span>    ns,
<span class="linenr"> 2091: </span>    tag,
<span class="linenr"> 2092: </span>    tagType,
<span class="linenr"> 2093: </span>    props,
<span class="linenr"> 2094: </span>    isSelfClosing,
<span class="linenr"> 2095: </span>    children: [],
<span class=
"linenr"> 2096: </span>    loc: getSelection(context, start),
<span class="linenr"> 2097: </span>    codegenNode: <span class=
"org-constant">undefined</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">在 transform 阶段生成的产物</span>
<span class="linenr"> 2098: </span>  }
<span class="linenr"> 2099: </span>}
<span class="linenr"> 2100: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseText</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">mode</span>) {
<span class="linenr"> 2101: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">endTokens</span> = mode === TextModes.CDATA ? [<span class="org-string">']]&gt;'</span>] : [<span class="org-string">'&lt;'</span>, context.options.delimiters[<span class="org-highlight-numbers-number">0</span>]]
<span class="linenr"> 2102: </span>
<span class="linenr"> 2103: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">endIndex</span> = context.source.length
<span class="linenr"> 2104: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; endTokens.length; i++) {
<span class="linenr"> 2105: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">index</span> = context.source.indexOf(endTokens[i], <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 2106: </span>    <span class=
"org-keyword">if</span> (index !== -<span class=
"org-highlight-numbers-number">1</span> &amp;& endIndex &gt; index) {
<span class="linenr"> 2107: </span>      endIndex = index
<span class="linenr"> 2108: </span>    }
<span class="linenr"> 2109: </span>  }
<span class="linenr"> 2110: </span>
<span class="linenr"> 2111: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = getCursor(context)
<span class="linenr"> 2112: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">content</span> = parseTextData(context, endIndex, mode)
<span class="linenr"> 2113: </span>
<span class="linenr"> 2114: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 2115: </span>    type: NodeTypes.TEXT,
<span class="linenr"> 2116: </span>    content,
<span class=
"linenr"> 2117: </span>    loc: getSelection(context, start)
<span class="linenr"> 2118: </span>  }
<span class="linenr"> 2119: </span>}
<span class="linenr"> 2120: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseTextData</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">length</span>, <span class=
"org-variable-name">mode</span>) {
<span class="linenr"> 2121: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rawText</span> = context.source.slice(<span class="org-highlight-numbers-number">0</span>, length)
<span class="linenr"> 2122: </span>  advanceBy(context, length)
<span class="linenr"> 2123: </span>
<span class="linenr"> 2124: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">不含HTML entities</span>
<span class="linenr"> 2125: </span>  <span class=
"org-keyword">if</span> (mode === TextModes.RAWTEXT || mode === TextModes.CDATA || !rawText.includes(<span class="org-string">'&amp;'</span>)) {
<span class="linenr"> 2126: </span>    <span class=
"org-keyword">return</span> rawText
<span class="linenr"> 2127: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2128: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">将 &amp;gt; -&gt; `&gt;`, &amp;lt; -&gt; `&lt;`, &amp;amp; -&gt; `&amp;`, &amp;apos; -&gt; `'`, &amp;quot; -&gt; `"`</span>
<span class="linenr"> 2129: </span>    <span class=
"org-keyword">return</span> context.options.decodeEntities(rawText, mode === TextModes.ATTRIBUTE_VALUE)
<span class="linenr"> 2130: </span>  }
<span class="linenr"> 2131: </span>}
<span class="linenr"> 2132: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseInterpolation</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">mode</span>) {
<span class="linenr"> 2133: </span>  <span class=
"org-keyword">const</span> [<span class=
"org-variable-name">open</span>, <span class=
"org-variable-name">close</span>] = context.options.delimiters
<span class="linenr"> 2134: </span>
<span class="linenr"> 2135: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">如： source = "{{ a + b }}"</span>
<span class="linenr"> 2136: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">closeIndex = indexOf("}}", "{{".length) = 9</span>
<span class="linenr"> 2137: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">closeIndex</span> = context.source.indexOf(close, open.length)
<span class="linenr"> 2138: </span>  <span class=
"org-keyword">if</span> (closeIndex === -<span class=
"org-highlight-numbers-number">1</span>) {
<span class=
"linenr"> 2139: </span>    emitError(context, <span class=
"org-string">'X_MISSING_INTERPOLATION_END'</span>)
<span class="linenr"> 2140: </span>    <span class=
"org-keyword">return</span> <span class=
"org-constant">undefined</span>
<span class="linenr"> 2141: </span>  }
<span class="linenr"> 2142: </span>
<span class="linenr"> 2143: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = getCursor(context)
<span class="linenr"> 2144: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&gt;&gt; 2 -&gt; " a + b }}"</span>
<span class=
"linenr"> 2145: </span>  advanceBy(context, open.length)
<span class="linenr"> 2146: </span>
<span class="linenr"> 2147: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">{ line, column, offset }</span>
<span class="linenr"> 2148: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">innerStart</span> = getCursor(context)
<span class="linenr"> 2149: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">innerEnd</span> = getCursor(context)
<span class="linenr"> 2150: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">9 - '{{'.length = 7</span>
<span class="linenr"> 2151: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rawContentLength</span> = closeIndex - open.length
<span class="linenr"> 2152: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">" a + b }}".slice(0, 7) =&gt; " a + b "</span>
<span class="linenr"> 2153: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rawContent</span> = context.source.slice(<span class="org-highlight-numbers-number">0</span>, rawContentLength)
<span class="linenr"> 2154: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">preTrimContent</span> = parseTextData(context, rawContentLength, mode)
<span class="linenr"> 2155: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">" a + b " =&gt; "a + b"</span>
<span class="linenr"> 2156: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">content</span> = preTrimContent.trim()
<span class="linenr"> 2157: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">startOffset</span> = preTrimContent.indexOf(content)
<span class="linenr"> 2158: </span>  <span class=
"org-keyword">if</span> (startOffset &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 2159: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">处理换行问题</span>
<span class=
"linenr"> 2160: </span>    advancePositionWithMutation(innerStart, rawContent, startOffset)
<span class="linenr"> 2161: </span>  }
<span class="linenr"> 2162: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">endOffset</span> = rawContentLength - (preTrimContent.length - content.length - startOffset)
<span class=
"linenr"> 2163: </span>  advancePositionWithMutation(innerEnd, rawContent, endOffset)
<span class=
"linenr"> 2164: </span>  advanceBy(context, close.length)
<span class="linenr"> 2165: </span>
<span class="linenr"> 2166: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 2167: </span>    type: NodeTypes.INTERPOLATION,
<span class="linenr"> 2168: </span>    content: {
<span class=
"linenr"> 2169: </span>      type: NodeTypes.SIMPLE_EXPRESSION,
<span class="linenr"> 2170: </span>      isStatic: <span class=
"org-constant">false</span>,
<span class="linenr"> 2171: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Set `isConstant` to false by default and will decide in transformExpression</span>
<span class=
"linenr"> 2172: </span>      constType: ConstantTypes.NOT_CONSTANT,
<span class="linenr"> 2173: </span>      content,
<span class=
"linenr"> 2174: </span>      loc: getSelection(context, innerStart, innerEnd)
<span class="linenr"> 2175: </span>    },
<span class=
"linenr"> 2176: </span>    loc: getSelection(context, start)
<span class="linenr"> 2177: </span>  }
<span class="linenr"> 2178: </span>}
<span class="linenr"> 2179: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseAttributes</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">type</span>) {
<span class="linenr"> 2180: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">props</span> = []
<span class="linenr"> 2181: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">用 set 避免重复属性</span>
<span class="linenr"> 2182: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">attributeNames</span> = <span class=
"org-keyword">new</span> <span class="org-type">Set</span>()
<span class="linenr"> 2183: </span>  <span class=
"org-keyword">while</span> (
<span class=
"linenr"> 2184: </span>    context.source.length &gt; <span class=
"org-highlight-numbers-number">0</span> &amp;&
<span class=
"linenr"> 2185: </span>      !startsWith(context.source, <span class="org-string">'&gt;'</span>) &amp;&
<span class=
"linenr"> 2186: </span>      !startsWith(context.source, <span class="org-string">'/&gt;'</span>)
<span class="linenr"> 2187: </span>  ) {
<span class="linenr"> 2188: </span>
<span class="linenr"> 2189: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">一些非法检测, ignore</span>
<span class="linenr"> 2190: </span>
<span class="linenr"> 2191: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">attr</span> = parseAttribute(context, attributeNames)
<span class="linenr"> 2192: </span>
<span class="linenr"> 2193: </span>    logg(<span class=
"org-string">'ATTR'</span>, attr)
<span class="linenr"> 2194: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">去掉 class 之间多余的空格，如： `foo   bar  ` -&gt; `foo bar`</span>
<span class="linenr"> 2195: </span>    <span class=
"org-keyword">if</span> (attr.type === NodeTypes.ATTRIBUTE &amp;&
<span class=
"linenr"> 2196: </span>       attr.value &amp;& attr.name === <span class="org-string">'class'</span>) {
<span class=
"linenr"> 2197: </span>      attr.value.content = attr.value.content.replace(<span class="org-string">/\s+/</span>g, <span class="org-string">' '</span>).trim()
<span class="linenr"> 2198: </span>    }
<span class="linenr"> 2199: </span>
<span class="linenr"> 2200: </span>    <span class=
"org-keyword">if</span> (type === TagType.Start) {
<span class="linenr"> 2201: </span>      props.push(attr)
<span class="linenr"> 2202: </span>    }
<span class="linenr"> 2203: </span>
<span class="linenr"> 2204: </span>    advanceSpaces(context)
<span class="linenr"> 2205: </span>  }
<span class="linenr"> 2206: </span>
<span class="linenr"> 2207: </span>  <span class=
"org-keyword">return</span> props
<span class="linenr"> 2208: </span>}
<span class="linenr"> 2209: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseAttribute</span>(<span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">nameSet</span>) {
<span class="linenr"> 2210: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = getCursor(context)
<span class="linenr"> 2211: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">match</span> = <span class=
"org-string">/^[^\t\r\n\f /&gt;][^\t\r\n\f /&gt;=]*/</span>.exec(context.source)
<span class="linenr"> 2212: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">name</span> = match[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 2213: </span>
<span class="linenr"> 2214: </span>  nameSet.add(name)
<span class="linenr"> 2215: </span>
<span class=
"linenr"> 2216: </span>  advanceBy(context, name.length)
<span class="linenr"> 2217: </span>
<span class="linenr"> 2218: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">value</span> = <span class=
"org-constant">undefined</span>
<span class="linenr"> 2219: </span>
<span class="linenr"> 2220: </span>  <span class=
"org-keyword">if</span> (<span class=
"org-string">/^[\t\r\n\f ]*=/</span>.test(context.source)) {
<span class="linenr"> 2221: </span>    advanceSpaces(context)
<span class=
"linenr"> 2222: </span>    advanceBy(context, <span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr"> 2223: </span>    advanceSpaces(context)
<span class=
"linenr"> 2224: </span>    value = parseAttributeValue(context)
<span class="linenr"> 2225: </span>  }
<span class="linenr"> 2226: </span>
<span class="linenr"> 2227: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">loc</span> = getSelection(context, start)
<span class="linenr"> 2228: </span>
<span class="linenr"> 2229: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-on(@), v-bind(:), v-if, v-else, v-slot(#) 指令</span>
<span class="linenr"> 2230: </span>  <span class=
"org-keyword">if</span> (!context.inVPre &amp;& <span class=
"org-string">/^(v-[A-Za-z0-9-]|:|\.|@|#)/</span>.test(name)) {
<span class="linenr"> 2231: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">match</span> = <span class=
"org-string">/(?:^v-([a-z0-9-]+))?(?:(?::|^\.|^@|^#)(\[[^\]]+\]|[^\.]+))?(.+)?$/</span>i.exec(name)
<span class="linenr"> 2232: </span>
<span class="linenr"> 2233: </span>    log(<span class=
"org-string">`parseAttribute| match=${match}`</span>)
<span class="linenr"> 2234: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">isPropShorthand</span> = startsWith(name, <span class="org-string">'.'</span>)
<span class="linenr"> 2235: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">dirName</span> =
<span class="linenr"> 2236: </span>        match[<span class=
"org-highlight-numbers-number">1</span>] ||
<span class=
"linenr"> 2237: </span>        (isPropShorthand || startsWith(name, <span class="org-string">':'</span>)
<span class="linenr"> 2238: </span>         ? <span class=
"org-string">'bind'</span>
<span class=
"linenr"> 2239: </span>         : startsWith(name, <span class=
"org-string">'@'</span>)
<span class="linenr"> 2240: </span>        ? <span class=
"org-string">'on'</span>
<span class="linenr"> 2241: </span>        : <span class=
"org-string">'slot'</span>)
<span class="linenr"> 2242: </span>    <span class=
"org-keyword">let</span> <span class="org-variable-name">arg</span>
<span class="linenr"> 2243: </span>
<span class="linenr"> 2244: </span>    <span class=
"org-keyword">if</span> (match[<span class=
"org-highlight-numbers-number">2</span>]) {
<span class="linenr"> 2245: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSlot</span> = dirName === <span class=
"org-string">'slot'</span>
<span class="linenr"> 2246: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">startOffset</span> = name.lastIndexOf(match[<span class="org-highlight-numbers-number">2</span>])
<span class="linenr"> 2247: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">loc</span> = getSelection(
<span class="linenr"> 2248: </span>        context,
<span class=
"linenr"> 2249: </span>        getNewPosition(context, start, startOffset),
<span class="linenr"> 2250: </span>        getNewPosition(
<span class="linenr"> 2251: </span>          context,
<span class="linenr"> 2252: </span>          start,
<span class=
"linenr"> 2253: </span>          startOffset + match[<span class=
"org-highlight-numbers-number">2</span>].length + ((isSlot &amp;& match[<span class="org-highlight-numbers-number">3</span>]) || <span class="org-string">''</span>).length
<span class="linenr"> 2254: </span>        )
<span class="linenr"> 2255: </span>      )
<span class="linenr"> 2256: </span>
<span class="linenr"> 2257: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">content</span> = match[<span class=
"org-highlight-numbers-number">2</span>]
<span class="linenr"> 2258: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">isStatic</span> = <span class=
"org-constant">true</span>
<span class="linenr"> 2259: </span>
<span class="linenr"> 2260: </span>      <span class=
"org-keyword">if</span> (content.startsWith(<span class=
"org-string">'['</span>)) {
<span class="linenr"> 2261: </span>        isStatic = <span class=
"org-constant">false</span>
<span class="linenr"> 2262: </span>
<span class=
"linenr"> 2263: </span>        content = content.slice(<span class=
"org-highlight-numbers-number">1</span>, content.length - <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 2264: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isSlot){
<span class=
"linenr"> 2265: </span>        content += match[<span class=
"org-highlight-numbers-number">3</span>] || <span class=
"org-string">''</span>
<span class="linenr"> 2266: </span>      }
<span class="linenr"> 2267: </span>
<span class="linenr"> 2268: </span>      arg = {
<span class=
"linenr"> 2269: </span>        type: NodeTypes.SIMPLE_EXPRESSION,
<span class="linenr"> 2270: </span>        content,
<span class="linenr"> 2271: </span>        isStatic,
<span class="linenr"> 2272: </span>        constType: isStatic
<span class=
"linenr"> 2273: </span>          ? ConstantTypes.CAN_STRINGIFY
<span class=
"linenr"> 2274: </span>          : ConstantTypes.NOT_CONSTANT,
<span class="linenr"> 2275: </span>        loc
<span class="linenr"> 2276: </span>      }
<span class="linenr"> 2277: </span>    }
<span class="linenr"> 2278: </span>
<span class="linenr"> 2279: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">quoted: `foo="bar"`, not quoted: `foo=bar`</span>
<span class="linenr"> 2280: </span>    <span class=
"org-keyword">if</span> (value &amp;& value.isQuoted) {
<span class="linenr"> 2281: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">valueLoc</span> = value.loc
<span class="linenr"> 2282: </span>      valueLoc.start.offset++
<span class="linenr"> 2283: </span>      valueLoc.start.column++
<span class=
"linenr"> 2284: </span>      valueLoc.end = advancePositionWithClone(valueLoc.start, value.content)
<span class=
"linenr"> 2285: </span>      valueLoc.source = valueLoc.source.slice(<span class="org-highlight-numbers-number">1</span>, -<span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 2286: </span>    }
<span class="linenr"> 2287: </span>
<span class="linenr"> 2288: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">修饰符 v-bind.number="foo" =&gt; '.number' =&gt; ['number']</span>
<span class="linenr"> 2289: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">modifiers</span> = match[<span class=
"org-highlight-numbers-number">3</span>] ? match[<span class=
"org-highlight-numbers-number">3</span>].slice(<span class=
"org-highlight-numbers-number">1</span>).split(<span class=
"org-string">'.'</span>) : []
<span class="linenr"> 2290: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">`&lt;div foo.prop="bar"&gt;` 如果不加 `.prop` 这个会被解析到 `$attrs` 中</span>
<span class="linenr"> 2291: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">如果加了 `.prop` 则会被解析到 `$props` 中去</span>
<span class="linenr"> 2292: </span>    <span class=
"org-keyword">if</span> (isPropShorthand) {
<span class=
"linenr"> 2293: </span>      modifiers.push(<span class="org-string">'prop'</span>)
<span class="linenr"> 2294: </span>    }
<span class="linenr"> 2295: </span>
<span class="linenr"> 2296: </span>    <span class=
"org-keyword">return</span> {
<span class="linenr"> 2297: </span>      type: NodeTypes.DIRECTIVE,
<span class="linenr"> 2298: </span>      name: dirName,
<span class="linenr"> 2299: </span>      exp: value &amp;& {
<span class=
"linenr"> 2300: </span>        type: NodeTypes.SIMPLE_EXPRESSION,
<span class="linenr"> 2301: </span>        content: value.content,
<span class="linenr"> 2302: </span>        isStatic: <span class=
"org-constant">false</span>,
<span class="linenr"> 2303: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Treat as non-constant by default. This can be potentially set to</span>
<span class="linenr"> 2304: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">other values by `transformExpression` to make it eligible for hoisting.</span>
<span class=
"linenr"> 2305: </span>        constType: ConstantTypes.NOT_CONSTANT,
<span class="linenr"> 2306: </span>        loc: value.loc
<span class="linenr"> 2307: </span>      },
<span class="linenr"> 2308: </span>      arg,
<span class="linenr"> 2309: </span>      modifiers,
<span class="linenr"> 2310: </span>      loc
<span class="linenr"> 2311: </span>    }
<span class="linenr"> 2312: </span>  }
<span class="linenr"> 2313: </span>
<span class="linenr"> 2314: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 2315: </span>    type: NodeTypes.ATTRIBUTE,
<span class="linenr"> 2316: </span>    name,
<span class="linenr"> 2317: </span>    value: value &amp;& {
<span class="linenr"> 2318: </span>      type: NodeTypes.TEXT,
<span class="linenr"> 2319: </span>      content: value.content,
<span class="linenr"> 2320: </span>      loc: value.loc
<span class="linenr"> 2321: </span>    },
<span class="linenr"> 2322: </span>    loc
<span class="linenr"> 2323: </span>  }
<span class="linenr"> 2324: </span>}
<span class="linenr"> 2325: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseAttributeValue</span>(<span class=
"org-variable-name">context</span>) {
<span class="linenr"> 2326: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = getCursor(context)
<span class="linenr"> 2327: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">content</span>
<span class="linenr"> 2328: </span>
<span class="linenr"> 2329: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">quote</span> = context.source[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 2330: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">value 分两种情况，可以用引号包起来也可以不使用引号</span>
<span class="linenr"> 2331: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">`&lt;div foo="value"&gt;` 或 `&lt;div foo=value&gt;`</span>
<span class="linenr"> 2332: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isQuoted</span> = quote === <span class=
"org-string">`"`</span> || quote === <span class=
"org-string">`'`</span>
<span class="linenr"> 2333: </span>  <span class=
"org-keyword">if</span> (isQuoted) {
<span class="linenr"> 2334: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Quoted value.</span>
<span class=
"linenr"> 2335: </span>    advanceBy(context, <span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr"> 2336: </span>
<span class="linenr"> 2337: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">endIndex</span> = context.source.indexOf(quote)
<span class="linenr"> 2338: </span>    <span class=
"org-keyword">if</span> (endIndex === -<span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 2339: </span>      content = parseTextData(
<span class="linenr"> 2340: </span>        context,
<span class="linenr"> 2341: </span>        context.source.length,
<span class=
"linenr"> 2342: </span>        TextModes.ATTRIBUTE_VALUE
<span class="linenr"> 2343: </span>      )
<span class="linenr"> 2344: </span>    } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 2345: </span>      content = parseTextData(context, endIndex, TextModes.ATTRIBUTE_VALUE)
<span class=
"linenr"> 2346: </span>      advanceBy(context, <span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr"> 2347: </span>    }
<span class="linenr"> 2348: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2349: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Unquoted</span>
<span class="linenr"> 2350: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">match</span> = <span class=
"org-string">/^[^\t\r\n\f &gt;]+/</span>.exec(context.source)
<span class="linenr"> 2351: </span>    <span class=
"org-keyword">if</span> (!match) {
<span class="linenr"> 2352: </span>      <span class=
"org-keyword">return</span> <span class=
"org-constant">undefined</span>
<span class="linenr"> 2353: </span>    }
<span class=
"linenr"> 2354: </span>    content = parseTextData(context, match[<span class="org-highlight-numbers-number">0</span>].length, TextModes.ATTRIBUTE_VALUE)
<span class="linenr"> 2355: </span>  }
<span class="linenr"> 2356: </span>
<span class="linenr"> 2357: </span>  <span class=
"org-keyword">return</span> { content, isQuoted, loc: getSelection(context, start) }
<span class="linenr"> 2358: </span>}
<span class="linenr"> 2359: </span>
<span class="linenr"> 2360: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">baseParse</span>(<span class=
"org-variable-name">content</span>, <span class=
"org-variable-name">options</span> = {}) {
<span class="linenr"> 2361: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">context</span> = createParserContext(content, options)
<span class="linenr"> 2362: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = getCursor(context)
<span class="linenr"> 2363: </span>  <span class=
"org-keyword">return</span> createRoot(
<span class=
"linenr"> 2364: </span>    parseChildren(context, TextModes.DATA, []),
<span class="linenr"> 2365: </span>    getSelection(context, start)
<span class="linenr"> 2366: </span>  )
<span class="linenr"> 2367: </span>}
<span class="linenr"> 2368: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createTransformContext</span>(
<span class="linenr"> 2369: </span>  <span class=
"org-variable-name">root</span>,
<span class="linenr"> 2370: </span>  {
<span class="linenr"> 2371: </span>    filename = <span class=
"org-string">''</span>,
<span class=
"linenr"> 2372: </span>    prefixIdentifiers = <span class=
"org-constant">false</span>,
<span class="linenr"> 2373: </span>    hoistStatic = <span class=
"org-constant">false</span>,
<span class="linenr"> 2374: </span>    cacheHandlers = <span class=
"org-constant">false</span>,
<span class="linenr"> 2375: </span>    nodeTransforms = [],
<span class="linenr"> 2376: </span>    directiveTransforms = {},
<span class=
"linenr"> 2377: </span>    transformHoist = <span class="org-constant">null</span>,
<span class="linenr"> 2378: </span>    isBuiltInComponent = NOOP,
<span class="linenr"> 2379: </span>    isCustomElement = NOOP,
<span class="linenr"> 2380: </span>    expressionPlugins = [],
<span class="linenr"> 2381: </span>    scopeId = <span class=
"org-constant">null</span>,
<span class="linenr"> 2382: </span>    slotted = <span class=
"org-constant">true</span>,
<span class="linenr"> 2383: </span>    ssr = <span class=
"org-constant">false</span>,
<span class="linenr"> 2384: </span>    inSSR = <span class=
"org-constant">false</span>,
<span class="linenr"> 2385: </span>    ssrCssVars = <span class=
"org-string">``</span>,
<span class="linenr"> 2386: </span>    bindingMetadata = EMPTY_OBJ,
<span class="linenr"> 2387: </span>    inline = <span class=
"org-constant">false</span>,
<span class="linenr"> 2388: </span>    isTS = <span class=
"org-constant">false</span>,
<span class="linenr"> 2389: </span>    onError = defaultOnError,
<span class="linenr"> 2390: </span>    onWarn = defaultOnWarn,
<span class="linenr"> 2391: </span>    compatConfig
<span class="linenr"> 2392: </span>  }
<span class="linenr"> 2393: </span>) {
<span class="linenr"> 2394: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">nameMatch</span> = filename.replace(<span class="org-string">/\?.*$/</span>, <span class="org-string">''</span>).match(<span class="org-string">/([^/\\]+)\.\w+$/</span>)
<span class="linenr"> 2395: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">context</span> = {
<span class="linenr"> 2396: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">options</span>
<span class=
"linenr"> 2397: </span>    selfName: nameMatch &amp;& capitalize(camelize(nameMatch[<span class="org-highlight-numbers-number">1</span>])),
<span class="linenr"> 2398: </span>    prefixIdentifiers,
<span class="linenr"> 2399: </span>    hoistStatic,
<span class="linenr"> 2400: </span>    cacheHandlers,
<span class="linenr"> 2401: </span>    nodeTransforms,
<span class="linenr"> 2402: </span>    directiveTransforms,
<span class="linenr"> 2403: </span>    transformHoist,
<span class="linenr"> 2404: </span>    isBuiltInComponent,
<span class="linenr"> 2405: </span>    isCustomElement,
<span class="linenr"> 2406: </span>    expressionPlugins,
<span class="linenr"> 2407: </span>    scopeId,
<span class="linenr"> 2408: </span>    slotted,
<span class="linenr"> 2409: </span>    ssr,
<span class="linenr"> 2410: </span>    inSSR,
<span class="linenr"> 2411: </span>    ssrCssVars,
<span class="linenr"> 2412: </span>    bindingMetadata,
<span class="linenr"> 2413: </span>    inline,
<span class="linenr"> 2414: </span>    isTS,
<span class="linenr"> 2415: </span>    onError,
<span class="linenr"> 2416: </span>    onWarn,
<span class="linenr"> 2417: </span>    compatConfig,
<span class="linenr"> 2418: </span>
<span class="linenr"> 2419: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">state</span>
<span class="linenr"> 2420: </span>    root,
<span class="linenr"> 2421: </span>    helpers: <span class=
"org-keyword">new</span> <span class="org-type">Map</span>(),
<span class="linenr"> 2422: </span>    components: <span class=
"org-keyword">new</span> <span class="org-type">Set</span>(),
<span class="linenr"> 2423: </span>    directives: <span class=
"org-keyword">new</span> <span class="org-type">Set</span>(),
<span class="linenr"> 2424: </span>    hoists: [],
<span class="linenr"> 2425: </span>    imports: [],
<span class="linenr"> 2426: </span>    constantCache: <span class=
"org-keyword">new</span> <span class="org-type">Map</span>(),
<span class="linenr"> 2427: </span>    temps: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 2428: </span>    cached: <span class=
"org-highlight-numbers-number">0</span>,
<span class=
"linenr"> 2429: </span>    identifiers: Object.create(<span class=
"org-constant">null</span>),
<span class="linenr"> 2430: </span>    scopes: { <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">记录下面四个指令的嵌套层次</span>
<span class="linenr"> 2431: </span>      vFor: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 2432: </span>      vSlot: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 2433: </span>      vPre: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 2434: </span>      vOnce: <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 2435: </span>    },
<span class="linenr"> 2436: </span>    parent: <span class=
"org-constant">null</span>,
<span class="linenr"> 2437: </span>    currentNode: root,
<span class="linenr"> 2438: </span>    childIndex: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 2439: </span>    inVOnce: <span class=
"org-constant">false</span>,
<span class="linenr"> 2440: </span>
<span class="linenr"> 2441: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">methods</span>
<span class="linenr"> 2442: </span>    helper(name) {
<span class="linenr"> 2443: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">count</span> = context.helpers.get(name) || <span class="org-highlight-numbers-number">0</span>
<span class=
"linenr"> 2444: </span>      context.helpers.set(name, count + <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 2445: </span>      <span class=
"org-keyword">return</span> name
<span class="linenr"> 2446: </span>    },
<span class="linenr"> 2447: </span>    removeHelper(name) {
<span class="linenr"> 2448: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">count</span> = context.helpers.get(name)
<span class="linenr"> 2449: </span>      <span class=
"org-keyword">if</span> (count) {
<span class="linenr"> 2450: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">currentCount</span> = count - <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 2451: </span>        <span class=
"org-keyword">if</span> (!currentCount) {
<span class=
"linenr"> 2452: </span>          context.helpers.<span class=
"org-keyword">delete</span>(name)
<span class="linenr"> 2453: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 2454: </span>          context.helpers.set(name, currentCount)
<span class="linenr"> 2455: </span>        }
<span class="linenr"> 2456: </span>      }
<span class="linenr"> 2457: </span>    },
<span class="linenr"> 2458: </span>    helperString(name) {
<span class="linenr"> 2459: </span>      <span class=
"org-keyword">return</span> <span class=
"org-string">`_${helperNameMap[context.helper(name)]}`</span>
<span class="linenr"> 2460: </span>    },
<span class="linenr"> 2461: </span>    replaceNode(node) {
<span class=
"linenr"> 2462: </span>      context.parent.children[context.childIndex] = context.currentNode = node
<span class="linenr"> 2463: </span>    },
<span class="linenr"> 2464: </span>    removeNode(node) {
<span class="linenr"> 2465: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">list</span> = context.parent.children
<span class="linenr"> 2466: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">removalIndex</span> = node
<span class="linenr"> 2467: </span>        ? list.indexOf(node)
<span class="linenr"> 2468: </span>        : context.currentNode
<span class="linenr"> 2469: </span>        ? context.childIndex
<span class="linenr"> 2470: </span>        : -<span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 2471: </span>
<span class="linenr"> 2472: </span>      <span class=
"org-keyword">if</span> (!node || node === context.currentNode) {
<span class="linenr"> 2473: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">current node removed</span>
<span class=
"linenr"> 2474: </span>        context.currentNode = <span class=
"org-constant">null</span>
<span class="linenr"> 2475: </span>        context.onNodeRemoved()
<span class="linenr"> 2476: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2477: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">sibling node removed</span>
<span class="linenr"> 2478: </span>        <span class=
"org-keyword">if</span> (context.childIndex &gt; removalIndex) {
<span class="linenr"> 2479: </span>          context.childIndex--
<span class=
"linenr"> 2480: </span>          context.onNodeRemoved()
<span class="linenr"> 2481: </span>        }
<span class="linenr"> 2482: </span>      }
<span class=
"linenr"> 2483: </span>      context.parent.children.splice(removalIndex, <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 2484: </span>    },
<span class="linenr"> 2485: </span>    onNodeRemoved: () =&gt; {},
<span class="linenr"> 2486: </span>    addIdentifiers(exp) {
<span class="linenr"> 2487: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">identifier tracking only happens in non-browser builds.</span>
<span class="linenr"> 2488: </span>      <span class=
"org-keyword">if</span> (!__BROWSER__) {
<span class="linenr"> 2489: </span>        <span class=
"org-keyword">if</span> (isString(exp)) {
<span class="linenr"> 2490: </span>          addId(exp)
<span class="linenr"> 2491: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (exp.identifiers) {
<span class=
"linenr"> 2492: </span>          exp.identifiers.forEach(addId)
<span class="linenr"> 2493: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (exp.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 2494: </span>          addId(exp.content)
<span class="linenr"> 2495: </span>        }
<span class="linenr"> 2496: </span>      }
<span class="linenr"> 2497: </span>    },
<span class="linenr"> 2498: </span>    removeIdentifiers(exp) {
<span class="linenr"> 2499: </span>      <span class=
"org-keyword">if</span> (!__BROWSER__) {
<span class="linenr"> 2500: </span>        <span class=
"org-keyword">if</span> (isString(exp)) {
<span class="linenr"> 2501: </span>          removeId(exp)
<span class="linenr"> 2502: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (exp.identifiers) {
<span class=
"linenr"> 2503: </span>          exp.identifiers.forEach(removeId)
<span class="linenr"> 2504: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (exp.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 2505: </span>          removeId(exp.content)
<span class="linenr"> 2506: </span>        }
<span class="linenr"> 2507: </span>      }
<span class="linenr"> 2508: </span>    },
<span class="linenr"> 2509: </span>    hoist(exp) {
<span class="linenr"> 2510: </span>      <span class=
"org-keyword">if</span> (isString(exp)) exp = createSimpleExpression(exp)
<span class="linenr"> 2511: </span>      context.hoists.push(exp)
<span class="linenr"> 2512: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">identifier</span> = createSimpleExpression(
<span class="linenr"> 2513: </span>        <span class=
"org-string">`_hoisted_${context.hoists.length}`</span>,
<span class="linenr"> 2514: </span>        <span class=
"org-constant">false</span>,
<span class="linenr"> 2515: </span>        exp.loc,
<span class="linenr"> 2516: </span>        ConstantTypes.CAN_HOIST
<span class="linenr"> 2517: </span>      )
<span class="linenr"> 2518: </span>      identifier.hoisted = exp
<span class="linenr"> 2519: </span>      <span class=
"org-keyword">return</span> identifier
<span class="linenr"> 2520: </span>    },
<span class=
"linenr"> 2521: </span>    cache(exp, isVNode = <span class=
"org-constant">false</span>) {
<span class="linenr"> 2522: </span>      <span class=
"org-keyword">return</span> createCacheExpression(context.cached++, exp, isVNode)
<span class="linenr"> 2523: </span>    }
<span class="linenr"> 2524: </span>  }
<span class="linenr"> 2525: </span>
<span class="linenr"> 2526: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">addId</span>(<span class=
"org-variable-name">id</span>) {
<span class="linenr"> 2527: </span>    <span class=
"org-keyword">const</span> { identifiers } = context
<span class="linenr"> 2528: </span>    <span class=
"org-keyword">if</span> (identifiers[id] === <span class=
"org-constant">undefined</span>) {
<span class=
"linenr"> 2529: </span>      identifiers[id] = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 2530: </span>    }
<span class="linenr"> 2531: </span>    identifiers[id]++
<span class="linenr"> 2532: </span>  }
<span class="linenr"> 2533: </span>
<span class="linenr"> 2534: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">removeId</span>(<span class=
"org-variable-name">id</span>) {
<span class="linenr"> 2535: </span>    context.identifiers[id]--
<span class="linenr"> 2536: </span>  }
<span class="linenr"> 2537: </span>
<span class="linenr"> 2538: </span>  <span class=
"org-keyword">return</span> context
<span class="linenr"> 2539: </span>}
<span class="linenr"> 2540: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">traverseNode</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 2541: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">记录当前正在处理的节点</span>
<span class="linenr"> 2542: </span>  context.currentNode = node
<span class="linenr"> 2543: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">对节点转换时使用到的插件(外部可通过这个来修改某个指令)</span>
<span class="linenr"> 2544: </span>  <span class=
"org-keyword">const</span> { nodeTransforms } = context
<span class="linenr"> 2545: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">递归遍历结束，回溯时调用的函数列表</span>
<span class="linenr"> 2546: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">也就是这个函数最后执行的函数，当一颗树遍历完成执行的函数</span>
<span class="linenr"> 2547: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">随后的 for 循环是用来收集这些函数的</span>
<span class="linenr"> 2548: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exitFns</span> = []
<span class="linenr"> 2549: </span>
<span class="linenr"> 2550: </span>  logg(<span class=
"org-string">'traverseNode'</span>, node)
<span class="linenr"> 2551: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; nodeTransforms.length; i++) {
<span class="linenr"> 2552: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">onExit</span> = nodeTransforms[i](node, context)
<span class="linenr"> 2553: </span>    <span class=
"org-keyword">if</span> (onExit) {
<span class="linenr"> 2554: </span>      <span class=
"org-keyword">if</span> (isArray(onExit)) {
<span class="linenr"> 2555: </span>        exitFns.push(...onExit)
<span class="linenr"> 2556: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2557: </span>        exitFns.push(onExit)
<span class="linenr"> 2558: </span>      }
<span class="linenr"> 2559: </span>    }
<span class="linenr"> 2560: </span>    <span class=
"org-keyword">if</span> (!context.currentNode) {
<span class="linenr"> 2561: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">node was removed</span>
<span class="linenr"> 2562: </span>      <span class=
"org-keyword">return</span>
<span class="linenr"> 2563: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2564: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">node may have been replaced</span>
<span class="linenr"> 2565: </span>      node = context.currentNode
<span class="linenr"> 2566: </span>    }
<span class="linenr"> 2567: </span>  }
<span class="linenr"> 2568: </span>
<span class="linenr"> 2569: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">根据节点类型来分别处理，这里忽略注释</span>
<span class="linenr"> 2570: </span>  <span class=
"org-keyword">switch</span> (node.type) {
<span class="linenr"> 2571: </span>    <span class=
"org-keyword">case</span> NodeTypes.INTERPOLATION:
<span class="linenr"> 2572: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no need to traverse, but we need to inject toString helper</span>
<span class="linenr"> 2573: </span>      <span class=
"org-keyword">if</span> (!context.ssr) {
<span class=
"linenr"> 2574: </span>        context.helper(TO_DISPLAY_STRING)
<span class="linenr"> 2575: </span>      }
<span class="linenr"> 2576: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 2577: </span>
<span class="linenr"> 2578: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for container types, further traverse downwards</span>
<span class="linenr"> 2579: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">处理 if...else if...else 分支</span>
<span class="linenr"> 2580: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF:
<span class="linenr"> 2581: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.branches.length; i++) {
<span class=
"linenr"> 2582: </span>        traverseNode(node.branches[i], context)
<span class="linenr"> 2583: </span>      }
<span class="linenr"> 2584: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 2585: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF_BRANCH: <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">else..if</span>
<span class="linenr"> 2586: </span>    <span class=
"org-keyword">case</span> NodeTypes.FOR: <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for</span>
<span class="linenr"> 2587: </span>    <span class=
"org-keyword">case</span> NodeTypes.ELEMENT:
<span class="linenr"> 2588: </span>    <span class=
"org-keyword">case</span> NodeTypes.ROOT:
<span class=
"linenr"> 2589: </span>      traverseChildren(node, context)
<span class="linenr"> 2590: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 2591: </span>  }
<span class="linenr"> 2592: </span>
<span class="linenr"> 2593: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">收集完成，执行这些收集到的函数，作用到当前节点上</span>
<span class="linenr"> 2594: </span>  context.currentNode = node
<span class="linenr"> 2595: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = exitFns.length
<span class="linenr"> 2596: </span>  <span class=
"org-keyword">while</span> (i--) {
<span class="linenr"> 2597: </span>    exitFns[i]()
<span class="linenr"> 2598: </span>  }
<span class="linenr"> 2599: </span>}
<span class="linenr"> 2600: </span>
<span class="linenr"> 2601: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">traverseChildren</span>(<span class=
"org-variable-name">parent</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 2602: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 2603: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">nodeRemoved</span> = () =&gt; {
<span class="linenr"> 2604: </span>    i--
<span class="linenr"> 2605: </span>  }
<span class="linenr"> 2606: </span>  <span class=
"org-keyword">for</span> (; i &lt; parent.children.length; i++) {
<span class="linenr"> 2607: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = parent.children[i]
<span class="linenr"> 2608: </span>    <span class=
"org-keyword">if</span> (isString(child)) <span class=
"org-keyword">continue</span>
<span class="linenr"> 2609: </span>    context.parent = parent
<span class="linenr"> 2610: </span>    context.childIndex = i
<span class=
"linenr"> 2611: </span>    context.onNodeRemoved = nodeRemoved
<span class="linenr"> 2612: </span>    traverseNode(child, context)
<span class="linenr"> 2613: </span>  }
<span class="linenr"> 2614: </span>}
<span class="linenr"> 2615: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">hoistStatic</span>(<span class=
"org-variable-name">root</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 2616: </span>  _walk(
<span class="linenr"> 2617: </span>    root,
<span class="linenr"> 2618: </span>    context,
<span class="linenr"> 2619: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Root node is unfortunately non-hoistable due to potential parent</span>
<span class="linenr"> 2620: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">fallthrough attributes.</span>
<span class=
"linenr"> 2621: </span>    isSingleElementRoot(root, root.children[<span class="org-highlight-numbers-number">0</span>])
<span class="linenr"> 2622: </span>  )
<span class="linenr"> 2623: </span>}
<span class="linenr"> 2624: </span>
<span class="linenr"> 2625: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isSingleElementRoot</span>(
<span class="linenr"> 2626: </span>  <span class=
"org-variable-name">root</span>,
<span class="linenr"> 2627: </span>  child
<span class="linenr"> 2628: </span>) {
<span class="linenr"> 2629: </span>  <span class=
"org-keyword">const</span> { children } = root
<span class="linenr"> 2630: </span>  <span class=
"org-keyword">return</span> (
<span class=
"linenr"> 2631: </span>    children.length === <span class=
"org-highlight-numbers-number">1</span> &amp;&
<span class=
"linenr"> 2632: </span>    child.type === NodeTypes.ELEMENT &amp;&
<span class="linenr"> 2633: </span>    !isSlotOutlet(child)
<span class="linenr"> 2634: </span>  )
<span class="linenr"> 2635: </span>}
<span class="linenr"> 2636: </span>
<span class="linenr"> 2637: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">_walk</span>(
<span class="linenr"> 2638: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 2639: </span>  <span class=
"org-variable-name">context</span>,
<span class="linenr"> 2640: </span>  doNotHoistNode = <span class=
"org-constant">false</span>
<span class="linenr"> 2641: </span>) {
<span class="linenr"> 2642: </span>  <span class=
"org-keyword">const</span> { children } = node
<span class="linenr"> 2643: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">originalCount</span> = children.length
<span class="linenr"> 2644: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hoistedCount</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 2645: </span>
<span class="linenr"> 2646: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; children.length; i++) {
<span class="linenr"> 2647: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = children[i]
<span class="linenr"> 2648: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">only plain elements & text calls are eligible for hoisting.</span>
<span class="linenr"> 2649: </span>    <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 2650: </span>      child.type === NodeTypes.ELEMENT &amp;&
<span class=
"linenr"> 2651: </span>      child.tagType === ElementTypes.ELEMENT
<span class="linenr"> 2652: </span>    ) {
<span class="linenr"> 2653: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">constantType</span> = doNotHoistNode
<span class=
"linenr"> 2654: </span>        ? ConstantTypes.NOT_CONSTANT
<span class=
"linenr"> 2655: </span>        : getConstantType(child, context)
<span class="linenr"> 2656: </span>      <span class=
"org-keyword">if</span> (constantType &gt; ConstantTypes.NOT_CONSTANT) {
<span class="linenr"> 2657: </span>        <span class=
"org-keyword">if</span> (constantType &gt;= ConstantTypes.CAN_HOIST) {
<span class=
"linenr"> 2658: </span>          child.codegenNode.patchFlag =
<span class=
"linenr"> 2659: </span>            PatchFlags.HOISTED + (__DEV__ ? <span class="org-string">` /* HOISTED */`</span> : <span class="org-string">``</span>)
<span class=
"linenr"> 2660: </span>          child.codegenNode = context.hoist(child.codegenNode)
<span class="linenr"> 2661: </span>          hoistedCount++
<span class="linenr"> 2662: </span>          <span class=
"org-keyword">continue</span>
<span class="linenr"> 2663: </span>        }
<span class="linenr"> 2664: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2665: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">node may contain dynamic children, but its props may be eligible for</span>
<span class="linenr"> 2666: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">hoisting.</span>
<span class="linenr"> 2667: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">codegenNode</span> = child.codegenNode
<span class="linenr"> 2668: </span>        <span class=
"org-keyword">if</span> (codegenNode.type === NodeTypes.VNODE_CALL) {
<span class="linenr"> 2669: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">flag</span> = getPatchFlag(codegenNode)
<span class="linenr"> 2670: </span>          <span class=
"org-keyword">if</span> (
<span class="linenr"> 2671: </span>            (!flag ||
<span class=
"linenr"> 2672: </span>              flag === PatchFlags.NEED_PATCH ||
<span class=
"linenr"> 2673: </span>              flag === PatchFlags.TEXT) &amp;&
<span class=
"linenr"> 2674: </span>            getGeneratedPropsConstantType(child, context) &gt;=
<span class=
"linenr"> 2675: </span>              ConstantTypes.CAN_HOIST
<span class="linenr"> 2676: </span>          ) {
<span class="linenr"> 2677: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">props</span> = getNodeProps(child)
<span class="linenr"> 2678: </span>            <span class=
"org-keyword">if</span> (props) {
<span class=
"linenr"> 2679: </span>              codegenNode.props = context.hoist(props)
<span class="linenr"> 2680: </span>            }
<span class="linenr"> 2681: </span>          }
<span class="linenr"> 2682: </span>          <span class=
"org-keyword">if</span> (codegenNode.dynamicProps) {
<span class=
"linenr"> 2683: </span>            codegenNode.dynamicProps = context.hoist(codegenNode.dynamicProps)
<span class="linenr"> 2684: </span>          }
<span class="linenr"> 2685: </span>        }
<span class="linenr"> 2686: </span>      }
<span class="linenr"> 2687: </span>    } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr"> 2688: </span>      child.type === NodeTypes.TEXT_CALL &amp;&
<span class=
"linenr"> 2689: </span>      getConstantType(child.content, context) &gt;= ConstantTypes.CAN_HOIST
<span class="linenr"> 2690: </span>    ) {
<span class=
"linenr"> 2691: </span>      child.codegenNode = context.hoist(child.codegenNode)
<span class="linenr"> 2692: </span>      hoistedCount++
<span class="linenr"> 2693: </span>    }
<span class="linenr"> 2694: </span>
<span class="linenr"> 2695: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">walk further</span>
<span class="linenr"> 2696: </span>    <span class=
"org-keyword">if</span> (child.type === NodeTypes.ELEMENT) {
<span class="linenr"> 2697: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isComponent</span> = child.tagType === ElementTypes.COMPONENT
<span class="linenr"> 2698: </span>      <span class=
"org-keyword">if</span> (isComponent) {
<span class="linenr"> 2699: </span>        context.scopes.vSlot++
<span class="linenr"> 2700: </span>      }
<span class="linenr"> 2701: </span>      _walk(child, context)
<span class="linenr"> 2702: </span>      <span class=
"org-keyword">if</span> (isComponent) {
<span class="linenr"> 2703: </span>        context.scopes.vSlot--
<span class="linenr"> 2704: </span>      }
<span class="linenr"> 2705: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (child.type === NodeTypes.FOR) {
<span class="linenr"> 2706: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Do not hoist v-for single child because it has to be a block</span>
<span class=
"linenr"> 2707: </span>      _walk(child, context, child.children.length === <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 2708: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (child.type === NodeTypes.IF) {
<span class="linenr"> 2709: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; child.branches.length; i++) {
<span class="linenr"> 2710: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Do not hoist v-if single child because it has to be a block</span>
<span class="linenr"> 2711: </span>        _walk(
<span class="linenr"> 2712: </span>          child.branches[i],
<span class="linenr"> 2713: </span>          context,
<span class=
"linenr"> 2714: </span>          child.branches[i].children.length === <span class="org-highlight-numbers-number">1</span>
<span class="linenr"> 2715: </span>        )
<span class="linenr"> 2716: </span>      }
<span class="linenr"> 2717: </span>    }
<span class="linenr"> 2718: </span>  }
<span class="linenr"> 2719: </span>
<span class="linenr"> 2720: </span>  <span class=
"org-keyword">if</span> (hoistedCount &amp;& context.transformHoist) {
<span class="linenr"> 2721: </span>    logg(<span class=
"org-string">`hoist walk -&gt; transformHoist, hoistedCount = ${hoistedCount}`</span>)
<span class=
"linenr"> 2722: </span>    context.transformHoist(children, context, node)
<span class="linenr"> 2723: </span>  }
<span class="linenr"> 2724: </span>
<span class="linenr"> 2725: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">all children were hoisted - the entire children array is hoistable.</span>
<span class="linenr"> 2726: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 2727: </span>    hoistedCount &amp;&
<span class=
"linenr"> 2728: </span>    hoistedCount === originalCount &amp;&
<span class=
"linenr"> 2729: </span>    node.type === NodeTypes.ELEMENT &amp;&
<span class=
"linenr"> 2730: </span>    node.tagType === ElementTypes.ELEMENT &amp;&
<span class="linenr"> 2731: </span>    node.codegenNode &amp;&
<span class=
"linenr"> 2732: </span>    node.codegenNode.type === NodeTypes.VNODE_CALL &amp;&
<span class=
"linenr"> 2733: </span>    isArray(node.codegenNode.children)
<span class="linenr"> 2734: </span>  ) {
<span class=
"linenr"> 2735: </span>    node.codegenNode.children = context.hoist(
<span class=
"linenr"> 2736: </span>      createArrayExpression(node.codegenNode.children)
<span class="linenr"> 2737: </span>    )
<span class="linenr"> 2738: </span>  }
<span class="linenr"> 2739: </span>}
<span class="linenr"> 2740: </span>
<span class="linenr"> 2741: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getConstantType</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 2742: </span>  <span class=
"org-keyword">const</span> { constantCache } = context
<span class="linenr"> 2743: </span>  <span class=
"org-keyword">switch</span> (node.type) {
<span class="linenr"> 2744: </span>    <span class=
"org-keyword">case</span> NodeTypes.ELEMENT:
<span class="linenr"> 2745: </span>      <span class=
"org-keyword">if</span> (node.tagType !== ElementTypes.ELEMENT) {
<span class="linenr"> 2746: </span>        <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2747: </span>      }
<span class="linenr"> 2748: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">cached</span> = constantCache.get(node)
<span class="linenr"> 2749: </span>      <span class=
"org-keyword">if</span> (cached !== <span class=
"org-constant">undefined</span>) {
<span class="linenr"> 2750: </span>        <span class=
"org-keyword">return</span> cached
<span class="linenr"> 2751: </span>      }
<span class="linenr"> 2752: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">codegenNode</span> = node.codegenNode
<span class="linenr"> 2753: </span>      <span class=
"org-keyword">if</span> (codegenNode.type !== NodeTypes.VNODE_CALL) {
<span class="linenr"> 2754: </span>        <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2755: </span>      }
<span class="linenr"> 2756: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 2757: </span>        codegenNode.isBlock &amp;&
<span class=
"linenr"> 2758: </span>        node.tag !== <span class="org-string">'svg'</span> &amp;&
<span class=
"linenr"> 2759: </span>        node.tag !== <span class="org-string">'foreignObject'</span>
<span class="linenr"> 2760: </span>      ) {
<span class="linenr"> 2761: </span>        <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2762: </span>      }
<span class="linenr"> 2763: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">flag</span> = getPatchFlag(codegenNode)
<span class="linenr"> 2764: </span>      <span class=
"org-keyword">if</span> (!flag) {
<span class="linenr"> 2765: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">returnType</span> = ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 2766: </span>
<span class="linenr"> 2767: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Element itself has no patch flag. However we still need to check:</span>
<span class="linenr"> 2768: </span>
<span class="linenr"> 2769: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. Even for a node with no patch flag, it is possible for it to contain</span>
<span class="linenr"> 2770: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">non-hoistable expressions that refers to scope variables, e.g. compiler</span>
<span class="linenr"> 2771: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">injected keys or cached event handlers. Therefore we need to always</span>
<span class="linenr"> 2772: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check the codegenNode's props to be sure.</span>
<span class="linenr"> 2773: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">generatedPropsType</span> = getGeneratedPropsConstantType(node, context)
<span class="linenr"> 2774: </span>        <span class=
"org-keyword">if</span> (generatedPropsType === ConstantTypes.NOT_CONSTANT) {
<span class=
"linenr"> 2775: </span>          constantCache.set(node, ConstantTypes.NOT_CONSTANT)
<span class="linenr"> 2776: </span>          <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2777: </span>        }
<span class="linenr"> 2778: </span>        <span class=
"org-keyword">if</span> (generatedPropsType &lt; returnType) {
<span class=
"linenr"> 2779: </span>          returnType = generatedPropsType
<span class="linenr"> 2780: </span>        }
<span class="linenr"> 2781: </span>
<span class="linenr"> 2782: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. its children.</span>
<span class="linenr"> 2783: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.children.length; i++) {
<span class="linenr"> 2784: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">childType</span> = getConstantType(node.children[i], context)
<span class="linenr"> 2785: </span>          <span class=
"org-keyword">if</span> (childType === ConstantTypes.NOT_CONSTANT) {
<span class=
"linenr"> 2786: </span>            constantCache.set(node, ConstantTypes.NOT_CONSTANT)
<span class="linenr"> 2787: </span>            <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2788: </span>          }
<span class="linenr"> 2789: </span>          <span class=
"org-keyword">if</span> (childType &lt; returnType) {
<span class=
"linenr"> 2790: </span>            returnType = childType
<span class="linenr"> 2791: </span>          }
<span class="linenr"> 2792: </span>        }
<span class="linenr"> 2793: </span>
<span class="linenr"> 2794: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">3. if the type is not already CAN_SKIP_PATCH which is the lowest non-0</span>
<span class="linenr"> 2795: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">type, check if any of the props can cause the type to be lowered</span>
<span class="linenr"> 2796: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we can skip can_patch because it's guaranteed by the absence of a</span>
<span class="linenr"> 2797: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">patchFlag.</span>
<span class="linenr"> 2798: </span>        <span class=
"org-keyword">if</span> (returnType &gt; ConstantTypes.CAN_SKIP_PATCH) {
<span class="linenr"> 2799: </span>          <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr"> 2800: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = node.props[i]
<span class="linenr"> 2801: </span>            <span class=
"org-keyword">if</span> (p.type === NodeTypes.DIRECTIVE &amp;& p.name === <span class="org-string">'bind'</span> &amp;& p.exp) {
<span class="linenr"> 2802: </span>              <span class=
"org-keyword">const</span> <span class=
"org-variable-name">expType</span> = getConstantType(p.exp, context)
<span class="linenr"> 2803: </span>              <span class=
"org-keyword">if</span> (expType === ConstantTypes.NOT_CONSTANT) {
<span class=
"linenr"> 2804: </span>                constantCache.set(node, ConstantTypes.NOT_CONSTANT)
<span class="linenr"> 2805: </span>                <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2806: </span>              }
<span class="linenr"> 2807: </span>              <span class=
"org-keyword">if</span> (expType &lt; returnType) {
<span class=
"linenr"> 2808: </span>                returnType = expType
<span class="linenr"> 2809: </span>              }
<span class="linenr"> 2810: </span>            }
<span class="linenr"> 2811: </span>          }
<span class="linenr"> 2812: </span>        }
<span class="linenr"> 2813: </span>
<span class="linenr"> 2814: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">only svg/foreignObject could be block here, however if they are</span>
<span class="linenr"> 2815: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">static then they don't need to be blocks since there will be no</span>
<span class="linenr"> 2816: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">nested updates.</span>
<span class="linenr"> 2817: </span>        <span class=
"org-keyword">if</span> (codegenNode.isBlock) {
<span class=
"linenr"> 2818: </span>          context.removeHelper(OPEN_BLOCK)
<span class="linenr"> 2819: </span>          context.removeHelper(
<span class=
"linenr"> 2820: </span>            getVNodeBlockHelper(context.inSSR, codegenNode.isComponent)
<span class="linenr"> 2821: </span>          )
<span class=
"linenr"> 2822: </span>          codegenNode.isBlock = <span class=
"org-constant">false</span>
<span class=
"linenr"> 2823: </span>          context.helper(getVNodeHelper(context.inSSR, codegenNode.isComponent))
<span class="linenr"> 2824: </span>        }
<span class="linenr"> 2825: </span>
<span class=
"linenr"> 2826: </span>        constantCache.set(node, returnType)
<span class="linenr"> 2827: </span>        <span class=
"org-keyword">return</span> returnType
<span class="linenr"> 2828: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 2829: </span>        constantCache.set(node, ConstantTypes.NOT_CONSTANT)
<span class="linenr"> 2830: </span>        <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2831: </span>      }
<span class="linenr"> 2832: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT:
<span class="linenr"> 2833: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMMENT:
<span class="linenr"> 2834: </span>      <span class=
"org-keyword">return</span> ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 2835: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF:
<span class="linenr"> 2836: </span>    <span class=
"org-keyword">case</span> NodeTypes.FOR:
<span class="linenr"> 2837: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF_BRANCH:
<span class="linenr"> 2838: </span>      <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2839: </span>    <span class=
"org-keyword">case</span> NodeTypes.INTERPOLATION:
<span class="linenr"> 2840: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT_CALL:
<span class="linenr"> 2841: </span>      <span class=
"org-keyword">return</span> getConstantType(node.content, context)
<span class="linenr"> 2842: </span>    <span class=
"org-keyword">case</span> NodeTypes.SIMPLE_EXPRESSION:
<span class="linenr"> 2843: </span>      <span class=
"org-keyword">return</span> node.constType
<span class="linenr"> 2844: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMPOUND_EXPRESSION:
<span class="linenr"> 2845: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">returnType</span> = ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 2846: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.children.length; i++) {
<span class="linenr"> 2847: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = node.children[i]
<span class="linenr"> 2848: </span>        <span class=
"org-keyword">if</span> (isString(child) || isSymbol(child)) {
<span class="linenr"> 2849: </span>          <span class=
"org-keyword">continue</span>
<span class="linenr"> 2850: </span>        }
<span class="linenr"> 2851: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">childType</span> = getConstantType(child, context)
<span class="linenr"> 2852: </span>        <span class=
"org-keyword">if</span> (childType === ConstantTypes.NOT_CONSTANT) {
<span class="linenr"> 2853: </span>          <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2854: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (childType &lt; returnType) {
<span class="linenr"> 2855: </span>          returnType = childType
<span class="linenr"> 2856: </span>        }
<span class="linenr"> 2857: </span>      }
<span class="linenr"> 2858: </span>      <span class=
"org-keyword">return</span> returnType
<span class="linenr"> 2859: </span>    <span class=
"org-keyword">default</span>:
<span class="linenr"> 2860: </span>      <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2861: </span>  }
<span class="linenr"> 2862: </span>}
<span class="linenr"> 2863: </span>
<span class="linenr"> 2864: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">allowHoistedHelperSet</span> = <span class=
"org-keyword">new</span> <span class="org-type">Set</span>([
<span class="linenr"> 2865: </span>  NORMALIZE_CLASS,
<span class="linenr"> 2866: </span>  NORMALIZE_STYLE,
<span class="linenr"> 2867: </span>  NORMALIZE_PROPS,
<span class="linenr"> 2868: </span>  GUARD_REACTIVE_PROPS
<span class="linenr"> 2869: </span>])
<span class="linenr"> 2870: </span>
<span class="linenr"> 2871: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getConstantTypeOfHelperCall</span>(<span class=
"org-variable-name">value</span>, <span class=
"org-variable-name">context</span>){
<span class="linenr"> 2872: </span>  <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 2873: </span>    value.type === NodeTypes.JS_CALL_EXPRESSION &amp;&
<span class=
"linenr"> 2874: </span>    !isString(value.callee) &amp;&
<span class=
"linenr"> 2875: </span>    allowHoistedHelperSet.has(value.callee)
<span class="linenr"> 2876: </span>  ) {
<span class="linenr"> 2877: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">arg</span> = value.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 2878: </span>    <span class=
"org-keyword">if</span> (arg.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 2879: </span>      <span class=
"org-keyword">return</span> getConstantType(arg, context)
<span class="linenr"> 2880: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (arg.type === NodeTypes.JS_CALL_EXPRESSION) {
<span class="linenr"> 2881: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in the case of nested helper call, e.g. `normalizeProps(guardReactiveProps(exp))`</span>
<span class="linenr"> 2882: </span>      <span class=
"org-keyword">return</span> getConstantTypeOfHelperCall(arg, context)
<span class="linenr"> 2883: </span>    }
<span class="linenr"> 2884: </span>  }
<span class="linenr"> 2885: </span>  <span class=
"org-keyword">return</span> ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2886: </span>}
<span class="linenr"> 2887: </span>
<span class="linenr"> 2888: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getGeneratedPropsConstantType</span>(<span class="org-variable-name">node</span>, <span class="org-variable-name">context</span>) {
<span class="linenr"> 2889: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">returnType</span> = ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 2890: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">props</span> = getNodeProps(node)
<span class="linenr"> 2891: </span>  <span class=
"org-keyword">if</span> (props &amp;& props.type === NodeTypes.JS_OBJECT_EXPRESSION) {
<span class="linenr"> 2892: </span>    <span class=
"org-keyword">const</span> { properties } = props
<span class="linenr"> 2893: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; properties.length; i++) {
<span class="linenr"> 2894: </span>      <span class=
"org-keyword">const</span> { key, value } = properties[i]
<span class="linenr"> 2895: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyType</span> = getConstantType(key, context)
<span class="linenr"> 2896: </span>      <span class=
"org-keyword">if</span> (keyType === ConstantTypes.NOT_CONSTANT) {
<span class="linenr"> 2897: </span>        <span class=
"org-keyword">return</span> keyType
<span class="linenr"> 2898: </span>      }
<span class="linenr"> 2899: </span>      <span class=
"org-keyword">if</span> (keyType &lt; returnType) {
<span class="linenr"> 2900: </span>        returnType = keyType
<span class="linenr"> 2901: </span>      }
<span class="linenr"> 2902: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">valueType</span>
<span class="linenr"> 2903: </span>      <span class=
"org-keyword">if</span> (value.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class=
"linenr"> 2904: </span>        valueType = getConstantType(value, context)
<span class="linenr"> 2905: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (value.type === NodeTypes.JS_CALL_EXPRESSION) {
<span class="linenr"> 2906: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">some helper calls can be hoisted,</span>
<span class="linenr"> 2907: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">such as the `normalizeProps` generated by the compiler for pre-normalize class,</span>
<span class="linenr"> 2908: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in this case we need to respect the ConstantType of the helper's arguments</span>
<span class=
"linenr"> 2909: </span>        valueType = getConstantTypeOfHelperCall(value, context)
<span class="linenr"> 2910: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 2911: </span>        valueType = ConstantTypes.NOT_CONSTANT
<span class="linenr"> 2912: </span>      }
<span class="linenr"> 2913: </span>      <span class=
"org-keyword">if</span> (valueType === ConstantTypes.NOT_CONSTANT) {
<span class="linenr"> 2914: </span>        <span class=
"org-keyword">return</span> valueType
<span class="linenr"> 2915: </span>      }
<span class="linenr"> 2916: </span>      <span class=
"org-keyword">if</span> (valueType &lt; returnType) {
<span class="linenr"> 2917: </span>        returnType = valueType
<span class="linenr"> 2918: </span>      }
<span class="linenr"> 2919: </span>    }
<span class="linenr"> 2920: </span>  }
<span class="linenr"> 2921: </span>  <span class=
"org-keyword">return</span> returnType
<span class="linenr"> 2922: </span>}
<span class="linenr"> 2923: </span>
<span class="linenr"> 2924: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getNodeProps</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr"> 2925: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">codegenNode</span> = node.codegenNode
<span class="linenr"> 2926: </span>  <span class=
"org-keyword">if</span> (codegenNode.type === NodeTypes.VNODE_CALL) {
<span class="linenr"> 2927: </span>    <span class=
"org-keyword">return</span> codegenNode.props
<span class="linenr"> 2928: </span>  }
<span class="linenr"> 2929: </span>}
<span class="linenr"> 2930: </span>
<span class="linenr"> 2931: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getPatchFlag</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr"> 2932: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">flag</span> = node.patchFlag
<span class="linenr"> 2933: </span>  <span class=
"org-keyword">return</span> flag ? parseInt(flag, <span class=
"org-highlight-numbers-number">10</span>) : <span class=
"org-constant">undefined</span>
<span class="linenr"> 2934: </span>}
<span class="linenr"> 2935: </span>
<span class="linenr"> 2936: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createRootCodegen</span>(<span class=
"org-variable-name">root</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 2937: </span>  <span class=
"org-keyword">const</span> { helper } = context
<span class="linenr"> 2938: </span>  <span class=
"org-keyword">const</span> { children } = root
<span class="linenr"> 2939: </span>  logg(<span class=
"org-string">'createRootCodegen'</span>, <span class=
"org-string">`children=${children.length}, 只有一个用 block, 多个用Fragment`</span>)
<span class="linenr"> 2940: </span>  <span class=
"org-keyword">if</span> (children.length === <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 2941: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = children[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 2942: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if the single child is an element, turn it into a block.</span>
<span class="linenr"> 2943: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">如果只有一个根元素，如： &lt;template&gt;&lt;div&gt;...&lt;/div&gt;&lt;/template&gt;</span>
<span class="linenr"> 2944: </span>    <span class=
"org-keyword">if</span> (isSingleElementRoot(root, child) &amp;& child.codegenNode) {
<span class="linenr"> 2945: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">single element root is never hoisted so codegenNode will never be</span>
<span class="linenr"> 2946: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">SimpleExpressionNode</span>
<span class="linenr"> 2947: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">codegenNode</span> = child.codegenNode
<span class="linenr"> 2948: </span>      <span class=
"org-keyword">if</span> (codegenNode.type === NodeTypes.VNODE_CALL) {
<span class=
"linenr"> 2949: </span>        makeBlock(codegenNode, context)
<span class="linenr"> 2950: </span>      }
<span class=
"linenr"> 2951: </span>      root.codegenNode = codegenNode
<span class="linenr"> 2952: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2953: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">- single &lt;slot/&gt;, IfNode, ForNode: already blocks.</span>
<span class="linenr"> 2954: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">- single text node: always patched.</span>
<span class="linenr"> 2955: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">root codegen falls through via genNode()</span>
<span class="linenr"> 2956: </span>      root.codegenNode = child
<span class="linenr"> 2957: </span>    }
<span class="linenr"> 2958: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (children.length &gt; <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 2959: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">root 下有多个节点时，使用 fragment block，3.x 特性，2.x中是不支持多个元素的</span>
<span class="linenr"> 2960: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">patchFlag</span> = PatchFlags.STABLE_FRAGMENT
<span class="linenr"> 2961: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">patchFlagText</span> = PatchFlagNames[PatchFlags.STABLE_FRAGMENT]
<span class="linenr"> 2962: </span>
<span class=
"linenr"> 2963: </span>    root.codegenNode = createVNodeCall(
<span class="linenr"> 2964: </span>      context,
<span class="linenr"> 2965: </span>      helper(FRAGMENT),
<span class="linenr"> 2966: </span>      <span class=
"org-constant">undefined</span>,
<span class="linenr"> 2967: </span>      root.children,
<span class=
"linenr"> 2968: </span>      patchFlag + (__DEV__ ? <span class=
"org-string">` /* ${patchFlagText} */`</span> : <span class=
"org-string">``</span>),
<span class="linenr"> 2969: </span>      <span class=
"org-constant">undefined</span>,
<span class="linenr"> 2970: </span>      <span class=
"org-constant">undefined</span>,
<span class="linenr"> 2971: </span>      <span class=
"org-constant">true</span>,
<span class="linenr"> 2972: </span>      <span class=
"org-constant">undefined</span>,
<span class="linenr"> 2973: </span>      <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">isComponent</span><span class=
"org-comment-delimiter"> */</span>
<span class="linenr"> 2974: </span>    )
<span class="linenr"> 2975: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 2976: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no children = noop. codegen will return null.</span>
<span class="linenr"> 2977: </span>  }
<span class="linenr"> 2978: </span>}
<span class="linenr"> 2979: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createStructuralDirectiveTransform</span>(<span class="org-variable-name">name</span>, <span class="org-variable-name">fn</span>) {
<span class="linenr"> 2980: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">正则就用 test 方法，字符串直接比较</span>
<span class="linenr"> 2981: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">matches</span> = isString(name)
<span class="linenr"> 2982: </span>    ? (n) =&gt; n === name
<span class="linenr"> 2983: </span>    : (n) =&gt; name.test(n)
<span class="linenr"> 2984: </span>
<span class="linenr"> 2985: </span>  logg(<span class=
"org-string">'createStructuralDirectiveTransform'</span>, <span class="org-string">`name=${name}, matches=${matches}`</span>)
<span class="linenr"> 2986: </span>  <span class=
"org-keyword">return</span> (node, context) =&gt; {
<span class="linenr"> 2987: </span>    <span class=
"org-keyword">if</span> (node.type === NodeTypes.ELEMENT) {
<span class="linenr"> 2988: </span>      <span class=
"org-keyword">const</span> { props } = node
<span class="linenr"> 2989: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-slot 指令特殊处理，代码在 vSlot.ts 中，所以这里跳过它</span>
<span class="linenr"> 2990: </span>      <span class=
"org-keyword">if</span> (node.tagType === ElementTypes.TEMPLATE &amp;& props.some(isVSlot)) {
<span class="linenr"> 2991: </span>        <span class=
"org-keyword">return</span>
<span class="linenr"> 2992: </span>      }
<span class="linenr"> 2993: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exitFns</span> = []
<span class="linenr"> 2994: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; props.length; i++) {
<span class="linenr"> 2995: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prop</span> = props[i]
<span class="linenr"> 2996: </span>        <span class=
"org-keyword">if</span> (prop.type === NodeTypes.DIRECTIVE &amp;& matches(prop.name)) {
<span class="linenr"> 2997: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">structural directives are removed to avoid infinite recursion</span>
<span class="linenr"> 2998: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">also we remove them *before* applying so that it can further</span>
<span class="linenr"> 2999: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">traverse itself in case it moves the node around</span>
<span class=
"linenr"> 3000: </span>          props.splice(i, <span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr"> 3001: </span>          i--
<span class="linenr"> 3002: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">onExit</span> = fn(node, prop, context)
<span class="linenr"> 3003: </span>          <span class=
"org-keyword">if</span> (onExit) exitFns.push(onExit)
<span class="linenr"> 3004: </span>        }
<span class="linenr"> 3005: </span>      }
<span class="linenr"> 3006: </span>      <span class=
"org-keyword">return</span> exitFns
<span class="linenr"> 3007: </span>    }
<span class="linenr"> 3008: </span>  }
<span class="linenr"> 3009: </span>}
<span class="linenr"> 3010: </span>
<span class="linenr"> 3011: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getBaseTransformPreset</span>(<span class=
"org-variable-name">prefixIdentifiers</span>) {
<span class="linenr"> 3012: </span>  <span class=
"org-keyword">return</span> [
<span class="linenr"> 3013: </span>    [
<span class="linenr"> 3014: </span>      transformOnce,
<span class="linenr"> 3015: </span>      transformIf,
<span class="linenr"> 3016: </span>      transformMemo,
<span class="linenr"> 3017: </span>      transformFor,
<span class=
"linenr"> 3018: </span>      ...(!__BROWSER__ &amp;& prefixIdentifiers
<span class="linenr"> 3019: </span>        ? [
<span class="linenr"> 3020: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">order is important</span>
<span class="linenr"> 3021: </span>            trackVForSlotScopes,
<span class="linenr"> 3022: </span>            transformExpression
<span class="linenr"> 3023: </span>          ]
<span class=
"linenr"> 3024: </span>        : __BROWSER__ &amp;& __DEV__
<span class="linenr"> 3025: </span>        ? [transformExpression]
<span class="linenr"> 3026: </span>        : []),
<span class="linenr"> 3027: </span>      transformSlotOutlet,
<span class="linenr"> 3028: </span>      transformElement,
<span class="linenr"> 3029: </span>      trackSlotScopes,
<span class="linenr"> 3030: </span>      transformText
<span class="linenr"> 3031: </span>    ],
<span class="linenr"> 3032: </span>    {
<span class="linenr"> 3033: </span>      on: transformOn,
<span class="linenr"> 3034: </span>      bind: transformBind,
<span class="linenr"> 3035: </span>      model: transformModel
<span class="linenr"> 3036: </span>    }
<span class="linenr"> 3037: </span>  ]
<span class="linenr"> 3038: </span>}
<span class="linenr"> 3039: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">makeBlock</span>(<span class=
"org-variable-name">node</span>, { <span class=
"org-variable-name">helper</span>, <span class=
"org-variable-name">removeHelper</span>, <span class=
"org-variable-name">inSSR</span> }) {
<span class="linenr"> 3040: </span>  <span class=
"org-keyword">if</span> (!node.isBlock) {
<span class="linenr"> 3041: </span>    node.isBlock = <span class=
"org-constant">true</span>
<span class=
"linenr"> 3042: </span>    removeHelper(getVNodeHelper(inSSR, node.isComponent))
<span class="linenr"> 3043: </span>    helper(OPEN_BLOCK)
<span class=
"linenr"> 3044: </span>    helper(getVNodeBlockHelper(inSSR, node.isComponent))
<span class="linenr"> 3045: </span>  }
<span class="linenr"> 3046: </span>}
<span class="linenr"> 3047: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">defaultFallback</span> = createSimpleExpression(<span class="org-string">`undefined`</span>, <span class="org-constant">false</span>)
<span class="linenr"> 3048: </span>
<span class="linenr"> 3049: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">A NodeTransform that:</span>
<span class="linenr"> 3050: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. Tracks scope identifiers for scoped slots so that they don't get prefixed</span>
<span class="linenr"> 3051: </span><span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">by transformExpression. This is only applied in non-browser builds with</span>
<span class="linenr"> 3052: </span><span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">{ prefixIdentifiers: true }.</span>
<span class="linenr"> 3053: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. Track v-slot depths so that we know a slot is inside another slot.</span>
<span class="linenr"> 3054: </span><span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">Note the exit callback is executed before buildSlots() on the same node,</span>
<span class="linenr"> 3055: </span><span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">so only nested slots see positive numbers.</span>
<span class="linenr"> 3056: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">trackSlotScopes</span> = (node, context) =&gt; {
<span class="linenr"> 3057: </span>  <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 3058: </span>    node.type === NodeTypes.ELEMENT &amp;&
<span class=
"linenr"> 3059: </span>    (node.tagType === ElementTypes.COMPONENT ||
<span class=
"linenr"> 3060: </span>      node.tagType === ElementTypes.TEMPLATE)
<span class="linenr"> 3061: </span>  ) {
<span class="linenr"> 3062: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">We are only checking non-empty v-slot here</span>
<span class="linenr"> 3063: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">since we only care about slots that introduce scope variables.</span>
<span class="linenr"> 3064: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">vSlot</span> = findDir(node, <span class=
"org-string">'slot'</span>)
<span class="linenr"> 3065: </span>    <span class=
"org-keyword">if</span> (vSlot) {
<span class="linenr"> 3066: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotProps</span> = vSlot.exp
<span class="linenr"> 3067: </span>      <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 3068: </span>        slotProps &amp;& context.addIdentifiers(slotProps)
<span class="linenr"> 3069: </span>      }
<span class="linenr"> 3070: </span>      context.scopes.vSlot++
<span class="linenr"> 3071: </span>      <span class=
"org-keyword">return</span> () =&gt; {
<span class="linenr"> 3072: </span>        <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 3073: </span>          slotProps &amp;& context.removeIdentifiers(slotProps)
<span class="linenr"> 3074: </span>        }
<span class="linenr"> 3075: </span>        context.scopes.vSlot--
<span class="linenr"> 3076: </span>      }
<span class="linenr"> 3077: </span>    }
<span class="linenr"> 3078: </span>  }
<span class="linenr"> 3079: </span>}
<span class="linenr"> 3080: </span>
<span class="linenr"> 3081: </span>
<span class="linenr"> 3082: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">A NodeTransform that tracks scope identifiers for scoped slots with v-for.</span>
<span class="linenr"> 3083: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">This transform is only applied in non-browser builds with { prefixIdentifiers: true }</span>
<span class="linenr"> 3084: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">trackVForSlotScopes</span> = (node, context) =&gt; {
<span class="linenr"> 3085: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vFor</span>
<span class="linenr"> 3086: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 3087: </span>    isTemplateNode(node) &amp;&
<span class=
"linenr"> 3088: </span>    node.props.some(isVSlot) &amp;&
<span class=
"linenr"> 3089: </span>    (vFor = findDir(node, <span class=
"org-string">'for'</span>))
<span class="linenr"> 3090: </span>  ) {
<span class="linenr"> 3091: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">result</span> = (vFor.parseResult = parseForExpression(
<span class="linenr"> 3092: </span>      vFor.exp,
<span class="linenr"> 3093: </span>      context
<span class="linenr"> 3094: </span>    ))
<span class="linenr"> 3095: </span>    <span class=
"org-keyword">if</span> (result) {
<span class="linenr"> 3096: </span>      <span class=
"org-keyword">const</span> { value, key, index } = result
<span class="linenr"> 3097: </span>      <span class=
"org-keyword">const</span> { addIdentifiers, removeIdentifiers } = context
<span class=
"linenr"> 3098: </span>      value &amp;& addIdentifiers(value)
<span class=
"linenr"> 3099: </span>      key &amp;& addIdentifiers(key)
<span class=
"linenr"> 3100: </span>      index &amp;& addIdentifiers(index)
<span class="linenr"> 3101: </span>
<span class="linenr"> 3102: </span>      <span class=
"org-keyword">return</span> () =&gt; {
<span class=
"linenr"> 3103: </span>        value &amp;& removeIdentifiers(value)
<span class=
"linenr"> 3104: </span>        key &amp;& removeIdentifiers(key)
<span class=
"linenr"> 3105: </span>        index &amp;& removeIdentifiers(index)
<span class="linenr"> 3106: </span>      }
<span class="linenr"> 3107: </span>    }
<span class="linenr"> 3108: </span>  }
<span class="linenr"> 3109: </span>}
<span class="linenr"> 3110: </span>
<span class="linenr"> 3111: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">buildClientSlotFn</span> = (props, children, loc) =&gt;
<span class="linenr"> 3112: </span>  createFunctionExpression(
<span class="linenr"> 3113: </span>    props,
<span class="linenr"> 3114: </span>    children,
<span class="linenr"> 3115: </span>    <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">newline</span><span class=
"org-comment-delimiter"> */</span>,
<span class="linenr"> 3116: </span>    <span class=
"org-constant">true</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">isSlot</span><span class=
"org-comment-delimiter"> */</span>,
<span class=
"linenr"> 3117: </span>    children.length ? children[<span class=
"org-highlight-numbers-number">0</span>].loc : loc
<span class="linenr"> 3118: </span>  )
<span class="linenr"> 3119: </span>
<span class="linenr"> 3120: </span>
<span class="linenr"> 3121: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Instead of being a DirectiveTransform, v-slot processing is called during</span>
<span class="linenr"> 3122: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">transformElement to build the slots object for a component.</span>
<span class="linenr"> 3123: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">buildSlots</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">buildSlotFn</span>= <span class=
"org-variable-name">buildClientSlotFn</span>) {
<span class="linenr"> 3124: </span>  context.helper(WITH_CTX)
<span class="linenr"> 3125: </span>
<span class="linenr"> 3126: </span>  <span class=
"org-keyword">const</span> { children, loc } = node
<span class="linenr"> 3127: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotsProperties</span> = []
<span class="linenr"> 3128: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">dynamicSlots</span>= []
<span class="linenr"> 3129: </span>
<span class="linenr"> 3130: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">If the slot is inside a v-for or another v-slot, force it to be dynamic</span>
<span class="linenr"> 3131: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">since it likely uses a scope variable.</span>
<span class="linenr"> 3132: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasDynamicSlots</span> = context.scopes.vSlot &gt; <span class="org-highlight-numbers-number">0</span> || context.scopes.vFor &gt; <span class="org-highlight-numbers-number">0</span>
<span class="linenr"> 3133: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">with `prefixIdentifiers: true`, this can be further optimized to make</span>
<span class="linenr"> 3134: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">it dynamic only when the slot actually uses the scope variables.</span>
<span class="linenr"> 3135: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& !context.ssr &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 3136: </span>    hasDynamicSlots = hasScopeRef(node, context.identifiers)
<span class="linenr"> 3137: </span>  }
<span class="linenr"> 3138: </span>
<span class="linenr"> 3139: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. Check for slot with slotProps on component itself.</span>
<span class="linenr"> 3140: </span>  <span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">&lt;Comp v-slot="{ prop }"/&gt;</span>
<span class="linenr"> 3141: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">onComponentSlot</span> = findDir(node, <span class="org-string">'slot'</span>, <span class="org-constant">true</span>)
<span class="linenr"> 3142: </span>  <span class=
"org-keyword">if</span> (onComponentSlot) {
<span class="linenr"> 3143: </span>    <span class=
"org-keyword">const</span> { arg, exp } = onComponentSlot
<span class="linenr"> 3144: </span>    <span class=
"org-keyword">if</span> (arg &amp;& !isStaticExp(arg)) {
<span class=
"linenr"> 3145: </span>      hasDynamicSlots = <span class=
"org-constant">true</span>
<span class="linenr"> 3146: </span>    }
<span class="linenr"> 3147: </span>    slotsProperties.push(
<span class="linenr"> 3148: </span>      createObjectProperty(
<span class=
"linenr"> 3149: </span>        arg || createSimpleExpression(<span class="org-string">'default'</span>, <span class="org-constant">true</span>),
<span class=
"linenr"> 3150: </span>        buildSlotFn(exp, children, loc)
<span class="linenr"> 3151: </span>      )
<span class="linenr"> 3152: </span>    )
<span class="linenr"> 3153: </span>  }
<span class="linenr"> 3154: </span>
<span class="linenr"> 3155: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. Iterate through children and check for template slots</span>
<span class="linenr"> 3156: </span>  <span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">&lt;template v-slot:foo="{ prop }"&gt;</span>
<span class="linenr"> 3157: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasTemplateSlots</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3158: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasNamedDefaultSlot</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3159: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">implicitDefaultChildren</span> = []
<span class="linenr"> 3160: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">seenSlotNames</span> = <span class=
"org-keyword">new</span> <span class="org-type">Set</span>()
<span class="linenr"> 3161: </span>
<span class="linenr"> 3162: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; children.length; i++) {
<span class="linenr"> 3163: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotElement</span> = children[i]
<span class="linenr"> 3164: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">slotDir</span>
<span class="linenr"> 3165: </span>
<span class="linenr"> 3166: </span>    <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 3167: </span>      !isTemplateNode(slotElement) ||
<span class=
"linenr"> 3168: </span>      !(slotDir = findDir(slotElement, <span class="org-string">'slot'</span>, <span class="org-constant">true</span>))
<span class="linenr"> 3169: </span>    ) { <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">收集不在 template v-slot 中的元素/组件，这些都会合并到默认插槽中去</span>
<span class="linenr"> 3170: </span>      <span class=
"org-keyword">if</span> (slotElement.type !== NodeTypes.COMMENT) {
<span class=
"linenr"> 3171: </span>        implicitDefaultChildren.push(slotElement)
<span class="linenr"> 3172: </span>      }
<span class="linenr"> 3173: </span>      <span class=
"org-keyword">continue</span>
<span class="linenr"> 3174: </span>    }
<span class="linenr"> 3175: </span>
<span class="linenr"> 3176: </span>    <span class=
"org-keyword">if</span> (onComponentSlot) {
<span class="linenr"> 3177: </span>      logg(<span class=
"org-string">`buildSlots already has on-component slot - this is incorrect usage`</span>)
<span class="linenr"> 3178: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 3179: </span>    }
<span class="linenr"> 3180: </span>
<span class=
"linenr"> 3181: </span>    hasTemplateSlots = <span class=
"org-constant">true</span>
<span class="linenr"> 3182: </span>    <span class=
"org-keyword">const</span> { children: <span class=
"org-variable-name">slotChildren</span>, loc: <span class=
"org-variable-name">slotLoc</span> } = slotElement
<span class="linenr"> 3183: </span>    <span class=
"org-keyword">const</span> {
<span class=
"linenr"> 3184: </span>      arg: slotName = createSimpleExpression(<span class="org-string">`default`</span>, <span class="org-constant">true</span>),
<span class="linenr"> 3185: </span>      exp: slotProps,
<span class="linenr"> 3186: </span>      loc: dirLoc
<span class="linenr"> 3187: </span>    } = slotDir
<span class="linenr"> 3188: </span>
<span class="linenr"> 3189: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check if name is dynamic.</span>
<span class="linenr"> 3190: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">staticSlotName</span>
<span class="linenr"> 3191: </span>    <span class=
"org-keyword">if</span> (isStaticExp(slotName)) {
<span class=
"linenr"> 3192: </span>      staticSlotName = slotName ? slotName.content : <span class="org-string">`default`</span>
<span class="linenr"> 3193: </span>    } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 3194: </span>      hasDynamicSlots = <span class=
"org-constant">true</span>
<span class="linenr"> 3195: </span>    }
<span class="linenr"> 3196: </span>
<span class="linenr"> 3197: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotFunction</span> = buildSlotFn(slotProps, slotChildren, slotLoc)
<span class="linenr"> 3198: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check if this slot is conditional (v-if/v-for)</span>
<span class="linenr"> 3199: </span>    <span class=
"org-keyword">let</span> <span class="org-variable-name">vIf</span>
<span class="linenr"> 3200: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vElse</span>
<span class="linenr"> 3201: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vFor</span>
<span class="linenr"> 3202: </span>    <span class=
"org-keyword">if</span> ((vIf = findDir(slotElement, <span class=
"org-string">'if'</span>))) {
<span class=
"linenr"> 3203: </span>      hasDynamicSlots = <span class=
"org-constant">true</span>
<span class="linenr"> 3204: </span>      dynamicSlots.push(
<span class=
"linenr"> 3205: </span>        createConditionalExpression(
<span class="linenr"> 3206: </span>          vIf.exp,
<span class=
"linenr"> 3207: </span>          buildDynamicSlot(slotName, slotFunction),
<span class="linenr"> 3208: </span>          defaultFallback
<span class="linenr"> 3209: </span>        )
<span class="linenr"> 3210: </span>      )
<span class="linenr"> 3211: </span>    } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr"> 3212: </span>      (vElse = findDir(slotElement, <span class="org-string">/^else(-if)?$/</span>, <span class="org-constant">true</span> <span class="org-comment-delimiter">/* </span><span class="org-comment">allowEmpty</span><span class="org-comment-delimiter"> */</span>))
<span class="linenr"> 3213: </span>    ) {
<span class="linenr"> 3214: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">find adjacent v-if</span>
<span class="linenr"> 3215: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">j</span> = i
<span class="linenr"> 3216: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">prev</span>
<span class="linenr"> 3217: </span>      <span class=
"org-keyword">while</span> (j--) {
<span class="linenr"> 3218: </span>        prev = children[j]
<span class="linenr"> 3219: </span>        <span class=
"org-keyword">if</span> (prev.type !== NodeTypes.COMMENT) {
<span class="linenr"> 3220: </span>          <span class=
"org-keyword">break</span>
<span class="linenr"> 3221: </span>        }
<span class="linenr"> 3222: </span>      }
<span class="linenr"> 3223: </span>      <span class=
"org-keyword">if</span> (prev &amp;& isTemplateNode(prev) &amp;& findDir(prev, <span class="org-string">'if'</span>)) {
<span class="linenr"> 3224: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">remove node</span>
<span class=
"linenr"> 3225: </span>        children.splice(i, <span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr"> 3226: </span>        i--
<span class="linenr"> 3227: </span>
<span class="linenr"> 3228: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">attach this slot to previous conditional</span>
<span class="linenr"> 3229: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">conditional</span> = dynamicSlots[
<span class=
"linenr"> 3230: </span>          dynamicSlots.length - <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 3231: </span>        ]
<span class="linenr"> 3232: </span>        <span class=
"org-keyword">while</span> (
<span class=
"linenr"> 3233: </span>          conditional.alternate.type === NodeTypes.JS_CONDITIONAL_EXPRESSION
<span class="linenr"> 3234: </span>        ) {
<span class=
"linenr"> 3235: </span>          conditional = conditional.alternate
<span class="linenr"> 3236: </span>        }
<span class=
"linenr"> 3237: </span>        conditional.alternate = vElse.exp
<span class=
"linenr"> 3238: </span>          ? createConditionalExpression(
<span class="linenr"> 3239: </span>              vElse.exp,
<span class=
"linenr"> 3240: </span>              buildDynamicSlot(slotName, slotFunction),
<span class="linenr"> 3241: </span>              defaultFallback
<span class="linenr"> 3242: </span>            )
<span class=
"linenr"> 3243: </span>          : buildDynamicSlot(slotName, slotFunction)
<span class="linenr"> 3244: </span>      }
<span class="linenr"> 3245: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> ((vFor = findDir(slotElement, <span class=
"org-string">'for'</span>))) {
<span class=
"linenr"> 3246: </span>      hasDynamicSlots = <span class=
"org-constant">true</span>
<span class="linenr"> 3247: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parseResult</span> =
<span class="linenr"> 3248: </span>        vFor.parseResult ||
<span class=
"linenr"> 3249: </span>        parseForExpression(vFor.exp , context)
<span class="linenr"> 3250: </span>      <span class=
"org-keyword">if</span> (parseResult) {
<span class="linenr"> 3251: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Render the dynamic slots as an array and add it to the createSlot()</span>
<span class="linenr"> 3252: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">args. The runtime knows how to handle it appropriately.</span>
<span class="linenr"> 3253: </span>        dynamicSlots.push(
<span class=
"linenr"> 3254: </span>          createCallExpression(context.helper(RENDER_LIST), [
<span class="linenr"> 3255: </span>            parseResult.source,
<span class=
"linenr"> 3256: </span>            createFunctionExpression(
<span class=
"linenr"> 3257: </span>              createForLoopParams(parseResult),
<span class=
"linenr"> 3258: </span>              buildDynamicSlot(slotName, slotFunction),
<span class="linenr"> 3259: </span>              <span class=
"org-constant">true</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">force newline</span><span class=
"org-comment-delimiter"> */</span>
<span class="linenr"> 3260: </span>            )
<span class="linenr"> 3261: </span>          ])
<span class="linenr"> 3262: </span>        )
<span class="linenr"> 3263: </span>      }
<span class="linenr"> 3264: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 3265: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check duplicate static names</span>
<span class="linenr"> 3266: </span>      <span class=
"org-keyword">if</span> (staticSlotName) {
<span class="linenr"> 3267: </span>        <span class=
"org-keyword">if</span> (seenSlotNames.has(staticSlotName)) {
<span class="linenr"> 3268: </span>          logg(<span class=
"org-string">`buildSlots seenSlotNames has slot name`</span>)
<span class="linenr"> 3269: </span>          <span class=
"org-keyword">continue</span>
<span class="linenr"> 3270: </span>        }
<span class=
"linenr"> 3271: </span>        seenSlotNames.add(staticSlotName)
<span class="linenr"> 3272: </span>        <span class=
"org-keyword">if</span> (staticSlotName === <span class=
"org-string">'default'</span>) {
<span class=
"linenr"> 3273: </span>          hasNamedDefaultSlot = <span class=
"org-constant">true</span>
<span class="linenr"> 3274: </span>        }
<span class="linenr"> 3275: </span>      }
<span class=
"linenr"> 3276: </span>      slotsProperties.push(createObjectProperty(slotName, slotFunction))
<span class="linenr"> 3277: </span>    }
<span class="linenr"> 3278: </span>  }
<span class="linenr"> 3279: </span>
<span class="linenr"> 3280: </span>  <span class=
"org-keyword">if</span> (!onComponentSlot) {
<span class="linenr"> 3281: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">buildDefaultSlotProperty</span> = (props, children) =&gt; {
<span class="linenr"> 3282: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">fn</span> = buildSlotFn(props, children, loc)
<span class="linenr"> 3283: </span>
<span class="linenr"> 3284: </span>      <span class=
"org-keyword">return</span> createObjectProperty(<span class=
"org-string">`default`</span>, fn)
<span class="linenr"> 3285: </span>    }
<span class="linenr"> 3286: </span>
<span class="linenr"> 3287: </span>    <span class=
"org-keyword">if</span> (!hasTemplateSlots) {
<span class="linenr"> 3288: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">implicit default slot (on component)</span>
<span class=
"linenr"> 3289: </span>      slotsProperties.push(buildDefaultSlotProperty(<span class="org-constant">undefined</span>, children))
<span class="linenr"> 3290: </span>    } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr"> 3291: </span>      implicitDefaultChildren.length &amp;&
<span class="linenr"> 3292: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#3766</span>
<span class="linenr"> 3293: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">with whitespace: 'preserve', whitespaces between slots will end up in</span>
<span class="linenr"> 3294: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">implicitDefaultChildren. Ignore if all implicit children are whitespaces.</span>
<span class=
"linenr"> 3295: </span>      implicitDefaultChildren.some(node =&gt; isNonWhitespaceContent(node))
<span class="linenr"> 3296: </span>    ) {
<span class="linenr"> 3297: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">implicit default slot (mixed with named slots)</span>
<span class="linenr"> 3298: </span>      <span class=
"org-keyword">if</span> (hasNamedDefaultSlot) {
<span class="linenr"> 3299: </span>        logg(<span class=
"org-string">`buildSlots hasNamedDefaultSlot`</span>)
<span class="linenr"> 3300: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 3301: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">合并到默认插槽</span>
<span class="linenr"> 3302: </span>        slotsProperties.push(
<span class=
"linenr"> 3303: </span>          buildDefaultSlotProperty(<span class="org-constant">undefined</span>, implicitDefaultChildren)
<span class="linenr"> 3304: </span>        )
<span class="linenr"> 3305: </span>      }
<span class="linenr"> 3306: </span>    }
<span class="linenr"> 3307: </span>  }
<span class="linenr"> 3308: </span>
<span class="linenr"> 3309: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotFlag</span> = hasDynamicSlots
<span class="linenr"> 3310: </span>    ? SlotFlags.DYNAMIC
<span class=
"linenr"> 3311: </span>    : hasForwardedSlots(node.children)
<span class="linenr"> 3312: </span>    ? SlotFlags.FORWARDED
<span class="linenr"> 3313: </span>    : SlotFlags.STABLE
<span class="linenr"> 3314: </span>
<span class="linenr"> 3315: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">slots</span> = createObjectExpression(
<span class="linenr"> 3316: </span>    slotsProperties.concat(
<span class="linenr"> 3317: </span>      createObjectProperty(
<span class="linenr"> 3318: </span>        <span class=
"org-string">`_`</span>,
<span class="linenr"> 3319: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2 = compiled but dynamic = can skip normalization, but must run diff</span>
<span class="linenr"> 3320: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1 = compiled and static = can skip normalization AND diff as optimized</span>
<span class="linenr"> 3321: </span>        createSimpleExpression(
<span class=
"linenr"> 3322: </span>          slotFlag + (__DEV__ ? <span class=
"org-string">` /* ${slotFlagsText[slotFlag]} */`</span> : <span class="org-string">``</span>),
<span class="linenr"> 3323: </span>          <span class=
"org-constant">false</span>
<span class="linenr"> 3324: </span>        )
<span class="linenr"> 3325: </span>      )
<span class="linenr"> 3326: </span>    ),
<span class="linenr"> 3327: </span>    loc
<span class="linenr"> 3328: </span>  )
<span class="linenr"> 3329: </span>  <span class=
"org-keyword">if</span> (dynamicSlots.length) {
<span class=
"linenr"> 3330: </span>    slots = createCallExpression(context.helper(CREATE_SLOTS), [
<span class="linenr"> 3331: </span>      slots,
<span class=
"linenr"> 3332: </span>      createArrayExpression(dynamicSlots)
<span class="linenr"> 3333: </span>    ])
<span class="linenr"> 3334: </span>  }
<span class="linenr"> 3335: </span>
<span class="linenr"> 3336: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 3337: </span>    slots,
<span class="linenr"> 3338: </span>    hasDynamicSlots
<span class="linenr"> 3339: </span>  }
<span class="linenr"> 3340: </span>}
<span class="linenr"> 3341: </span>
<span class="linenr"> 3342: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">buildDynamicSlot</span>(<span class=
"org-variable-name">name</span>, <span class=
"org-variable-name">fn</span>) {
<span class="linenr"> 3343: </span>  <span class=
"org-keyword">return</span> createObjectExpression([
<span class=
"linenr"> 3344: </span>    createObjectProperty(<span class=
"org-string">`name`</span>, name),
<span class=
"linenr"> 3345: </span>    createObjectProperty(<span class=
"org-string">`fn`</span>, fn)
<span class="linenr"> 3346: </span>  ])
<span class="linenr"> 3347: </span>}
<span class="linenr"> 3348: </span>
<span class="linenr"> 3349: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">hasForwardedSlots</span>(<span class=
"org-variable-name">children</span>) {
<span class="linenr"> 3350: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; children.length; i++) {
<span class="linenr"> 3351: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = children[i]
<span class="linenr"> 3352: </span>    <span class=
"org-keyword">switch</span> (child.type) {
<span class="linenr"> 3353: </span>      <span class=
"org-keyword">case</span> NodeTypes.ELEMENT:
<span class="linenr"> 3354: </span>        <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 3355: </span>          child.tagType === ElementTypes.SLOT ||
<span class=
"linenr"> 3356: </span>          hasForwardedSlots(child.children)
<span class="linenr"> 3357: </span>        ) {
<span class="linenr"> 3358: </span>          <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 3359: </span>        }
<span class="linenr"> 3360: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 3361: </span>      <span class=
"org-keyword">case</span> NodeTypes.IF:
<span class="linenr"> 3362: </span>        <span class=
"org-keyword">if</span> (hasForwardedSlots(child.branches)) <span class="org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 3363: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 3364: </span>      <span class=
"org-keyword">case</span> NodeTypes.IF_BRANCH:
<span class="linenr"> 3365: </span>      <span class=
"org-keyword">case</span> NodeTypes.FOR:
<span class="linenr"> 3366: </span>        <span class=
"org-keyword">if</span> (hasForwardedSlots(child.children)) <span class="org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 3367: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 3368: </span>      <span class=
"org-keyword">default</span>:
<span class="linenr"> 3369: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 3370: </span>    }
<span class="linenr"> 3371: </span>  }
<span class="linenr"> 3372: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 3373: </span>}
<span class="linenr"> 3374: </span>
<span class="linenr"> 3375: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isNonWhitespaceContent</span>(<span class=
"org-variable-name">node</span>){
<span class="linenr"> 3376: </span>  <span class=
"org-keyword">if</span> (node.type !== NodeTypes.TEXT &amp;& node.type !== NodeTypes.TEXT_CALL)
<span class="linenr"> 3377: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 3378: </span>  <span class=
"org-keyword">return</span> node.type === NodeTypes.TEXT
<span class="linenr"> 3379: </span>    ? !!node.content.trim()
<span class=
"linenr"> 3380: </span>    : isNonWhitespaceContent(node.content)
<span class="linenr"> 3381: </span>}
<span class="linenr"> 3382: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">some directive transforms (e.g. v-model) may return a symbol for runtime</span>
<span class="linenr"> 3383: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">import, which should be used instead of a resolveDirective call.</span>
<span class="linenr"> 3384: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">directiveImportMap</span> = <span class=
"org-keyword">new</span> <span class="org-type">WeakMap</span>()
<span class="linenr"> 3385: </span>
<span class="linenr"> 3386: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">generate a JavaScript AST for this element's codegen</span>
<span class="linenr"> 3387: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformElement</span> = (node, context) =&gt; {
<span class="linenr"> 3388: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">perform the work on exit, after all child expressions have been</span>
<span class="linenr"> 3389: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">processed and merged.</span>
<span class="linenr"> 3390: </span>  <span class=
"org-keyword">return</span> <span class=
"org-keyword">function</span> postTransformElement() {
<span class="linenr"> 3391: </span>    node = context.currentNode
<span class="linenr"> 3392: </span>
<span class="linenr"> 3393: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr"> 3394: </span>      !(
<span class=
"linenr"> 3395: </span>        node.type === NodeTypes.ELEMENT &amp;&
<span class=
"linenr"> 3396: </span>        (node.tagType === ElementTypes.ELEMENT ||
<span class=
"linenr"> 3397: </span>          node.tagType === ElementTypes.COMPONENT)
<span class="linenr"> 3398: </span>      )
<span class="linenr"> 3399: </span>    ) {
<span class="linenr"> 3400: </span>      <span class=
"org-keyword">return</span>
<span class="linenr"> 3401: </span>    }
<span class="linenr"> 3402: </span>
<span class="linenr"> 3403: </span>    <span class=
"org-keyword">const</span> { tag, props } = node
<span class="linenr"> 3404: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isComponent</span> = node.tagType === ElementTypes.COMPONENT
<span class="linenr"> 3405: </span>
<span class="linenr"> 3406: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">The goal of the transform is to create a codegenNode implementing the</span>
<span class="linenr"> 3407: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">VNodeCall interface.</span>
<span class="linenr"> 3408: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vnodeTag</span> = isComponent
<span class=
"linenr"> 3409: </span>      ? resolveComponentType(node, context)
<span class="linenr"> 3410: </span>      : <span class=
"org-string">`"${tag}"`</span>
<span class="linenr"> 3411: </span>
<span class="linenr"> 3412: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDynamicComponent</span> =
<span class=
"linenr"> 3413: </span>      isObject(vnodeTag) &amp;& vnodeTag.callee === RESOLVE_DYNAMIC_COMPONENT
<span class="linenr"> 3414: </span>
<span class="linenr"> 3415: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vnodeProps</span>
<span class="linenr"> 3416: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vnodeChildren</span>
<span class="linenr"> 3417: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vnodePatchFlag</span>
<span class="linenr"> 3418: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">patchFlag</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 3419: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vnodeDynamicProps</span>
<span class="linenr"> 3420: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">dynamicPropNames</span>
<span class="linenr"> 3421: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">vnodeDirectives</span>
<span class="linenr"> 3422: </span>
<span class="linenr"> 3423: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">shouldUseBlock</span> =
<span class="linenr"> 3424: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">dynamic component may resolve to plain elements</span>
<span class="linenr"> 3425: </span>      isDynamicComponent ||
<span class="linenr"> 3426: </span>      vnodeTag === TELEPORT ||
<span class="linenr"> 3427: </span>      vnodeTag === SUSPENSE ||
<span class="linenr"> 3428: </span>      (!isComponent &amp;&
<span class="linenr"> 3429: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;svg&gt; and &lt;foreignObject&gt; must be forced into blocks so that block</span>
<span class="linenr"> 3430: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">updates inside get proper isSVG flag at runtime. (#639, #643)</span>
<span class="linenr"> 3431: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">This is technically web-specific, but splitting the logic out of core</span>
<span class="linenr"> 3432: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">leads to too much unnecessary complexity.</span>
<span class="linenr"> 3433: </span>        (tag === <span class=
"org-string">'svg'</span> || tag === <span class=
"org-string">'foreignObject'</span>))
<span class="linenr"> 3434: </span>
<span class="linenr"> 3435: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props</span>
<span class="linenr"> 3436: </span>    <span class=
"org-keyword">if</span> (props.length &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 3437: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">propsBuildResult</span> = buildProps(node, context)
<span class=
"linenr"> 3438: </span>      vnodeProps = propsBuildResult.props
<span class=
"linenr"> 3439: </span>      patchFlag = propsBuildResult.patchFlag
<span class=
"linenr"> 3440: </span>      dynamicPropNames = propsBuildResult.dynamicPropNames
<span class="linenr"> 3441: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">directives</span> = propsBuildResult.directives
<span class="linenr"> 3442: </span>      vnodeDirectives =
<span class=
"linenr"> 3443: </span>        directives &amp;& directives.length
<span class=
"linenr"> 3444: </span>          ? (createArrayExpression(
<span class=
"linenr"> 3445: </span>              directives.map(dir =&gt; buildDirectiveArgs(dir, context))
<span class="linenr"> 3446: </span>            ))
<span class="linenr"> 3447: </span>          : <span class=
"org-constant">undefined</span>
<span class="linenr"> 3448: </span>
<span class="linenr"> 3449: </span>      <span class=
"org-keyword">if</span> (propsBuildResult.shouldUseBlock) {
<span class=
"linenr"> 3450: </span>        shouldUseBlock = <span class=
"org-constant">true</span>
<span class="linenr"> 3451: </span>      }
<span class="linenr"> 3452: </span>    }
<span class="linenr"> 3453: </span>
<span class="linenr"> 3454: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">children</span>
<span class="linenr"> 3455: </span>    <span class=
"org-keyword">if</span> (node.children.length &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 3456: </span>      <span class=
"org-keyword">if</span> (vnodeTag === KEEP_ALIVE) {
<span class="linenr"> 3457: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Although a built-in component, we compile KeepAlive with raw children</span>
<span class="linenr"> 3458: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">instead of slot functions so that it can be used inside Transition</span>
<span class="linenr"> 3459: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">or other Transition-wrapping HOCs.</span>
<span class="linenr"> 3460: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">To ensure correct updates with block optimizations, we need to:</span>
<span class="linenr"> 3461: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. Force keep-alive into a block. This avoids its children being</span>
<span class="linenr"> 3462: </span>        <span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">collected by a parent block.</span>
<span class=
"linenr"> 3463: </span>        shouldUseBlock = <span class=
"org-constant">true</span>
<span class="linenr"> 3464: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. Force keep-alive to always be updated, since it uses raw children.</span>
<span class=
"linenr"> 3465: </span>        patchFlag |= PatchFlags.DYNAMIC_SLOTS
<span class="linenr"> 3466: </span>      }
<span class="linenr"> 3467: </span>
<span class="linenr"> 3468: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">shouldBuildAsSlots</span> =
<span class="linenr"> 3469: </span>        isComponent &amp;&
<span class="linenr"> 3470: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Teleport is not a real component and has dedicated runtime handling</span>
<span class=
"linenr"> 3471: </span>        vnodeTag !== TELEPORT &amp;&
<span class="linenr"> 3472: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">explained above.</span>
<span class="linenr"> 3473: </span>        vnodeTag !== KEEP_ALIVE
<span class="linenr"> 3474: </span>
<span class="linenr"> 3475: </span>      <span class=
"org-keyword">if</span> (shouldBuildAsSlots) {
<span class="linenr"> 3476: </span>        <span class=
"org-keyword">const</span> { slots, hasDynamicSlots } = buildSlots(node, context)
<span class="linenr"> 3477: </span>        vnodeChildren = slots
<span class="linenr"> 3478: </span>        <span class=
"org-keyword">if</span> (hasDynamicSlots) {
<span class=
"linenr"> 3479: </span>          patchFlag |= PatchFlags.DYNAMIC_SLOTS
<span class="linenr"> 3480: </span>        }
<span class="linenr"> 3481: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.children.length === <span class=
"org-highlight-numbers-number">1</span> &amp;& vnodeTag !== TELEPORT) {
<span class="linenr"> 3482: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = node.children[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 3483: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = child.type
<span class="linenr"> 3484: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check for dynamic text children</span>
<span class="linenr"> 3485: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hasDynamicTextChild</span> =
<span class=
"linenr"> 3486: </span>          type === NodeTypes.INTERPOLATION ||
<span class=
"linenr"> 3487: </span>          type === NodeTypes.COMPOUND_EXPRESSION
<span class="linenr"> 3488: </span>        <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 3489: </span>          hasDynamicTextChild &amp;&
<span class=
"linenr"> 3490: </span>          getConstantType(child, context) === ConstantTypes.NOT_CONSTANT
<span class="linenr"> 3491: </span>        ) {
<span class=
"linenr"> 3492: </span>          patchFlag |= PatchFlags.TEXT
<span class="linenr"> 3493: </span>        }
<span class="linenr"> 3494: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">pass directly if the only child is a text node</span>
<span class="linenr"> 3495: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">(plain / interpolation / expression)</span>
<span class="linenr"> 3496: </span>        <span class=
"org-keyword">if</span> (hasDynamicTextChild || type === NodeTypes.TEXT) {
<span class="linenr"> 3497: </span>          vnodeChildren = child
<span class="linenr"> 3498: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 3499: </span>          vnodeChildren = node.children
<span class="linenr"> 3500: </span>        }
<span class="linenr"> 3501: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 3502: </span>        vnodeChildren = node.children
<span class="linenr"> 3503: </span>      }
<span class="linenr"> 3504: </span>    }
<span class="linenr"> 3505: </span>
<span class="linenr"> 3506: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">patchFlag & dynamicPropNames</span>
<span class="linenr"> 3507: </span>    <span class=
"org-keyword">if</span> (patchFlag !== <span class=
"org-highlight-numbers-number">0</span>) {
<span class=
"linenr"> 3508: </span>      vnodePatchFlag = String(patchFlag)
<span class="linenr"> 3509: </span>      <span class=
"org-keyword">if</span> (dynamicPropNames &amp;& dynamicPropNames.length) {
<span class=
"linenr"> 3510: </span>        vnodeDynamicProps = stringifyDynamicPropNames(dynamicPropNames)
<span class="linenr"> 3511: </span>      }
<span class="linenr"> 3512: </span>    }
<span class="linenr"> 3513: </span>
<span class=
"linenr"> 3514: </span>    node.codegenNode = createVNodeCall(
<span class="linenr"> 3515: </span>      context,
<span class="linenr"> 3516: </span>      vnodeTag,
<span class="linenr"> 3517: </span>      vnodeProps,
<span class="linenr"> 3518: </span>      vnodeChildren,
<span class="linenr"> 3519: </span>      vnodePatchFlag,
<span class="linenr"> 3520: </span>      vnodeDynamicProps,
<span class="linenr"> 3521: </span>      vnodeDirectives,
<span class="linenr"> 3522: </span>      !!shouldUseBlock,
<span class="linenr"> 3523: </span>      <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">disableTracking</span><span class=
"org-comment-delimiter"> */</span>,
<span class="linenr"> 3524: </span>      isComponent,
<span class="linenr"> 3525: </span>      node.loc
<span class="linenr"> 3526: </span>    )
<span class="linenr"> 3527: </span>  }
<span class="linenr"> 3528: </span>}
<span class="linenr"> 3529: </span>
<span class="linenr"> 3530: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">resolveComponentType</span>(
<span class="linenr"> 3531: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 3532: </span>  <span class=
"org-variable-name">context</span>,
<span class="linenr"> 3533: </span>  ssr = <span class=
"org-constant">false</span>
<span class="linenr"> 3534: </span>) {
<span class="linenr"> 3535: </span>  <span class=
"org-keyword">let</span> { tag } = node
<span class="linenr"> 3536: </span>
<span class="linenr"> 3537: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. dynamic component</span>
<span class="linenr"> 3538: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isExplicitDynamic</span> = isComponentTag(tag)
<span class="linenr"> 3539: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isProp</span> = findProp(node, <span class=
"org-string">'is'</span>)
<span class="linenr"> 3540: </span>  <span class=
"org-keyword">if</span> (isProp) {
<span class="linenr"> 3541: </span>    <span class=
"org-keyword">if</span> (isExplicitDynamic ) {
<span class="linenr"> 3542: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exp</span> =
<span class=
"linenr"> 3543: </span>        isProp.type === NodeTypes.ATTRIBUTE
<span class=
"linenr"> 3544: </span>          ? isProp.value &amp;& createSimpleExpression(isProp.value.content, <span class="org-constant">true</span>)
<span class="linenr"> 3545: </span>          : isProp.exp
<span class="linenr"> 3546: </span>      <span class=
"org-keyword">if</span> (exp) {
<span class="linenr"> 3547: </span>        <span class=
"org-keyword">return</span> createCallExpression(context.helper(RESOLVE_DYNAMIC_COMPONENT), [
<span class="linenr"> 3548: </span>          exp
<span class="linenr"> 3549: </span>        ])
<span class="linenr"> 3550: </span>      }
<span class="linenr"> 3551: </span>    } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr"> 3552: </span>      isProp.type === NodeTypes.ATTRIBUTE &amp;&
<span class=
"linenr"> 3553: </span>      isProp.value.content.startsWith(<span class="org-string">'vue:'</span>)
<span class="linenr"> 3554: </span>    ) {
<span class="linenr"> 3555: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;button is="vue:xxx"&gt;</span>
<span class="linenr"> 3556: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if not &lt;component&gt;, only is value that starts with "vue:" will be</span>
<span class="linenr"> 3557: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">treated as component by the parse phase and reach here, unless it's</span>
<span class="linenr"> 3558: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">compat mode where all is values are considered components</span>
<span class=
"linenr"> 3559: </span>      tag = isProp.value.content.slice(<span class="org-highlight-numbers-number">4</span>)
<span class="linenr"> 3560: </span>    }
<span class="linenr"> 3561: </span>  }
<span class="linenr"> 3562: </span>
<span class="linenr"> 3563: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1.5 v-is (</span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO:</span></span></span><span class=
"org-comment"> Deprecate)</span>
<span class="linenr"> 3564: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDir</span> = !isExplicitDynamic &amp;& findDir(node, <span class="org-string">'is'</span>)
<span class="linenr"> 3565: </span>  <span class=
"org-keyword">if</span> (isDir &amp;& isDir.exp) {
<span class="linenr"> 3566: </span>    <span class=
"org-keyword">return</span> createCallExpression(context.helper(RESOLVE_DYNAMIC_COMPONENT), [
<span class="linenr"> 3567: </span>      isDir.exp
<span class="linenr"> 3568: </span>    ])
<span class="linenr"> 3569: </span>  }
<span class="linenr"> 3570: </span>
<span class="linenr"> 3571: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. built-in components (Teleport, Transition, KeepAlive, Suspense...)</span>
<span class="linenr"> 3572: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">builtIn</span> = isCoreComponent(tag) || context.isBuiltInComponent(tag)
<span class="linenr"> 3573: </span>  <span class=
"org-keyword">if</span> (builtIn) {
<span class="linenr"> 3574: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">built-ins are simply fallthroughs / have special handling during ssr</span>
<span class="linenr"> 3575: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">so we don't need to import their runtime equivalents</span>
<span class="linenr"> 3576: </span>    <span class=
"org-keyword">if</span> (!ssr) context.helper(builtIn)
<span class="linenr"> 3577: </span>    <span class=
"org-keyword">return</span> builtIn
<span class="linenr"> 3578: </span>  }
<span class="linenr"> 3579: </span>
<span class="linenr"> 3580: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">3. user component (from setup bindings)</span>
<span class="linenr"> 3581: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">this is skipped in browser build since browser builds do not perform</span>
<span class="linenr"> 3582: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">binding analysis.</span>
<span class="linenr"> 3583: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__) {
<span class="linenr"> 3584: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">fromSetup</span> = resolveSetupReference(tag, context)
<span class="linenr"> 3585: </span>    <span class=
"org-keyword">if</span> (fromSetup) {
<span class="linenr"> 3586: </span>      <span class=
"org-keyword">return</span> fromSetup
<span class="linenr"> 3587: </span>    }
<span class="linenr"> 3588: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">dotIndex</span> = tag.indexOf(<span class=
"org-string">'.'</span>)
<span class="linenr"> 3589: </span>    <span class=
"org-keyword">if</span> (dotIndex &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 3590: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ns</span> = resolveSetupReference(tag.slice(<span class="org-highlight-numbers-number">0</span>, dotIndex), context)
<span class="linenr"> 3591: </span>      <span class=
"org-keyword">if</span> (ns) {
<span class="linenr"> 3592: </span>        <span class=
"org-keyword">return</span> ns + tag.slice(dotIndex)
<span class="linenr"> 3593: </span>      }
<span class="linenr"> 3594: </span>    }
<span class="linenr"> 3595: </span>  }
<span class="linenr"> 3596: </span>
<span class="linenr"> 3597: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">4. Self referencing component (inferred from filename)</span>
<span class="linenr"> 3598: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 3599: </span>    !__BROWSER__ &amp;&
<span class="linenr"> 3600: </span>    context.selfName &amp;&
<span class=
"linenr"> 3601: </span>    capitalize(camelize(tag)) === context.selfName
<span class="linenr"> 3602: </span>  ) {
<span class=
"linenr"> 3603: </span>    context.helper(RESOLVE_COMPONENT)
<span class="linenr"> 3604: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">codegen.ts has special check for __self postfix when generating</span>
<span class="linenr"> 3605: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">component imports, which will pass additional `maybeSelfReference` flag</span>
<span class="linenr"> 3606: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">to `resolveComponent`.</span>
<span class=
"linenr"> 3607: </span>    context.components.add(tag + <span class="org-string">`__self`</span>)
<span class="linenr"> 3608: </span>    <span class=
"org-keyword">return</span> toValidAssetId(tag, <span class=
"org-string">`component`</span>)
<span class="linenr"> 3609: </span>  }
<span class="linenr"> 3610: </span>
<span class="linenr"> 3611: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">5. user component (resolve)</span>
<span class=
"linenr"> 3612: </span>  context.helper(RESOLVE_COMPONENT)
<span class="linenr"> 3613: </span>  context.components.add(tag)
<span class="linenr"> 3614: </span>  <span class=
"org-keyword">return</span> toValidAssetId(tag, <span class=
"org-string">`component`</span>)
<span class="linenr"> 3615: </span>}
<span class="linenr"> 3616: </span>
<span class="linenr"> 3617: </span>
<span class="linenr"> 3618: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">resolveSetupReference</span>(<span class=
"org-variable-name">name</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 3619: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bindings</span> = context.bindingMetadata
<span class="linenr"> 3620: </span>  <span class=
"org-keyword">if</span> (!bindings || bindings.__isScriptSetup === <span class="org-constant">false</span>) {
<span class="linenr"> 3621: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 3622: </span>  }
<span class="linenr"> 3623: </span>
<span class="linenr"> 3624: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">camelName</span> = camelize(name)
<span class="linenr"> 3625: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">PascalName</span> = capitalize(camelName)
<span class="linenr"> 3626: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">checkType</span> = (type) =&gt; {
<span class="linenr"> 3627: </span>    <span class=
"org-keyword">if</span> (bindings[name] === type) {
<span class="linenr"> 3628: </span>      <span class=
"org-keyword">return</span> name
<span class="linenr"> 3629: </span>    }
<span class="linenr"> 3630: </span>    <span class=
"org-keyword">if</span> (bindings[camelName] === type) {
<span class="linenr"> 3631: </span>      <span class=
"org-keyword">return</span> camelName
<span class="linenr"> 3632: </span>    }
<span class="linenr"> 3633: </span>    <span class=
"org-keyword">if</span> (bindings[PascalName] === type) {
<span class="linenr"> 3634: </span>      <span class=
"org-keyword">return</span> PascalName
<span class="linenr"> 3635: </span>    }
<span class="linenr"> 3636: </span>  }
<span class="linenr"> 3637: </span>
<span class="linenr"> 3638: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">fromConst</span> = checkType(BindingTypes.SETUP_CONST)
<span class="linenr"> 3639: </span>  <span class=
"org-keyword">if</span> (fromConst) {
<span class="linenr"> 3640: </span>    <span class=
"org-keyword">return</span> context.inline
<span class="linenr"> 3641: </span>      ? <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in inline mode, const setup bindings (e.g. imports) can be used as-is</span>
<span class="linenr"> 3642: </span>        fromConst
<span class="linenr"> 3643: </span>      : <span class=
"org-string">`$setup[${JSON.stringify(fromConst)}]`</span>
<span class="linenr"> 3644: </span>  }
<span class="linenr"> 3645: </span>
<span class="linenr"> 3646: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">fromMaybeRef</span> =
<span class=
"linenr"> 3647: </span>    checkType(BindingTypes.SETUP_LET) ||
<span class=
"linenr"> 3648: </span>    checkType(BindingTypes.SETUP_REF) ||
<span class=
"linenr"> 3649: </span>    checkType(BindingTypes.SETUP_MAYBE_REF)
<span class="linenr"> 3650: </span>  <span class=
"org-keyword">if</span> (fromMaybeRef) {
<span class="linenr"> 3651: </span>    <span class=
"org-keyword">return</span> context.inline
<span class="linenr"> 3652: </span>      ? <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">setup scope bindings that may be refs need to be unrefed</span>
<span class="linenr"> 3653: </span>        <span class=
"org-string">`${context.helperString(UNREF)}(${fromMaybeRef})`</span>
<span class="linenr"> 3654: </span>      : <span class=
"org-string">`$setup[${JSON.stringify(fromMaybeRef)}]`</span>
<span class="linenr"> 3655: </span>  }
<span class="linenr"> 3656: </span>}
<span class="linenr"> 3657: </span>
<span class="linenr"> 3658: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">buildProps</span>(
<span class="linenr"> 3659: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 3660: </span>  <span class=
"org-variable-name">context</span>,
<span class="linenr"> 3661: </span>  props = node.props,
<span class="linenr"> 3662: </span>  ssr = <span class=
"org-constant">false</span>
<span class="linenr"> 3663: </span>) {
<span class="linenr"> 3664: </span>  <span class=
"org-keyword">const</span> { tag, loc: elementLoc, children } = node
<span class="linenr"> 3665: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isComponent</span> = node.tagType === ElementTypes.COMPONENT
<span class="linenr"> 3666: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">properties</span> = []
<span class="linenr"> 3667: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">mergeArgs</span> = []
<span class="linenr"> 3668: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">runtimeDirectives</span> = []
<span class="linenr"> 3669: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hasChildren</span> = children.length &gt; <span class="org-highlight-numbers-number">0</span>
<span class="linenr"> 3670: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">shouldUseBlock</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3671: </span>
<span class="linenr"> 3672: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">patchFlag analysis</span>
<span class="linenr"> 3673: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">patchFlag</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 3674: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasRef</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3675: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasClassBinding</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3676: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasStyleBinding</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3677: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasHydrationEventBinding</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3678: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasDynamicKeys</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3679: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasVnodeHook</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3680: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">dynamicPropNames</span> = []
<span class="linenr"> 3681: </span>
<span class="linenr"> 3682: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">analyzePatchFlag</span> = ({ key, value }) =&gt; {
<span class="linenr"> 3683: </span>    <span class=
"org-keyword">if</span> (isStaticExp(key)) {
<span class="linenr"> 3684: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">name</span> = key.content
<span class="linenr"> 3685: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isEventHandler</span> = isOn(name)
<span class="linenr"> 3686: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 3687: </span>        !isComponent &amp;&
<span class="linenr"> 3688: </span>        isEventHandler &amp;&
<span class="linenr"> 3689: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">omit the flag for click handlers because hydration gives click</span>
<span class="linenr"> 3690: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">dedicated fast path.</span>
<span class=
"linenr"> 3691: </span>        name.toLowerCase() !== <span class=
"org-string">'onclick'</span> &amp;&
<span class="linenr"> 3692: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">omit v-model handlers</span>
<span class="linenr"> 3693: </span>        name !== <span class=
"org-string">'onUpdate:modelValue'</span> &amp;&
<span class="linenr"> 3694: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">omit onVnodeXXX hooks</span>
<span class="linenr"> 3695: </span>        !isReservedProp(name)
<span class="linenr"> 3696: </span>      ) {
<span class=
"linenr"> 3697: </span>        hasHydrationEventBinding = <span class="org-constant">true</span>
<span class="linenr"> 3698: </span>      }
<span class="linenr"> 3699: </span>
<span class="linenr"> 3700: </span>      <span class=
"org-keyword">if</span> (isEventHandler &amp;& isReservedProp(name)) {
<span class=
"linenr"> 3701: </span>        hasVnodeHook = <span class=
"org-constant">true</span>
<span class="linenr"> 3702: </span>      }
<span class="linenr"> 3703: </span>
<span class="linenr"> 3704: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 3705: </span>        value.type === NodeTypes.JS_CACHE_EXPRESSION ||
<span class=
"linenr"> 3706: </span>        ((value.type === NodeTypes.SIMPLE_EXPRESSION ||
<span class=
"linenr"> 3707: </span>          value.type === NodeTypes.COMPOUND_EXPRESSION) &amp;&
<span class=
"linenr"> 3708: </span>          getConstantType(value, context) &gt; <span class="org-highlight-numbers-number">0</span>)
<span class="linenr"> 3709: </span>      ) {
<span class="linenr"> 3710: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip if the prop is a cached handler or has constant value</span>
<span class="linenr"> 3711: </span>        <span class=
"org-keyword">return</span>
<span class="linenr"> 3712: </span>      }
<span class="linenr"> 3713: </span>
<span class="linenr"> 3714: </span>      <span class=
"org-keyword">if</span> (name === <span class=
"org-string">'ref'</span>) {
<span class="linenr"> 3715: </span>        hasRef = <span class=
"org-constant">true</span>
<span class="linenr"> 3716: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (name === <span class=
"org-string">'class'</span>) {
<span class=
"linenr"> 3717: </span>        hasClassBinding = <span class=
"org-constant">true</span>
<span class="linenr"> 3718: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (name === <span class=
"org-string">'style'</span>) {
<span class=
"linenr"> 3719: </span>        hasStyleBinding = <span class=
"org-constant">true</span>
<span class="linenr"> 3720: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (name !== <span class=
"org-string">'key'</span> &amp;& !dynamicPropNames.includes(name)) {
<span class=
"linenr"> 3721: </span>        dynamicPropNames.push(name)
<span class="linenr"> 3722: </span>      }
<span class="linenr"> 3723: </span>
<span class="linenr"> 3724: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">treat the dynamic class and style binding of the component as dynamic props</span>
<span class="linenr"> 3725: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 3726: </span>        isComponent &amp;&
<span class="linenr"> 3727: </span>        (name === <span class=
"org-string">'class'</span> || name === <span class=
"org-string">'style'</span>) &amp;&
<span class=
"linenr"> 3728: </span>        !dynamicPropNames.includes(name)
<span class="linenr"> 3729: </span>      ) {
<span class=
"linenr"> 3730: </span>        dynamicPropNames.push(name)
<span class="linenr"> 3731: </span>      }
<span class="linenr"> 3732: </span>    } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 3733: </span>      hasDynamicKeys = <span class=
"org-constant">true</span>
<span class="linenr"> 3734: </span>    }
<span class="linenr"> 3735: </span>  }
<span class="linenr"> 3736: </span>
<span class="linenr"> 3737: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; props.length; i++) {
<span class="linenr"> 3738: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">static attribute</span>
<span class="linenr"> 3739: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prop</span> = props[i]
<span class="linenr"> 3740: </span>    <span class=
"org-keyword">if</span> (prop.type === NodeTypes.ATTRIBUTE) {
<span class="linenr"> 3741: </span>      <span class=
"org-keyword">const</span> { loc, name, value } = prop
<span class="linenr"> 3742: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">isStatic</span> = <span class=
"org-constant">true</span>
<span class="linenr"> 3743: </span>      <span class=
"org-keyword">if</span> (name === <span class=
"org-string">'ref'</span>) {
<span class="linenr"> 3744: </span>        hasRef = <span class=
"org-constant">true</span>
<span class="linenr"> 3745: </span>        <span class=
"org-keyword">if</span> (context.scopes.vFor &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 3746: </span>          properties.push(
<span class=
"linenr"> 3747: </span>            createObjectProperty(
<span class=
"linenr"> 3748: </span>              createSimpleExpression(<span class="org-string">'ref_for'</span>, <span class="org-constant">true</span>),
<span class=
"linenr"> 3749: </span>              createSimpleExpression(<span class="org-string">'true'</span>)
<span class="linenr"> 3750: </span>            )
<span class="linenr"> 3751: </span>          )
<span class="linenr"> 3752: </span>        }
<span class="linenr"> 3753: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in inline mode there is no setupState object, so we can't use string</span>
<span class="linenr"> 3754: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">keys to set the ref. Instead, we need to transform it to pass the</span>
<span class="linenr"> 3755: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">actual ref instead.</span>
<span class="linenr"> 3756: </span>        <span class=
"org-keyword">if</span> (
<span class="linenr"> 3757: </span>          !__BROWSER__ &amp;&
<span class="linenr"> 3758: </span>          value &amp;&
<span class="linenr"> 3759: </span>          context.inline &amp;&
<span class=
"linenr"> 3760: </span>          context.bindingMetadata[value.content]
<span class="linenr"> 3761: </span>        ) {
<span class=
"linenr"> 3762: </span>          isStatic = <span class="org-constant">false</span>
<span class="linenr"> 3763: </span>          properties.push(
<span class=
"linenr"> 3764: </span>            createObjectProperty(
<span class=
"linenr"> 3765: </span>              createSimpleExpression(<span class="org-string">'ref_key'</span>, <span class="org-constant">true</span>),
<span class=
"linenr"> 3766: </span>              createSimpleExpression(value.content, <span class="org-constant">true</span>, value.loc)
<span class="linenr"> 3767: </span>            )
<span class="linenr"> 3768: </span>          )
<span class="linenr"> 3769: </span>        }
<span class="linenr"> 3770: </span>      }
<span class="linenr"> 3771: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip is on &lt;component&gt;, or is="vue:xxx"</span>
<span class="linenr"> 3772: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 3773: </span>        name === <span class=
"org-string">'is'</span> &amp;&
<span class="linenr"> 3774: </span>        (isComponentTag(tag) ||
<span class=
"linenr"> 3775: </span>          (value &amp;& value.content.startsWith(<span class="org-string">'vue:'</span>)))
<span class="linenr"> 3776: </span>      ) {
<span class="linenr"> 3777: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 3778: </span>      }
<span class="linenr"> 3779: </span>      properties.push(
<span class="linenr"> 3780: </span>        createObjectProperty(
<span class=
"linenr"> 3781: </span>          createSimpleExpression(
<span class="linenr"> 3782: </span>            name,
<span class="linenr"> 3783: </span>            <span class=
"org-constant">true</span>,
<span class=
"linenr"> 3784: </span>            getInnerRange(loc, <span class=
"org-highlight-numbers-number">0</span>, name.length)
<span class="linenr"> 3785: </span>          ),
<span class=
"linenr"> 3786: </span>          createSimpleExpression(
<span class=
"linenr"> 3787: </span>            value ? value.content : <span class="org-string">''</span>,
<span class="linenr"> 3788: </span>            isStatic,
<span class=
"linenr"> 3789: </span>            value ? value.loc : loc
<span class="linenr"> 3790: </span>          )
<span class="linenr"> 3791: </span>        )
<span class="linenr"> 3792: </span>      )
<span class="linenr"> 3793: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 3794: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">directives</span>
<span class="linenr"> 3795: </span>      <span class=
"org-keyword">const</span> { name, arg, exp, loc } = prop
<span class="linenr"> 3796: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isVBind</span> = name === <span class=
"org-string">'bind'</span>
<span class="linenr"> 3797: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isVOn</span> = name === <span class=
"org-string">'on'</span>
<span class="linenr"> 3798: </span>
<span class="linenr"> 3799: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip v-slot - it is handled by its dedicated transform.</span>
<span class="linenr"> 3800: </span>      <span class=
"org-keyword">if</span> (name === <span class=
"org-string">'slot'</span>) {
<span class="linenr"> 3801: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 3802: </span>      }
<span class="linenr"> 3803: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip v-once/v-memo - they are handled by dedicated transforms.</span>
<span class="linenr"> 3804: </span>      <span class=
"org-keyword">if</span> (name === <span class=
"org-string">'once'</span> || name === <span class=
"org-string">'memo'</span>) {
<span class="linenr"> 3805: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 3806: </span>      }
<span class="linenr"> 3807: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip v-is and :is on &lt;component&gt;</span>
<span class="linenr"> 3808: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 3809: </span>        name === <span class=
"org-string">'is'</span> ||
<span class="linenr"> 3810: </span>        (isVBind &amp;&
<span class=
"linenr"> 3811: </span>          isStaticArgOf(arg, <span class=
"org-string">'is'</span>) &amp;&
<span class="linenr"> 3812: </span>          isComponentTag(tag))
<span class="linenr"> 3813: </span>      ) {
<span class="linenr"> 3814: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 3815: </span>      }
<span class="linenr"> 3816: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip v-on in SSR compilation</span>
<span class="linenr"> 3817: </span>      <span class=
"org-keyword">if</span> (isVOn &amp;& ssr) {
<span class="linenr"> 3818: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 3819: </span>      }
<span class="linenr"> 3820: </span>
<span class="linenr"> 3821: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 3822: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#938: elements with dynamic keys should be forced into blocks</span>
<span class=
"linenr"> 3823: </span>        (isVBind &amp;& isStaticArgOf(arg, <span class="org-string">'key'</span>)) ||
<span class="linenr"> 3824: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inline before-update hooks need to force block so that it is invoked</span>
<span class="linenr"> 3825: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">before children</span>
<span class=
"linenr"> 3826: </span>        (isVOn &amp;& hasChildren &amp;& isStaticArgOf(arg, <span class="org-string">'vue:before-update'</span>))
<span class="linenr"> 3827: </span>      ) {
<span class=
"linenr"> 3828: </span>        shouldUseBlock = <span class=
"org-constant">true</span>
<span class="linenr"> 3829: </span>      }
<span class="linenr"> 3830: </span>
<span class="linenr"> 3831: </span>      <span class=
"org-keyword">if</span> (isVBind &amp;& isStaticArgOf(arg, <span class="org-string">'ref'</span>) &amp;& context.scopes.vFor &gt; <span class="org-highlight-numbers-number">0</span>) {
<span class="linenr"> 3832: </span>        properties.push(
<span class="linenr"> 3833: </span>          createObjectProperty(
<span class=
"linenr"> 3834: </span>            createSimpleExpression(<span class="org-string">'ref_for'</span>, <span class="org-constant">true</span>),
<span class=
"linenr"> 3835: </span>            createSimpleExpression(<span class="org-string">'true'</span>)
<span class="linenr"> 3836: </span>          )
<span class="linenr"> 3837: </span>        )
<span class="linenr"> 3838: </span>      }
<span class="linenr"> 3839: </span>
<span class="linenr"> 3840: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">special case for v-bind and v-on with no argument</span>
<span class="linenr"> 3841: </span>      <span class=
"org-keyword">if</span> (!arg &amp;& (isVBind || isVOn)) {
<span class=
"linenr"> 3842: </span>        hasDynamicKeys = <span class=
"org-constant">true</span>
<span class="linenr"> 3843: </span>        <span class=
"org-keyword">if</span> (exp) {
<span class="linenr"> 3844: </span>          <span class=
"org-keyword">if</span> (properties.length) {
<span class="linenr"> 3845: </span>            mergeArgs.push(
<span class=
"linenr"> 3846: </span>              createObjectExpression(dedupeProperties(properties), elementLoc)
<span class="linenr"> 3847: </span>            )
<span class="linenr"> 3848: </span>            properties = []
<span class="linenr"> 3849: </span>          }
<span class="linenr"> 3850: </span>          <span class=
"org-keyword">if</span> (isVBind) {
<span class="linenr"> 3851: </span>            mergeArgs.push(exp)
<span class="linenr"> 3852: </span>          } <span class=
"org-keyword">else</span> {
<span class="linenr"> 3853: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-on="obj" -&gt; toHandlers(obj)</span>
<span class="linenr"> 3854: </span>            mergeArgs.push({
<span class=
"linenr"> 3855: </span>              type: NodeTypes.JS_CALL_EXPRESSION,
<span class="linenr"> 3856: </span>              loc,
<span class=
"linenr"> 3857: </span>              callee: context.helper(TO_HANDLERS),
<span class="linenr"> 3858: </span>              <span class=
"org-constant">arguments</span>: [exp]
<span class="linenr"> 3859: </span>            })
<span class="linenr"> 3860: </span>          }
<span class="linenr"> 3861: </span>        }
<span class="linenr"> 3862: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 3863: </span>      }
<span class="linenr"> 3864: </span>
<span class="linenr"> 3865: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">directiveTransform</span> = context.directiveTransforms[name]
<span class="linenr"> 3866: </span>      <span class=
"org-keyword">if</span> (directiveTransform) {
<span class="linenr"> 3867: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">has built-in directive transform.</span>
<span class="linenr"> 3868: </span>        <span class=
"org-keyword">const</span> { props, needRuntime } = directiveTransform(prop, node, context)
<span class=
"linenr"> 3869: </span>        !ssr &amp;& props.forEach(analyzePatchFlag)
<span class=
"linenr"> 3870: </span>        properties.push(...props)
<span class="linenr"> 3871: </span>        <span class=
"org-keyword">if</span> (needRuntime) {
<span class=
"linenr"> 3872: </span>          runtimeDirectives.push(prop)
<span class="linenr"> 3873: </span>          <span class=
"org-keyword">if</span> (isSymbol(needRuntime)) {
<span class=
"linenr"> 3874: </span>            directiveImportMap.set(prop, needRuntime)
<span class="linenr"> 3875: </span>          }
<span class="linenr"> 3876: </span>        }
<span class="linenr"> 3877: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (!isBuiltInDirective(name)) {
<span class="linenr"> 3878: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no built-in transform, this is a user custom directive.</span>
<span class=
"linenr"> 3879: </span>        runtimeDirectives.push(prop)
<span class="linenr"> 3880: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">custom dirs may use beforeUpdate so they need to force blocks</span>
<span class="linenr"> 3881: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">to ensure before-update gets called before children update</span>
<span class="linenr"> 3882: </span>        <span class=
"org-keyword">if</span> (hasChildren) {
<span class=
"linenr"> 3883: </span>          shouldUseBlock = <span class=
"org-constant">true</span>
<span class="linenr"> 3884: </span>        }
<span class="linenr"> 3885: </span>      }
<span class="linenr"> 3886: </span>    }
<span class="linenr"> 3887: </span>  }
<span class="linenr"> 3888: </span>
<span class="linenr"> 3889: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsExpression</span> = <span class=
"org-constant">undefined</span>
<span class="linenr"> 3890: </span>
<span class="linenr"> 3891: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">has v-bind="object" or v-on="object", wrap with mergeProps</span>
<span class="linenr"> 3892: </span>  <span class=
"org-keyword">if</span> (mergeArgs.length) {
<span class="linenr"> 3893: </span>    <span class=
"org-keyword">if</span> (properties.length) {
<span class="linenr"> 3894: </span>      mergeArgs.push(
<span class=
"linenr"> 3895: </span>        createObjectExpression(dedupeProperties(properties), elementLoc)
<span class="linenr"> 3896: </span>      )
<span class="linenr"> 3897: </span>    }
<span class="linenr"> 3898: </span>    <span class=
"org-keyword">if</span> (mergeArgs.length &gt; <span class=
"org-highlight-numbers-number">1</span>) {
<span class=
"linenr"> 3899: </span>      propsExpression = createCallExpression(
<span class=
"linenr"> 3900: </span>        context.helper(MERGE_PROPS),
<span class="linenr"> 3901: </span>        mergeArgs,
<span class="linenr"> 3902: </span>        elementLoc
<span class="linenr"> 3903: </span>      )
<span class="linenr"> 3904: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 3905: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">single v-bind with nothing else - no need for a mergeProps call</span>
<span class=
"linenr"> 3906: </span>      propsExpression = mergeArgs[<span class="org-highlight-numbers-number">0</span>]
<span class="linenr"> 3907: </span>    }
<span class="linenr"> 3908: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (properties.length) {
<span class=
"linenr"> 3909: </span>    propsExpression = createObjectExpression(
<span class=
"linenr"> 3910: </span>      dedupeProperties(properties),
<span class="linenr"> 3911: </span>      elementLoc
<span class="linenr"> 3912: </span>    )
<span class="linenr"> 3913: </span>  }
<span class="linenr"> 3914: </span>
<span class="linenr"> 3915: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">patchFlag analysis</span>
<span class="linenr"> 3916: </span>  <span class=
"org-keyword">if</span> (hasDynamicKeys) {
<span class=
"linenr"> 3917: </span>    patchFlag |= PatchFlags.FULL_PROPS
<span class="linenr"> 3918: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 3919: </span>    <span class=
"org-keyword">if</span> (hasClassBinding &amp;& !isComponent) {
<span class=
"linenr"> 3920: </span>      patchFlag |= PatchFlags.CLASS
<span class="linenr"> 3921: </span>    }
<span class="linenr"> 3922: </span>    <span class=
"org-keyword">if</span> (hasStyleBinding &amp;& !isComponent) {
<span class=
"linenr"> 3923: </span>      patchFlag |= PatchFlags.STYLE
<span class="linenr"> 3924: </span>    }
<span class="linenr"> 3925: </span>    <span class=
"org-keyword">if</span> (dynamicPropNames.length) {
<span class=
"linenr"> 3926: </span>      patchFlag |= PatchFlags.PROPS
<span class="linenr"> 3927: </span>    }
<span class="linenr"> 3928: </span>    <span class=
"org-keyword">if</span> (hasHydrationEventBinding) {
<span class=
"linenr"> 3929: </span>      patchFlag |= PatchFlags.HYDRATE_EVENTS
<span class="linenr"> 3930: </span>    }
<span class="linenr"> 3931: </span>  }
<span class="linenr"> 3932: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 3933: </span>    !shouldUseBlock &amp;&
<span class="linenr"> 3934: </span>    (patchFlag === <span class=
"org-highlight-numbers-number">0</span> || patchFlag === PatchFlags.HYDRATE_EVENTS) &amp;&
<span class=
"linenr"> 3935: </span>    (hasRef || hasVnodeHook || runtimeDirectives.length &gt; <span class="org-highlight-numbers-number">0</span>)
<span class="linenr"> 3936: </span>  ) {
<span class=
"linenr"> 3937: </span>    patchFlag |= PatchFlags.NEED_PATCH
<span class="linenr"> 3938: </span>  }
<span class="linenr"> 3939: </span>
<span class="linenr"> 3940: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">pre-normalize props, SSR is skipped for now</span>
<span class="linenr"> 3941: </span>  <span class=
"org-keyword">if</span> (!context.inSSR &amp;& propsExpression) {
<span class="linenr"> 3942: </span>    <span class=
"org-keyword">switch</span> (propsExpression.type) {
<span class="linenr"> 3943: </span>      <span class=
"org-keyword">case</span> NodeTypes.JS_OBJECT_EXPRESSION:
<span class="linenr"> 3944: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">means that there is no v-bind,</span>
<span class="linenr"> 3945: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">but still need to deal with dynamic key binding</span>
<span class="linenr"> 3946: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">classKeyIndex</span> = -<span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 3947: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">styleKeyIndex</span> = -<span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 3948: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasDynamicKey</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 3949: </span>
<span class="linenr"> 3950: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; propsExpression.properties.length; i++) {
<span class="linenr"> 3951: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> = propsExpression.properties[i].key
<span class="linenr"> 3952: </span>          <span class=
"org-keyword">if</span> (isStaticExp(key)) {
<span class="linenr"> 3953: </span>            <span class=
"org-keyword">if</span> (key.content === <span class=
"org-string">'class'</span>) {
<span class="linenr"> 3954: </span>              classKeyIndex = i
<span class="linenr"> 3955: </span>            } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (key.content === <span class=
"org-string">'style'</span>) {
<span class="linenr"> 3956: </span>              styleKeyIndex = i
<span class="linenr"> 3957: </span>            }
<span class="linenr"> 3958: </span>          } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (!key.isHandlerKey) {
<span class=
"linenr"> 3959: </span>            hasDynamicKey = <span class=
"org-constant">true</span>
<span class="linenr"> 3960: </span>          }
<span class="linenr"> 3961: </span>        }
<span class="linenr"> 3962: </span>
<span class="linenr"> 3963: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">classProp</span> = propsExpression.properties[classKeyIndex]
<span class="linenr"> 3964: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">styleProp</span> = propsExpression.properties[styleKeyIndex]
<span class="linenr"> 3965: </span>
<span class="linenr"> 3966: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no dynamic key</span>
<span class="linenr"> 3967: </span>        <span class=
"org-keyword">if</span> (!hasDynamicKey) {
<span class="linenr"> 3968: </span>          <span class=
"org-keyword">if</span> (classProp &amp;& !isStaticExp(classProp.value)) {
<span class=
"linenr"> 3969: </span>            classProp.value = createCallExpression(
<span class=
"linenr"> 3970: </span>              context.helper(NORMALIZE_CLASS),
<span class="linenr"> 3971: </span>              [classProp.value]
<span class="linenr"> 3972: </span>            )
<span class="linenr"> 3973: </span>          }
<span class="linenr"> 3974: </span>          <span class=
"org-keyword">if</span> (
<span class="linenr"> 3975: </span>            styleProp &amp;&
<span class=
"linenr"> 3976: </span>            !isStaticExp(styleProp.value) &amp;&
<span class="linenr"> 3977: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the static style is compiled into an object,</span>
<span class="linenr"> 3978: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">so use `hasStyleBinding` to ensure that it is a dynamic style binding</span>
<span class="linenr"> 3979: </span>            (hasStyleBinding ||
<span class="linenr"> 3980: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-bind:style and style both exist,</span>
<span class="linenr"> 3981: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-bind:style with static literal object</span>
<span class=
"linenr"> 3982: </span>              styleProp.value.type === NodeTypes.JS_ARRAY_EXPRESSION)
<span class="linenr"> 3983: </span>          ) {
<span class=
"linenr"> 3984: </span>            styleProp.value = createCallExpression(
<span class=
"linenr"> 3985: </span>              context.helper(NORMALIZE_STYLE),
<span class="linenr"> 3986: </span>              [styleProp.value]
<span class="linenr"> 3987: </span>            )
<span class="linenr"> 3988: </span>          }
<span class="linenr"> 3989: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr"> 3990: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">dynamic key binding, wrap with `normalizeProps`</span>
<span class=
"linenr"> 3991: </span>          propsExpression = createCallExpression(
<span class=
"linenr"> 3992: </span>            context.helper(NORMALIZE_PROPS),
<span class="linenr"> 3993: </span>            [propsExpression]
<span class="linenr"> 3994: </span>          )
<span class="linenr"> 3995: </span>        }
<span class="linenr"> 3996: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 3997: </span>      <span class=
"org-keyword">case</span> NodeTypes.JS_CALL_EXPRESSION:
<span class="linenr"> 3998: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">mergeProps call, do nothing</span>
<span class="linenr"> 3999: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 4000: </span>      <span class=
"org-keyword">default</span>:
<span class="linenr"> 4001: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">single v-bind</span>
<span class=
"linenr"> 4002: </span>        propsExpression = createCallExpression(
<span class=
"linenr"> 4003: </span>          context.helper(NORMALIZE_PROPS),
<span class="linenr"> 4004: </span>          [
<span class=
"linenr"> 4005: </span>            createCallExpression(context.helper(GUARD_REACTIVE_PROPS), [
<span class="linenr"> 4006: </span>              propsExpression
<span class="linenr"> 4007: </span>            ])
<span class="linenr"> 4008: </span>          ]
<span class="linenr"> 4009: </span>        )
<span class="linenr"> 4010: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 4011: </span>    }
<span class="linenr"> 4012: </span>  }
<span class="linenr"> 4013: </span>
<span class="linenr"> 4014: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 4015: </span>    props: propsExpression,
<span class=
"linenr"> 4016: </span>    directives: runtimeDirectives,
<span class="linenr"> 4017: </span>    patchFlag,
<span class="linenr"> 4018: </span>    dynamicPropNames,
<span class="linenr"> 4019: </span>    shouldUseBlock
<span class="linenr"> 4020: </span>  }
<span class="linenr"> 4021: </span>}
<span class="linenr"> 4022: </span>
<span class="linenr"> 4023: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Dedupe props in an object literal.</span>
<span class="linenr"> 4024: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Literal duplicated attributes would have been warned during the parse phase,</span>
<span class="linenr"> 4025: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">however, it's possible to encounter duplicated `onXXX` handlers with different</span>
<span class="linenr"> 4026: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">modifiers. We also need to merge static and dynamic class / style attributes.</span>
<span class="linenr"> 4027: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">- onXXX handlers / style: merge into array</span>
<span class="linenr"> 4028: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">- class: merge into single expression with concatenation</span>
<span class="linenr"> 4029: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">dedupeProperties</span>(<span class=
"org-variable-name">properties</span>) {
<span class="linenr"> 4030: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">knownProps</span> = <span class=
"org-keyword">new</span> <span class="org-type">Map</span>()
<span class="linenr"> 4031: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">deduped</span> = []
<span class="linenr"> 4032: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; properties.length; i++) {
<span class="linenr"> 4033: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prop</span> = properties[i]
<span class="linenr"> 4034: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">dynamic keys are always allowed</span>
<span class="linenr"> 4035: </span>    <span class=
"org-keyword">if</span> (prop.key.type === NodeTypes.COMPOUND_EXPRESSION || !prop.key.isStatic) {
<span class="linenr"> 4036: </span>      deduped.push(prop)
<span class="linenr"> 4037: </span>      <span class=
"org-keyword">continue</span>
<span class="linenr"> 4038: </span>    }
<span class="linenr"> 4039: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">name</span> = prop.key.content
<span class="linenr"> 4040: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">existing</span> = knownProps.get(name)
<span class="linenr"> 4041: </span>    <span class=
"org-keyword">if</span> (existing) {
<span class="linenr"> 4042: </span>      <span class=
"org-keyword">if</span> (name === <span class=
"org-string">'style'</span> || name === <span class=
"org-string">'class'</span> || isOn(name)) {
<span class=
"linenr"> 4043: </span>        mergeAsArray(existing, prop)
<span class="linenr"> 4044: </span>      }
<span class="linenr"> 4045: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">unexpected duplicate, should have emitted error during parse</span>
<span class="linenr"> 4046: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4047: </span>      knownProps.set(name, prop)
<span class="linenr"> 4048: </span>      deduped.push(prop)
<span class="linenr"> 4049: </span>    }
<span class="linenr"> 4050: </span>  }
<span class="linenr"> 4051: </span>  <span class=
"org-keyword">return</span> deduped
<span class="linenr"> 4052: </span>}
<span class="linenr"> 4053: </span>
<span class="linenr"> 4054: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">mergeAsArray</span>(<span class=
"org-variable-name">existing</span>, <span class=
"org-variable-name">incoming</span>) {
<span class="linenr"> 4055: </span>  <span class=
"org-keyword">if</span> (existing.value.type === NodeTypes.JS_ARRAY_EXPRESSION) {
<span class=
"linenr"> 4056: </span>    existing.value.elements.push(incoming.value)
<span class="linenr"> 4057: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4058: </span>    existing.value = createArrayExpression(
<span class=
"linenr"> 4059: </span>      [existing.value, incoming.value],
<span class="linenr"> 4060: </span>      existing.loc
<span class="linenr"> 4061: </span>    )
<span class="linenr"> 4062: </span>  }
<span class="linenr"> 4063: </span>}
<span class="linenr"> 4064: </span>
<span class="linenr"> 4065: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">buildDirectiveArgs</span>(
<span class="linenr"> 4066: </span>  <span class=
"org-variable-name">dir</span>,
<span class="linenr"> 4067: </span>  context
<span class="linenr"> 4068: </span>) {
<span class="linenr"> 4069: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">dirArgs</span> = []
<span class="linenr"> 4070: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">runtime</span> = directiveImportMap.get(dir)
<span class="linenr"> 4071: </span>  <span class=
"org-keyword">if</span> (runtime) {
<span class="linenr"> 4072: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">built-in directive with runtime</span>
<span class=
"linenr"> 4073: </span>    dirArgs.push(context.helperString(runtime))
<span class="linenr"> 4074: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4075: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">user directive.</span>
<span class="linenr"> 4076: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">see if we have directives exposed via &lt;script setup&gt;</span>
<span class="linenr"> 4077: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">fromSetup</span> =
<span class=
"linenr"> 4078: </span>      !__BROWSER__ &amp;& resolveSetupReference(<span class="org-string">'v-'</span> + dir.name, context)
<span class="linenr"> 4079: </span>    <span class=
"org-keyword">if</span> (fromSetup) {
<span class="linenr"> 4080: </span>      dirArgs.push(fromSetup)
<span class="linenr"> 4081: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4082: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject statement for resolving directive</span>
<span class=
"linenr"> 4083: </span>      context.helper(RESOLVE_DIRECTIVE)
<span class=
"linenr"> 4084: </span>      context.directives.add(dir.name)
<span class=
"linenr"> 4085: </span>      dirArgs.push(toValidAssetId(dir.name, <span class="org-string">`directive`</span>))
<span class="linenr"> 4086: </span>    }
<span class="linenr"> 4087: </span>  }
<span class="linenr"> 4088: </span>  <span class=
"org-keyword">const</span> { loc } = dir
<span class="linenr"> 4089: </span>  <span class=
"org-keyword">if</span> (dir.exp) dirArgs.push(dir.exp)
<span class="linenr"> 4090: </span>  <span class=
"org-keyword">if</span> (dir.arg) {
<span class="linenr"> 4091: </span>    <span class=
"org-keyword">if</span> (!dir.exp) {
<span class="linenr"> 4092: </span>      dirArgs.push(<span class=
"org-string">`void 0`</span>)
<span class="linenr"> 4093: </span>    }
<span class="linenr"> 4094: </span>    dirArgs.push(dir.arg)
<span class="linenr"> 4095: </span>  }
<span class="linenr"> 4096: </span>  <span class=
"org-keyword">if</span> (Object.keys(dir.modifiers).length) {
<span class="linenr"> 4097: </span>    <span class=
"org-keyword">if</span> (!dir.arg) {
<span class="linenr"> 4098: </span>      <span class=
"org-keyword">if</span> (!dir.exp) {
<span class=
"linenr"> 4099: </span>        dirArgs.push(<span class="org-string">`void 0`</span>)
<span class="linenr"> 4100: </span>      }
<span class="linenr"> 4101: </span>      dirArgs.push(<span class=
"org-string">`void 0`</span>)
<span class="linenr"> 4102: </span>    }
<span class="linenr"> 4103: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">trueExpression</span> = createSimpleExpression(<span class="org-string">`true`</span>, <span class="org-constant">false</span>, loc)
<span class="linenr"> 4104: </span>    dirArgs.push(
<span class="linenr"> 4105: </span>      createObjectExpression(
<span class=
"linenr"> 4106: </span>        dir.modifiers.map(modifier =&gt;
<span class=
"linenr"> 4107: </span>          createObjectProperty(modifier, trueExpression)
<span class="linenr"> 4108: </span>        ),
<span class="linenr"> 4109: </span>        loc
<span class="linenr"> 4110: </span>      )
<span class="linenr"> 4111: </span>    )
<span class="linenr"> 4112: </span>  }
<span class="linenr"> 4113: </span>  <span class=
"org-keyword">return</span> createArrayExpression(dirArgs, dir.loc)
<span class="linenr"> 4114: </span>}
<span class="linenr"> 4115: </span>
<span class="linenr"> 4116: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">stringifyDynamicPropNames</span>(<span class=
"org-variable-name">props</span>) {
<span class="linenr"> 4117: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsNamesString</span> = <span class=
"org-string">`[`</span>
<span class="linenr"> 4118: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>, <span class=
"org-variable-name">l</span> = props.length; i &lt; l; i++) {
<span class=
"linenr"> 4119: </span>    propsNamesString += JSON.stringify(props[i])
<span class="linenr"> 4120: </span>    <span class=
"org-keyword">if</span> (i &lt; l - <span class=
"org-highlight-numbers-number">1</span>) propsNamesString += <span class="org-string">', '</span>
<span class="linenr"> 4121: </span>  }
<span class="linenr"> 4122: </span>  <span class=
"org-keyword">return</span> propsNamesString + <span class=
"org-string">`]`</span>
<span class="linenr"> 4123: </span>}
<span class="linenr"> 4124: </span>
<span class="linenr"> 4125: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isComponentTag</span>(<span class=
"org-variable-name">tag</span>) {
<span class="linenr"> 4126: </span>  <span class=
"org-keyword">return</span> tag === <span class=
"org-string">'component'</span> || tag === <span class=
"org-string">'Component'</span>
<span class="linenr"> 4127: </span>}
<span class="linenr"> 4128: </span>
<span class="linenr"> 4129: </span>
<span class="linenr"> 4130: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isLiteralWhitelisted</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(<span class=
"org-string">'true,false,null,this'</span>)
<span class="linenr"> 4131: </span>
<span class="linenr"> 4132: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformExpression</span> = (node, context) =&gt; {
<span class="linenr"> 4133: </span>  logg(<span class=
"org-string">`transformExpression`</span>, node)
<span class="linenr"> 4134: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">插值处理</span>
<span class="linenr"> 4135: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.INTERPOLATION) {
<span class=
"linenr"> 4136: </span>    node.content = processExpression(
<span class="linenr"> 4137: </span>      node.content ,
<span class="linenr"> 4138: </span>      context
<span class="linenr"> 4139: </span>    )
<span class="linenr"> 4140: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === NodeTypes.ELEMENT) {
<span class="linenr"> 4141: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">处理元素上的指令</span>
<span class="linenr"> 4142: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr"> 4143: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">dir</span> = node.props[i]
<span class="linenr"> 4144: </span>      logg(<span class=
"org-string">`transformExpression - prop[${i}] - directive`</span>, node.props[i])
<span class="linenr"> 4145: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">do not process for v-on & v-for since they are special handled</span>
<span class="linenr"> 4146: </span>      <span class=
"org-keyword">if</span> (dir.type === NodeTypes.DIRECTIVE &amp;& dir.name !== <span class="org-string">'for'</span>) { <span class="org-comment-delimiter">// </span><span class="org-comment">v-for 在 vFor.ts 中处理</span>
<span class="linenr"> 4147: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exp</span> = dir.exp
<span class="linenr"> 4148: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">arg</span> = dir.arg
<span class="linenr"> 4149: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">do not process exp if this is v-on:arg - we need special handling</span>
<span class="linenr"> 4150: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for wrapping inline statements.</span>
<span class="linenr"> 4151: </span>        <span class=
"org-keyword">if</span> (
<span class="linenr"> 4152: </span>          exp &amp;&
<span class=
"linenr"> 4153: </span>          exp.type === NodeTypes.SIMPLE_EXPRESSION &amp;&
<span class=
"linenr"> 4154: </span>          !(dir.name === <span class=
"org-string">'on'</span> &amp;& arg)
<span class="linenr"> 4155: </span>        ) {
<span class=
"linenr"> 4156: </span>          dir.exp = processExpression(
<span class="linenr"> 4157: </span>            exp,
<span class="linenr"> 4158: </span>            context,
<span class="linenr"> 4159: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">slot args must be processed as function params</span>
<span class=
"linenr"> 4160: </span>            dir.name === <span class=
"org-string">'slot'</span>
<span class="linenr"> 4161: </span>          )
<span class="linenr"> 4162: </span>        }
<span class="linenr"> 4163: </span>        <span class=
"org-keyword">if</span> (arg &amp;& arg.type === NodeTypes.SIMPLE_EXPRESSION &amp;& !arg.isStatic) {
<span class=
"linenr"> 4164: </span>          dir.arg = processExpression(arg, context)
<span class="linenr"> 4165: </span>        }
<span class="linenr"> 4166: </span>      }
<span class="linenr"> 4167: </span>    }
<span class="linenr"> 4168: </span>  }
<span class="linenr"> 4169: </span>}
<span class="linenr"> 4170: </span>
<span class="linenr"> 4171: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Important: since this function uses Node.js only dependencies, it should</span>
<span class="linenr"> 4172: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">always be used with a leading !__BROWSER__ check so that it can be</span>
<span class="linenr"> 4173: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">tree-shaken from the browser build.</span>
<span class="linenr"> 4174: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">processExpression</span>(
<span class="linenr"> 4175: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 4176: </span>  <span class=
"org-variable-name">context</span>,
<span class="linenr"> 4177: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">some expressions like v-slot props & v-for aliases should be parsed as</span>
<span class="linenr"> 4178: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">function params</span>
<span class="linenr"> 4179: </span>  asParams = <span class=
"org-constant">false</span>,
<span class="linenr"> 4180: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-on handler values may contain multiple statements</span>
<span class="linenr"> 4181: </span>  asRawStatements = <span class=
"org-constant">false</span>,
<span class=
"linenr"> 4182: </span>  localVars = Object.create(context.identifiers)
<span class="linenr"> 4183: </span>) {
<span class="linenr"> 4184: </span>  <span class=
"org-keyword">if</span> (__BROWSER__) {
<span class="linenr"> 4185: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 4186: </span>  }
<span class="linenr"> 4187: </span>
<span class="linenr"> 4188: </span>  <span class=
"org-keyword">if</span> (!context.prefixIdentifiers || !node.content.trim()) {
<span class="linenr"> 4189: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 4190: </span>  }
<span class="linenr"> 4191: </span>
<span class="linenr"> 4192: </span>  <span class=
"org-keyword">const</span> { inline, bindingMetadata } = context
<span class="linenr"> 4193: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rewriteIdentifier</span> = (raw, parent, id) =&gt; {
<span class="linenr"> 4194: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = hasOwn(bindingMetadata, raw) &amp;& bindingMetadata[raw]
<span class="linenr"> 4195: </span>    <span class=
"org-keyword">if</span> (inline) {
<span class="linenr"> 4196: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x = y</span>
<span class="linenr"> 4197: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isAssignmentLVal</span> =
<span class=
"linenr"> 4198: </span>        parent &amp;& parent.type === <span class="org-string">'AssignmentExpression'</span> &amp;& parent.left === id
<span class="linenr"> 4199: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x++</span>
<span class="linenr"> 4200: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isUpdateArg</span> =
<span class=
"linenr"> 4201: </span>        parent &amp;& parent.type === <span class="org-string">'UpdateExpression'</span> &amp;& parent.argument === id
<span class="linenr"> 4202: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">({ x } = y)</span>
<span class="linenr"> 4203: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDestructureAssignment</span> =
<span class=
"linenr"> 4204: </span>        parent &amp;& isInDestructureAssignment(parent, parentStack)
<span class="linenr"> 4205: </span>
<span class="linenr"> 4206: </span>      <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_CONST || localVars[raw]) {
<span class="linenr"> 4207: </span>        <span class=
"org-keyword">return</span> raw
<span class="linenr"> 4208: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_REF) {
<span class="linenr"> 4209: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`${raw}.value`</span>
<span class="linenr"> 4210: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_MAYBE_REF) {
<span class="linenr"> 4211: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">const binding that may or may not be ref</span>
<span class="linenr"> 4212: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if it's not a ref, then assignments don't make sense -</span>
<span class="linenr"> 4213: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">so we ignore the non-ref assignment case and generate code</span>
<span class="linenr"> 4214: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">that assumes the value to be a ref for more efficiency</span>
<span class="linenr"> 4215: </span>        <span class=
"org-keyword">return</span> isAssignmentLVal || isUpdateArg || isDestructureAssignment
<span class="linenr"> 4216: </span>          ? <span class=
"org-string">`${raw}.value`</span>
<span class="linenr"> 4217: </span>          : <span class=
"org-string">`${context.helperString(UNREF)}(${raw})`</span>
<span class="linenr"> 4218: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_LET) {
<span class="linenr"> 4219: </span>        <span class=
"org-keyword">if</span> (isAssignmentLVal) {
<span class="linenr"> 4220: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let binding.</span>
<span class="linenr"> 4221: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">this is a bit more tricky as we need to cover the case where</span>
<span class="linenr"> 4222: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let is a local non-ref value, and we need to replicate the</span>
<span class="linenr"> 4223: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">right hand side value.</span>
<span class="linenr"> 4224: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x = y --&gt; isRef(x) ? x.value = y : x = y</span>
<span class="linenr"> 4225: </span>          <span class=
"org-keyword">const</span> { right: rVal, operator } = parent
<span class="linenr"> 4226: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rExp</span> = rawExp.slice(rVal.start - <span class="org-highlight-numbers-number">1</span>, rVal.end - <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 4227: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rExpString</span> = stringifyExpression(
<span class="linenr"> 4228: </span>            processExpression(
<span class=
"linenr"> 4229: </span>              createSimpleExpression(rExp, <span class="org-constant">false</span>),
<span class="linenr"> 4230: </span>              context,
<span class="linenr"> 4231: </span>              <span class=
"org-constant">false</span>,
<span class="linenr"> 4232: </span>              <span class=
"org-constant">false</span>,
<span class="linenr"> 4233: </span>              knownIds
<span class="linenr"> 4234: </span>            )
<span class="linenr"> 4235: </span>          )
<span class="linenr"> 4236: </span>          <span class=
"org-keyword">return</span> <span class=
"org-string">`${context.helperString(IS_REF)}(${raw})${``} ? ${raw}.value ${operator} ${rExpString} : ${raw}`</span>
<span class="linenr"> 4237: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isUpdateArg) {
<span class="linenr"> 4238: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">make id replace parent in the code range so the raw update operator</span>
<span class="linenr"> 4239: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">is removed</span>
<span class=
"linenr"> 4240: </span>          id.start = parent.start
<span class="linenr"> 4241: </span>          id.end = parent.end
<span class="linenr"> 4242: </span>          <span class=
"org-keyword">const</span> { prefix: isPrefix, operator } = parent
<span class="linenr"> 4243: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prefix</span> = isPrefix ? operator : <span class="org-string">``</span>
<span class="linenr"> 4244: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">postfix</span> = isPrefix ? <span class=
"org-string">``</span> : operator
<span class="linenr"> 4245: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let binding.</span>
<span class="linenr"> 4246: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x++ --&gt; isRef(a) ? a.value++ : a++</span>
<span class="linenr"> 4247: </span>          <span class=
"org-keyword">return</span> <span class=
"org-string">`${context.helperString(IS_REF)}(${raw})${``} ? ${prefix}${raw}.value${postfix} : ${prefix}${raw}${postfix}`</span>
<span class="linenr"> 4248: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isDestructureAssignment) {
<span class="linenr"> 4249: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO</span></span></span>
<span class="linenr"> 4250: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let binding in a destructure assignment - it's very tricky to</span>
<span class="linenr"> 4251: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">handle both possible cases here without altering the original</span>
<span class="linenr"> 4252: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">structure of the code, so we just assume it's not a ref here</span>
<span class="linenr"> 4253: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for now</span>
<span class="linenr"> 4254: </span>          <span class=
"org-keyword">return</span> raw
<span class="linenr"> 4255: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4256: </span>          <span class=
"org-keyword">return</span> <span class=
"org-string">`${context.helperString(UNREF)}(${raw})`</span>
<span class="linenr"> 4257: </span>        }
<span class="linenr"> 4258: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.PROPS) {
<span class="linenr"> 4259: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">use __props which is generated by compileScript so in ts mode</span>
<span class="linenr"> 4260: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">it gets correct type</span>
<span class="linenr"> 4261: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`__props.${raw}`</span>
<span class="linenr"> 4262: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.PROPS_ALIASED) {
<span class="linenr"> 4263: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">prop with a different local alias (from defineProps() destructure)</span>
<span class="linenr"> 4264: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`__props.${bindingMetadata.__propsAliases[raw]}`</span>
<span class="linenr"> 4265: </span>      }
<span class="linenr"> 4266: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4267: </span>      <span class=
"org-keyword">if</span> (type &amp;& type.startsWith(<span class=
"org-string">'setup'</span>)) {
<span class="linenr"> 4268: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">setup bindings in non-inline mode</span>
<span class="linenr"> 4269: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`$setup.${raw}`</span>
<span class="linenr"> 4270: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.PROPS_ALIASED) {
<span class="linenr"> 4271: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`$props.${bindingMetadata.__propsAliases[raw]}`</span>
<span class="linenr"> 4272: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type) {
<span class="linenr"> 4273: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`$${type}.${raw}`</span>
<span class="linenr"> 4274: </span>      }
<span class="linenr"> 4275: </span>    }
<span class="linenr"> 4276: </span>
<span class="linenr"> 4277: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">fallback to ctx</span>
<span class="linenr"> 4278: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`_ctx.${raw}`</span>
<span class="linenr"> 4279: </span>  }
<span class="linenr"> 4280: </span>
<span class="linenr"> 4281: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">fast path if expression is a simple identifier.</span>
<span class="linenr"> 4282: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rawExp</span> = node.content
<span class="linenr"> 4283: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">bail constant on parens (function invocation) and dot (member access)</span>
<span class="linenr"> 4284: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bailConstant</span> = rawExp.indexOf(<span class="org-string">`(`</span>) &gt; -<span class="org-highlight-numbers-number">1</span> || rawExp.indexOf(<span class="org-string">'.'</span>) &gt; <span class="org-highlight-numbers-number">0</span>
<span class="linenr"> 4285: </span>
<span class="linenr"> 4286: </span>  logg(<span class=
"org-string">`processExpression - node.content: ${rawExp}`</span>)
<span class="linenr"> 4287: </span>  <span class=
"org-keyword">if</span> (isSimpleIdentifier(rawExp)) {
<span class="linenr"> 4288: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isScopeVarReference</span> = context.identifiers[rawExp]
<span class="linenr"> 4289: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isAllowedGlobal</span> = isGloballyWhitelisted(rawExp)
<span class="linenr"> 4290: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isLiteral</span> = isLiteralWhitelisted(rawExp)
<span class="linenr"> 4291: </span>    <span class=
"org-keyword">if</span> (!asParams &amp;& !isScopeVarReference &amp;& !isAllowedGlobal &amp;& !isLiteral) {
<span class="linenr"> 4292: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">const bindings exposed from setup can be skipped for patching but</span>
<span class="linenr"> 4293: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">cannot be hoisted to module scope</span>
<span class="linenr"> 4294: </span>      <span class=
"org-keyword">if</span> (bindingMetadata[node.content] === BindingTypes.SETUP_CONST) {
<span class=
"linenr"> 4295: </span>        node.constType = ConstantTypes.CAN_SKIP_PATCH
<span class="linenr"> 4296: </span>      }
<span class=
"linenr"> 4297: </span>      node.content = rewriteIdentifier(rawExp)
<span class="linenr"> 4298: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (!isScopeVarReference) {
<span class="linenr"> 4299: </span>      <span class=
"org-keyword">if</span> (isLiteral) {
<span class=
"linenr"> 4300: </span>        node.constType = ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 4301: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4302: </span>        node.constType = ConstantTypes.CAN_HOIST
<span class="linenr"> 4303: </span>      }
<span class="linenr"> 4304: </span>    }
<span class="linenr"> 4305: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 4306: </span>  }
<span class="linenr"> 4307: </span>
<span class="linenr"> 4308: </span>  <span class=
"org-keyword">let</span> <span class="org-variable-name">ast</span>
<span class="linenr"> 4309: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">exp needs to be parsed differently:</span>
<span class="linenr"> 4310: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. Multiple inline statements (v-on, with presence of `;`): parse as raw</span>
<span class="linenr"> 4311: </span>  <span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">exp, but make sure to pad with spaces for consistent ranges</span>
<span class="linenr"> 4312: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. Expressions: wrap with parens (for e.g. object expressions)</span>
<span class="linenr"> 4313: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">3. Function arguments (v-for, v-slot): place in a function argument position</span>
<span class="linenr"> 4314: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = asRawStatements
<span class="linenr"> 4315: </span>    ? <span class=
"org-string">` ${rawExp} `</span>
<span class="linenr"> 4316: </span>    : <span class=
"org-string">`(${rawExp})${asParams ? `</span>=&gt;{}<span class=
"org-string">` : ``}`</span>
<span class="linenr"> 4317: </span>  <span class=
"org-keyword">try</span> {
<span class=
"linenr"> 4318: </span>    ast = babelParser.parse(source, {
<span class=
"linenr"> 4319: </span>      plugins: context.expressionPlugins
<span class="linenr"> 4320: </span>    }).program
<span class="linenr"> 4321: </span>  } <span class=
"org-keyword">catch</span> (e) {
<span class="linenr"> 4322: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 4323: </span>  }
<span class="linenr"> 4324: </span>
<span class="linenr"> 4325: </span>  logg(<span class=
"org-string">`processExpression - babel parse`</span>, ast)
<span class="linenr"> 4326: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ids</span> = []
<span class="linenr"> 4327: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parentStack</span> = []
<span class="linenr"> 4328: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">knownIds</span> = Object.create(context.identifiers)
<span class="linenr"> 4329: </span>
<span class="linenr"> 4330: </span>  walkIdentifiers(
<span class="linenr"> 4331: </span>    ast,
<span class=
"linenr"> 4332: </span>    (node, parent, _, isReferenced, isLocal) =&gt; {
<span class="linenr"> 4333: </span>      <span class=
"org-keyword">if</span> (isStaticPropertyKey(node, parent)) {
<span class="linenr"> 4334: </span>        <span class=
"org-keyword">return</span>
<span class="linenr"> 4335: </span>      }
<span class="linenr"> 4336: </span>
<span class="linenr"> 4337: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">needPrefix</span> = isReferenced &amp;& canPrefix(node)
<span class="linenr"> 4338: </span>      <span class=
"org-keyword">if</span> (needPrefix &amp;& !isLocal) {
<span class="linenr"> 4339: </span>        <span class=
"org-keyword">if</span> (isStaticProperty(parent) &amp;& parent.shorthand) {
<span class="linenr"> 4340: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">property shorthand like { foo }, we need to add the key since</span>
<span class="linenr"> 4341: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we rewrite the value</span>
<span class=
"linenr"> 4342: </span>          node.prefix = <span class=
"org-string">`${node.name}: `</span>
<span class="linenr"> 4343: </span>        }
<span class=
"linenr"> 4344: </span>        node.name = rewriteIdentifier(node.name, parent, node)
<span class="linenr"> 4345: </span>        ids.push(node)
<span class="linenr"> 4346: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4347: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">The identifier is considered constant unless it's pointing to a</span>
<span class="linenr"> 4348: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">local scope variable (a v-for alias, or a v-slot prop)</span>
<span class="linenr"> 4349: </span>        <span class=
"org-keyword">if</span> (!(needPrefix &amp;& isLocal) &amp;& !bailConstant) {
<span class=
"linenr"> 4350: </span>          node.isConstant = <span class=
"org-constant">true</span>
<span class="linenr"> 4351: </span>        }
<span class="linenr"> 4352: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">also generate sub-expressions for other identifiers for better</span>
<span class="linenr"> 4353: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">source map support. (except for property keys which are static)</span>
<span class="linenr"> 4354: </span>        ids.push(node)
<span class="linenr"> 4355: </span>      }
<span class="linenr"> 4356: </span>    },
<span class="linenr"> 4357: </span>    <span class=
"org-constant">true</span>, <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">invoke on ALL identifiers</span>
<span class="linenr"> 4358: </span>    parentStack,
<span class="linenr"> 4359: </span>    knownIds
<span class="linenr"> 4360: </span>  )
<span class="linenr"> 4361: </span>
<span class="linenr"> 4362: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">We break up the compound expression into an array of strings and sub</span>
<span class="linenr"> 4363: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">expressions (for identifiers that have been prefixed). In codegen, if</span>
<span class="linenr"> 4364: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">an ExpressionNode has the `.children` property, it will be used instead of</span>
<span class="linenr"> 4365: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">`.content`.</span>
<span class="linenr"> 4366: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">children</span> = []
<span class=
"linenr"> 4367: </span>  ids.sort((a, b) =&gt; a.start - b.start)
<span class="linenr"> 4368: </span>  ids.forEach((id, i) =&gt; {
<span class="linenr"> 4369: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">range is offset by -1 due to the wrapping parens when parsed</span>
<span class="linenr"> 4370: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = id.start - <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 4371: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">end</span> = id.end - <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 4372: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">last</span> = ids[i - <span class=
"org-highlight-numbers-number">1</span>]
<span class="linenr"> 4373: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">leadingText</span> = rawExp.slice(last ? last.end - <span class="org-highlight-numbers-number">1</span> : <span class="org-highlight-numbers-number">0</span>, start)
<span class="linenr"> 4374: </span>    <span class=
"org-keyword">if</span> (leadingText.length || id.prefix) {
<span class=
"linenr"> 4375: </span>      children.push(leadingText + (id.prefix || <span class="org-string">``</span>))
<span class="linenr"> 4376: </span>    }
<span class="linenr"> 4377: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = rawExp.slice(start, end)
<span class="linenr"> 4378: </span>    children.push(
<span class="linenr"> 4379: </span>      createSimpleExpression(
<span class="linenr"> 4380: </span>        id.name,
<span class="linenr"> 4381: </span>        <span class=
"org-constant">false</span>,
<span class="linenr"> 4382: </span>        {
<span class="linenr"> 4383: </span>          source,
<span class=
"linenr"> 4384: </span>          start: advancePositionWithClone(node.loc.start, source, start),
<span class=
"linenr"> 4385: </span>          end: advancePositionWithClone(node.loc.start, source, end)
<span class="linenr"> 4386: </span>        },
<span class=
"linenr"> 4387: </span>        id.isConstant ? ConstantTypes.CAN_STRINGIFY : ConstantTypes.NOT_CONSTANT
<span class="linenr"> 4388: </span>      )
<span class="linenr"> 4389: </span>    )
<span class="linenr"> 4390: </span>    <span class=
"org-keyword">if</span> (i === ids.length - <span class=
"org-highlight-numbers-number">1</span> &amp;& end &lt; rawExp.length) {
<span class=
"linenr"> 4391: </span>      children.push(rawExp.slice(end))
<span class="linenr"> 4392: </span>    }
<span class="linenr"> 4393: </span>  })
<span class="linenr"> 4394: </span>
<span class="linenr"> 4395: </span>  <span class=
"org-keyword">let</span> <span class="org-variable-name">ret</span>
<span class="linenr"> 4396: </span>  <span class=
"org-keyword">if</span> (children.length) {
<span class=
"linenr"> 4397: </span>    ret = createCompoundExpression(children, node.loc)
<span class="linenr"> 4398: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4399: </span>    ret = node
<span class="linenr"> 4400: </span>    ret.constType = bailConstant
<span class=
"linenr"> 4401: </span>      ? ConstantTypes.NOT_CONSTANT
<span class=
"linenr"> 4402: </span>      : ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 4403: </span>  }
<span class=
"linenr"> 4404: </span>  ret.identifiers = Object.keys(knownIds)
<span class="linenr"> 4405: </span>  <span class=
"org-keyword">return</span> ret
<span class="linenr"> 4406: </span>}
<span class="linenr"> 4407: </span>
<span class="linenr"> 4408: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">canPrefix</span>(<span class=
"org-variable-name">id</span>) {
<span class="linenr"> 4409: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip whitelisted globals</span>
<span class="linenr"> 4410: </span>  <span class=
"org-keyword">if</span> (isGloballyWhitelisted(id.name)) {
<span class="linenr"> 4411: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 4412: </span>  }
<span class="linenr"> 4413: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">special case for webpack compilation</span>
<span class="linenr"> 4414: </span>  <span class=
"org-keyword">if</span> (id.name === <span class=
"org-string">'require'</span>) {
<span class="linenr"> 4415: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 4416: </span>  }
<span class="linenr"> 4417: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 4418: </span>}
<span class="linenr"> 4419: </span>
<span class="linenr"> 4420: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">stringifyExpression</span>(<span class=
"org-variable-name">exp</span>) {
<span class="linenr"> 4421: </span>  <span class=
"org-keyword">if</span> (isString(exp)) {
<span class="linenr"> 4422: </span>    <span class=
"org-keyword">return</span> exp
<span class="linenr"> 4423: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (exp.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 4424: </span>    <span class=
"org-keyword">return</span> exp.content
<span class="linenr"> 4425: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4426: </span>    <span class=
"org-keyword">return</span> (exp.children)
<span class="linenr"> 4427: </span>      .map(stringifyExpression)
<span class="linenr"> 4428: </span>      .join(<span class=
"org-string">''</span>)
<span class="linenr"> 4429: </span>  }
<span class="linenr"> 4430: </span>}
<span class="linenr"> 4431: </span>
<span class="linenr"> 4432: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformSlotOutlet</span> = (node, context) =&gt; {
<span class="linenr"> 4433: </span>  <span class=
"org-keyword">if</span> (isSlotOutlet(node)) { <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;slot/&gt;</span>
<span class="linenr"> 4434: </span>    <span class=
"org-keyword">const</span> { children, loc } = node
<span class="linenr"> 4435: </span>    <span class=
"org-keyword">const</span> { slotName, slotProps } = processSlotOutlet(node, context)
<span class="linenr"> 4436: </span>
<span class="linenr"> 4437: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotArgs</span> = [
<span class=
"linenr"> 4438: </span>      context.prefixIdentifiers ? <span class="org-string">`_ctx.$slots`</span> : <span class="org-string">`$slots`</span>,
<span class="linenr"> 4439: </span>      slotName,
<span class="linenr"> 4440: </span>      <span class=
"org-string">'{}'</span>, <span class=
"org-comment-delimiter">//  </span><span class=
"org-comment">props</span>
<span class="linenr"> 4441: </span>      <span class=
"org-string">'undefined'</span>, <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">children</span>
<span class="linenr"> 4442: </span>      <span class=
"org-string">'true'</span>
<span class="linenr"> 4443: </span>    ]
<span class="linenr"> 4444: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">expectedLen</span> = <span class=
"org-highlight-numbers-number">2</span>
<span class="linenr"> 4445: </span>
<span class="linenr"> 4446: </span>    <span class=
"org-keyword">if</span> (slotProps) {
<span class="linenr"> 4447: </span>      slotArgs[<span class=
"org-highlight-numbers-number">2</span>] = slotProps
<span class="linenr"> 4448: </span>      expectedLen = <span class=
"org-highlight-numbers-number">3</span>
<span class="linenr"> 4449: </span>    }
<span class="linenr"> 4450: </span>
<span class="linenr"> 4451: </span>    <span class=
"org-keyword">if</span> (children.length) {
<span class="linenr"> 4452: </span>      slotArgs[<span class=
"org-highlight-numbers-number">3</span>] = createFunctionExpression([], children, <span class="org-constant">false</span>, <span class="org-constant">false</span>, loc)
<span class="linenr"> 4453: </span>      expectedLen = <span class=
"org-highlight-numbers-number">4</span>
<span class="linenr"> 4454: </span>    }
<span class="linenr"> 4455: </span>
<span class="linenr"> 4456: </span>    <span class=
"org-keyword">if</span> (context.scopeId &amp;& !context.slotted) {
<span class="linenr"> 4457: </span>      expectedLen = <span class=
"org-highlight-numbers-number">5</span>
<span class="linenr"> 4458: </span>    }
<span class=
"linenr"> 4459: </span>    slotArgs.splice(expectedLen) <span class="org-comment-delimiter">// </span><span class="org-comment">remove unused arguments</span>
<span class="linenr"> 4460: </span>
<span class="linenr"> 4461: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">-&gt; renderSlot($slots, slotName, props, children, true)</span>
<span class=
"linenr"> 4462: </span>    node.codegenNode = createCallExpression(
<span class=
"linenr"> 4463: </span>      context.helper(RENDER_SLOT), <span class="org-comment-delimiter">// </span><span class="org-comment">renderSlot</span>
<span class="linenr"> 4464: </span>      slotArgs,
<span class="linenr"> 4465: </span>      loc
<span class="linenr"> 4466: </span>    )
<span class="linenr"> 4467: </span>  }
<span class="linenr"> 4468: </span>}
<span class="linenr"> 4469: </span>
<span class="linenr"> 4470: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">processSlotOutlet</span>(
<span class="linenr"> 4471: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 4472: </span>  context
<span class="linenr"> 4473: </span>) {
<span class="linenr"> 4474: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">slotName</span> = <span class=
"org-string">`"default"`</span>
<span class="linenr"> 4475: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">slotProps</span> = <span class=
"org-constant">undefined</span>
<span class="linenr"> 4476: </span>
<span class="linenr"> 4477: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">nonNameProps</span> = [] <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">无名插槽</span>
<span class="linenr"> 4478: </span>  logg(<span class=
"org-string">`processSlotOutlet| props.length = ${node.props.length}`</span>)
<span class="linenr"> 4479: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr"> 4480: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = node.props[i]
<span class="linenr"> 4481: </span>    logg(<span class=
"org-string">`processSlotOutlet| props[${i}]`</span>, p)
<span class="linenr"> 4482: </span>    <span class=
"org-keyword">if</span> (p.type === NodeTypes.ATTRIBUTE) { <span class="org-comment-delimiter">// </span><span class="org-comment">静态 &lt;slot name="xxx"/&gt;</span>
<span class="linenr"> 4483: </span>      <span class=
"org-keyword">if</span> (p.value) {
<span class="linenr"> 4484: </span>        <span class=
"org-keyword">if</span> (p.name === <span class=
"org-string">'name'</span>) {
<span class=
"linenr"> 4485: </span>          slotName = JSON.stringify(p.value.content)
<span class="linenr"> 4486: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4487: </span>          p.name = camelize(p.name)
<span class="linenr"> 4488: </span>          nonNameProps.push(p)
<span class="linenr"> 4489: </span>        }
<span class="linenr"> 4490: </span>      }
<span class="linenr"> 4491: </span>    } <span class=
"org-keyword">else</span> { <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">动态 &lt;slot :name="xxx"/&gt;</span>
<span class="linenr"> 4492: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">动态插槽 &lt;slot v-bind:name="slotName"/&gt;</span>
<span class="linenr"> 4493: </span>      <span class=
"org-keyword">if</span> (p.name === <span class=
"org-string">'bind'</span> &amp;& isStaticArgOf(p.arg, <span class=
"org-string">'name'</span>)) {
<span class="linenr"> 4494: </span>        <span class=
"org-keyword">if</span> (p.exp) slotName = p.exp
<span class="linenr"> 4495: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4496: </span>        <span class=
"org-keyword">if</span> (p.name === <span class=
"org-string">'bind'</span> &amp;& p.arg &amp;& isStaticExp(p.arg)) {
<span class=
"linenr"> 4497: </span>          p.arg.content = camelize(p.arg.content)
<span class="linenr"> 4498: </span>        }
<span class="linenr"> 4499: </span>        nonNameProps.push(p)
<span class="linenr"> 4500: </span>      }
<span class="linenr"> 4501: </span>    }
<span class="linenr"> 4502: </span>  }
<span class="linenr"> 4503: </span>
<span class="linenr"> 4504: </span>  logg(<span class=
"org-string">`processSlotOutlet| nonNameProps.length=${nonNameProps.length}`</span>)
<span class="linenr"> 4505: </span>  <span class=
"org-keyword">if</span> (nonNameProps.length &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 4506: </span>    <span class=
"org-keyword">const</span> { props, directives } = buildProps(node, context, nonNameProps)
<span class="linenr"> 4507: </span>    slotProps = props
<span class="linenr"> 4508: </span>
<span class="linenr"> 4509: </span>    <span class=
"org-keyword">if</span> (directives.length) {
<span class="linenr"> 4510: </span>      logg(<span class=
"org-string">'[ERROR] X_V_SLOT_UNEXPECTED_DIRECTIVE_ON_SLOT_OUTLET'</span>)
<span class="linenr"> 4511: </span>    }
<span class="linenr"> 4512: </span>  }
<span class="linenr"> 4513: </span>
<span class="linenr"> 4514: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 4515: </span>    slotName,
<span class="linenr"> 4516: </span>    slotProps
<span class="linenr"> 4517: </span>  }
<span class="linenr"> 4518: </span>}
<span class="linenr"> 4519: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Merge adjacent text nodes and expressions into a single expression</span>
<span class="linenr"> 4520: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">e.g. &lt;div&gt;abc {{ d }} {{ e }}&lt;/div&gt; should have a single expression node as child.</span>
<span class="linenr"> 4521: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformText</span> = (node, context) =&gt; {
<span class="linenr"> 4522: </span>  <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 4523: </span>    node.type === NodeTypes.ROOT ||
<span class=
"linenr"> 4524: </span>    node.type === NodeTypes.ELEMENT ||
<span class=
"linenr"> 4525: </span>    node.type === NodeTypes.FOR ||
<span class=
"linenr"> 4526: </span>    node.type === NodeTypes.IF_BRANCH
<span class="linenr"> 4527: </span>  ) {
<span class="linenr"> 4528: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">perform the transform on node exit so that all expressions have already</span>
<span class="linenr"> 4529: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">been processed.</span>
<span class="linenr"> 4530: </span>    <span class=
"org-keyword">return</span> () =&gt; {
<span class="linenr"> 4531: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">children</span> = node.children
<span class="linenr"> 4532: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">currentContainer</span> = <span class=
"org-constant">undefined</span>
<span class="linenr"> 4533: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasText</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 4534: </span>
<span class="linenr"> 4535: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; children.length; i++) {
<span class="linenr"> 4536: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = children[i]
<span class="linenr"> 4537: </span>        <span class=
"org-keyword">if</span> (isText(child)) {
<span class="linenr"> 4538: </span>          hasText = <span class=
"org-constant">true</span>
<span class="linenr"> 4539: </span>          <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">j</span> = i + <span class=
"org-highlight-numbers-number">1</span>; j &lt; children.length; j++) {
<span class="linenr"> 4540: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">next</span> = children[j]
<span class="linenr"> 4541: </span>            <span class=
"org-keyword">if</span> (isText(next)) {
<span class="linenr"> 4542: </span>              <span class=
"org-keyword">if</span> (!currentContainer) {
<span class=
"linenr"> 4543: </span>                currentContainer = children[i] = {
<span class=
"linenr"> 4544: </span>                  type: NodeTypes.COMPOUND_EXPRESSION,
<span class=
"linenr"> 4545: </span>                  loc: child.loc,
<span class=
"linenr"> 4546: </span>                  children: [child]
<span class="linenr"> 4547: </span>                }
<span class="linenr"> 4548: </span>              }
<span class="linenr"> 4549: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">merge adjacent text node into current</span>
<span class=
"linenr"> 4550: </span>              currentContainer.children.push(<span class="org-string">` + `</span>, next)
<span class=
"linenr"> 4551: </span>              children.splice(j, <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 4552: </span>              j--
<span class="linenr"> 4553: </span>            } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4554: </span>              currentContainer = <span class="org-constant">undefined</span>
<span class="linenr"> 4555: </span>              <span class=
"org-keyword">break</span>
<span class="linenr"> 4556: </span>            }
<span class="linenr"> 4557: </span>          }
<span class="linenr"> 4558: </span>        }
<span class="linenr"> 4559: </span>      }
<span class="linenr"> 4560: </span>
<span class="linenr"> 4561: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 4562: </span>        !hasText ||
<span class="linenr"> 4563: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if this is a plain element with a single text child, leave it</span>
<span class="linenr"> 4564: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">as-is since the runtime has dedicated fast path for this by directly</span>
<span class="linenr"> 4565: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">setting textContent of the element.</span>
<span class="linenr"> 4566: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for component root it's always normalized anyway.</span>
<span class=
"linenr"> 4567: </span>        (children.length === <span class=
"org-highlight-numbers-number">1</span> &amp;&
<span class=
"linenr"> 4568: </span>          (node.type === NodeTypes.ROOT ||
<span class=
"linenr"> 4569: </span>            (node.type === NodeTypes.ELEMENT &amp;&
<span class=
"linenr"> 4570: </span>              node.tagType === ElementTypes.ELEMENT &amp;&
<span class="linenr"> 4571: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#3756</span>
<span class="linenr"> 4572: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">custom directives can potentially add DOM elements arbitrarily,</span>
<span class="linenr"> 4573: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we need to avoid setting textContent of the element at runtime</span>
<span class="linenr"> 4574: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">to avoid accidentally overwriting the DOM elements added</span>
<span class="linenr"> 4575: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">by the user through custom directives.</span>
<span class="linenr"> 4576: </span>              !node.props.find(
<span class="linenr"> 4577: </span>                p =&gt;
<span class=
"linenr"> 4578: </span>                  p.type === NodeTypes.DIRECTIVE &amp;&
<span class=
"linenr"> 4579: </span>                  !context.directiveTransforms[p.name]
<span class="linenr"> 4580: </span>              ))))
<span class="linenr"> 4581: </span>      ) {
<span class="linenr"> 4582: </span>        <span class=
"org-keyword">return</span>
<span class="linenr"> 4583: </span>      }
<span class="linenr"> 4584: </span>
<span class="linenr"> 4585: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">pre-convert text nodes into createTextVNode(text) calls to avoid</span>
<span class="linenr"> 4586: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">runtime normalization.</span>
<span class="linenr"> 4587: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; children.length; i++) {
<span class="linenr"> 4588: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = children[i]
<span class="linenr"> 4589: </span>        <span class=
"org-keyword">if</span> (isText(child) || child.type === NodeTypes.COMPOUND_EXPRESSION) {
<span class="linenr"> 4590: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">callArgs</span> = []
<span class="linenr"> 4591: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">createTextVNode defaults to single whitespace, so if it is a</span>
<span class="linenr"> 4592: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">single space the code could be an empty call to save bytes.</span>
<span class="linenr"> 4593: </span>          <span class=
"org-keyword">if</span> (child.type !== NodeTypes.TEXT || child.content !== <span class="org-string">' '</span>) {
<span class="linenr"> 4594: </span>            callArgs.push(child)
<span class="linenr"> 4595: </span>          }
<span class="linenr"> 4596: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">mark dynamic text with flag so it gets patched inside a block</span>
<span class="linenr"> 4597: </span>          <span class=
"org-keyword">if</span> (
<span class="linenr"> 4598: </span>            !context.ssr &amp;&
<span class=
"linenr"> 4599: </span>            getConstantType(child, context) === ConstantTypes.NOT_CONSTANT
<span class="linenr"> 4600: </span>          ) {
<span class="linenr"> 4601: </span>            callArgs.push(
<span class="linenr"> 4602: </span>              PatchFlags.TEXT +
<span class=
"linenr"> 4603: </span>                (__DEV__ ? <span class=
"org-string">` /* ${PatchFlagNames[PatchFlags.TEXT]} */`</span> : <span class="org-string">``</span>)
<span class="linenr"> 4604: </span>            )
<span class="linenr"> 4605: </span>          }
<span class="linenr"> 4606: </span>          children[i] = {
<span class=
"linenr"> 4607: </span>            type: NodeTypes.TEXT_CALL,
<span class="linenr"> 4608: </span>            content: child,
<span class="linenr"> 4609: </span>            loc: child.loc,
<span class=
"linenr"> 4610: </span>            codegenNode: createCallExpression(
<span class=
"linenr"> 4611: </span>              context.helper(CREATE_TEXT),
<span class="linenr"> 4612: </span>              callArgs
<span class="linenr"> 4613: </span>            )
<span class="linenr"> 4614: </span>          }
<span class="linenr"> 4615: </span>        }
<span class="linenr"> 4616: </span>      }
<span class="linenr"> 4617: </span>    }
<span class="linenr"> 4618: </span>  }
<span class="linenr"> 4619: </span>}
<span class="linenr"> 4620: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-bind without arg is handled directly in ./transformElements.ts due to it affecting</span>
<span class="linenr"> 4621: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">codegen for the entire props object. This transform here is only for v-bind</span>
<span class="linenr"> 4622: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">*with* args.</span>
<span class="linenr"> 4623: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformBind</span> = (dir, _node, context) =&gt; {
<span class="linenr"> 4624: </span>  <span class=
"org-keyword">const</span> { exp, modifiers, loc } = dir
<span class="linenr"> 4625: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">arg</span> = dir.arg
<span class="linenr"> 4626: </span>
<span class="linenr"> 4627: </span>  <span class=
"org-keyword">if</span> (arg.type !== NodeTypes.SIMPLE_EXPRESSION) {
<span class=
"linenr"> 4628: </span>    arg.children.unshift(<span class=
"org-string">`(`</span>)
<span class=
"linenr"> 4629: </span>    arg.children.push(<span class=
"org-string">`) || ""`</span>)
<span class="linenr"> 4630: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (!arg.isStatic) {
<span class="linenr"> 4631: </span>    arg.content = <span class=
"org-string">`${arg.content} || ""`</span>
<span class="linenr"> 4632: </span>  }
<span class="linenr"> 4633: </span>
<span class="linenr"> 4634: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">.sync is replaced by v-model:arg</span>
<span class="linenr"> 4635: </span>  <span class=
"org-keyword">if</span> (modifiers.includes(<span class=
"org-string">'camel'</span>)) {
<span class="linenr"> 4636: </span>    <span class=
"org-keyword">if</span> (arg.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 4637: </span>      <span class=
"org-keyword">if</span> (arg.isStatic) {
<span class=
"linenr"> 4638: </span>        arg.content = camelize(arg.content)
<span class="linenr"> 4639: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4640: </span>        arg.content = <span class=
"org-string">`${context.helperString(CAMELIZE)}(${arg.content})`</span>
<span class="linenr"> 4641: </span>      }
<span class="linenr"> 4642: </span>    } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4643: </span>      arg.children.unshift(<span class=
"org-string">`${context.helperString(CAMELIZE)}(`</span>)
<span class=
"linenr"> 4644: </span>      arg.children.push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 4645: </span>    }
<span class="linenr"> 4646: </span>  }
<span class="linenr"> 4647: </span>
<span class="linenr"> 4648: </span>  <span class=
"org-keyword">if</span> (!context.inSSR) {
<span class="linenr"> 4649: </span>    <span class=
"org-keyword">if</span> (modifiers.includes(<span class=
"org-string">'prop'</span>)) {
<span class=
"linenr"> 4650: </span>      injectPrefix(arg, <span class=
"org-string">'.'</span>)
<span class="linenr"> 4651: </span>    }
<span class="linenr"> 4652: </span>    <span class=
"org-keyword">if</span> (modifiers.includes(<span class=
"org-string">'attr'</span>)) {
<span class=
"linenr"> 4653: </span>      injectPrefix(arg, <span class=
"org-string">'^'</span>)
<span class="linenr"> 4654: </span>    }
<span class="linenr"> 4655: </span>  }
<span class="linenr"> 4656: </span>
<span class="linenr"> 4657: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 4658: </span>    !exp ||
<span class=
"linenr"> 4659: </span>    (exp.type === NodeTypes.SIMPLE_EXPRESSION &amp;& !exp.content.trim())
<span class="linenr"> 4660: </span>  ) {
<span class="linenr"> 4661: </span>    logg(<span class=
"org-string">`transformBind v-bind no expression`</span>)
<span class="linenr"> 4662: </span>    <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 4663: </span>      props: [createObjectProperty(arg, createSimpleExpression(<span class="org-string">''</span>, <span class="org-constant">true</span>, loc))]
<span class="linenr"> 4664: </span>    }
<span class="linenr"> 4665: </span>  }
<span class="linenr"> 4666: </span>
<span class="linenr"> 4667: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 4668: </span>    props: [createObjectProperty(arg, exp)]
<span class="linenr"> 4669: </span>  }
<span class="linenr"> 4670: </span>}
<span class="linenr"> 4671: </span>
<span class="linenr"> 4672: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">injectPrefix</span> = (arg, prefix) =&gt; {
<span class="linenr"> 4673: </span>  <span class=
"org-keyword">if</span> (arg.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 4674: </span>    <span class=
"org-keyword">if</span> (arg.isStatic) {
<span class=
"linenr"> 4675: </span>      arg.content = prefix + arg.content
<span class="linenr"> 4676: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4677: </span>      arg.content = <span class=
"org-string">`\`${prefix}\${${arg.content}}\``</span>
<span class="linenr"> 4678: </span>    }
<span class="linenr"> 4679: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4680: </span>    arg.children.unshift(<span class=
"org-string">`'${prefix}' + (`</span>)
<span class=
"linenr"> 4681: </span>    arg.children.push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 4682: </span>  }
<span class="linenr"> 4683: </span>}
<span class="linenr"> 4684: </span>
<span class="linenr"> 4685: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformFor</span> = createStructuralDirectiveTransform(
<span class="linenr"> 4686: </span>  <span class=
"org-string">'for'</span>,
<span class="linenr"> 4687: </span>  (node, dir, context) =&gt; {
<span class="linenr"> 4688: </span>    <span class=
"org-keyword">const</span> { helper, removeHelper } = context
<span class="linenr"> 4689: </span>    <span class=
"org-keyword">return</span> processFor(node, dir, context, forNode =&gt; {
<span class="linenr"> 4690: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">create the loop render function expression now, and add the</span>
<span class="linenr"> 4691: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">iterator on exit after all children have been traversed</span>
<span class="linenr"> 4692: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">renderExp</span> = createCallExpression(helper(RENDER_LIST), [
<span class="linenr"> 4693: </span>        forNode.source
<span class="linenr"> 4694: </span>      ])
<span class="linenr"> 4695: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isTemplate</span> = isTemplateNode(node)
<span class="linenr"> 4696: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">memo</span> = findDir(node, <span class=
"org-string">'memo'</span>)
<span class="linenr"> 4697: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyProp</span> = findProp(node, <span class=
"org-string">`key`</span>)
<span class="linenr"> 4698: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyExp</span> =
<span class="linenr"> 4699: </span>        keyProp &amp;&
<span class=
"linenr"> 4700: </span>        (keyProp.type === NodeTypes.ATTRIBUTE
<span class=
"linenr"> 4701: </span>          ? createSimpleExpression(keyProp.value.content, <span class="org-constant">true</span>)
<span class="linenr"> 4702: </span>          : keyProp.exp)
<span class="linenr"> 4703: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyProperty</span> = keyProp ? createObjectProperty(<span class="org-string">`key`</span>, keyExp) : <span class="org-constant">null</span>
<span class="linenr"> 4704: </span>
<span class="linenr"> 4705: </span>      <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& isTemplate) {
<span class="linenr"> 4706: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#2085 / #5288 process :key and v-memo expressions need to be</span>
<span class="linenr"> 4707: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">processed on `&lt;template v-for&gt;`. In this case the node is discarded</span>
<span class="linenr"> 4708: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">and never traversed so its binding expressions won't be processed</span>
<span class="linenr"> 4709: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">by the normal transforms.</span>
<span class="linenr"> 4710: </span>        <span class=
"org-keyword">if</span> (memo) {
<span class=
"linenr"> 4711: </span>          memo.exp = processExpression(
<span class="linenr"> 4712: </span>            memo.exp ,
<span class="linenr"> 4713: </span>            context
<span class="linenr"> 4714: </span>          )
<span class="linenr"> 4715: </span>        }
<span class="linenr"> 4716: </span>        <span class=
"org-keyword">if</span> (keyProperty &amp;& keyProp.type !== NodeTypes.ATTRIBUTE) {
<span class=
"linenr"> 4717: </span>          keyProperty.value = processExpression(
<span class="linenr"> 4718: </span>            keyProperty.value ,
<span class="linenr"> 4719: </span>            context
<span class="linenr"> 4720: </span>          )
<span class="linenr"> 4721: </span>        }
<span class="linenr"> 4722: </span>      }
<span class="linenr"> 4723: </span>
<span class="linenr"> 4724: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isStableFragment</span> =
<span class=
"linenr"> 4725: </span>        forNode.source.type === NodeTypes.SIMPLE_EXPRESSION &amp;&
<span class=
"linenr"> 4726: </span>        forNode.source.constType &gt; ConstantTypes.NOT_CONSTANT
<span class="linenr"> 4727: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">fragmentFlag</span> = isStableFragment
<span class=
"linenr"> 4728: </span>        ? PatchFlags.STABLE_FRAGMENT
<span class="linenr"> 4729: </span>        : keyProp
<span class=
"linenr"> 4730: </span>        ? PatchFlags.KEYED_FRAGMENT
<span class=
"linenr"> 4731: </span>        : PatchFlags.UNKEYED_FRAGMENT
<span class="linenr"> 4732: </span>
<span class=
"linenr"> 4733: </span>      forNode.codegenNode = createVNodeCall(
<span class="linenr"> 4734: </span>        context,
<span class="linenr"> 4735: </span>        helper(FRAGMENT),
<span class="linenr"> 4736: </span>        <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4737: </span>        renderExp,
<span class="linenr"> 4738: </span>        fragmentFlag +
<span class=
"linenr"> 4739: </span>          (__DEV__ ? <span class="org-string">` /* ${PatchFlagNames[fragmentFlag]} */`</span> : <span class="org-string">``</span>),
<span class="linenr"> 4740: </span>        <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4741: </span>        <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4742: </span>        <span class=
"org-constant">true</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">isBlock</span><span class=
"org-comment-delimiter"> */</span>,
<span class=
"linenr"> 4743: </span>        !isStableFragment <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">disableTracking</span><span class=
"org-comment-delimiter"> */</span>,
<span class="linenr"> 4744: </span>        <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">isComponent</span><span class=
"org-comment-delimiter"> */</span>,
<span class="linenr"> 4745: </span>        node.loc
<span class="linenr"> 4746: </span>      )
<span class="linenr"> 4747: </span>
<span class="linenr"> 4748: </span>      <span class=
"org-keyword">return</span> () =&gt; {
<span class="linenr"> 4749: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">finish the codegen now that all children have been traversed</span>
<span class="linenr"> 4750: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">childBlock</span>
<span class="linenr"> 4751: </span>        <span class=
"org-keyword">const</span> { children } = forNode
<span class="linenr"> 4752: </span>
<span class="linenr"> 4753: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check &lt;template v-for&gt; key placement</span>
<span class="linenr"> 4754: </span>        <span class=
"org-keyword">if</span> ((__DEV__ || !__BROWSER__) &amp;& isTemplate) {
<span class=
"linenr"> 4755: </span>          node.children.some(c =&gt; {
<span class="linenr"> 4756: </span>            <span class=
"org-keyword">if</span> (c.type === NodeTypes.ELEMENT) {
<span class="linenr"> 4757: </span>              <span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> = findProp(c, <span class=
"org-string">'key'</span>)
<span class="linenr"> 4758: </span>              <span class=
"org-keyword">if</span> (key) {
<span class=
"linenr"> 4759: </span>                logg(<span class="org-string">`transformFor - key on template`</span>)
<span class="linenr"> 4760: </span>                <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 4761: </span>              }
<span class="linenr"> 4762: </span>            }
<span class="linenr"> 4763: </span>          })
<span class="linenr"> 4764: </span>        }
<span class="linenr"> 4765: </span>
<span class="linenr"> 4766: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">needFragmentWrapper</span> =
<span class=
"linenr"> 4767: </span>          children.length !== <span class=
"org-highlight-numbers-number">1</span> || children[<span class=
"org-highlight-numbers-number">0</span>].type !== NodeTypes.ELEMENT
<span class="linenr"> 4768: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">slotOutlet</span> = isSlotOutlet(node)
<span class="linenr"> 4769: </span>          ? node
<span class="linenr"> 4770: </span>          : isTemplate &amp;&
<span class=
"linenr"> 4771: </span>            node.children.length === <span class="org-highlight-numbers-number">1</span> &amp;&
<span class=
"linenr"> 4772: </span>            isSlotOutlet(node.children[<span class="org-highlight-numbers-number">0</span>])
<span class=
"linenr"> 4773: </span>          ? node.children[<span class=
"org-highlight-numbers-number">0</span>] <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">api-extractor somehow fails to infer this</span>
<span class="linenr"> 4774: </span>          : <span class=
"org-constant">null</span>
<span class="linenr"> 4775: </span>
<span class="linenr"> 4776: </span>        <span class=
"org-keyword">if</span> (slotOutlet) {
<span class="linenr"> 4777: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;slot v-for="..."&gt; or &lt;template v-for="..."&gt;&lt;slot/&gt;&lt;/template&gt;</span>
<span class=
"linenr"> 4778: </span>          childBlock = slotOutlet.codegenNode
<span class="linenr"> 4779: </span>          <span class=
"org-keyword">if</span> (isTemplate &amp;& keyProperty) {
<span class="linenr"> 4780: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;template v-for="..." :key="..."&gt;&lt;slot/&gt;&lt;/template&gt;</span>
<span class="linenr"> 4781: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we need to inject the key to the renderSlot() call.</span>
<span class="linenr"> 4782: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the props for renderSlot is passed as the 3rd argument.</span>
<span class=
"linenr"> 4783: </span>            injectProp(childBlock, keyProperty, context)
<span class="linenr"> 4784: </span>          }
<span class="linenr"> 4785: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (needFragmentWrapper) {
<span class="linenr"> 4786: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;template v-for="..."&gt; with text or multi-elements</span>
<span class="linenr"> 4787: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">should generate a fragment block for each loop</span>
<span class=
"linenr"> 4788: </span>          childBlock = createVNodeCall(
<span class="linenr"> 4789: </span>            context,
<span class="linenr"> 4790: </span>            helper(FRAGMENT),
<span class=
"linenr"> 4791: </span>            keyProperty ? createObjectExpression([keyProperty]) : <span class="org-constant">undefined</span>,
<span class="linenr"> 4792: </span>            node.children,
<span class=
"linenr"> 4793: </span>            PatchFlags.STABLE_FRAGMENT +
<span class="linenr"> 4794: </span>              (__DEV__
<span class="linenr"> 4795: </span>                ? <span class=
"org-string">` /* ${PatchFlagNames[PatchFlags.STABLE_FRAGMENT]} */`</span>
<span class="linenr"> 4796: </span>                : <span class=
"org-string">``</span>),
<span class="linenr"> 4797: </span>            <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4798: </span>            <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4799: </span>            <span class=
"org-constant">true</span>,
<span class="linenr"> 4800: </span>            <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4801: </span>            <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">isComponent</span><span class=
"org-comment-delimiter"> */</span>
<span class="linenr"> 4802: </span>          )
<span class="linenr"> 4803: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4804: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Normal element v-for. Directly use the child's codegenNode</span>
<span class="linenr"> 4805: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">but mark it as a block.</span>
<span class=
"linenr"> 4806: </span>          childBlock = children[<span class=
"org-highlight-numbers-number">0</span>].codegenNode
<span class="linenr"> 4807: </span>          <span class=
"org-keyword">if</span> (isTemplate &amp;& keyProperty) {
<span class=
"linenr"> 4808: </span>            injectProp(childBlock, keyProperty, context)
<span class="linenr"> 4809: </span>          }
<span class="linenr"> 4810: </span>          <span class=
"org-keyword">if</span> (childBlock.isBlock !== !isStableFragment) {
<span class="linenr"> 4811: </span>            <span class=
"org-keyword">if</span> (childBlock.isBlock) {
<span class="linenr"> 4812: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">switch from block to vnode</span>
<span class=
"linenr"> 4813: </span>              removeHelper(OPEN_BLOCK)
<span class="linenr"> 4814: </span>              removeHelper(
<span class=
"linenr"> 4815: </span>                getVNodeBlockHelper(context.inSSR, childBlock.isComponent)
<span class="linenr"> 4816: </span>              )
<span class="linenr"> 4817: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4818: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">switch from vnode to block</span>
<span class="linenr"> 4819: </span>              removeHelper(
<span class=
"linenr"> 4820: </span>                getVNodeHelper(context.inSSR, childBlock.isComponent)
<span class="linenr"> 4821: </span>              )
<span class="linenr"> 4822: </span>            }
<span class="linenr"> 4823: </span>          }
<span class=
"linenr"> 4824: </span>          childBlock.isBlock = !isStableFragment
<span class="linenr"> 4825: </span>          <span class=
"org-keyword">if</span> (childBlock.isBlock) {
<span class="linenr"> 4826: </span>            helper(OPEN_BLOCK)
<span class=
"linenr"> 4827: </span>            helper(getVNodeBlockHelper(context.inSSR, childBlock.isComponent))
<span class="linenr"> 4828: </span>          } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 4829: </span>            helper(getVNodeHelper(context.inSSR, childBlock.isComponent))
<span class="linenr"> 4830: </span>          }
<span class="linenr"> 4831: </span>        }
<span class="linenr"> 4832: </span>
<span class="linenr"> 4833: </span>        <span class=
"org-keyword">if</span> (memo) {
<span class="linenr"> 4834: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">loop</span> = createFunctionExpression(
<span class=
"linenr"> 4835: </span>            createForLoopParams(forNode.parseResult, [
<span class=
"linenr"> 4836: </span>              createSimpleExpression(<span class="org-string">`_cached`</span>)
<span class="linenr"> 4837: </span>            ])
<span class="linenr"> 4838: </span>          )
<span class=
"linenr"> 4839: </span>          loop.body = createBlockStatement([
<span class=
"linenr"> 4840: </span>            createCompoundExpression([<span class="org-string">`const _memo = (`</span>, memo.exp, <span class="org-string">`)`</span>]),
<span class=
"linenr"> 4841: </span>            createCompoundExpression([
<span class="linenr"> 4842: </span>              <span class=
"org-string">`if (_cached`</span>,
<span class=
"linenr"> 4843: </span>              ...(keyExp ? [<span class=
"org-string">` &amp;& _cached.key === `</span>, keyExp] : []),
<span class="linenr"> 4844: </span>              <span class=
"org-string">` &amp;& ${context.helperString(</span>
<span class="linenr"> 4845: </span><span class=
"org-string">                IS_MEMO_SAME</span>
<span class="linenr"> 4846: </span><span class=
"org-string">              )}(_cached, _memo)) return _cached`</span>
<span class="linenr"> 4847: </span>            ]),
<span class=
"linenr"> 4848: </span>            createCompoundExpression([<span class="org-string">`const _item = `</span>, childBlock]),
<span class=
"linenr"> 4849: </span>            createSimpleExpression(<span class="org-string">`_item.memo = _memo`</span>),
<span class=
"linenr"> 4850: </span>            createSimpleExpression(<span class="org-string">`return _item`</span>)
<span class="linenr"> 4851: </span>          ])
<span class="linenr"> 4852: </span>          renderExp.<span class=
"org-constant">arguments</span>.push(
<span class="linenr"> 4853: </span>            loop,
<span class=
"linenr"> 4854: </span>            createSimpleExpression(<span class="org-string">`_cache`</span>),
<span class=
"linenr"> 4855: </span>            createSimpleExpression(String(context.cached++))
<span class="linenr"> 4856: </span>          )
<span class="linenr"> 4857: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr"> 4858: </span>          renderExp.<span class=
"org-constant">arguments</span>.push(
<span class=
"linenr"> 4859: </span>            createFunctionExpression(
<span class=
"linenr"> 4860: </span>              createForLoopParams(forNode.parseResult),
<span class="linenr"> 4861: </span>              childBlock,
<span class="linenr"> 4862: </span>              <span class=
"org-constant">true</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">force newline</span><span class=
"org-comment-delimiter"> */</span>
<span class="linenr"> 4863: </span>            )
<span class="linenr"> 4864: </span>          )
<span class="linenr"> 4865: </span>        }
<span class="linenr"> 4866: </span>      }
<span class="linenr"> 4867: </span>    })
<span class="linenr"> 4868: </span>  }
<span class="linenr"> 4869: </span>)
<span class="linenr"> 4870: </span>
<span class="linenr"> 4871: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">target-agnostic transform used for both Client and SSR</span>
<span class="linenr"> 4872: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">processFor</span>(
<span class="linenr"> 4873: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 4874: </span>  <span class=
"org-variable-name">dir</span>,
<span class="linenr"> 4875: </span>  <span class=
"org-variable-name">context</span>,
<span class="linenr"> 4876: </span>  processCodegen
<span class="linenr"> 4877: </span>) {
<span class="linenr"> 4878: </span>  <span class=
"org-keyword">if</span> (!dir.exp) {
<span class="linenr"> 4879: </span>    logg(<span class=
"org-string">`processFor - dir.exp is null`</span>)
<span class="linenr"> 4880: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 4881: </span>  }
<span class="linenr"> 4882: </span>
<span class="linenr"> 4883: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parseResult</span> = parseForExpression(
<span class="linenr"> 4884: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">can only be simple expression because vFor transform is applied</span>
<span class="linenr"> 4885: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">before expression transform.</span>
<span class="linenr"> 4886: </span>    dir.exp,
<span class="linenr"> 4887: </span>    context
<span class="linenr"> 4888: </span>  )
<span class="linenr"> 4889: </span>
<span class="linenr"> 4890: </span>  <span class=
"org-keyword">if</span> (!parseResult) {
<span class="linenr"> 4891: </span>    logg(<span class=
"org-string">`processFor - parseResult is null`</span>)
<span class="linenr"> 4892: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 4893: </span>  }
<span class="linenr"> 4894: </span>
<span class="linenr"> 4895: </span>  <span class=
"org-keyword">const</span> { addIdentifiers, removeIdentifiers, scopes } = context
<span class="linenr"> 4896: </span>  <span class=
"org-keyword">const</span> { source, value, key, index } = parseResult
<span class="linenr"> 4897: </span>
<span class="linenr"> 4898: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">forNode</span> = {
<span class="linenr"> 4899: </span>    type: NodeTypes.FOR,
<span class="linenr"> 4900: </span>    loc: dir.loc,
<span class="linenr"> 4901: </span>    source,
<span class="linenr"> 4902: </span>    valueAlias: value,
<span class="linenr"> 4903: </span>    keyAlias: key,
<span class="linenr"> 4904: </span>    objectIndexAlias: index,
<span class="linenr"> 4905: </span>    parseResult,
<span class=
"linenr"> 4906: </span>    children: isTemplateNode(node) ? node.children : [node]
<span class="linenr"> 4907: </span>  }
<span class="linenr"> 4908: </span>
<span class="linenr"> 4909: </span>  context.replaceNode(forNode)
<span class="linenr"> 4910: </span>
<span class="linenr"> 4911: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">bookkeeping</span>
<span class="linenr"> 4912: </span>  scopes.vFor++
<span class="linenr"> 4913: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class="linenr"> 4914: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">scope management</span>
<span class="linenr"> 4915: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject identifiers to context</span>
<span class=
"linenr"> 4916: </span>    value &amp;& addIdentifiers(value)
<span class=
"linenr"> 4917: </span>    key &amp;& addIdentifiers(key)
<span class=
"linenr"> 4918: </span>    index &amp;& addIdentifiers(index)
<span class="linenr"> 4919: </span>  }
<span class="linenr"> 4920: </span>
<span class="linenr"> 4921: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">onExit</span> = processCodegen &amp;& processCodegen(forNode)
<span class="linenr"> 4922: </span>
<span class="linenr"> 4923: </span>  <span class=
"org-keyword">return</span> () =&gt; {
<span class="linenr"> 4924: </span>    scopes.vFor--
<span class="linenr"> 4925: </span>    <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 4926: </span>      value &amp;& removeIdentifiers(value)
<span class=
"linenr"> 4927: </span>      key &amp;& removeIdentifiers(key)
<span class=
"linenr"> 4928: </span>      index &amp;& removeIdentifiers(index)
<span class="linenr"> 4929: </span>    }
<span class="linenr"> 4930: </span>    <span class=
"org-keyword">if</span> (onExit) onExit()
<span class="linenr"> 4931: </span>  }
<span class="linenr"> 4932: </span>}
<span class="linenr"> 4933: </span>
<span class="linenr"> 4934: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">forAliasRE</span> = <span class=
"org-string">/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/</span>
<span class="linenr"> 4935: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">This regex doesn't cover the case if key or index aliases have destructuring,</span>
<span class="linenr"> 4936: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">but those do not make sense in the first place, so this works in practice.</span>
<span class="linenr"> 4937: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">forIteratorRE</span> = <span class=
"org-string">/,([^,\}\]]*)(?:,([^,\}\]]*))?$/</span>
<span class="linenr"> 4938: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">stripParensRE</span> = <span class=
"org-string">/^\(|\)$/</span>g
<span class="linenr"> 4939: </span>
<span class="linenr"> 4940: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseForExpression</span>(
<span class="linenr"> 4941: </span>  <span class=
"org-variable-name">input</span>,
<span class="linenr"> 4942: </span>  context
<span class="linenr"> 4943: </span>) {
<span class="linenr"> 4944: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">loc</span> = input.loc
<span class="linenr"> 4945: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exp</span> = input.content
<span class="linenr"> 4946: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">inMatch</span> = exp.match(forAliasRE)
<span class="linenr"> 4947: </span>  <span class=
"org-keyword">if</span> (!inMatch) <span class=
"org-keyword">return</span>
<span class="linenr"> 4948: </span>
<span class="linenr"> 4949: </span>  <span class=
"org-keyword">const</span> [, <span class=
"org-variable-name">LHS</span>, <span class=
"org-variable-name">RHS</span>] = inMatch
<span class="linenr"> 4950: </span>
<span class="linenr"> 4951: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">result</span> = {
<span class=
"linenr"> 4952: </span>    source: createAliasExpression(
<span class="linenr"> 4953: </span>      loc,
<span class="linenr"> 4954: </span>      RHS.trim(),
<span class=
"linenr"> 4955: </span>      exp.indexOf(RHS, LHS.length)
<span class="linenr"> 4956: </span>    ),
<span class="linenr"> 4957: </span>    value: <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4958: </span>    key: <span class=
"org-constant">undefined</span>,
<span class="linenr"> 4959: </span>    index: <span class=
"org-constant">undefined</span>
<span class="linenr"> 4960: </span>  }
<span class="linenr"> 4961: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 4962: </span>    result.source = processExpression(
<span class="linenr"> 4963: </span>      result.source,
<span class="linenr"> 4964: </span>      context
<span class="linenr"> 4965: </span>    )
<span class="linenr"> 4966: </span>  }
<span class="linenr"> 4967: </span>
<span class="linenr"> 4968: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">valueContent</span> = LHS.trim().replace(stripParensRE, <span class="org-string">''</span>).trim()
<span class="linenr"> 4969: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">trimmedOffset</span> = LHS.indexOf(valueContent)
<span class="linenr"> 4970: </span>
<span class="linenr"> 4971: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">iteratorMatch</span> = valueContent.match(forIteratorRE)
<span class="linenr"> 4972: </span>  <span class=
"org-keyword">if</span> (iteratorMatch) {
<span class=
"linenr"> 4973: </span>    valueContent = valueContent.replace(forIteratorRE, <span class="org-string">''</span>).trim()
<span class="linenr"> 4974: </span>
<span class="linenr"> 4975: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyContent</span> = iteratorMatch[<span class=
"org-highlight-numbers-number">1</span>].trim()
<span class="linenr"> 4976: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">keyOffset</span>
<span class="linenr"> 4977: </span>    <span class=
"org-keyword">if</span> (keyContent) {
<span class=
"linenr"> 4978: </span>      keyOffset = exp.indexOf(keyContent, trimmedOffset + valueContent.length)
<span class=
"linenr"> 4979: </span>      result.key = createAliasExpression(loc, keyContent, keyOffset)
<span class="linenr"> 4980: </span>      <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 4981: </span>        result.key = processExpression(result.key, context, <span class="org-constant">true</span>)
<span class="linenr"> 4982: </span>      }
<span class="linenr"> 4983: </span>    }
<span class="linenr"> 4984: </span>
<span class="linenr"> 4985: </span>    <span class=
"org-keyword">if</span> (iteratorMatch[<span class=
"org-highlight-numbers-number">2</span>]) {
<span class="linenr"> 4986: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">indexContent</span> = iteratorMatch[<span class="org-highlight-numbers-number">2</span>].trim()
<span class="linenr"> 4987: </span>
<span class="linenr"> 4988: </span>      <span class=
"org-keyword">if</span> (indexContent) {
<span class=
"linenr"> 4989: </span>        result.index = createAliasExpression(
<span class="linenr"> 4990: </span>          loc,
<span class="linenr"> 4991: </span>          indexContent,
<span class="linenr"> 4992: </span>          exp.indexOf(
<span class="linenr"> 4993: </span>            indexContent,
<span class="linenr"> 4994: </span>            result.key
<span class=
"linenr"> 4995: </span>              ? keyOffset + keyContent.length
<span class=
"linenr"> 4996: </span>              : trimmedOffset + valueContent.length
<span class="linenr"> 4997: </span>          )
<span class="linenr"> 4998: </span>        )
<span class="linenr"> 4999: </span>        <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 5000: </span>          result.index = processExpression(result.index, context, <span class="org-constant">true</span>)
<span class="linenr"> 5001: </span>        }
<span class="linenr"> 5002: </span>      }
<span class="linenr"> 5003: </span>    }
<span class="linenr"> 5004: </span>  }
<span class="linenr"> 5005: </span>
<span class="linenr"> 5006: </span>  <span class=
"org-keyword">if</span> (valueContent) {
<span class=
"linenr"> 5007: </span>    result.value = createAliasExpression(loc, valueContent, trimmedOffset)
<span class="linenr"> 5008: </span>    <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 5009: </span>      result.value = processExpression(result.value, context, <span class="org-constant">true</span>)
<span class="linenr"> 5010: </span>    }
<span class="linenr"> 5011: </span>  }
<span class="linenr"> 5012: </span>
<span class="linenr"> 5013: </span>  <span class=
"org-keyword">return</span> result
<span class="linenr"> 5014: </span>}
<span class="linenr"> 5015: </span>
<span class="linenr"> 5016: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createAliasExpression</span>(
<span class="linenr"> 5017: </span>  <span class=
"org-variable-name">range</span>,
<span class="linenr"> 5018: </span>  <span class=
"org-variable-name">content</span>,
<span class="linenr"> 5019: </span>  offset
<span class="linenr"> 5020: </span>) {
<span class="linenr"> 5021: </span>  <span class=
"org-keyword">return</span> createSimpleExpression(
<span class="linenr"> 5022: </span>    content,
<span class="linenr"> 5023: </span>    <span class=
"org-constant">false</span>,
<span class=
"linenr"> 5024: </span>    getInnerRange(range, offset, content.length)
<span class="linenr"> 5025: </span>  )
<span class="linenr"> 5026: </span>}
<span class="linenr"> 5027: </span>
<span class="linenr"> 5028: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createForLoopParams</span>(
<span class="linenr"> 5029: </span>  { value, key, index },
<span class="linenr"> 5030: </span>  memoArgs = []
<span class="linenr"> 5031: </span>) {
<span class="linenr"> 5032: </span>  <span class=
"org-keyword">return</span> createParamsList([value, key, index, ...memoArgs])
<span class="linenr"> 5033: </span>}
<span class="linenr"> 5034: </span>
<span class="linenr"> 5035: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createParamsList</span>(<span class=
"org-variable-name">args</span>) {
<span class="linenr"> 5036: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = args.length
<span class="linenr"> 5037: </span>  <span class=
"org-keyword">while</span> (i--) {
<span class="linenr"> 5038: </span>    <span class=
"org-keyword">if</span> (args[i]) <span class=
"org-keyword">break</span>
<span class="linenr"> 5039: </span>  }
<span class="linenr"> 5040: </span>  <span class=
"org-keyword">return</span> args
<span class="linenr"> 5041: </span>    .slice(<span class=
"org-highlight-numbers-number">0</span>, i + <span class=
"org-highlight-numbers-number">1</span>)
<span class=
"linenr"> 5042: </span>    .map((arg, i) =&gt; arg || createSimpleExpression(<span class="org-string">`_`</span>.repeat(i + <span class="org-highlight-numbers-number">1</span>), <span class="org-constant">false</span>))
<span class="linenr"> 5043: </span>}
<span class="linenr"> 5044: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">processIf</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">dir</span>, <span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">processCodegen</span>) {
<span class="linenr"> 5045: </span>  logg(<span class=
"org-string">'processIf - node - dir'</span>, node, dir)
<span class="linenr"> 5046: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 5047: </span>    dir.name !== <span class=
"org-string">'else'</span> &amp;&
<span class=
"linenr"> 5048: </span>    (!dir.exp || !dir.exp.content.trim())
<span class="linenr"> 5049: </span>  ) {
<span class="linenr"> 5050: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">loc</span> = dir.exp ? dir.exp.loc : node.loc
<span class="linenr"> 5051: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;div v-if&gt;&lt;/div&gt; 没有指令值的情况，默认值为 true</span>
<span class=
"linenr"> 5052: </span>    dir.exp = createSimpleExpression(<span class="org-string">`true`</span>, <span class="org-constant">false</span>, loc)
<span class="linenr"> 5053: </span>  }
<span class="linenr"> 5054: </span>
<span class="linenr"> 5055: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers &amp;& dir.exp) {
<span class="linenr"> 5056: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">dir.exp can only be simple expression because vIf transform is applied</span>
<span class="linenr"> 5057: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">before expression transform.</span>
<span class=
"linenr"> 5058: </span>    dir.exp = processExpression(dir.exp, context)
<span class="linenr"> 5059: </span>  }
<span class="linenr"> 5060: </span>
<span class="linenr"> 5061: </span>  <span class=
"org-keyword">if</span> (dir.name === <span class=
"org-string">'if'</span>) { <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-if</span>
<span class="linenr"> 5062: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">branch</span> = createIfBranch(node, dir)
<span class="linenr"> 5063: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ifNode</span> = {
<span class="linenr"> 5064: </span>      type: NodeTypes.IF,
<span class="linenr"> 5065: </span>      loc: node.loc,
<span class="linenr"> 5066: </span>      branches: [branch]
<span class="linenr"> 5067: </span>    }
<span class="linenr"> 5068: </span>    context.replaceNode(ifNode)
<span class="linenr"> 5069: </span>    <span class=
"org-keyword">if</span> (processCodegen) {
<span class="linenr"> 5070: </span>      <span class=
"org-keyword">return</span> processCodegen(ifNode, branch, <span class="org-constant">true</span>)
<span class="linenr"> 5071: </span>    }
<span class="linenr"> 5072: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5073: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">locate the adjacent v-if</span>
<span class="linenr"> 5074: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">siblings</span> = context.parent.children
<span class="linenr"> 5075: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">comments</span> = []
<span class="linenr"> 5076: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = siblings.indexOf(node)
<span class="linenr"> 5077: </span>    <span class=
"org-keyword">while</span> (i-- &gt;= -<span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 5078: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">sibling</span> = siblings[i]
<span class="linenr"> 5079: </span>
<span class="linenr"> 5080: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">空行，空文本</span>
<span class="linenr"> 5081: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr"> 5082: </span>        sibling &amp;&
<span class=
"linenr"> 5083: </span>        sibling.type === NodeTypes.TEXT &amp;&
<span class=
"linenr"> 5084: </span>        !sibling.content.trim().length
<span class="linenr"> 5085: </span>      ) {
<span class=
"linenr"> 5086: </span>        context.removeNode(sibling)
<span class="linenr"> 5087: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 5088: </span>      }
<span class="linenr"> 5089: </span>
<span class="linenr"> 5090: </span>      <span class=
"org-keyword">if</span> (sibling &amp;& sibling.type === NodeTypes.IF) {
<span class="linenr"> 5091: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">这里会将原本的结点删除，而是用新组装的 if 结构(包含else-if, else 分支的结构，node.branches[...])</span>
<span class="linenr"> 5092: </span>        context.removeNode()
<span class="linenr"> 5093: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">branch</span> = createIfBranch(node, dir)
<span class=
"linenr"> 5094: </span>        sibling.branches.push(branch)
<span class="linenr"> 5095: </span>
<span class="linenr"> 5096: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">onExit</span> = processCodegen &amp;& processCodegen(sibling, branch, <span class="org-constant">false</span>)
<span class="linenr"> 5097: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">这里需要手动触发一次遍历，因为上面将原本的分支节点从原来的节点树中删除了</span>
<span class=
"linenr"> 5098: </span>        traverseNode(branch, context)
<span class="linenr"> 5099: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">回溯结束后执行收集到的 transformXxx 函数</span>
<span class="linenr"> 5100: </span>        <span class=
"org-keyword">if</span> (onExit) onExit()
<span class="linenr"> 5101: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">make sure to reset currentNode after traversal to indicate this</span>
<span class="linenr"> 5102: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">node has been removed.</span>
<span class=
"linenr"> 5103: </span>        context.currentNode = <span class=
"org-constant">null</span>
<span class="linenr"> 5104: </span>      }
<span class="linenr"> 5105: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 5106: </span>    }
<span class="linenr"> 5107: </span>  }
<span class="linenr"> 5108: </span>}
<span class="linenr"> 5109: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createIfBranch</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">dir</span>) {
<span class="linenr"> 5110: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 5111: </span>    type: NodeTypes.IF_BRANCH,
<span class="linenr"> 5112: </span>    loc: node.loc,
<span class=
"linenr"> 5113: </span>    condition: dir.name === <span class=
"org-string">'else'</span> ? <span class=
"org-constant">undefined</span> : dir.exp,
<span class="linenr"> 5114: </span>    children:
<span class=
"linenr"> 5115: </span>      node.tagType === ElementTypes.TEMPLATE &amp;& !findDir(node, <span class="org-string">'for'</span>)
<span class="linenr"> 5116: </span>        ? node.children
<span class="linenr"> 5117: </span>        : [node],
<span class=
"linenr"> 5118: </span>    userKey: findProp(node, <span class=
"org-string">`key`</span>)
<span class="linenr"> 5119: </span>  }
<span class="linenr"> 5120: </span>}
<span class="linenr"> 5121: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createCodegenNodeForBranch</span>(<span class=
"org-variable-name">branch</span>, <span class=
"org-variable-name">keyIndex</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 5122: </span>  <span class=
"org-keyword">if</span> (branch.condition) {
<span class="linenr"> 5123: </span>    <span class=
"org-keyword">return</span> createConditionalExpression(
<span class="linenr"> 5124: </span>      branch.condition,
<span class=
"linenr"> 5125: </span>      createChildrenCodegenNode(branch, keyIndex, context),
<span class="linenr"> 5126: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">这里是考虑到只有 v-if 的情况，因为 v-if 指令最后都会被解析成三目运算符形式</span>
<span class="linenr"> 5127: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">如： &lt;div v-if="foo"/&gt;&lt;div v-else/&gt; =&gt; foo ? ... : ...</span>
<span class="linenr"> 5128: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">如： &lt;div v-if="foo"/&gt;&lt;div v-else-if="bar"/&gt;&lt;div v-else/&gt; =&gt; foo ? ... : bar ? ... : ...</span>
<span class="linenr"> 5129: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">所以必需得要有一个 v-else，如果没有的话就相当于是 `foo ? ...` 这样的语句是不合法的</span>
<span class="linenr"> 5130: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">因此这里在判断没有 v-else 分支的情况时默认给它创建了个注释节点</span>
<span class=
"linenr"> 5131: </span>      createCallExpression(context.helper(CREATE_COMMENT), [
<span class="linenr"> 5132: </span>        __DEV__ ? <span class=
"org-string">'"v-if"'</span> : <span class=
"org-string">'""'</span>,
<span class="linenr"> 5133: </span>        <span class=
"org-string">'true'</span>
<span class="linenr"> 5134: </span>      ])
<span class="linenr"> 5135: </span>    )
<span class="linenr"> 5136: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5137: </span>    <span class=
"org-keyword">return</span> createChildrenCodegenNode(branch, keyIndex, context)
<span class="linenr"> 5138: </span>  }
<span class="linenr"> 5139: </span>}
<span class="linenr"> 5140: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createChildrenCodegenNode</span>(<span class=
"org-variable-name">branch</span>, <span class=
"org-variable-name">keyIndex</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 5141: </span>  <span class=
"org-keyword">const</span> { helper } = context
<span class="linenr"> 5142: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyProperty</span> = createObjectProperty(
<span class="linenr"> 5143: </span>    <span class=
"org-string">`key`</span>,
<span class="linenr"> 5144: </span>    createSimpleExpression(
<span class="linenr"> 5145: </span>      <span class=
"org-string">`${keyIndex}`</span>,
<span class="linenr"> 5146: </span>      <span class=
"org-constant">false</span>,
<span class="linenr"> 5147: </span>      locStub,
<span class="linenr"> 5148: </span>      ConstantTypes.CAN_HOIST
<span class="linenr"> 5149: </span>    )
<span class="linenr"> 5150: </span>  )
<span class="linenr"> 5151: </span>  <span class=
"org-keyword">const</span> { children } = branch
<span class="linenr"> 5152: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">firstChild</span> = children[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 5153: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">needFragmentWrapper</span> =
<span class=
"linenr"> 5154: </span>    children.length !== <span class=
"org-highlight-numbers-number">1</span> || firstChild.type !== NodeTypes.ELEMENT
<span class="linenr"> 5155: </span>  <span class=
"org-keyword">if</span> (needFragmentWrapper) {
<span class="linenr"> 5156: </span>    <span class=
"org-keyword">if</span> (children.length === <span class=
"org-highlight-numbers-number">1</span> &amp;& firstChild.type === NodeTypes.FOR) {
<span class="linenr"> 5157: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">optimize away nested fragments when child is a ForNode</span>
<span class="linenr"> 5158: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">vnodeCall</span> = firstChild.codegenNode
<span class=
"linenr"> 5159: </span>      injectProp(vnodeCall, keyProperty, context)
<span class="linenr"> 5160: </span>      <span class=
"org-keyword">return</span> vnodeCall
<span class="linenr"> 5161: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5162: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">patchFlag</span> = PatchFlags.STABLE_FRAGMENT
<span class="linenr"> 5163: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">patchFlagText</span> = PatchFlagNames[PatchFlags.STABLE_FRAGMENT]
<span class="linenr"> 5164: </span>
<span class="linenr"> 5165: </span>      <span class=
"org-keyword">return</span> createVNodeCall(
<span class="linenr"> 5166: </span>        context,
<span class="linenr"> 5167: </span>        helper(FRAGMENT),
<span class=
"linenr"> 5168: </span>        createObjectExpression([keyProperty]),
<span class="linenr"> 5169: </span>        children,
<span class=
"linenr"> 5170: </span>        patchFlag + (__DEV__ ? <span class=
"org-string">` /* ${patchFlagText} */`</span> : <span class=
"org-string">``</span>),
<span class="linenr"> 5171: </span>        <span class=
"org-constant">undefined</span>,
<span class="linenr"> 5172: </span>        <span class=
"org-constant">undefined</span>,
<span class="linenr"> 5173: </span>        <span class=
"org-constant">true</span>,
<span class="linenr"> 5174: </span>        <span class=
"org-constant">false</span>,
<span class="linenr"> 5175: </span>        <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">isComponent</span><span class=
"org-comment-delimiter"> */</span>,
<span class="linenr"> 5176: </span>        branch.loc
<span class="linenr"> 5177: </span>      )
<span class="linenr"> 5178: </span>    }
<span class="linenr"> 5179: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5180: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ret</span> = firstChild.codegenNode
<span class="linenr"> 5181: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">vnodeCall</span> = getMemoedVNodeCall(ret)
<span class="linenr"> 5182: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Change createVNode to createBlock.</span>
<span class="linenr"> 5183: </span>    <span class=
"org-keyword">if</span> (vnodeCall.type === NodeTypes.VNODE_CALL) {
<span class=
"linenr"> 5184: </span>      makeBlock(vnodeCall, context)
<span class="linenr"> 5185: </span>    }
<span class="linenr"> 5186: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject branch key</span>
<span class=
"linenr"> 5187: </span>    injectProp(vnodeCall, keyProperty, context)
<span class="linenr"> 5188: </span>    <span class=
"org-keyword">return</span> ret
<span class="linenr"> 5189: </span>  }
<span class="linenr"> 5190: </span>}
<span class="linenr"> 5191: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isSameKey</span>(<span class=
"org-variable-name">a</span>, <span class=
"org-variable-name">b</span>) {
<span class="linenr"> 5192: </span>  <span class=
"org-keyword">if</span> (!a || a.type !== b.type) {
<span class="linenr"> 5193: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 5194: </span>  }
<span class="linenr"> 5195: </span>  <span class=
"org-keyword">if</span> (a.type === NodeTypes.ATTRIBUTE) {
<span class="linenr"> 5196: </span>    <span class=
"org-keyword">if</span> (a.value.content !== b.value.content) {
<span class="linenr"> 5197: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 5198: </span>    }
<span class="linenr"> 5199: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5200: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">directive</span>
<span class="linenr"> 5201: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exp</span> = a.exp
<span class="linenr"> 5202: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">branchExp</span> = b.exp
<span class="linenr"> 5203: </span>    <span class=
"org-keyword">if</span> (exp.type !== branchExp.type) {
<span class="linenr"> 5204: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 5205: </span>    }
<span class="linenr"> 5206: </span>    <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 5207: </span>      exp.type !== NodeTypes.SIMPLE_EXPRESSION ||
<span class=
"linenr"> 5208: </span>      exp.isStatic !== branchExp.isStatic ||
<span class=
"linenr"> 5209: </span>      exp.content !== branchExp.content
<span class="linenr"> 5210: </span>    ) {
<span class="linenr"> 5211: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 5212: </span>    }
<span class="linenr"> 5213: </span>  }
<span class="linenr"> 5214: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 5215: </span>}
<span class="linenr"> 5216: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getParentCondition</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr"> 5217: </span>  <span class=
"org-keyword">while</span> (<span class=
"org-constant">true</span>) {
<span class="linenr"> 5218: </span>    <span class=
"org-keyword">if</span> (node.type === NodeTypes.JS_CONDITIONAL_EXPRESSION) {
<span class="linenr"> 5219: </span>      <span class=
"org-keyword">if</span> (node.alternate.type === NodeTypes.JS_CONDITIONAL_EXPRESSION) {
<span class="linenr"> 5220: </span>        node = node.alternate
<span class="linenr"> 5221: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5222: </span>        <span class=
"org-keyword">return</span> node
<span class="linenr"> 5223: </span>      }
<span class="linenr"> 5224: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === NodeTypes.JS_CACHE_EXPRESSION) {
<span class="linenr"> 5225: </span>      node = node.value
<span class="linenr"> 5226: </span>    }
<span class="linenr"> 5227: </span>  }
<span class="linenr"> 5228: </span>}
<span class="linenr"> 5229: </span>
<span class="linenr"> 5230: </span>
<span class="linenr"> 5231: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformIf</span> = createStructuralDirectiveTransform(
<span class="linenr"> 5232: </span>  <span class=
"org-string">/^(if|else|else-if)$/</span>,
<span class="linenr"> 5233: </span>  (node, dir, context) =&gt; {
<span class="linenr"> 5234: </span>    <span class=
"org-keyword">return</span> processIf(node, dir, context, (ifNode, branch, isRoot) =&gt; {
<span class="linenr"> 5235: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">siblings</span> = context.parent.children
<span class="linenr"> 5236: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if...else if...else 都处于同级渲染</span>
<span class="linenr"> 5237: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = siblings.indexOf(ifNode)
<span class="linenr"> 5238: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">key</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 5239: </span>      <span class=
"org-keyword">while</span> (i-- &gt;= <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 5240: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">sibling</span> = siblings[i]
<span class="linenr"> 5241: </span>        <span class=
"org-keyword">if</span> (sibling &amp;& sibling.type === NodeTypes.IF) {
<span class=
"linenr"> 5242: </span>          key += sibling.branches.length
<span class="linenr"> 5243: </span>        }
<span class="linenr"> 5244: </span>      }
<span class="linenr"> 5245: </span>
<span class="linenr"> 5246: </span>      logg(<span class=
"org-string">'transformIf'</span>, ifNode, { isRoot, branch })
<span class="linenr"> 5247: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">退出时的回调，当所有 children 被遍历转换完成时被调用生成 codegenNode</span>
<span class="linenr"> 5248: </span>      <span class=
"org-keyword">return</span> () =&gt; {
<span class="linenr"> 5249: </span>        <span class=
"org-keyword">if</span> (isRoot) { <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-if</span>
<span class=
"linenr"> 5250: </span>          ifNode.codegenNode = createCodegenNodeForBranch(
<span class="linenr"> 5251: </span>            branch, key, context
<span class="linenr"> 5252: </span>          )
<span class="linenr"> 5253: </span>          logg(<span class=
"org-string">'transformIf - isRoot - v-if'</span>, ifNode)
<span class="linenr"> 5254: </span>        } <span class=
"org-keyword">else</span> { <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-else, v-else-if</span>
<span class="linenr"> 5255: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">将 v-else-* 分枝挂到 v-if 节点下面</span>
<span class="linenr"> 5256: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parentCondition</span> = getParentCondition(ifNode.codegenNode)
<span class=
"linenr"> 5257: </span>          parentCondition.alternate = createCodegenNodeForBranch(
<span class=
"linenr"> 5258: </span>            branch, key + ifNode.branches.length - <span class="org-highlight-numbers-number">1</span>,
<span class="linenr"> 5259: </span>            context
<span class="linenr"> 5260: </span>          )
<span class="linenr"> 5261: </span>          logg(<span class=
"org-string">'transformIf - v-else-*'</span>, ifNode)
<span class="linenr"> 5262: </span>        }
<span class="linenr"> 5263: </span>      }
<span class="linenr"> 5264: </span>
<span class="linenr"> 5265: </span>    })
<span class="linenr"> 5266: </span>  }
<span class="linenr"> 5267: </span>)
<span class="linenr"> 5268: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">memoSeen</span> = <span class=
"org-keyword">new</span> <span class="org-type">WeakSet</span>()
<span class="linenr"> 5269: </span>
<span class="linenr"> 5270: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformMemo</span> = (node, context) =&gt; {
<span class="linenr"> 5271: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.ELEMENT) {
<span class="linenr"> 5272: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">dir</span> = findDir(node, <span class=
"org-string">'memo'</span>)
<span class="linenr"> 5273: </span>    <span class=
"org-keyword">if</span> (!dir || memoSeen.has(node)) {
<span class="linenr"> 5274: </span>      <span class=
"org-keyword">return</span>
<span class="linenr"> 5275: </span>    }
<span class="linenr"> 5276: </span>    memoSeen.add(node)
<span class="linenr"> 5277: </span>    <span class=
"org-keyword">return</span> () =&gt; {
<span class="linenr"> 5278: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">codegenNode</span> = node.codegenNode || context.currentNode.codegenNode
<span class="linenr"> 5279: </span>      <span class=
"org-keyword">if</span> (codegenNode &amp;& codegenNode.type === NodeTypes.VNODE_CALL) {
<span class="linenr"> 5280: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">non-component sub tree should be turned into a block</span>
<span class="linenr"> 5281: </span>        <span class=
"org-keyword">if</span> (node.tagType !== ElementTypes.COMPONENT) {
<span class=
"linenr"> 5282: </span>          makeBlock(codegenNode, context)
<span class="linenr"> 5283: </span>        }
<span class=
"linenr"> 5284: </span>        node.codegenNode = createCallExpression(context.helper(WITH_MEMO), [
<span class="linenr"> 5285: </span>          dir.exp,
<span class=
"linenr"> 5286: </span>          createFunctionExpression(<span class="org-constant">undefined</span>, codegenNode),
<span class="linenr"> 5287: </span>          <span class=
"org-string">`_cache`</span>,
<span class=
"linenr"> 5288: </span>          String(context.cached++)
<span class="linenr"> 5289: </span>        ])
<span class="linenr"> 5290: </span>      }
<span class="linenr"> 5291: </span>    }
<span class="linenr"> 5292: </span>  }
<span class="linenr"> 5293: </span>}
<span class="linenr"> 5294: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformModel</span> = (dir, node, context) =&gt; {
<span class="linenr"> 5295: </span>  <span class=
"org-keyword">const</span> { exp, arg } = dir
<span class="linenr"> 5296: </span>  <span class=
"org-keyword">if</span> (!exp) {
<span class="linenr"> 5297: </span>    logg(<span class=
"org-string">`transformModel no exp`</span>)
<span class="linenr"> 5298: </span>    <span class=
"org-keyword">return</span> createTransformProps()
<span class="linenr"> 5299: </span>  }
<span class="linenr"> 5300: </span>
<span class="linenr"> 5301: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rawExp</span> = exp.loc.source
<span class="linenr"> 5302: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">expString</span> =
<span class=
"linenr"> 5303: </span>    exp.type === NodeTypes.SIMPLE_EXPRESSION ? exp.content : rawExp
<span class="linenr"> 5304: </span>
<span class="linenr"> 5305: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">im SFC &lt;script setup&gt; inline mode, the exp may have been transformed into</span>
<span class="linenr"> 5306: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">_unref(exp)</span>
<span class="linenr"> 5307: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bindingType</span> = context.bindingMetadata[rawExp]
<span class="linenr"> 5308: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">maybeRef</span> =
<span class="linenr"> 5309: </span>    !__BROWSER__ &amp;&
<span class="linenr"> 5310: </span>    context.inline &amp;&
<span class="linenr"> 5311: </span>    bindingType &amp;&
<span class=
"linenr"> 5312: </span>    bindingType !== BindingTypes.SETUP_CONST
<span class="linenr"> 5313: </span>
<span class="linenr"> 5314: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 5315: </span>    !expString.trim() ||
<span class=
"linenr"> 5316: </span>    (!isMemberExpression(expString, context) &amp;& !maybeRef)
<span class="linenr"> 5317: </span>  ) {
<span class="linenr"> 5318: </span>    <span class=
"org-keyword">return</span> createTransformProps()
<span class="linenr"> 5319: </span>  }
<span class="linenr"> 5320: </span>
<span class="linenr"> 5321: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 5322: </span>    !__BROWSER__ &amp;&
<span class=
"linenr"> 5323: </span>    context.prefixIdentifiers &amp;&
<span class=
"linenr"> 5324: </span>    isSimpleIdentifier(expString) &amp;&
<span class=
"linenr"> 5325: </span>    context.identifiers[expString]
<span class="linenr"> 5326: </span>  ) {
<span class="linenr"> 5327: </span>    <span class=
"org-keyword">return</span> createTransformProps()
<span class="linenr"> 5328: </span>  }
<span class="linenr"> 5329: </span>
<span class="linenr"> 5330: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">propName</span> = arg ? arg : createSimpleExpression(<span class="org-string">'modelValue'</span>, <span class="org-constant">true</span>)
<span class="linenr"> 5331: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">eventName</span> = arg
<span class="linenr"> 5332: </span>    ? isStaticExp(arg)
<span class="linenr"> 5333: </span>      ? <span class=
"org-string">`onUpdate:${arg.content}`</span>
<span class=
"linenr"> 5334: </span>      : createCompoundExpression([<span class="org-string">'"onUpdate:" + '</span>, arg])
<span class="linenr"> 5335: </span>    : <span class=
"org-string">`onUpdate:modelValue`</span>
<span class="linenr"> 5336: </span>
<span class="linenr"> 5337: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">assignmentExp</span>
<span class="linenr"> 5338: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">eventArg</span> = context.isTS ? <span class=
"org-string">`($event: any)`</span> : <span class=
"org-string">`$event`</span>
<span class="linenr"> 5339: </span>  <span class=
"org-keyword">if</span> (maybeRef) {
<span class="linenr"> 5340: </span>    <span class=
"org-keyword">if</span> (bindingType === BindingTypes.SETUP_REF) {
<span class="linenr"> 5341: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-model used on known ref.</span>
<span class=
"linenr"> 5342: </span>      assignmentExp = createCompoundExpression([
<span class="linenr"> 5343: </span>        <span class=
"org-string">`${eventArg} =&gt; ((`</span>,
<span class=
"linenr"> 5344: </span>        createSimpleExpression(rawExp, <span class="org-constant">false</span>, exp.loc),
<span class="linenr"> 5345: </span>        <span class=
"org-string">`).value = $event)`</span>
<span class="linenr"> 5346: </span>      ])
<span class="linenr"> 5347: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5348: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-model used on a potentially ref binding in &lt;script setup&gt; inline mode.</span>
<span class="linenr"> 5349: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the assignment needs to check whether the binding is actually a ref.</span>
<span class="linenr"> 5350: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">altAssignment</span> =
<span class=
"linenr"> 5351: </span>        bindingType === BindingTypes.SETUP_LET ? <span class="org-string">`${rawExp} = $event`</span> : <span class="org-string">`null`</span>
<span class=
"linenr"> 5352: </span>      assignmentExp = createCompoundExpression([
<span class="linenr"> 5353: </span>        <span class=
"org-string">`${eventArg} =&gt; (${context.helperString(IS_REF)}(${rawExp}) ? (`</span>,
<span class=
"linenr"> 5354: </span>        createSimpleExpression(rawExp, <span class="org-constant">false</span>, exp.loc),
<span class="linenr"> 5355: </span>        <span class=
"org-string">`).value = $event : ${altAssignment})`</span>
<span class="linenr"> 5356: </span>      ])
<span class="linenr"> 5357: </span>    }
<span class="linenr"> 5358: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 5359: </span>    assignmentExp = createCompoundExpression([
<span class="linenr"> 5360: </span>      <span class=
"org-string">`${eventArg} =&gt; ((`</span>,
<span class="linenr"> 5361: </span>      exp,
<span class="linenr"> 5362: </span>      <span class=
"org-string">`) = $event)`</span>
<span class="linenr"> 5363: </span>    ])
<span class="linenr"> 5364: </span>  }
<span class="linenr"> 5365: </span>
<span class="linenr"> 5366: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">props</span> = [
<span class="linenr"> 5367: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">modelValue: foo</span>
<span class=
"linenr"> 5368: </span>    createObjectProperty(propName, dir.exp),
<span class="linenr"> 5369: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">"onUpdate:modelValue": $event =&gt; (foo = $event)</span>
<span class=
"linenr"> 5370: </span>    createObjectProperty(eventName, assignmentExp)
<span class="linenr"> 5371: </span>  ]
<span class="linenr"> 5372: </span>
<span class="linenr"> 5373: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">cache v-model handler if applicable (when it doesn't refer any scope vars)</span>
<span class="linenr"> 5374: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 5375: </span>    !__BROWSER__ &amp;&
<span class=
"linenr"> 5376: </span>    context.prefixIdentifiers &amp;&
<span class="linenr"> 5377: </span>    !context.inVOnce &amp;&
<span class="linenr"> 5378: </span>    context.cacheHandlers &amp;&
<span class=
"linenr"> 5379: </span>    !hasScopeRef(exp, context.identifiers)
<span class="linenr"> 5380: </span>  ) {
<span class="linenr"> 5381: </span>    props[<span class=
"org-highlight-numbers-number">1</span>].value = context.cache(props[<span class="org-highlight-numbers-number">1</span>].value)
<span class="linenr"> 5382: </span>  }
<span class="linenr"> 5383: </span>
<span class="linenr"> 5384: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">modelModifiers: { foo: true, "bar-baz": true }</span>
<span class="linenr"> 5385: </span>  <span class=
"org-keyword">if</span> (dir.modifiers.length &amp;& node.tagType === ElementTypes.COMPONENT) {
<span class="linenr"> 5386: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">modifiers</span> = dir.modifiers
<span class=
"linenr"> 5387: </span>      .map(m =&gt; (isSimpleIdentifier(m) ? m : JSON.stringify(m)) + <span class="org-string">`: true`</span>)
<span class="linenr"> 5388: </span>      .join(<span class=
"org-string">`, `</span>)
<span class="linenr"> 5389: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">modifiersKey</span> = arg
<span class="linenr"> 5390: </span>      ? isStaticExp(arg)
<span class="linenr"> 5391: </span>        ? <span class=
"org-string">`${arg.content}Modifiers`</span>
<span class=
"linenr"> 5392: </span>        : createCompoundExpression([arg, <span class="org-string">' + "Modifiers"'</span>])
<span class="linenr"> 5393: </span>      : <span class=
"org-string">`modelModifiers`</span>
<span class="linenr"> 5394: </span>    props.push(
<span class="linenr"> 5395: </span>      createObjectProperty(
<span class="linenr"> 5396: </span>        modifiersKey,
<span class="linenr"> 5397: </span>        createSimpleExpression(
<span class="linenr"> 5398: </span>          <span class=
"org-string">`{ ${modifiers} }`</span>,
<span class="linenr"> 5399: </span>          <span class=
"org-constant">false</span>,
<span class="linenr"> 5400: </span>          dir.loc,
<span class=
"linenr"> 5401: </span>          ConstantTypes.CAN_HOIST
<span class="linenr"> 5402: </span>        )
<span class="linenr"> 5403: </span>      )
<span class="linenr"> 5404: </span>    )
<span class="linenr"> 5405: </span>  }
<span class="linenr"> 5406: </span>
<span class="linenr"> 5407: </span>  <span class=
"org-keyword">return</span> createTransformProps(props)
<span class="linenr"> 5408: </span>}
<span class="linenr"> 5409: </span>
<span class="linenr"> 5410: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createTransformProps</span>(<span class=
"org-variable-name">props</span> = []) {
<span class="linenr"> 5411: </span>  <span class=
"org-keyword">return</span> { props }
<span class="linenr"> 5412: </span>}
<span class="linenr"> 5413: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">函数表达式正则, @click="fnExp"</span>
<span class="linenr"> 5414: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">fnExpRE</span> =
<span class="linenr"> 5415: </span>  <span class=
"org-string">/^\s*([\w$_]+|(async\s*)?\([^)]*?\))\s*=&gt;|^\s*(async\s+)?function(?:\s+[\w$]+)?\s*\(/</span>
<span class="linenr"> 5416: </span>
<span class="linenr"> 5417: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformOn</span> = (
<span class="linenr"> 5418: </span>  dir,
<span class="linenr"> 5419: </span>  node,
<span class="linenr"> 5420: </span>  context,
<span class="linenr"> 5421: </span>  augmentor
<span class="linenr"> 5422: </span>) =&gt; {
<span class="linenr"> 5423: </span>  <span class=
"org-keyword">const</span> { loc, modifiers, arg } = dir
<span class="linenr"> 5424: </span>
<span class="linenr"> 5425: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">eventName</span>
<span class="linenr"> 5426: </span>  <span class=
"org-keyword">if</span> (arg.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 5427: </span>    <span class=
"org-keyword">if</span> (arg.isStatic) {
<span class="linenr"> 5428: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">rawName</span> = arg.content
<span class="linenr"> 5429: </span>
<span class="linenr"> 5430: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">将事件名转成驼峰式</span>
<span class=
"linenr"> 5431: </span>      eventName = createSimpleExpression(
<span class=
"linenr"> 5432: </span>        toHandlerKey(camelize(rawName)),
<span class="linenr"> 5433: </span>        <span class=
"org-constant">true</span>,
<span class="linenr"> 5434: </span>        arg.loc
<span class="linenr"> 5435: </span>      )
<span class="linenr"> 5436: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5437: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#2388 toHandlerKey 将事件名转成 onXxx, 如：eventName -&gt; onEventName</span>
<span class=
"linenr"> 5438: </span>      eventName = createCompoundExpression([
<span class="linenr"> 5439: </span>        <span class=
"org-string">`${context.helperString(TO_HANDLER_KEY)}(`</span>,
<span class="linenr"> 5440: </span>        arg,
<span class="linenr"> 5441: </span>        <span class=
"org-string">`)`</span>
<span class="linenr"> 5442: </span>      ])
<span class="linenr"> 5443: </span>    }
<span class="linenr"> 5444: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5445: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">already a compound expression.</span>
<span class="linenr"> 5446: </span>
<span class="linenr"> 5447: </span>    eventName = arg
<span class=
"linenr"> 5448: </span>    eventName.children.unshift(<span class=
"org-string">`${context.helperString(TO_HANDLER_KEY)}(`</span>)
<span class=
"linenr"> 5449: </span>    eventName.children.push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 5450: </span>  }
<span class="linenr"> 5451: </span>
<span class="linenr"> 5452: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">handler processing, 事件表达式内容</span>
<span class="linenr"> 5453: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">exp</span> = dir.exp
<span class="linenr"> 5454: </span>  <span class=
"org-keyword">if</span> (exp &amp;& !exp.content.trim()) {
<span class="linenr"> 5455: </span>    exp = <span class=
"org-constant">undefined</span>
<span class="linenr"> 5456: </span>  }
<span class="linenr"> 5457: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">事件处理函数缓存</span>
<span class="linenr"> 5458: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">shouldCache</span> = context.cacheHandlers &amp;& !exp &amp;& !context.inVOnce
<span class="linenr"> 5459: </span>  <span class=
"org-keyword">if</span> (exp) {
<span class="linenr"> 5460: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isMemberExp</span> = isMemberExpression(exp.content, context)
<span class="linenr"> 5461: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isInlineStatement</span> = !(isMemberExp || fnExpRE.test(exp.content))
<span class="linenr"> 5462: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hasMultipleStatements</span> = exp.content.includes(<span class="org-string">`;`</span>)
<span class="linenr"> 5463: </span>
<span class="linenr"> 5464: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">process the expression since it's been skipped</span>
<span class="linenr"> 5465: </span>    <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.prefixIdentifiers) {
<span class=
"linenr"> 5466: </span>      isInlineStatement &amp;& context.addIdentifiers(<span class="org-string">`$event`</span>)
<span class=
"linenr"> 5467: </span>      exp = dir.exp = processExpression(
<span class="linenr"> 5468: </span>        exp,
<span class="linenr"> 5469: </span>        context,
<span class="linenr"> 5470: </span>        <span class=
"org-constant">false</span>,
<span class="linenr"> 5471: </span>        hasMultipleStatements
<span class="linenr"> 5472: </span>      )
<span class=
"linenr"> 5473: </span>      isInlineStatement &amp;& context.removeIdentifiers(<span class="org-string">`$event`</span>)
<span class="linenr"> 5474: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">with scope analysis, the function is hoistable if it has no reference</span>
<span class="linenr"> 5475: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">to scope variables.</span>
<span class="linenr"> 5476: </span>      shouldCache =
<span class=
"linenr"> 5477: </span>        context.cacheHandlers &amp;&
<span class="linenr"> 5478: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">unnecessary to cache inside v-once</span>
<span class="linenr"> 5479: </span>        !context.inVOnce &amp;&
<span class="linenr"> 5480: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">runtime constants don't need to be cached</span>
<span class="linenr"> 5481: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">(this is analyzed by compileScript in SFC &lt;script setup&gt;)</span>
<span class=
"linenr"> 5482: </span>        !(exp.type === NodeTypes.SIMPLE_EXPRESSION &amp;& exp.constType &gt; <span class="org-highlight-numbers-number">0</span>) &amp;&
<span class="linenr"> 5483: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#1541 bail if this is a member exp handler passed to a component -</span>
<span class="linenr"> 5484: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we need to use the original function to preserve arity,</span>
<span class="linenr"> 5485: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">e.g. &lt;transition&gt; relies on checking cb.length to determine</span>
<span class="linenr"> 5486: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">transition end handling. Inline function is ok since its arity</span>
<span class="linenr"> 5487: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">is preserved even when cached.</span>
<span class=
"linenr"> 5488: </span>        !(isMemberExp &amp;& node.tagType === ElementTypes.COMPONENT) &amp;&
<span class="linenr"> 5489: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">bail if the function references closure variables (v-for, v-slot)</span>
<span class="linenr"> 5490: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">it must be passed fresh to avoid stale values.</span>
<span class=
"linenr"> 5491: </span>        !hasScopeRef(exp, context.identifiers)
<span class="linenr"> 5492: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">If the expression is optimizable and is a member expression pointing</span>
<span class="linenr"> 5493: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">to a function, turn it into invocation (and wrap in an arrow function</span>
<span class="linenr"> 5494: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">below) so that it always accesses the latest value when called - thus</span>
<span class="linenr"> 5495: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">avoiding the need to be patched.</span>
<span class="linenr"> 5496: </span>      <span class=
"org-keyword">if</span> (shouldCache &amp;& isMemberExp) {
<span class="linenr"> 5497: </span>        <span class=
"org-keyword">if</span> (exp.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class=
"linenr"> 5498: </span>          exp.content = <span class=
"org-string">`${exp.content} &amp;& ${exp.content}(...args)`</span>
<span class="linenr"> 5499: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 5500: </span>          exp.children = [...exp.children, <span class="org-string">` &amp;& `</span>, ...exp.children, <span class="org-string">`(...args)`</span>]
<span class="linenr"> 5501: </span>        }
<span class="linenr"> 5502: </span>      }
<span class="linenr"> 5503: </span>    }
<span class="linenr"> 5504: </span>
<span class="linenr"> 5505: </span>    <span class=
"org-keyword">if</span> (isInlineStatement || (shouldCache &amp;& isMemberExp)) {
<span class="linenr"> 5506: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">wrap inline statement in a function expression</span>
<span class="linenr"> 5507: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">($event) =&gt; statement</span>
<span class="linenr"> 5508: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">(...args) =&gt; { statement1;statement2 }</span>
<span class=
"linenr"> 5509: </span>      exp = createCompoundExpression([
<span class="linenr"> 5510: </span>        <span class=
"org-string">`${</span>
<span class="linenr"> 5511: </span><span class=
"org-string">          isInlineStatement</span>
<span class="linenr"> 5512: </span><span class=
"org-string">            ? `</span>$event<span class=
"org-string">`</span>
<span class="linenr"> 5513: </span><span class=
"org-string">            : `</span>(...args)<span class=
"org-string">`</span>
<span class="linenr"> 5514: </span><span class=
"org-string">        } =&gt; ${hasMultipleStatements ? `</span>{<span class="org-string">` : `</span>(<span class="org-string">`}`</span>,
<span class="linenr"> 5515: </span>        exp,
<span class=
"linenr"> 5516: </span>        hasMultipleStatements ? <span class=
"org-string">`}`</span> : <span class="org-string">`)`</span>
<span class="linenr"> 5517: </span>      ])
<span class="linenr"> 5518: </span>    }
<span class="linenr"> 5519: </span>  }
<span class="linenr"> 5520: </span>
<span class="linenr"> 5521: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">ret</span> = {
<span class="linenr"> 5522: </span>    props: [
<span class="linenr"> 5523: </span>      createObjectProperty(
<span class="linenr"> 5524: </span>        eventName,
<span class=
"linenr"> 5525: </span>        exp || createSimpleExpression(<span class="org-string">`() =&gt; {}`</span>, <span class="org-constant">false</span>, loc)
<span class="linenr"> 5526: </span>      )
<span class="linenr"> 5527: </span>    ]
<span class="linenr"> 5528: </span>  }
<span class="linenr"> 5529: </span>
<span class="linenr"> 5530: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">apply extended compiler augmentor</span>
<span class="linenr"> 5531: </span>  <span class=
"org-keyword">if</span> (augmentor) {
<span class="linenr"> 5532: </span>    ret = augmentor(ret)
<span class="linenr"> 5533: </span>  }
<span class="linenr"> 5534: </span>
<span class="linenr"> 5535: </span>  <span class=
"org-keyword">if</span> (shouldCache) {
<span class="linenr"> 5536: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">cache handlers so that it's always the same handler being passed down.</span>
<span class="linenr"> 5537: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">this avoids unnecessary re-renders when users use inline handlers on</span>
<span class="linenr"> 5538: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">components.</span>
<span class="linenr"> 5539: </span>    ret.props[<span class=
"org-highlight-numbers-number">0</span>].value = context.cache(ret.props[<span class="org-highlight-numbers-number">0</span>].value)
<span class="linenr"> 5540: </span>  }
<span class="linenr"> 5541: </span>
<span class="linenr"> 5542: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">mark the key as handler for props normalization check</span>
<span class=
"linenr"> 5543: </span>  ret.props.forEach(p =&gt; (p.key.isHandlerKey = <span class="org-constant">true</span>))
<span class="linenr"> 5544: </span>  <span class=
"org-keyword">return</span> ret
<span class="linenr"> 5545: </span>}
<span class="linenr"> 5546: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">seen</span> = <span class=
"org-keyword">new</span> <span class="org-type">WeakSet</span>()
<span class="linenr"> 5547: </span>
<span class="linenr"> 5548: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformOnce</span> = (node, context) =&gt; {
<span class="linenr"> 5549: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.ELEMENT &amp;& findDir(node, <span class="org-string">'once'</span>, <span class="org-constant">true</span>)) {
<span class="linenr"> 5550: </span>    <span class=
"org-keyword">if</span> (seen.has(node) || context.inVOnce) {
<span class="linenr"> 5551: </span>      logg(<span class=
"org-string">`transformOnce node has seen`</span>)
<span class="linenr"> 5552: </span>      <span class=
"org-keyword">return</span>
<span class="linenr"> 5553: </span>    }
<span class="linenr"> 5554: </span>    seen.add(node)
<span class=
"linenr"> 5555: </span>    context.inVOnce = <span class=
"org-constant">true</span>
<span class=
"linenr"> 5556: </span>    context.helper(SET_BLOCK_TRACKING)
<span class="linenr"> 5557: </span>    <span class=
"org-keyword">return</span> () =&gt; {
<span class=
"linenr"> 5558: </span>      context.inVOnce = <span class=
"org-constant">false</span>
<span class="linenr"> 5559: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">cur</span> = context.currentNode
<span class="linenr"> 5560: </span>      <span class=
"org-keyword">if</span> (cur.codegenNode) {
<span class=
"linenr"> 5561: </span>        cur.codegenNode = context.cache(cur.codegenNode, <span class="org-constant">true</span> <span class="org-comment-delimiter">/* </span><span class="org-comment">isVNode</span><span class="org-comment-delimiter"> */</span>)
<span class="linenr"> 5562: </span>      }
<span class="linenr"> 5563: </span>    }
<span class="linenr"> 5564: </span>  }
<span class="linenr"> 5565: </span>}
<span class="linenr"> 5566: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Important: since this function uses Node.js only dependencies, it should</span>
<span class="linenr"> 5567: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">always be used with a leading !__BROWSER__ check so that it can be</span>
<span class="linenr"> 5568: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">tree-shaken from the browser build.</span>
<span class="linenr"> 5569: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">processExpression</span>(
<span class="linenr"> 5570: </span>  <span class=
"org-variable-name">node</span>,
<span class="linenr"> 5571: </span>  <span class=
"org-variable-name">context</span>,
<span class="linenr"> 5572: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">some expressions like v-slot props & v-for aliases should be parsed as</span>
<span class="linenr"> 5573: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">function params</span>
<span class="linenr"> 5574: </span>  asParams = <span class=
"org-constant">false</span>,
<span class="linenr"> 5575: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-on handler values may contain multiple statements</span>
<span class="linenr"> 5576: </span>  asRawStatements = <span class=
"org-constant">false</span>,
<span class=
"linenr"> 5577: </span>  localVars = Object.create(context.identifiers)
<span class="linenr"> 5578: </span>) {
<span class="linenr"> 5579: </span>  <span class=
"org-keyword">if</span> (__BROWSER__) {
<span class="linenr"> 5580: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 5581: </span>  }
<span class="linenr"> 5582: </span>
<span class="linenr"> 5583: </span>  <span class=
"org-keyword">if</span> (!context.prefixIdentifiers || !node.content.trim()) {
<span class="linenr"> 5584: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 5585: </span>  }
<span class="linenr"> 5586: </span>
<span class="linenr"> 5587: </span>  <span class=
"org-keyword">const</span> { inline, bindingMetadata } = context
<span class="linenr"> 5588: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rewriteIdentifier</span> = (raw, parent, id) =&gt; {
<span class="linenr"> 5589: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = hasOwn(bindingMetadata, raw) &amp;& bindingMetadata[raw]
<span class="linenr"> 5590: </span>    <span class=
"org-keyword">if</span> (inline) {
<span class="linenr"> 5591: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x = y</span>
<span class="linenr"> 5592: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isAssignmentLVal</span> =
<span class=
"linenr"> 5593: </span>        parent &amp;& parent.type === <span class="org-string">'AssignmentExpression'</span> &amp;& parent.left === id
<span class="linenr"> 5594: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x++</span>
<span class="linenr"> 5595: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isUpdateArg</span> =
<span class=
"linenr"> 5596: </span>        parent &amp;& parent.type === <span class="org-string">'UpdateExpression'</span> &amp;& parent.argument === id
<span class="linenr"> 5597: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">({ x } = y)</span>
<span class="linenr"> 5598: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDestructureAssignment</span> =
<span class=
"linenr"> 5599: </span>        parent &amp;& isInDestructureAssignment(parent, parentStack)
<span class="linenr"> 5600: </span>
<span class="linenr"> 5601: </span>      <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_CONST || localVars[raw]) {
<span class="linenr"> 5602: </span>        <span class=
"org-keyword">return</span> raw
<span class="linenr"> 5603: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_REF) {
<span class="linenr"> 5604: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`${raw}.value`</span>
<span class="linenr"> 5605: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_MAYBE_REF) {
<span class="linenr"> 5606: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">const binding that may or may not be ref</span>
<span class="linenr"> 5607: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if it's not a ref, then assignments don't make sense -</span>
<span class="linenr"> 5608: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">so we ignore the non-ref assignment case and generate code</span>
<span class="linenr"> 5609: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">that assumes the value to be a ref for more efficiency</span>
<span class="linenr"> 5610: </span>        <span class=
"org-keyword">return</span> isAssignmentLVal || isUpdateArg || isDestructureAssignment
<span class="linenr"> 5611: </span>          ? <span class=
"org-string">`${raw}.value`</span>
<span class="linenr"> 5612: </span>          : <span class=
"org-string">`${context.helperString(UNREF)}(${raw})`</span>
<span class="linenr"> 5613: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.SETUP_LET) {
<span class="linenr"> 5614: </span>        <span class=
"org-keyword">if</span> (isAssignmentLVal) {
<span class="linenr"> 5615: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let binding.</span>
<span class="linenr"> 5616: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">this is a bit more tricky as we need to cover the case where</span>
<span class="linenr"> 5617: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let is a local non-ref value, and we need to replicate the</span>
<span class="linenr"> 5618: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">right hand side value.</span>
<span class="linenr"> 5619: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x = y --&gt; isRef(x) ? x.value = y : x = y</span>
<span class="linenr"> 5620: </span>          <span class=
"org-keyword">const</span> { right: rVal, operator } = parent
<span class="linenr"> 5621: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rExp</span> = rawExp.slice(rVal.start - <span class="org-highlight-numbers-number">1</span>, rVal.end - <span class="org-highlight-numbers-number">1</span>)
<span class="linenr"> 5622: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rExpString</span> = stringifyExpression(
<span class="linenr"> 5623: </span>            processExpression(
<span class=
"linenr"> 5624: </span>              createSimpleExpression(rExp, <span class="org-constant">false</span>),
<span class="linenr"> 5625: </span>              context,
<span class="linenr"> 5626: </span>              <span class=
"org-constant">false</span>,
<span class="linenr"> 5627: </span>              <span class=
"org-constant">false</span>,
<span class="linenr"> 5628: </span>              knownIds
<span class="linenr"> 5629: </span>            )
<span class="linenr"> 5630: </span>          )
<span class="linenr"> 5631: </span>          <span class=
"org-keyword">return</span> <span class=
"org-string">`${context.helperString(IS_REF)}(${raw})${``} ? ${raw}.value ${operator} ${rExpString} : ${raw}`</span>
<span class="linenr"> 5632: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isUpdateArg) {
<span class="linenr"> 5633: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">make id replace parent in the code range so the raw update operator</span>
<span class="linenr"> 5634: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">is removed</span>
<span class=
"linenr"> 5635: </span>          id.start = parent.start
<span class="linenr"> 5636: </span>          id.end = parent.end
<span class="linenr"> 5637: </span>          <span class=
"org-keyword">const</span> { prefix: isPrefix, operator } = parent
<span class="linenr"> 5638: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prefix</span> = isPrefix ? operator : <span class="org-string">``</span>
<span class="linenr"> 5639: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">postfix</span> = isPrefix ? <span class=
"org-string">``</span> : operator
<span class="linenr"> 5640: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let binding.</span>
<span class="linenr"> 5641: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x++ --&gt; isRef(a) ? a.value++ : a++</span>
<span class="linenr"> 5642: </span>          <span class=
"org-keyword">return</span> <span class=
"org-string">`${context.helperString(IS_REF)}(${raw})${``} ? ${prefix}${raw}.value${postfix} : ${prefix}${raw}${postfix}`</span>
<span class="linenr"> 5643: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isDestructureAssignment) {
<span class="linenr"> 5644: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO</span></span></span>
<span class="linenr"> 5645: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let binding in a destructure assignment - it's very tricky to</span>
<span class="linenr"> 5646: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">handle both possible cases here without altering the original</span>
<span class="linenr"> 5647: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">structure of the code, so we just assume it's not a ref here</span>
<span class="linenr"> 5648: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for now</span>
<span class="linenr"> 5649: </span>          <span class=
"org-keyword">return</span> raw
<span class="linenr"> 5650: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5651: </span>          <span class=
"org-keyword">return</span> <span class=
"org-string">`${context.helperString(UNREF)}(${raw})`</span>
<span class="linenr"> 5652: </span>        }
<span class="linenr"> 5653: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.PROPS) {
<span class="linenr"> 5654: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">use __props which is generated by compileScript so in ts mode</span>
<span class="linenr"> 5655: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">it gets correct type</span>
<span class="linenr"> 5656: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`__props.${raw}`</span>
<span class="linenr"> 5657: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.PROPS_ALIASED) {
<span class="linenr"> 5658: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">prop with a different local alias (from defineProps() destructure)</span>
<span class="linenr"> 5659: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`__props.${bindingMetadata.__propsAliases[raw]}`</span>
<span class="linenr"> 5660: </span>      }
<span class="linenr"> 5661: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5662: </span>      <span class=
"org-keyword">if</span> (type &amp;& type.startsWith(<span class=
"org-string">'setup'</span>)) {
<span class="linenr"> 5663: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">setup bindings in non-inline mode</span>
<span class="linenr"> 5664: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`$setup.${raw}`</span>
<span class="linenr"> 5665: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type === BindingTypes.PROPS_ALIASED) {
<span class="linenr"> 5666: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`$props.${bindingMetadata.__propsAliases[raw]}`</span>
<span class="linenr"> 5667: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type) {
<span class="linenr"> 5668: </span>        <span class=
"org-keyword">return</span> <span class=
"org-string">`$${type}.${raw}`</span>
<span class="linenr"> 5669: </span>      }
<span class="linenr"> 5670: </span>    }
<span class="linenr"> 5671: </span>
<span class="linenr"> 5672: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">fallback to ctx</span>
<span class="linenr"> 5673: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`_ctx.${raw}`</span>
<span class="linenr"> 5674: </span>  }
<span class="linenr"> 5675: </span>
<span class="linenr"> 5676: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">fast path if expression is a simple identifier.</span>
<span class="linenr"> 5677: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rawExp</span> = node.content
<span class="linenr"> 5678: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">bail constant on parens (function invocation) and dot (member access)</span>
<span class="linenr"> 5679: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bailConstant</span> = rawExp.indexOf(<span class="org-string">`(`</span>) &gt; -<span class="org-highlight-numbers-number">1</span> || rawExp.indexOf(<span class="org-string">'.'</span>) &gt; <span class="org-highlight-numbers-number">0</span>
<span class="linenr"> 5680: </span>
<span class="linenr"> 5681: </span>  <span class=
"org-keyword">if</span> (isSimpleIdentifier(rawExp)) {
<span class="linenr"> 5682: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isScopeVarReference</span> = context.identifiers[rawExp]
<span class="linenr"> 5683: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isAllowedGlobal</span> = isGloballyWhitelisted(rawExp)
<span class="linenr"> 5684: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isLiteral</span> = isLiteralWhitelisted(rawExp)
<span class="linenr"> 5685: </span>    <span class=
"org-keyword">if</span> (!asParams &amp;& !isScopeVarReference &amp;& !isAllowedGlobal &amp;& !isLiteral) {
<span class="linenr"> 5686: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">const bindings exposed from setup can be skipped for patching but</span>
<span class="linenr"> 5687: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">cannot be hoisted to module scope</span>
<span class="linenr"> 5688: </span>      <span class=
"org-keyword">if</span> (bindingMetadata[node.content] === BindingTypes.SETUP_CONST) {
<span class=
"linenr"> 5689: </span>        node.constType = ConstantTypes.CAN_SKIP_PATCH
<span class="linenr"> 5690: </span>      }
<span class=
"linenr"> 5691: </span>      node.content = rewriteIdentifier(rawExp)
<span class="linenr"> 5692: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (!isScopeVarReference) {
<span class="linenr"> 5693: </span>      <span class=
"org-keyword">if</span> (isLiteral) {
<span class=
"linenr"> 5694: </span>        node.constType = ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 5695: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 5696: </span>        node.constType = ConstantTypes.CAN_HOIST
<span class="linenr"> 5697: </span>      }
<span class="linenr"> 5698: </span>    }
<span class="linenr"> 5699: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 5700: </span>  }
<span class="linenr"> 5701: </span>
<span class="linenr"> 5702: </span>  <span class=
"org-keyword">let</span> <span class="org-variable-name">ast</span>
<span class="linenr"> 5703: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">exp needs to be parsed differently:</span>
<span class="linenr"> 5704: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. Multiple inline statements (v-on, with presence of `;`): parse as raw</span>
<span class="linenr"> 5705: </span>  <span class=
"org-comment-delimiter">//    </span><span class=
"org-comment">exp, but make sure to pad with spaces for consistent ranges</span>
<span class="linenr"> 5706: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. Expressions: wrap with parens (for e.g. object expressions)</span>
<span class="linenr"> 5707: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">3. Function arguments (v-for, v-slot): place in a function argument position</span>
<span class="linenr"> 5708: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = asRawStatements
<span class="linenr"> 5709: </span>    ? <span class=
"org-string">` ${rawExp} `</span>
<span class="linenr"> 5710: </span>    : <span class=
"org-string">`(${rawExp})${asParams ? `</span>=&gt;{}<span class=
"org-string">` : ``}`</span>
<span class="linenr"> 5711: </span>  <span class=
"org-keyword">try</span> {
<span class=
"linenr"> 5712: </span>    ast = babelParser.parse(source, {
<span class=
"linenr"> 5713: </span>      plugins: context.expressionPlugins
<span class="linenr"> 5714: </span>    }).program
<span class="linenr"> 5715: </span>  } <span class=
"org-keyword">catch</span> (e) {
<span class="linenr"> 5716: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr"> 5717: </span>  }
<span class="linenr"> 5718: </span>
<span class="linenr"> 5719: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ids</span>= []
<span class="linenr"> 5720: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parentStack</span> = []
<span class="linenr"> 5721: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">knownIds</span> = Object.create(context.identifiers)
<span class="linenr"> 5722: </span>
<span class="linenr"> 5723: </span>  walkIdentifiers(
<span class="linenr"> 5724: </span>    ast,
<span class=
"linenr"> 5725: </span>    (node, parent, _, isReferenced, isLocal) =&gt; {
<span class="linenr"> 5726: </span>      <span class=
"org-keyword">if</span> (isStaticPropertyKey(node, parent)) {
<span class="linenr"> 5727: </span>        <span class=
"org-keyword">return</span>
<span class="linenr"> 5728: </span>      }
<span class="linenr"> 5729: </span>
<span class="linenr"> 5730: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">needPrefix</span> = isReferenced &amp;& canPrefix(node)
<span class="linenr"> 5731: </span>      <span class=
"org-keyword">if</span> (needPrefix &amp;& !isLocal) {
<span class="linenr"> 5732: </span>        <span class=
"org-keyword">if</span> (isStaticProperty(parent) &amp;& parent.shorthand) {
<span class="linenr"> 5733: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">property shorthand like { foo }, we need to add the key since</span>
<span class="linenr"> 5734: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we rewrite the value</span>
<span class=
"linenr"> 5735: </span>          node.prefix = <span class=
"org-string">`${node.name}: `</span>
<span class="linenr"> 5736: </span>        }
<span class=
"linenr"> 5737: </span>        node.name = rewriteIdentifier(node.name, parent, node)
<span class="linenr"> 5738: </span>        ids.push(node)
<span class="linenr"> 5739: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5740: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">The identifier is considered constant unless it's pointing to a</span>
<span class="linenr"> 5741: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">local scope variable (a v-for alias, or a v-slot prop)</span>
<span class="linenr"> 5742: </span>        <span class=
"org-keyword">if</span> (!(needPrefix &amp;& isLocal) &amp;& !bailConstant) {
<span class=
"linenr"> 5743: </span>          node.isConstant = <span class=
"org-constant">true</span>
<span class="linenr"> 5744: </span>        }
<span class="linenr"> 5745: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">also generate sub-expressions for other identifiers for better</span>
<span class="linenr"> 5746: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">source map support. (except for property keys which are static)</span>
<span class="linenr"> 5747: </span>        ids.push(node)
<span class="linenr"> 5748: </span>      }
<span class="linenr"> 5749: </span>    },
<span class="linenr"> 5750: </span>    <span class=
"org-constant">true</span>, <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">invoke on ALL identifiers</span>
<span class="linenr"> 5751: </span>    parentStack,
<span class="linenr"> 5752: </span>    knownIds
<span class="linenr"> 5753: </span>  )
<span class="linenr"> 5754: </span>
<span class="linenr"> 5755: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">We break up the compound expression into an array of strings and sub</span>
<span class="linenr"> 5756: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">expressions (for identifiers that have been prefixed). In codegen, if</span>
<span class="linenr"> 5757: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">an ExpressionNode has the `.children` property, it will be used instead of</span>
<span class="linenr"> 5758: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">`.content`.</span>
<span class="linenr"> 5759: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">children</span> = []
<span class=
"linenr"> 5760: </span>  ids.sort((a, b) =&gt; a.start - b.start)
<span class="linenr"> 5761: </span>  ids.forEach((id, i) =&gt; {
<span class="linenr"> 5762: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">range is offset by -1 due to the wrapping parens when parsed</span>
<span class="linenr"> 5763: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = id.start - <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 5764: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">end</span> = id.end - <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 5765: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">last</span> = ids[i - <span class=
"org-highlight-numbers-number">1</span>]
<span class="linenr"> 5766: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">leadingText</span> = rawExp.slice(last ? last.end - <span class="org-highlight-numbers-number">1</span> : <span class="org-highlight-numbers-number">0</span>, start)
<span class="linenr"> 5767: </span>    <span class=
"org-keyword">if</span> (leadingText.length || id.prefix) {
<span class=
"linenr"> 5768: </span>      children.push(leadingText + (id.prefix || <span class="org-string">``</span>))
<span class="linenr"> 5769: </span>    }
<span class="linenr"> 5770: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = rawExp.slice(start, end)
<span class="linenr"> 5771: </span>    children.push(
<span class="linenr"> 5772: </span>      createSimpleExpression(
<span class="linenr"> 5773: </span>        id.name,
<span class="linenr"> 5774: </span>        <span class=
"org-constant">false</span>,
<span class="linenr"> 5775: </span>        {
<span class="linenr"> 5776: </span>          source,
<span class=
"linenr"> 5777: </span>          start: advancePositionWithClone(node.loc.start, source, start),
<span class=
"linenr"> 5778: </span>          end: advancePositionWithClone(node.loc.start, source, end)
<span class="linenr"> 5779: </span>        },
<span class=
"linenr"> 5780: </span>        id.isConstant ? ConstantTypes.CAN_STRINGIFY : ConstantTypes.NOT_CONSTANT
<span class="linenr"> 5781: </span>      )
<span class="linenr"> 5782: </span>    )
<span class="linenr"> 5783: </span>    <span class=
"org-keyword">if</span> (i === ids.length - <span class=
"org-highlight-numbers-number">1</span> &amp;& end &lt; rawExp.length) {
<span class=
"linenr"> 5784: </span>      children.push(rawExp.slice(end))
<span class="linenr"> 5785: </span>    }
<span class="linenr"> 5786: </span>  })
<span class="linenr"> 5787: </span>
<span class="linenr"> 5788: </span>  <span class=
"org-keyword">let</span> <span class="org-variable-name">ret</span>
<span class="linenr"> 5789: </span>  <span class=
"org-keyword">if</span> (children.length) {
<span class=
"linenr"> 5790: </span>    ret = createCompoundExpression(children, node.loc)
<span class="linenr"> 5791: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5792: </span>    ret = node
<span class="linenr"> 5793: </span>    ret.constType = bailConstant
<span class=
"linenr"> 5794: </span>      ? ConstantTypes.NOT_CONSTANT
<span class=
"linenr"> 5795: </span>      : ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 5796: </span>  }
<span class=
"linenr"> 5797: </span>  ret.identifiers = Object.keys(knownIds)
<span class="linenr"> 5798: </span>  <span class=
"org-keyword">return</span> ret
<span class="linenr"> 5799: </span>}
<span class="linenr"> 5800: </span>
<span class="linenr"> 5801: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">canPrefix</span>(<span class=
"org-variable-name">id</span>) {
<span class="linenr"> 5802: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip whitelisted globals</span>
<span class="linenr"> 5803: </span>  <span class=
"org-keyword">if</span> (isGloballyWhitelisted(id.name)) {
<span class="linenr"> 5804: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 5805: </span>  }
<span class="linenr"> 5806: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">special case for webpack compilation</span>
<span class="linenr"> 5807: </span>  <span class=
"org-keyword">if</span> (id.name === <span class=
"org-string">'require'</span>) {
<span class="linenr"> 5808: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 5809: </span>  }
<span class="linenr"> 5810: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 5811: </span>}
<span class="linenr"> 5812: </span>
<span class="linenr"> 5813: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">stringifyExpression</span>(<span class=
"org-variable-name">exp</span>){
<span class="linenr"> 5814: </span>  <span class=
"org-keyword">if</span> (isString(exp)) {
<span class="linenr"> 5815: </span>    <span class=
"org-keyword">return</span> exp
<span class="linenr"> 5816: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (exp.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 5817: </span>    <span class=
"org-keyword">return</span> exp.content
<span class="linenr"> 5818: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5819: </span>    <span class=
"org-keyword">return</span> exp.children.map(stringifyExpression).join(<span class="org-string">''</span>)
<span class="linenr"> 5820: </span>  }
<span class="linenr"> 5821: </span>}
<span class="linenr"> 5822: </span>
<span class="linenr"> 5823: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createRoot</span>(<span class=
"org-variable-name">children</span>, <span class=
"org-variable-name">loc</span> = <span class=
"org-variable-name">locStub</span>) {
<span class="linenr"> 5824: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 5825: </span>    type: NodeTypes.ROOT,
<span class="linenr"> 5826: </span>    children,
<span class="linenr"> 5827: </span>    helpers: [],
<span class="linenr"> 5828: </span>    components: [],
<span class="linenr"> 5829: </span>    directives: [],
<span class="linenr"> 5830: </span>    hoists: [],
<span class="linenr"> 5831: </span>    imports: [],
<span class="linenr"> 5832: </span>    cached: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 5833: </span>    temps: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 5834: </span>    codegenNode: <span class=
"org-constant">undefined</span>,
<span class="linenr"> 5835: </span>    loc
<span class="linenr"> 5836: </span>  }
<span class="linenr"> 5837: </span>}
<span class="linenr"> 5838: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createVNodeCall</span>(
<span class="linenr"> 5839: </span>  <span class=
"org-variable-name">context</span>,
<span class="linenr"> 5840: </span>  <span class=
"org-variable-name">tag</span>,
<span class="linenr"> 5841: </span>  <span class=
"org-variable-name">props</span>,
<span class="linenr"> 5842: </span>  <span class=
"org-variable-name">children</span>,
<span class="linenr"> 5843: </span>  <span class=
"org-variable-name">patchFlag</span>,
<span class="linenr"> 5844: </span>  <span class=
"org-variable-name">dynamicProps</span>,
<span class="linenr"> 5845: </span>  <span class=
"org-variable-name">directives</span>,
<span class="linenr"> 5846: </span>  isBlock = <span class=
"org-constant">false</span>,
<span class="linenr"> 5847: </span>  disableTracking = <span class=
"org-constant">false</span>,
<span class="linenr"> 5848: </span>  isComponent = <span class=
"org-constant">false</span>,
<span class="linenr"> 5849: </span>  loc = locStub
<span class="linenr"> 5850: </span>) {
<span class="linenr"> 5851: </span>  <span class=
"org-keyword">if</span> (context) {
<span class="linenr"> 5852: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">单个子节点用 block</span>
<span class="linenr"> 5853: </span>    <span class=
"org-keyword">if</span> (isBlock) {
<span class="linenr"> 5854: </span>      context.helper(OPEN_BLOCK)
<span class=
"linenr"> 5855: </span>      context.helper(getVNodeBlockHelper(context.inSSR, isComponent))
<span class="linenr"> 5856: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 5857: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">多个节节点用 fragment</span>
<span class=
"linenr"> 5858: </span>      context.helper(getVNodeHelper(context.inSSR, isComponent))
<span class="linenr"> 5859: </span>    }
<span class="linenr"> 5860: </span>    <span class=
"org-keyword">if</span> (directives) {
<span class=
"linenr"> 5861: </span>      context.helper(WITH_DIRECTIVES)
<span class="linenr"> 5862: </span>    }
<span class="linenr"> 5863: </span>  }
<span class="linenr"> 5864: </span>
<span class="linenr"> 5865: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 5866: </span>    type: NodeTypes.VNODE_CALL,
<span class="linenr"> 5867: </span>    tag,
<span class="linenr"> 5868: </span>    props,
<span class="linenr"> 5869: </span>    children,
<span class="linenr"> 5870: </span>    patchFlag,
<span class="linenr"> 5871: </span>    dynamicProps,
<span class="linenr"> 5872: </span>    directives,
<span class="linenr"> 5873: </span>    isBlock,
<span class="linenr"> 5874: </span>    disableTracking,
<span class="linenr"> 5875: </span>    isComponent,
<span class="linenr"> 5876: </span>    loc
<span class="linenr"> 5877: </span>  }
<span class="linenr"> 5878: </span>}
<span class="linenr"> 5879: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createArrayExpression</span>(<span class=
"org-variable-name">elements</span>, <span class=
"org-variable-name">loc</span> = <span class=
"org-variable-name">locStub</span>) {
<span class="linenr"> 5880: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5881: </span>    type: NodeTypes.JS_ARRAY_EXPRESSION,
<span class="linenr"> 5882: </span>    loc,
<span class="linenr"> 5883: </span>    elements
<span class="linenr"> 5884: </span>  }
<span class="linenr"> 5885: </span>}
<span class="linenr"> 5886: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createObjectExpression</span>(<span class=
"org-variable-name">properties</span>, <span class=
"org-variable-name">loc</span> = <span class=
"org-variable-name">locStub</span>) {
<span class="linenr"> 5887: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5888: </span>    type: NodeTypes.JS_OBJECT_EXPRESSION,
<span class="linenr"> 5889: </span>    loc,
<span class="linenr"> 5890: </span>    properties
<span class="linenr"> 5891: </span>  }
<span class="linenr"> 5892: </span>}
<span class="linenr"> 5893: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createObjectProperty</span>(<span class=
"org-variable-name">key</span>, <span class=
"org-variable-name">value</span>) {
<span class="linenr"> 5894: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 5895: </span>    type: NodeTypes.JS_PROPERTY,
<span class="linenr"> 5896: </span>    loc: locStub,
<span class=
"linenr"> 5897: </span>    key: isString(key) ? createSimpleExpression(key, <span class="org-constant">true</span>) : key,
<span class="linenr"> 5898: </span>    value
<span class="linenr"> 5899: </span>  }
<span class="linenr"> 5900: </span>}
<span class="linenr"> 5901: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createSimpleExpression</span>(
<span class="linenr"> 5902: </span>  <span class=
"org-variable-name">content</span>,
<span class="linenr"> 5903: </span>  isStatic = <span class=
"org-constant">false</span>,
<span class="linenr"> 5904: </span>  loc  = locStub,
<span class=
"linenr"> 5905: </span>  constType = ConstantTypes.NOT_CONSTANT
<span class="linenr"> 5906: </span>) {
<span class="linenr"> 5907: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5908: </span>    type: NodeTypes.SIMPLE_EXPRESSION,
<span class="linenr"> 5909: </span>    loc,
<span class="linenr"> 5910: </span>    content,
<span class="linenr"> 5911: </span>    isStatic,
<span class=
"linenr"> 5912: </span>    constType: isStatic ? ConstantTypes.CAN_STRINGIFY : constType
<span class="linenr"> 5913: </span>  }
<span class="linenr"> 5914: </span>}
<span class="linenr"> 5915: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createInterpolation</span>(<span class=
"org-variable-name">content</span>, <span class=
"org-variable-name">loc</span>) {
<span class="linenr"> 5916: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5917: </span>    type: NodeTypes.INTERPOLATION,
<span class="linenr"> 5918: </span>    loc,
<span class="linenr"> 5919: </span>    content: isString(content)
<span class=
"linenr"> 5920: </span>      ? createSimpleExpression(content, <span class="org-constant">false</span>, loc)
<span class="linenr"> 5921: </span>      : content
<span class="linenr"> 5922: </span>  }
<span class="linenr"> 5923: </span>}
<span class="linenr"> 5924: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createCompoundExpression</span>(<span class=
"org-variable-name">children</span>, <span class=
"org-variable-name">loc</span> = <span class=
"org-variable-name">locStub</span>) {
<span class="linenr"> 5925: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5926: </span>    type: NodeTypes.COMPOUND_EXPRESSION,
<span class="linenr"> 5927: </span>    loc,
<span class="linenr"> 5928: </span>    children
<span class="linenr"> 5929: </span>  }
<span class="linenr"> 5930: </span>}
<span class="linenr"> 5931: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createCallExpression</span>(<span class=
"org-variable-name">callee</span>, <span class=
"org-variable-name">args</span> = [], <span class=
"org-variable-name">loc</span> = <span class=
"org-variable-name">locStub</span>) {
<span class="linenr"> 5932: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5933: </span>    type: NodeTypes.JS_CALL_EXPRESSION,
<span class="linenr"> 5934: </span>    loc,
<span class="linenr"> 5935: </span>    callee,
<span class="linenr"> 5936: </span>    <span class=
"org-constant">arguments</span>: args
<span class="linenr"> 5937: </span>  }
<span class="linenr"> 5938: </span>}
<span class="linenr"> 5939: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createFunctionExpression</span>(
<span class="linenr"> 5940: </span>  <span class=
"org-variable-name">params</span>,
<span class="linenr"> 5941: </span>  returns = <span class=
"org-constant">undefined</span>,
<span class="linenr"> 5942: </span>  newline = <span class=
"org-constant">false</span>,
<span class="linenr"> 5943: </span>  isSlot = <span class=
"org-constant">false</span>,
<span class="linenr"> 5944: </span>  loc = locStub
<span class="linenr"> 5945: </span>) {
<span class="linenr"> 5946: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5947: </span>    type: NodeTypes.JS_FUNCTION_EXPRESSION,
<span class="linenr"> 5948: </span>    params,
<span class="linenr"> 5949: </span>    returns,
<span class="linenr"> 5950: </span>    newline,
<span class="linenr"> 5951: </span>    isSlot,
<span class="linenr"> 5952: </span>    loc
<span class="linenr"> 5953: </span>  }
<span class="linenr"> 5954: </span>}
<span class="linenr"> 5955: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createConditionalExpression</span>(
<span class="linenr"> 5956: </span>  <span class=
"org-variable-name">test</span>,
<span class="linenr"> 5957: </span>  <span class=
"org-variable-name">consequent</span>,
<span class="linenr"> 5958: </span>  <span class=
"org-variable-name">alternate</span>,
<span class="linenr"> 5959: </span>  newline = <span class=
"org-constant">true</span>
<span class="linenr"> 5960: </span>) {
<span class="linenr"> 5961: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5962: </span>    type: NodeTypes.JS_CONDITIONAL_EXPRESSION,
<span class="linenr"> 5963: </span>    test,
<span class="linenr"> 5964: </span>    consequent,
<span class="linenr"> 5965: </span>    alternate,
<span class="linenr"> 5966: </span>    newline,
<span class="linenr"> 5967: </span>    loc: locStub
<span class="linenr"> 5968: </span>  }
<span class="linenr"> 5969: </span>}
<span class="linenr"> 5970: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createCacheExpression</span>(
<span class="linenr"> 5971: </span>  <span class=
"org-variable-name">index</span>,
<span class="linenr"> 5972: </span>  <span class=
"org-variable-name">value</span>,
<span class="linenr"> 5973: </span>  isVNode = <span class=
"org-constant">false</span>
<span class="linenr"> 5974: </span>) {
<span class="linenr"> 5975: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5976: </span>    type: NodeTypes.JS_CACHE_EXPRESSION,
<span class="linenr"> 5977: </span>    index,
<span class="linenr"> 5978: </span>    value,
<span class="linenr"> 5979: </span>    isVNode,
<span class="linenr"> 5980: </span>    loc: locStub
<span class="linenr"> 5981: </span>  }
<span class="linenr"> 5982: </span>}
<span class="linenr"> 5983: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createBlockStatement</span>(<span class=
"org-variable-name">body</span>) {
<span class="linenr"> 5984: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5985: </span>    type: NodeTypes.JS_BLOCK_STATEMENT,
<span class="linenr"> 5986: </span>    body,
<span class="linenr"> 5987: </span>    loc: locStub
<span class="linenr"> 5988: </span>  }
<span class="linenr"> 5989: </span>}
<span class="linenr"> 5990: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createTemplateLiteral</span>(<span class=
"org-variable-name">elements</span>) {
<span class="linenr"> 5991: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5992: </span>    type: NodeTypes.JS_TEMPLATE_LITERAL,
<span class="linenr"> 5993: </span>    elements,
<span class="linenr"> 5994: </span>    loc: locStub
<span class="linenr"> 5995: </span>  }
<span class="linenr"> 5996: </span>}
<span class="linenr"> 5997: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createIfStatement</span>(<span class=
"org-variable-name">test</span>, <span class=
"org-variable-name">consequent</span>, <span class=
"org-variable-name">alternate</span>) {
<span class="linenr"> 5998: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 5999: </span>    type: NodeTypes.JS_IF_STATEMENT,
<span class="linenr"> 6000: </span>    test,
<span class="linenr"> 6001: </span>    consequent,
<span class="linenr"> 6002: </span>    alternate,
<span class="linenr"> 6003: </span>    loc: locStub
<span class="linenr"> 6004: </span>  }
<span class="linenr"> 6005: </span>}
<span class="linenr"> 6006: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createAssignmentExpression</span>(<span class=
"org-variable-name">left</span>, <span class=
"org-variable-name">right</span>) {
<span class="linenr"> 6007: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 6008: </span>    type: NodeTypes.JS_ASSIGNMENT_EXPRESSION,
<span class="linenr"> 6009: </span>    left,
<span class="linenr"> 6010: </span>    right,
<span class="linenr"> 6011: </span>    loc: locStub
<span class="linenr"> 6012: </span>  }
<span class="linenr"> 6013: </span>}
<span class="linenr"> 6014: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createSequenceExpression</span>(<span class=
"org-variable-name">expressions</span>) {
<span class="linenr"> 6015: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 6016: </span>    type: NodeTypes.JS_SEQUENCE_EXPRESSION,
<span class="linenr"> 6017: </span>    expressions,
<span class="linenr"> 6018: </span>    loc: locStub
<span class="linenr"> 6019: </span>  }
<span class="linenr"> 6020: </span>}
<span class="linenr"> 6021: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createReturnStatement</span>(<span class=
"org-variable-name">returns</span>) {
<span class="linenr"> 6022: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr"> 6023: </span>    type: NodeTypes.JS_RETURN_STATEMENT,
<span class="linenr"> 6024: </span>    returns,
<span class="linenr"> 6025: </span>    loc: locStub
<span class="linenr"> 6026: </span>  }
<span class="linenr"> 6027: </span>}
<span class="linenr"> 6028: </span>
<span class="linenr"> 6029: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">transform</span>(<span class=
"org-variable-name">root</span>, <span class=
"org-variable-name">options</span>) {
<span class="linenr"> 6030: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">transform 上下文</span>
<span class="linenr"> 6031: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">context</span> = createTransformContext(root, options)
<span class="linenr"> 6032: </span>
<span class="linenr"> 6033: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">递归遍历整个 ast root 树，最终为每颗子树生成 codegenNode</span>
<span class="linenr"> 6034: </span>  traverseNode(root, context)
<span class="linenr"> 6035: </span>
<span class="linenr"> 6036: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">静态提升处理</span>
<span class="linenr"> 6037: </span>  <span class=
"org-keyword">if</span> (options.hoistStatic) {
<span class="linenr"> 6038: </span>    hoistStatic(root, context)
<span class="linenr"> 6039: </span>  }
<span class="linenr"> 6040: </span>
<span class="linenr"> 6041: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">创建 root codegenNode 代码</span>
<span class="linenr"> 6042: </span>  <span class=
"org-keyword">if</span> (!options.ssr) {
<span class=
"linenr"> 6043: </span>    createRootCodegen(root, context)
<span class="linenr"> 6044: </span>  }
<span class="linenr"> 6045: </span>
<span class="linenr"> 6046: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">finalize meta information</span>
<span class=
"linenr"> 6047: </span>  root.helpers = [...context.helpers.keys()]
<span class=
"linenr"> 6048: </span>  root.components = [...context.components]
<span class=
"linenr"> 6049: </span>  root.directives = [...context.directives]
<span class="linenr"> 6050: </span>  root.imports = context.imports
<span class="linenr"> 6051: </span>  root.hoists = context.hoists
<span class="linenr"> 6052: </span>  root.temps = context.temps
<span class="linenr"> 6053: </span>  root.cached = context.cached
<span class="linenr"> 6054: </span>}
<span class="linenr"> 6055: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getBaseTransformPreset</span>(<span class=
"org-variable-name">prefixIdentifiers</span>) {
<span class="linenr"> 6056: </span>  <span class=
"org-keyword">return</span> [
<span class="linenr"> 6057: </span>    [
<span class="linenr"> 6058: </span>      transformOnce,
<span class="linenr"> 6059: </span>      transformIf,
<span class="linenr"> 6060: </span>      transformMemo,
<span class="linenr"> 6061: </span>      transformFor,
<span class=
"linenr"> 6062: </span>      ...(!__BROWSER__ &amp;& prefixIdentifiers
<span class="linenr"> 6063: </span>        ? [
<span class="linenr"> 6064: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">order is important</span>
<span class="linenr"> 6065: </span>            trackVForSlotScopes,
<span class="linenr"> 6066: </span>            transformExpression
<span class="linenr"> 6067: </span>          ]
<span class=
"linenr"> 6068: </span>        : __BROWSER__ &amp;& __DEV__
<span class="linenr"> 6069: </span>        ? [transformExpression]
<span class="linenr"> 6070: </span>        : []),
<span class="linenr"> 6071: </span>      transformSlotOutlet,
<span class="linenr"> 6072: </span>      transformElement,
<span class="linenr"> 6073: </span>      trackSlotScopes,
<span class="linenr"> 6074: </span>      transformText
<span class="linenr"> 6075: </span>    ],
<span class="linenr"> 6076: </span>    {
<span class="linenr"> 6077: </span>      on: transformOn,
<span class="linenr"> 6078: </span>      bind: transformBind,
<span class="linenr"> 6079: </span>      model: transformModel
<span class="linenr"> 6080: </span>    }
<span class="linenr"> 6081: </span>  ]
<span class="linenr"> 6082: </span>}
<span class="linenr"> 6083: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">PURE_ANNOTATION</span> = <span class=
"org-string">`/*#__PURE__*/`</span>
<span class="linenr"> 6084: </span>
<span class="linenr"> 6085: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isText$1</span>(<span class=
"org-variable-name">n</span>) {
<span class="linenr"> 6086: </span>  <span class=
"org-keyword">return</span> (
<span class="linenr"> 6087: </span>    isString(n) ||
<span class=
"linenr"> 6088: </span>    n.type === NodeTypes.SIMPLE_EXPRESSION ||
<span class="linenr"> 6089: </span>    n.type === NodeTypes.TEXT ||
<span class=
"linenr"> 6090: </span>    n.type === NodeTypes.INTERPOLATION ||
<span class=
"linenr"> 6091: </span>    n.type === NodeTypes.COMPOUND_EXPRESSION
<span class="linenr"> 6092: </span>  )
<span class="linenr"> 6093: </span>}
<span class="linenr"> 6094: </span>
<span class="linenr"> 6095: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">过滤掉后面空值参数fn(a, b, c, null, undefined, '') =&gt; fn(a,b,c)</span>
<span class="linenr"> 6096: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genNullableArgs</span>(<span class=
"org-variable-name">args</span>) {
<span class="linenr"> 6097: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = args.length
<span class="linenr"> 6098: </span>  <span class=
"org-keyword">while</span> (i--) {
<span class="linenr"> 6099: </span>    <span class=
"org-keyword">if</span> (args[i] != <span class=
"org-constant">null</span>) <span class="org-keyword">break</span>
<span class="linenr"> 6100: </span>  }
<span class="linenr"> 6101: </span>  <span class=
"org-keyword">return</span> args.slice(<span class=
"org-highlight-numbers-number">0</span>, i + <span class=
"org-highlight-numbers-number">1</span>).map(arg =&gt; arg || <span class="org-string">`null`</span>)
<span class="linenr"> 6102: </span>}
<span class="linenr"> 6103: </span>
<span class="linenr"> 6104: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">生成对象的 key 值，可能是个表达式，如： { [a + b + c]: value }</span>
<span class="linenr"> 6105: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genExpressionAsPropertyKey</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6106: </span>  <span class=
"org-keyword">const</span> { push } = context
<span class="linenr"> 6107: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.COMPOUND_EXPRESSION) {
<span class="linenr"> 6108: </span>    push(<span class=
"org-string">`[`</span>)
<span class=
"linenr"> 6109: </span>    genCompoundExpression(node, context)
<span class="linenr"> 6110: </span>    push(<span class=
"org-string">`]`</span>)
<span class="linenr"> 6111: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.isStatic) {
<span class="linenr"> 6112: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">only quote keys if necessary</span>
<span class="linenr"> 6113: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">text</span> = isSimpleIdentifier(node.content)
<span class="linenr"> 6114: </span>      ? node.content
<span class=
"linenr"> 6115: </span>      : JSON.stringify(node.content)
<span class="linenr"> 6116: </span>    push(text, node)
<span class="linenr"> 6117: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6118: </span>    push(<span class=
"org-string">`[${node.content}]`</span>, node)
<span class="linenr"> 6119: </span>  }
<span class="linenr"> 6120: </span>}
<span class="linenr"> 6121: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createCodegenContext</span>(
<span class="linenr"> 6122: </span>  <span class=
"org-variable-name">ast</span>,
<span class="linenr"> 6123: </span>  {
<span class="linenr"> 6124: </span>    mode = <span class=
"org-string">'function'</span>,
<span class=
"linenr"> 6125: </span>    prefixIdentifiers = mode === <span class="org-string">'module'</span>,
<span class="linenr"> 6126: </span>    sourceMap = <span class=
"org-constant">false</span>,
<span class="linenr"> 6127: </span>    filename = <span class=
"org-string">`template.vue.html`</span>,
<span class="linenr"> 6128: </span>    scopeId = <span class=
"org-constant">null</span>,
<span class=
"linenr"> 6129: </span>    optimizeImports = <span class=
"org-constant">false</span>,
<span class=
"linenr"> 6130: </span>    runtimeGlobalName = <span class=
"org-string">`Vue`</span>,
<span class=
"linenr"> 6131: </span>    runtimeModuleName = <span class=
"org-string">`vue`</span>,
<span class=
"linenr"> 6132: </span>    ssrRuntimeModuleName = <span class=
"org-string">'vue/server-renderer'</span>,
<span class="linenr"> 6133: </span>    ssr = <span class=
"org-constant">false</span>,
<span class="linenr"> 6134: </span>    isTS = <span class=
"org-constant">false</span>,
<span class="linenr"> 6135: </span>    inSSR = <span class=
"org-constant">false</span>
<span class="linenr"> 6136: </span>  }
<span class="linenr"> 6137: </span>) {
<span class="linenr"> 6138: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">context</span> = {
<span class="linenr"> 6139: </span>    mode,
<span class="linenr"> 6140: </span>    prefixIdentifiers,
<span class="linenr"> 6141: </span>    sourceMap,
<span class="linenr"> 6142: </span>    filename,
<span class="linenr"> 6143: </span>    scopeId,
<span class="linenr"> 6144: </span>    optimizeImports,
<span class="linenr"> 6145: </span>    runtimeGlobalName,
<span class="linenr"> 6146: </span>    runtimeModuleName,
<span class="linenr"> 6147: </span>    ssrRuntimeModuleName,
<span class="linenr"> 6148: </span>    ssr,
<span class="linenr"> 6149: </span>    isTS,
<span class="linenr"> 6150: </span>    inSSR,
<span class="linenr"> 6151: </span>    source: ast.loc.source,
<span class="linenr"> 6152: </span>    code: <span class=
"org-string">``</span>,
<span class="linenr"> 6153: </span>    column: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr"> 6154: </span>    line: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr"> 6155: </span>    offset: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 6156: </span>    indentLevel: <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 6157: </span>    pure: <span class=
"org-constant">false</span>,
<span class="linenr"> 6158: </span>    map: <span class=
"org-constant">undefined</span>,
<span class="linenr"> 6159: </span>    helper(key) {
<span class="linenr"> 6160: </span>      <span class=
"org-keyword">return</span> <span class=
"org-string">`_${helperNameMap[key]}`</span>
<span class="linenr"> 6161: </span>    },
<span class="linenr"> 6162: </span>    push(code, node) {
<span class="linenr"> 6163: </span>      context.code += code
<span class="linenr"> 6164: </span>      <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& context.map) {
<span class="linenr"> 6165: </span>        <span class=
"org-keyword">if</span> (node) {
<span class="linenr"> 6166: </span>          <span class=
"org-keyword">let</span> <span class=
"org-variable-name">name</span>
<span class="linenr"> 6167: </span>          <span class=
"org-keyword">if</span> (node.type === NodeTypes.SIMPLE_EXPRESSION &amp;& !node.isStatic) {
<span class="linenr"> 6168: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">content</span> = node.content.replace(<span class="org-string">/^_ctx\./</span>, <span class="org-string">''</span>)
<span class="linenr"> 6169: </span>            <span class=
"org-keyword">if</span> (content !== node.content &amp;& isSimpleIdentifier(content)) {
<span class="linenr"> 6170: </span>              name = content
<span class="linenr"> 6171: </span>            }
<span class="linenr"> 6172: </span>          }
<span class=
"linenr"> 6173: </span>          addMapping(node.loc.start, name)
<span class="linenr"> 6174: </span>        }
<span class=
"linenr"> 6175: </span>        advancePositionWithMutation(context, code)
<span class="linenr"> 6176: </span>        <span class=
"org-keyword">if</span> (node &amp;& node.loc !== locStub) {
<span class=
"linenr"> 6177: </span>          addMapping(node.loc.end)
<span class="linenr"> 6178: </span>        }
<span class="linenr"> 6179: </span>      }
<span class="linenr"> 6180: </span>    },
<span class="linenr"> 6181: </span>    indent() {
<span class=
"linenr"> 6182: </span>      newline(++context.indentLevel)
<span class="linenr"> 6183: </span>    },
<span class=
"linenr"> 6184: </span>    deindent(withoutNewLine = <span class=
"org-constant">false</span>) {
<span class="linenr"> 6185: </span>      <span class=
"org-keyword">if</span> (withoutNewLine) {
<span class="linenr"> 6186: </span>        --context.indentLevel
<span class="linenr"> 6187: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 6188: </span>        newline(--context.indentLevel)
<span class="linenr"> 6189: </span>      }
<span class="linenr"> 6190: </span>    },
<span class="linenr"> 6191: </span>    newline() {
<span class=
"linenr"> 6192: </span>      newline(context.indentLevel)
<span class="linenr"> 6193: </span>    }
<span class="linenr"> 6194: </span>  }
<span class="linenr"> 6195: </span>
<span class="linenr"> 6196: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">newline</span>(<span class=
"org-variable-name">n</span>) {
<span class="linenr"> 6197: </span>    context.push(<span class=
"org-string">'\n'</span> + <span class=
"org-string">`  `</span>.repeat(n))
<span class="linenr"> 6198: </span>  }
<span class="linenr"> 6199: </span>
<span class="linenr"> 6200: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">addMapping</span>(<span class=
"org-variable-name">loc</span>, <span class=
"org-variable-name">name</span>) {
<span class="linenr"> 6201: </span>    context.map.addMapping({
<span class="linenr"> 6202: </span>      name,
<span class="linenr"> 6203: </span>      source: context.filename,
<span class="linenr"> 6204: </span>      original: {
<span class="linenr"> 6205: </span>        line: loc.line,
<span class=
"linenr"> 6206: </span>        column: loc.column - <span class=
"org-highlight-numbers-number">1</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">source-map column is 0 based</span>
<span class="linenr"> 6207: </span>      },
<span class="linenr"> 6208: </span>      generated: {
<span class="linenr"> 6209: </span>        line: context.line,
<span class=
"linenr"> 6210: </span>        column: context.column - <span class="org-highlight-numbers-number">1</span>
<span class="linenr"> 6211: </span>      }
<span class="linenr"> 6212: </span>    })
<span class="linenr"> 6213: </span>  }
<span class="linenr"> 6214: </span>
<span class="linenr"> 6215: </span>  <span class=
"org-keyword">return</span> context
<span class="linenr"> 6216: </span>}
<span class="linenr"> 6217: </span>
<span class="linenr"> 6218: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genModulePreamble</span>(<span class=
"org-variable-name">ast</span>, <span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">genScopeId</span>, <span class=
"org-variable-name">inline</span>) {
<span class="linenr"> 6219: </span>  <span class=
"org-keyword">const</span> {
<span class="linenr"> 6220: </span>    push,
<span class="linenr"> 6221: </span>    newline,
<span class="linenr"> 6222: </span>    optimizeImports,
<span class="linenr"> 6223: </span>    runtimeModuleName,
<span class="linenr"> 6224: </span>    ssrRuntimeModuleName
<span class="linenr"> 6225: </span>  } = context
<span class="linenr"> 6226: </span>
<span class="linenr"> 6227: </span>  <span class=
"org-keyword">if</span> (genScopeId &amp;& ast.hoists.length) {
<span class=
"linenr"> 6228: </span>    ast.helpers.push(PUSH_SCOPE_ID, POP_SCOPE_ID)
<span class="linenr"> 6229: </span>  }
<span class="linenr"> 6230: </span>
<span class="linenr"> 6231: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">generate import statements for helpers</span>
<span class="linenr"> 6232: </span>  <span class=
"org-keyword">if</span> (ast.helpers.length) {
<span class="linenr"> 6233: </span>    <span class=
"org-keyword">if</span> (optimizeImports) {
<span class="linenr"> 6234: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">when bundled with webpack with code-split, calling an import binding</span>
<span class="linenr"> 6235: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">as a function leads to it being wrapped with `Object(a.b)` or `(0,a.b)`,</span>
<span class="linenr"> 6236: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">incurring both payload size increase and potential perf overhead.</span>
<span class="linenr"> 6237: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">therefore we assign the imports to variables (which is a constant ~50b</span>
<span class="linenr"> 6238: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">cost per-component instead of scaling with template size)</span>
<span class="linenr"> 6239: </span>      push(
<span class="linenr"> 6240: </span>        <span class=
"org-string">`import { ${ast.helpers</span>
<span class="linenr"> 6241: </span><span class=
"org-string">          .map(s =&gt; helperNameMap[s])</span>
<span class="linenr"> 6242: </span><span class=
"org-string">          .join(', ')} } from ${JSON.stringify(runtimeModuleName)}\n`</span>
<span class="linenr"> 6243: </span>      )
<span class="linenr"> 6244: </span>      push(
<span class="linenr"> 6245: </span>        <span class=
"org-string">`\n// Binding optimization for webpack code-split\nconst ${ast.helpers</span>
<span class="linenr"> 6246: </span><span class=
"org-string">          .map(s =&gt; `</span>_${helperNameMap[s]} = ${helperNameMap[s]}<span class="org-string">`)</span>
<span class="linenr"> 6247: </span><span class=
"org-string">          .join(', ')}\n`</span>
<span class="linenr"> 6248: </span>      )
<span class="linenr"> 6249: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6250: </span>      push(
<span class="linenr"> 6251: </span>        <span class=
"org-string">`import { ${ast.helpers</span>
<span class="linenr"> 6252: </span><span class=
"org-string">          .map(s =&gt; `</span>${helperNameMap[s]} as _${helperNameMap[s]}<span class="org-string">`)</span>
<span class="linenr"> 6253: </span><span class=
"org-string">          .join(', ')} } from ${JSON.stringify(runtimeModuleName)}\n`</span>
<span class="linenr"> 6254: </span>      )
<span class="linenr"> 6255: </span>    }
<span class="linenr"> 6256: </span>  }
<span class="linenr"> 6257: </span>
<span class="linenr"> 6258: </span>  <span class=
"org-keyword">if</span> (ast.ssrHelpers &amp;& ast.ssrHelpers.length) {
<span class="linenr"> 6259: </span>    push(
<span class="linenr"> 6260: </span>      <span class=
"org-string">`import { ${ast.ssrHelpers</span>
<span class="linenr"> 6261: </span><span class=
"org-string">        .map(s =&gt; `</span>${helperNameMap[s]} as _${helperNameMap[s]}<span class="org-string">`)</span>
<span class="linenr"> 6262: </span><span class=
"org-string">        .join(', ')} } from "${ssrRuntimeModuleName}"\n`</span>
<span class="linenr"> 6263: </span>    )
<span class="linenr"> 6264: </span>  }
<span class="linenr"> 6265: </span>
<span class="linenr"> 6266: </span>  <span class=
"org-keyword">if</span> (ast.imports.length) {
<span class=
"linenr"> 6267: </span>    genImports(ast.imports, context)
<span class="linenr"> 6268: </span>    newline()
<span class="linenr"> 6269: </span>  }
<span class="linenr"> 6270: </span>
<span class="linenr"> 6271: </span>  genHoists(ast.hoists, context)
<span class="linenr"> 6272: </span>  newline()
<span class="linenr"> 6273: </span>
<span class="linenr"> 6274: </span>  <span class=
"org-keyword">if</span> (!inline) {
<span class="linenr"> 6275: </span>    push(<span class=
"org-string">`export `</span>)
<span class="linenr"> 6276: </span>  }
<span class="linenr"> 6277: </span>}
<span class="linenr"> 6278: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genImports</span>(<span class=
"org-variable-name">importsOptions</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6279: </span>  <span class=
"org-keyword">if</span> (!importsOptions.length) {
<span class="linenr"> 6280: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 6281: </span>  }
<span class=
"linenr"> 6282: </span>  importsOptions.forEach(imports =&gt; {
<span class="linenr"> 6283: </span>    context.push(<span class=
"org-string">`import `</span>)
<span class=
"linenr"> 6284: </span>    genNode(imports.exp, context)
<span class="linenr"> 6285: </span>    context.push(<span class=
"org-string">` from '${imports.path}'`</span>)
<span class="linenr"> 6286: </span>    context.newline()
<span class="linenr"> 6287: </span>  })
<span class="linenr"> 6288: </span>}
<span class="linenr"> 6289: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genFunctionPreamble</span>(<span class=
"org-variable-name">ast</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6290: </span>  <span class=
"org-keyword">const</span> {
<span class="linenr"> 6291: </span>    ssr,
<span class="linenr"> 6292: </span>    prefixIdentifiers,
<span class="linenr"> 6293: </span>    push,
<span class="linenr"> 6294: </span>    newline,
<span class="linenr"> 6295: </span>    runtimeModuleName,
<span class="linenr"> 6296: </span>    runtimeGlobalName,
<span class="linenr"> 6297: </span>    ssrRuntimeModuleName
<span class="linenr"> 6298: </span>  } = context
<span class="linenr"> 6299: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">VueBinding</span> =
<span class="linenr"> 6300: </span>    !__BROWSER__ &amp;& ssr
<span class="linenr"> 6301: </span>      ? <span class=
"org-string">`require(${JSON.stringify(runtimeModuleName)})`</span>
<span class="linenr"> 6302: </span>      : runtimeGlobalName
<span class="linenr"> 6303: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">aliasHelper</span> = (s) =&gt; <span class=
"org-string">`${helperNameMap[s]}: _${helperNameMap[s]}`</span>
<span class="linenr"> 6304: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Generate const declaration for helpers</span>
<span class="linenr"> 6305: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">In prefix mode, we place the const declaration at top so it's done</span>
<span class="linenr"> 6306: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">only once; But if we not prefixing, we place the declaration inside the</span>
<span class="linenr"> 6307: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">with block so it doesn't incur the `in` check cost for every helper access.</span>
<span class="linenr"> 6308: </span>  <span class=
"org-keyword">if</span> (ast.helpers.length &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 6309: </span>    <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& prefixIdentifiers) {
<span class="linenr"> 6310: </span>      push(
<span class="linenr"> 6311: </span>        <span class=
"org-string">`const { ${ast.helpers.map(aliasHelper).join(', ')} } = ${VueBinding}\n`</span>
<span class="linenr"> 6312: </span>      )
<span class="linenr"> 6313: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6314: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">"with" mode.</span>
<span class="linenr"> 6315: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">save Vue in a separate variable to avoid collision</span>
<span class="linenr"> 6316: </span>      push(<span class=
"org-string">`const _Vue = ${VueBinding}\n`</span>)
<span class="linenr"> 6317: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in "with" mode, helpers are declared inside the with block to avoid</span>
<span class="linenr"> 6318: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">has check cost, but hoists are lifted out of the function - we need</span>
<span class="linenr"> 6319: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">to provide the helper here.</span>
<span class="linenr"> 6320: </span>      <span class=
"org-keyword">if</span> (ast.hoists.length) {
<span class="linenr"> 6321: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">staticHelpers</span> = [
<span class="linenr"> 6322: </span>          CREATE_VNODE,
<span class="linenr"> 6323: </span>          CREATE_ELEMENT_VNODE,
<span class="linenr"> 6324: </span>          CREATE_COMMENT,
<span class="linenr"> 6325: </span>          CREATE_TEXT,
<span class="linenr"> 6326: </span>          CREATE_STATIC
<span class="linenr"> 6327: </span>        ]
<span class=
"linenr"> 6328: </span>          .filter(helper =&gt; ast.helpers.includes(helper))
<span class="linenr"> 6329: </span>          .map(aliasHelper)
<span class="linenr"> 6330: </span>          .join(<span class=
"org-string">', '</span>)
<span class="linenr"> 6331: </span>        push(<span class=
"org-string">`const { ${staticHelpers} } = _Vue\n`</span>)
<span class="linenr"> 6332: </span>      }
<span class="linenr"> 6333: </span>    }
<span class="linenr"> 6334: </span>  }
<span class="linenr"> 6335: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">generate variables for ssr helpers</span>
<span class="linenr"> 6336: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& ast.ssrHelpers &amp;& ast.ssrHelpers.length) {
<span class="linenr"> 6337: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">ssr guarantees prefixIdentifier: true</span>
<span class="linenr"> 6338: </span>    push(
<span class="linenr"> 6339: </span>      <span class=
"org-string">`const { ${ast.ssrHelpers</span>
<span class="linenr"> 6340: </span><span class=
"org-string">        .map(aliasHelper)</span>
<span class="linenr"> 6341: </span><span class=
"org-string">        .join(', ')} } = require("${ssrRuntimeModuleName}")\n`</span>
<span class="linenr"> 6342: </span>    )
<span class="linenr"> 6343: </span>  }
<span class="linenr"> 6344: </span>  genHoists(ast.hoists, context)
<span class="linenr"> 6345: </span>  newline()
<span class="linenr"> 6346: </span>  push(<span class=
"org-string">`return `</span>)
<span class="linenr"> 6347: </span>}
<span class="linenr"> 6348: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genHoists</span>(<span class=
"org-variable-name">hoists</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6349: </span>  <span class=
"org-keyword">if</span> (!hoists.length) {
<span class="linenr"> 6350: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 6351: </span>  }
<span class="linenr"> 6352: </span>  context.pure = <span class=
"org-constant">true</span>
<span class="linenr"> 6353: </span>  <span class=
"org-keyword">const</span> { push, newline, helper, scopeId, mode } = context
<span class="linenr"> 6354: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">genScopeId</span> = !__BROWSER__ &amp;& scopeId != <span class="org-constant">null</span> &amp;& mode !== <span class="org-string">'function'</span>
<span class="linenr"> 6355: </span>  newline()
<span class="linenr"> 6356: </span>
<span class="linenr"> 6357: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">generate inlined withScopeId helper</span>
<span class="linenr"> 6358: </span>  <span class=
"org-keyword">if</span> (genScopeId) {
<span class="linenr"> 6359: </span>    push(
<span class="linenr"> 6360: </span>      <span class=
"org-string">`const _withScopeId = n =&gt; (${helper(</span>
<span class="linenr"> 6361: </span><span class=
"org-string">        PUSH_SCOPE_ID</span>
<span class="linenr"> 6362: </span><span class=
"org-string">      )}("${scopeId}"),n=n(),${helper(POP_SCOPE_ID)}(),n)`</span>
<span class="linenr"> 6363: </span>    )
<span class="linenr"> 6364: </span>    newline()
<span class="linenr"> 6365: </span>  }
<span class="linenr"> 6366: </span>
<span class="linenr"> 6367: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; hoists.length; i++) {
<span class="linenr"> 6368: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exp</span> = hoists[i]
<span class="linenr"> 6369: </span>    <span class=
"org-keyword">if</span> (exp) {
<span class="linenr"> 6370: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">needScopeIdWrapper</span> = genScopeId &amp;& exp.type === NodeTypes.VNODE_CALL
<span class="linenr"> 6371: </span>      push(
<span class="linenr"> 6372: </span>        <span class=
"org-string">`const _hoisted_${i + 1} = ${</span>
<span class="linenr"> 6373: </span><span class=
"org-string">          needScopeIdWrapper ? `</span>${PURE_ANNOTATION} _withScopeId(() =&gt; <span class="org-string">` : ``</span>
<span class="linenr"> 6374: </span><span class=
"org-string">        }`</span>
<span class="linenr"> 6375: </span>      )
<span class="linenr"> 6376: </span>      genNode(exp, context)
<span class="linenr"> 6377: </span>      <span class=
"org-keyword">if</span> (needScopeIdWrapper) {
<span class="linenr"> 6378: </span>        push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6379: </span>      }
<span class="linenr"> 6380: </span>      newline()
<span class="linenr"> 6381: </span>    }
<span class="linenr"> 6382: </span>  }
<span class="linenr"> 6383: </span>
<span class="linenr"> 6384: </span>  context.pure = <span class=
"org-constant">false</span>
<span class="linenr"> 6385: </span>}
<span class="linenr"> 6386: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">type = 'component' | 'directive' | 'filter'</span>
<span class="linenr"> 6387: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genAssets</span>(<span class=
"org-variable-name">assets</span>, <span class=
"org-variable-name">type</span>, { <span class=
"org-variable-name">helper</span>, <span class=
"org-variable-name">push</span>, <span class=
"org-variable-name">newline</span>, <span class=
"org-variable-name">isTS</span> }) {
<span class="linenr"> 6388: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">resolver</span> = helper(
<span class="linenr"> 6389: </span>    type === <span class=
"org-string">'component'</span>
<span class="linenr"> 6390: </span>      ? RESOLVE_COMPONENT
<span class="linenr"> 6391: </span>      : RESOLVE_DIRECTIVE
<span class="linenr"> 6392: </span>  )
<span class="linenr"> 6393: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; assets.length; i++) {
<span class="linenr"> 6394: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">id</span> = assets[i]
<span class="linenr"> 6395: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">potential component implicit self-reference inferred from SFC filename</span>
<span class="linenr"> 6396: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">maybeSelfReference</span> = id.endsWith(<span class="org-string">'__self'</span>)
<span class="linenr"> 6397: </span>    <span class=
"org-keyword">if</span> (maybeSelfReference) {
<span class="linenr"> 6398: </span>      id = id.slice(<span class=
"org-highlight-numbers-number">0</span>, -<span class=
"org-highlight-numbers-number">6</span>)
<span class="linenr"> 6399: </span>    }
<span class="linenr"> 6400: </span>    push(
<span class="linenr"> 6401: </span>      <span class=
"org-string">`const ${toValidAssetId(id, type)} = ${resolver}(${JSON.stringify(id)}${</span>
<span class="linenr"> 6402: </span><span class=
"org-string">        maybeSelfReference ? `</span>, <span class=
"org-constant">true</span><span class="org-string">` : ``</span>
<span class="linenr"> 6403: </span><span class=
"org-string">      })${isTS ? `</span>!<span class=
"org-string">` : ``}`</span>
<span class="linenr"> 6404: </span>    )
<span class="linenr"> 6405: </span>    <span class=
"org-keyword">if</span> (i &lt; assets.length - <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 6406: </span>      newline()
<span class="linenr"> 6407: </span>    }
<span class="linenr"> 6408: </span>  }
<span class="linenr"> 6409: </span>}
<span class="linenr"> 6410: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genText</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class=
"linenr"> 6411: </span>  context.push(JSON.stringify(node.content), node)
<span class="linenr"> 6412: </span>}
<span class="linenr"> 6413: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6414: </span>  <span class=
"org-keyword">const</span> { content, isStatic } = node
<span class=
"linenr"> 6415: </span>  context.push(isStatic ? JSON.stringify(content) : content, node)
<span class="linenr"> 6416: </span>}
<span class="linenr"> 6417: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genInterpolation</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6418: </span>  <span class=
"org-keyword">const</span> { push, helper, pure } = context
<span class="linenr"> 6419: </span>  <span class=
"org-keyword">if</span> (pure) push(PURE_ANNOTATION)
<span class="linenr"> 6420: </span>  push(<span class=
"org-string">`${helper(TO_DISPLAY_STRING)}(`</span>)
<span class="linenr"> 6421: </span>  genNode(node.content, context)
<span class="linenr"> 6422: </span>  push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6423: </span>}
<span class="linenr"> 6424: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genCompoundExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6425: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.children.length; i++) {
<span class="linenr"> 6426: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = node.children[i]
<span class="linenr"> 6427: </span>    <span class=
"org-keyword">if</span> (isString(child)) {
<span class="linenr"> 6428: </span>      context.push(child)
<span class="linenr"> 6429: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6430: </span>      genNode(child, context)
<span class="linenr"> 6431: </span>    }
<span class="linenr"> 6432: </span>  }
<span class="linenr"> 6433: </span>}
<span class="linenr"> 6434: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genComment</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6435: </span>  <span class=
"org-keyword">const</span> { push, helper, pure } = context
<span class="linenr"> 6436: </span>  <span class=
"org-keyword">if</span> (pure) {
<span class="linenr"> 6437: </span>    push(PURE_ANNOTATION)
<span class="linenr"> 6438: </span>  }
<span class="linenr"> 6439: </span>  push(<span class=
"org-string">`${helper(CREATE_COMMENT)}(${JSON.stringify(node.content)})`</span>, node)
<span class="linenr"> 6440: </span>}
<span class="linenr"> 6441: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genVNodeCall</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6442: </span>  <span class=
"org-keyword">const</span> { push, helper, pure } = context
<span class="linenr"> 6443: </span>  <span class=
"org-keyword">const</span> {
<span class="linenr"> 6444: </span>    tag,
<span class="linenr"> 6445: </span>    props,
<span class="linenr"> 6446: </span>    children,
<span class="linenr"> 6447: </span>    patchFlag,
<span class="linenr"> 6448: </span>    dynamicProps,
<span class="linenr"> 6449: </span>    directives,
<span class="linenr"> 6450: </span>    isBlock,
<span class="linenr"> 6451: </span>    disableTracking,
<span class="linenr"> 6452: </span>    isComponent
<span class="linenr"> 6453: </span>  } = node
<span class="linenr"> 6454: </span>  <span class=
"org-keyword">if</span> (directives) {
<span class=
"linenr"> 6455: </span>    push(helper(WITH_DIRECTIVES) + <span class="org-string">`(`</span>)
<span class="linenr"> 6456: </span>  }
<span class="linenr"> 6457: </span>  <span class=
"org-keyword">if</span> (isBlock) {
<span class="linenr"> 6458: </span>    push(<span class=
"org-string">`(${helper(OPEN_BLOCK)}(${disableTracking ? `</span><span class="org-constant">true</span><span class="org-string">` : ``}), `</span>)
<span class="linenr"> 6459: </span>  }
<span class="linenr"> 6460: </span>  <span class=
"org-keyword">if</span> (pure) {
<span class="linenr"> 6461: </span>    push(PURE_ANNOTATION)
<span class="linenr"> 6462: </span>  }
<span class="linenr"> 6463: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">callHelper</span> = isBlock
<span class=
"linenr"> 6464: </span>    ? getVNodeBlockHelper(context.inSSR, isComponent)
<span class=
"linenr"> 6465: </span>    : getVNodeHelper(context.inSSR, isComponent)
<span class=
"linenr"> 6466: </span>  push(helper(callHelper) + <span class=
"org-string">`(`</span>, node)
<span class="linenr"> 6467: </span>  genNodeList(
<span class=
"linenr"> 6468: </span>    genNullableArgs([tag, props, children, patchFlag, dynamicProps]),
<span class="linenr"> 6469: </span>    context
<span class="linenr"> 6470: </span>  )
<span class="linenr"> 6471: </span>  push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6472: </span>  <span class=
"org-keyword">if</span> (isBlock) {
<span class="linenr"> 6473: </span>    push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6474: </span>  }
<span class="linenr"> 6475: </span>  <span class=
"org-keyword">if</span> (directives) {
<span class="linenr"> 6476: </span>    push(<span class=
"org-string">`, `</span>)
<span class="linenr"> 6477: </span>    genNode(directives, context)
<span class="linenr"> 6478: </span>    push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6479: </span>  }
<span class="linenr"> 6480: </span>}
<span class="linenr"> 6481: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">JavaScript</span>
<span class="linenr"> 6482: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genCallExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6483: </span>  <span class=
"org-keyword">const</span> { push, helper, pure } = context
<span class="linenr"> 6484: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">callee</span> = isString(node.callee) ? node.callee : helper(node.callee)
<span class="linenr"> 6485: </span>  <span class=
"org-keyword">if</span> (pure) {
<span class="linenr"> 6486: </span>    push(PURE_ANNOTATION)
<span class="linenr"> 6487: </span>  }
<span class="linenr"> 6488: </span>  push(callee + <span class=
"org-string">`(`</span>, node)
<span class="linenr"> 6489: </span>  genNodeList(node.<span class=
"org-constant">arguments</span>, context)
<span class="linenr"> 6490: </span>  push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6491: </span>}
<span class="linenr"> 6492: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genObjectExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6493: </span>  <span class=
"org-keyword">const</span> { push, indent, deindent, newline } = context
<span class="linenr"> 6494: </span>  <span class=
"org-keyword">const</span> { properties } = node
<span class="linenr"> 6495: </span>  <span class=
"org-keyword">if</span> (!properties.length) {
<span class="linenr"> 6496: </span>    push(<span class=
"org-string">`{}`</span>, node)
<span class="linenr"> 6497: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 6498: </span>  }
<span class="linenr"> 6499: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">multilines</span> =
<span class=
"linenr"> 6500: </span>    properties.length &gt; <span class=
"org-highlight-numbers-number">1</span> ||
<span class=
"linenr"> 6501: </span>    ((!__BROWSER__ || __DEV__) &amp;&
<span class=
"linenr"> 6502: </span>      properties.some(p =&gt; p.value.type !== NodeTypes.SIMPLE_EXPRESSION))
<span class="linenr"> 6503: </span>  push(multilines ? <span class=
"org-string">`{`</span> : <span class="org-string">`{ `</span>)
<span class="linenr"> 6504: </span>  multilines &amp;& indent()
<span class="linenr"> 6505: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; properties.length; i++) {
<span class="linenr"> 6506: </span>    <span class=
"org-keyword">const</span> { key, value } = properties[i]
<span class="linenr"> 6507: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">key</span>
<span class=
"linenr"> 6508: </span>    genExpressionAsPropertyKey(key, context)
<span class="linenr"> 6509: </span>    push(<span class=
"org-string">`: `</span>)
<span class="linenr"> 6510: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">value</span>
<span class="linenr"> 6511: </span>    genNode(value, context)
<span class="linenr"> 6512: </span>    <span class=
"org-keyword">if</span> (i &lt; properties.length - <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 6513: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">will only reach this if it's multilines</span>
<span class="linenr"> 6514: </span>      push(<span class=
"org-string">`,`</span>)
<span class="linenr"> 6515: </span>      newline()
<span class="linenr"> 6516: </span>    }
<span class="linenr"> 6517: </span>  }
<span class="linenr"> 6518: </span>  multilines &amp;& deindent()
<span class="linenr"> 6519: </span>  push(multilines ? <span class=
"org-string">`}`</span> : <span class="org-string">` }`</span>)
<span class="linenr"> 6520: </span>}
<span class="linenr"> 6521: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genArrayExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class=
"linenr"> 6522: </span>  genNodeListAsArray(node.elements, context)
<span class="linenr"> 6523: </span>}
<span class="linenr"> 6524: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genFunctionExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6525: </span>  <span class=
"org-keyword">const</span> { push, indent, deindent } = context
<span class="linenr"> 6526: </span>  <span class=
"org-keyword">const</span> { params, returns, body, newline, isSlot } = node
<span class="linenr"> 6527: </span>  <span class=
"org-keyword">if</span> (isSlot) {
<span class="linenr"> 6528: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">wrap slot functions with owner context</span>
<span class="linenr"> 6529: </span>    push(<span class=
"org-string">`_${helperNameMap[WITH_CTX]}(`</span>)
<span class="linenr"> 6530: </span>  }
<span class="linenr"> 6531: </span>  push(<span class=
"org-string">`(`</span>, node)
<span class="linenr"> 6532: </span>  <span class=
"org-keyword">if</span> (isArray(params)) {
<span class="linenr"> 6533: </span>    genNodeList(params, context)
<span class="linenr"> 6534: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (params) {
<span class="linenr"> 6535: </span>    genNode(params, context)
<span class="linenr"> 6536: </span>  }
<span class="linenr"> 6537: </span>  push(<span class=
"org-string">`) =&gt; `</span>)
<span class="linenr"> 6538: </span>  <span class=
"org-keyword">if</span> (newline || body) {
<span class="linenr"> 6539: </span>    push(<span class=
"org-string">`{`</span>)
<span class="linenr"> 6540: </span>    indent()
<span class="linenr"> 6541: </span>  }
<span class="linenr"> 6542: </span>  <span class=
"org-keyword">if</span> (returns) {
<span class="linenr"> 6543: </span>    <span class=
"org-keyword">if</span> (newline) {
<span class="linenr"> 6544: </span>      push(<span class=
"org-string">`return `</span>)
<span class="linenr"> 6545: </span>    }
<span class="linenr"> 6546: </span>    <span class=
"org-keyword">if</span> (isArray(returns)) {
<span class=
"linenr"> 6547: </span>      genNodeListAsArray(returns, context)
<span class="linenr"> 6548: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6549: </span>      genNode(returns, context)
<span class="linenr"> 6550: </span>    }
<span class="linenr"> 6551: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (body) {
<span class="linenr"> 6552: </span>    genNode(body, context)
<span class="linenr"> 6553: </span>  }
<span class="linenr"> 6554: </span>  <span class=
"org-keyword">if</span> (newline || body) {
<span class="linenr"> 6555: </span>    deindent()
<span class="linenr"> 6556: </span>    push(<span class=
"org-string">`}`</span>)
<span class="linenr"> 6557: </span>  }
<span class="linenr"> 6558: </span>  <span class=
"org-keyword">if</span> (isSlot) {
<span class="linenr"> 6559: </span>    push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6560: </span>  }
<span class="linenr"> 6561: </span>}
<span class="linenr"> 6562: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genConditionalExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6563: </span>  <span class=
"org-keyword">const</span> { test, consequent, alternate, newline: needNewline } = node
<span class="linenr"> 6564: </span>  <span class=
"org-keyword">const</span> { push, indent, deindent, newline } = context
<span class="linenr"> 6565: </span>  <span class=
"org-keyword">if</span> (test.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr"> 6566: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">needsParens</span> = !isSimpleIdentifier(test.content)
<span class=
"linenr"> 6567: </span>    needsParens &amp;& push(<span class=
"org-string">`(`</span>)
<span class="linenr"> 6568: </span>    genExpression(test, context)
<span class=
"linenr"> 6569: </span>    needsParens &amp;& push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6570: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6571: </span>    push(<span class=
"org-string">`(`</span>)
<span class="linenr"> 6572: </span>    genNode(test, context)
<span class="linenr"> 6573: </span>    push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6574: </span>  }
<span class="linenr"> 6575: </span>  needNewline &amp;& indent()
<span class="linenr"> 6576: </span>  context.indentLevel++
<span class=
"linenr"> 6577: </span>  needNewline || push(<span class=
"org-string">` `</span>)
<span class="linenr"> 6578: </span>  push(<span class=
"org-string">`? `</span>)
<span class="linenr"> 6579: </span>  genNode(consequent, context)
<span class="linenr"> 6580: </span>  context.indentLevel--
<span class="linenr"> 6581: </span>  needNewline &amp;& newline()
<span class=
"linenr"> 6582: </span>  needNewline || push(<span class=
"org-string">` `</span>)
<span class="linenr"> 6583: </span>  push(<span class=
"org-string">`: `</span>)
<span class="linenr"> 6584: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isNested</span> = alternate.type === NodeTypes.JS_CONDITIONAL_EXPRESSION
<span class="linenr"> 6585: </span>  <span class=
"org-keyword">if</span> (!isNested) {
<span class="linenr"> 6586: </span>    context.indentLevel++
<span class="linenr"> 6587: </span>  }
<span class="linenr"> 6588: </span>  genNode(alternate, context)
<span class="linenr"> 6589: </span>  <span class=
"org-keyword">if</span> (!isNested) {
<span class="linenr"> 6590: </span>    context.indentLevel--
<span class="linenr"> 6591: </span>  }
<span class=
"linenr"> 6592: </span>  needNewline &amp;& deindent(<span class=
"org-constant">true</span> <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">without newline</span><span class=
"org-comment-delimiter"> */</span>)
<span class="linenr"> 6593: </span>}
<span class="linenr"> 6594: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genCacheExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6595: </span>  <span class=
"org-keyword">const</span> { push, helper, indent, deindent, newline } = context
<span class="linenr"> 6596: </span>  push(<span class=
"org-string">`_cache[${node.index}] || (`</span>)
<span class="linenr"> 6597: </span>  <span class=
"org-keyword">if</span> (node.isVNode) {
<span class="linenr"> 6598: </span>    indent()
<span class="linenr"> 6599: </span>    push(<span class=
"org-string">`${helper(SET_BLOCK_TRACKING)}(-1),`</span>)
<span class="linenr"> 6600: </span>    newline()
<span class="linenr"> 6601: </span>  }
<span class="linenr"> 6602: </span>  push(<span class=
"org-string">`_cache[${node.index}] = `</span>)
<span class="linenr"> 6603: </span>  genNode(node.value, context)
<span class="linenr"> 6604: </span>  <span class=
"org-keyword">if</span> (node.isVNode) {
<span class="linenr"> 6605: </span>    push(<span class=
"org-string">`,`</span>)
<span class="linenr"> 6606: </span>    newline()
<span class="linenr"> 6607: </span>    push(<span class=
"org-string">`${helper(SET_BLOCK_TRACKING)}(1),`</span>)
<span class="linenr"> 6608: </span>    newline()
<span class="linenr"> 6609: </span>    push(<span class=
"org-string">`_cache[${node.index}]`</span>)
<span class="linenr"> 6610: </span>    deindent()
<span class="linenr"> 6611: </span>  }
<span class="linenr"> 6612: </span>  push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6613: </span>}
<span class="linenr"> 6614: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genNodeList</span>(<span class=
"org-variable-name">nodes</span>, <span class=
"org-variable-name">context</span>, <span class=
"org-variable-name">multilines</span> = <span class=
"org-constant">false</span>, <span class=
"org-variable-name">comma</span> = <span class=
"org-constant">true</span>) {
<span class="linenr"> 6615: </span>  <span class=
"org-keyword">const</span> { push, newline } = context
<span class="linenr"> 6616: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; nodes.length; i++) {
<span class="linenr"> 6617: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> = nodes[i]
<span class="linenr"> 6618: </span>    <span class=
"org-keyword">if</span> (isString(node)) {
<span class="linenr"> 6619: </span>      push(node)
<span class="linenr"> 6620: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isArray(node)) {
<span class=
"linenr"> 6621: </span>      genNodeListAsArray(node, context)
<span class="linenr"> 6622: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6623: </span>      genNode(node, context)
<span class="linenr"> 6624: </span>    }
<span class="linenr"> 6625: </span>    <span class=
"org-keyword">if</span> (i &lt; nodes.length - <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 6626: </span>      <span class=
"org-keyword">if</span> (multilines) {
<span class=
"linenr"> 6627: </span>        comma &amp;& push(<span class=
"org-string">','</span>)
<span class="linenr"> 6628: </span>        newline()
<span class="linenr"> 6629: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 6630: </span>        comma &amp;& push(<span class=
"org-string">', '</span>)
<span class="linenr"> 6631: </span>      }
<span class="linenr"> 6632: </span>    }
<span class="linenr"> 6633: </span>  }
<span class="linenr"> 6634: </span>}
<span class="linenr"> 6635: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genTemplateLiteral</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6636: </span>  <span class=
"org-keyword">const</span> { push, indent, deindent } = context
<span class="linenr"> 6637: </span>  push(<span class=
"org-string">'`'</span>)
<span class="linenr"> 6638: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">l</span> = node.elements.length
<span class="linenr"> 6639: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">multilines</span> = l &gt; <span class=
"org-highlight-numbers-number">3</span>
<span class="linenr"> 6640: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; l; i++) {
<span class="linenr"> 6641: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">e</span> = node.elements[i]
<span class="linenr"> 6642: </span>    <span class=
"org-keyword">if</span> (isString(e)) {
<span class=
"linenr"> 6643: </span>      push(e.replace(<span class="org-string">/(`|\$|\\)/</span>g, <span class="org-string">'\\$1'</span>))
<span class="linenr"> 6644: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6645: </span>      push(<span class=
"org-string">'${'</span>)
<span class="linenr"> 6646: </span>      <span class=
"org-keyword">if</span> (multilines) indent()
<span class="linenr"> 6647: </span>      genNode(e, context)
<span class="linenr"> 6648: </span>      <span class=
"org-keyword">if</span> (multilines) deindent()
<span class="linenr"> 6649: </span>      push(<span class=
"org-string">'}'</span>)
<span class="linenr"> 6650: </span>    }
<span class="linenr"> 6651: </span>  }
<span class="linenr"> 6652: </span>  push(<span class=
"org-string">'`'</span>)
<span class="linenr"> 6653: </span>}
<span class="linenr"> 6654: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genIfStatement</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6655: </span>  <span class=
"org-keyword">const</span> { push, indent, deindent } = context
<span class="linenr"> 6656: </span>  <span class=
"org-keyword">const</span> { test, consequent, alternate } = node
<span class="linenr"> 6657: </span>  push(<span class=
"org-string">`if (`</span>)
<span class="linenr"> 6658: </span>  genNode(test, context)
<span class="linenr"> 6659: </span>  push(<span class=
"org-string">`) {`</span>)
<span class="linenr"> 6660: </span>  indent()
<span class="linenr"> 6661: </span>  genNode(consequent, context)
<span class="linenr"> 6662: </span>  deindent()
<span class="linenr"> 6663: </span>  push(<span class=
"org-string">`}`</span>)
<span class="linenr"> 6664: </span>  <span class=
"org-keyword">if</span> (alternate) {
<span class="linenr"> 6665: </span>    push(<span class=
"org-string">` else `</span>)
<span class="linenr"> 6666: </span>    <span class=
"org-keyword">if</span> (alternate.type === NodeTypes.JS_IF_STATEMENT) {
<span class=
"linenr"> 6667: </span>      genIfStatement(alternate, context)
<span class="linenr"> 6668: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6669: </span>      push(<span class=
"org-string">`{`</span>)
<span class="linenr"> 6670: </span>      indent()
<span class=
"linenr"> 6671: </span>      genNode(alternate, context)
<span class="linenr"> 6672: </span>      deindent()
<span class="linenr"> 6673: </span>      push(<span class=
"org-string">`}`</span>)
<span class="linenr"> 6674: </span>    }
<span class="linenr"> 6675: </span>  }
<span class="linenr"> 6676: </span>}
<span class="linenr"> 6677: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genAssignmentExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6678: </span>  genNode(node.left, context)
<span class="linenr"> 6679: </span>  context.push(<span class=
"org-string">` = `</span>)
<span class="linenr"> 6680: </span>  genNode(node.right, context)
<span class="linenr"> 6681: </span>}
<span class="linenr"> 6682: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genSequenceExpression</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6683: </span>  context.push(<span class=
"org-string">`(`</span>)
<span class=
"linenr"> 6684: </span>  genNodeList(node.expressions, context)
<span class="linenr"> 6685: </span>  context.push(<span class=
"org-string">`)`</span>)
<span class="linenr"> 6686: </span>}
<span class="linenr"> 6687: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genReturnStatement</span>({ returns }, context) {
<span class="linenr"> 6688: </span>  context.push(<span class=
"org-string">`return `</span>)
<span class="linenr"> 6689: </span>  <span class=
"org-keyword">if</span> (isArray(returns)) {
<span class=
"linenr"> 6690: </span>    genNodeListAsArray(returns, context)
<span class="linenr"> 6691: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6692: </span>    genNode(returns, context)
<span class="linenr"> 6693: </span>  }
<span class="linenr"> 6694: </span>}
<span class="linenr"> 6695: </span>
<span class="linenr"> 6696: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genNode</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6697: </span>  <span class=
"org-keyword">if</span> (isString(node)) {
<span class="linenr"> 6698: </span>    context.push(node)
<span class="linenr"> 6699: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 6700: </span>  }
<span class="linenr"> 6701: </span>  <span class=
"org-keyword">if</span> (isSymbol(node)) {
<span class=
"linenr"> 6702: </span>    context.push(context.helper(node))
<span class="linenr"> 6703: </span>    <span class=
"org-keyword">return</span>
<span class="linenr"> 6704: </span>  }
<span class="linenr"> 6705: </span>  <span class=
"org-keyword">switch</span> (node.type) {
<span class="linenr"> 6706: </span>    <span class=
"org-keyword">case</span> NodeTypes.ELEMENT:
<span class="linenr"> 6707: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF:
<span class="linenr"> 6708: </span>    <span class=
"org-keyword">case</span> NodeTypes.FOR:
<span class=
"linenr"> 6709: </span>      genNode(node.codegenNode, context)
<span class="linenr"> 6710: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6711: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT:
<span class="linenr"> 6712: </span>      genText(node, context)
<span class="linenr"> 6713: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6714: </span>    <span class=
"org-keyword">case</span> NodeTypes.SIMPLE_EXPRESSION:
<span class=
"linenr"> 6715: </span>      genExpression(node, context)
<span class="linenr"> 6716: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6717: </span>    <span class=
"org-keyword">case</span> NodeTypes.INTERPOLATION:
<span class=
"linenr"> 6718: </span>      genInterpolation(node, context)
<span class="linenr"> 6719: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6720: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT_CALL:
<span class=
"linenr"> 6721: </span>      genNode(node.codegenNode, context)
<span class="linenr"> 6722: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6723: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMPOUND_EXPRESSION:
<span class=
"linenr"> 6724: </span>      genCompoundExpression(node, context)
<span class="linenr"> 6725: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6726: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMMENT:
<span class="linenr"> 6727: </span>      genComment(node, context)
<span class="linenr"> 6728: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6729: </span>    <span class=
"org-keyword">case</span> NodeTypes.VNODE_CALL:
<span class=
"linenr"> 6730: </span>      genVNodeCall(node, context)
<span class="linenr"> 6731: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6732: </span>
<span class="linenr"> 6733: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_CALL_EXPRESSION:
<span class=
"linenr"> 6734: </span>      genCallExpression(node, context)
<span class="linenr"> 6735: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6736: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_OBJECT_EXPRESSION:
<span class=
"linenr"> 6737: </span>      genObjectExpression(node, context)
<span class="linenr"> 6738: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6739: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_ARRAY_EXPRESSION:
<span class=
"linenr"> 6740: </span>      genArrayExpression(node, context)
<span class="linenr"> 6741: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6742: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_FUNCTION_EXPRESSION:
<span class=
"linenr"> 6743: </span>      genFunctionExpression(node, context)
<span class="linenr"> 6744: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6745: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_CONDITIONAL_EXPRESSION:
<span class=
"linenr"> 6746: </span>      genConditionalExpression(node, context)
<span class="linenr"> 6747: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6748: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_CACHE_EXPRESSION:
<span class=
"linenr"> 6749: </span>      genCacheExpression(node, context)
<span class="linenr"> 6750: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6751: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_BLOCK_STATEMENT:
<span class=
"linenr"> 6752: </span>      genNodeList(node.body, context, <span class="org-constant">true</span>, <span class="org-constant">false</span>)
<span class="linenr"> 6753: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6754: </span>
<span class="linenr"> 6755: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">SSR only types</span>
<span class="linenr"> 6756: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_TEMPLATE_LITERAL:
<span class=
"linenr"> 6757: </span>      !__BROWSER__ &amp;& genTemplateLiteral(node, context)
<span class="linenr"> 6758: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6759: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_IF_STATEMENT:
<span class=
"linenr"> 6760: </span>      !__BROWSER__ &amp;& genIfStatement(node, context)
<span class="linenr"> 6761: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6762: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_ASSIGNMENT_EXPRESSION:
<span class=
"linenr"> 6763: </span>      !__BROWSER__ &amp;& genAssignmentExpression(node, context)
<span class="linenr"> 6764: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6765: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_SEQUENCE_EXPRESSION:
<span class=
"linenr"> 6766: </span>      !__BROWSER__ &amp;& genSequenceExpression(node, context)
<span class="linenr"> 6767: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6768: </span>    <span class=
"org-keyword">case</span> NodeTypes.JS_RETURN_STATEMENT:
<span class=
"linenr"> 6769: </span>      !__BROWSER__ &amp;& genReturnStatement(node, context)
<span class="linenr"> 6770: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6771: </span>
<span class="linenr"> 6772: </span>    <span class=
"org-comment-delimiter">/* </span><span class=
"org-comment">istanbul ignore next</span><span class=
"org-comment-delimiter"> */</span>
<span class="linenr"> 6773: </span>    <span class=
"org-keyword">case</span> NodeTypes.IF_BRANCH:
<span class="linenr"> 6774: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">noop</span>
<span class="linenr"> 6775: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 6776: </span>    <span class=
"org-keyword">default</span>:
<span class="linenr"> 6777: </span>      logg(<span class=
"org-string">`unhandled codegen node type: ${node.type}`</span>)
<span class="linenr"> 6778: </span>  }
<span class="linenr"> 6779: </span>}
<span class="linenr"> 6780: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genNodeListAsArray</span>(<span class=
"org-variable-name">nodes</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr"> 6781: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">multilines</span> =
<span class=
"linenr"> 6782: </span>    nodes.length &gt; <span class=
"org-highlight-numbers-number">3</span> ||
<span class=
"linenr"> 6783: </span>    ((!__BROWSER__ || __DEV__) &amp;& nodes.some(n =&gt; isArray(n) || !isText(n)))
<span class="linenr"> 6784: </span>  context.push(<span class=
"org-string">`[`</span>)
<span class=
"linenr"> 6785: </span>  multilines &amp;& context.indent()
<span class=
"linenr"> 6786: </span>  genNodeList(nodes, context, multilines)
<span class=
"linenr"> 6787: </span>  multilines &amp;& context.deindent()
<span class="linenr"> 6788: </span>  context.push(<span class=
"org-string">`]`</span>)
<span class="linenr"> 6789: </span>}
<span class="linenr"> 6790: </span>
<span class="linenr"> 6791: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">generate</span>(<span class=
"org-variable-name">ast</span>, <span class=
"org-variable-name">options</span> = {}) {
<span class="linenr"> 6792: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">context</span> = createCodegenContext(ast, options)
<span class="linenr"> 6793: </span>  <span class=
"org-keyword">if</span> (options.onContextCreated) options.onContextCreated(context)
<span class="linenr"> 6794: </span>  <span class=
"org-keyword">const</span> {
<span class="linenr"> 6795: </span>    mode,
<span class="linenr"> 6796: </span>    push,
<span class="linenr"> 6797: </span>    prefixIdentifiers,
<span class="linenr"> 6798: </span>    indent,
<span class="linenr"> 6799: </span>    deindent,
<span class="linenr"> 6800: </span>    newline,
<span class="linenr"> 6801: </span>    scopeId,
<span class="linenr"> 6802: </span>    ssr
<span class="linenr"> 6803: </span>  } = context
<span class="linenr"> 6804: </span>
<span class="linenr"> 6805: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hasHelpers</span> = ast.helpers.length &gt; <span class="org-highlight-numbers-number">0</span>
<span class="linenr"> 6806: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">useWithBlock</span> = !prefixIdentifiers &amp;& mode !== <span class="org-string">'module'</span>
<span class="linenr"> 6807: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">genScopeId</span> = !__BROWSER__ &amp;& scopeId != <span class="org-constant">null</span> &amp;& mode === <span class="org-string">'module'</span>
<span class="linenr"> 6808: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSetupInlined</span> = !__BROWSER__ &amp;& !!options.inline
<span class="linenr"> 6809: </span>
<span class="linenr"> 6810: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">preambles</span>
<span class="linenr"> 6811: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in setup() inline mode, the preamble is generated in a sub context</span>
<span class="linenr"> 6812: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">and returned separately.</span>
<span class="linenr"> 6813: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">preambleContext</span> = isSetupInlined
<span class=
"linenr"> 6814: </span>    ? createCodegenContext(ast, options)
<span class="linenr"> 6815: </span>    : context
<span class="linenr"> 6816: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& mode === <span class=
"org-string">'module'</span>) {
<span class=
"linenr"> 6817: </span>    genModulePreamble(ast, preambleContext, genScopeId, isSetupInlined)
<span class="linenr"> 6818: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 6819: </span>    genFunctionPreamble(ast, preambleContext)
<span class="linenr"> 6820: </span>  }
<span class="linenr"> 6821: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">enter render function</span>
<span class="linenr"> 6822: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">functionName</span> = ssr ? <span class=
"org-string">`ssrRender`</span> : <span class=
"org-string">`render`</span>
<span class="linenr"> 6823: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">args</span> = ssr ? [<span class=
"org-string">'_ctx'</span>, <span class=
"org-string">'_push'</span>, <span class=
"org-string">'_parent'</span>, <span class=
"org-string">'_attrs'</span>] : [<span class=
"org-string">'_ctx'</span>, <span class=
"org-string">'_cache'</span>]
<span class="linenr"> 6824: </span>  <span class=
"org-keyword">if</span> (!__BROWSER__ &amp;& options.bindingMetadata &amp;& !options.inline) {
<span class="linenr"> 6825: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">binding optimization args</span>
<span class="linenr"> 6826: </span>    args.push(<span class=
"org-string">'$props'</span>, <span class=
"org-string">'$setup'</span>, <span class=
"org-string">'$data'</span>, <span class=
"org-string">'$options'</span>)
<span class="linenr"> 6827: </span>  }
<span class="linenr"> 6828: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">signature</span> =
<span class=
"linenr"> 6829: </span>    !__BROWSER__ &amp;& options.isTS
<span class=
"linenr"> 6830: </span>      ? args.map(arg =&gt; <span class=
"org-string">`${arg}: any`</span>).join(<span class=
"org-string">','</span>)
<span class="linenr"> 6831: </span>      : args.join(<span class=
"org-string">', '</span>)
<span class="linenr"> 6832: </span>
<span class="linenr"> 6833: </span>  <span class=
"org-keyword">if</span> (isSetupInlined) {
<span class="linenr"> 6834: </span>    push(<span class=
"org-string">`(${signature}) =&gt; {`</span>)
<span class="linenr"> 6835: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6836: </span>    push(<span class=
"org-string">`function ${functionName}(${signature}) {`</span>)
<span class="linenr"> 6837: </span>  }
<span class="linenr"> 6838: </span>  indent()
<span class="linenr"> 6839: </span>
<span class="linenr"> 6840: </span>  <span class=
"org-keyword">if</span> (useWithBlock) {
<span class="linenr"> 6841: </span>    push(<span class=
"org-string">`with (_ctx) {`</span>)
<span class="linenr"> 6842: </span>    indent()
<span class="linenr"> 6843: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">function mode const declarations should be inside with block</span>
<span class="linenr"> 6844: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">also they should be renamed to avoid collision with user properties</span>
<span class="linenr"> 6845: </span>    <span class=
"org-keyword">if</span> (hasHelpers) {
<span class="linenr"> 6846: </span>      push(
<span class="linenr"> 6847: </span>        <span class=
"org-string">`const { ${ast.helpers</span>
<span class="linenr"> 6848: </span><span class=
"org-string">          .map(s =&gt; `</span>${helperNameMap[s]}: _${helperNameMap[s]}<span class="org-string">`)</span>
<span class="linenr"> 6849: </span><span class=
"org-string">          .join(', ')} } = _Vue`</span>
<span class="linenr"> 6850: </span>      )
<span class="linenr"> 6851: </span>      push(<span class=
"org-string">`\n`</span>)
<span class="linenr"> 6852: </span>      newline()
<span class="linenr"> 6853: </span>    }
<span class="linenr"> 6854: </span>  }
<span class="linenr"> 6855: </span>
<span class="linenr"> 6856: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">generate asset resolution statements</span>
<span class="linenr"> 6857: </span>  <span class=
"org-keyword">if</span> (ast.components.length) {
<span class=
"linenr"> 6858: </span>    genAssets(ast.components, <span class=
"org-string">'component'</span>, context)
<span class="linenr"> 6859: </span>    <span class=
"org-keyword">if</span> (ast.directives.length || ast.temps &gt; <span class="org-highlight-numbers-number">0</span>) {
<span class="linenr"> 6860: </span>      newline()
<span class="linenr"> 6861: </span>    }
<span class="linenr"> 6862: </span>  }
<span class="linenr"> 6863: </span>  <span class=
"org-keyword">if</span> (ast.directives.length) {
<span class=
"linenr"> 6864: </span>    genAssets(ast.directives, <span class=
"org-string">'directive'</span>, context)
<span class="linenr"> 6865: </span>    <span class=
"org-keyword">if</span> (ast.temps &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 6866: </span>      newline()
<span class="linenr"> 6867: </span>    }
<span class="linenr"> 6868: </span>  }
<span class="linenr"> 6869: </span>
<span class="linenr"> 6870: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">临时变量</span>
<span class="linenr"> 6871: </span>  <span class=
"org-keyword">if</span> (ast.temps &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 6872: </span>    push(<span class=
"org-string">`let `</span>)
<span class="linenr"> 6873: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; ast.temps; i++) {
<span class="linenr"> 6874: </span>      push(<span class=
"org-string">`${i &gt; 0 ? `</span>, <span class=
"org-string">` : ``}_temp${i}`</span>)
<span class="linenr"> 6875: </span>    }
<span class="linenr"> 6876: </span>  }
<span class="linenr"> 6877: </span>  <span class=
"org-keyword">if</span> (ast.components.length || ast.directives.length || ast.temps) {
<span class="linenr"> 6878: </span>    push(<span class=
"org-string">`\n`</span>)
<span class="linenr"> 6879: </span>    newline()
<span class="linenr"> 6880: </span>  }
<span class="linenr"> 6881: </span>
<span class="linenr"> 6882: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">generate the VNode tree expression</span>
<span class="linenr"> 6883: </span>  <span class=
"org-keyword">if</span> (!ssr) {
<span class="linenr"> 6884: </span>    push(<span class=
"org-string">`return `</span>)
<span class="linenr"> 6885: </span>  }
<span class="linenr"> 6886: </span>  <span class=
"org-keyword">if</span> (ast.codegenNode) {
<span class=
"linenr"> 6887: </span>    genNode(ast.codegenNode, context)
<span class="linenr"> 6888: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 6889: </span>    push(<span class=
"org-string">`null`</span>)
<span class="linenr"> 6890: </span>  }
<span class="linenr"> 6891: </span>
<span class="linenr"> 6892: </span>  <span class=
"org-keyword">if</span> (useWithBlock) {
<span class="linenr"> 6893: </span>    deindent()
<span class="linenr"> 6894: </span>    push(<span class=
"org-string">`}`</span>)
<span class="linenr"> 6895: </span>  }
<span class="linenr"> 6896: </span>
<span class="linenr"> 6897: </span>  deindent()
<span class="linenr"> 6898: </span>  push(<span class=
"org-string">`}`</span>)
<span class="linenr"> 6899: </span>
<span class="linenr"> 6900: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 6901: </span>    ast,
<span class="linenr"> 6902: </span>    code: context.code,
<span class=
"linenr"> 6903: </span>    preamble: isSetupInlined ? preambleContext.code : <span class="org-string">``</span>,
<span class="linenr"> 6904: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">SourceMapGenerator does have toJSON() method but it's not in the types</span>
<span class=
"linenr"> 6905: </span>    map: context.map ? context.map.toJSON() : <span class="org-constant">undefined</span>
<span class="linenr"> 6906: </span>  }
<span class="linenr"> 6907: </span>}
<span class="linenr"> 6908: </span>
<span class="linenr"> 6909: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">baseCompile</span>(<span class=
"org-variable-name">template</span>, <span class=
"org-variable-name">options</span> = {}) {
<span class="linenr"> 6910: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isModuleMode</span> = options.mode === <span class="org-string">'module'</span>
<span class="linenr"> 6911: </span>
<span class="linenr"> 6912: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prefixIdentifiers</span> =
<span class=
"linenr"> 6913: </span>    !__BROWSER__ &amp;& (options.prefixIdentifiers === <span class="org-constant">true</span> || isModuleMode)
<span class="linenr"> 6914: </span>
<span class="linenr"> 6915: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ast</span> = isString(template) ? baseParse(template, options) : template
<span class="linenr"> 6916: </span>  <span class=
"org-keyword">const</span> [<span class=
"org-variable-name">nodeTransforms</span>, <span class=
"org-variable-name">directiveTransforms</span>] = getBaseTransformPreset(prefixIdentifiers)
<span class="linenr"> 6917: </span>
<span class="linenr"> 6918: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">转换出每个节点的 codegenNode</span>
<span class="linenr"> 6919: </span>  transform(
<span class="linenr"> 6920: </span>    ast,
<span class="linenr"> 6921: </span>    extend({}, options, {
<span class="linenr"> 6922: </span>      prefixIdentifiers,
<span class="linenr"> 6923: </span>      nodeTransforms: [
<span class="linenr"> 6924: </span>        ...nodeTransforms,
<span class=
"linenr"> 6925: </span>        ...(options.nodeTransforms || []) <span class="org-comment-delimiter">// </span><span class="org-comment">user transforms</span>
<span class="linenr"> 6926: </span>      ],
<span class=
"linenr"> 6927: </span>      directiveTransforms: extend(
<span class="linenr"> 6928: </span>        {},
<span class="linenr"> 6929: </span>        directiveTransforms,
<span class=
"linenr"> 6930: </span>        options.directiveTransforms || {} <span class="org-comment-delimiter">// </span><span class="org-comment">user transforms</span>
<span class="linenr"> 6931: </span>      )
<span class="linenr"> 6932: </span>    })
<span class="linenr"> 6933: </span>  )
<span class="linenr"> 6934: </span>
<span class="linenr"> 6935: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">生成 codegen</span>
<span class="linenr"> 6936: </span>  <span class=
"org-keyword">return</span> generate(ast, extend({}, options, { prefixIdentifiers }))
<span class="linenr"> 6937: </span>}
<span class="linenr"> 6938: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">namedCharacterReferences</span> = {
<span class="linenr"> 6939: </span>  <span class=
"org-string">"GT"</span>: <span class="org-string">"&gt;"</span>,
<span class="linenr"> 6940: </span>  <span class=
"org-string">"gt"</span>: <span class="org-string">"&gt;"</span>,
<span class="linenr"> 6941: </span>  <span class=
"org-string">"LT"</span>: <span class="org-string">"&lt;"</span>,
<span class="linenr"> 6942: </span>  <span class=
"org-string">"lt"</span>: <span class="org-string">"&lt;"</span>,
<span class="linenr"> 6943: </span>  <span class=
"org-string">"ac;"</span>: <span class="org-string">"∾"</span>,
<span class="linenr"> 6944: </span>  <span class=
"org-string">"af;"</span>: <span class="org-string">"⁡"</span>,
<span class="linenr"> 6945: </span>  <span class=
"org-string">"AMP"</span>: <span class="org-string">"&amp;"</span>,
<span class="linenr"> 6946: </span>  <span class=
"org-string">"amp"</span>: <span class="org-string">"&amp;"</span>,
<span class="linenr"> 6947: </span>  <span class=
"org-string">"ap;"</span>: <span class="org-string">"≈"</span>,
<span class="linenr"> 6948: </span>  <span class=
"org-string">"DD;"</span>: <span class="org-string">"ⅅ"</span>,
<span class="linenr"> 6949: </span>  <span class=
"org-string">"dd;"</span>: <span class="org-string">"ⅆ"</span>,
<span class="linenr"> 6950: </span>  <span class=
"org-string">"deg"</span>: <span class="org-string">"°"</span>,
<span class="linenr"> 6951: </span>  <span class=
"org-string">"ee;"</span>: <span class="org-string">"ⅇ"</span>,
<span class="linenr"> 6952: </span>  <span class=
"org-string">"eg;"</span>: <span class="org-string">"⪚"</span>,
<span class="linenr"> 6953: </span>  <span class=
"org-string">"el;"</span>: <span class="org-string">"⪙"</span>,
<span class="linenr"> 6954: </span>  <span class=
"org-string">"ETH"</span>: <span class="org-string">"Ð"</span>,
<span class="linenr"> 6955: </span>  <span class=
"org-string">"eth"</span>: <span class="org-string">"ð"</span>,
<span class="linenr"> 6956: </span>  <span class=
"org-string">"gE;"</span>: <span class="org-string">"≧"</span>,
<span class="linenr"> 6957: </span>  <span class=
"org-string">"ge;"</span>: <span class="org-string">"≥"</span>,
<span class="linenr"> 6958: </span>  <span class=
"org-string">"Gg;"</span>: <span class="org-string">"⋙"</span>,
<span class="linenr"> 6959: </span>  <span class=
"org-string">"gg;"</span>: <span class="org-string">"≫"</span>,
<span class="linenr"> 6960: </span>  <span class=
"org-string">"gl;"</span>: <span class="org-string">"≷"</span>,
<span class="linenr"> 6961: </span>  <span class=
"org-string">"GT;"</span>: <span class="org-string">"&gt;"</span>,
<span class="linenr"> 6962: </span>  <span class=
"org-string">"Gt;"</span>: <span class="org-string">"≫"</span>,
<span class="linenr"> 6963: </span>  <span class=
"org-string">"gt;"</span>: <span class="org-string">"&gt;"</span>,
<span class="linenr"> 6964: </span>  <span class=
"org-string">"ic;"</span>: <span class="org-string">"⁣"</span>,
<span class="linenr"> 6965: </span>  <span class=
"org-string">"ii;"</span>: <span class="org-string">"ⅈ"</span>,
<span class="linenr"> 6966: </span>  <span class=
"org-string">"Im;"</span>: <span class="org-string">"ℑ"</span>,
<span class="linenr"> 6967: </span>  <span class=
"org-string">"in;"</span>: <span class="org-string">"∈"</span>,
<span class="linenr"> 6968: </span>  <span class=
"org-string">"it;"</span>: <span class="org-string">"⁢"</span>,
<span class="linenr"> 6969: </span>  <span class=
"org-string">"lE;"</span>: <span class="org-string">"≦"</span>,
<span class="linenr"> 6970: </span>  <span class=
"org-string">"le;"</span>: <span class="org-string">"≤"</span>,
<span class="linenr"> 6971: </span>  <span class=
"org-string">"lg;"</span>: <span class="org-string">"≶"</span>,
<span class="linenr"> 6972: </span>  <span class=
"org-string">"Ll;"</span>: <span class="org-string">"⋘"</span>,
<span class="linenr"> 6973: </span>  <span class=
"org-string">"ll;"</span>: <span class="org-string">"≪"</span>,
<span class="linenr"> 6974: </span>  <span class=
"org-string">"LT;"</span>: <span class="org-string">"&lt;"</span>,
<span class="linenr"> 6975: </span>  <span class=
"org-string">"Lt;"</span>: <span class="org-string">"≪"</span>,
<span class="linenr"> 6976: </span>  <span class=
"org-string">"lt;"</span>: <span class="org-string">"&lt;"</span>,
<span class="linenr"> 6977: </span>  <span class=
"org-string">"mp;"</span>: <span class="org-string">"∓"</span>,
<span class="linenr"> 6978: </span>  <span class=
"org-string">"Mu;"</span>: <span class="org-string">"Μ"</span>,
<span class="linenr"> 6979: </span>  <span class=
"org-string">"mu;"</span>: <span class="org-string">"μ"</span>,
<span class="linenr"> 6980: </span>  <span class=
"org-string">"ne;"</span>: <span class="org-string">"≠"</span>,
<span class="linenr"> 6981: </span>  <span class=
"org-string">"ni;"</span>: <span class="org-string">"∋"</span>,
<span class="linenr"> 6982: </span>  <span class=
"org-string">"not"</span>: <span class="org-string">"¬"</span>,
<span class="linenr"> 6983: </span>  <span class=
"org-string">"Nu;"</span>: <span class="org-string">"Ν"</span>,
<span class="linenr"> 6984: </span>  <span class=
"org-string">"nu;"</span>: <span class="org-string">"ν"</span>,
<span class="linenr"> 6985: </span>  <span class=
"org-string">"Or;"</span>: <span class="org-string">"⩔"</span>,
<span class="linenr"> 6986: </span>  <span class=
"org-string">"or;"</span>: <span class="org-string">"∨"</span>,
<span class="linenr"> 6987: </span>  <span class=
"org-string">"oS;"</span>: <span class="org-string">"Ⓢ"</span>,
<span class="linenr"> 6988: </span>  <span class=
"org-string">"Pi;"</span>: <span class="org-string">"Π"</span>,
<span class="linenr"> 6989: </span>  <span class=
"org-string">"pi;"</span>: <span class="org-string">"π"</span>,
<span class="linenr"> 6990: </span>  <span class=
"org-string">"pm;"</span>: <span class="org-string">"±"</span>,
<span class="linenr"> 6991: </span>  <span class=
"org-string">"Pr;"</span>: <span class="org-string">"⪻"</span>,
<span class="linenr"> 6992: </span>  <span class=
"org-string">"pr;"</span>: <span class="org-string">"≺"</span>,
<span class="linenr"> 6993: </span>  <span class=
"org-string">"Re;"</span>: <span class="org-string">"ℜ"</span>,
<span class="linenr"> 6994: </span>  <span class=
"org-string">"REG"</span>: <span class="org-string">"®"</span>,
<span class="linenr"> 6995: </span>  <span class=
"org-string">"reg"</span>: <span class="org-string">"®"</span>,
<span class="linenr"> 6996: </span>  <span class=
"org-string">"rx;"</span>: <span class="org-string">"℞"</span>,
<span class="linenr"> 6997: </span>  <span class=
"org-string">"Sc;"</span>: <span class="org-string">"⪼"</span>,
<span class="linenr"> 6998: </span>  <span class=
"org-string">"sc;"</span>: <span class="org-string">"≻"</span>,
<span class="linenr"> 6999: </span>  <span class=
"org-string">"shy"</span>: <span class="org-string">"­"</span>,
<span class="linenr"> 7000: </span>  <span class=
"org-string">"uml"</span>: <span class="org-string">"¨"</span>,
<span class="linenr"> 7001: </span>  <span class=
"org-string">"wp;"</span>: <span class="org-string">"℘"</span>,
<span class="linenr"> 7002: </span>  <span class=
"org-string">"wr;"</span>: <span class="org-string">"≀"</span>,
<span class="linenr"> 7003: </span>  <span class=
"org-string">"Xi;"</span>: <span class="org-string">"Ξ"</span>,
<span class="linenr"> 7004: </span>  <span class=
"org-string">"xi;"</span>: <span class="org-string">"ξ"</span>,
<span class="linenr"> 7005: </span>  <span class=
"org-string">"yen"</span>: <span class="org-string">"¥"</span>,
<span class="linenr"> 7006: </span>  <span class=
"org-string">"acd;"</span>: <span class="org-string">"∿"</span>,
<span class="linenr"> 7007: </span>  <span class=
"org-string">"acE;"</span>: <span class="org-string">"∾̳"</span>,
<span class="linenr"> 7008: </span>  <span class=
"org-string">"Acy;"</span>: <span class="org-string">"А"</span>,
<span class="linenr"> 7009: </span>  <span class=
"org-string">"acy;"</span>: <span class="org-string">"а"</span>,
<span class="linenr"> 7010: </span>  <span class=
"org-string">"Afr;"</span>: <span class="org-string">"𝔄"</span>,
<span class="linenr"> 7011: </span>  <span class=
"org-string">"afr;"</span>: <span class="org-string">"𝔞"</span>,
<span class="linenr"> 7012: </span>  <span class=
"org-string">"AMP;"</span>: <span class=
"org-string">"&amp;"</span>,
<span class="linenr"> 7013: </span>  <span class=
"org-string">"amp;"</span>: <span class=
"org-string">"&amp;"</span>,
<span class="linenr"> 7014: </span>  <span class=
"org-string">"And;"</span>: <span class="org-string">"⩓"</span>,
<span class="linenr"> 7015: </span>  <span class=
"org-string">"and;"</span>: <span class="org-string">"∧"</span>,
<span class="linenr"> 7016: </span>  <span class=
"org-string">"ang;"</span>: <span class="org-string">"∠"</span>,
<span class="linenr"> 7017: </span>  <span class=
"org-string">"apE;"</span>: <span class="org-string">"⩰"</span>,
<span class="linenr"> 7018: </span>  <span class=
"org-string">"ape;"</span>: <span class="org-string">"≊"</span>,
<span class="linenr"> 7019: </span>  <span class=
"org-string">"ast;"</span>: <span class="org-string">"*"</span>,
<span class="linenr"> 7020: </span>  <span class=
"org-string">"Auml"</span>: <span class="org-string">"Ä"</span>,
<span class="linenr"> 7021: </span>  <span class=
"org-string">"auml"</span>: <span class="org-string">"ä"</span>,
<span class="linenr"> 7022: </span>  <span class=
"org-string">"Bcy;"</span>: <span class="org-string">"Б"</span>,
<span class="linenr"> 7023: </span>  <span class=
"org-string">"bcy;"</span>: <span class="org-string">"б"</span>,
<span class="linenr"> 7024: </span>  <span class=
"org-string">"Bfr;"</span>: <span class="org-string">"𝔅"</span>,
<span class="linenr"> 7025: </span>  <span class=
"org-string">"bfr;"</span>: <span class="org-string">"𝔟"</span>,
<span class="linenr"> 7026: </span>  <span class=
"org-string">"bne;"</span>: <span class="org-string">"=⃥"</span>,
<span class="linenr"> 7027: </span>  <span class=
"org-string">"bot;"</span>: <span class="org-string">"⊥"</span>,
<span class="linenr"> 7028: </span>  <span class=
"org-string">"Cap;"</span>: <span class="org-string">"⋒"</span>,
<span class="linenr"> 7029: </span>  <span class=
"org-string">"cap;"</span>: <span class="org-string">"∩"</span>,
<span class="linenr"> 7030: </span>  <span class=
"org-string">"cent"</span>: <span class="org-string">"¢"</span>,
<span class="linenr"> 7031: </span>  <span class=
"org-string">"Cfr;"</span>: <span class="org-string">"ℭ"</span>,
<span class="linenr"> 7032: </span>  <span class=
"org-string">"cfr;"</span>: <span class="org-string">"𝔠"</span>,
<span class="linenr"> 7033: </span>  <span class=
"org-string">"Chi;"</span>: <span class="org-string">"Χ"</span>,
<span class="linenr"> 7034: </span>  <span class=
"org-string">"chi;"</span>: <span class="org-string">"χ"</span>,
<span class="linenr"> 7035: </span>  <span class=
"org-string">"cir;"</span>: <span class="org-string">"○"</span>,
<span class="linenr"> 7036: </span>  <span class=
"org-string">"COPY"</span>: <span class="org-string">"©"</span>,
<span class="linenr"> 7037: </span>  <span class=
"org-string">"copy"</span>: <span class="org-string">"©"</span>,
<span class="linenr"> 7038: </span>  <span class=
"org-string">"Cup;"</span>: <span class="org-string">"⋓"</span>,
<span class="linenr"> 7039: </span>  <span class=
"org-string">"cup;"</span>: <span class="org-string">"∪"</span>,
<span class="linenr"> 7040: </span>  <span class=
"org-string">"Dcy;"</span>: <span class="org-string">"Д"</span>,
<span class="linenr"> 7041: </span>  <span class=
"org-string">"dcy;"</span>: <span class="org-string">"д"</span>,
<span class="linenr"> 7042: </span>  <span class=
"org-string">"deg;"</span>: <span class="org-string">"°"</span>,
<span class="linenr"> 7043: </span>  <span class=
"org-string">"Del;"</span>: <span class="org-string">"∇"</span>,
<span class="linenr"> 7044: </span>  <span class=
"org-string">"Dfr;"</span>: <span class="org-string">"𝔇"</span>,
<span class="linenr"> 7045: </span>  <span class=
"org-string">"dfr;"</span>: <span class="org-string">"𝔡"</span>,
<span class="linenr"> 7046: </span>  <span class=
"org-string">"die;"</span>: <span class="org-string">"¨"</span>,
<span class="linenr"> 7047: </span>  <span class=
"org-string">"div;"</span>: <span class="org-string">"÷"</span>,
<span class="linenr"> 7048: </span>  <span class=
"org-string">"Dot;"</span>: <span class="org-string">"¨"</span>,
<span class="linenr"> 7049: </span>  <span class=
"org-string">"dot;"</span>: <span class="org-string">"˙"</span>,
<span class="linenr"> 7050: </span>  <span class=
"org-string">"Ecy;"</span>: <span class="org-string">"Э"</span>,
<span class="linenr"> 7051: </span>  <span class=
"org-string">"ecy;"</span>: <span class="org-string">"э"</span>,
<span class="linenr"> 7052: </span>  <span class=
"org-string">"Efr;"</span>: <span class="org-string">"𝔈"</span>,
<span class="linenr"> 7053: </span>  <span class=
"org-string">"efr;"</span>: <span class="org-string">"𝔢"</span>,
<span class="linenr"> 7054: </span>  <span class=
"org-string">"egs;"</span>: <span class="org-string">"⪖"</span>,
<span class="linenr"> 7055: </span>  <span class=
"org-string">"ell;"</span>: <span class="org-string">"ℓ"</span>,
<span class="linenr"> 7056: </span>  <span class=
"org-string">"els;"</span>: <span class="org-string">"⪕"</span>,
<span class="linenr"> 7057: </span>  <span class=
"org-string">"ENG;"</span>: <span class="org-string">"Ŋ"</span>,
<span class="linenr"> 7058: </span>  <span class=
"org-string">"eng;"</span>: <span class="org-string">"ŋ"</span>,
<span class="linenr"> 7059: </span>  <span class=
"org-string">"Eta;"</span>: <span class="org-string">"Η"</span>,
<span class="linenr"> 7060: </span>  <span class=
"org-string">"eta;"</span>: <span class="org-string">"η"</span>,
<span class="linenr"> 7061: </span>  <span class=
"org-string">"ETH;"</span>: <span class="org-string">"Ð"</span>,
<span class="linenr"> 7062: </span>  <span class=
"org-string">"eth;"</span>: <span class="org-string">"ð"</span>,
<span class="linenr"> 7063: </span>  <span class=
"org-string">"Euml"</span>: <span class="org-string">"Ë"</span>,
<span class="linenr"> 7064: </span>  <span class=
"org-string">"euml"</span>: <span class="org-string">"ë"</span>,
<span class="linenr"> 7065: </span>  <span class=
"org-string">"Fcy;"</span>: <span class="org-string">"Ф"</span>,
<span class="linenr"> 7066: </span>  <span class=
"org-string">"fcy;"</span>: <span class="org-string">"ф"</span>,
<span class="linenr"> 7067: </span>  <span class=
"org-string">"Ffr;"</span>: <span class="org-string">"𝔉"</span>,
<span class="linenr"> 7068: </span>  <span class=
"org-string">"ffr;"</span>: <span class="org-string">"𝔣"</span>,
<span class="linenr"> 7069: </span>  <span class=
"org-string">"gap;"</span>: <span class="org-string">"⪆"</span>,
<span class="linenr"> 7070: </span>  <span class=
"org-string">"Gcy;"</span>: <span class="org-string">"Г"</span>,
<span class="linenr"> 7071: </span>  <span class=
"org-string">"gcy;"</span>: <span class="org-string">"г"</span>,
<span class="linenr"> 7072: </span>  <span class=
"org-string">"gEl;"</span>: <span class="org-string">"⪌"</span>,
<span class="linenr"> 7073: </span>  <span class=
"org-string">"gel;"</span>: <span class="org-string">"⋛"</span>,
<span class="linenr"> 7074: </span>  <span class=
"org-string">"geq;"</span>: <span class="org-string">"≥"</span>,
<span class="linenr"> 7075: </span>  <span class=
"org-string">"ges;"</span>: <span class="org-string">"⩾"</span>,
<span class="linenr"> 7076: </span>  <span class=
"org-string">"Gfr;"</span>: <span class="org-string">"𝔊"</span>,
<span class="linenr"> 7077: </span>  <span class=
"org-string">"gfr;"</span>: <span class="org-string">"𝔤"</span>,
<span class="linenr"> 7078: </span>  <span class=
"org-string">"ggg;"</span>: <span class="org-string">"⋙"</span>,
<span class="linenr"> 7079: </span>  <span class=
"org-string">"gla;"</span>: <span class="org-string">"⪥"</span>,
<span class="linenr"> 7080: </span>  <span class=
"org-string">"glE;"</span>: <span class="org-string">"⪒"</span>,
<span class="linenr"> 7081: </span>  <span class=
"org-string">"glj;"</span>: <span class="org-string">"⪤"</span>,
<span class="linenr"> 7082: </span>  <span class=
"org-string">"gnE;"</span>: <span class="org-string">"≩"</span>,
<span class="linenr"> 7083: </span>  <span class=
"org-string">"gne;"</span>: <span class="org-string">"⪈"</span>,
<span class="linenr"> 7084: </span>  <span class=
"org-string">"Hat;"</span>: <span class="org-string">"^"</span>,
<span class="linenr"> 7085: </span>  <span class=
"org-string">"Hfr;"</span>: <span class="org-string">"ℌ"</span>,
<span class="linenr"> 7086: </span>  <span class=
"org-string">"hfr;"</span>: <span class="org-string">"𝔥"</span>,
<span class="linenr"> 7087: </span>  <span class=
"org-string">"Icy;"</span>: <span class="org-string">"И"</span>,
<span class="linenr"> 7088: </span>  <span class=
"org-string">"icy;"</span>: <span class="org-string">"и"</span>,
<span class="linenr"> 7089: </span>  <span class=
"org-string">"iff;"</span>: <span class="org-string">"⇔"</span>,
<span class="linenr"> 7090: </span>  <span class=
"org-string">"Ifr;"</span>: <span class="org-string">"ℑ"</span>,
<span class="linenr"> 7091: </span>  <span class=
"org-string">"ifr;"</span>: <span class="org-string">"𝔦"</span>,
<span class="linenr"> 7092: </span>  <span class=
"org-string">"Int;"</span>: <span class="org-string">"∬"</span>,
<span class="linenr"> 7093: </span>  <span class=
"org-string">"int;"</span>: <span class="org-string">"∫"</span>,
<span class="linenr"> 7094: </span>  <span class=
"org-string">"Iuml"</span>: <span class="org-string">"Ï"</span>,
<span class="linenr"> 7095: </span>  <span class=
"org-string">"iuml"</span>: <span class="org-string">"ï"</span>,
<span class="linenr"> 7096: </span>  <span class=
"org-string">"Jcy;"</span>: <span class="org-string">"Й"</span>,
<span class="linenr"> 7097: </span>  <span class=
"org-string">"jcy;"</span>: <span class="org-string">"й"</span>,
<span class="linenr"> 7098: </span>  <span class=
"org-string">"Jfr;"</span>: <span class="org-string">"𝔍"</span>,
<span class="linenr"> 7099: </span>  <span class=
"org-string">"jfr;"</span>: <span class="org-string">"𝔧"</span>,
<span class="linenr"> 7100: </span>  <span class=
"org-string">"Kcy;"</span>: <span class="org-string">"К"</span>,
<span class="linenr"> 7101: </span>  <span class=
"org-string">"kcy;"</span>: <span class="org-string">"к"</span>,
<span class="linenr"> 7102: </span>  <span class=
"org-string">"Kfr;"</span>: <span class="org-string">"𝔎"</span>,
<span class="linenr"> 7103: </span>  <span class=
"org-string">"kfr;"</span>: <span class="org-string">"𝔨"</span>,
<span class="linenr"> 7104: </span>  <span class=
"org-string">"lap;"</span>: <span class="org-string">"⪅"</span>,
<span class="linenr"> 7105: </span>  <span class=
"org-string">"lat;"</span>: <span class="org-string">"⪫"</span>,
<span class="linenr"> 7106: </span>  <span class=
"org-string">"Lcy;"</span>: <span class="org-string">"Л"</span>,
<span class="linenr"> 7107: </span>  <span class=
"org-string">"lcy;"</span>: <span class="org-string">"л"</span>,
<span class="linenr"> 7108: </span>  <span class=
"org-string">"lEg;"</span>: <span class="org-string">"⪋"</span>,
<span class="linenr"> 7109: </span>  <span class=
"org-string">"leg;"</span>: <span class="org-string">"⋚"</span>,
<span class="linenr"> 7110: </span>  <span class=
"org-string">"leq;"</span>: <span class="org-string">"≤"</span>,
<span class="linenr"> 7111: </span>  <span class=
"org-string">"les;"</span>: <span class="org-string">"⩽"</span>,
<span class="linenr"> 7112: </span>  <span class=
"org-string">"Lfr;"</span>: <span class="org-string">"𝔏"</span>,
<span class="linenr"> 7113: </span>  <span class=
"org-string">"lfr;"</span>: <span class="org-string">"𝔩"</span>,
<span class="linenr"> 7114: </span>  <span class=
"org-string">"lgE;"</span>: <span class="org-string">"⪑"</span>,
<span class="linenr"> 7115: </span>  <span class=
"org-string">"lnE;"</span>: <span class="org-string">"≨"</span>,
<span class="linenr"> 7116: </span>  <span class=
"org-string">"lne;"</span>: <span class="org-string">"⪇"</span>,
<span class="linenr"> 7117: </span>  <span class=
"org-string">"loz;"</span>: <span class="org-string">"◊"</span>,
<span class="linenr"> 7118: </span>  <span class=
"org-string">"lrm;"</span>: <span class="org-string">"‎"</span>,
<span class="linenr"> 7119: </span>  <span class=
"org-string">"Lsh;"</span>: <span class="org-string">"↰"</span>,
<span class="linenr"> 7120: </span>  <span class=
"org-string">"lsh;"</span>: <span class="org-string">"↰"</span>,
<span class="linenr"> 7121: </span>  <span class=
"org-string">"macr"</span>: <span class="org-string">"¯"</span>,
<span class="linenr"> 7122: </span>  <span class=
"org-string">"Map;"</span>: <span class="org-string">"⤅"</span>,
<span class="linenr"> 7123: </span>  <span class=
"org-string">"map;"</span>: <span class="org-string">"↦"</span>,
<span class="linenr"> 7124: </span>  <span class=
"org-string">"Mcy;"</span>: <span class="org-string">"М"</span>,
<span class="linenr"> 7125: </span>  <span class=
"org-string">"mcy;"</span>: <span class="org-string">"м"</span>,
<span class="linenr"> 7126: </span>  <span class=
"org-string">"Mfr;"</span>: <span class="org-string">"𝔐"</span>,
<span class="linenr"> 7127: </span>  <span class=
"org-string">"mfr;"</span>: <span class="org-string">"𝔪"</span>,
<span class="linenr"> 7128: </span>  <span class=
"org-string">"mho;"</span>: <span class="org-string">"℧"</span>,
<span class="linenr"> 7129: </span>  <span class=
"org-string">"mid;"</span>: <span class="org-string">"∣"</span>,
<span class="linenr"> 7130: </span>  <span class=
"org-string">"nap;"</span>: <span class="org-string">"≉"</span>,
<span class="linenr"> 7131: </span>  <span class=
"org-string">"nbsp"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 7132: </span>  <span class=
"org-string">"Ncy;"</span>: <span class="org-string">"Н"</span>,
<span class="linenr"> 7133: </span>  <span class=
"org-string">"ncy;"</span>: <span class="org-string">"н"</span>,
<span class="linenr"> 7134: </span>  <span class=
"org-string">"Nfr;"</span>: <span class="org-string">"𝔑"</span>,
<span class="linenr"> 7135: </span>  <span class=
"org-string">"nfr;"</span>: <span class="org-string">"𝔫"</span>,
<span class="linenr"> 7136: </span>  <span class=
"org-string">"ngE;"</span>: <span class="org-string">"≧̸"</span>,
<span class="linenr"> 7137: </span>  <span class=
"org-string">"nge;"</span>: <span class="org-string">"≱"</span>,
<span class="linenr"> 7138: </span>  <span class=
"org-string">"nGg;"</span>: <span class="org-string">"⋙̸"</span>,
<span class="linenr"> 7139: </span>  <span class=
"org-string">"nGt;"</span>: <span class="org-string">"≫⃒"</span>,
<span class="linenr"> 7140: </span>  <span class=
"org-string">"ngt;"</span>: <span class="org-string">"≯"</span>,
<span class="linenr"> 7141: </span>  <span class=
"org-string">"nis;"</span>: <span class="org-string">"⋼"</span>,
<span class="linenr"> 7142: </span>  <span class=
"org-string">"niv;"</span>: <span class="org-string">"∋"</span>,
<span class="linenr"> 7143: </span>  <span class=
"org-string">"nlE;"</span>: <span class="org-string">"≦̸"</span>,
<span class="linenr"> 7144: </span>  <span class=
"org-string">"nle;"</span>: <span class="org-string">"≰"</span>,
<span class="linenr"> 7145: </span>  <span class=
"org-string">"nLl;"</span>: <span class="org-string">"⋘̸"</span>,
<span class="linenr"> 7146: </span>  <span class=
"org-string">"nLt;"</span>: <span class="org-string">"≪⃒"</span>,
<span class="linenr"> 7147: </span>  <span class=
"org-string">"nlt;"</span>: <span class="org-string">"≮"</span>,
<span class="linenr"> 7148: </span>  <span class=
"org-string">"Not;"</span>: <span class="org-string">"⫬"</span>,
<span class="linenr"> 7149: </span>  <span class=
"org-string">"not;"</span>: <span class="org-string">"¬"</span>,
<span class="linenr"> 7150: </span>  <span class=
"org-string">"npr;"</span>: <span class="org-string">"⊀"</span>,
<span class="linenr"> 7151: </span>  <span class=
"org-string">"nsc;"</span>: <span class="org-string">"⊁"</span>,
<span class="linenr"> 7152: </span>  <span class=
"org-string">"num;"</span>: <span class="org-string">"#"</span>,
<span class="linenr"> 7153: </span>  <span class=
"org-string">"Ocy;"</span>: <span class="org-string">"О"</span>,
<span class="linenr"> 7154: </span>  <span class=
"org-string">"ocy;"</span>: <span class="org-string">"о"</span>,
<span class="linenr"> 7155: </span>  <span class=
"org-string">"Ofr;"</span>: <span class="org-string">"𝔒"</span>,
<span class="linenr"> 7156: </span>  <span class=
"org-string">"ofr;"</span>: <span class="org-string">"𝔬"</span>,
<span class="linenr"> 7157: </span>  <span class=
"org-string">"ogt;"</span>: <span class="org-string">"⧁"</span>,
<span class="linenr"> 7158: </span>  <span class=
"org-string">"ohm;"</span>: <span class="org-string">"Ω"</span>,
<span class="linenr"> 7159: </span>  <span class=
"org-string">"olt;"</span>: <span class="org-string">"⧀"</span>,
<span class="linenr"> 7160: </span>  <span class=
"org-string">"ord;"</span>: <span class="org-string">"⩝"</span>,
<span class="linenr"> 7161: </span>  <span class=
"org-string">"ordf"</span>: <span class="org-string">"ª"</span>,
<span class="linenr"> 7162: </span>  <span class=
"org-string">"ordm"</span>: <span class="org-string">"º"</span>,
<span class="linenr"> 7163: </span>  <span class=
"org-string">"orv;"</span>: <span class="org-string">"⩛"</span>,
<span class="linenr"> 7164: </span>  <span class=
"org-string">"Ouml"</span>: <span class="org-string">"Ö"</span>,
<span class="linenr"> 7165: </span>  <span class=
"org-string">"ouml"</span>: <span class="org-string">"ö"</span>,
<span class="linenr"> 7166: </span>  <span class=
"org-string">"par;"</span>: <span class="org-string">"∥"</span>,
<span class="linenr"> 7167: </span>  <span class=
"org-string">"para"</span>: <span class="org-string">"¶"</span>,
<span class="linenr"> 7168: </span>  <span class=
"org-string">"Pcy;"</span>: <span class="org-string">"П"</span>,
<span class="linenr"> 7169: </span>  <span class=
"org-string">"pcy;"</span>: <span class="org-string">"п"</span>,
<span class="linenr"> 7170: </span>  <span class=
"org-string">"Pfr;"</span>: <span class="org-string">"𝔓"</span>,
<span class="linenr"> 7171: </span>  <span class=
"org-string">"pfr;"</span>: <span class="org-string">"𝔭"</span>,
<span class="linenr"> 7172: </span>  <span class=
"org-string">"Phi;"</span>: <span class="org-string">"Φ"</span>,
<span class="linenr"> 7173: </span>  <span class=
"org-string">"phi;"</span>: <span class="org-string">"φ"</span>,
<span class="linenr"> 7174: </span>  <span class=
"org-string">"piv;"</span>: <span class="org-string">"ϖ"</span>,
<span class="linenr"> 7175: </span>  <span class=
"org-string">"prE;"</span>: <span class="org-string">"⪳"</span>,
<span class="linenr"> 7176: </span>  <span class=
"org-string">"pre;"</span>: <span class="org-string">"⪯"</span>,
<span class="linenr"> 7177: </span>  <span class=
"org-string">"Psi;"</span>: <span class="org-string">"Ψ"</span>,
<span class="linenr"> 7178: </span>  <span class=
"org-string">"psi;"</span>: <span class="org-string">"ψ"</span>,
<span class="linenr"> 7179: </span>  <span class=
"org-string">"Qfr;"</span>: <span class="org-string">"𝔔"</span>,
<span class="linenr"> 7180: </span>  <span class=
"org-string">"qfr;"</span>: <span class="org-string">"𝔮"</span>,
<span class="linenr"> 7181: </span>  <span class=
"org-string">"QUOT"</span>: <span class="org-string">"\""</span>,
<span class="linenr"> 7182: </span>  <span class=
"org-string">"quot"</span>: <span class="org-string">"\""</span>,
<span class="linenr"> 7183: </span>  <span class=
"org-string">"Rcy;"</span>: <span class="org-string">"Р"</span>,
<span class="linenr"> 7184: </span>  <span class=
"org-string">"rcy;"</span>: <span class="org-string">"р"</span>,
<span class="linenr"> 7185: </span>  <span class=
"org-string">"REG;"</span>: <span class="org-string">"®"</span>,
<span class="linenr"> 7186: </span>  <span class=
"org-string">"reg;"</span>: <span class="org-string">"®"</span>,
<span class="linenr"> 7187: </span>  <span class=
"org-string">"Rfr;"</span>: <span class="org-string">"ℜ"</span>,
<span class="linenr"> 7188: </span>  <span class=
"org-string">"rfr;"</span>: <span class="org-string">"𝔯"</span>,
<span class="linenr"> 7189: </span>  <span class=
"org-string">"Rho;"</span>: <span class="org-string">"Ρ"</span>,
<span class="linenr"> 7190: </span>  <span class=
"org-string">"rho;"</span>: <span class="org-string">"ρ"</span>,
<span class="linenr"> 7191: </span>  <span class=
"org-string">"rlm;"</span>: <span class="org-string">"‏"</span>,
<span class="linenr"> 7192: </span>  <span class=
"org-string">"Rsh;"</span>: <span class="org-string">"↱"</span>,
<span class="linenr"> 7193: </span>  <span class=
"org-string">"rsh;"</span>: <span class="org-string">"↱"</span>,
<span class="linenr"> 7194: </span>  <span class=
"org-string">"scE;"</span>: <span class="org-string">"⪴"</span>,
<span class="linenr"> 7195: </span>  <span class=
"org-string">"sce;"</span>: <span class="org-string">"⪰"</span>,
<span class="linenr"> 7196: </span>  <span class=
"org-string">"Scy;"</span>: <span class="org-string">"С"</span>,
<span class="linenr"> 7197: </span>  <span class=
"org-string">"scy;"</span>: <span class="org-string">"с"</span>,
<span class="linenr"> 7198: </span>  <span class=
"org-string">"sect"</span>: <span class="org-string">"§"</span>,
<span class="linenr"> 7199: </span>  <span class=
"org-string">"Sfr;"</span>: <span class="org-string">"𝔖"</span>,
<span class="linenr"> 7200: </span>  <span class=
"org-string">"sfr;"</span>: <span class="org-string">"𝔰"</span>,
<span class="linenr"> 7201: </span>  <span class=
"org-string">"shy;"</span>: <span class="org-string">"­"</span>,
<span class="linenr"> 7202: </span>  <span class=
"org-string">"sim;"</span>: <span class="org-string">"∼"</span>,
<span class="linenr"> 7203: </span>  <span class=
"org-string">"smt;"</span>: <span class="org-string">"⪪"</span>,
<span class="linenr"> 7204: </span>  <span class=
"org-string">"sol;"</span>: <span class="org-string">"/"</span>,
<span class="linenr"> 7205: </span>  <span class=
"org-string">"squ;"</span>: <span class="org-string">"□"</span>,
<span class="linenr"> 7206: </span>  <span class=
"org-string">"Sub;"</span>: <span class="org-string">"⋐"</span>,
<span class="linenr"> 7207: </span>  <span class=
"org-string">"sub;"</span>: <span class="org-string">"⊂"</span>,
<span class="linenr"> 7208: </span>  <span class=
"org-string">"Sum;"</span>: <span class="org-string">"∑"</span>,
<span class="linenr"> 7209: </span>  <span class=
"org-string">"sum;"</span>: <span class="org-string">"∑"</span>,
<span class="linenr"> 7210: </span>  <span class=
"org-string">"Sup;"</span>: <span class="org-string">"⋑"</span>,
<span class="linenr"> 7211: </span>  <span class=
"org-string">"sup;"</span>: <span class="org-string">"⊃"</span>,
<span class="linenr"> 7212: </span>  <span class=
"org-string">"sup1"</span>: <span class="org-string">"¹"</span>,
<span class="linenr"> 7213: </span>  <span class=
"org-string">"sup2"</span>: <span class="org-string">"²"</span>,
<span class="linenr"> 7214: </span>  <span class=
"org-string">"sup3"</span>: <span class="org-string">"³"</span>,
<span class="linenr"> 7215: </span>  <span class=
"org-string">"Tab;"</span>: <span class="org-string">"\t"</span>,
<span class="linenr"> 7216: </span>  <span class=
"org-string">"Tau;"</span>: <span class="org-string">"Τ"</span>,
<span class="linenr"> 7217: </span>  <span class=
"org-string">"tau;"</span>: <span class="org-string">"τ"</span>,
<span class="linenr"> 7218: </span>  <span class=
"org-string">"Tcy;"</span>: <span class="org-string">"Т"</span>,
<span class="linenr"> 7219: </span>  <span class=
"org-string">"tcy;"</span>: <span class="org-string">"т"</span>,
<span class="linenr"> 7220: </span>  <span class=
"org-string">"Tfr;"</span>: <span class="org-string">"𝔗"</span>,
<span class="linenr"> 7221: </span>  <span class=
"org-string">"tfr;"</span>: <span class="org-string">"𝔱"</span>,
<span class="linenr"> 7222: </span>  <span class=
"org-string">"top;"</span>: <span class="org-string">"⊤"</span>,
<span class="linenr"> 7223: </span>  <span class=
"org-string">"Ucy;"</span>: <span class="org-string">"У"</span>,
<span class="linenr"> 7224: </span>  <span class=
"org-string">"ucy;"</span>: <span class="org-string">"у"</span>,
<span class="linenr"> 7225: </span>  <span class=
"org-string">"Ufr;"</span>: <span class="org-string">"𝔘"</span>,
<span class="linenr"> 7226: </span>  <span class=
"org-string">"ufr;"</span>: <span class="org-string">"𝔲"</span>,
<span class="linenr"> 7227: </span>  <span class=
"org-string">"uml;"</span>: <span class="org-string">"¨"</span>,
<span class="linenr"> 7228: </span>  <span class=
"org-string">"Uuml"</span>: <span class="org-string">"Ü"</span>,
<span class="linenr"> 7229: </span>  <span class=
"org-string">"uuml"</span>: <span class="org-string">"ü"</span>,
<span class="linenr"> 7230: </span>  <span class=
"org-string">"Vcy;"</span>: <span class="org-string">"В"</span>,
<span class="linenr"> 7231: </span>  <span class=
"org-string">"vcy;"</span>: <span class="org-string">"в"</span>,
<span class="linenr"> 7232: </span>  <span class=
"org-string">"Vee;"</span>: <span class="org-string">"⋁"</span>,
<span class="linenr"> 7233: </span>  <span class=
"org-string">"vee;"</span>: <span class="org-string">"∨"</span>,
<span class="linenr"> 7234: </span>  <span class=
"org-string">"Vfr;"</span>: <span class="org-string">"𝔙"</span>,
<span class="linenr"> 7235: </span>  <span class=
"org-string">"vfr;"</span>: <span class="org-string">"𝔳"</span>,
<span class="linenr"> 7236: </span>  <span class=
"org-string">"Wfr;"</span>: <span class="org-string">"𝔚"</span>,
<span class="linenr"> 7237: </span>  <span class=
"org-string">"wfr;"</span>: <span class="org-string">"𝔴"</span>,
<span class="linenr"> 7238: </span>  <span class=
"org-string">"Xfr;"</span>: <span class="org-string">"𝔛"</span>,
<span class="linenr"> 7239: </span>  <span class=
"org-string">"xfr;"</span>: <span class="org-string">"𝔵"</span>,
<span class="linenr"> 7240: </span>  <span class=
"org-string">"Ycy;"</span>: <span class="org-string">"Ы"</span>,
<span class="linenr"> 7241: </span>  <span class=
"org-string">"ycy;"</span>: <span class="org-string">"ы"</span>,
<span class="linenr"> 7242: </span>  <span class=
"org-string">"yen;"</span>: <span class="org-string">"¥"</span>,
<span class="linenr"> 7243: </span>  <span class=
"org-string">"Yfr;"</span>: <span class="org-string">"𝔜"</span>,
<span class="linenr"> 7244: </span>  <span class=
"org-string">"yfr;"</span>: <span class="org-string">"𝔶"</span>,
<span class="linenr"> 7245: </span>  <span class=
"org-string">"yuml"</span>: <span class="org-string">"ÿ"</span>,
<span class="linenr"> 7246: </span>  <span class=
"org-string">"Zcy;"</span>: <span class="org-string">"З"</span>,
<span class="linenr"> 7247: </span>  <span class=
"org-string">"zcy;"</span>: <span class="org-string">"з"</span>,
<span class="linenr"> 7248: </span>  <span class=
"org-string">"Zfr;"</span>: <span class="org-string">"ℨ"</span>,
<span class="linenr"> 7249: </span>  <span class=
"org-string">"zfr;"</span>: <span class="org-string">"𝔷"</span>,
<span class="linenr"> 7250: </span>  <span class=
"org-string">"zwj;"</span>: <span class="org-string">"‍"</span>,
<span class="linenr"> 7251: </span>  <span class=
"org-string">"Acirc"</span>: <span class="org-string">"Â"</span>,
<span class="linenr"> 7252: </span>  <span class=
"org-string">"acirc"</span>: <span class="org-string">"â"</span>,
<span class="linenr"> 7253: </span>  <span class=
"org-string">"acute"</span>: <span class="org-string">"´"</span>,
<span class="linenr"> 7254: </span>  <span class=
"org-string">"AElig"</span>: <span class="org-string">"Æ"</span>,
<span class="linenr"> 7255: </span>  <span class=
"org-string">"aelig"</span>: <span class="org-string">"æ"</span>,
<span class="linenr"> 7256: </span>  <span class=
"org-string">"andd;"</span>: <span class="org-string">"⩜"</span>,
<span class="linenr"> 7257: </span>  <span class=
"org-string">"andv;"</span>: <span class="org-string">"⩚"</span>,
<span class="linenr"> 7258: </span>  <span class=
"org-string">"ange;"</span>: <span class="org-string">"⦤"</span>,
<span class="linenr"> 7259: </span>  <span class=
"org-string">"Aopf;"</span>: <span class="org-string">"𝔸"</span>,
<span class="linenr"> 7260: </span>  <span class=
"org-string">"aopf;"</span>: <span class="org-string">"𝕒"</span>,
<span class="linenr"> 7261: </span>  <span class=
"org-string">"apid;"</span>: <span class="org-string">"≋"</span>,
<span class="linenr"> 7262: </span>  <span class=
"org-string">"apos;"</span>: <span class="org-string">"'"</span>,
<span class="linenr"> 7263: </span>  <span class=
"org-string">"Aring"</span>: <span class="org-string">"Å"</span>,
<span class="linenr"> 7264: </span>  <span class=
"org-string">"aring"</span>: <span class="org-string">"å"</span>,
<span class="linenr"> 7265: </span>  <span class=
"org-string">"Ascr;"</span>: <span class="org-string">"𝒜"</span>,
<span class="linenr"> 7266: </span>  <span class=
"org-string">"ascr;"</span>: <span class="org-string">"𝒶"</span>,
<span class="linenr"> 7267: </span>  <span class=
"org-string">"Auml;"</span>: <span class="org-string">"Ä"</span>,
<span class="linenr"> 7268: </span>  <span class=
"org-string">"auml;"</span>: <span class="org-string">"ä"</span>,
<span class="linenr"> 7269: </span>  <span class=
"org-string">"Barv;"</span>: <span class="org-string">"⫧"</span>,
<span class="linenr"> 7270: </span>  <span class=
"org-string">"bbrk;"</span>: <span class="org-string">"⎵"</span>,
<span class="linenr"> 7271: </span>  <span class=
"org-string">"Beta;"</span>: <span class="org-string">"Β"</span>,
<span class="linenr"> 7272: </span>  <span class=
"org-string">"beta;"</span>: <span class="org-string">"β"</span>,
<span class="linenr"> 7273: </span>  <span class=
"org-string">"beth;"</span>: <span class="org-string">"ℶ"</span>,
<span class="linenr"> 7274: </span>  <span class=
"org-string">"bNot;"</span>: <span class="org-string">"⫭"</span>,
<span class="linenr"> 7275: </span>  <span class=
"org-string">"bnot;"</span>: <span class="org-string">"⌐"</span>,
<span class="linenr"> 7276: </span>  <span class=
"org-string">"Bopf;"</span>: <span class="org-string">"𝔹"</span>,
<span class="linenr"> 7277: </span>  <span class=
"org-string">"bopf;"</span>: <span class="org-string">"𝕓"</span>,
<span class="linenr"> 7278: </span>  <span class=
"org-string">"boxH;"</span>: <span class="org-string">"═"</span>,
<span class="linenr"> 7279: </span>  <span class=
"org-string">"boxh;"</span>: <span class="org-string">"─"</span>,
<span class="linenr"> 7280: </span>  <span class=
"org-string">"boxV;"</span>: <span class="org-string">"║"</span>,
<span class="linenr"> 7281: </span>  <span class=
"org-string">"boxv;"</span>: <span class="org-string">"│"</span>,
<span class="linenr"> 7282: </span>  <span class=
"org-string">"Bscr;"</span>: <span class="org-string">"ℬ"</span>,
<span class="linenr"> 7283: </span>  <span class=
"org-string">"bscr;"</span>: <span class="org-string">"𝒷"</span>,
<span class="linenr"> 7284: </span>  <span class=
"org-string">"bsim;"</span>: <span class="org-string">"∽"</span>,
<span class="linenr"> 7285: </span>  <span class=
"org-string">"bsol;"</span>: <span class="org-string">"\\"</span>,
<span class="linenr"> 7286: </span>  <span class=
"org-string">"bull;"</span>: <span class="org-string">"•"</span>,
<span class="linenr"> 7287: </span>  <span class=
"org-string">"bump;"</span>: <span class="org-string">"≎"</span>,
<span class="linenr"> 7288: </span>  <span class=
"org-string">"caps;"</span>: <span class="org-string">"∩︀"</span>,
<span class="linenr"> 7289: </span>  <span class=
"org-string">"Cdot;"</span>: <span class="org-string">"Ċ"</span>,
<span class="linenr"> 7290: </span>  <span class=
"org-string">"cdot;"</span>: <span class="org-string">"ċ"</span>,
<span class="linenr"> 7291: </span>  <span class=
"org-string">"cedil"</span>: <span class="org-string">"¸"</span>,
<span class="linenr"> 7292: </span>  <span class=
"org-string">"cent;"</span>: <span class="org-string">"¢"</span>,
<span class="linenr"> 7293: </span>  <span class=
"org-string">"CHcy;"</span>: <span class="org-string">"Ч"</span>,
<span class="linenr"> 7294: </span>  <span class=
"org-string">"chcy;"</span>: <span class="org-string">"ч"</span>,
<span class="linenr"> 7295: </span>  <span class=
"org-string">"circ;"</span>: <span class="org-string">"ˆ"</span>,
<span class="linenr"> 7296: </span>  <span class=
"org-string">"cirE;"</span>: <span class="org-string">"⧃"</span>,
<span class="linenr"> 7297: </span>  <span class=
"org-string">"cire;"</span>: <span class="org-string">"≗"</span>,
<span class="linenr"> 7298: </span>  <span class=
"org-string">"comp;"</span>: <span class="org-string">"∁"</span>,
<span class="linenr"> 7299: </span>  <span class=
"org-string">"cong;"</span>: <span class="org-string">"≅"</span>,
<span class="linenr"> 7300: </span>  <span class=
"org-string">"Copf;"</span>: <span class="org-string">"ℂ"</span>,
<span class="linenr"> 7301: </span>  <span class=
"org-string">"copf;"</span>: <span class="org-string">"𝕔"</span>,
<span class="linenr"> 7302: </span>  <span class=
"org-string">"COPY;"</span>: <span class="org-string">"©"</span>,
<span class="linenr"> 7303: </span>  <span class=
"org-string">"copy;"</span>: <span class="org-string">"©"</span>,
<span class="linenr"> 7304: </span>  <span class=
"org-string">"Cscr;"</span>: <span class="org-string">"𝒞"</span>,
<span class="linenr"> 7305: </span>  <span class=
"org-string">"cscr;"</span>: <span class="org-string">"𝒸"</span>,
<span class="linenr"> 7306: </span>  <span class=
"org-string">"csub;"</span>: <span class="org-string">"⫏"</span>,
<span class="linenr"> 7307: </span>  <span class=
"org-string">"csup;"</span>: <span class="org-string">"⫐"</span>,
<span class="linenr"> 7308: </span>  <span class=
"org-string">"cups;"</span>: <span class="org-string">"∪︀"</span>,
<span class="linenr"> 7309: </span>  <span class=
"org-string">"Darr;"</span>: <span class="org-string">"↡"</span>,
<span class="linenr"> 7310: </span>  <span class=
"org-string">"dArr;"</span>: <span class="org-string">"⇓"</span>,
<span class="linenr"> 7311: </span>  <span class=
"org-string">"darr;"</span>: <span class="org-string">"↓"</span>,
<span class="linenr"> 7312: </span>  <span class=
"org-string">"dash;"</span>: <span class="org-string">"‐"</span>,
<span class="linenr"> 7313: </span>  <span class=
"org-string">"dHar;"</span>: <span class="org-string">"⥥"</span>,
<span class="linenr"> 7314: </span>  <span class=
"org-string">"diam;"</span>: <span class="org-string">"⋄"</span>,
<span class="linenr"> 7315: </span>  <span class=
"org-string">"DJcy;"</span>: <span class="org-string">"Ђ"</span>,
<span class="linenr"> 7316: </span>  <span class=
"org-string">"djcy;"</span>: <span class="org-string">"ђ"</span>,
<span class="linenr"> 7317: </span>  <span class=
"org-string">"Dopf;"</span>: <span class="org-string">"𝔻"</span>,
<span class="linenr"> 7318: </span>  <span class=
"org-string">"dopf;"</span>: <span class="org-string">"𝕕"</span>,
<span class="linenr"> 7319: </span>  <span class=
"org-string">"Dscr;"</span>: <span class="org-string">"𝒟"</span>,
<span class="linenr"> 7320: </span>  <span class=
"org-string">"dscr;"</span>: <span class="org-string">"𝒹"</span>,
<span class="linenr"> 7321: </span>  <span class=
"org-string">"DScy;"</span>: <span class="org-string">"Ѕ"</span>,
<span class="linenr"> 7322: </span>  <span class=
"org-string">"dscy;"</span>: <span class="org-string">"ѕ"</span>,
<span class="linenr"> 7323: </span>  <span class=
"org-string">"dsol;"</span>: <span class="org-string">"⧶"</span>,
<span class="linenr"> 7324: </span>  <span class=
"org-string">"dtri;"</span>: <span class="org-string">"▿"</span>,
<span class="linenr"> 7325: </span>  <span class=
"org-string">"DZcy;"</span>: <span class="org-string">"Џ"</span>,
<span class="linenr"> 7326: </span>  <span class=
"org-string">"dzcy;"</span>: <span class="org-string">"џ"</span>,
<span class="linenr"> 7327: </span>  <span class=
"org-string">"ecir;"</span>: <span class="org-string">"≖"</span>,
<span class="linenr"> 7328: </span>  <span class=
"org-string">"Ecirc"</span>: <span class="org-string">"Ê"</span>,
<span class="linenr"> 7329: </span>  <span class=
"org-string">"ecirc"</span>: <span class="org-string">"ê"</span>,
<span class="linenr"> 7330: </span>  <span class=
"org-string">"Edot;"</span>: <span class="org-string">"Ė"</span>,
<span class="linenr"> 7331: </span>  <span class=
"org-string">"eDot;"</span>: <span class="org-string">"≑"</span>,
<span class="linenr"> 7332: </span>  <span class=
"org-string">"edot;"</span>: <span class="org-string">"ė"</span>,
<span class="linenr"> 7333: </span>  <span class=
"org-string">"emsp;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 7334: </span>  <span class=
"org-string">"ensp;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 7335: </span>  <span class=
"org-string">"Eopf;"</span>: <span class="org-string">"𝔼"</span>,
<span class="linenr"> 7336: </span>  <span class=
"org-string">"eopf;"</span>: <span class="org-string">"𝕖"</span>,
<span class="linenr"> 7337: </span>  <span class=
"org-string">"epar;"</span>: <span class="org-string">"⋕"</span>,
<span class="linenr"> 7338: </span>  <span class=
"org-string">"epsi;"</span>: <span class="org-string">"ε"</span>,
<span class="linenr"> 7339: </span>  <span class=
"org-string">"Escr;"</span>: <span class="org-string">"ℰ"</span>,
<span class="linenr"> 7340: </span>  <span class=
"org-string">"escr;"</span>: <span class="org-string">"ℯ"</span>,
<span class="linenr"> 7341: </span>  <span class=
"org-string">"Esim;"</span>: <span class="org-string">"⩳"</span>,
<span class="linenr"> 7342: </span>  <span class=
"org-string">"esim;"</span>: <span class="org-string">"≂"</span>,
<span class="linenr"> 7343: </span>  <span class=
"org-string">"Euml;"</span>: <span class="org-string">"Ë"</span>,
<span class="linenr"> 7344: </span>  <span class=
"org-string">"euml;"</span>: <span class="org-string">"ë"</span>,
<span class="linenr"> 7345: </span>  <span class=
"org-string">"euro;"</span>: <span class="org-string">"€"</span>,
<span class="linenr"> 7346: </span>  <span class=
"org-string">"excl;"</span>: <span class="org-string">"!"</span>,
<span class="linenr"> 7347: </span>  <span class=
"org-string">"flat;"</span>: <span class="org-string">"♭"</span>,
<span class="linenr"> 7348: </span>  <span class=
"org-string">"fnof;"</span>: <span class="org-string">"ƒ"</span>,
<span class="linenr"> 7349: </span>  <span class=
"org-string">"Fopf;"</span>: <span class="org-string">"𝔽"</span>,
<span class="linenr"> 7350: </span>  <span class=
"org-string">"fopf;"</span>: <span class="org-string">"𝕗"</span>,
<span class="linenr"> 7351: </span>  <span class=
"org-string">"fork;"</span>: <span class="org-string">"⋔"</span>,
<span class="linenr"> 7352: </span>  <span class=
"org-string">"Fscr;"</span>: <span class="org-string">"ℱ"</span>,
<span class="linenr"> 7353: </span>  <span class=
"org-string">"fscr;"</span>: <span class="org-string">"𝒻"</span>,
<span class="linenr"> 7354: </span>  <span class=
"org-string">"Gdot;"</span>: <span class="org-string">"Ġ"</span>,
<span class="linenr"> 7355: </span>  <span class=
"org-string">"gdot;"</span>: <span class="org-string">"ġ"</span>,
<span class="linenr"> 7356: </span>  <span class=
"org-string">"geqq;"</span>: <span class="org-string">"≧"</span>,
<span class="linenr"> 7357: </span>  <span class=
"org-string">"gesl;"</span>: <span class="org-string">"⋛︀"</span>,
<span class="linenr"> 7358: </span>  <span class=
"org-string">"GJcy;"</span>: <span class="org-string">"Ѓ"</span>,
<span class="linenr"> 7359: </span>  <span class=
"org-string">"gjcy;"</span>: <span class="org-string">"ѓ"</span>,
<span class="linenr"> 7360: </span>  <span class=
"org-string">"gnap;"</span>: <span class="org-string">"⪊"</span>,
<span class="linenr"> 7361: </span>  <span class=
"org-string">"gneq;"</span>: <span class="org-string">"⪈"</span>,
<span class="linenr"> 7362: </span>  <span class=
"org-string">"Gopf;"</span>: <span class="org-string">"𝔾"</span>,
<span class="linenr"> 7363: </span>  <span class=
"org-string">"gopf;"</span>: <span class="org-string">"𝕘"</span>,
<span class="linenr"> 7364: </span>  <span class=
"org-string">"Gscr;"</span>: <span class="org-string">"𝒢"</span>,
<span class="linenr"> 7365: </span>  <span class=
"org-string">"gscr;"</span>: <span class="org-string">"ℊ"</span>,
<span class="linenr"> 7366: </span>  <span class=
"org-string">"gsim;"</span>: <span class="org-string">"≳"</span>,
<span class="linenr"> 7367: </span>  <span class=
"org-string">"gtcc;"</span>: <span class="org-string">"⪧"</span>,
<span class="linenr"> 7368: </span>  <span class=
"org-string">"gvnE;"</span>: <span class="org-string">"≩︀"</span>,
<span class="linenr"> 7369: </span>  <span class=
"org-string">"half;"</span>: <span class="org-string">"½"</span>,
<span class="linenr"> 7370: </span>  <span class=
"org-string">"hArr;"</span>: <span class="org-string">"⇔"</span>,
<span class="linenr"> 7371: </span>  <span class=
"org-string">"harr;"</span>: <span class="org-string">"↔"</span>,
<span class="linenr"> 7372: </span>  <span class=
"org-string">"hbar;"</span>: <span class="org-string">"ℏ"</span>,
<span class="linenr"> 7373: </span>  <span class=
"org-string">"Hopf;"</span>: <span class="org-string">"ℍ"</span>,
<span class="linenr"> 7374: </span>  <span class=
"org-string">"hopf;"</span>: <span class="org-string">"𝕙"</span>,
<span class="linenr"> 7375: </span>  <span class=
"org-string">"Hscr;"</span>: <span class="org-string">"ℋ"</span>,
<span class="linenr"> 7376: </span>  <span class=
"org-string">"hscr;"</span>: <span class="org-string">"𝒽"</span>,
<span class="linenr"> 7377: </span>  <span class=
"org-string">"Icirc"</span>: <span class="org-string">"Î"</span>,
<span class="linenr"> 7378: </span>  <span class=
"org-string">"icirc"</span>: <span class="org-string">"î"</span>,
<span class="linenr"> 7379: </span>  <span class=
"org-string">"Idot;"</span>: <span class="org-string">"İ"</span>,
<span class="linenr"> 7380: </span>  <span class=
"org-string">"IEcy;"</span>: <span class="org-string">"Е"</span>,
<span class="linenr"> 7381: </span>  <span class=
"org-string">"iecy;"</span>: <span class="org-string">"е"</span>,
<span class="linenr"> 7382: </span>  <span class=
"org-string">"iexcl"</span>: <span class="org-string">"¡"</span>,
<span class="linenr"> 7383: </span>  <span class=
"org-string">"imof;"</span>: <span class="org-string">"⊷"</span>,
<span class="linenr"> 7384: </span>  <span class=
"org-string">"IOcy;"</span>: <span class="org-string">"Ё"</span>,
<span class="linenr"> 7385: </span>  <span class=
"org-string">"iocy;"</span>: <span class="org-string">"ё"</span>,
<span class="linenr"> 7386: </span>  <span class=
"org-string">"Iopf;"</span>: <span class="org-string">"𝕀"</span>,
<span class="linenr"> 7387: </span>  <span class=
"org-string">"iopf;"</span>: <span class="org-string">"𝕚"</span>,
<span class="linenr"> 7388: </span>  <span class=
"org-string">"Iota;"</span>: <span class="org-string">"Ι"</span>,
<span class="linenr"> 7389: </span>  <span class=
"org-string">"iota;"</span>: <span class="org-string">"ι"</span>,
<span class="linenr"> 7390: </span>  <span class=
"org-string">"Iscr;"</span>: <span class="org-string">"ℐ"</span>,
<span class="linenr"> 7391: </span>  <span class=
"org-string">"iscr;"</span>: <span class="org-string">"𝒾"</span>,
<span class="linenr"> 7392: </span>  <span class=
"org-string">"isin;"</span>: <span class="org-string">"∈"</span>,
<span class="linenr"> 7393: </span>  <span class=
"org-string">"Iuml;"</span>: <span class="org-string">"Ï"</span>,
<span class="linenr"> 7394: </span>  <span class=
"org-string">"iuml;"</span>: <span class="org-string">"ï"</span>,
<span class="linenr"> 7395: </span>  <span class=
"org-string">"Jopf;"</span>: <span class="org-string">"𝕁"</span>,
<span class="linenr"> 7396: </span>  <span class=
"org-string">"jopf;"</span>: <span class="org-string">"𝕛"</span>,
<span class="linenr"> 7397: </span>  <span class=
"org-string">"Jscr;"</span>: <span class="org-string">"𝒥"</span>,
<span class="linenr"> 7398: </span>  <span class=
"org-string">"jscr;"</span>: <span class="org-string">"𝒿"</span>,
<span class="linenr"> 7399: </span>  <span class=
"org-string">"KHcy;"</span>: <span class="org-string">"Х"</span>,
<span class="linenr"> 7400: </span>  <span class=
"org-string">"khcy;"</span>: <span class="org-string">"х"</span>,
<span class="linenr"> 7401: </span>  <span class=
"org-string">"KJcy;"</span>: <span class="org-string">"Ќ"</span>,
<span class="linenr"> 7402: </span>  <span class=
"org-string">"kjcy;"</span>: <span class="org-string">"ќ"</span>,
<span class="linenr"> 7403: </span>  <span class=
"org-string">"Kopf;"</span>: <span class="org-string">"𝕂"</span>,
<span class="linenr"> 7404: </span>  <span class=
"org-string">"kopf;"</span>: <span class="org-string">"𝕜"</span>,
<span class="linenr"> 7405: </span>  <span class=
"org-string">"Kscr;"</span>: <span class="org-string">"𝒦"</span>,
<span class="linenr"> 7406: </span>  <span class=
"org-string">"kscr;"</span>: <span class="org-string">"𝓀"</span>,
<span class="linenr"> 7407: </span>  <span class=
"org-string">"Lang;"</span>: <span class="org-string">"⟪"</span>,
<span class="linenr"> 7408: </span>  <span class=
"org-string">"lang;"</span>: <span class="org-string">"⟨"</span>,
<span class="linenr"> 7409: </span>  <span class=
"org-string">"laquo"</span>: <span class="org-string">"«"</span>,
<span class="linenr"> 7410: </span>  <span class=
"org-string">"Larr;"</span>: <span class="org-string">"↞"</span>,
<span class="linenr"> 7411: </span>  <span class=
"org-string">"lArr;"</span>: <span class="org-string">"⇐"</span>,
<span class="linenr"> 7412: </span>  <span class=
"org-string">"larr;"</span>: <span class="org-string">"←"</span>,
<span class="linenr"> 7413: </span>  <span class=
"org-string">"late;"</span>: <span class="org-string">"⪭"</span>,
<span class="linenr"> 7414: </span>  <span class=
"org-string">"lcub;"</span>: <span class="org-string">"{"</span>,
<span class="linenr"> 7415: </span>  <span class=
"org-string">"ldca;"</span>: <span class="org-string">"⤶"</span>,
<span class="linenr"> 7416: </span>  <span class=
"org-string">"ldsh;"</span>: <span class="org-string">"↲"</span>,
<span class="linenr"> 7417: </span>  <span class=
"org-string">"leqq;"</span>: <span class="org-string">"≦"</span>,
<span class="linenr"> 7418: </span>  <span class=
"org-string">"lesg;"</span>: <span class="org-string">"⋚︀"</span>,
<span class="linenr"> 7419: </span>  <span class=
"org-string">"lHar;"</span>: <span class="org-string">"⥢"</span>,
<span class="linenr"> 7420: </span>  <span class=
"org-string">"LJcy;"</span>: <span class="org-string">"Љ"</span>,
<span class="linenr"> 7421: </span>  <span class=
"org-string">"ljcy;"</span>: <span class="org-string">"љ"</span>,
<span class="linenr"> 7422: </span>  <span class=
"org-string">"lnap;"</span>: <span class="org-string">"⪉"</span>,
<span class="linenr"> 7423: </span>  <span class=
"org-string">"lneq;"</span>: <span class="org-string">"⪇"</span>,
<span class="linenr"> 7424: </span>  <span class=
"org-string">"Lopf;"</span>: <span class="org-string">"𝕃"</span>,
<span class="linenr"> 7425: </span>  <span class=
"org-string">"lopf;"</span>: <span class="org-string">"𝕝"</span>,
<span class="linenr"> 7426: </span>  <span class=
"org-string">"lozf;"</span>: <span class="org-string">"⧫"</span>,
<span class="linenr"> 7427: </span>  <span class=
"org-string">"lpar;"</span>: <span class="org-string">"("</span>,
<span class="linenr"> 7428: </span>  <span class=
"org-string">"Lscr;"</span>: <span class="org-string">"ℒ"</span>,
<span class="linenr"> 7429: </span>  <span class=
"org-string">"lscr;"</span>: <span class="org-string">"𝓁"</span>,
<span class="linenr"> 7430: </span>  <span class=
"org-string">"lsim;"</span>: <span class="org-string">"≲"</span>,
<span class="linenr"> 7431: </span>  <span class=
"org-string">"lsqb;"</span>: <span class="org-string">"["</span>,
<span class="linenr"> 7432: </span>  <span class=
"org-string">"ltcc;"</span>: <span class="org-string">"⪦"</span>,
<span class="linenr"> 7433: </span>  <span class=
"org-string">"ltri;"</span>: <span class="org-string">"◃"</span>,
<span class="linenr"> 7434: </span>  <span class=
"org-string">"lvnE;"</span>: <span class="org-string">"≨︀"</span>,
<span class="linenr"> 7435: </span>  <span class=
"org-string">"macr;"</span>: <span class="org-string">"¯"</span>,
<span class="linenr"> 7436: </span>  <span class=
"org-string">"male;"</span>: <span class="org-string">"♂"</span>,
<span class="linenr"> 7437: </span>  <span class=
"org-string">"malt;"</span>: <span class="org-string">"✠"</span>,
<span class="linenr"> 7438: </span>  <span class=
"org-string">"micro"</span>: <span class="org-string">"µ"</span>,
<span class="linenr"> 7439: </span>  <span class=
"org-string">"mlcp;"</span>: <span class="org-string">"⫛"</span>,
<span class="linenr"> 7440: </span>  <span class=
"org-string">"mldr;"</span>: <span class="org-string">"…"</span>,
<span class="linenr"> 7441: </span>  <span class=
"org-string">"Mopf;"</span>: <span class="org-string">"𝕄"</span>,
<span class="linenr"> 7442: </span>  <span class=
"org-string">"mopf;"</span>: <span class="org-string">"𝕞"</span>,
<span class="linenr"> 7443: </span>  <span class=
"org-string">"Mscr;"</span>: <span class="org-string">"ℳ"</span>,
<span class="linenr"> 7444: </span>  <span class=
"org-string">"mscr;"</span>: <span class="org-string">"𝓂"</span>,
<span class="linenr"> 7445: </span>  <span class=
"org-string">"nang;"</span>: <span class="org-string">"∠⃒"</span>,
<span class="linenr"> 7446: </span>  <span class=
"org-string">"napE;"</span>: <span class="org-string">"⩰̸"</span>,
<span class="linenr"> 7447: </span>  <span class=
"org-string">"nbsp;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 7448: </span>  <span class=
"org-string">"ncap;"</span>: <span class="org-string">"⩃"</span>,
<span class="linenr"> 7449: </span>  <span class=
"org-string">"ncup;"</span>: <span class="org-string">"⩂"</span>,
<span class="linenr"> 7450: </span>  <span class=
"org-string">"ngeq;"</span>: <span class="org-string">"≱"</span>,
<span class="linenr"> 7451: </span>  <span class=
"org-string">"nges;"</span>: <span class="org-string">"⩾̸"</span>,
<span class="linenr"> 7452: </span>  <span class=
"org-string">"ngtr;"</span>: <span class="org-string">"≯"</span>,
<span class="linenr"> 7453: </span>  <span class=
"org-string">"nGtv;"</span>: <span class="org-string">"≫̸"</span>,
<span class="linenr"> 7454: </span>  <span class=
"org-string">"nisd;"</span>: <span class="org-string">"⋺"</span>,
<span class="linenr"> 7455: </span>  <span class=
"org-string">"NJcy;"</span>: <span class="org-string">"Њ"</span>,
<span class="linenr"> 7456: </span>  <span class=
"org-string">"njcy;"</span>: <span class="org-string">"њ"</span>,
<span class="linenr"> 7457: </span>  <span class=
"org-string">"nldr;"</span>: <span class="org-string">"‥"</span>,
<span class="linenr"> 7458: </span>  <span class=
"org-string">"nleq;"</span>: <span class="org-string">"≰"</span>,
<span class="linenr"> 7459: </span>  <span class=
"org-string">"nles;"</span>: <span class="org-string">"⩽̸"</span>,
<span class="linenr"> 7460: </span>  <span class=
"org-string">"nLtv;"</span>: <span class="org-string">"≪̸"</span>,
<span class="linenr"> 7461: </span>  <span class=
"org-string">"nmid;"</span>: <span class="org-string">"∤"</span>,
<span class="linenr"> 7462: </span>  <span class=
"org-string">"Nopf;"</span>: <span class="org-string">"ℕ"</span>,
<span class="linenr"> 7463: </span>  <span class=
"org-string">"nopf;"</span>: <span class="org-string">"𝕟"</span>,
<span class="linenr"> 7464: </span>  <span class=
"org-string">"npar;"</span>: <span class="org-string">"∦"</span>,
<span class="linenr"> 7465: </span>  <span class=
"org-string">"npre;"</span>: <span class="org-string">"⪯̸"</span>,
<span class="linenr"> 7466: </span>  <span class=
"org-string">"nsce;"</span>: <span class="org-string">"⪰̸"</span>,
<span class="linenr"> 7467: </span>  <span class=
"org-string">"Nscr;"</span>: <span class="org-string">"𝒩"</span>,
<span class="linenr"> 7468: </span>  <span class=
"org-string">"nscr;"</span>: <span class="org-string">"𝓃"</span>,
<span class="linenr"> 7469: </span>  <span class=
"org-string">"nsim;"</span>: <span class="org-string">"≁"</span>,
<span class="linenr"> 7470: </span>  <span class=
"org-string">"nsub;"</span>: <span class="org-string">"⊄"</span>,
<span class="linenr"> 7471: </span>  <span class=
"org-string">"nsup;"</span>: <span class="org-string">"⊅"</span>,
<span class="linenr"> 7472: </span>  <span class=
"org-string">"ntgl;"</span>: <span class="org-string">"≹"</span>,
<span class="linenr"> 7473: </span>  <span class=
"org-string">"ntlg;"</span>: <span class="org-string">"≸"</span>,
<span class="linenr"> 7474: </span>  <span class=
"org-string">"nvap;"</span>: <span class="org-string">"≍⃒"</span>,
<span class="linenr"> 7475: </span>  <span class=
"org-string">"nvge;"</span>: <span class="org-string">"≥⃒"</span>,
<span class="linenr"> 7476: </span>  <span class=
"org-string">"nvgt;"</span>: <span class=
"org-string">"&gt;⃒"</span>,
<span class="linenr"> 7477: </span>  <span class=
"org-string">"nvle;"</span>: <span class="org-string">"≤⃒"</span>,
<span class="linenr"> 7478: </span>  <span class=
"org-string">"nvlt;"</span>: <span class=
"org-string">"&lt;⃒"</span>,
<span class="linenr"> 7479: </span>  <span class=
"org-string">"oast;"</span>: <span class="org-string">"⊛"</span>,
<span class="linenr"> 7480: </span>  <span class=
"org-string">"ocir;"</span>: <span class="org-string">"⊚"</span>,
<span class="linenr"> 7481: </span>  <span class=
"org-string">"Ocirc"</span>: <span class="org-string">"Ô"</span>,
<span class="linenr"> 7482: </span>  <span class=
"org-string">"ocirc"</span>: <span class="org-string">"ô"</span>,
<span class="linenr"> 7483: </span>  <span class=
"org-string">"odiv;"</span>: <span class="org-string">"⨸"</span>,
<span class="linenr"> 7484: </span>  <span class=
"org-string">"odot;"</span>: <span class="org-string">"⊙"</span>,
<span class="linenr"> 7485: </span>  <span class=
"org-string">"ogon;"</span>: <span class="org-string">"˛"</span>,
<span class="linenr"> 7486: </span>  <span class=
"org-string">"oint;"</span>: <span class="org-string">"∮"</span>,
<span class="linenr"> 7487: </span>  <span class=
"org-string">"omid;"</span>: <span class="org-string">"⦶"</span>,
<span class="linenr"> 7488: </span>  <span class=
"org-string">"Oopf;"</span>: <span class="org-string">"𝕆"</span>,
<span class="linenr"> 7489: </span>  <span class=
"org-string">"oopf;"</span>: <span class="org-string">"𝕠"</span>,
<span class="linenr"> 7490: </span>  <span class=
"org-string">"opar;"</span>: <span class="org-string">"⦷"</span>,
<span class="linenr"> 7491: </span>  <span class=
"org-string">"ordf;"</span>: <span class="org-string">"ª"</span>,
<span class="linenr"> 7492: </span>  <span class=
"org-string">"ordm;"</span>: <span class="org-string">"º"</span>,
<span class="linenr"> 7493: </span>  <span class=
"org-string">"oror;"</span>: <span class="org-string">"⩖"</span>,
<span class="linenr"> 7494: </span>  <span class=
"org-string">"Oscr;"</span>: <span class="org-string">"𝒪"</span>,
<span class="linenr"> 7495: </span>  <span class=
"org-string">"oscr;"</span>: <span class="org-string">"ℴ"</span>,
<span class="linenr"> 7496: </span>  <span class=
"org-string">"osol;"</span>: <span class="org-string">"⊘"</span>,
<span class="linenr"> 7497: </span>  <span class=
"org-string">"Ouml;"</span>: <span class="org-string">"Ö"</span>,
<span class="linenr"> 7498: </span>  <span class=
"org-string">"ouml;"</span>: <span class="org-string">"ö"</span>,
<span class="linenr"> 7499: </span>  <span class=
"org-string">"para;"</span>: <span class="org-string">"¶"</span>,
<span class="linenr"> 7500: </span>  <span class=
"org-string">"part;"</span>: <span class="org-string">"∂"</span>,
<span class="linenr"> 7501: </span>  <span class=
"org-string">"perp;"</span>: <span class="org-string">"⊥"</span>,
<span class="linenr"> 7502: </span>  <span class=
"org-string">"phiv;"</span>: <span class="org-string">"ϕ"</span>,
<span class="linenr"> 7503: </span>  <span class=
"org-string">"plus;"</span>: <span class="org-string">"+"</span>,
<span class="linenr"> 7504: </span>  <span class=
"org-string">"Popf;"</span>: <span class="org-string">"ℙ"</span>,
<span class="linenr"> 7505: </span>  <span class=
"org-string">"popf;"</span>: <span class="org-string">"𝕡"</span>,
<span class="linenr"> 7506: </span>  <span class=
"org-string">"pound"</span>: <span class="org-string">"£"</span>,
<span class="linenr"> 7507: </span>  <span class=
"org-string">"prap;"</span>: <span class="org-string">"⪷"</span>,
<span class="linenr"> 7508: </span>  <span class=
"org-string">"prec;"</span>: <span class="org-string">"≺"</span>,
<span class="linenr"> 7509: </span>  <span class=
"org-string">"prnE;"</span>: <span class="org-string">"⪵"</span>,
<span class="linenr"> 7510: </span>  <span class=
"org-string">"prod;"</span>: <span class="org-string">"∏"</span>,
<span class="linenr"> 7511: </span>  <span class=
"org-string">"prop;"</span>: <span class="org-string">"∝"</span>,
<span class="linenr"> 7512: </span>  <span class=
"org-string">"Pscr;"</span>: <span class="org-string">"𝒫"</span>,
<span class="linenr"> 7513: </span>  <span class=
"org-string">"pscr;"</span>: <span class="org-string">"𝓅"</span>,
<span class="linenr"> 7514: </span>  <span class=
"org-string">"qint;"</span>: <span class="org-string">"⨌"</span>,
<span class="linenr"> 7515: </span>  <span class=
"org-string">"Qopf;"</span>: <span class="org-string">"ℚ"</span>,
<span class="linenr"> 7516: </span>  <span class=
"org-string">"qopf;"</span>: <span class="org-string">"𝕢"</span>,
<span class="linenr"> 7517: </span>  <span class=
"org-string">"Qscr;"</span>: <span class="org-string">"𝒬"</span>,
<span class="linenr"> 7518: </span>  <span class=
"org-string">"qscr;"</span>: <span class="org-string">"𝓆"</span>,
<span class="linenr"> 7519: </span>  <span class=
"org-string">"QUOT;"</span>: <span class="org-string">"\""</span>,
<span class="linenr"> 7520: </span>  <span class=
"org-string">"quot;"</span>: <span class="org-string">"\""</span>,
<span class="linenr"> 7521: </span>  <span class=
"org-string">"race;"</span>: <span class="org-string">"∽̱"</span>,
<span class="linenr"> 7522: </span>  <span class=
"org-string">"Rang;"</span>: <span class="org-string">"⟫"</span>,
<span class="linenr"> 7523: </span>  <span class=
"org-string">"rang;"</span>: <span class="org-string">"⟩"</span>,
<span class="linenr"> 7524: </span>  <span class=
"org-string">"raquo"</span>: <span class="org-string">"»"</span>,
<span class="linenr"> 7525: </span>  <span class=
"org-string">"Rarr;"</span>: <span class="org-string">"↠"</span>,
<span class="linenr"> 7526: </span>  <span class=
"org-string">"rArr;"</span>: <span class="org-string">"⇒"</span>,
<span class="linenr"> 7527: </span>  <span class=
"org-string">"rarr;"</span>: <span class="org-string">"→"</span>,
<span class="linenr"> 7528: </span>  <span class=
"org-string">"rcub;"</span>: <span class="org-string">"}"</span>,
<span class="linenr"> 7529: </span>  <span class=
"org-string">"rdca;"</span>: <span class="org-string">"⤷"</span>,
<span class="linenr"> 7530: </span>  <span class=
"org-string">"rdsh;"</span>: <span class="org-string">"↳"</span>,
<span class="linenr"> 7531: </span>  <span class=
"org-string">"real;"</span>: <span class="org-string">"ℜ"</span>,
<span class="linenr"> 7532: </span>  <span class=
"org-string">"rect;"</span>: <span class="org-string">"▭"</span>,
<span class="linenr"> 7533: </span>  <span class=
"org-string">"rHar;"</span>: <span class="org-string">"⥤"</span>,
<span class="linenr"> 7534: </span>  <span class=
"org-string">"rhov;"</span>: <span class="org-string">"ϱ"</span>,
<span class="linenr"> 7535: </span>  <span class=
"org-string">"ring;"</span>: <span class="org-string">"˚"</span>,
<span class="linenr"> 7536: </span>  <span class=
"org-string">"Ropf;"</span>: <span class="org-string">"ℝ"</span>,
<span class="linenr"> 7537: </span>  <span class=
"org-string">"ropf;"</span>: <span class="org-string">"𝕣"</span>,
<span class="linenr"> 7538: </span>  <span class=
"org-string">"rpar;"</span>: <span class="org-string">")"</span>,
<span class="linenr"> 7539: </span>  <span class=
"org-string">"Rscr;"</span>: <span class="org-string">"ℛ"</span>,
<span class="linenr"> 7540: </span>  <span class=
"org-string">"rscr;"</span>: <span class="org-string">"𝓇"</span>,
<span class="linenr"> 7541: </span>  <span class=
"org-string">"rsqb;"</span>: <span class="org-string">"]"</span>,
<span class="linenr"> 7542: </span>  <span class=
"org-string">"rtri;"</span>: <span class="org-string">"▹"</span>,
<span class="linenr"> 7543: </span>  <span class=
"org-string">"scap;"</span>: <span class="org-string">"⪸"</span>,
<span class="linenr"> 7544: </span>  <span class=
"org-string">"scnE;"</span>: <span class="org-string">"⪶"</span>,
<span class="linenr"> 7545: </span>  <span class=
"org-string">"sdot;"</span>: <span class="org-string">"⋅"</span>,
<span class="linenr"> 7546: </span>  <span class=
"org-string">"sect;"</span>: <span class="org-string">"§"</span>,
<span class="linenr"> 7547: </span>  <span class=
"org-string">"semi;"</span>: <span class="org-string">";"</span>,
<span class="linenr"> 7548: </span>  <span class=
"org-string">"sext;"</span>: <span class="org-string">"✶"</span>,
<span class="linenr"> 7549: </span>  <span class=
"org-string">"SHcy;"</span>: <span class="org-string">"Ш"</span>,
<span class="linenr"> 7550: </span>  <span class=
"org-string">"shcy;"</span>: <span class="org-string">"ш"</span>,
<span class="linenr"> 7551: </span>  <span class=
"org-string">"sime;"</span>: <span class="org-string">"≃"</span>,
<span class="linenr"> 7552: </span>  <span class=
"org-string">"simg;"</span>: <span class="org-string">"⪞"</span>,
<span class="linenr"> 7553: </span>  <span class=
"org-string">"siml;"</span>: <span class="org-string">"⪝"</span>,
<span class="linenr"> 7554: </span>  <span class=
"org-string">"smid;"</span>: <span class="org-string">"∣"</span>,
<span class="linenr"> 7555: </span>  <span class=
"org-string">"smte;"</span>: <span class="org-string">"⪬"</span>,
<span class="linenr"> 7556: </span>  <span class=
"org-string">"solb;"</span>: <span class="org-string">"⧄"</span>,
<span class="linenr"> 7557: </span>  <span class=
"org-string">"Sopf;"</span>: <span class="org-string">"𝕊"</span>,
<span class="linenr"> 7558: </span>  <span class=
"org-string">"sopf;"</span>: <span class="org-string">"𝕤"</span>,
<span class="linenr"> 7559: </span>  <span class=
"org-string">"spar;"</span>: <span class="org-string">"∥"</span>,
<span class="linenr"> 7560: </span>  <span class=
"org-string">"Sqrt;"</span>: <span class="org-string">"√"</span>,
<span class="linenr"> 7561: </span>  <span class=
"org-string">"squf;"</span>: <span class="org-string">"▪"</span>,
<span class="linenr"> 7562: </span>  <span class=
"org-string">"Sscr;"</span>: <span class="org-string">"𝒮"</span>,
<span class="linenr"> 7563: </span>  <span class=
"org-string">"sscr;"</span>: <span class="org-string">"𝓈"</span>,
<span class="linenr"> 7564: </span>  <span class=
"org-string">"Star;"</span>: <span class="org-string">"⋆"</span>,
<span class="linenr"> 7565: </span>  <span class=
"org-string">"star;"</span>: <span class="org-string">"☆"</span>,
<span class="linenr"> 7566: </span>  <span class=
"org-string">"subE;"</span>: <span class="org-string">"⫅"</span>,
<span class="linenr"> 7567: </span>  <span class=
"org-string">"sube;"</span>: <span class="org-string">"⊆"</span>,
<span class="linenr"> 7568: </span>  <span class=
"org-string">"succ;"</span>: <span class="org-string">"≻"</span>,
<span class="linenr"> 7569: </span>  <span class=
"org-string">"sung;"</span>: <span class="org-string">"♪"</span>,
<span class="linenr"> 7570: </span>  <span class=
"org-string">"sup1;"</span>: <span class="org-string">"¹"</span>,
<span class="linenr"> 7571: </span>  <span class=
"org-string">"sup2;"</span>: <span class="org-string">"²"</span>,
<span class="linenr"> 7572: </span>  <span class=
"org-string">"sup3;"</span>: <span class="org-string">"³"</span>,
<span class="linenr"> 7573: </span>  <span class=
"org-string">"supE;"</span>: <span class="org-string">"⫆"</span>,
<span class="linenr"> 7574: </span>  <span class=
"org-string">"supe;"</span>: <span class="org-string">"⊇"</span>,
<span class="linenr"> 7575: </span>  <span class=
"org-string">"szlig"</span>: <span class="org-string">"ß"</span>,
<span class="linenr"> 7576: </span>  <span class=
"org-string">"tbrk;"</span>: <span class="org-string">"⎴"</span>,
<span class="linenr"> 7577: </span>  <span class=
"org-string">"tdot;"</span>: <span class="org-string">"⃛"</span>,
<span class="linenr"> 7578: </span>  <span class=
"org-string">"THORN"</span>: <span class="org-string">"Þ"</span>,
<span class="linenr"> 7579: </span>  <span class=
"org-string">"thorn"</span>: <span class="org-string">"þ"</span>,
<span class="linenr"> 7580: </span>  <span class=
"org-string">"times"</span>: <span class="org-string">"×"</span>,
<span class="linenr"> 7581: </span>  <span class=
"org-string">"tint;"</span>: <span class="org-string">"∭"</span>,
<span class="linenr"> 7582: </span>  <span class=
"org-string">"toea;"</span>: <span class="org-string">"⤨"</span>,
<span class="linenr"> 7583: </span>  <span class=
"org-string">"Topf;"</span>: <span class="org-string">"𝕋"</span>,
<span class="linenr"> 7584: </span>  <span class=
"org-string">"topf;"</span>: <span class="org-string">"𝕥"</span>,
<span class="linenr"> 7585: </span>  <span class=
"org-string">"tosa;"</span>: <span class="org-string">"⤩"</span>,
<span class="linenr"> 7586: </span>  <span class=
"org-string">"trie;"</span>: <span class="org-string">"≜"</span>,
<span class="linenr"> 7587: </span>  <span class=
"org-string">"Tscr;"</span>: <span class="org-string">"𝒯"</span>,
<span class="linenr"> 7588: </span>  <span class=
"org-string">"tscr;"</span>: <span class="org-string">"𝓉"</span>,
<span class="linenr"> 7589: </span>  <span class=
"org-string">"TScy;"</span>: <span class="org-string">"Ц"</span>,
<span class="linenr"> 7590: </span>  <span class=
"org-string">"tscy;"</span>: <span class="org-string">"ц"</span>,
<span class="linenr"> 7591: </span>  <span class=
"org-string">"Uarr;"</span>: <span class="org-string">"↟"</span>,
<span class="linenr"> 7592: </span>  <span class=
"org-string">"uArr;"</span>: <span class="org-string">"⇑"</span>,
<span class="linenr"> 7593: </span>  <span class=
"org-string">"uarr;"</span>: <span class="org-string">"↑"</span>,
<span class="linenr"> 7594: </span>  <span class=
"org-string">"Ucirc"</span>: <span class="org-string">"Û"</span>,
<span class="linenr"> 7595: </span>  <span class=
"org-string">"ucirc"</span>: <span class="org-string">"û"</span>,
<span class="linenr"> 7596: </span>  <span class=
"org-string">"uHar;"</span>: <span class="org-string">"⥣"</span>,
<span class="linenr"> 7597: </span>  <span class=
"org-string">"Uopf;"</span>: <span class="org-string">"𝕌"</span>,
<span class="linenr"> 7598: </span>  <span class=
"org-string">"uopf;"</span>: <span class="org-string">"𝕦"</span>,
<span class="linenr"> 7599: </span>  <span class=
"org-string">"Upsi;"</span>: <span class="org-string">"ϒ"</span>,
<span class="linenr"> 7600: </span>  <span class=
"org-string">"upsi;"</span>: <span class="org-string">"υ"</span>,
<span class="linenr"> 7601: </span>  <span class=
"org-string">"Uscr;"</span>: <span class="org-string">"𝒰"</span>,
<span class="linenr"> 7602: </span>  <span class=
"org-string">"uscr;"</span>: <span class="org-string">"𝓊"</span>,
<span class="linenr"> 7603: </span>  <span class=
"org-string">"utri;"</span>: <span class="org-string">"▵"</span>,
<span class="linenr"> 7604: </span>  <span class=
"org-string">"Uuml;"</span>: <span class="org-string">"Ü"</span>,
<span class="linenr"> 7605: </span>  <span class=
"org-string">"uuml;"</span>: <span class="org-string">"ü"</span>,
<span class="linenr"> 7606: </span>  <span class=
"org-string">"vArr;"</span>: <span class="org-string">"⇕"</span>,
<span class="linenr"> 7607: </span>  <span class=
"org-string">"varr;"</span>: <span class="org-string">"↕"</span>,
<span class="linenr"> 7608: </span>  <span class=
"org-string">"Vbar;"</span>: <span class="org-string">"⫫"</span>,
<span class="linenr"> 7609: </span>  <span class=
"org-string">"vBar;"</span>: <span class="org-string">"⫨"</span>,
<span class="linenr"> 7610: </span>  <span class=
"org-string">"Vert;"</span>: <span class="org-string">"‖"</span>,
<span class="linenr"> 7611: </span>  <span class=
"org-string">"vert;"</span>: <span class="org-string">"|"</span>,
<span class="linenr"> 7612: </span>  <span class=
"org-string">"Vopf;"</span>: <span class="org-string">"𝕍"</span>,
<span class="linenr"> 7613: </span>  <span class=
"org-string">"vopf;"</span>: <span class="org-string">"𝕧"</span>,
<span class="linenr"> 7614: </span>  <span class=
"org-string">"Vscr;"</span>: <span class="org-string">"𝒱"</span>,
<span class="linenr"> 7615: </span>  <span class=
"org-string">"vscr;"</span>: <span class="org-string">"𝓋"</span>,
<span class="linenr"> 7616: </span>  <span class=
"org-string">"Wopf;"</span>: <span class="org-string">"𝕎"</span>,
<span class="linenr"> 7617: </span>  <span class=
"org-string">"wopf;"</span>: <span class="org-string">"𝕨"</span>,
<span class="linenr"> 7618: </span>  <span class=
"org-string">"Wscr;"</span>: <span class="org-string">"𝒲"</span>,
<span class="linenr"> 7619: </span>  <span class=
"org-string">"wscr;"</span>: <span class="org-string">"𝓌"</span>,
<span class="linenr"> 7620: </span>  <span class=
"org-string">"xcap;"</span>: <span class="org-string">"⋂"</span>,
<span class="linenr"> 7621: </span>  <span class=
"org-string">"xcup;"</span>: <span class="org-string">"⋃"</span>,
<span class="linenr"> 7622: </span>  <span class=
"org-string">"xmap;"</span>: <span class="org-string">"⟼"</span>,
<span class="linenr"> 7623: </span>  <span class=
"org-string">"xnis;"</span>: <span class="org-string">"⋻"</span>,
<span class="linenr"> 7624: </span>  <span class=
"org-string">"Xopf;"</span>: <span class="org-string">"𝕏"</span>,
<span class="linenr"> 7625: </span>  <span class=
"org-string">"xopf;"</span>: <span class="org-string">"𝕩"</span>,
<span class="linenr"> 7626: </span>  <span class=
"org-string">"Xscr;"</span>: <span class="org-string">"𝒳"</span>,
<span class="linenr"> 7627: </span>  <span class=
"org-string">"xscr;"</span>: <span class="org-string">"𝓍"</span>,
<span class="linenr"> 7628: </span>  <span class=
"org-string">"xvee;"</span>: <span class="org-string">"⋁"</span>,
<span class="linenr"> 7629: </span>  <span class=
"org-string">"YAcy;"</span>: <span class="org-string">"Я"</span>,
<span class="linenr"> 7630: </span>  <span class=
"org-string">"yacy;"</span>: <span class="org-string">"я"</span>,
<span class="linenr"> 7631: </span>  <span class=
"org-string">"YIcy;"</span>: <span class="org-string">"Ї"</span>,
<span class="linenr"> 7632: </span>  <span class=
"org-string">"yicy;"</span>: <span class="org-string">"ї"</span>,
<span class="linenr"> 7633: </span>  <span class=
"org-string">"Yopf;"</span>: <span class="org-string">"𝕐"</span>,
<span class="linenr"> 7634: </span>  <span class=
"org-string">"yopf;"</span>: <span class="org-string">"𝕪"</span>,
<span class="linenr"> 7635: </span>  <span class=
"org-string">"Yscr;"</span>: <span class="org-string">"𝒴"</span>,
<span class="linenr"> 7636: </span>  <span class=
"org-string">"yscr;"</span>: <span class="org-string">"𝓎"</span>,
<span class="linenr"> 7637: </span>  <span class=
"org-string">"YUcy;"</span>: <span class="org-string">"Ю"</span>,
<span class="linenr"> 7638: </span>  <span class=
"org-string">"yucy;"</span>: <span class="org-string">"ю"</span>,
<span class="linenr"> 7639: </span>  <span class=
"org-string">"Yuml;"</span>: <span class="org-string">"Ÿ"</span>,
<span class="linenr"> 7640: </span>  <span class=
"org-string">"yuml;"</span>: <span class="org-string">"ÿ"</span>,
<span class="linenr"> 7641: </span>  <span class=
"org-string">"Zdot;"</span>: <span class="org-string">"Ż"</span>,
<span class="linenr"> 7642: </span>  <span class=
"org-string">"zdot;"</span>: <span class="org-string">"ż"</span>,
<span class="linenr"> 7643: </span>  <span class=
"org-string">"Zeta;"</span>: <span class="org-string">"Ζ"</span>,
<span class="linenr"> 7644: </span>  <span class=
"org-string">"zeta;"</span>: <span class="org-string">"ζ"</span>,
<span class="linenr"> 7645: </span>  <span class=
"org-string">"ZHcy;"</span>: <span class="org-string">"Ж"</span>,
<span class="linenr"> 7646: </span>  <span class=
"org-string">"zhcy;"</span>: <span class="org-string">"ж"</span>,
<span class="linenr"> 7647: </span>  <span class=
"org-string">"Zopf;"</span>: <span class="org-string">"ℤ"</span>,
<span class="linenr"> 7648: </span>  <span class=
"org-string">"zopf;"</span>: <span class="org-string">"𝕫"</span>,
<span class="linenr"> 7649: </span>  <span class=
"org-string">"Zscr;"</span>: <span class="org-string">"𝒵"</span>,
<span class="linenr"> 7650: </span>  <span class=
"org-string">"zscr;"</span>: <span class="org-string">"𝓏"</span>,
<span class="linenr"> 7651: </span>  <span class=
"org-string">"zwnj;"</span>: <span class="org-string">"‌"</span>,
<span class="linenr"> 7652: </span>  <span class=
"org-string">"Aacute"</span>: <span class="org-string">"Á"</span>,
<span class="linenr"> 7653: </span>  <span class=
"org-string">"aacute"</span>: <span class="org-string">"á"</span>,
<span class="linenr"> 7654: </span>  <span class=
"org-string">"Acirc;"</span>: <span class="org-string">"Â"</span>,
<span class="linenr"> 7655: </span>  <span class=
"org-string">"acirc;"</span>: <span class="org-string">"â"</span>,
<span class="linenr"> 7656: </span>  <span class=
"org-string">"acute;"</span>: <span class="org-string">"´"</span>,
<span class="linenr"> 7657: </span>  <span class=
"org-string">"AElig;"</span>: <span class="org-string">"Æ"</span>,
<span class="linenr"> 7658: </span>  <span class=
"org-string">"aelig;"</span>: <span class="org-string">"æ"</span>,
<span class="linenr"> 7659: </span>  <span class=
"org-string">"Agrave"</span>: <span class="org-string">"À"</span>,
<span class="linenr"> 7660: </span>  <span class=
"org-string">"agrave"</span>: <span class="org-string">"à"</span>,
<span class="linenr"> 7661: </span>  <span class=
"org-string">"aleph;"</span>: <span class="org-string">"ℵ"</span>,
<span class="linenr"> 7662: </span>  <span class=
"org-string">"Alpha;"</span>: <span class="org-string">"Α"</span>,
<span class="linenr"> 7663: </span>  <span class=
"org-string">"alpha;"</span>: <span class="org-string">"α"</span>,
<span class="linenr"> 7664: </span>  <span class=
"org-string">"Amacr;"</span>: <span class="org-string">"Ā"</span>,
<span class="linenr"> 7665: </span>  <span class=
"org-string">"amacr;"</span>: <span class="org-string">"ā"</span>,
<span class="linenr"> 7666: </span>  <span class=
"org-string">"amalg;"</span>: <span class="org-string">"⨿"</span>,
<span class="linenr"> 7667: </span>  <span class=
"org-string">"angle;"</span>: <span class="org-string">"∠"</span>,
<span class="linenr"> 7668: </span>  <span class=
"org-string">"angrt;"</span>: <span class="org-string">"∟"</span>,
<span class="linenr"> 7669: </span>  <span class=
"org-string">"angst;"</span>: <span class="org-string">"Å"</span>,
<span class="linenr"> 7670: </span>  <span class=
"org-string">"Aogon;"</span>: <span class="org-string">"Ą"</span>,
<span class="linenr"> 7671: </span>  <span class=
"org-string">"aogon;"</span>: <span class="org-string">"ą"</span>,
<span class="linenr"> 7672: </span>  <span class=
"org-string">"Aring;"</span>: <span class="org-string">"Å"</span>,
<span class="linenr"> 7673: </span>  <span class=
"org-string">"aring;"</span>: <span class="org-string">"å"</span>,
<span class="linenr"> 7674: </span>  <span class=
"org-string">"asymp;"</span>: <span class="org-string">"≈"</span>,
<span class="linenr"> 7675: </span>  <span class=
"org-string">"Atilde"</span>: <span class="org-string">"Ã"</span>,
<span class="linenr"> 7676: </span>  <span class=
"org-string">"atilde"</span>: <span class="org-string">"ã"</span>,
<span class="linenr"> 7677: </span>  <span class=
"org-string">"awint;"</span>: <span class="org-string">"⨑"</span>,
<span class="linenr"> 7678: </span>  <span class=
"org-string">"bcong;"</span>: <span class="org-string">"≌"</span>,
<span class="linenr"> 7679: </span>  <span class=
"org-string">"bdquo;"</span>: <span class="org-string">"„"</span>,
<span class="linenr"> 7680: </span>  <span class=
"org-string">"bepsi;"</span>: <span class="org-string">"϶"</span>,
<span class="linenr"> 7681: </span>  <span class=
"org-string">"blank;"</span>: <span class="org-string">"␣"</span>,
<span class="linenr"> 7682: </span>  <span class=
"org-string">"blk12;"</span>: <span class="org-string">"▒"</span>,
<span class="linenr"> 7683: </span>  <span class=
"org-string">"blk14;"</span>: <span class="org-string">"░"</span>,
<span class="linenr"> 7684: </span>  <span class=
"org-string">"blk34;"</span>: <span class="org-string">"▓"</span>,
<span class="linenr"> 7685: </span>  <span class=
"org-string">"block;"</span>: <span class="org-string">"█"</span>,
<span class="linenr"> 7686: </span>  <span class=
"org-string">"boxDL;"</span>: <span class="org-string">"╗"</span>,
<span class="linenr"> 7687: </span>  <span class=
"org-string">"boxDl;"</span>: <span class="org-string">"╖"</span>,
<span class="linenr"> 7688: </span>  <span class=
"org-string">"boxdL;"</span>: <span class="org-string">"╕"</span>,
<span class="linenr"> 7689: </span>  <span class=
"org-string">"boxdl;"</span>: <span class="org-string">"┐"</span>,
<span class="linenr"> 7690: </span>  <span class=
"org-string">"boxDR;"</span>: <span class="org-string">"╔"</span>,
<span class="linenr"> 7691: </span>  <span class=
"org-string">"boxDr;"</span>: <span class="org-string">"╓"</span>,
<span class="linenr"> 7692: </span>  <span class=
"org-string">"boxdR;"</span>: <span class="org-string">"╒"</span>,
<span class="linenr"> 7693: </span>  <span class=
"org-string">"boxdr;"</span>: <span class="org-string">"┌"</span>,
<span class="linenr"> 7694: </span>  <span class=
"org-string">"boxHD;"</span>: <span class="org-string">"╦"</span>,
<span class="linenr"> 7695: </span>  <span class=
"org-string">"boxHd;"</span>: <span class="org-string">"╤"</span>,
<span class="linenr"> 7696: </span>  <span class=
"org-string">"boxhD;"</span>: <span class="org-string">"╥"</span>,
<span class="linenr"> 7697: </span>  <span class=
"org-string">"boxhd;"</span>: <span class="org-string">"┬"</span>,
<span class="linenr"> 7698: </span>  <span class=
"org-string">"boxHU;"</span>: <span class="org-string">"╩"</span>,
<span class="linenr"> 7699: </span>  <span class=
"org-string">"boxHu;"</span>: <span class="org-string">"╧"</span>,
<span class="linenr"> 7700: </span>  <span class=
"org-string">"boxhU;"</span>: <span class="org-string">"╨"</span>,
<span class="linenr"> 7701: </span>  <span class=
"org-string">"boxhu;"</span>: <span class="org-string">"┴"</span>,
<span class="linenr"> 7702: </span>  <span class=
"org-string">"boxUL;"</span>: <span class="org-string">"╝"</span>,
<span class="linenr"> 7703: </span>  <span class=
"org-string">"boxUl;"</span>: <span class="org-string">"╜"</span>,
<span class="linenr"> 7704: </span>  <span class=
"org-string">"boxuL;"</span>: <span class="org-string">"╛"</span>,
<span class="linenr"> 7705: </span>  <span class=
"org-string">"boxul;"</span>: <span class="org-string">"┘"</span>,
<span class="linenr"> 7706: </span>  <span class=
"org-string">"boxUR;"</span>: <span class="org-string">"╚"</span>,
<span class="linenr"> 7707: </span>  <span class=
"org-string">"boxUr;"</span>: <span class="org-string">"╙"</span>,
<span class="linenr"> 7708: </span>  <span class=
"org-string">"boxuR;"</span>: <span class="org-string">"╘"</span>,
<span class="linenr"> 7709: </span>  <span class=
"org-string">"boxur;"</span>: <span class="org-string">"└"</span>,
<span class="linenr"> 7710: </span>  <span class=
"org-string">"boxVH;"</span>: <span class="org-string">"╬"</span>,
<span class="linenr"> 7711: </span>  <span class=
"org-string">"boxVh;"</span>: <span class="org-string">"╫"</span>,
<span class="linenr"> 7712: </span>  <span class=
"org-string">"boxvH;"</span>: <span class="org-string">"╪"</span>,
<span class="linenr"> 7713: </span>  <span class=
"org-string">"boxvh;"</span>: <span class="org-string">"┼"</span>,
<span class="linenr"> 7714: </span>  <span class=
"org-string">"boxVL;"</span>: <span class="org-string">"╣"</span>,
<span class="linenr"> 7715: </span>  <span class=
"org-string">"boxVl;"</span>: <span class="org-string">"╢"</span>,
<span class="linenr"> 7716: </span>  <span class=
"org-string">"boxvL;"</span>: <span class="org-string">"╡"</span>,
<span class="linenr"> 7717: </span>  <span class=
"org-string">"boxvl;"</span>: <span class="org-string">"┤"</span>,
<span class="linenr"> 7718: </span>  <span class=
"org-string">"boxVR;"</span>: <span class="org-string">"╠"</span>,
<span class="linenr"> 7719: </span>  <span class=
"org-string">"boxVr;"</span>: <span class="org-string">"╟"</span>,
<span class="linenr"> 7720: </span>  <span class=
"org-string">"boxvR;"</span>: <span class="org-string">"╞"</span>,
<span class="linenr"> 7721: </span>  <span class=
"org-string">"boxvr;"</span>: <span class="org-string">"├"</span>,
<span class="linenr"> 7722: </span>  <span class=
"org-string">"Breve;"</span>: <span class="org-string">"˘"</span>,
<span class="linenr"> 7723: </span>  <span class=
"org-string">"breve;"</span>: <span class="org-string">"˘"</span>,
<span class="linenr"> 7724: </span>  <span class=
"org-string">"brvbar"</span>: <span class="org-string">"¦"</span>,
<span class="linenr"> 7725: </span>  <span class=
"org-string">"bsemi;"</span>: <span class="org-string">"⁏"</span>,
<span class="linenr"> 7726: </span>  <span class=
"org-string">"bsime;"</span>: <span class="org-string">"⋍"</span>,
<span class="linenr"> 7727: </span>  <span class=
"org-string">"bsolb;"</span>: <span class="org-string">"⧅"</span>,
<span class="linenr"> 7728: </span>  <span class=
"org-string">"bumpE;"</span>: <span class="org-string">"⪮"</span>,
<span class="linenr"> 7729: </span>  <span class=
"org-string">"bumpe;"</span>: <span class="org-string">"≏"</span>,
<span class="linenr"> 7730: </span>  <span class=
"org-string">"caret;"</span>: <span class="org-string">"⁁"</span>,
<span class="linenr"> 7731: </span>  <span class=
"org-string">"caron;"</span>: <span class="org-string">"ˇ"</span>,
<span class="linenr"> 7732: </span>  <span class=
"org-string">"ccaps;"</span>: <span class="org-string">"⩍"</span>,
<span class="linenr"> 7733: </span>  <span class=
"org-string">"Ccedil"</span>: <span class="org-string">"Ç"</span>,
<span class="linenr"> 7734: </span>  <span class=
"org-string">"ccedil"</span>: <span class="org-string">"ç"</span>,
<span class="linenr"> 7735: </span>  <span class=
"org-string">"Ccirc;"</span>: <span class="org-string">"Ĉ"</span>,
<span class="linenr"> 7736: </span>  <span class=
"org-string">"ccirc;"</span>: <span class="org-string">"ĉ"</span>,
<span class="linenr"> 7737: </span>  <span class=
"org-string">"ccups;"</span>: <span class="org-string">"⩌"</span>,
<span class="linenr"> 7738: </span>  <span class=
"org-string">"cedil;"</span>: <span class="org-string">"¸"</span>,
<span class="linenr"> 7739: </span>  <span class=
"org-string">"check;"</span>: <span class="org-string">"✓"</span>,
<span class="linenr"> 7740: </span>  <span class=
"org-string">"clubs;"</span>: <span class="org-string">"♣"</span>,
<span class="linenr"> 7741: </span>  <span class=
"org-string">"Colon;"</span>: <span class="org-string">"∷"</span>,
<span class="linenr"> 7742: </span>  <span class=
"org-string">"colon;"</span>: <span class="org-string">":"</span>,
<span class="linenr"> 7743: </span>  <span class=
"org-string">"comma;"</span>: <span class="org-string">","</span>,
<span class="linenr"> 7744: </span>  <span class=
"org-string">"crarr;"</span>: <span class="org-string">"↵"</span>,
<span class="linenr"> 7745: </span>  <span class=
"org-string">"Cross;"</span>: <span class="org-string">"⨯"</span>,
<span class="linenr"> 7746: </span>  <span class=
"org-string">"cross;"</span>: <span class="org-string">"✗"</span>,
<span class="linenr"> 7747: </span>  <span class=
"org-string">"csube;"</span>: <span class="org-string">"⫑"</span>,
<span class="linenr"> 7748: </span>  <span class=
"org-string">"csupe;"</span>: <span class="org-string">"⫒"</span>,
<span class="linenr"> 7749: </span>  <span class=
"org-string">"ctdot;"</span>: <span class="org-string">"⋯"</span>,
<span class="linenr"> 7750: </span>  <span class=
"org-string">"cuepr;"</span>: <span class="org-string">"⋞"</span>,
<span class="linenr"> 7751: </span>  <span class=
"org-string">"cuesc;"</span>: <span class="org-string">"⋟"</span>,
<span class="linenr"> 7752: </span>  <span class=
"org-string">"cupor;"</span>: <span class="org-string">"⩅"</span>,
<span class="linenr"> 7753: </span>  <span class=
"org-string">"curren"</span>: <span class="org-string">"¤"</span>,
<span class="linenr"> 7754: </span>  <span class=
"org-string">"cuvee;"</span>: <span class="org-string">"⋎"</span>,
<span class="linenr"> 7755: </span>  <span class=
"org-string">"cuwed;"</span>: <span class="org-string">"⋏"</span>,
<span class="linenr"> 7756: </span>  <span class=
"org-string">"cwint;"</span>: <span class="org-string">"∱"</span>,
<span class="linenr"> 7757: </span>  <span class=
"org-string">"Dashv;"</span>: <span class="org-string">"⫤"</span>,
<span class="linenr"> 7758: </span>  <span class=
"org-string">"dashv;"</span>: <span class="org-string">"⊣"</span>,
<span class="linenr"> 7759: </span>  <span class=
"org-string">"dblac;"</span>: <span class="org-string">"˝"</span>,
<span class="linenr"> 7760: </span>  <span class=
"org-string">"ddarr;"</span>: <span class="org-string">"⇊"</span>,
<span class="linenr"> 7761: </span>  <span class=
"org-string">"Delta;"</span>: <span class="org-string">"Δ"</span>,
<span class="linenr"> 7762: </span>  <span class=
"org-string">"delta;"</span>: <span class="org-string">"δ"</span>,
<span class="linenr"> 7763: </span>  <span class=
"org-string">"dharl;"</span>: <span class="org-string">"⇃"</span>,
<span class="linenr"> 7764: </span>  <span class=
"org-string">"dharr;"</span>: <span class="org-string">"⇂"</span>,
<span class="linenr"> 7765: </span>  <span class=
"org-string">"diams;"</span>: <span class="org-string">"♦"</span>,
<span class="linenr"> 7766: </span>  <span class=
"org-string">"disin;"</span>: <span class="org-string">"⋲"</span>,
<span class="linenr"> 7767: </span>  <span class=
"org-string">"divide"</span>: <span class="org-string">"÷"</span>,
<span class="linenr"> 7768: </span>  <span class=
"org-string">"doteq;"</span>: <span class="org-string">"≐"</span>,
<span class="linenr"> 7769: </span>  <span class=
"org-string">"dtdot;"</span>: <span class="org-string">"⋱"</span>,
<span class="linenr"> 7770: </span>  <span class=
"org-string">"dtrif;"</span>: <span class="org-string">"▾"</span>,
<span class="linenr"> 7771: </span>  <span class=
"org-string">"duarr;"</span>: <span class="org-string">"⇵"</span>,
<span class="linenr"> 7772: </span>  <span class=
"org-string">"duhar;"</span>: <span class="org-string">"⥯"</span>,
<span class="linenr"> 7773: </span>  <span class=
"org-string">"Eacute"</span>: <span class="org-string">"É"</span>,
<span class="linenr"> 7774: </span>  <span class=
"org-string">"eacute"</span>: <span class="org-string">"é"</span>,
<span class="linenr"> 7775: </span>  <span class=
"org-string">"Ecirc;"</span>: <span class="org-string">"Ê"</span>,
<span class="linenr"> 7776: </span>  <span class=
"org-string">"ecirc;"</span>: <span class="org-string">"ê"</span>,
<span class="linenr"> 7777: </span>  <span class=
"org-string">"eDDot;"</span>: <span class="org-string">"⩷"</span>,
<span class="linenr"> 7778: </span>  <span class=
"org-string">"efDot;"</span>: <span class="org-string">"≒"</span>,
<span class="linenr"> 7779: </span>  <span class=
"org-string">"Egrave"</span>: <span class="org-string">"È"</span>,
<span class="linenr"> 7780: </span>  <span class=
"org-string">"egrave"</span>: <span class="org-string">"è"</span>,
<span class="linenr"> 7781: </span>  <span class=
"org-string">"Emacr;"</span>: <span class="org-string">"Ē"</span>,
<span class="linenr"> 7782: </span>  <span class=
"org-string">"emacr;"</span>: <span class="org-string">"ē"</span>,
<span class="linenr"> 7783: </span>  <span class=
"org-string">"empty;"</span>: <span class="org-string">"∅"</span>,
<span class="linenr"> 7784: </span>  <span class=
"org-string">"Eogon;"</span>: <span class="org-string">"Ę"</span>,
<span class="linenr"> 7785: </span>  <span class=
"org-string">"eogon;"</span>: <span class="org-string">"ę"</span>,
<span class="linenr"> 7786: </span>  <span class=
"org-string">"eplus;"</span>: <span class="org-string">"⩱"</span>,
<span class="linenr"> 7787: </span>  <span class=
"org-string">"epsiv;"</span>: <span class="org-string">"ϵ"</span>,
<span class="linenr"> 7788: </span>  <span class=
"org-string">"eqsim;"</span>: <span class="org-string">"≂"</span>,
<span class="linenr"> 7789: </span>  <span class=
"org-string">"Equal;"</span>: <span class="org-string">"⩵"</span>,
<span class="linenr"> 7790: </span>  <span class=
"org-string">"equiv;"</span>: <span class="org-string">"≡"</span>,
<span class="linenr"> 7791: </span>  <span class=
"org-string">"erarr;"</span>: <span class="org-string">"⥱"</span>,
<span class="linenr"> 7792: </span>  <span class=
"org-string">"erDot;"</span>: <span class="org-string">"≓"</span>,
<span class="linenr"> 7793: </span>  <span class=
"org-string">"esdot;"</span>: <span class="org-string">"≐"</span>,
<span class="linenr"> 7794: </span>  <span class=
"org-string">"exist;"</span>: <span class="org-string">"∃"</span>,
<span class="linenr"> 7795: </span>  <span class=
"org-string">"fflig;"</span>: <span class="org-string">"ﬀ"</span>,
<span class="linenr"> 7796: </span>  <span class=
"org-string">"filig;"</span>: <span class="org-string">"ﬁ"</span>,
<span class="linenr"> 7797: </span>  <span class=
"org-string">"fjlig;"</span>: <span class="org-string">"fj"</span>,
<span class="linenr"> 7798: </span>  <span class=
"org-string">"fllig;"</span>: <span class="org-string">"ﬂ"</span>,
<span class="linenr"> 7799: </span>  <span class=
"org-string">"fltns;"</span>: <span class="org-string">"▱"</span>,
<span class="linenr"> 7800: </span>  <span class=
"org-string">"forkv;"</span>: <span class="org-string">"⫙"</span>,
<span class="linenr"> 7801: </span>  <span class=
"org-string">"frac12"</span>: <span class="org-string">"½"</span>,
<span class="linenr"> 7802: </span>  <span class=
"org-string">"frac14"</span>: <span class="org-string">"¼"</span>,
<span class="linenr"> 7803: </span>  <span class=
"org-string">"frac34"</span>: <span class="org-string">"¾"</span>,
<span class="linenr"> 7804: </span>  <span class=
"org-string">"frasl;"</span>: <span class="org-string">"⁄"</span>,
<span class="linenr"> 7805: </span>  <span class=
"org-string">"frown;"</span>: <span class="org-string">"⌢"</span>,
<span class="linenr"> 7806: </span>  <span class=
"org-string">"Gamma;"</span>: <span class="org-string">"Γ"</span>,
<span class="linenr"> 7807: </span>  <span class=
"org-string">"gamma;"</span>: <span class="org-string">"γ"</span>,
<span class="linenr"> 7808: </span>  <span class=
"org-string">"Gcirc;"</span>: <span class="org-string">"Ĝ"</span>,
<span class="linenr"> 7809: </span>  <span class=
"org-string">"gcirc;"</span>: <span class="org-string">"ĝ"</span>,
<span class="linenr"> 7810: </span>  <span class=
"org-string">"gescc;"</span>: <span class="org-string">"⪩"</span>,
<span class="linenr"> 7811: </span>  <span class=
"org-string">"gimel;"</span>: <span class="org-string">"ℷ"</span>,
<span class="linenr"> 7812: </span>  <span class=
"org-string">"gneqq;"</span>: <span class="org-string">"≩"</span>,
<span class="linenr"> 7813: </span>  <span class=
"org-string">"gnsim;"</span>: <span class="org-string">"⋧"</span>,
<span class="linenr"> 7814: </span>  <span class=
"org-string">"grave;"</span>: <span class="org-string">"`"</span>,
<span class="linenr"> 7815: </span>  <span class=
"org-string">"gsime;"</span>: <span class="org-string">"⪎"</span>,
<span class="linenr"> 7816: </span>  <span class=
"org-string">"gsiml;"</span>: <span class="org-string">"⪐"</span>,
<span class="linenr"> 7817: </span>  <span class=
"org-string">"gtcir;"</span>: <span class="org-string">"⩺"</span>,
<span class="linenr"> 7818: </span>  <span class=
"org-string">"gtdot;"</span>: <span class="org-string">"⋗"</span>,
<span class="linenr"> 7819: </span>  <span class=
"org-string">"Hacek;"</span>: <span class="org-string">"ˇ"</span>,
<span class="linenr"> 7820: </span>  <span class=
"org-string">"harrw;"</span>: <span class="org-string">"↭"</span>,
<span class="linenr"> 7821: </span>  <span class=
"org-string">"Hcirc;"</span>: <span class="org-string">"Ĥ"</span>,
<span class="linenr"> 7822: </span>  <span class=
"org-string">"hcirc;"</span>: <span class="org-string">"ĥ"</span>,
<span class="linenr"> 7823: </span>  <span class=
"org-string">"hoarr;"</span>: <span class="org-string">"⇿"</span>,
<span class="linenr"> 7824: </span>  <span class=
"org-string">"Iacute"</span>: <span class="org-string">"Í"</span>,
<span class="linenr"> 7825: </span>  <span class=
"org-string">"iacute"</span>: <span class="org-string">"í"</span>,
<span class="linenr"> 7826: </span>  <span class=
"org-string">"Icirc;"</span>: <span class="org-string">"Î"</span>,
<span class="linenr"> 7827: </span>  <span class=
"org-string">"icirc;"</span>: <span class="org-string">"î"</span>,
<span class="linenr"> 7828: </span>  <span class=
"org-string">"iexcl;"</span>: <span class="org-string">"¡"</span>,
<span class="linenr"> 7829: </span>  <span class=
"org-string">"Igrave"</span>: <span class="org-string">"Ì"</span>,
<span class="linenr"> 7830: </span>  <span class=
"org-string">"igrave"</span>: <span class="org-string">"ì"</span>,
<span class="linenr"> 7831: </span>  <span class=
"org-string">"iiint;"</span>: <span class="org-string">"∭"</span>,
<span class="linenr"> 7832: </span>  <span class=
"org-string">"iiota;"</span>: <span class="org-string">"℩"</span>,
<span class="linenr"> 7833: </span>  <span class=
"org-string">"IJlig;"</span>: <span class="org-string">"Ĳ"</span>,
<span class="linenr"> 7834: </span>  <span class=
"org-string">"ijlig;"</span>: <span class="org-string">"ĳ"</span>,
<span class="linenr"> 7835: </span>  <span class=
"org-string">"Imacr;"</span>: <span class="org-string">"Ī"</span>,
<span class="linenr"> 7836: </span>  <span class=
"org-string">"imacr;"</span>: <span class="org-string">"ī"</span>,
<span class="linenr"> 7837: </span>  <span class=
"org-string">"image;"</span>: <span class="org-string">"ℑ"</span>,
<span class="linenr"> 7838: </span>  <span class=
"org-string">"imath;"</span>: <span class="org-string">"ı"</span>,
<span class="linenr"> 7839: </span>  <span class=
"org-string">"imped;"</span>: <span class="org-string">"Ƶ"</span>,
<span class="linenr"> 7840: </span>  <span class=
"org-string">"infin;"</span>: <span class="org-string">"∞"</span>,
<span class="linenr"> 7841: </span>  <span class=
"org-string">"Iogon;"</span>: <span class="org-string">"Į"</span>,
<span class="linenr"> 7842: </span>  <span class=
"org-string">"iogon;"</span>: <span class="org-string">"į"</span>,
<span class="linenr"> 7843: </span>  <span class=
"org-string">"iprod;"</span>: <span class="org-string">"⨼"</span>,
<span class="linenr"> 7844: </span>  <span class=
"org-string">"iquest"</span>: <span class="org-string">"¿"</span>,
<span class="linenr"> 7845: </span>  <span class=
"org-string">"isinE;"</span>: <span class="org-string">"⋹"</span>,
<span class="linenr"> 7846: </span>  <span class=
"org-string">"isins;"</span>: <span class="org-string">"⋴"</span>,
<span class="linenr"> 7847: </span>  <span class=
"org-string">"isinv;"</span>: <span class="org-string">"∈"</span>,
<span class="linenr"> 7848: </span>  <span class=
"org-string">"Iukcy;"</span>: <span class="org-string">"І"</span>,
<span class="linenr"> 7849: </span>  <span class=
"org-string">"iukcy;"</span>: <span class="org-string">"і"</span>,
<span class="linenr"> 7850: </span>  <span class=
"org-string">"Jcirc;"</span>: <span class="org-string">"Ĵ"</span>,
<span class="linenr"> 7851: </span>  <span class=
"org-string">"jcirc;"</span>: <span class="org-string">"ĵ"</span>,
<span class="linenr"> 7852: </span>  <span class=
"org-string">"jmath;"</span>: <span class="org-string">"ȷ"</span>,
<span class="linenr"> 7853: </span>  <span class=
"org-string">"Jukcy;"</span>: <span class="org-string">"Є"</span>,
<span class="linenr"> 7854: </span>  <span class=
"org-string">"jukcy;"</span>: <span class="org-string">"є"</span>,
<span class="linenr"> 7855: </span>  <span class=
"org-string">"Kappa;"</span>: <span class="org-string">"Κ"</span>,
<span class="linenr"> 7856: </span>  <span class=
"org-string">"kappa;"</span>: <span class="org-string">"κ"</span>,
<span class="linenr"> 7857: </span>  <span class=
"org-string">"lAarr;"</span>: <span class="org-string">"⇚"</span>,
<span class="linenr"> 7858: </span>  <span class=
"org-string">"langd;"</span>: <span class="org-string">"⦑"</span>,
<span class="linenr"> 7859: </span>  <span class=
"org-string">"laquo;"</span>: <span class="org-string">"«"</span>,
<span class="linenr"> 7860: </span>  <span class=
"org-string">"larrb;"</span>: <span class="org-string">"⇤"</span>,
<span class="linenr"> 7861: </span>  <span class=
"org-string">"lates;"</span>: <span class="org-string">"⪭︀"</span>,
<span class="linenr"> 7862: </span>  <span class=
"org-string">"lBarr;"</span>: <span class="org-string">"⤎"</span>,
<span class="linenr"> 7863: </span>  <span class=
"org-string">"lbarr;"</span>: <span class="org-string">"⤌"</span>,
<span class="linenr"> 7864: </span>  <span class=
"org-string">"lbbrk;"</span>: <span class="org-string">"❲"</span>,
<span class="linenr"> 7865: </span>  <span class=
"org-string">"lbrke;"</span>: <span class="org-string">"⦋"</span>,
<span class="linenr"> 7866: </span>  <span class=
"org-string">"lceil;"</span>: <span class="org-string">"⌈"</span>,
<span class="linenr"> 7867: </span>  <span class=
"org-string">"ldquo;"</span>: <span class="org-string">"“"</span>,
<span class="linenr"> 7868: </span>  <span class=
"org-string">"lescc;"</span>: <span class="org-string">"⪨"</span>,
<span class="linenr"> 7869: </span>  <span class=
"org-string">"lhard;"</span>: <span class="org-string">"↽"</span>,
<span class="linenr"> 7870: </span>  <span class=
"org-string">"lharu;"</span>: <span class="org-string">"↼"</span>,
<span class="linenr"> 7871: </span>  <span class=
"org-string">"lhblk;"</span>: <span class="org-string">"▄"</span>,
<span class="linenr"> 7872: </span>  <span class=
"org-string">"llarr;"</span>: <span class="org-string">"⇇"</span>,
<span class="linenr"> 7873: </span>  <span class=
"org-string">"lltri;"</span>: <span class="org-string">"◺"</span>,
<span class="linenr"> 7874: </span>  <span class=
"org-string">"lneqq;"</span>: <span class="org-string">"≨"</span>,
<span class="linenr"> 7875: </span>  <span class=
"org-string">"lnsim;"</span>: <span class="org-string">"⋦"</span>,
<span class="linenr"> 7876: </span>  <span class=
"org-string">"loang;"</span>: <span class="org-string">"⟬"</span>,
<span class="linenr"> 7877: </span>  <span class=
"org-string">"loarr;"</span>: <span class="org-string">"⇽"</span>,
<span class="linenr"> 7878: </span>  <span class=
"org-string">"lobrk;"</span>: <span class="org-string">"⟦"</span>,
<span class="linenr"> 7879: </span>  <span class=
"org-string">"lopar;"</span>: <span class="org-string">"⦅"</span>,
<span class="linenr"> 7880: </span>  <span class=
"org-string">"lrarr;"</span>: <span class="org-string">"⇆"</span>,
<span class="linenr"> 7881: </span>  <span class=
"org-string">"lrhar;"</span>: <span class="org-string">"⇋"</span>,
<span class="linenr"> 7882: </span>  <span class=
"org-string">"lrtri;"</span>: <span class="org-string">"⊿"</span>,
<span class="linenr"> 7883: </span>  <span class=
"org-string">"lsime;"</span>: <span class="org-string">"⪍"</span>,
<span class="linenr"> 7884: </span>  <span class=
"org-string">"lsimg;"</span>: <span class="org-string">"⪏"</span>,
<span class="linenr"> 7885: </span>  <span class=
"org-string">"lsquo;"</span>: <span class="org-string">"‘"</span>,
<span class="linenr"> 7886: </span>  <span class=
"org-string">"ltcir;"</span>: <span class="org-string">"⩹"</span>,
<span class="linenr"> 7887: </span>  <span class=
"org-string">"ltdot;"</span>: <span class="org-string">"⋖"</span>,
<span class="linenr"> 7888: </span>  <span class=
"org-string">"ltrie;"</span>: <span class="org-string">"⊴"</span>,
<span class="linenr"> 7889: </span>  <span class=
"org-string">"ltrif;"</span>: <span class="org-string">"◂"</span>,
<span class="linenr"> 7890: </span>  <span class=
"org-string">"mdash;"</span>: <span class="org-string">"—"</span>,
<span class="linenr"> 7891: </span>  <span class=
"org-string">"mDDot;"</span>: <span class="org-string">"∺"</span>,
<span class="linenr"> 7892: </span>  <span class=
"org-string">"micro;"</span>: <span class="org-string">"µ"</span>,
<span class="linenr"> 7893: </span>  <span class=
"org-string">"middot"</span>: <span class="org-string">"·"</span>,
<span class="linenr"> 7894: </span>  <span class=
"org-string">"minus;"</span>: <span class="org-string">"−"</span>,
<span class="linenr"> 7895: </span>  <span class=
"org-string">"mumap;"</span>: <span class="org-string">"⊸"</span>,
<span class="linenr"> 7896: </span>  <span class=
"org-string">"nabla;"</span>: <span class="org-string">"∇"</span>,
<span class="linenr"> 7897: </span>  <span class=
"org-string">"napid;"</span>: <span class="org-string">"≋̸"</span>,
<span class="linenr"> 7898: </span>  <span class=
"org-string">"napos;"</span>: <span class="org-string">"ŉ"</span>,
<span class="linenr"> 7899: </span>  <span class=
"org-string">"natur;"</span>: <span class="org-string">"♮"</span>,
<span class="linenr"> 7900: </span>  <span class=
"org-string">"nbump;"</span>: <span class="org-string">"≎̸"</span>,
<span class="linenr"> 7901: </span>  <span class=
"org-string">"ncong;"</span>: <span class="org-string">"≇"</span>,
<span class="linenr"> 7902: </span>  <span class=
"org-string">"ndash;"</span>: <span class="org-string">"–"</span>,
<span class="linenr"> 7903: </span>  <span class=
"org-string">"neArr;"</span>: <span class="org-string">"⇗"</span>,
<span class="linenr"> 7904: </span>  <span class=
"org-string">"nearr;"</span>: <span class="org-string">"↗"</span>,
<span class="linenr"> 7905: </span>  <span class=
"org-string">"nedot;"</span>: <span class="org-string">"≐̸"</span>,
<span class="linenr"> 7906: </span>  <span class=
"org-string">"nesim;"</span>: <span class="org-string">"≂̸"</span>,
<span class="linenr"> 7907: </span>  <span class=
"org-string">"ngeqq;"</span>: <span class="org-string">"≧̸"</span>,
<span class="linenr"> 7908: </span>  <span class=
"org-string">"ngsim;"</span>: <span class="org-string">"≵"</span>,
<span class="linenr"> 7909: </span>  <span class=
"org-string">"nhArr;"</span>: <span class="org-string">"⇎"</span>,
<span class="linenr"> 7910: </span>  <span class=
"org-string">"nharr;"</span>: <span class="org-string">"↮"</span>,
<span class="linenr"> 7911: </span>  <span class=
"org-string">"nhpar;"</span>: <span class="org-string">"⫲"</span>,
<span class="linenr"> 7912: </span>  <span class=
"org-string">"nlArr;"</span>: <span class="org-string">"⇍"</span>,
<span class="linenr"> 7913: </span>  <span class=
"org-string">"nlarr;"</span>: <span class="org-string">"↚"</span>,
<span class="linenr"> 7914: </span>  <span class=
"org-string">"nleqq;"</span>: <span class="org-string">"≦̸"</span>,
<span class="linenr"> 7915: </span>  <span class=
"org-string">"nless;"</span>: <span class="org-string">"≮"</span>,
<span class="linenr"> 7916: </span>  <span class=
"org-string">"nlsim;"</span>: <span class="org-string">"≴"</span>,
<span class="linenr"> 7917: </span>  <span class=
"org-string">"nltri;"</span>: <span class="org-string">"⋪"</span>,
<span class="linenr"> 7918: </span>  <span class=
"org-string">"notin;"</span>: <span class="org-string">"∉"</span>,
<span class="linenr"> 7919: </span>  <span class=
"org-string">"notni;"</span>: <span class="org-string">"∌"</span>,
<span class="linenr"> 7920: </span>  <span class=
"org-string">"npart;"</span>: <span class="org-string">"∂̸"</span>,
<span class="linenr"> 7921: </span>  <span class=
"org-string">"nprec;"</span>: <span class="org-string">"⊀"</span>,
<span class="linenr"> 7922: </span>  <span class=
"org-string">"nrArr;"</span>: <span class="org-string">"⇏"</span>,
<span class="linenr"> 7923: </span>  <span class=
"org-string">"nrarr;"</span>: <span class="org-string">"↛"</span>,
<span class="linenr"> 7924: </span>  <span class=
"org-string">"nrtri;"</span>: <span class="org-string">"⋫"</span>,
<span class="linenr"> 7925: </span>  <span class=
"org-string">"nsime;"</span>: <span class="org-string">"≄"</span>,
<span class="linenr"> 7926: </span>  <span class=
"org-string">"nsmid;"</span>: <span class="org-string">"∤"</span>,
<span class="linenr"> 7927: </span>  <span class=
"org-string">"nspar;"</span>: <span class="org-string">"∦"</span>,
<span class="linenr"> 7928: </span>  <span class=
"org-string">"nsubE;"</span>: <span class="org-string">"⫅̸"</span>,
<span class="linenr"> 7929: </span>  <span class=
"org-string">"nsube;"</span>: <span class="org-string">"⊈"</span>,
<span class="linenr"> 7930: </span>  <span class=
"org-string">"nsucc;"</span>: <span class="org-string">"⊁"</span>,
<span class="linenr"> 7931: </span>  <span class=
"org-string">"nsupE;"</span>: <span class="org-string">"⫆̸"</span>,
<span class="linenr"> 7932: </span>  <span class=
"org-string">"nsupe;"</span>: <span class="org-string">"⊉"</span>,
<span class="linenr"> 7933: </span>  <span class=
"org-string">"Ntilde"</span>: <span class="org-string">"Ñ"</span>,
<span class="linenr"> 7934: </span>  <span class=
"org-string">"ntilde"</span>: <span class="org-string">"ñ"</span>,
<span class="linenr"> 7935: </span>  <span class=
"org-string">"numsp;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 7936: </span>  <span class=
"org-string">"nvsim;"</span>: <span class="org-string">"∼⃒"</span>,
<span class="linenr"> 7937: </span>  <span class=
"org-string">"nwArr;"</span>: <span class="org-string">"⇖"</span>,
<span class="linenr"> 7938: </span>  <span class=
"org-string">"nwarr;"</span>: <span class="org-string">"↖"</span>,
<span class="linenr"> 7939: </span>  <span class=
"org-string">"Oacute"</span>: <span class="org-string">"Ó"</span>,
<span class="linenr"> 7940: </span>  <span class=
"org-string">"oacute"</span>: <span class="org-string">"ó"</span>,
<span class="linenr"> 7941: </span>  <span class=
"org-string">"Ocirc;"</span>: <span class="org-string">"Ô"</span>,
<span class="linenr"> 7942: </span>  <span class=
"org-string">"ocirc;"</span>: <span class="org-string">"ô"</span>,
<span class="linenr"> 7943: </span>  <span class=
"org-string">"odash;"</span>: <span class="org-string">"⊝"</span>,
<span class="linenr"> 7944: </span>  <span class=
"org-string">"OElig;"</span>: <span class="org-string">"Œ"</span>,
<span class="linenr"> 7945: </span>  <span class=
"org-string">"oelig;"</span>: <span class="org-string">"œ"</span>,
<span class="linenr"> 7946: </span>  <span class=
"org-string">"ofcir;"</span>: <span class="org-string">"⦿"</span>,
<span class="linenr"> 7947: </span>  <span class=
"org-string">"Ograve"</span>: <span class="org-string">"Ò"</span>,
<span class="linenr"> 7948: </span>  <span class=
"org-string">"ograve"</span>: <span class="org-string">"ò"</span>,
<span class="linenr"> 7949: </span>  <span class=
"org-string">"ohbar;"</span>: <span class="org-string">"⦵"</span>,
<span class="linenr"> 7950: </span>  <span class=
"org-string">"olarr;"</span>: <span class="org-string">"↺"</span>,
<span class="linenr"> 7951: </span>  <span class=
"org-string">"olcir;"</span>: <span class="org-string">"⦾"</span>,
<span class="linenr"> 7952: </span>  <span class=
"org-string">"oline;"</span>: <span class="org-string">"‾"</span>,
<span class="linenr"> 7953: </span>  <span class=
"org-string">"Omacr;"</span>: <span class="org-string">"Ō"</span>,
<span class="linenr"> 7954: </span>  <span class=
"org-string">"omacr;"</span>: <span class="org-string">"ō"</span>,
<span class="linenr"> 7955: </span>  <span class=
"org-string">"Omega;"</span>: <span class="org-string">"Ω"</span>,
<span class="linenr"> 7956: </span>  <span class=
"org-string">"omega;"</span>: <span class="org-string">"ω"</span>,
<span class="linenr"> 7957: </span>  <span class=
"org-string">"operp;"</span>: <span class="org-string">"⦹"</span>,
<span class="linenr"> 7958: </span>  <span class=
"org-string">"oplus;"</span>: <span class="org-string">"⊕"</span>,
<span class="linenr"> 7959: </span>  <span class=
"org-string">"orarr;"</span>: <span class="org-string">"↻"</span>,
<span class="linenr"> 7960: </span>  <span class=
"org-string">"order;"</span>: <span class="org-string">"ℴ"</span>,
<span class="linenr"> 7961: </span>  <span class=
"org-string">"Oslash"</span>: <span class="org-string">"Ø"</span>,
<span class="linenr"> 7962: </span>  <span class=
"org-string">"oslash"</span>: <span class="org-string">"ø"</span>,
<span class="linenr"> 7963: </span>  <span class=
"org-string">"Otilde"</span>: <span class="org-string">"Õ"</span>,
<span class="linenr"> 7964: </span>  <span class=
"org-string">"otilde"</span>: <span class="org-string">"õ"</span>,
<span class="linenr"> 7965: </span>  <span class=
"org-string">"ovbar;"</span>: <span class="org-string">"⌽"</span>,
<span class="linenr"> 7966: </span>  <span class=
"org-string">"parsl;"</span>: <span class="org-string">"⫽"</span>,
<span class="linenr"> 7967: </span>  <span class=
"org-string">"phone;"</span>: <span class="org-string">"☎"</span>,
<span class="linenr"> 7968: </span>  <span class=
"org-string">"plusb;"</span>: <span class="org-string">"⊞"</span>,
<span class="linenr"> 7969: </span>  <span class=
"org-string">"pluse;"</span>: <span class="org-string">"⩲"</span>,
<span class="linenr"> 7970: </span>  <span class=
"org-string">"plusmn"</span>: <span class="org-string">"±"</span>,
<span class="linenr"> 7971: </span>  <span class=
"org-string">"pound;"</span>: <span class="org-string">"£"</span>,
<span class="linenr"> 7972: </span>  <span class=
"org-string">"prcue;"</span>: <span class="org-string">"≼"</span>,
<span class="linenr"> 7973: </span>  <span class=
"org-string">"Prime;"</span>: <span class="org-string">"″"</span>,
<span class="linenr"> 7974: </span>  <span class=
"org-string">"prime;"</span>: <span class="org-string">"′"</span>,
<span class="linenr"> 7975: </span>  <span class=
"org-string">"prnap;"</span>: <span class="org-string">"⪹"</span>,
<span class="linenr"> 7976: </span>  <span class=
"org-string">"prsim;"</span>: <span class="org-string">"≾"</span>,
<span class="linenr"> 7977: </span>  <span class=
"org-string">"quest;"</span>: <span class="org-string">"?"</span>,
<span class="linenr"> 7978: </span>  <span class=
"org-string">"rAarr;"</span>: <span class="org-string">"⇛"</span>,
<span class="linenr"> 7979: </span>  <span class=
"org-string">"radic;"</span>: <span class="org-string">"√"</span>,
<span class="linenr"> 7980: </span>  <span class=
"org-string">"rangd;"</span>: <span class="org-string">"⦒"</span>,
<span class="linenr"> 7981: </span>  <span class=
"org-string">"range;"</span>: <span class="org-string">"⦥"</span>,
<span class="linenr"> 7982: </span>  <span class=
"org-string">"raquo;"</span>: <span class="org-string">"»"</span>,
<span class="linenr"> 7983: </span>  <span class=
"org-string">"rarrb;"</span>: <span class="org-string">"⇥"</span>,
<span class="linenr"> 7984: </span>  <span class=
"org-string">"rarrc;"</span>: <span class="org-string">"⤳"</span>,
<span class="linenr"> 7985: </span>  <span class=
"org-string">"rarrw;"</span>: <span class="org-string">"↝"</span>,
<span class="linenr"> 7986: </span>  <span class=
"org-string">"ratio;"</span>: <span class="org-string">"∶"</span>,
<span class="linenr"> 7987: </span>  <span class=
"org-string">"RBarr;"</span>: <span class="org-string">"⤐"</span>,
<span class="linenr"> 7988: </span>  <span class=
"org-string">"rBarr;"</span>: <span class="org-string">"⤏"</span>,
<span class="linenr"> 7989: </span>  <span class=
"org-string">"rbarr;"</span>: <span class="org-string">"⤍"</span>,
<span class="linenr"> 7990: </span>  <span class=
"org-string">"rbbrk;"</span>: <span class="org-string">"❳"</span>,
<span class="linenr"> 7991: </span>  <span class=
"org-string">"rbrke;"</span>: <span class="org-string">"⦌"</span>,
<span class="linenr"> 7992: </span>  <span class=
"org-string">"rceil;"</span>: <span class="org-string">"⌉"</span>,
<span class="linenr"> 7993: </span>  <span class=
"org-string">"rdquo;"</span>: <span class="org-string">"”"</span>,
<span class="linenr"> 7994: </span>  <span class=
"org-string">"reals;"</span>: <span class="org-string">"ℝ"</span>,
<span class="linenr"> 7995: </span>  <span class=
"org-string">"rhard;"</span>: <span class="org-string">"⇁"</span>,
<span class="linenr"> 7996: </span>  <span class=
"org-string">"rharu;"</span>: <span class="org-string">"⇀"</span>,
<span class="linenr"> 7997: </span>  <span class=
"org-string">"rlarr;"</span>: <span class="org-string">"⇄"</span>,
<span class="linenr"> 7998: </span>  <span class=
"org-string">"rlhar;"</span>: <span class="org-string">"⇌"</span>,
<span class="linenr"> 7999: </span>  <span class=
"org-string">"rnmid;"</span>: <span class="org-string">"⫮"</span>,
<span class="linenr"> 8000: </span>  <span class=
"org-string">"roang;"</span>: <span class="org-string">"⟭"</span>,
<span class="linenr"> 8001: </span>  <span class=
"org-string">"roarr;"</span>: <span class="org-string">"⇾"</span>,
<span class="linenr"> 8002: </span>  <span class=
"org-string">"robrk;"</span>: <span class="org-string">"⟧"</span>,
<span class="linenr"> 8003: </span>  <span class=
"org-string">"ropar;"</span>: <span class="org-string">"⦆"</span>,
<span class="linenr"> 8004: </span>  <span class=
"org-string">"rrarr;"</span>: <span class="org-string">"⇉"</span>,
<span class="linenr"> 8005: </span>  <span class=
"org-string">"rsquo;"</span>: <span class="org-string">"’"</span>,
<span class="linenr"> 8006: </span>  <span class=
"org-string">"rtrie;"</span>: <span class="org-string">"⊵"</span>,
<span class="linenr"> 8007: </span>  <span class=
"org-string">"rtrif;"</span>: <span class="org-string">"▸"</span>,
<span class="linenr"> 8008: </span>  <span class=
"org-string">"sbquo;"</span>: <span class="org-string">"‚"</span>,
<span class="linenr"> 8009: </span>  <span class=
"org-string">"sccue;"</span>: <span class="org-string">"≽"</span>,
<span class="linenr"> 8010: </span>  <span class=
"org-string">"Scirc;"</span>: <span class="org-string">"Ŝ"</span>,
<span class="linenr"> 8011: </span>  <span class=
"org-string">"scirc;"</span>: <span class="org-string">"ŝ"</span>,
<span class="linenr"> 8012: </span>  <span class=
"org-string">"scnap;"</span>: <span class="org-string">"⪺"</span>,
<span class="linenr"> 8013: </span>  <span class=
"org-string">"scsim;"</span>: <span class="org-string">"≿"</span>,
<span class="linenr"> 8014: </span>  <span class=
"org-string">"sdotb;"</span>: <span class="org-string">"⊡"</span>,
<span class="linenr"> 8015: </span>  <span class=
"org-string">"sdote;"</span>: <span class="org-string">"⩦"</span>,
<span class="linenr"> 8016: </span>  <span class=
"org-string">"seArr;"</span>: <span class="org-string">"⇘"</span>,
<span class="linenr"> 8017: </span>  <span class=
"org-string">"searr;"</span>: <span class="org-string">"↘"</span>,
<span class="linenr"> 8018: </span>  <span class=
"org-string">"setmn;"</span>: <span class="org-string">"∖"</span>,
<span class="linenr"> 8019: </span>  <span class=
"org-string">"sharp;"</span>: <span class="org-string">"♯"</span>,
<span class="linenr"> 8020: </span>  <span class=
"org-string">"Sigma;"</span>: <span class="org-string">"Σ"</span>,
<span class="linenr"> 8021: </span>  <span class=
"org-string">"sigma;"</span>: <span class="org-string">"σ"</span>,
<span class="linenr"> 8022: </span>  <span class=
"org-string">"simeq;"</span>: <span class="org-string">"≃"</span>,
<span class="linenr"> 8023: </span>  <span class=
"org-string">"simgE;"</span>: <span class="org-string">"⪠"</span>,
<span class="linenr"> 8024: </span>  <span class=
"org-string">"simlE;"</span>: <span class="org-string">"⪟"</span>,
<span class="linenr"> 8025: </span>  <span class=
"org-string">"simne;"</span>: <span class="org-string">"≆"</span>,
<span class="linenr"> 8026: </span>  <span class=
"org-string">"slarr;"</span>: <span class="org-string">"←"</span>,
<span class="linenr"> 8027: </span>  <span class=
"org-string">"smile;"</span>: <span class="org-string">"⌣"</span>,
<span class="linenr"> 8028: </span>  <span class=
"org-string">"smtes;"</span>: <span class="org-string">"⪬︀"</span>,
<span class="linenr"> 8029: </span>  <span class=
"org-string">"sqcap;"</span>: <span class="org-string">"⊓"</span>,
<span class="linenr"> 8030: </span>  <span class=
"org-string">"sqcup;"</span>: <span class="org-string">"⊔"</span>,
<span class="linenr"> 8031: </span>  <span class=
"org-string">"sqsub;"</span>: <span class="org-string">"⊏"</span>,
<span class="linenr"> 8032: </span>  <span class=
"org-string">"sqsup;"</span>: <span class="org-string">"⊐"</span>,
<span class="linenr"> 8033: </span>  <span class=
"org-string">"srarr;"</span>: <span class="org-string">"→"</span>,
<span class="linenr"> 8034: </span>  <span class=
"org-string">"starf;"</span>: <span class="org-string">"★"</span>,
<span class="linenr"> 8035: </span>  <span class=
"org-string">"strns;"</span>: <span class="org-string">"¯"</span>,
<span class="linenr"> 8036: </span>  <span class=
"org-string">"subnE;"</span>: <span class="org-string">"⫋"</span>,
<span class="linenr"> 8037: </span>  <span class=
"org-string">"subne;"</span>: <span class="org-string">"⊊"</span>,
<span class="linenr"> 8038: </span>  <span class=
"org-string">"supnE;"</span>: <span class="org-string">"⫌"</span>,
<span class="linenr"> 8039: </span>  <span class=
"org-string">"supne;"</span>: <span class="org-string">"⊋"</span>,
<span class="linenr"> 8040: </span>  <span class=
"org-string">"swArr;"</span>: <span class="org-string">"⇙"</span>,
<span class="linenr"> 8041: </span>  <span class=
"org-string">"swarr;"</span>: <span class="org-string">"↙"</span>,
<span class="linenr"> 8042: </span>  <span class=
"org-string">"szlig;"</span>: <span class="org-string">"ß"</span>,
<span class="linenr"> 8043: </span>  <span class=
"org-string">"Theta;"</span>: <span class="org-string">"Θ"</span>,
<span class="linenr"> 8044: </span>  <span class=
"org-string">"theta;"</span>: <span class="org-string">"θ"</span>,
<span class="linenr"> 8045: </span>  <span class=
"org-string">"thkap;"</span>: <span class="org-string">"≈"</span>,
<span class="linenr"> 8046: </span>  <span class=
"org-string">"THORN;"</span>: <span class="org-string">"Þ"</span>,
<span class="linenr"> 8047: </span>  <span class=
"org-string">"thorn;"</span>: <span class="org-string">"þ"</span>,
<span class="linenr"> 8048: </span>  <span class=
"org-string">"Tilde;"</span>: <span class="org-string">"∼"</span>,
<span class="linenr"> 8049: </span>  <span class=
"org-string">"tilde;"</span>: <span class="org-string">"˜"</span>,
<span class="linenr"> 8050: </span>  <span class=
"org-string">"times;"</span>: <span class="org-string">"×"</span>,
<span class="linenr"> 8051: </span>  <span class=
"org-string">"TRADE;"</span>: <span class="org-string">"™"</span>,
<span class="linenr"> 8052: </span>  <span class=
"org-string">"trade;"</span>: <span class="org-string">"™"</span>,
<span class="linenr"> 8053: </span>  <span class=
"org-string">"trisb;"</span>: <span class="org-string">"⧍"</span>,
<span class="linenr"> 8054: </span>  <span class=
"org-string">"TSHcy;"</span>: <span class="org-string">"Ћ"</span>,
<span class="linenr"> 8055: </span>  <span class=
"org-string">"tshcy;"</span>: <span class="org-string">"ћ"</span>,
<span class="linenr"> 8056: </span>  <span class=
"org-string">"twixt;"</span>: <span class="org-string">"≬"</span>,
<span class="linenr"> 8057: </span>  <span class=
"org-string">"Uacute"</span>: <span class="org-string">"Ú"</span>,
<span class="linenr"> 8058: </span>  <span class=
"org-string">"uacute"</span>: <span class="org-string">"ú"</span>,
<span class="linenr"> 8059: </span>  <span class=
"org-string">"Ubrcy;"</span>: <span class="org-string">"Ў"</span>,
<span class="linenr"> 8060: </span>  <span class=
"org-string">"ubrcy;"</span>: <span class="org-string">"ў"</span>,
<span class="linenr"> 8061: </span>  <span class=
"org-string">"Ucirc;"</span>: <span class="org-string">"Û"</span>,
<span class="linenr"> 8062: </span>  <span class=
"org-string">"ucirc;"</span>: <span class="org-string">"û"</span>,
<span class="linenr"> 8063: </span>  <span class=
"org-string">"udarr;"</span>: <span class="org-string">"⇅"</span>,
<span class="linenr"> 8064: </span>  <span class=
"org-string">"udhar;"</span>: <span class="org-string">"⥮"</span>,
<span class="linenr"> 8065: </span>  <span class=
"org-string">"Ugrave"</span>: <span class="org-string">"Ù"</span>,
<span class="linenr"> 8066: </span>  <span class=
"org-string">"ugrave"</span>: <span class="org-string">"ù"</span>,
<span class="linenr"> 8067: </span>  <span class=
"org-string">"uharl;"</span>: <span class="org-string">"↿"</span>,
<span class="linenr"> 8068: </span>  <span class=
"org-string">"uharr;"</span>: <span class="org-string">"↾"</span>,
<span class="linenr"> 8069: </span>  <span class=
"org-string">"uhblk;"</span>: <span class="org-string">"▀"</span>,
<span class="linenr"> 8070: </span>  <span class=
"org-string">"ultri;"</span>: <span class="org-string">"◸"</span>,
<span class="linenr"> 8071: </span>  <span class=
"org-string">"Umacr;"</span>: <span class="org-string">"Ū"</span>,
<span class="linenr"> 8072: </span>  <span class=
"org-string">"umacr;"</span>: <span class="org-string">"ū"</span>,
<span class="linenr"> 8073: </span>  <span class=
"org-string">"Union;"</span>: <span class="org-string">"⋃"</span>,
<span class="linenr"> 8074: </span>  <span class=
"org-string">"Uogon;"</span>: <span class="org-string">"Ų"</span>,
<span class="linenr"> 8075: </span>  <span class=
"org-string">"uogon;"</span>: <span class="org-string">"ų"</span>,
<span class="linenr"> 8076: </span>  <span class=
"org-string">"uplus;"</span>: <span class="org-string">"⊎"</span>,
<span class="linenr"> 8077: </span>  <span class=
"org-string">"upsih;"</span>: <span class="org-string">"ϒ"</span>,
<span class="linenr"> 8078: </span>  <span class=
"org-string">"UpTee;"</span>: <span class="org-string">"⊥"</span>,
<span class="linenr"> 8079: </span>  <span class=
"org-string">"Uring;"</span>: <span class="org-string">"Ů"</span>,
<span class="linenr"> 8080: </span>  <span class=
"org-string">"uring;"</span>: <span class="org-string">"ů"</span>,
<span class="linenr"> 8081: </span>  <span class=
"org-string">"urtri;"</span>: <span class="org-string">"◹"</span>,
<span class="linenr"> 8082: </span>  <span class=
"org-string">"utdot;"</span>: <span class="org-string">"⋰"</span>,
<span class="linenr"> 8083: </span>  <span class=
"org-string">"utrif;"</span>: <span class="org-string">"▴"</span>,
<span class="linenr"> 8084: </span>  <span class=
"org-string">"uuarr;"</span>: <span class="org-string">"⇈"</span>,
<span class="linenr"> 8085: </span>  <span class=
"org-string">"varpi;"</span>: <span class="org-string">"ϖ"</span>,
<span class="linenr"> 8086: </span>  <span class=
"org-string">"vBarv;"</span>: <span class="org-string">"⫩"</span>,
<span class="linenr"> 8087: </span>  <span class=
"org-string">"VDash;"</span>: <span class="org-string">"⊫"</span>,
<span class="linenr"> 8088: </span>  <span class=
"org-string">"Vdash;"</span>: <span class="org-string">"⊩"</span>,
<span class="linenr"> 8089: </span>  <span class=
"org-string">"vDash;"</span>: <span class="org-string">"⊨"</span>,
<span class="linenr"> 8090: </span>  <span class=
"org-string">"vdash;"</span>: <span class="org-string">"⊢"</span>,
<span class="linenr"> 8091: </span>  <span class=
"org-string">"veeeq;"</span>: <span class="org-string">"≚"</span>,
<span class="linenr"> 8092: </span>  <span class=
"org-string">"vltri;"</span>: <span class="org-string">"⊲"</span>,
<span class="linenr"> 8093: </span>  <span class=
"org-string">"vnsub;"</span>: <span class="org-string">"⊂⃒"</span>,
<span class="linenr"> 8094: </span>  <span class=
"org-string">"vnsup;"</span>: <span class="org-string">"⊃⃒"</span>,
<span class="linenr"> 8095: </span>  <span class=
"org-string">"vprop;"</span>: <span class="org-string">"∝"</span>,
<span class="linenr"> 8096: </span>  <span class=
"org-string">"vrtri;"</span>: <span class="org-string">"⊳"</span>,
<span class="linenr"> 8097: </span>  <span class=
"org-string">"Wcirc;"</span>: <span class="org-string">"Ŵ"</span>,
<span class="linenr"> 8098: </span>  <span class=
"org-string">"wcirc;"</span>: <span class="org-string">"ŵ"</span>,
<span class="linenr"> 8099: </span>  <span class=
"org-string">"Wedge;"</span>: <span class="org-string">"⋀"</span>,
<span class="linenr"> 8100: </span>  <span class=
"org-string">"wedge;"</span>: <span class="org-string">"∧"</span>,
<span class="linenr"> 8101: </span>  <span class=
"org-string">"xcirc;"</span>: <span class="org-string">"◯"</span>,
<span class="linenr"> 8102: </span>  <span class=
"org-string">"xdtri;"</span>: <span class="org-string">"▽"</span>,
<span class="linenr"> 8103: </span>  <span class=
"org-string">"xhArr;"</span>: <span class="org-string">"⟺"</span>,
<span class="linenr"> 8104: </span>  <span class=
"org-string">"xharr;"</span>: <span class="org-string">"⟷"</span>,
<span class="linenr"> 8105: </span>  <span class=
"org-string">"xlArr;"</span>: <span class="org-string">"⟸"</span>,
<span class="linenr"> 8106: </span>  <span class=
"org-string">"xlarr;"</span>: <span class="org-string">"⟵"</span>,
<span class="linenr"> 8107: </span>  <span class=
"org-string">"xodot;"</span>: <span class="org-string">"⨀"</span>,
<span class="linenr"> 8108: </span>  <span class=
"org-string">"xrArr;"</span>: <span class="org-string">"⟹"</span>,
<span class="linenr"> 8109: </span>  <span class=
"org-string">"xrarr;"</span>: <span class="org-string">"⟶"</span>,
<span class="linenr"> 8110: </span>  <span class=
"org-string">"xutri;"</span>: <span class="org-string">"△"</span>,
<span class="linenr"> 8111: </span>  <span class=
"org-string">"Yacute"</span>: <span class="org-string">"Ý"</span>,
<span class="linenr"> 8112: </span>  <span class=
"org-string">"yacute"</span>: <span class="org-string">"ý"</span>,
<span class="linenr"> 8113: </span>  <span class=
"org-string">"Ycirc;"</span>: <span class="org-string">"Ŷ"</span>,
<span class="linenr"> 8114: </span>  <span class=
"org-string">"ycirc;"</span>: <span class="org-string">"ŷ"</span>,
<span class="linenr"> 8115: </span>  <span class=
"org-string">"Aacute;"</span>: <span class="org-string">"Á"</span>,
<span class="linenr"> 8116: </span>  <span class=
"org-string">"aacute;"</span>: <span class="org-string">"á"</span>,
<span class="linenr"> 8117: </span>  <span class=
"org-string">"Abreve;"</span>: <span class="org-string">"Ă"</span>,
<span class="linenr"> 8118: </span>  <span class=
"org-string">"abreve;"</span>: <span class="org-string">"ă"</span>,
<span class="linenr"> 8119: </span>  <span class=
"org-string">"Agrave;"</span>: <span class="org-string">"À"</span>,
<span class="linenr"> 8120: </span>  <span class=
"org-string">"agrave;"</span>: <span class="org-string">"à"</span>,
<span class="linenr"> 8121: </span>  <span class=
"org-string">"andand;"</span>: <span class="org-string">"⩕"</span>,
<span class="linenr"> 8122: </span>  <span class=
"org-string">"angmsd;"</span>: <span class="org-string">"∡"</span>,
<span class="linenr"> 8123: </span>  <span class=
"org-string">"angsph;"</span>: <span class="org-string">"∢"</span>,
<span class="linenr"> 8124: </span>  <span class=
"org-string">"apacir;"</span>: <span class="org-string">"⩯"</span>,
<span class="linenr"> 8125: </span>  <span class=
"org-string">"approx;"</span>: <span class="org-string">"≈"</span>,
<span class="linenr"> 8126: </span>  <span class=
"org-string">"Assign;"</span>: <span class="org-string">"≔"</span>,
<span class="linenr"> 8127: </span>  <span class=
"org-string">"Atilde;"</span>: <span class="org-string">"Ã"</span>,
<span class="linenr"> 8128: </span>  <span class=
"org-string">"atilde;"</span>: <span class="org-string">"ã"</span>,
<span class="linenr"> 8129: </span>  <span class=
"org-string">"barvee;"</span>: <span class="org-string">"⊽"</span>,
<span class="linenr"> 8130: </span>  <span class=
"org-string">"Barwed;"</span>: <span class="org-string">"⌆"</span>,
<span class="linenr"> 8131: </span>  <span class=
"org-string">"barwed;"</span>: <span class="org-string">"⌅"</span>,
<span class="linenr"> 8132: </span>  <span class=
"org-string">"becaus;"</span>: <span class="org-string">"∵"</span>,
<span class="linenr"> 8133: </span>  <span class=
"org-string">"bernou;"</span>: <span class="org-string">"ℬ"</span>,
<span class="linenr"> 8134: </span>  <span class=
"org-string">"bigcap;"</span>: <span class="org-string">"⋂"</span>,
<span class="linenr"> 8135: </span>  <span class=
"org-string">"bigcup;"</span>: <span class="org-string">"⋃"</span>,
<span class="linenr"> 8136: </span>  <span class=
"org-string">"bigvee;"</span>: <span class="org-string">"⋁"</span>,
<span class="linenr"> 8137: </span>  <span class=
"org-string">"bkarow;"</span>: <span class="org-string">"⤍"</span>,
<span class="linenr"> 8138: </span>  <span class=
"org-string">"bottom;"</span>: <span class="org-string">"⊥"</span>,
<span class="linenr"> 8139: </span>  <span class=
"org-string">"bowtie;"</span>: <span class="org-string">"⋈"</span>,
<span class="linenr"> 8140: </span>  <span class=
"org-string">"boxbox;"</span>: <span class="org-string">"⧉"</span>,
<span class="linenr"> 8141: </span>  <span class=
"org-string">"bprime;"</span>: <span class="org-string">"‵"</span>,
<span class="linenr"> 8142: </span>  <span class=
"org-string">"brvbar;"</span>: <span class="org-string">"¦"</span>,
<span class="linenr"> 8143: </span>  <span class=
"org-string">"bullet;"</span>: <span class="org-string">"•"</span>,
<span class="linenr"> 8144: </span>  <span class=
"org-string">"Bumpeq;"</span>: <span class="org-string">"≎"</span>,
<span class="linenr"> 8145: </span>  <span class=
"org-string">"bumpeq;"</span>: <span class="org-string">"≏"</span>,
<span class="linenr"> 8146: </span>  <span class=
"org-string">"Cacute;"</span>: <span class="org-string">"Ć"</span>,
<span class="linenr"> 8147: </span>  <span class=
"org-string">"cacute;"</span>: <span class="org-string">"ć"</span>,
<span class="linenr"> 8148: </span>  <span class=
"org-string">"capand;"</span>: <span class="org-string">"⩄"</span>,
<span class="linenr"> 8149: </span>  <span class=
"org-string">"capcap;"</span>: <span class="org-string">"⩋"</span>,
<span class="linenr"> 8150: </span>  <span class=
"org-string">"capcup;"</span>: <span class="org-string">"⩇"</span>,
<span class="linenr"> 8151: </span>  <span class=
"org-string">"capdot;"</span>: <span class="org-string">"⩀"</span>,
<span class="linenr"> 8152: </span>  <span class=
"org-string">"Ccaron;"</span>: <span class="org-string">"Č"</span>,
<span class="linenr"> 8153: </span>  <span class=
"org-string">"ccaron;"</span>: <span class="org-string">"č"</span>,
<span class="linenr"> 8154: </span>  <span class=
"org-string">"Ccedil;"</span>: <span class="org-string">"Ç"</span>,
<span class="linenr"> 8155: </span>  <span class=
"org-string">"ccedil;"</span>: <span class="org-string">"ç"</span>,
<span class="linenr"> 8156: </span>  <span class=
"org-string">"circeq;"</span>: <span class="org-string">"≗"</span>,
<span class="linenr"> 8157: </span>  <span class=
"org-string">"cirmid;"</span>: <span class="org-string">"⫯"</span>,
<span class="linenr"> 8158: </span>  <span class=
"org-string">"Colone;"</span>: <span class="org-string">"⩴"</span>,
<span class="linenr"> 8159: </span>  <span class=
"org-string">"colone;"</span>: <span class="org-string">"≔"</span>,
<span class="linenr"> 8160: </span>  <span class=
"org-string">"commat;"</span>: <span class="org-string">"@"</span>,
<span class="linenr"> 8161: </span>  <span class=
"org-string">"compfn;"</span>: <span class="org-string">"∘"</span>,
<span class="linenr"> 8162: </span>  <span class=
"org-string">"Conint;"</span>: <span class="org-string">"∯"</span>,
<span class="linenr"> 8163: </span>  <span class=
"org-string">"conint;"</span>: <span class="org-string">"∮"</span>,
<span class="linenr"> 8164: </span>  <span class=
"org-string">"coprod;"</span>: <span class="org-string">"∐"</span>,
<span class="linenr"> 8165: </span>  <span class=
"org-string">"copysr;"</span>: <span class="org-string">"℗"</span>,
<span class="linenr"> 8166: </span>  <span class=
"org-string">"cularr;"</span>: <span class="org-string">"↶"</span>,
<span class="linenr"> 8167: </span>  <span class=
"org-string">"CupCap;"</span>: <span class="org-string">"≍"</span>,
<span class="linenr"> 8168: </span>  <span class=
"org-string">"cupcap;"</span>: <span class="org-string">"⩆"</span>,
<span class="linenr"> 8169: </span>  <span class=
"org-string">"cupcup;"</span>: <span class="org-string">"⩊"</span>,
<span class="linenr"> 8170: </span>  <span class=
"org-string">"cupdot;"</span>: <span class="org-string">"⊍"</span>,
<span class="linenr"> 8171: </span>  <span class=
"org-string">"curarr;"</span>: <span class="org-string">"↷"</span>,
<span class="linenr"> 8172: </span>  <span class=
"org-string">"curren;"</span>: <span class="org-string">"¤"</span>,
<span class="linenr"> 8173: </span>  <span class=
"org-string">"cylcty;"</span>: <span class="org-string">"⌭"</span>,
<span class="linenr"> 8174: </span>  <span class=
"org-string">"Dagger;"</span>: <span class="org-string">"‡"</span>,
<span class="linenr"> 8175: </span>  <span class=
"org-string">"dagger;"</span>: <span class="org-string">"†"</span>,
<span class="linenr"> 8176: </span>  <span class=
"org-string">"daleth;"</span>: <span class="org-string">"ℸ"</span>,
<span class="linenr"> 8177: </span>  <span class=
"org-string">"Dcaron;"</span>: <span class="org-string">"Ď"</span>,
<span class="linenr"> 8178: </span>  <span class=
"org-string">"dcaron;"</span>: <span class="org-string">"ď"</span>,
<span class="linenr"> 8179: </span>  <span class=
"org-string">"dfisht;"</span>: <span class="org-string">"⥿"</span>,
<span class="linenr"> 8180: </span>  <span class=
"org-string">"divide;"</span>: <span class="org-string">"÷"</span>,
<span class="linenr"> 8181: </span>  <span class=
"org-string">"divonx;"</span>: <span class="org-string">"⋇"</span>,
<span class="linenr"> 8182: </span>  <span class=
"org-string">"dlcorn;"</span>: <span class="org-string">"⌞"</span>,
<span class="linenr"> 8183: </span>  <span class=
"org-string">"dlcrop;"</span>: <span class="org-string">"⌍"</span>,
<span class="linenr"> 8184: </span>  <span class=
"org-string">"dollar;"</span>: <span class="org-string">"$"</span>,
<span class="linenr"> 8185: </span>  <span class=
"org-string">"DotDot;"</span>: <span class="org-string">"⃜"</span>,
<span class="linenr"> 8186: </span>  <span class=
"org-string">"drcorn;"</span>: <span class="org-string">"⌟"</span>,
<span class="linenr"> 8187: </span>  <span class=
"org-string">"drcrop;"</span>: <span class="org-string">"⌌"</span>,
<span class="linenr"> 8188: </span>  <span class=
"org-string">"Dstrok;"</span>: <span class="org-string">"Đ"</span>,
<span class="linenr"> 8189: </span>  <span class=
"org-string">"dstrok;"</span>: <span class="org-string">"đ"</span>,
<span class="linenr"> 8190: </span>  <span class=
"org-string">"Eacute;"</span>: <span class="org-string">"É"</span>,
<span class="linenr"> 8191: </span>  <span class=
"org-string">"eacute;"</span>: <span class="org-string">"é"</span>,
<span class="linenr"> 8192: </span>  <span class=
"org-string">"easter;"</span>: <span class="org-string">"⩮"</span>,
<span class="linenr"> 8193: </span>  <span class=
"org-string">"Ecaron;"</span>: <span class="org-string">"Ě"</span>,
<span class="linenr"> 8194: </span>  <span class=
"org-string">"ecaron;"</span>: <span class="org-string">"ě"</span>,
<span class="linenr"> 8195: </span>  <span class=
"org-string">"ecolon;"</span>: <span class="org-string">"≕"</span>,
<span class="linenr"> 8196: </span>  <span class=
"org-string">"Egrave;"</span>: <span class="org-string">"È"</span>,
<span class="linenr"> 8197: </span>  <span class=
"org-string">"egrave;"</span>: <span class="org-string">"è"</span>,
<span class="linenr"> 8198: </span>  <span class=
"org-string">"egsdot;"</span>: <span class="org-string">"⪘"</span>,
<span class="linenr"> 8199: </span>  <span class=
"org-string">"elsdot;"</span>: <span class="org-string">"⪗"</span>,
<span class="linenr"> 8200: </span>  <span class=
"org-string">"emptyv;"</span>: <span class="org-string">"∅"</span>,
<span class="linenr"> 8201: </span>  <span class=
"org-string">"emsp13;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 8202: </span>  <span class=
"org-string">"emsp14;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 8203: </span>  <span class=
"org-string">"eparsl;"</span>: <span class="org-string">"⧣"</span>,
<span class="linenr"> 8204: </span>  <span class=
"org-string">"eqcirc;"</span>: <span class="org-string">"≖"</span>,
<span class="linenr"> 8205: </span>  <span class=
"org-string">"equals;"</span>: <span class="org-string">"="</span>,
<span class="linenr"> 8206: </span>  <span class=
"org-string">"equest;"</span>: <span class="org-string">"≟"</span>,
<span class="linenr"> 8207: </span>  <span class=
"org-string">"Exists;"</span>: <span class="org-string">"∃"</span>,
<span class="linenr"> 8208: </span>  <span class=
"org-string">"female;"</span>: <span class="org-string">"♀"</span>,
<span class="linenr"> 8209: </span>  <span class=
"org-string">"ffilig;"</span>: <span class="org-string">"ﬃ"</span>,
<span class="linenr"> 8210: </span>  <span class=
"org-string">"ffllig;"</span>: <span class="org-string">"ﬄ"</span>,
<span class="linenr"> 8211: </span>  <span class=
"org-string">"ForAll;"</span>: <span class="org-string">"∀"</span>,
<span class="linenr"> 8212: </span>  <span class=
"org-string">"forall;"</span>: <span class="org-string">"∀"</span>,
<span class="linenr"> 8213: </span>  <span class=
"org-string">"frac12;"</span>: <span class="org-string">"½"</span>,
<span class="linenr"> 8214: </span>  <span class=
"org-string">"frac13;"</span>: <span class="org-string">"⅓"</span>,
<span class="linenr"> 8215: </span>  <span class=
"org-string">"frac14;"</span>: <span class="org-string">"¼"</span>,
<span class="linenr"> 8216: </span>  <span class=
"org-string">"frac15;"</span>: <span class="org-string">"⅕"</span>,
<span class="linenr"> 8217: </span>  <span class=
"org-string">"frac16;"</span>: <span class="org-string">"⅙"</span>,
<span class="linenr"> 8218: </span>  <span class=
"org-string">"frac18;"</span>: <span class="org-string">"⅛"</span>,
<span class="linenr"> 8219: </span>  <span class=
"org-string">"frac23;"</span>: <span class="org-string">"⅔"</span>,
<span class="linenr"> 8220: </span>  <span class=
"org-string">"frac25;"</span>: <span class="org-string">"⅖"</span>,
<span class="linenr"> 8221: </span>  <span class=
"org-string">"frac34;"</span>: <span class="org-string">"¾"</span>,
<span class="linenr"> 8222: </span>  <span class=
"org-string">"frac35;"</span>: <span class="org-string">"⅗"</span>,
<span class="linenr"> 8223: </span>  <span class=
"org-string">"frac38;"</span>: <span class="org-string">"⅜"</span>,
<span class="linenr"> 8224: </span>  <span class=
"org-string">"frac45;"</span>: <span class="org-string">"⅘"</span>,
<span class="linenr"> 8225: </span>  <span class=
"org-string">"frac56;"</span>: <span class="org-string">"⅚"</span>,
<span class="linenr"> 8226: </span>  <span class=
"org-string">"frac58;"</span>: <span class="org-string">"⅝"</span>,
<span class="linenr"> 8227: </span>  <span class=
"org-string">"frac78;"</span>: <span class="org-string">"⅞"</span>,
<span class="linenr"> 8228: </span>  <span class=
"org-string">"gacute;"</span>: <span class="org-string">"ǵ"</span>,
<span class="linenr"> 8229: </span>  <span class=
"org-string">"Gammad;"</span>: <span class="org-string">"Ϝ"</span>,
<span class="linenr"> 8230: </span>  <span class=
"org-string">"gammad;"</span>: <span class="org-string">"ϝ"</span>,
<span class="linenr"> 8231: </span>  <span class=
"org-string">"Gbreve;"</span>: <span class="org-string">"Ğ"</span>,
<span class="linenr"> 8232: </span>  <span class=
"org-string">"gbreve;"</span>: <span class="org-string">"ğ"</span>,
<span class="linenr"> 8233: </span>  <span class=
"org-string">"Gcedil;"</span>: <span class="org-string">"Ģ"</span>,
<span class="linenr"> 8234: </span>  <span class=
"org-string">"gesdot;"</span>: <span class="org-string">"⪀"</span>,
<span class="linenr"> 8235: </span>  <span class=
"org-string">"gesles;"</span>: <span class="org-string">"⪔"</span>,
<span class="linenr"> 8236: </span>  <span class=
"org-string">"gtlPar;"</span>: <span class="org-string">"⦕"</span>,
<span class="linenr"> 8237: </span>  <span class=
"org-string">"gtrarr;"</span>: <span class="org-string">"⥸"</span>,
<span class="linenr"> 8238: </span>  <span class=
"org-string">"gtrdot;"</span>: <span class="org-string">"⋗"</span>,
<span class="linenr"> 8239: </span>  <span class=
"org-string">"gtrsim;"</span>: <span class="org-string">"≳"</span>,
<span class="linenr"> 8240: </span>  <span class=
"org-string">"hairsp;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 8241: </span>  <span class=
"org-string">"hamilt;"</span>: <span class="org-string">"ℋ"</span>,
<span class="linenr"> 8242: </span>  <span class=
"org-string">"HARDcy;"</span>: <span class="org-string">"Ъ"</span>,
<span class="linenr"> 8243: </span>  <span class=
"org-string">"hardcy;"</span>: <span class="org-string">"ъ"</span>,
<span class="linenr"> 8244: </span>  <span class=
"org-string">"hearts;"</span>: <span class="org-string">"♥"</span>,
<span class="linenr"> 8245: </span>  <span class=
"org-string">"hellip;"</span>: <span class="org-string">"…"</span>,
<span class="linenr"> 8246: </span>  <span class=
"org-string">"hercon;"</span>: <span class="org-string">"⊹"</span>,
<span class="linenr"> 8247: </span>  <span class=
"org-string">"homtht;"</span>: <span class="org-string">"∻"</span>,
<span class="linenr"> 8248: </span>  <span class=
"org-string">"horbar;"</span>: <span class="org-string">"―"</span>,
<span class="linenr"> 8249: </span>  <span class=
"org-string">"hslash;"</span>: <span class="org-string">"ℏ"</span>,
<span class="linenr"> 8250: </span>  <span class=
"org-string">"Hstrok;"</span>: <span class="org-string">"Ħ"</span>,
<span class="linenr"> 8251: </span>  <span class=
"org-string">"hstrok;"</span>: <span class="org-string">"ħ"</span>,
<span class="linenr"> 8252: </span>  <span class=
"org-string">"hybull;"</span>: <span class="org-string">"⁃"</span>,
<span class="linenr"> 8253: </span>  <span class=
"org-string">"hyphen;"</span>: <span class="org-string">"‐"</span>,
<span class="linenr"> 8254: </span>  <span class=
"org-string">"Iacute;"</span>: <span class="org-string">"Í"</span>,
<span class="linenr"> 8255: </span>  <span class=
"org-string">"iacute;"</span>: <span class="org-string">"í"</span>,
<span class="linenr"> 8256: </span>  <span class=
"org-string">"Igrave;"</span>: <span class="org-string">"Ì"</span>,
<span class="linenr"> 8257: </span>  <span class=
"org-string">"igrave;"</span>: <span class="org-string">"ì"</span>,
<span class="linenr"> 8258: </span>  <span class=
"org-string">"iiiint;"</span>: <span class="org-string">"⨌"</span>,
<span class="linenr"> 8259: </span>  <span class=
"org-string">"iinfin;"</span>: <span class="org-string">"⧜"</span>,
<span class="linenr"> 8260: </span>  <span class=
"org-string">"incare;"</span>: <span class="org-string">"℅"</span>,
<span class="linenr"> 8261: </span>  <span class=
"org-string">"inodot;"</span>: <span class="org-string">"ı"</span>,
<span class="linenr"> 8262: </span>  <span class=
"org-string">"intcal;"</span>: <span class="org-string">"⊺"</span>,
<span class="linenr"> 8263: </span>  <span class=
"org-string">"iquest;"</span>: <span class="org-string">"¿"</span>,
<span class="linenr"> 8264: </span>  <span class=
"org-string">"isinsv;"</span>: <span class="org-string">"⋳"</span>,
<span class="linenr"> 8265: </span>  <span class=
"org-string">"Itilde;"</span>: <span class="org-string">"Ĩ"</span>,
<span class="linenr"> 8266: </span>  <span class=
"org-string">"itilde;"</span>: <span class="org-string">"ĩ"</span>,
<span class="linenr"> 8267: </span>  <span class=
"org-string">"Jsercy;"</span>: <span class="org-string">"Ј"</span>,
<span class="linenr"> 8268: </span>  <span class=
"org-string">"jsercy;"</span>: <span class="org-string">"ј"</span>,
<span class="linenr"> 8269: </span>  <span class=
"org-string">"kappav;"</span>: <span class="org-string">"ϰ"</span>,
<span class="linenr"> 8270: </span>  <span class=
"org-string">"Kcedil;"</span>: <span class="org-string">"Ķ"</span>,
<span class="linenr"> 8271: </span>  <span class=
"org-string">"kcedil;"</span>: <span class="org-string">"ķ"</span>,
<span class="linenr"> 8272: </span>  <span class=
"org-string">"kgreen;"</span>: <span class="org-string">"ĸ"</span>,
<span class="linenr"> 8273: </span>  <span class=
"org-string">"Lacute;"</span>: <span class="org-string">"Ĺ"</span>,
<span class="linenr"> 8274: </span>  <span class=
"org-string">"lacute;"</span>: <span class="org-string">"ĺ"</span>,
<span class="linenr"> 8275: </span>  <span class=
"org-string">"lagran;"</span>: <span class="org-string">"ℒ"</span>,
<span class="linenr"> 8276: </span>  <span class=
"org-string">"Lambda;"</span>: <span class="org-string">"Λ"</span>,
<span class="linenr"> 8277: </span>  <span class=
"org-string">"lambda;"</span>: <span class="org-string">"λ"</span>,
<span class="linenr"> 8278: </span>  <span class=
"org-string">"langle;"</span>: <span class="org-string">"⟨"</span>,
<span class="linenr"> 8279: </span>  <span class=
"org-string">"larrfs;"</span>: <span class="org-string">"⤝"</span>,
<span class="linenr"> 8280: </span>  <span class=
"org-string">"larrhk;"</span>: <span class="org-string">"↩"</span>,
<span class="linenr"> 8281: </span>  <span class=
"org-string">"larrlp;"</span>: <span class="org-string">"↫"</span>,
<span class="linenr"> 8282: </span>  <span class=
"org-string">"larrpl;"</span>: <span class="org-string">"⤹"</span>,
<span class="linenr"> 8283: </span>  <span class=
"org-string">"larrtl;"</span>: <span class="org-string">"↢"</span>,
<span class="linenr"> 8284: </span>  <span class=
"org-string">"lAtail;"</span>: <span class="org-string">"⤛"</span>,
<span class="linenr"> 8285: </span>  <span class=
"org-string">"latail;"</span>: <span class="org-string">"⤙"</span>,
<span class="linenr"> 8286: </span>  <span class=
"org-string">"lbrace;"</span>: <span class="org-string">"{"</span>,
<span class="linenr"> 8287: </span>  <span class=
"org-string">"lbrack;"</span>: <span class="org-string">"["</span>,
<span class="linenr"> 8288: </span>  <span class=
"org-string">"Lcaron;"</span>: <span class="org-string">"Ľ"</span>,
<span class="linenr"> 8289: </span>  <span class=
"org-string">"lcaron;"</span>: <span class="org-string">"ľ"</span>,
<span class="linenr"> 8290: </span>  <span class=
"org-string">"Lcedil;"</span>: <span class="org-string">"Ļ"</span>,
<span class="linenr"> 8291: </span>  <span class=
"org-string">"lcedil;"</span>: <span class="org-string">"ļ"</span>,
<span class="linenr"> 8292: </span>  <span class=
"org-string">"ldquor;"</span>: <span class="org-string">"„"</span>,
<span class="linenr"> 8293: </span>  <span class=
"org-string">"lesdot;"</span>: <span class="org-string">"⩿"</span>,
<span class="linenr"> 8294: </span>  <span class=
"org-string">"lesges;"</span>: <span class="org-string">"⪓"</span>,
<span class="linenr"> 8295: </span>  <span class=
"org-string">"lfisht;"</span>: <span class="org-string">"⥼"</span>,
<span class="linenr"> 8296: </span>  <span class=
"org-string">"lfloor;"</span>: <span class="org-string">"⌊"</span>,
<span class="linenr"> 8297: </span>  <span class=
"org-string">"lharul;"</span>: <span class="org-string">"⥪"</span>,
<span class="linenr"> 8298: </span>  <span class=
"org-string">"llhard;"</span>: <span class="org-string">"⥫"</span>,
<span class="linenr"> 8299: </span>  <span class=
"org-string">"Lmidot;"</span>: <span class="org-string">"Ŀ"</span>,
<span class="linenr"> 8300: </span>  <span class=
"org-string">"lmidot;"</span>: <span class="org-string">"ŀ"</span>,
<span class="linenr"> 8301: </span>  <span class=
"org-string">"lmoust;"</span>: <span class="org-string">"⎰"</span>,
<span class="linenr"> 8302: </span>  <span class=
"org-string">"loplus;"</span>: <span class="org-string">"⨭"</span>,
<span class="linenr"> 8303: </span>  <span class=
"org-string">"lowast;"</span>: <span class="org-string">"∗"</span>,
<span class="linenr"> 8304: </span>  <span class=
"org-string">"lowbar;"</span>: <span class="org-string">"_"</span>,
<span class="linenr"> 8305: </span>  <span class=
"org-string">"lparlt;"</span>: <span class="org-string">"⦓"</span>,
<span class="linenr"> 8306: </span>  <span class=
"org-string">"lrhard;"</span>: <span class="org-string">"⥭"</span>,
<span class="linenr"> 8307: </span>  <span class=
"org-string">"lsaquo;"</span>: <span class="org-string">"‹"</span>,
<span class="linenr"> 8308: </span>  <span class=
"org-string">"lsquor;"</span>: <span class="org-string">"‚"</span>,
<span class="linenr"> 8309: </span>  <span class=
"org-string">"Lstrok;"</span>: <span class="org-string">"Ł"</span>,
<span class="linenr"> 8310: </span>  <span class=
"org-string">"lstrok;"</span>: <span class="org-string">"ł"</span>,
<span class="linenr"> 8311: </span>  <span class=
"org-string">"lthree;"</span>: <span class="org-string">"⋋"</span>,
<span class="linenr"> 8312: </span>  <span class=
"org-string">"ltimes;"</span>: <span class="org-string">"⋉"</span>,
<span class="linenr"> 8313: </span>  <span class=
"org-string">"ltlarr;"</span>: <span class="org-string">"⥶"</span>,
<span class="linenr"> 8314: </span>  <span class=
"org-string">"ltrPar;"</span>: <span class="org-string">"⦖"</span>,
<span class="linenr"> 8315: </span>  <span class=
"org-string">"mapsto;"</span>: <span class="org-string">"↦"</span>,
<span class="linenr"> 8316: </span>  <span class=
"org-string">"marker;"</span>: <span class="org-string">"▮"</span>,
<span class="linenr"> 8317: </span>  <span class=
"org-string">"mcomma;"</span>: <span class="org-string">"⨩"</span>,
<span class="linenr"> 8318: </span>  <span class=
"org-string">"midast;"</span>: <span class="org-string">"*"</span>,
<span class="linenr"> 8319: </span>  <span class=
"org-string">"midcir;"</span>: <span class="org-string">"⫰"</span>,
<span class="linenr"> 8320: </span>  <span class=
"org-string">"middot;"</span>: <span class="org-string">"·"</span>,
<span class="linenr"> 8321: </span>  <span class=
"org-string">"minusb;"</span>: <span class="org-string">"⊟"</span>,
<span class="linenr"> 8322: </span>  <span class=
"org-string">"minusd;"</span>: <span class="org-string">"∸"</span>,
<span class="linenr"> 8323: </span>  <span class=
"org-string">"mnplus;"</span>: <span class="org-string">"∓"</span>,
<span class="linenr"> 8324: </span>  <span class=
"org-string">"models;"</span>: <span class="org-string">"⊧"</span>,
<span class="linenr"> 8325: </span>  <span class=
"org-string">"mstpos;"</span>: <span class="org-string">"∾"</span>,
<span class="linenr"> 8326: </span>  <span class=
"org-string">"Nacute;"</span>: <span class="org-string">"Ń"</span>,
<span class="linenr"> 8327: </span>  <span class=
"org-string">"nacute;"</span>: <span class="org-string">"ń"</span>,
<span class="linenr"> 8328: </span>  <span class=
"org-string">"nbumpe;"</span>: <span class=
"org-string">"≏̸"</span>,
<span class="linenr"> 8329: </span>  <span class=
"org-string">"Ncaron;"</span>: <span class="org-string">"Ň"</span>,
<span class="linenr"> 8330: </span>  <span class=
"org-string">"ncaron;"</span>: <span class="org-string">"ň"</span>,
<span class="linenr"> 8331: </span>  <span class=
"org-string">"Ncedil;"</span>: <span class="org-string">"Ņ"</span>,
<span class="linenr"> 8332: </span>  <span class=
"org-string">"ncedil;"</span>: <span class="org-string">"ņ"</span>,
<span class="linenr"> 8333: </span>  <span class=
"org-string">"nearhk;"</span>: <span class="org-string">"⤤"</span>,
<span class="linenr"> 8334: </span>  <span class=
"org-string">"nequiv;"</span>: <span class="org-string">"≢"</span>,
<span class="linenr"> 8335: </span>  <span class=
"org-string">"nesear;"</span>: <span class="org-string">"⤨"</span>,
<span class="linenr"> 8336: </span>  <span class=
"org-string">"nexist;"</span>: <span class="org-string">"∄"</span>,
<span class="linenr"> 8337: </span>  <span class=
"org-string">"nltrie;"</span>: <span class="org-string">"⋬"</span>,
<span class="linenr"> 8338: </span>  <span class=
"org-string">"notinE;"</span>: <span class=
"org-string">"⋹̸"</span>,
<span class="linenr"> 8339: </span>  <span class=
"org-string">"nparsl;"</span>: <span class=
"org-string">"⫽⃥"</span>,
<span class="linenr"> 8340: </span>  <span class=
"org-string">"nprcue;"</span>: <span class="org-string">"⋠"</span>,
<span class="linenr"> 8341: </span>  <span class=
"org-string">"nrarrc;"</span>: <span class=
"org-string">"⤳̸"</span>,
<span class="linenr"> 8342: </span>  <span class=
"org-string">"nrarrw;"</span>: <span class=
"org-string">"↝̸"</span>,
<span class="linenr"> 8343: </span>  <span class=
"org-string">"nrtrie;"</span>: <span class="org-string">"⋭"</span>,
<span class="linenr"> 8344: </span>  <span class=
"org-string">"nsccue;"</span>: <span class="org-string">"⋡"</span>,
<span class="linenr"> 8345: </span>  <span class=
"org-string">"nsimeq;"</span>: <span class="org-string">"≄"</span>,
<span class="linenr"> 8346: </span>  <span class=
"org-string">"Ntilde;"</span>: <span class="org-string">"Ñ"</span>,
<span class="linenr"> 8347: </span>  <span class=
"org-string">"ntilde;"</span>: <span class="org-string">"ñ"</span>,
<span class="linenr"> 8348: </span>  <span class=
"org-string">"numero;"</span>: <span class="org-string">"№"</span>,
<span class="linenr"> 8349: </span>  <span class=
"org-string">"nVDash;"</span>: <span class="org-string">"⊯"</span>,
<span class="linenr"> 8350: </span>  <span class=
"org-string">"nVdash;"</span>: <span class="org-string">"⊮"</span>,
<span class="linenr"> 8351: </span>  <span class=
"org-string">"nvDash;"</span>: <span class="org-string">"⊭"</span>,
<span class="linenr"> 8352: </span>  <span class=
"org-string">"nvdash;"</span>: <span class="org-string">"⊬"</span>,
<span class="linenr"> 8353: </span>  <span class=
"org-string">"nvHarr;"</span>: <span class="org-string">"⤄"</span>,
<span class="linenr"> 8354: </span>  <span class=
"org-string">"nvlArr;"</span>: <span class="org-string">"⤂"</span>,
<span class="linenr"> 8355: </span>  <span class=
"org-string">"nvrArr;"</span>: <span class="org-string">"⤃"</span>,
<span class="linenr"> 8356: </span>  <span class=
"org-string">"nwarhk;"</span>: <span class="org-string">"⤣"</span>,
<span class="linenr"> 8357: </span>  <span class=
"org-string">"nwnear;"</span>: <span class="org-string">"⤧"</span>,
<span class="linenr"> 8358: </span>  <span class=
"org-string">"Oacute;"</span>: <span class="org-string">"Ó"</span>,
<span class="linenr"> 8359: </span>  <span class=
"org-string">"oacute;"</span>: <span class="org-string">"ó"</span>,
<span class="linenr"> 8360: </span>  <span class=
"org-string">"Odblac;"</span>: <span class="org-string">"Ő"</span>,
<span class="linenr"> 8361: </span>  <span class=
"org-string">"odblac;"</span>: <span class="org-string">"ő"</span>,
<span class="linenr"> 8362: </span>  <span class=
"org-string">"odsold;"</span>: <span class="org-string">"⦼"</span>,
<span class="linenr"> 8363: </span>  <span class=
"org-string">"Ograve;"</span>: <span class="org-string">"Ò"</span>,
<span class="linenr"> 8364: </span>  <span class=
"org-string">"ograve;"</span>: <span class="org-string">"ò"</span>,
<span class="linenr"> 8365: </span>  <span class=
"org-string">"ominus;"</span>: <span class="org-string">"⊖"</span>,
<span class="linenr"> 8366: </span>  <span class=
"org-string">"origof;"</span>: <span class="org-string">"⊶"</span>,
<span class="linenr"> 8367: </span>  <span class=
"org-string">"Oslash;"</span>: <span class="org-string">"Ø"</span>,
<span class="linenr"> 8368: </span>  <span class=
"org-string">"oslash;"</span>: <span class="org-string">"ø"</span>,
<span class="linenr"> 8369: </span>  <span class=
"org-string">"Otilde;"</span>: <span class="org-string">"Õ"</span>,
<span class="linenr"> 8370: </span>  <span class=
"org-string">"otilde;"</span>: <span class="org-string">"õ"</span>,
<span class="linenr"> 8371: </span>  <span class=
"org-string">"Otimes;"</span>: <span class="org-string">"⨷"</span>,
<span class="linenr"> 8372: </span>  <span class=
"org-string">"otimes;"</span>: <span class="org-string">"⊗"</span>,
<span class="linenr"> 8373: </span>  <span class=
"org-string">"parsim;"</span>: <span class="org-string">"⫳"</span>,
<span class="linenr"> 8374: </span>  <span class=
"org-string">"percnt;"</span>: <span class="org-string">"%"</span>,
<span class="linenr"> 8375: </span>  <span class=
"org-string">"period;"</span>: <span class="org-string">"."</span>,
<span class="linenr"> 8376: </span>  <span class=
"org-string">"permil;"</span>: <span class="org-string">"‰"</span>,
<span class="linenr"> 8377: </span>  <span class=
"org-string">"phmmat;"</span>: <span class="org-string">"ℳ"</span>,
<span class="linenr"> 8378: </span>  <span class=
"org-string">"planck;"</span>: <span class="org-string">"ℏ"</span>,
<span class="linenr"> 8379: </span>  <span class=
"org-string">"plankv;"</span>: <span class="org-string">"ℏ"</span>,
<span class="linenr"> 8380: </span>  <span class=
"org-string">"plusdo;"</span>: <span class="org-string">"∔"</span>,
<span class="linenr"> 8381: </span>  <span class=
"org-string">"plusdu;"</span>: <span class="org-string">"⨥"</span>,
<span class="linenr"> 8382: </span>  <span class=
"org-string">"plusmn;"</span>: <span class="org-string">"±"</span>,
<span class="linenr"> 8383: </span>  <span class=
"org-string">"preceq;"</span>: <span class="org-string">"⪯"</span>,
<span class="linenr"> 8384: </span>  <span class=
"org-string">"primes;"</span>: <span class="org-string">"ℙ"</span>,
<span class="linenr"> 8385: </span>  <span class=
"org-string">"prnsim;"</span>: <span class="org-string">"⋨"</span>,
<span class="linenr"> 8386: </span>  <span class=
"org-string">"propto;"</span>: <span class="org-string">"∝"</span>,
<span class="linenr"> 8387: </span>  <span class=
"org-string">"prurel;"</span>: <span class="org-string">"⊰"</span>,
<span class="linenr"> 8388: </span>  <span class=
"org-string">"puncsp;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 8389: </span>  <span class=
"org-string">"qprime;"</span>: <span class="org-string">"⁗"</span>,
<span class="linenr"> 8390: </span>  <span class=
"org-string">"Racute;"</span>: <span class="org-string">"Ŕ"</span>,
<span class="linenr"> 8391: </span>  <span class=
"org-string">"racute;"</span>: <span class="org-string">"ŕ"</span>,
<span class="linenr"> 8392: </span>  <span class=
"org-string">"rangle;"</span>: <span class="org-string">"⟩"</span>,
<span class="linenr"> 8393: </span>  <span class=
"org-string">"rarrap;"</span>: <span class="org-string">"⥵"</span>,
<span class="linenr"> 8394: </span>  <span class=
"org-string">"rarrfs;"</span>: <span class="org-string">"⤞"</span>,
<span class="linenr"> 8395: </span>  <span class=
"org-string">"rarrhk;"</span>: <span class="org-string">"↪"</span>,
<span class="linenr"> 8396: </span>  <span class=
"org-string">"rarrlp;"</span>: <span class="org-string">"↬"</span>,
<span class="linenr"> 8397: </span>  <span class=
"org-string">"rarrpl;"</span>: <span class="org-string">"⥅"</span>,
<span class="linenr"> 8398: </span>  <span class=
"org-string">"Rarrtl;"</span>: <span class="org-string">"⤖"</span>,
<span class="linenr"> 8399: </span>  <span class=
"org-string">"rarrtl;"</span>: <span class="org-string">"↣"</span>,
<span class="linenr"> 8400: </span>  <span class=
"org-string">"rAtail;"</span>: <span class="org-string">"⤜"</span>,
<span class="linenr"> 8401: </span>  <span class=
"org-string">"ratail;"</span>: <span class="org-string">"⤚"</span>,
<span class="linenr"> 8402: </span>  <span class=
"org-string">"rbrace;"</span>: <span class="org-string">"}"</span>,
<span class="linenr"> 8403: </span>  <span class=
"org-string">"rbrack;"</span>: <span class="org-string">"]"</span>,
<span class="linenr"> 8404: </span>  <span class=
"org-string">"Rcaron;"</span>: <span class="org-string">"Ř"</span>,
<span class="linenr"> 8405: </span>  <span class=
"org-string">"rcaron;"</span>: <span class="org-string">"ř"</span>,
<span class="linenr"> 8406: </span>  <span class=
"org-string">"Rcedil;"</span>: <span class="org-string">"Ŗ"</span>,
<span class="linenr"> 8407: </span>  <span class=
"org-string">"rcedil;"</span>: <span class="org-string">"ŗ"</span>,
<span class="linenr"> 8408: </span>  <span class=
"org-string">"rdquor;"</span>: <span class="org-string">"”"</span>,
<span class="linenr"> 8409: </span>  <span class=
"org-string">"rfisht;"</span>: <span class="org-string">"⥽"</span>,
<span class="linenr"> 8410: </span>  <span class=
"org-string">"rfloor;"</span>: <span class="org-string">"⌋"</span>,
<span class="linenr"> 8411: </span>  <span class=
"org-string">"rharul;"</span>: <span class="org-string">"⥬"</span>,
<span class="linenr"> 8412: </span>  <span class=
"org-string">"rmoust;"</span>: <span class="org-string">"⎱"</span>,
<span class="linenr"> 8413: </span>  <span class=
"org-string">"roplus;"</span>: <span class="org-string">"⨮"</span>,
<span class="linenr"> 8414: </span>  <span class=
"org-string">"rpargt;"</span>: <span class="org-string">"⦔"</span>,
<span class="linenr"> 8415: </span>  <span class=
"org-string">"rsaquo;"</span>: <span class="org-string">"›"</span>,
<span class="linenr"> 8416: </span>  <span class=
"org-string">"rsquor;"</span>: <span class="org-string">"’"</span>,
<span class="linenr"> 8417: </span>  <span class=
"org-string">"rthree;"</span>: <span class="org-string">"⋌"</span>,
<span class="linenr"> 8418: </span>  <span class=
"org-string">"rtimes;"</span>: <span class="org-string">"⋊"</span>,
<span class="linenr"> 8419: </span>  <span class=
"org-string">"Sacute;"</span>: <span class="org-string">"Ś"</span>,
<span class="linenr"> 8420: </span>  <span class=
"org-string">"sacute;"</span>: <span class="org-string">"ś"</span>,
<span class="linenr"> 8421: </span>  <span class=
"org-string">"Scaron;"</span>: <span class="org-string">"Š"</span>,
<span class="linenr"> 8422: </span>  <span class=
"org-string">"scaron;"</span>: <span class="org-string">"š"</span>,
<span class="linenr"> 8423: </span>  <span class=
"org-string">"Scedil;"</span>: <span class="org-string">"Ş"</span>,
<span class="linenr"> 8424: </span>  <span class=
"org-string">"scedil;"</span>: <span class="org-string">"ş"</span>,
<span class="linenr"> 8425: </span>  <span class=
"org-string">"scnsim;"</span>: <span class="org-string">"⋩"</span>,
<span class="linenr"> 8426: </span>  <span class=
"org-string">"searhk;"</span>: <span class="org-string">"⤥"</span>,
<span class="linenr"> 8427: </span>  <span class=
"org-string">"seswar;"</span>: <span class="org-string">"⤩"</span>,
<span class="linenr"> 8428: </span>  <span class=
"org-string">"sfrown;"</span>: <span class="org-string">"⌢"</span>,
<span class="linenr"> 8429: </span>  <span class=
"org-string">"SHCHcy;"</span>: <span class="org-string">"Щ"</span>,
<span class="linenr"> 8430: </span>  <span class=
"org-string">"shchcy;"</span>: <span class="org-string">"щ"</span>,
<span class="linenr"> 8431: </span>  <span class=
"org-string">"sigmaf;"</span>: <span class="org-string">"ς"</span>,
<span class="linenr"> 8432: </span>  <span class=
"org-string">"sigmav;"</span>: <span class="org-string">"ς"</span>,
<span class="linenr"> 8433: </span>  <span class=
"org-string">"simdot;"</span>: <span class="org-string">"⩪"</span>,
<span class="linenr"> 8434: </span>  <span class=
"org-string">"smashp;"</span>: <span class="org-string">"⨳"</span>,
<span class="linenr"> 8435: </span>  <span class=
"org-string">"SOFTcy;"</span>: <span class="org-string">"Ь"</span>,
<span class="linenr"> 8436: </span>  <span class=
"org-string">"softcy;"</span>: <span class="org-string">"ь"</span>,
<span class="linenr"> 8437: </span>  <span class=
"org-string">"solbar;"</span>: <span class="org-string">"⌿"</span>,
<span class="linenr"> 8438: </span>  <span class=
"org-string">"spades;"</span>: <span class="org-string">"♠"</span>,
<span class="linenr"> 8439: </span>  <span class=
"org-string">"sqcaps;"</span>: <span class=
"org-string">"⊓︀"</span>,
<span class="linenr"> 8440: </span>  <span class=
"org-string">"sqcups;"</span>: <span class=
"org-string">"⊔︀"</span>,
<span class="linenr"> 8441: </span>  <span class=
"org-string">"sqsube;"</span>: <span class="org-string">"⊑"</span>,
<span class="linenr"> 8442: </span>  <span class=
"org-string">"sqsupe;"</span>: <span class="org-string">"⊒"</span>,
<span class="linenr"> 8443: </span>  <span class=
"org-string">"Square;"</span>: <span class="org-string">"□"</span>,
<span class="linenr"> 8444: </span>  <span class=
"org-string">"square;"</span>: <span class="org-string">"□"</span>,
<span class="linenr"> 8445: </span>  <span class=
"org-string">"squarf;"</span>: <span class="org-string">"▪"</span>,
<span class="linenr"> 8446: </span>  <span class=
"org-string">"ssetmn;"</span>: <span class="org-string">"∖"</span>,
<span class="linenr"> 8447: </span>  <span class=
"org-string">"ssmile;"</span>: <span class="org-string">"⌣"</span>,
<span class="linenr"> 8448: </span>  <span class=
"org-string">"sstarf;"</span>: <span class="org-string">"⋆"</span>,
<span class="linenr"> 8449: </span>  <span class=
"org-string">"subdot;"</span>: <span class="org-string">"⪽"</span>,
<span class="linenr"> 8450: </span>  <span class=
"org-string">"Subset;"</span>: <span class="org-string">"⋐"</span>,
<span class="linenr"> 8451: </span>  <span class=
"org-string">"subset;"</span>: <span class="org-string">"⊂"</span>,
<span class="linenr"> 8452: </span>  <span class=
"org-string">"subsim;"</span>: <span class="org-string">"⫇"</span>,
<span class="linenr"> 8453: </span>  <span class=
"org-string">"subsub;"</span>: <span class="org-string">"⫕"</span>,
<span class="linenr"> 8454: </span>  <span class=
"org-string">"subsup;"</span>: <span class="org-string">"⫓"</span>,
<span class="linenr"> 8455: </span>  <span class=
"org-string">"succeq;"</span>: <span class="org-string">"⪰"</span>,
<span class="linenr"> 8456: </span>  <span class=
"org-string">"supdot;"</span>: <span class="org-string">"⪾"</span>,
<span class="linenr"> 8457: </span>  <span class=
"org-string">"Supset;"</span>: <span class="org-string">"⋑"</span>,
<span class="linenr"> 8458: </span>  <span class=
"org-string">"supset;"</span>: <span class="org-string">"⊃"</span>,
<span class="linenr"> 8459: </span>  <span class=
"org-string">"supsim;"</span>: <span class="org-string">"⫈"</span>,
<span class="linenr"> 8460: </span>  <span class=
"org-string">"supsub;"</span>: <span class="org-string">"⫔"</span>,
<span class="linenr"> 8461: </span>  <span class=
"org-string">"supsup;"</span>: <span class="org-string">"⫖"</span>,
<span class="linenr"> 8462: </span>  <span class=
"org-string">"swarhk;"</span>: <span class="org-string">"⤦"</span>,
<span class="linenr"> 8463: </span>  <span class=
"org-string">"swnwar;"</span>: <span class="org-string">"⤪"</span>,
<span class="linenr"> 8464: </span>  <span class=
"org-string">"target;"</span>: <span class="org-string">"⌖"</span>,
<span class="linenr"> 8465: </span>  <span class=
"org-string">"Tcaron;"</span>: <span class="org-string">"Ť"</span>,
<span class="linenr"> 8466: </span>  <span class=
"org-string">"tcaron;"</span>: <span class="org-string">"ť"</span>,
<span class="linenr"> 8467: </span>  <span class=
"org-string">"Tcedil;"</span>: <span class="org-string">"Ţ"</span>,
<span class="linenr"> 8468: </span>  <span class=
"org-string">"tcedil;"</span>: <span class="org-string">"ţ"</span>,
<span class="linenr"> 8469: </span>  <span class=
"org-string">"telrec;"</span>: <span class="org-string">"⌕"</span>,
<span class="linenr"> 8470: </span>  <span class=
"org-string">"there4;"</span>: <span class="org-string">"∴"</span>,
<span class="linenr"> 8471: </span>  <span class=
"org-string">"thetav;"</span>: <span class="org-string">"ϑ"</span>,
<span class="linenr"> 8472: </span>  <span class=
"org-string">"thinsp;"</span>: <span class="org-string">" "</span>,
<span class="linenr"> 8473: </span>  <span class=
"org-string">"thksim;"</span>: <span class="org-string">"∼"</span>,
<span class="linenr"> 8474: </span>  <span class=
"org-string">"timesb;"</span>: <span class="org-string">"⊠"</span>,
<span class="linenr"> 8475: </span>  <span class=
"org-string">"timesd;"</span>: <span class="org-string">"⨰"</span>,
<span class="linenr"> 8476: </span>  <span class=
"org-string">"topbot;"</span>: <span class="org-string">"⌶"</span>,
<span class="linenr"> 8477: </span>  <span class=
"org-string">"topcir;"</span>: <span class="org-string">"⫱"</span>,
<span class="linenr"> 8478: </span>  <span class=
"org-string">"tprime;"</span>: <span class="org-string">"‴"</span>,
<span class="linenr"> 8479: </span>  <span class=
"org-string">"tridot;"</span>: <span class="org-string">"◬"</span>,
<span class="linenr"> 8480: </span>  <span class=
"org-string">"Tstrok;"</span>: <span class="org-string">"Ŧ"</span>,
<span class="linenr"> 8481: </span>  <span class=
"org-string">"tstrok;"</span>: <span class="org-string">"ŧ"</span>,
<span class="linenr"> 8482: </span>  <span class=
"org-string">"Uacute;"</span>: <span class="org-string">"Ú"</span>,
<span class="linenr"> 8483: </span>  <span class=
"org-string">"uacute;"</span>: <span class="org-string">"ú"</span>,
<span class="linenr"> 8484: </span>  <span class=
"org-string">"Ubreve;"</span>: <span class="org-string">"Ŭ"</span>,
<span class="linenr"> 8485: </span>  <span class=
"org-string">"ubreve;"</span>: <span class="org-string">"ŭ"</span>,
<span class="linenr"> 8486: </span>  <span class=
"org-string">"Udblac;"</span>: <span class="org-string">"Ű"</span>,
<span class="linenr"> 8487: </span>  <span class=
"org-string">"udblac;"</span>: <span class="org-string">"ű"</span>,
<span class="linenr"> 8488: </span>  <span class=
"org-string">"ufisht;"</span>: <span class="org-string">"⥾"</span>,
<span class="linenr"> 8489: </span>  <span class=
"org-string">"Ugrave;"</span>: <span class="org-string">"Ù"</span>,
<span class="linenr"> 8490: </span>  <span class=
"org-string">"ugrave;"</span>: <span class="org-string">"ù"</span>,
<span class="linenr"> 8491: </span>  <span class=
"org-string">"ulcorn;"</span>: <span class="org-string">"⌜"</span>,
<span class="linenr"> 8492: </span>  <span class=
"org-string">"ulcrop;"</span>: <span class="org-string">"⌏"</span>,
<span class="linenr"> 8493: </span>  <span class=
"org-string">"urcorn;"</span>: <span class="org-string">"⌝"</span>,
<span class="linenr"> 8494: </span>  <span class=
"org-string">"urcrop;"</span>: <span class="org-string">"⌎"</span>,
<span class="linenr"> 8495: </span>  <span class=
"org-string">"Utilde;"</span>: <span class="org-string">"Ũ"</span>,
<span class="linenr"> 8496: </span>  <span class=
"org-string">"utilde;"</span>: <span class="org-string">"ũ"</span>,
<span class="linenr"> 8497: </span>  <span class=
"org-string">"vangrt;"</span>: <span class="org-string">"⦜"</span>,
<span class="linenr"> 8498: </span>  <span class=
"org-string">"varphi;"</span>: <span class="org-string">"ϕ"</span>,
<span class="linenr"> 8499: </span>  <span class=
"org-string">"varrho;"</span>: <span class="org-string">"ϱ"</span>,
<span class="linenr"> 8500: </span>  <span class=
"org-string">"Vdashl;"</span>: <span class="org-string">"⫦"</span>,
<span class="linenr"> 8501: </span>  <span class=
"org-string">"veebar;"</span>: <span class="org-string">"⊻"</span>,
<span class="linenr"> 8502: </span>  <span class=
"org-string">"vellip;"</span>: <span class="org-string">"⋮"</span>,
<span class="linenr"> 8503: </span>  <span class=
"org-string">"Verbar;"</span>: <span class="org-string">"‖"</span>,
<span class="linenr"> 8504: </span>  <span class=
"org-string">"verbar;"</span>: <span class="org-string">"|"</span>,
<span class="linenr"> 8505: </span>  <span class=
"org-string">"vsubnE;"</span>: <span class=
"org-string">"⫋︀"</span>,
<span class="linenr"> 8506: </span>  <span class=
"org-string">"vsubne;"</span>: <span class=
"org-string">"⊊︀"</span>,
<span class="linenr"> 8507: </span>  <span class=
"org-string">"vsupnE;"</span>: <span class=
"org-string">"⫌︀"</span>,
<span class="linenr"> 8508: </span>  <span class=
"org-string">"vsupne;"</span>: <span class=
"org-string">"⊋︀"</span>,
<span class="linenr"> 8509: </span>  <span class=
"org-string">"Vvdash;"</span>: <span class="org-string">"⊪"</span>,
<span class="linenr"> 8510: </span>  <span class=
"org-string">"wedbar;"</span>: <span class="org-string">"⩟"</span>,
<span class="linenr"> 8511: </span>  <span class=
"org-string">"wedgeq;"</span>: <span class="org-string">"≙"</span>,
<span class="linenr"> 8512: </span>  <span class=
"org-string">"weierp;"</span>: <span class="org-string">"℘"</span>,
<span class="linenr"> 8513: </span>  <span class=
"org-string">"wreath;"</span>: <span class="org-string">"≀"</span>,
<span class="linenr"> 8514: </span>  <span class=
"org-string">"xoplus;"</span>: <span class="org-string">"⨁"</span>,
<span class="linenr"> 8515: </span>  <span class=
"org-string">"xotime;"</span>: <span class="org-string">"⨂"</span>,
<span class="linenr"> 8516: </span>  <span class=
"org-string">"xsqcup;"</span>: <span class="org-string">"⨆"</span>,
<span class="linenr"> 8517: </span>  <span class=
"org-string">"xuplus;"</span>: <span class="org-string">"⨄"</span>,
<span class="linenr"> 8518: </span>  <span class=
"org-string">"xwedge;"</span>: <span class="org-string">"⋀"</span>,
<span class="linenr"> 8519: </span>  <span class=
"org-string">"Yacute;"</span>: <span class="org-string">"Ý"</span>,
<span class="linenr"> 8520: </span>  <span class=
"org-string">"yacute;"</span>: <span class="org-string">"ý"</span>,
<span class="linenr"> 8521: </span>  <span class=
"org-string">"Zacute;"</span>: <span class="org-string">"Ź"</span>,
<span class="linenr"> 8522: </span>  <span class=
"org-string">"zacute;"</span>: <span class="org-string">"ź"</span>,
<span class="linenr"> 8523: </span>  <span class=
"org-string">"Zcaron;"</span>: <span class="org-string">"Ž"</span>,
<span class="linenr"> 8524: </span>  <span class=
"org-string">"zcaron;"</span>: <span class="org-string">"ž"</span>,
<span class="linenr"> 8525: </span>  <span class=
"org-string">"zeetrf;"</span>: <span class="org-string">"ℨ"</span>,
<span class="linenr"> 8526: </span>  <span class=
"org-string">"alefsym;"</span>: <span class=
"org-string">"ℵ"</span>,
<span class="linenr"> 8527: </span>  <span class=
"org-string">"angrtvb;"</span>: <span class=
"org-string">"⊾"</span>,
<span class="linenr"> 8528: </span>  <span class=
"org-string">"angzarr;"</span>: <span class=
"org-string">"⍼"</span>,
<span class="linenr"> 8529: </span>  <span class=
"org-string">"asympeq;"</span>: <span class=
"org-string">"≍"</span>,
<span class="linenr"> 8530: </span>  <span class=
"org-string">"backsim;"</span>: <span class=
"org-string">"∽"</span>,
<span class="linenr"> 8531: </span>  <span class=
"org-string">"Because;"</span>: <span class=
"org-string">"∵"</span>,
<span class="linenr"> 8532: </span>  <span class=
"org-string">"because;"</span>: <span class=
"org-string">"∵"</span>,
<span class="linenr"> 8533: </span>  <span class=
"org-string">"bemptyv;"</span>: <span class=
"org-string">"⦰"</span>,
<span class="linenr"> 8534: </span>  <span class=
"org-string">"between;"</span>: <span class=
"org-string">"≬"</span>,
<span class="linenr"> 8535: </span>  <span class=
"org-string">"bigcirc;"</span>: <span class=
"org-string">"◯"</span>,
<span class="linenr"> 8536: </span>  <span class=
"org-string">"bigodot;"</span>: <span class=
"org-string">"⨀"</span>,
<span class="linenr"> 8537: </span>  <span class=
"org-string">"bigstar;"</span>: <span class=
"org-string">"★"</span>,
<span class="linenr"> 8538: </span>  <span class=
"org-string">"bnequiv;"</span>: <span class=
"org-string">"≡⃥"</span>,
<span class="linenr"> 8539: </span>  <span class=
"org-string">"boxplus;"</span>: <span class=
"org-string">"⊞"</span>,
<span class="linenr"> 8540: </span>  <span class=
"org-string">"Cayleys;"</span>: <span class=
"org-string">"ℭ"</span>,
<span class="linenr"> 8541: </span>  <span class=
"org-string">"Cconint;"</span>: <span class=
"org-string">"∰"</span>,
<span class="linenr"> 8542: </span>  <span class=
"org-string">"ccupssm;"</span>: <span class=
"org-string">"⩐"</span>,
<span class="linenr"> 8543: </span>  <span class=
"org-string">"Cedilla;"</span>: <span class=
"org-string">"¸"</span>,
<span class="linenr"> 8544: </span>  <span class=
"org-string">"cemptyv;"</span>: <span class=
"org-string">"⦲"</span>,
<span class="linenr"> 8545: </span>  <span class=
"org-string">"cirscir;"</span>: <span class=
"org-string">"⧂"</span>,
<span class="linenr"> 8546: </span>  <span class=
"org-string">"coloneq;"</span>: <span class=
"org-string">"≔"</span>,
<span class="linenr"> 8547: </span>  <span class=
"org-string">"congdot;"</span>: <span class=
"org-string">"⩭"</span>,
<span class="linenr"> 8548: </span>  <span class=
"org-string">"cudarrl;"</span>: <span class=
"org-string">"⤸"</span>,
<span class="linenr"> 8549: </span>  <span class=
"org-string">"cudarrr;"</span>: <span class=
"org-string">"⤵"</span>,
<span class="linenr"> 8550: </span>  <span class=
"org-string">"cularrp;"</span>: <span class=
"org-string">"⤽"</span>,
<span class="linenr"> 8551: </span>  <span class=
"org-string">"curarrm;"</span>: <span class=
"org-string">"⤼"</span>,
<span class="linenr"> 8552: </span>  <span class=
"org-string">"dbkarow;"</span>: <span class=
"org-string">"⤏"</span>,
<span class="linenr"> 8553: </span>  <span class=
"org-string">"ddagger;"</span>: <span class=
"org-string">"‡"</span>,
<span class="linenr"> 8554: </span>  <span class=
"org-string">"ddotseq;"</span>: <span class=
"org-string">"⩷"</span>,
<span class="linenr"> 8555: </span>  <span class=
"org-string">"demptyv;"</span>: <span class=
"org-string">"⦱"</span>,
<span class="linenr"> 8556: </span>  <span class=
"org-string">"Diamond;"</span>: <span class=
"org-string">"⋄"</span>,
<span class="linenr"> 8557: </span>  <span class=
"org-string">"diamond;"</span>: <span class=
"org-string">"⋄"</span>,
<span class="linenr"> 8558: </span>  <span class=
"org-string">"digamma;"</span>: <span class=
"org-string">"ϝ"</span>,
<span class="linenr"> 8559: </span>  <span class=
"org-string">"dotplus;"</span>: <span class=
"org-string">"∔"</span>,
<span class="linenr"> 8560: </span>  <span class=
"org-string">"DownTee;"</span>: <span class=
"org-string">"⊤"</span>,
<span class="linenr"> 8561: </span>  <span class=
"org-string">"dwangle;"</span>: <span class=
"org-string">"⦦"</span>,
<span class="linenr"> 8562: </span>  <span class=
"org-string">"Element;"</span>: <span class=
"org-string">"∈"</span>,
<span class="linenr"> 8563: </span>  <span class=
"org-string">"Epsilon;"</span>: <span class=
"org-string">"Ε"</span>,
<span class="linenr"> 8564: </span>  <span class=
"org-string">"epsilon;"</span>: <span class=
"org-string">"ε"</span>,
<span class="linenr"> 8565: </span>  <span class=
"org-string">"eqcolon;"</span>: <span class=
"org-string">"≕"</span>,
<span class="linenr"> 8566: </span>  <span class=
"org-string">"equivDD;"</span>: <span class=
"org-string">"⩸"</span>,
<span class="linenr"> 8567: </span>  <span class=
"org-string">"gesdoto;"</span>: <span class=
"org-string">"⪂"</span>,
<span class="linenr"> 8568: </span>  <span class=
"org-string">"gtquest;"</span>: <span class=
"org-string">"⩼"</span>,
<span class="linenr"> 8569: </span>  <span class=
"org-string">"gtrless;"</span>: <span class=
"org-string">"≷"</span>,
<span class="linenr"> 8570: </span>  <span class=
"org-string">"harrcir;"</span>: <span class=
"org-string">"⥈"</span>,
<span class="linenr"> 8571: </span>  <span class=
"org-string">"Implies;"</span>: <span class=
"org-string">"⇒"</span>,
<span class="linenr"> 8572: </span>  <span class=
"org-string">"intprod;"</span>: <span class=
"org-string">"⨼"</span>,
<span class="linenr"> 8573: </span>  <span class=
"org-string">"isindot;"</span>: <span class=
"org-string">"⋵"</span>,
<span class="linenr"> 8574: </span>  <span class=
"org-string">"larrbfs;"</span>: <span class=
"org-string">"⤟"</span>,
<span class="linenr"> 8575: </span>  <span class=
"org-string">"larrsim;"</span>: <span class=
"org-string">"⥳"</span>,
<span class="linenr"> 8576: </span>  <span class=
"org-string">"lbrksld;"</span>: <span class=
"org-string">"⦏"</span>,
<span class="linenr"> 8577: </span>  <span class=
"org-string">"lbrkslu;"</span>: <span class=
"org-string">"⦍"</span>,
<span class="linenr"> 8578: </span>  <span class=
"org-string">"ldrdhar;"</span>: <span class=
"org-string">"⥧"</span>,
<span class="linenr"> 8579: </span>  <span class=
"org-string">"LeftTee;"</span>: <span class=
"org-string">"⊣"</span>,
<span class="linenr"> 8580: </span>  <span class=
"org-string">"lesdoto;"</span>: <span class=
"org-string">"⪁"</span>,
<span class="linenr"> 8581: </span>  <span class=
"org-string">"lessdot;"</span>: <span class=
"org-string">"⋖"</span>,
<span class="linenr"> 8582: </span>  <span class=
"org-string">"lessgtr;"</span>: <span class=
"org-string">"≶"</span>,
<span class="linenr"> 8583: </span>  <span class=
"org-string">"lesssim;"</span>: <span class=
"org-string">"≲"</span>,
<span class="linenr"> 8584: </span>  <span class=
"org-string">"lotimes;"</span>: <span class=
"org-string">"⨴"</span>,
<span class="linenr"> 8585: </span>  <span class=
"org-string">"lozenge;"</span>: <span class=
"org-string">"◊"</span>,
<span class="linenr"> 8586: </span>  <span class=
"org-string">"ltquest;"</span>: <span class=
"org-string">"⩻"</span>,
<span class="linenr"> 8587: </span>  <span class=
"org-string">"luruhar;"</span>: <span class=
"org-string">"⥦"</span>,
<span class="linenr"> 8588: </span>  <span class=
"org-string">"maltese;"</span>: <span class=
"org-string">"✠"</span>,
<span class="linenr"> 8589: </span>  <span class=
"org-string">"minusdu;"</span>: <span class=
"org-string">"⨪"</span>,
<span class="linenr"> 8590: </span>  <span class=
"org-string">"napprox;"</span>: <span class=
"org-string">"≉"</span>,
<span class="linenr"> 8591: </span>  <span class=
"org-string">"natural;"</span>: <span class=
"org-string">"♮"</span>,
<span class="linenr"> 8592: </span>  <span class=
"org-string">"nearrow;"</span>: <span class=
"org-string">"↗"</span>,
<span class="linenr"> 8593: </span>  <span class=
"org-string">"NewLine;"</span>: <span class=
"org-string">"\n"</span>,
<span class="linenr"> 8594: </span>  <span class=
"org-string">"nexists;"</span>: <span class=
"org-string">"∄"</span>,
<span class="linenr"> 8595: </span>  <span class=
"org-string">"NoBreak;"</span>: <span class=
"org-string">"⁠"</span>,
<span class="linenr"> 8596: </span>  <span class=
"org-string">"notinva;"</span>: <span class=
"org-string">"∉"</span>,
<span class="linenr"> 8597: </span>  <span class=
"org-string">"notinvb;"</span>: <span class=
"org-string">"⋷"</span>,
<span class="linenr"> 8598: </span>  <span class=
"org-string">"notinvc;"</span>: <span class=
"org-string">"⋶"</span>,
<span class="linenr"> 8599: </span>  <span class=
"org-string">"NotLess;"</span>: <span class=
"org-string">"≮"</span>,
<span class="linenr"> 8600: </span>  <span class=
"org-string">"notniva;"</span>: <span class=
"org-string">"∌"</span>,
<span class="linenr"> 8601: </span>  <span class=
"org-string">"notnivb;"</span>: <span class=
"org-string">"⋾"</span>,
<span class="linenr"> 8602: </span>  <span class=
"org-string">"notnivc;"</span>: <span class=
"org-string">"⋽"</span>,
<span class="linenr"> 8603: </span>  <span class=
"org-string">"npolint;"</span>: <span class=
"org-string">"⨔"</span>,
<span class="linenr"> 8604: </span>  <span class=
"org-string">"npreceq;"</span>: <span class=
"org-string">"⪯̸"</span>,
<span class="linenr"> 8605: </span>  <span class=
"org-string">"nsqsube;"</span>: <span class=
"org-string">"⋢"</span>,
<span class="linenr"> 8606: </span>  <span class=
"org-string">"nsqsupe;"</span>: <span class=
"org-string">"⋣"</span>,
<span class="linenr"> 8607: </span>  <span class=
"org-string">"nsubset;"</span>: <span class=
"org-string">"⊂⃒"</span>,
<span class="linenr"> 8608: </span>  <span class=
"org-string">"nsucceq;"</span>: <span class=
"org-string">"⪰̸"</span>,
<span class="linenr"> 8609: </span>  <span class=
"org-string">"nsupset;"</span>: <span class=
"org-string">"⊃⃒"</span>,
<span class="linenr"> 8610: </span>  <span class=
"org-string">"nvinfin;"</span>: <span class=
"org-string">"⧞"</span>,
<span class="linenr"> 8611: </span>  <span class=
"org-string">"nvltrie;"</span>: <span class=
"org-string">"⊴⃒"</span>,
<span class="linenr"> 8612: </span>  <span class=
"org-string">"nvrtrie;"</span>: <span class=
"org-string">"⊵⃒"</span>,
<span class="linenr"> 8613: </span>  <span class=
"org-string">"nwarrow;"</span>: <span class=
"org-string">"↖"</span>,
<span class="linenr"> 8614: </span>  <span class=
"org-string">"olcross;"</span>: <span class=
"org-string">"⦻"</span>,
<span class="linenr"> 8615: </span>  <span class=
"org-string">"Omicron;"</span>: <span class=
"org-string">"Ο"</span>,
<span class="linenr"> 8616: </span>  <span class=
"org-string">"omicron;"</span>: <span class=
"org-string">"ο"</span>,
<span class="linenr"> 8617: </span>  <span class=
"org-string">"orderof;"</span>: <span class=
"org-string">"ℴ"</span>,
<span class="linenr"> 8618: </span>  <span class=
"org-string">"orslope;"</span>: <span class=
"org-string">"⩗"</span>,
<span class="linenr"> 8619: </span>  <span class=
"org-string">"OverBar;"</span>: <span class=
"org-string">"‾"</span>,
<span class="linenr"> 8620: </span>  <span class=
"org-string">"pertenk;"</span>: <span class=
"org-string">"‱"</span>,
<span class="linenr"> 8621: </span>  <span class=
"org-string">"planckh;"</span>: <span class=
"org-string">"ℎ"</span>,
<span class="linenr"> 8622: </span>  <span class=
"org-string">"pluscir;"</span>: <span class=
"org-string">"⨢"</span>,
<span class="linenr"> 8623: </span>  <span class=
"org-string">"plussim;"</span>: <span class=
"org-string">"⨦"</span>,
<span class="linenr"> 8624: </span>  <span class=
"org-string">"plustwo;"</span>: <span class=
"org-string">"⨧"</span>,
<span class="linenr"> 8625: </span>  <span class=
"org-string">"precsim;"</span>: <span class=
"org-string">"≾"</span>,
<span class="linenr"> 8626: </span>  <span class=
"org-string">"Product;"</span>: <span class=
"org-string">"∏"</span>,
<span class="linenr"> 8627: </span>  <span class=
"org-string">"quatint;"</span>: <span class=
"org-string">"⨖"</span>,
<span class="linenr"> 8628: </span>  <span class=
"org-string">"questeq;"</span>: <span class=
"org-string">"≟"</span>,
<span class="linenr"> 8629: </span>  <span class=
"org-string">"rarrbfs;"</span>: <span class=
"org-string">"⤠"</span>,
<span class="linenr"> 8630: </span>  <span class=
"org-string">"rarrsim;"</span>: <span class=
"org-string">"⥴"</span>,
<span class="linenr"> 8631: </span>  <span class=
"org-string">"rbrksld;"</span>: <span class=
"org-string">"⦎"</span>,
<span class="linenr"> 8632: </span>  <span class=
"org-string">"rbrkslu;"</span>: <span class=
"org-string">"⦐"</span>,
<span class="linenr"> 8633: </span>  <span class=
"org-string">"rdldhar;"</span>: <span class=
"org-string">"⥩"</span>,
<span class="linenr"> 8634: </span>  <span class=
"org-string">"realine;"</span>: <span class=
"org-string">"ℛ"</span>,
<span class="linenr"> 8635: </span>  <span class=
"org-string">"rotimes;"</span>: <span class=
"org-string">"⨵"</span>,
<span class="linenr"> 8636: </span>  <span class=
"org-string">"ruluhar;"</span>: <span class=
"org-string">"⥨"</span>,
<span class="linenr"> 8637: </span>  <span class=
"org-string">"searrow;"</span>: <span class=
"org-string">"↘"</span>,
<span class="linenr"> 8638: </span>  <span class=
"org-string">"simplus;"</span>: <span class=
"org-string">"⨤"</span>,
<span class="linenr"> 8639: </span>  <span class=
"org-string">"simrarr;"</span>: <span class=
"org-string">"⥲"</span>,
<span class="linenr"> 8640: </span>  <span class=
"org-string">"subedot;"</span>: <span class=
"org-string">"⫃"</span>,
<span class="linenr"> 8641: </span>  <span class=
"org-string">"submult;"</span>: <span class=
"org-string">"⫁"</span>,
<span class="linenr"> 8642: </span>  <span class=
"org-string">"subplus;"</span>: <span class=
"org-string">"⪿"</span>,
<span class="linenr"> 8643: </span>  <span class=
"org-string">"subrarr;"</span>: <span class=
"org-string">"⥹"</span>,
<span class="linenr"> 8644: </span>  <span class=
"org-string">"succsim;"</span>: <span class=
"org-string">"≿"</span>,
<span class="linenr"> 8645: </span>  <span class=
"org-string">"supdsub;"</span>: <span class=
"org-string">"⫘"</span>,
<span class="linenr"> 8646: </span>  <span class=
"org-string">"supedot;"</span>: <span class=
"org-string">"⫄"</span>,
<span class="linenr"> 8647: </span>  <span class=
"org-string">"suphsol;"</span>: <span class=
"org-string">"⟉"</span>,
<span class="linenr"> 8648: </span>  <span class=
"org-string">"suphsub;"</span>: <span class=
"org-string">"⫗"</span>,
<span class="linenr"> 8649: </span>  <span class=
"org-string">"suplarr;"</span>: <span class=
"org-string">"⥻"</span>,
<span class="linenr"> 8650: </span>  <span class=
"org-string">"supmult;"</span>: <span class=
"org-string">"⫂"</span>,
<span class="linenr"> 8651: </span>  <span class=
"org-string">"supplus;"</span>: <span class=
"org-string">"⫀"</span>,
<span class="linenr"> 8652: </span>  <span class=
"org-string">"swarrow;"</span>: <span class=
"org-string">"↙"</span>,
<span class="linenr"> 8653: </span>  <span class=
"org-string">"topfork;"</span>: <span class=
"org-string">"⫚"</span>,
<span class="linenr"> 8654: </span>  <span class=
"org-string">"triplus;"</span>: <span class=
"org-string">"⨹"</span>,
<span class="linenr"> 8655: </span>  <span class=
"org-string">"tritime;"</span>: <span class=
"org-string">"⨻"</span>,
<span class="linenr"> 8656: </span>  <span class=
"org-string">"UpArrow;"</span>: <span class=
"org-string">"↑"</span>,
<span class="linenr"> 8657: </span>  <span class=
"org-string">"Uparrow;"</span>: <span class=
"org-string">"⇑"</span>,
<span class="linenr"> 8658: </span>  <span class=
"org-string">"uparrow;"</span>: <span class=
"org-string">"↑"</span>,
<span class="linenr"> 8659: </span>  <span class=
"org-string">"Upsilon;"</span>: <span class=
"org-string">"Υ"</span>,
<span class="linenr"> 8660: </span>  <span class=
"org-string">"upsilon;"</span>: <span class=
"org-string">"υ"</span>,
<span class="linenr"> 8661: </span>  <span class=
"org-string">"uwangle;"</span>: <span class=
"org-string">"⦧"</span>,
<span class="linenr"> 8662: </span>  <span class=
"org-string">"vzigzag;"</span>: <span class=
"org-string">"⦚"</span>,
<span class="linenr"> 8663: </span>  <span class=
"org-string">"zigrarr;"</span>: <span class=
"org-string">"⇝"</span>,
<span class="linenr"> 8664: </span>  <span class=
"org-string">"andslope;"</span>: <span class=
"org-string">"⩘"</span>,
<span class="linenr"> 8665: </span>  <span class=
"org-string">"angmsdaa;"</span>: <span class=
"org-string">"⦨"</span>,
<span class="linenr"> 8666: </span>  <span class=
"org-string">"angmsdab;"</span>: <span class=
"org-string">"⦩"</span>,
<span class="linenr"> 8667: </span>  <span class=
"org-string">"angmsdac;"</span>: <span class=
"org-string">"⦪"</span>,
<span class="linenr"> 8668: </span>  <span class=
"org-string">"angmsdad;"</span>: <span class=
"org-string">"⦫"</span>,
<span class="linenr"> 8669: </span>  <span class=
"org-string">"angmsdae;"</span>: <span class=
"org-string">"⦬"</span>,
<span class="linenr"> 8670: </span>  <span class=
"org-string">"angmsdaf;"</span>: <span class=
"org-string">"⦭"</span>,
<span class="linenr"> 8671: </span>  <span class=
"org-string">"angmsdag;"</span>: <span class=
"org-string">"⦮"</span>,
<span class="linenr"> 8672: </span>  <span class=
"org-string">"angmsdah;"</span>: <span class=
"org-string">"⦯"</span>,
<span class="linenr"> 8673: </span>  <span class=
"org-string">"angrtvbd;"</span>: <span class=
"org-string">"⦝"</span>,
<span class="linenr"> 8674: </span>  <span class=
"org-string">"approxeq;"</span>: <span class=
"org-string">"≊"</span>,
<span class="linenr"> 8675: </span>  <span class=
"org-string">"awconint;"</span>: <span class=
"org-string">"∳"</span>,
<span class="linenr"> 8676: </span>  <span class=
"org-string">"backcong;"</span>: <span class=
"org-string">"≌"</span>,
<span class="linenr"> 8677: </span>  <span class=
"org-string">"barwedge;"</span>: <span class=
"org-string">"⌅"</span>,
<span class="linenr"> 8678: </span>  <span class=
"org-string">"bbrktbrk;"</span>: <span class=
"org-string">"⎶"</span>,
<span class="linenr"> 8679: </span>  <span class=
"org-string">"bigoplus;"</span>: <span class=
"org-string">"⨁"</span>,
<span class="linenr"> 8680: </span>  <span class=
"org-string">"bigsqcup;"</span>: <span class=
"org-string">"⨆"</span>,
<span class="linenr"> 8681: </span>  <span class=
"org-string">"biguplus;"</span>: <span class=
"org-string">"⨄"</span>,
<span class="linenr"> 8682: </span>  <span class=
"org-string">"bigwedge;"</span>: <span class=
"org-string">"⋀"</span>,
<span class="linenr"> 8683: </span>  <span class=
"org-string">"boxminus;"</span>: <span class=
"org-string">"⊟"</span>,
<span class="linenr"> 8684: </span>  <span class=
"org-string">"boxtimes;"</span>: <span class=
"org-string">"⊠"</span>,
<span class="linenr"> 8685: </span>  <span class=
"org-string">"bsolhsub;"</span>: <span class=
"org-string">"⟈"</span>,
<span class="linenr"> 8686: </span>  <span class=
"org-string">"capbrcup;"</span>: <span class=
"org-string">"⩉"</span>,
<span class="linenr"> 8687: </span>  <span class=
"org-string">"circledR;"</span>: <span class=
"org-string">"®"</span>,
<span class="linenr"> 8688: </span>  <span class=
"org-string">"circledS;"</span>: <span class=
"org-string">"Ⓢ"</span>,
<span class="linenr"> 8689: </span>  <span class=
"org-string">"cirfnint;"</span>: <span class=
"org-string">"⨐"</span>,
<span class="linenr"> 8690: </span>  <span class=
"org-string">"clubsuit;"</span>: <span class=
"org-string">"♣"</span>,
<span class="linenr"> 8691: </span>  <span class=
"org-string">"cupbrcap;"</span>: <span class=
"org-string">"⩈"</span>,
<span class="linenr"> 8692: </span>  <span class=
"org-string">"curlyvee;"</span>: <span class=
"org-string">"⋎"</span>,
<span class="linenr"> 8693: </span>  <span class=
"org-string">"cwconint;"</span>: <span class=
"org-string">"∲"</span>,
<span class="linenr"> 8694: </span>  <span class=
"org-string">"DDotrahd;"</span>: <span class=
"org-string">"⤑"</span>,
<span class="linenr"> 8695: </span>  <span class=
"org-string">"doteqdot;"</span>: <span class=
"org-string">"≑"</span>,
<span class="linenr"> 8696: </span>  <span class=
"org-string">"DotEqual;"</span>: <span class=
"org-string">"≐"</span>,
<span class="linenr"> 8697: </span>  <span class=
"org-string">"dotminus;"</span>: <span class=
"org-string">"∸"</span>,
<span class="linenr"> 8698: </span>  <span class=
"org-string">"drbkarow;"</span>: <span class=
"org-string">"⤐"</span>,
<span class="linenr"> 8699: </span>  <span class=
"org-string">"dzigrarr;"</span>: <span class=
"org-string">"⟿"</span>,
<span class="linenr"> 8700: </span>  <span class=
"org-string">"elinters;"</span>: <span class=
"org-string">"⏧"</span>,
<span class="linenr"> 8701: </span>  <span class=
"org-string">"emptyset;"</span>: <span class=
"org-string">"∅"</span>,
<span class="linenr"> 8702: </span>  <span class=
"org-string">"eqvparsl;"</span>: <span class=
"org-string">"⧥"</span>,
<span class="linenr"> 8703: </span>  <span class=
"org-string">"fpartint;"</span>: <span class=
"org-string">"⨍"</span>,
<span class="linenr"> 8704: </span>  <span class=
"org-string">"geqslant;"</span>: <span class=
"org-string">"⩾"</span>,
<span class="linenr"> 8705: </span>  <span class=
"org-string">"gesdotol;"</span>: <span class=
"org-string">"⪄"</span>,
<span class="linenr"> 8706: </span>  <span class=
"org-string">"gnapprox;"</span>: <span class=
"org-string">"⪊"</span>,
<span class="linenr"> 8707: </span>  <span class=
"org-string">"hksearow;"</span>: <span class=
"org-string">"⤥"</span>,
<span class="linenr"> 8708: </span>  <span class=
"org-string">"hkswarow;"</span>: <span class=
"org-string">"⤦"</span>,
<span class="linenr"> 8709: </span>  <span class=
"org-string">"imagline;"</span>: <span class=
"org-string">"ℐ"</span>,
<span class="linenr"> 8710: </span>  <span class=
"org-string">"imagpart;"</span>: <span class=
"org-string">"ℑ"</span>,
<span class="linenr"> 8711: </span>  <span class=
"org-string">"infintie;"</span>: <span class=
"org-string">"⧝"</span>,
<span class="linenr"> 8712: </span>  <span class=
"org-string">"integers;"</span>: <span class=
"org-string">"ℤ"</span>,
<span class="linenr"> 8713: </span>  <span class=
"org-string">"Integral;"</span>: <span class=
"org-string">"∫"</span>,
<span class="linenr"> 8714: </span>  <span class=
"org-string">"intercal;"</span>: <span class=
"org-string">"⊺"</span>,
<span class="linenr"> 8715: </span>  <span class=
"org-string">"intlarhk;"</span>: <span class=
"org-string">"⨗"</span>,
<span class="linenr"> 8716: </span>  <span class=
"org-string">"laemptyv;"</span>: <span class=
"org-string">"⦴"</span>,
<span class="linenr"> 8717: </span>  <span class=
"org-string">"ldrushar;"</span>: <span class=
"org-string">"⥋"</span>,
<span class="linenr"> 8718: </span>  <span class=
"org-string">"leqslant;"</span>: <span class=
"org-string">"⩽"</span>,
<span class="linenr"> 8719: </span>  <span class=
"org-string">"lesdotor;"</span>: <span class=
"org-string">"⪃"</span>,
<span class="linenr"> 8720: </span>  <span class=
"org-string">"LessLess;"</span>: <span class=
"org-string">"⪡"</span>,
<span class="linenr"> 8721: </span>  <span class=
"org-string">"llcorner;"</span>: <span class=
"org-string">"⌞"</span>,
<span class="linenr"> 8722: </span>  <span class=
"org-string">"lnapprox;"</span>: <span class=
"org-string">"⪉"</span>,
<span class="linenr"> 8723: </span>  <span class=
"org-string">"lrcorner;"</span>: <span class=
"org-string">"⌟"</span>,
<span class="linenr"> 8724: </span>  <span class=
"org-string">"lurdshar;"</span>: <span class=
"org-string">"⥊"</span>,
<span class="linenr"> 8725: </span>  <span class=
"org-string">"mapstoup;"</span>: <span class=
"org-string">"↥"</span>,
<span class="linenr"> 8726: </span>  <span class=
"org-string">"multimap;"</span>: <span class=
"org-string">"⊸"</span>,
<span class="linenr"> 8727: </span>  <span class=
"org-string">"naturals;"</span>: <span class=
"org-string">"ℕ"</span>,
<span class="linenr"> 8728: </span>  <span class=
"org-string">"ncongdot;"</span>: <span class=
"org-string">"⩭̸"</span>,
<span class="linenr"> 8729: </span>  <span class=
"org-string">"NotEqual;"</span>: <span class=
"org-string">"≠"</span>,
<span class="linenr"> 8730: </span>  <span class=
"org-string">"notindot;"</span>: <span class=
"org-string">"⋵̸"</span>,
<span class="linenr"> 8731: </span>  <span class=
"org-string">"NotTilde;"</span>: <span class=
"org-string">"≁"</span>,
<span class="linenr"> 8732: </span>  <span class=
"org-string">"otimesas;"</span>: <span class=
"org-string">"⨶"</span>,
<span class="linenr"> 8733: </span>  <span class=
"org-string">"parallel;"</span>: <span class=
"org-string">"∥"</span>,
<span class="linenr"> 8734: </span>  <span class=
"org-string">"PartialD;"</span>: <span class=
"org-string">"∂"</span>,
<span class="linenr"> 8735: </span>  <span class=
"org-string">"plusacir;"</span>: <span class=
"org-string">"⨣"</span>,
<span class="linenr"> 8736: </span>  <span class=
"org-string">"pointint;"</span>: <span class=
"org-string">"⨕"</span>,
<span class="linenr"> 8737: </span>  <span class=
"org-string">"Precedes;"</span>: <span class=
"org-string">"≺"</span>,
<span class="linenr"> 8738: </span>  <span class=
"org-string">"precneqq;"</span>: <span class=
"org-string">"⪵"</span>,
<span class="linenr"> 8739: </span>  <span class=
"org-string">"precnsim;"</span>: <span class=
"org-string">"⋨"</span>,
<span class="linenr"> 8740: </span>  <span class=
"org-string">"profalar;"</span>: <span class=
"org-string">"⌮"</span>,
<span class="linenr"> 8741: </span>  <span class=
"org-string">"profline;"</span>: <span class=
"org-string">"⌒"</span>,
<span class="linenr"> 8742: </span>  <span class=
"org-string">"profsurf;"</span>: <span class=
"org-string">"⌓"</span>,
<span class="linenr"> 8743: </span>  <span class=
"org-string">"raemptyv;"</span>: <span class=
"org-string">"⦳"</span>,
<span class="linenr"> 8744: </span>  <span class=
"org-string">"realpart;"</span>: <span class=
"org-string">"ℜ"</span>,
<span class="linenr"> 8745: </span>  <span class=
"org-string">"RightTee;"</span>: <span class=
"org-string">"⊢"</span>,
<span class="linenr"> 8746: </span>  <span class=
"org-string">"rppolint;"</span>: <span class=
"org-string">"⨒"</span>,
<span class="linenr"> 8747: </span>  <span class=
"org-string">"rtriltri;"</span>: <span class=
"org-string">"⧎"</span>,
<span class="linenr"> 8748: </span>  <span class=
"org-string">"scpolint;"</span>: <span class=
"org-string">"⨓"</span>,
<span class="linenr"> 8749: </span>  <span class=
"org-string">"setminus;"</span>: <span class=
"org-string">"∖"</span>,
<span class="linenr"> 8750: </span>  <span class=
"org-string">"shortmid;"</span>: <span class=
"org-string">"∣"</span>,
<span class="linenr"> 8751: </span>  <span class=
"org-string">"smeparsl;"</span>: <span class=
"org-string">"⧤"</span>,
<span class="linenr"> 8752: </span>  <span class=
"org-string">"sqsubset;"</span>: <span class=
"org-string">"⊏"</span>,
<span class="linenr"> 8753: </span>  <span class=
"org-string">"sqsupset;"</span>: <span class=
"org-string">"⊐"</span>,
<span class="linenr"> 8754: </span>  <span class=
"org-string">"subseteq;"</span>: <span class=
"org-string">"⊆"</span>,
<span class="linenr"> 8755: </span>  <span class=
"org-string">"Succeeds;"</span>: <span class=
"org-string">"≻"</span>,
<span class="linenr"> 8756: </span>  <span class=
"org-string">"succneqq;"</span>: <span class=
"org-string">"⪶"</span>,
<span class="linenr"> 8757: </span>  <span class=
"org-string">"succnsim;"</span>: <span class=
"org-string">"⋩"</span>,
<span class="linenr"> 8758: </span>  <span class=
"org-string">"SuchThat;"</span>: <span class=
"org-string">"∋"</span>,
<span class="linenr"> 8759: </span>  <span class=
"org-string">"Superset;"</span>: <span class=
"org-string">"⊃"</span>,
<span class="linenr"> 8760: </span>  <span class=
"org-string">"supseteq;"</span>: <span class=
"org-string">"⊇"</span>,
<span class="linenr"> 8761: </span>  <span class=
"org-string">"thetasym;"</span>: <span class=
"org-string">"ϑ"</span>,
<span class="linenr"> 8762: </span>  <span class=
"org-string">"thicksim;"</span>: <span class=
"org-string">"∼"</span>,
<span class="linenr"> 8763: </span>  <span class=
"org-string">"timesbar;"</span>: <span class=
"org-string">"⨱"</span>,
<span class="linenr"> 8764: </span>  <span class=
"org-string">"triangle;"</span>: <span class=
"org-string">"▵"</span>,
<span class="linenr"> 8765: </span>  <span class=
"org-string">"triminus;"</span>: <span class=
"org-string">"⨺"</span>,
<span class="linenr"> 8766: </span>  <span class=
"org-string">"trpezium;"</span>: <span class=
"org-string">"⏢"</span>,
<span class="linenr"> 8767: </span>  <span class=
"org-string">"Uarrocir;"</span>: <span class=
"org-string">"⥉"</span>,
<span class="linenr"> 8768: </span>  <span class=
"org-string">"ulcorner;"</span>: <span class=
"org-string">"⌜"</span>,
<span class="linenr"> 8769: </span>  <span class=
"org-string">"UnderBar;"</span>: <span class=
"org-string">"_"</span>,
<span class="linenr"> 8770: </span>  <span class=
"org-string">"urcorner;"</span>: <span class=
"org-string">"⌝"</span>,
<span class="linenr"> 8771: </span>  <span class=
"org-string">"varkappa;"</span>: <span class=
"org-string">"ϰ"</span>,
<span class="linenr"> 8772: </span>  <span class=
"org-string">"varsigma;"</span>: <span class=
"org-string">"ς"</span>,
<span class="linenr"> 8773: </span>  <span class=
"org-string">"vartheta;"</span>: <span class=
"org-string">"ϑ"</span>,
<span class="linenr"> 8774: </span>  <span class=
"org-string">"backprime;"</span>: <span class=
"org-string">"‵"</span>,
<span class="linenr"> 8775: </span>  <span class=
"org-string">"backsimeq;"</span>: <span class=
"org-string">"⋍"</span>,
<span class="linenr"> 8776: </span>  <span class=
"org-string">"Backslash;"</span>: <span class=
"org-string">"∖"</span>,
<span class="linenr"> 8777: </span>  <span class=
"org-string">"bigotimes;"</span>: <span class=
"org-string">"⨂"</span>,
<span class="linenr"> 8778: </span>  <span class=
"org-string">"CenterDot;"</span>: <span class=
"org-string">"·"</span>,
<span class="linenr"> 8779: </span>  <span class=
"org-string">"centerdot;"</span>: <span class=
"org-string">"·"</span>,
<span class="linenr"> 8780: </span>  <span class=
"org-string">"checkmark;"</span>: <span class=
"org-string">"✓"</span>,
<span class="linenr"> 8781: </span>  <span class=
"org-string">"CircleDot;"</span>: <span class=
"org-string">"⊙"</span>,
<span class="linenr"> 8782: </span>  <span class=
"org-string">"complexes;"</span>: <span class=
"org-string">"ℂ"</span>,
<span class="linenr"> 8783: </span>  <span class=
"org-string">"Congruent;"</span>: <span class=
"org-string">"≡"</span>,
<span class="linenr"> 8784: </span>  <span class=
"org-string">"Coproduct;"</span>: <span class=
"org-string">"∐"</span>,
<span class="linenr"> 8785: </span>  <span class=
"org-string">"dotsquare;"</span>: <span class=
"org-string">"⊡"</span>,
<span class="linenr"> 8786: </span>  <span class=
"org-string">"DoubleDot;"</span>: <span class=
"org-string">"¨"</span>,
<span class="linenr"> 8787: </span>  <span class=
"org-string">"DownArrow;"</span>: <span class=
"org-string">"↓"</span>,
<span class="linenr"> 8788: </span>  <span class=
"org-string">"Downarrow;"</span>: <span class=
"org-string">"⇓"</span>,
<span class="linenr"> 8789: </span>  <span class=
"org-string">"downarrow;"</span>: <span class=
"org-string">"↓"</span>,
<span class="linenr"> 8790: </span>  <span class=
"org-string">"DownBreve;"</span>: <span class=
"org-string">"̑"</span>,
<span class="linenr"> 8791: </span>  <span class=
"org-string">"gtrapprox;"</span>: <span class=
"org-string">"⪆"</span>,
<span class="linenr"> 8792: </span>  <span class=
"org-string">"gtreqless;"</span>: <span class=
"org-string">"⋛"</span>,
<span class="linenr"> 8793: </span>  <span class=
"org-string">"gvertneqq;"</span>: <span class=
"org-string">"≩︀"</span>,
<span class="linenr"> 8794: </span>  <span class=
"org-string">"heartsuit;"</span>: <span class=
"org-string">"♥"</span>,
<span class="linenr"> 8795: </span>  <span class=
"org-string">"HumpEqual;"</span>: <span class=
"org-string">"≏"</span>,
<span class="linenr"> 8796: </span>  <span class=
"org-string">"LeftArrow;"</span>: <span class=
"org-string">"←"</span>,
<span class="linenr"> 8797: </span>  <span class=
"org-string">"Leftarrow;"</span>: <span class=
"org-string">"⇐"</span>,
<span class="linenr"> 8798: </span>  <span class=
"org-string">"leftarrow;"</span>: <span class=
"org-string">"←"</span>,
<span class="linenr"> 8799: </span>  <span class=
"org-string">"LeftFloor;"</span>: <span class=
"org-string">"⌊"</span>,
<span class="linenr"> 8800: </span>  <span class=
"org-string">"lesseqgtr;"</span>: <span class=
"org-string">"⋚"</span>,
<span class="linenr"> 8801: </span>  <span class=
"org-string">"LessTilde;"</span>: <span class=
"org-string">"≲"</span>,
<span class="linenr"> 8802: </span>  <span class=
"org-string">"lvertneqq;"</span>: <span class=
"org-string">"≨︀"</span>,
<span class="linenr"> 8803: </span>  <span class=
"org-string">"Mellintrf;"</span>: <span class=
"org-string">"ℳ"</span>,
<span class="linenr"> 8804: </span>  <span class=
"org-string">"MinusPlus;"</span>: <span class=
"org-string">"∓"</span>,
<span class="linenr"> 8805: </span>  <span class=
"org-string">"ngeqslant;"</span>: <span class=
"org-string">"⩾̸"</span>,
<span class="linenr"> 8806: </span>  <span class=
"org-string">"nleqslant;"</span>: <span class=
"org-string">"⩽̸"</span>,
<span class="linenr"> 8807: </span>  <span class=
"org-string">"NotCupCap;"</span>: <span class=
"org-string">"≭"</span>,
<span class="linenr"> 8808: </span>  <span class=
"org-string">"NotExists;"</span>: <span class=
"org-string">"∄"</span>,
<span class="linenr"> 8809: </span>  <span class=
"org-string">"NotSubset;"</span>: <span class=
"org-string">"⊂⃒"</span>,
<span class="linenr"> 8810: </span>  <span class=
"org-string">"nparallel;"</span>: <span class=
"org-string">"∦"</span>,
<span class="linenr"> 8811: </span>  <span class=
"org-string">"nshortmid;"</span>: <span class=
"org-string">"∤"</span>,
<span class="linenr"> 8812: </span>  <span class=
"org-string">"nsubseteq;"</span>: <span class=
"org-string">"⊈"</span>,
<span class="linenr"> 8813: </span>  <span class=
"org-string">"nsupseteq;"</span>: <span class=
"org-string">"⊉"</span>,
<span class="linenr"> 8814: </span>  <span class=
"org-string">"OverBrace;"</span>: <span class=
"org-string">"⏞"</span>,
<span class="linenr"> 8815: </span>  <span class=
"org-string">"pitchfork;"</span>: <span class=
"org-string">"⋔"</span>,
<span class="linenr"> 8816: </span>  <span class=
"org-string">"PlusMinus;"</span>: <span class=
"org-string">"±"</span>,
<span class="linenr"> 8817: </span>  <span class=
"org-string">"rationals;"</span>: <span class=
"org-string">"ℚ"</span>,
<span class="linenr"> 8818: </span>  <span class=
"org-string">"spadesuit;"</span>: <span class=
"org-string">"♠"</span>,
<span class="linenr"> 8819: </span>  <span class=
"org-string">"subseteqq;"</span>: <span class=
"org-string">"⫅"</span>,
<span class="linenr"> 8820: </span>  <span class=
"org-string">"subsetneq;"</span>: <span class=
"org-string">"⊊"</span>,
<span class="linenr"> 8821: </span>  <span class=
"org-string">"supseteqq;"</span>: <span class=
"org-string">"⫆"</span>,
<span class="linenr"> 8822: </span>  <span class=
"org-string">"supsetneq;"</span>: <span class=
"org-string">"⊋"</span>,
<span class="linenr"> 8823: </span>  <span class=
"org-string">"Therefore;"</span>: <span class=
"org-string">"∴"</span>,
<span class="linenr"> 8824: </span>  <span class=
"org-string">"therefore;"</span>: <span class=
"org-string">"∴"</span>,
<span class="linenr"> 8825: </span>  <span class=
"org-string">"ThinSpace;"</span>: <span class=
"org-string">" "</span>,
<span class="linenr"> 8826: </span>  <span class=
"org-string">"triangleq;"</span>: <span class=
"org-string">"≜"</span>,
<span class="linenr"> 8827: </span>  <span class=
"org-string">"TripleDot;"</span>: <span class=
"org-string">"⃛"</span>,
<span class="linenr"> 8828: </span>  <span class=
"org-string">"UnionPlus;"</span>: <span class=
"org-string">"⊎"</span>,
<span class="linenr"> 8829: </span>  <span class=
"org-string">"varpropto;"</span>: <span class=
"org-string">"∝"</span>,
<span class="linenr"> 8830: </span>  <span class=
"org-string">"Bernoullis;"</span>: <span class=
"org-string">"ℬ"</span>,
<span class="linenr"> 8831: </span>  <span class=
"org-string">"circledast;"</span>: <span class=
"org-string">"⊛"</span>,
<span class="linenr"> 8832: </span>  <span class=
"org-string">"CirclePlus;"</span>: <span class=
"org-string">"⊕"</span>,
<span class="linenr"> 8833: </span>  <span class=
"org-string">"complement;"</span>: <span class=
"org-string">"∁"</span>,
<span class="linenr"> 8834: </span>  <span class=
"org-string">"curlywedge;"</span>: <span class=
"org-string">"⋏"</span>,
<span class="linenr"> 8835: </span>  <span class=
"org-string">"eqslantgtr;"</span>: <span class=
"org-string">"⪖"</span>,
<span class="linenr"> 8836: </span>  <span class=
"org-string">"EqualTilde;"</span>: <span class=
"org-string">"≂"</span>,
<span class="linenr"> 8837: </span>  <span class=
"org-string">"Fouriertrf;"</span>: <span class=
"org-string">"ℱ"</span>,
<span class="linenr"> 8838: </span>  <span class=
"org-string">"gtreqqless;"</span>: <span class=
"org-string">"⪌"</span>,
<span class="linenr"> 8839: </span>  <span class=
"org-string">"ImaginaryI;"</span>: <span class=
"org-string">"ⅈ"</span>,
<span class="linenr"> 8840: </span>  <span class=
"org-string">"Laplacetrf;"</span>: <span class=
"org-string">"ℒ"</span>,
<span class="linenr"> 8841: </span>  <span class=
"org-string">"LeftVector;"</span>: <span class=
"org-string">"↼"</span>,
<span class="linenr"> 8842: </span>  <span class=
"org-string">"lessapprox;"</span>: <span class=
"org-string">"⪅"</span>,
<span class="linenr"> 8843: </span>  <span class=
"org-string">"lesseqqgtr;"</span>: <span class=
"org-string">"⪋"</span>,
<span class="linenr"> 8844: </span>  <span class=
"org-string">"Lleftarrow;"</span>: <span class=
"org-string">"⇚"</span>,
<span class="linenr"> 8845: </span>  <span class=
"org-string">"lmoustache;"</span>: <span class=
"org-string">"⎰"</span>,
<span class="linenr"> 8846: </span>  <span class=
"org-string">"longmapsto;"</span>: <span class=
"org-string">"⟼"</span>,
<span class="linenr"> 8847: </span>  <span class=
"org-string">"mapstodown;"</span>: <span class=
"org-string">"↧"</span>,
<span class="linenr"> 8848: </span>  <span class=
"org-string">"mapstoleft;"</span>: <span class=
"org-string">"↤"</span>,
<span class="linenr"> 8849: </span>  <span class=
"org-string">"nLeftarrow;"</span>: <span class=
"org-string">"⇍"</span>,
<span class="linenr"> 8850: </span>  <span class=
"org-string">"nleftarrow;"</span>: <span class=
"org-string">"↚"</span>,
<span class="linenr"> 8851: </span>  <span class=
"org-string">"NotElement;"</span>: <span class=
"org-string">"∉"</span>,
<span class="linenr"> 8852: </span>  <span class=
"org-string">"NotGreater;"</span>: <span class=
"org-string">"≯"</span>,
<span class="linenr"> 8853: </span>  <span class=
"org-string">"nsubseteqq;"</span>: <span class=
"org-string">"⫅̸"</span>,
<span class="linenr"> 8854: </span>  <span class=
"org-string">"nsupseteqq;"</span>: <span class=
"org-string">"⫆̸"</span>,
<span class="linenr"> 8855: </span>  <span class=
"org-string">"precapprox;"</span>: <span class=
"org-string">"⪷"</span>,
<span class="linenr"> 8856: </span>  <span class=
"org-string">"Proportion;"</span>: <span class=
"org-string">"∷"</span>,
<span class="linenr"> 8857: </span>  <span class=
"org-string">"RightArrow;"</span>: <span class=
"org-string">"→"</span>,
<span class="linenr"> 8858: </span>  <span class=
"org-string">"Rightarrow;"</span>: <span class=
"org-string">"⇒"</span>,
<span class="linenr"> 8859: </span>  <span class=
"org-string">"rightarrow;"</span>: <span class=
"org-string">"→"</span>,
<span class="linenr"> 8860: </span>  <span class=
"org-string">"RightFloor;"</span>: <span class=
"org-string">"⌋"</span>,
<span class="linenr"> 8861: </span>  <span class=
"org-string">"rmoustache;"</span>: <span class=
"org-string">"⎱"</span>,
<span class="linenr"> 8862: </span>  <span class=
"org-string">"sqsubseteq;"</span>: <span class=
"org-string">"⊑"</span>,
<span class="linenr"> 8863: </span>  <span class=
"org-string">"sqsupseteq;"</span>: <span class=
"org-string">"⊒"</span>,
<span class="linenr"> 8864: </span>  <span class=
"org-string">"subsetneqq;"</span>: <span class=
"org-string">"⫋"</span>,
<span class="linenr"> 8865: </span>  <span class=
"org-string">"succapprox;"</span>: <span class=
"org-string">"⪸"</span>,
<span class="linenr"> 8866: </span>  <span class=
"org-string">"supsetneqq;"</span>: <span class=
"org-string">"⫌"</span>,
<span class="linenr"> 8867: </span>  <span class=
"org-string">"ThickSpace;"</span>: <span class=
"org-string">"  "</span>,
<span class="linenr"> 8868: </span>  <span class=
"org-string">"TildeEqual;"</span>: <span class=
"org-string">"≃"</span>,
<span class="linenr"> 8869: </span>  <span class=
"org-string">"TildeTilde;"</span>: <span class=
"org-string">"≈"</span>,
<span class="linenr"> 8870: </span>  <span class=
"org-string">"UnderBrace;"</span>: <span class=
"org-string">"⏟"</span>,
<span class="linenr"> 8871: </span>  <span class=
"org-string">"UpArrowBar;"</span>: <span class=
"org-string">"⤒"</span>,
<span class="linenr"> 8872: </span>  <span class=
"org-string">"UpTeeArrow;"</span>: <span class=
"org-string">"↥"</span>,
<span class="linenr"> 8873: </span>  <span class=
"org-string">"upuparrows;"</span>: <span class=
"org-string">"⇈"</span>,
<span class="linenr"> 8874: </span>  <span class=
"org-string">"varepsilon;"</span>: <span class=
"org-string">"ϵ"</span>,
<span class="linenr"> 8875: </span>  <span class=
"org-string">"varnothing;"</span>: <span class=
"org-string">"∅"</span>,
<span class="linenr"> 8876: </span>  <span class=
"org-string">"backepsilon;"</span>: <span class=
"org-string">"϶"</span>,
<span class="linenr"> 8877: </span>  <span class=
"org-string">"blacksquare;"</span>: <span class=
"org-string">"▪"</span>,
<span class="linenr"> 8878: </span>  <span class=
"org-string">"circledcirc;"</span>: <span class=
"org-string">"⊚"</span>,
<span class="linenr"> 8879: </span>  <span class=
"org-string">"circleddash;"</span>: <span class=
"org-string">"⊝"</span>,
<span class="linenr"> 8880: </span>  <span class=
"org-string">"CircleMinus;"</span>: <span class=
"org-string">"⊖"</span>,
<span class="linenr"> 8881: </span>  <span class=
"org-string">"CircleTimes;"</span>: <span class=
"org-string">"⊗"</span>,
<span class="linenr"> 8882: </span>  <span class=
"org-string">"curlyeqprec;"</span>: <span class=
"org-string">"⋞"</span>,
<span class="linenr"> 8883: </span>  <span class=
"org-string">"curlyeqsucc;"</span>: <span class=
"org-string">"⋟"</span>,
<span class="linenr"> 8884: </span>  <span class=
"org-string">"diamondsuit;"</span>: <span class=
"org-string">"♦"</span>,
<span class="linenr"> 8885: </span>  <span class=
"org-string">"eqslantless;"</span>: <span class=
"org-string">"⪕"</span>,
<span class="linenr"> 8886: </span>  <span class=
"org-string">"Equilibrium;"</span>: <span class=
"org-string">"⇌"</span>,
<span class="linenr"> 8887: </span>  <span class=
"org-string">"expectation;"</span>: <span class=
"org-string">"ℰ"</span>,
<span class="linenr"> 8888: </span>  <span class=
"org-string">"GreaterLess;"</span>: <span class=
"org-string">"≷"</span>,
<span class="linenr"> 8889: </span>  <span class=
"org-string">"LeftCeiling;"</span>: <span class=
"org-string">"⌈"</span>,
<span class="linenr"> 8890: </span>  <span class=
"org-string">"LessGreater;"</span>: <span class=
"org-string">"≶"</span>,
<span class="linenr"> 8891: </span>  <span class=
"org-string">"MediumSpace;"</span>: <span class=
"org-string">" "</span>,
<span class="linenr"> 8892: </span>  <span class=
"org-string">"NotLessLess;"</span>: <span class=
"org-string">"≪̸"</span>,
<span class="linenr"> 8893: </span>  <span class=
"org-string">"NotPrecedes;"</span>: <span class=
"org-string">"⊀"</span>,
<span class="linenr"> 8894: </span>  <span class=
"org-string">"NotSucceeds;"</span>: <span class=
"org-string">"⊁"</span>,
<span class="linenr"> 8895: </span>  <span class=
"org-string">"NotSuperset;"</span>: <span class=
"org-string">"⊃⃒"</span>,
<span class="linenr"> 8896: </span>  <span class=
"org-string">"nRightarrow;"</span>: <span class=
"org-string">"⇏"</span>,
<span class="linenr"> 8897: </span>  <span class=
"org-string">"nrightarrow;"</span>: <span class=
"org-string">"↛"</span>,
<span class="linenr"> 8898: </span>  <span class=
"org-string">"OverBracket;"</span>: <span class=
"org-string">"⎴"</span>,
<span class="linenr"> 8899: </span>  <span class=
"org-string">"preccurlyeq;"</span>: <span class=
"org-string">"≼"</span>,
<span class="linenr"> 8900: </span>  <span class=
"org-string">"precnapprox;"</span>: <span class=
"org-string">"⪹"</span>,
<span class="linenr"> 8901: </span>  <span class=
"org-string">"quaternions;"</span>: <span class=
"org-string">"ℍ"</span>,
<span class="linenr"> 8902: </span>  <span class=
"org-string">"RightVector;"</span>: <span class=
"org-string">"⇀"</span>,
<span class="linenr"> 8903: </span>  <span class=
"org-string">"Rrightarrow;"</span>: <span class=
"org-string">"⇛"</span>,
<span class="linenr"> 8904: </span>  <span class=
"org-string">"RuleDelayed;"</span>: <span class=
"org-string">"⧴"</span>,
<span class="linenr"> 8905: </span>  <span class=
"org-string">"SmallCircle;"</span>: <span class=
"org-string">"∘"</span>,
<span class="linenr"> 8906: </span>  <span class=
"org-string">"SquareUnion;"</span>: <span class=
"org-string">"⊔"</span>,
<span class="linenr"> 8907: </span>  <span class=
"org-string">"straightphi;"</span>: <span class=
"org-string">"ϕ"</span>,
<span class="linenr"> 8908: </span>  <span class=
"org-string">"SubsetEqual;"</span>: <span class=
"org-string">"⊆"</span>,
<span class="linenr"> 8909: </span>  <span class=
"org-string">"succcurlyeq;"</span>: <span class=
"org-string">"≽"</span>,
<span class="linenr"> 8910: </span>  <span class=
"org-string">"succnapprox;"</span>: <span class=
"org-string">"⪺"</span>,
<span class="linenr"> 8911: </span>  <span class=
"org-string">"thickapprox;"</span>: <span class=
"org-string">"≈"</span>,
<span class="linenr"> 8912: </span>  <span class=
"org-string">"UpDownArrow;"</span>: <span class=
"org-string">"↕"</span>,
<span class="linenr"> 8913: </span>  <span class=
"org-string">"Updownarrow;"</span>: <span class=
"org-string">"⇕"</span>,
<span class="linenr"> 8914: </span>  <span class=
"org-string">"updownarrow;"</span>: <span class=
"org-string">"↕"</span>,
<span class="linenr"> 8915: </span>  <span class=
"org-string">"VerticalBar;"</span>: <span class=
"org-string">"∣"</span>,
<span class="linenr"> 8916: </span>  <span class=
"org-string">"blacklozenge;"</span>: <span class=
"org-string">"⧫"</span>,
<span class="linenr"> 8917: </span>  <span class=
"org-string">"DownArrowBar;"</span>: <span class=
"org-string">"⤓"</span>,
<span class="linenr"> 8918: </span>  <span class=
"org-string">"DownTeeArrow;"</span>: <span class=
"org-string">"↧"</span>,
<span class="linenr"> 8919: </span>  <span class=
"org-string">"ExponentialE;"</span>: <span class=
"org-string">"ⅇ"</span>,
<span class="linenr"> 8920: </span>  <span class=
"org-string">"exponentiale;"</span>: <span class=
"org-string">"ⅇ"</span>,
<span class="linenr"> 8921: </span>  <span class=
"org-string">"GreaterEqual;"</span>: <span class=
"org-string">"≥"</span>,
<span class="linenr"> 8922: </span>  <span class=
"org-string">"GreaterTilde;"</span>: <span class=
"org-string">"≳"</span>,
<span class="linenr"> 8923: </span>  <span class=
"org-string">"HilbertSpace;"</span>: <span class=
"org-string">"ℋ"</span>,
<span class="linenr"> 8924: </span>  <span class=
"org-string">"HumpDownHump;"</span>: <span class=
"org-string">"≎"</span>,
<span class="linenr"> 8925: </span>  <span class=
"org-string">"Intersection;"</span>: <span class=
"org-string">"⋂"</span>,
<span class="linenr"> 8926: </span>  <span class=
"org-string">"LeftArrowBar;"</span>: <span class=
"org-string">"⇤"</span>,
<span class="linenr"> 8927: </span>  <span class=
"org-string">"LeftTeeArrow;"</span>: <span class=
"org-string">"↤"</span>,
<span class="linenr"> 8928: </span>  <span class=
"org-string">"LeftTriangle;"</span>: <span class=
"org-string">"⊲"</span>,
<span class="linenr"> 8929: </span>  <span class=
"org-string">"LeftUpVector;"</span>: <span class=
"org-string">"↿"</span>,
<span class="linenr"> 8930: </span>  <span class=
"org-string">"NotCongruent;"</span>: <span class=
"org-string">"≢"</span>,
<span class="linenr"> 8931: </span>  <span class=
"org-string">"NotHumpEqual;"</span>: <span class=
"org-string">"≏̸"</span>,
<span class="linenr"> 8932: </span>  <span class=
"org-string">"NotLessEqual;"</span>: <span class=
"org-string">"≰"</span>,
<span class="linenr"> 8933: </span>  <span class=
"org-string">"NotLessTilde;"</span>: <span class=
"org-string">"≴"</span>,
<span class="linenr"> 8934: </span>  <span class=
"org-string">"Proportional;"</span>: <span class=
"org-string">"∝"</span>,
<span class="linenr"> 8935: </span>  <span class=
"org-string">"RightCeiling;"</span>: <span class=
"org-string">"⌉"</span>,
<span class="linenr"> 8936: </span>  <span class=
"org-string">"risingdotseq;"</span>: <span class=
"org-string">"≓"</span>,
<span class="linenr"> 8937: </span>  <span class=
"org-string">"RoundImplies;"</span>: <span class=
"org-string">"⥰"</span>,
<span class="linenr"> 8938: </span>  <span class=
"org-string">"ShortUpArrow;"</span>: <span class=
"org-string">"↑"</span>,
<span class="linenr"> 8939: </span>  <span class=
"org-string">"SquareSubset;"</span>: <span class=
"org-string">"⊏"</span>,
<span class="linenr"> 8940: </span>  <span class=
"org-string">"triangledown;"</span>: <span class=
"org-string">"▿"</span>,
<span class="linenr"> 8941: </span>  <span class=
"org-string">"triangleleft;"</span>: <span class=
"org-string">"◃"</span>,
<span class="linenr"> 8942: </span>  <span class=
"org-string">"UnderBracket;"</span>: <span class=
"org-string">"⎵"</span>,
<span class="linenr"> 8943: </span>  <span class=
"org-string">"varsubsetneq;"</span>: <span class=
"org-string">"⊊︀"</span>,
<span class="linenr"> 8944: </span>  <span class=
"org-string">"varsupsetneq;"</span>: <span class=
"org-string">"⊋︀"</span>,
<span class="linenr"> 8945: </span>  <span class=
"org-string">"VerticalLine;"</span>: <span class=
"org-string">"|"</span>,
<span class="linenr"> 8946: </span>  <span class=
"org-string">"ApplyFunction;"</span>: <span class=
"org-string">"⁡"</span>,
<span class="linenr"> 8947: </span>  <span class=
"org-string">"bigtriangleup;"</span>: <span class=
"org-string">"△"</span>,
<span class="linenr"> 8948: </span>  <span class=
"org-string">"blacktriangle;"</span>: <span class=
"org-string">"▴"</span>,
<span class="linenr"> 8949: </span>  <span class=
"org-string">"DifferentialD;"</span>: <span class=
"org-string">"ⅆ"</span>,
<span class="linenr"> 8950: </span>  <span class=
"org-string">"divideontimes;"</span>: <span class=
"org-string">"⋇"</span>,
<span class="linenr"> 8951: </span>  <span class=
"org-string">"DoubleLeftTee;"</span>: <span class=
"org-string">"⫤"</span>,
<span class="linenr"> 8952: </span>  <span class=
"org-string">"DoubleUpArrow;"</span>: <span class=
"org-string">"⇑"</span>,
<span class="linenr"> 8953: </span>  <span class=
"org-string">"fallingdotseq;"</span>: <span class=
"org-string">"≒"</span>,
<span class="linenr"> 8954: </span>  <span class=
"org-string">"hookleftarrow;"</span>: <span class=
"org-string">"↩"</span>,
<span class="linenr"> 8955: </span>  <span class=
"org-string">"leftarrowtail;"</span>: <span class=
"org-string">"↢"</span>,
<span class="linenr"> 8956: </span>  <span class=
"org-string">"leftharpoonup;"</span>: <span class=
"org-string">"↼"</span>,
<span class="linenr"> 8957: </span>  <span class=
"org-string">"LeftTeeVector;"</span>: <span class=
"org-string">"⥚"</span>,
<span class="linenr"> 8958: </span>  <span class=
"org-string">"LeftVectorBar;"</span>: <span class=
"org-string">"⥒"</span>,
<span class="linenr"> 8959: </span>  <span class=
"org-string">"LessFullEqual;"</span>: <span class=
"org-string">"≦"</span>,
<span class="linenr"> 8960: </span>  <span class=
"org-string">"LongLeftArrow;"</span>: <span class=
"org-string">"⟵"</span>,
<span class="linenr"> 8961: </span>  <span class=
"org-string">"Longleftarrow;"</span>: <span class=
"org-string">"⟸"</span>,
<span class="linenr"> 8962: </span>  <span class=
"org-string">"longleftarrow;"</span>: <span class=
"org-string">"⟵"</span>,
<span class="linenr"> 8963: </span>  <span class=
"org-string">"looparrowleft;"</span>: <span class=
"org-string">"↫"</span>,
<span class="linenr"> 8964: </span>  <span class=
"org-string">"measuredangle;"</span>: <span class=
"org-string">"∡"</span>,
<span class="linenr"> 8965: </span>  <span class=
"org-string">"NotEqualTilde;"</span>: <span class=
"org-string">"≂̸"</span>,
<span class="linenr"> 8966: </span>  <span class=
"org-string">"NotTildeEqual;"</span>: <span class=
"org-string">"≄"</span>,
<span class="linenr"> 8967: </span>  <span class=
"org-string">"NotTildeTilde;"</span>: <span class=
"org-string">"≉"</span>,
<span class="linenr"> 8968: </span>  <span class=
"org-string">"ntriangleleft;"</span>: <span class=
"org-string">"⋪"</span>,
<span class="linenr"> 8969: </span>  <span class=
"org-string">"Poincareplane;"</span>: <span class=
"org-string">"ℌ"</span>,
<span class="linenr"> 8970: </span>  <span class=
"org-string">"PrecedesEqual;"</span>: <span class=
"org-string">"⪯"</span>,
<span class="linenr"> 8971: </span>  <span class=
"org-string">"PrecedesTilde;"</span>: <span class=
"org-string">"≾"</span>,
<span class="linenr"> 8972: </span>  <span class=
"org-string">"RightArrowBar;"</span>: <span class=
"org-string">"⇥"</span>,
<span class="linenr"> 8973: </span>  <span class=
"org-string">"RightTeeArrow;"</span>: <span class=
"org-string">"↦"</span>,
<span class="linenr"> 8974: </span>  <span class=
"org-string">"RightTriangle;"</span>: <span class=
"org-string">"⊳"</span>,
<span class="linenr"> 8975: </span>  <span class=
"org-string">"RightUpVector;"</span>: <span class=
"org-string">"↾"</span>,
<span class="linenr"> 8976: </span>  <span class=
"org-string">"shortparallel;"</span>: <span class=
"org-string">"∥"</span>,
<span class="linenr"> 8977: </span>  <span class=
"org-string">"smallsetminus;"</span>: <span class=
"org-string">"∖"</span>,
<span class="linenr"> 8978: </span>  <span class=
"org-string">"SucceedsEqual;"</span>: <span class=
"org-string">"⪰"</span>,
<span class="linenr"> 8979: </span>  <span class=
"org-string">"SucceedsTilde;"</span>: <span class=
"org-string">"≿"</span>,
<span class="linenr"> 8980: </span>  <span class=
"org-string">"SupersetEqual;"</span>: <span class=
"org-string">"⊇"</span>,
<span class="linenr"> 8981: </span>  <span class=
"org-string">"triangleright;"</span>: <span class=
"org-string">"▹"</span>,
<span class="linenr"> 8982: </span>  <span class=
"org-string">"UpEquilibrium;"</span>: <span class=
"org-string">"⥮"</span>,
<span class="linenr"> 8983: </span>  <span class=
"org-string">"upharpoonleft;"</span>: <span class=
"org-string">"↿"</span>,
<span class="linenr"> 8984: </span>  <span class=
"org-string">"varsubsetneqq;"</span>: <span class=
"org-string">"⫋︀"</span>,
<span class="linenr"> 8985: </span>  <span class=
"org-string">"varsupsetneqq;"</span>: <span class=
"org-string">"⫌︀"</span>,
<span class="linenr"> 8986: </span>  <span class=
"org-string">"VerticalTilde;"</span>: <span class=
"org-string">"≀"</span>,
<span class="linenr"> 8987: </span>  <span class=
"org-string">"VeryThinSpace;"</span>: <span class=
"org-string">" "</span>,
<span class="linenr"> 8988: </span>  <span class=
"org-string">"curvearrowleft;"</span>: <span class=
"org-string">"↶"</span>,
<span class="linenr"> 8989: </span>  <span class=
"org-string">"DiacriticalDot;"</span>: <span class=
"org-string">"˙"</span>,
<span class="linenr"> 8990: </span>  <span class=
"org-string">"doublebarwedge;"</span>: <span class=
"org-string">"⌆"</span>,
<span class="linenr"> 8991: </span>  <span class=
"org-string">"DoubleRightTee;"</span>: <span class=
"org-string">"⊨"</span>,
<span class="linenr"> 8992: </span>  <span class=
"org-string">"downdownarrows;"</span>: <span class=
"org-string">"⇊"</span>,
<span class="linenr"> 8993: </span>  <span class=
"org-string">"DownLeftVector;"</span>: <span class=
"org-string">"↽"</span>,
<span class="linenr"> 8994: </span>  <span class=
"org-string">"GreaterGreater;"</span>: <span class=
"org-string">"⪢"</span>,
<span class="linenr"> 8995: </span>  <span class=
"org-string">"hookrightarrow;"</span>: <span class=
"org-string">"↪"</span>,
<span class="linenr"> 8996: </span>  <span class=
"org-string">"HorizontalLine;"</span>: <span class=
"org-string">"─"</span>,
<span class="linenr"> 8997: </span>  <span class=
"org-string">"InvisibleComma;"</span>: <span class=
"org-string">"⁣"</span>,
<span class="linenr"> 8998: </span>  <span class=
"org-string">"InvisibleTimes;"</span>: <span class=
"org-string">"⁢"</span>,
<span class="linenr"> 8999: </span>  <span class=
"org-string">"LeftDownVector;"</span>: <span class=
"org-string">"⇃"</span>,
<span class="linenr"> 9000: </span>  <span class=
"org-string">"leftleftarrows;"</span>: <span class=
"org-string">"⇇"</span>,
<span class="linenr"> 9001: </span>  <span class=
"org-string">"LeftRightArrow;"</span>: <span class=
"org-string">"↔"</span>,
<span class="linenr"> 9002: </span>  <span class=
"org-string">"Leftrightarrow;"</span>: <span class=
"org-string">"⇔"</span>,
<span class="linenr"> 9003: </span>  <span class=
"org-string">"leftrightarrow;"</span>: <span class=
"org-string">"↔"</span>,
<span class="linenr"> 9004: </span>  <span class=
"org-string">"leftthreetimes;"</span>: <span class=
"org-string">"⋋"</span>,
<span class="linenr"> 9005: </span>  <span class=
"org-string">"LessSlantEqual;"</span>: <span class=
"org-string">"⩽"</span>,
<span class="linenr"> 9006: </span>  <span class=
"org-string">"LongRightArrow;"</span>: <span class=
"org-string">"⟶"</span>,
<span class="linenr"> 9007: </span>  <span class=
"org-string">"Longrightarrow;"</span>: <span class=
"org-string">"⟹"</span>,
<span class="linenr"> 9008: </span>  <span class=
"org-string">"longrightarrow;"</span>: <span class=
"org-string">"⟶"</span>,
<span class="linenr"> 9009: </span>  <span class=
"org-string">"looparrowright;"</span>: <span class=
"org-string">"↬"</span>,
<span class="linenr"> 9010: </span>  <span class=
"org-string">"LowerLeftArrow;"</span>: <span class=
"org-string">"↙"</span>,
<span class="linenr"> 9011: </span>  <span class=
"org-string">"NestedLessLess;"</span>: <span class=
"org-string">"≪"</span>,
<span class="linenr"> 9012: </span>  <span class=
"org-string">"NotGreaterLess;"</span>: <span class=
"org-string">"≹"</span>,
<span class="linenr"> 9013: </span>  <span class=
"org-string">"NotLessGreater;"</span>: <span class=
"org-string">"≸"</span>,
<span class="linenr"> 9014: </span>  <span class=
"org-string">"NotSubsetEqual;"</span>: <span class=
"org-string">"⊈"</span>,
<span class="linenr"> 9015: </span>  <span class=
"org-string">"NotVerticalBar;"</span>: <span class=
"org-string">"∤"</span>,
<span class="linenr"> 9016: </span>  <span class=
"org-string">"nshortparallel;"</span>: <span class=
"org-string">"∦"</span>,
<span class="linenr"> 9017: </span>  <span class=
"org-string">"ntriangleright;"</span>: <span class=
"org-string">"⋫"</span>,
<span class="linenr"> 9018: </span>  <span class=
"org-string">"OpenCurlyQuote;"</span>: <span class=
"org-string">"‘"</span>,
<span class="linenr"> 9019: </span>  <span class=
"org-string">"ReverseElement;"</span>: <span class=
"org-string">"∋"</span>,
<span class="linenr"> 9020: </span>  <span class=
"org-string">"rightarrowtail;"</span>: <span class=
"org-string">"↣"</span>,
<span class="linenr"> 9021: </span>  <span class=
"org-string">"rightharpoonup;"</span>: <span class=
"org-string">"⇀"</span>,
<span class="linenr"> 9022: </span>  <span class=
"org-string">"RightTeeVector;"</span>: <span class=
"org-string">"⥛"</span>,
<span class="linenr"> 9023: </span>  <span class=
"org-string">"RightVectorBar;"</span>: <span class=
"org-string">"⥓"</span>,
<span class="linenr"> 9024: </span>  <span class=
"org-string">"ShortDownArrow;"</span>: <span class=
"org-string">"↓"</span>,
<span class="linenr"> 9025: </span>  <span class=
"org-string">"ShortLeftArrow;"</span>: <span class=
"org-string">"←"</span>,
<span class="linenr"> 9026: </span>  <span class=
"org-string">"SquareSuperset;"</span>: <span class=
"org-string">"⊐"</span>,
<span class="linenr"> 9027: </span>  <span class=
"org-string">"TildeFullEqual;"</span>: <span class=
"org-string">"≅"</span>,
<span class="linenr"> 9028: </span>  <span class=
"org-string">"trianglelefteq;"</span>: <span class=
"org-string">"⊴"</span>,
<span class="linenr"> 9029: </span>  <span class=
"org-string">"upharpoonright;"</span>: <span class=
"org-string">"↾"</span>,
<span class="linenr"> 9030: </span>  <span class=
"org-string">"UpperLeftArrow;"</span>: <span class=
"org-string">"↖"</span>,
<span class="linenr"> 9031: </span>  <span class=
"org-string">"ZeroWidthSpace;"</span>: <span class=
"org-string">"​"</span>,
<span class="linenr"> 9032: </span>  <span class=
"org-string">"bigtriangledown;"</span>: <span class=
"org-string">"▽"</span>,
<span class="linenr"> 9033: </span>  <span class=
"org-string">"circlearrowleft;"</span>: <span class=
"org-string">"↺"</span>,
<span class="linenr"> 9034: </span>  <span class=
"org-string">"CloseCurlyQuote;"</span>: <span class=
"org-string">"’"</span>,
<span class="linenr"> 9035: </span>  <span class=
"org-string">"ContourIntegral;"</span>: <span class=
"org-string">"∮"</span>,
<span class="linenr"> 9036: </span>  <span class=
"org-string">"curvearrowright;"</span>: <span class=
"org-string">"↷"</span>,
<span class="linenr"> 9037: </span>  <span class=
"org-string">"DoubleDownArrow;"</span>: <span class=
"org-string">"⇓"</span>,
<span class="linenr"> 9038: </span>  <span class=
"org-string">"DoubleLeftArrow;"</span>: <span class=
"org-string">"⇐"</span>,
<span class="linenr"> 9039: </span>  <span class=
"org-string">"downharpoonleft;"</span>: <span class=
"org-string">"⇃"</span>,
<span class="linenr"> 9040: </span>  <span class=
"org-string">"DownRightVector;"</span>: <span class=
"org-string">"⇁"</span>,
<span class="linenr"> 9041: </span>  <span class=
"org-string">"leftharpoondown;"</span>: <span class=
"org-string">"↽"</span>,
<span class="linenr"> 9042: </span>  <span class=
"org-string">"leftrightarrows;"</span>: <span class=
"org-string">"⇆"</span>,
<span class="linenr"> 9043: </span>  <span class=
"org-string">"LeftRightVector;"</span>: <span class=
"org-string">"⥎"</span>,
<span class="linenr"> 9044: </span>  <span class=
"org-string">"LeftTriangleBar;"</span>: <span class=
"org-string">"⧏"</span>,
<span class="linenr"> 9045: </span>  <span class=
"org-string">"LeftUpTeeVector;"</span>: <span class=
"org-string">"⥠"</span>,
<span class="linenr"> 9046: </span>  <span class=
"org-string">"LeftUpVectorBar;"</span>: <span class=
"org-string">"⥘"</span>,
<span class="linenr"> 9047: </span>  <span class=
"org-string">"LowerRightArrow;"</span>: <span class=
"org-string">"↘"</span>,
<span class="linenr"> 9048: </span>  <span class=
"org-string">"nLeftrightarrow;"</span>: <span class=
"org-string">"⇎"</span>,
<span class="linenr"> 9049: </span>  <span class=
"org-string">"nleftrightarrow;"</span>: <span class=
"org-string">"↮"</span>,
<span class="linenr"> 9050: </span>  <span class=
"org-string">"NotGreaterEqual;"</span>: <span class=
"org-string">"≱"</span>,
<span class="linenr"> 9051: </span>  <span class=
"org-string">"NotGreaterTilde;"</span>: <span class=
"org-string">"≵"</span>,
<span class="linenr"> 9052: </span>  <span class=
"org-string">"NotHumpDownHump;"</span>: <span class=
"org-string">"≎̸"</span>,
<span class="linenr"> 9053: </span>  <span class=
"org-string">"NotLeftTriangle;"</span>: <span class=
"org-string">"⋪"</span>,
<span class="linenr"> 9054: </span>  <span class=
"org-string">"NotSquareSubset;"</span>: <span class=
"org-string">"⊏̸"</span>,
<span class="linenr"> 9055: </span>  <span class=
"org-string">"ntrianglelefteq;"</span>: <span class=
"org-string">"⋬"</span>,
<span class="linenr"> 9056: </span>  <span class=
"org-string">"OverParenthesis;"</span>: <span class=
"org-string">"⏜"</span>,
<span class="linenr"> 9057: </span>  <span class=
"org-string">"RightDownVector;"</span>: <span class=
"org-string">"⇂"</span>,
<span class="linenr"> 9058: </span>  <span class=
"org-string">"rightleftarrows;"</span>: <span class=
"org-string">"⇄"</span>,
<span class="linenr"> 9059: </span>  <span class=
"org-string">"rightsquigarrow;"</span>: <span class=
"org-string">"↝"</span>,
<span class="linenr"> 9060: </span>  <span class=
"org-string">"rightthreetimes;"</span>: <span class=
"org-string">"⋌"</span>,
<span class="linenr"> 9061: </span>  <span class=
"org-string">"ShortRightArrow;"</span>: <span class=
"org-string">"→"</span>,
<span class="linenr"> 9062: </span>  <span class=
"org-string">"straightepsilon;"</span>: <span class=
"org-string">"ϵ"</span>,
<span class="linenr"> 9063: </span>  <span class=
"org-string">"trianglerighteq;"</span>: <span class=
"org-string">"⊵"</span>,
<span class="linenr"> 9064: </span>  <span class=
"org-string">"UpperRightArrow;"</span>: <span class=
"org-string">"↗"</span>,
<span class="linenr"> 9065: </span>  <span class=
"org-string">"vartriangleleft;"</span>: <span class=
"org-string">"⊲"</span>,
<span class="linenr"> 9066: </span>  <span class=
"org-string">"circlearrowright;"</span>: <span class=
"org-string">"↻"</span>,
<span class="linenr"> 9067: </span>  <span class=
"org-string">"DiacriticalAcute;"</span>: <span class=
"org-string">"´"</span>,
<span class="linenr"> 9068: </span>  <span class=
"org-string">"DiacriticalGrave;"</span>: <span class=
"org-string">"`"</span>,
<span class="linenr"> 9069: </span>  <span class=
"org-string">"DiacriticalTilde;"</span>: <span class=
"org-string">"˜"</span>,
<span class="linenr"> 9070: </span>  <span class=
"org-string">"DoubleRightArrow;"</span>: <span class=
"org-string">"⇒"</span>,
<span class="linenr"> 9071: </span>  <span class=
"org-string">"DownArrowUpArrow;"</span>: <span class=
"org-string">"⇵"</span>,
<span class="linenr"> 9072: </span>  <span class=
"org-string">"downharpoonright;"</span>: <span class=
"org-string">"⇂"</span>,
<span class="linenr"> 9073: </span>  <span class=
"org-string">"EmptySmallSquare;"</span>: <span class=
"org-string">"◻"</span>,
<span class="linenr"> 9074: </span>  <span class=
"org-string">"GreaterEqualLess;"</span>: <span class=
"org-string">"⋛"</span>,
<span class="linenr"> 9075: </span>  <span class=
"org-string">"GreaterFullEqual;"</span>: <span class=
"org-string">"≧"</span>,
<span class="linenr"> 9076: </span>  <span class=
"org-string">"LeftAngleBracket;"</span>: <span class=
"org-string">"⟨"</span>,
<span class="linenr"> 9077: </span>  <span class=
"org-string">"LeftUpDownVector;"</span>: <span class=
"org-string">"⥑"</span>,
<span class="linenr"> 9078: </span>  <span class=
"org-string">"LessEqualGreater;"</span>: <span class=
"org-string">"⋚"</span>,
<span class="linenr"> 9079: </span>  <span class=
"org-string">"NonBreakingSpace;"</span>: <span class=
"org-string">" "</span>,
<span class="linenr"> 9080: </span>  <span class=
"org-string">"NotPrecedesEqual;"</span>: <span class=
"org-string">"⪯̸"</span>,
<span class="linenr"> 9081: </span>  <span class=
"org-string">"NotRightTriangle;"</span>: <span class=
"org-string">"⋫"</span>,
<span class="linenr"> 9082: </span>  <span class=
"org-string">"NotSucceedsEqual;"</span>: <span class=
"org-string">"⪰̸"</span>,
<span class="linenr"> 9083: </span>  <span class=
"org-string">"NotSucceedsTilde;"</span>: <span class=
"org-string">"≿̸"</span>,
<span class="linenr"> 9084: </span>  <span class=
"org-string">"NotSupersetEqual;"</span>: <span class=
"org-string">"⊉"</span>,
<span class="linenr"> 9085: </span>  <span class=
"org-string">"ntrianglerighteq;"</span>: <span class=
"org-string">"⋭"</span>,
<span class="linenr"> 9086: </span>  <span class=
"org-string">"rightharpoondown;"</span>: <span class=
"org-string">"⇁"</span>,
<span class="linenr"> 9087: </span>  <span class=
"org-string">"rightrightarrows;"</span>: <span class=
"org-string">"⇉"</span>,
<span class="linenr"> 9088: </span>  <span class=
"org-string">"RightTriangleBar;"</span>: <span class=
"org-string">"⧐"</span>,
<span class="linenr"> 9089: </span>  <span class=
"org-string">"RightUpTeeVector;"</span>: <span class=
"org-string">"⥜"</span>,
<span class="linenr"> 9090: </span>  <span class=
"org-string">"RightUpVectorBar;"</span>: <span class=
"org-string">"⥔"</span>,
<span class="linenr"> 9091: </span>  <span class=
"org-string">"twoheadleftarrow;"</span>: <span class=
"org-string">"↞"</span>,
<span class="linenr"> 9092: </span>  <span class=
"org-string">"UnderParenthesis;"</span>: <span class=
"org-string">"⏝"</span>,
<span class="linenr"> 9093: </span>  <span class=
"org-string">"UpArrowDownArrow;"</span>: <span class=
"org-string">"⇅"</span>,
<span class="linenr"> 9094: </span>  <span class=
"org-string">"vartriangleright;"</span>: <span class=
"org-string">"⊳"</span>,
<span class="linenr"> 9095: </span>  <span class=
"org-string">"blacktriangledown;"</span>: <span class=
"org-string">"▾"</span>,
<span class="linenr"> 9096: </span>  <span class=
"org-string">"blacktriangleleft;"</span>: <span class=
"org-string">"◂"</span>,
<span class="linenr"> 9097: </span>  <span class=
"org-string">"DoubleUpDownArrow;"</span>: <span class=
"org-string">"⇕"</span>,
<span class="linenr"> 9098: </span>  <span class=
"org-string">"DoubleVerticalBar;"</span>: <span class=
"org-string">"∥"</span>,
<span class="linenr"> 9099: </span>  <span class=
"org-string">"DownLeftTeeVector;"</span>: <span class=
"org-string">"⥞"</span>,
<span class="linenr"> 9100: </span>  <span class=
"org-string">"DownLeftVectorBar;"</span>: <span class=
"org-string">"⥖"</span>,
<span class="linenr"> 9101: </span>  <span class=
"org-string">"FilledSmallSquare;"</span>: <span class=
"org-string">"◼"</span>,
<span class="linenr"> 9102: </span>  <span class=
"org-string">"GreaterSlantEqual;"</span>: <span class=
"org-string">"⩾"</span>,
<span class="linenr"> 9103: </span>  <span class=
"org-string">"LeftDoubleBracket;"</span>: <span class=
"org-string">"⟦"</span>,
<span class="linenr"> 9104: </span>  <span class=
"org-string">"LeftDownTeeVector;"</span>: <span class=
"org-string">"⥡"</span>,
<span class="linenr"> 9105: </span>  <span class=
"org-string">"LeftDownVectorBar;"</span>: <span class=
"org-string">"⥙"</span>,
<span class="linenr"> 9106: </span>  <span class=
"org-string">"leftrightharpoons;"</span>: <span class=
"org-string">"⇋"</span>,
<span class="linenr"> 9107: </span>  <span class=
"org-string">"LeftTriangleEqual;"</span>: <span class=
"org-string">"⊴"</span>,
<span class="linenr"> 9108: </span>  <span class=
"org-string">"NegativeThinSpace;"</span>: <span class=
"org-string">"​"</span>,
<span class="linenr"> 9109: </span>  <span class=
"org-string">"NotGreaterGreater;"</span>: <span class=
"org-string">"≫̸"</span>,
<span class="linenr"> 9110: </span>  <span class=
"org-string">"NotLessSlantEqual;"</span>: <span class=
"org-string">"⩽̸"</span>,
<span class="linenr"> 9111: </span>  <span class=
"org-string">"NotNestedLessLess;"</span>: <span class=
"org-string">"⪡̸"</span>,
<span class="linenr"> 9112: </span>  <span class=
"org-string">"NotReverseElement;"</span>: <span class=
"org-string">"∌"</span>,
<span class="linenr"> 9113: </span>  <span class=
"org-string">"NotSquareSuperset;"</span>: <span class=
"org-string">"⊐̸"</span>,
<span class="linenr"> 9114: </span>  <span class=
"org-string">"NotTildeFullEqual;"</span>: <span class=
"org-string">"≇"</span>,
<span class="linenr"> 9115: </span>  <span class=
"org-string">"RightAngleBracket;"</span>: <span class=
"org-string">"⟩"</span>,
<span class="linenr"> 9116: </span>  <span class=
"org-string">"rightleftharpoons;"</span>: <span class=
"org-string">"⇌"</span>,
<span class="linenr"> 9117: </span>  <span class=
"org-string">"RightUpDownVector;"</span>: <span class=
"org-string">"⥏"</span>,
<span class="linenr"> 9118: </span>  <span class=
"org-string">"SquareSubsetEqual;"</span>: <span class=
"org-string">"⊑"</span>,
<span class="linenr"> 9119: </span>  <span class=
"org-string">"twoheadrightarrow;"</span>: <span class=
"org-string">"↠"</span>,
<span class="linenr"> 9120: </span>  <span class=
"org-string">"VerticalSeparator;"</span>: <span class=
"org-string">"❘"</span>,
<span class="linenr"> 9121: </span>  <span class=
"org-string">"blacktriangleright;"</span>: <span class=
"org-string">"▸"</span>,
<span class="linenr"> 9122: </span>  <span class=
"org-string">"DownRightTeeVector;"</span>: <span class=
"org-string">"⥟"</span>,
<span class="linenr"> 9123: </span>  <span class=
"org-string">"DownRightVectorBar;"</span>: <span class=
"org-string">"⥗"</span>,
<span class="linenr"> 9124: </span>  <span class=
"org-string">"LongLeftRightArrow;"</span>: <span class=
"org-string">"⟷"</span>,
<span class="linenr"> 9125: </span>  <span class=
"org-string">"Longleftrightarrow;"</span>: <span class=
"org-string">"⟺"</span>,
<span class="linenr"> 9126: </span>  <span class=
"org-string">"longleftrightarrow;"</span>: <span class=
"org-string">"⟷"</span>,
<span class="linenr"> 9127: </span>  <span class=
"org-string">"NegativeThickSpace;"</span>: <span class=
"org-string">"​"</span>,
<span class="linenr"> 9128: </span>  <span class=
"org-string">"NotLeftTriangleBar;"</span>: <span class=
"org-string">"⧏̸"</span>,
<span class="linenr"> 9129: </span>  <span class=
"org-string">"PrecedesSlantEqual;"</span>: <span class=
"org-string">"≼"</span>,
<span class="linenr"> 9130: </span>  <span class=
"org-string">"ReverseEquilibrium;"</span>: <span class=
"org-string">"⇋"</span>,
<span class="linenr"> 9131: </span>  <span class=
"org-string">"RightDoubleBracket;"</span>: <span class=
"org-string">"⟧"</span>,
<span class="linenr"> 9132: </span>  <span class=
"org-string">"RightDownTeeVector;"</span>: <span class=
"org-string">"⥝"</span>,
<span class="linenr"> 9133: </span>  <span class=
"org-string">"RightDownVectorBar;"</span>: <span class=
"org-string">"⥕"</span>,
<span class="linenr"> 9134: </span>  <span class=
"org-string">"RightTriangleEqual;"</span>: <span class=
"org-string">"⊵"</span>,
<span class="linenr"> 9135: </span>  <span class=
"org-string">"SquareIntersection;"</span>: <span class=
"org-string">"⊓"</span>,
<span class="linenr"> 9136: </span>  <span class=
"org-string">"SucceedsSlantEqual;"</span>: <span class=
"org-string">"≽"</span>,
<span class="linenr"> 9137: </span>  <span class=
"org-string">"DoubleLongLeftArrow;"</span>: <span class=
"org-string">"⟸"</span>,
<span class="linenr"> 9138: </span>  <span class=
"org-string">"DownLeftRightVector;"</span>: <span class=
"org-string">"⥐"</span>,
<span class="linenr"> 9139: </span>  <span class=
"org-string">"LeftArrowRightArrow;"</span>: <span class=
"org-string">"⇆"</span>,
<span class="linenr"> 9140: </span>  <span class=
"org-string">"leftrightsquigarrow;"</span>: <span class=
"org-string">"↭"</span>,
<span class="linenr"> 9141: </span>  <span class=
"org-string">"NegativeMediumSpace;"</span>: <span class=
"org-string">"​"</span>,
<span class="linenr"> 9142: </span>  <span class=
"org-string">"NotGreaterFullEqual;"</span>: <span class=
"org-string">"≧̸"</span>,
<span class="linenr"> 9143: </span>  <span class=
"org-string">"NotRightTriangleBar;"</span>: <span class=
"org-string">"⧐̸"</span>,
<span class="linenr"> 9144: </span>  <span class=
"org-string">"RightArrowLeftArrow;"</span>: <span class=
"org-string">"⇄"</span>,
<span class="linenr"> 9145: </span>  <span class=
"org-string">"SquareSupersetEqual;"</span>: <span class=
"org-string">"⊒"</span>,
<span class="linenr"> 9146: </span>  <span class=
"org-string">"CapitalDifferentialD;"</span>: <span class=
"org-string">"ⅅ"</span>,
<span class="linenr"> 9147: </span>  <span class=
"org-string">"DoubleLeftRightArrow;"</span>: <span class=
"org-string">"⇔"</span>,
<span class="linenr"> 9148: </span>  <span class=
"org-string">"DoubleLongRightArrow;"</span>: <span class=
"org-string">"⟹"</span>,
<span class="linenr"> 9149: </span>  <span class=
"org-string">"EmptyVerySmallSquare;"</span>: <span class=
"org-string">"▫"</span>,
<span class="linenr"> 9150: </span>  <span class=
"org-string">"NestedGreaterGreater;"</span>: <span class=
"org-string">"≫"</span>,
<span class="linenr"> 9151: </span>  <span class=
"org-string">"NotDoubleVerticalBar;"</span>: <span class=
"org-string">"∦"</span>,
<span class="linenr"> 9152: </span>  <span class=
"org-string">"NotGreaterSlantEqual;"</span>: <span class=
"org-string">"⩾̸"</span>,
<span class="linenr"> 9153: </span>  <span class=
"org-string">"NotLeftTriangleEqual;"</span>: <span class=
"org-string">"⋬"</span>,
<span class="linenr"> 9154: </span>  <span class=
"org-string">"NotSquareSubsetEqual;"</span>: <span class=
"org-string">"⋢"</span>,
<span class="linenr"> 9155: </span>  <span class=
"org-string">"OpenCurlyDoubleQuote;"</span>: <span class=
"org-string">"“"</span>,
<span class="linenr"> 9156: </span>  <span class=
"org-string">"ReverseUpEquilibrium;"</span>: <span class=
"org-string">"⥯"</span>,
<span class="linenr"> 9157: </span>  <span class=
"org-string">"CloseCurlyDoubleQuote;"</span>: <span class=
"org-string">"”"</span>,
<span class="linenr"> 9158: </span>  <span class=
"org-string">"DoubleContourIntegral;"</span>: <span class=
"org-string">"∯"</span>,
<span class="linenr"> 9159: </span>  <span class=
"org-string">"FilledVerySmallSquare;"</span>: <span class=
"org-string">"▪"</span>,
<span class="linenr"> 9160: </span>  <span class=
"org-string">"NegativeVeryThinSpace;"</span>: <span class=
"org-string">"​"</span>,
<span class="linenr"> 9161: </span>  <span class=
"org-string">"NotPrecedesSlantEqual;"</span>: <span class=
"org-string">"⋠"</span>,
<span class="linenr"> 9162: </span>  <span class=
"org-string">"NotRightTriangleEqual;"</span>: <span class=
"org-string">"⋭"</span>,
<span class="linenr"> 9163: </span>  <span class=
"org-string">"NotSucceedsSlantEqual;"</span>: <span class=
"org-string">"⋡"</span>,
<span class="linenr"> 9164: </span>  <span class=
"org-string">"DiacriticalDoubleAcute;"</span>: <span class=
"org-string">"˝"</span>,
<span class="linenr"> 9165: </span>  <span class=
"org-string">"NotSquareSupersetEqual;"</span>: <span class=
"org-string">"⋣"</span>,
<span class="linenr"> 9166: </span>  <span class=
"org-string">"NotNestedGreaterGreater;"</span>: <span class=
"org-string">"⪢̸"</span>,
<span class="linenr"> 9167: </span>  <span class=
"org-string">"ClockwiseContourIntegral;"</span>: <span class=
"org-string">"∲"</span>,
<span class="linenr"> 9168: </span>  <span class=
"org-string">"DoubleLongLeftRightArrow;"</span>: <span class=
"org-string">"⟺"</span>,
<span class="linenr"> 9169: </span>  <span class=
"org-string">"CounterClockwiseContourIntegral;"</span>: <span class="org-string">"∳"</span>
<span class="linenr"> 9170: </span>}
<span class="linenr"> 9171: </span>
<span class="linenr"> 9172: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">decodeHtml</span> = (rawText, asAttr) =&gt; {
<span class="linenr"> 9173: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">offset</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 9174: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">end</span> = rawText.length
<span class="linenr"> 9175: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">decodedText</span> = <span class=
"org-string">''</span>
<span class="linenr"> 9176: </span>
<span class="linenr"> 9177: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">advance</span>(<span class=
"org-variable-name">length</span>) {
<span class="linenr"> 9178: </span>    offset += length
<span class=
"linenr"> 9179: </span>    rawText = rawText.slice(length)
<span class="linenr"> 9180: </span>  }
<span class="linenr"> 9181: </span>
<span class="linenr"> 9182: </span>  <span class=
"org-keyword">while</span> (offset &lt; end) {
<span class="linenr"> 9183: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">head</span> = <span class=
"org-string">/&amp;(?:#x?)?/</span>i.exec(rawText)
<span class="linenr"> 9184: </span>    <span class=
"org-keyword">if</span> (!head || offset + head.index &gt;= end) {
<span class="linenr"> 9185: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">remaining</span> = end - offset
<span class=
"linenr"> 9186: </span>      decodedText += rawText.slice(<span class="org-highlight-numbers-number">0</span>, remaining)
<span class="linenr"> 9187: </span>      advance(remaining)
<span class="linenr"> 9188: </span>      <span class=
"org-keyword">break</span>
<span class="linenr"> 9189: </span>    }
<span class="linenr"> 9190: </span>
<span class="linenr"> 9191: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Advance to the "&amp;".</span>
<span class=
"linenr"> 9192: </span>    decodedText += rawText.slice(<span class="org-highlight-numbers-number">0</span>, head.index)
<span class="linenr"> 9193: </span>    advance(head.index)
<span class="linenr"> 9194: </span>
<span class="linenr"> 9195: </span>    <span class=
"org-keyword">if</span> (head[<span class=
"org-highlight-numbers-number">0</span>] === <span class=
"org-string">'&amp;'</span>) {
<span class="linenr"> 9196: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Named character reference.</span>
<span class="linenr"> 9197: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">name</span> = <span class=
"org-string">''</span>
<span class="linenr"> 9198: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">value</span> = <span class=
"org-constant">undefined</span>
<span class="linenr"> 9199: </span>      <span class=
"org-keyword">if</span> (<span class=
"org-string">/[0-9a-z]/</span>i.test(rawText[<span class=
"org-highlight-numbers-number">1</span>])) {
<span class="linenr"> 9200: </span>        <span class=
"org-keyword">if</span> (!maxCRNameLength) {
<span class=
"linenr"> 9201: </span>          maxCRNameLength = Object.keys(namedCharacterReferences).reduce(
<span class=
"linenr"> 9202: </span>            (max, name) =&gt; Math.max(max, name.length),
<span class="linenr"> 9203: </span>            <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 9204: </span>          )
<span class="linenr"> 9205: </span>        }
<span class="linenr"> 9206: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">length</span> = maxCRNameLength; !value &amp;& length &gt; <span class="org-highlight-numbers-number">0</span>; --length) {
<span class=
"linenr"> 9207: </span>          name = rawText.slice(<span class=
"org-highlight-numbers-number">1</span>, <span class=
"org-highlight-numbers-number">1</span> + length)
<span class=
"linenr"> 9208: </span>          value = namedCharacterReferences[name]
<span class="linenr"> 9209: </span>        }
<span class="linenr"> 9210: </span>        <span class=
"org-keyword">if</span> (value) {
<span class="linenr"> 9211: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">semi</span> = name.endsWith(<span class=
"org-string">';'</span>)
<span class="linenr"> 9212: </span>          <span class=
"org-keyword">if</span> (
<span class="linenr"> 9213: </span>            asAttr &amp;&
<span class="linenr"> 9214: </span>            !semi &amp;&
<span class="linenr"> 9215: </span>            /[=a-z0-<span class=
"org-highlight-numbers-number">9</span>]/i.test(rawText[name.length + <span class="org-highlight-numbers-number">1</span>] || <span class="org-string">''</span>)
<span class="linenr"> 9216: </span>          ) {
<span class=
"linenr"> 9217: </span>            decodedText += <span class=
"org-string">'&amp;'</span> + name
<span class="linenr"> 9218: </span>            advance(<span class=
"org-highlight-numbers-number">1</span> + name.length)
<span class="linenr"> 9219: </span>          } <span class=
"org-keyword">else</span> {
<span class="linenr"> 9220: </span>            decodedText += value
<span class="linenr"> 9221: </span>            advance(<span class=
"org-highlight-numbers-number">1</span> + name.length)
<span class="linenr"> 9222: </span>          }
<span class="linenr"> 9223: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 9224: </span>          decodedText += <span class=
"org-string">'&amp;'</span> + name
<span class="linenr"> 9225: </span>          advance(<span class=
"org-highlight-numbers-number">1</span> + name.length)
<span class="linenr"> 9226: </span>        }
<span class="linenr"> 9227: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr"> 9228: </span>        decodedText += <span class=
"org-string">'&amp;'</span>
<span class="linenr"> 9229: </span>        advance(<span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr"> 9230: </span>      }
<span class="linenr"> 9231: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 9232: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Numeric character reference.</span>
<span class="linenr"> 9233: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hex</span> = head[<span class=
"org-highlight-numbers-number">0</span>] === <span class=
"org-string">'&amp;#x'</span>
<span class="linenr"> 9234: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">pattern</span> = hex ? /^&amp;#x([<span class=
"org-highlight-numbers-number">0</span>-9a-f]+);?/i : <span class=
"org-string">/^&amp;#([0-9]+);?/</span>
<span class="linenr"> 9235: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">body</span> = pattern.exec(rawText)
<span class="linenr"> 9236: </span>      <span class=
"org-keyword">if</span> (!body) {
<span class=
"linenr"> 9237: </span>        decodedText += head[<span class=
"org-highlight-numbers-number">0</span>]
<span class=
"linenr"> 9238: </span>        advance(head[<span class="org-highlight-numbers-number">0</span>].length)
<span class="linenr"> 9239: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 9240: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">https://html.spec.whatwg.org/multipage/parsing.html#numeric-character-reference-end-state</span>
<span class="linenr"> 9241: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">cp</span> = Number.parseInt(body[<span class=
"org-highlight-numbers-number">1</span>], hex ? <span class=
"org-highlight-numbers-number">16</span> : <span class=
"org-highlight-numbers-number">10</span>)
<span class="linenr"> 9242: </span>        <span class=
"org-keyword">if</span> (cp === <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr"> 9243: </span>          cp = 0xfffd
<span class="linenr"> 9244: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (cp &gt; 0x10ffff) {
<span class="linenr"> 9245: </span>          cp = 0xfffd
<span class="linenr"> 9246: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (cp &gt;= 0xd800 &amp;& cp &lt;= 0xdfff) {
<span class="linenr"> 9247: </span>          cp = 0xfffd
<span class="linenr"> 9248: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> ((cp &gt;= 0xfdd0 &amp;& cp &lt;= 0xfdef) || (cp & 0xfffe) === 0xfffe) {
<span class="linenr"> 9249: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">noop</span>
<span class="linenr"> 9250: </span>        } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr"> 9251: </span>          (cp &gt;= 0x01 &amp;& cp &lt;= 0x08) ||
<span class="linenr"> 9252: </span>          cp === 0x0b ||
<span class=
"linenr"> 9253: </span>          (cp &gt;= 0x0d &amp;& cp &lt;= 0x1f) ||
<span class=
"linenr"> 9254: </span>          (cp &gt;= 0x7f &amp;& cp &lt;= 0x9f)
<span class="linenr"> 9255: </span>        ) {
<span class=
"linenr"> 9256: </span>          cp = CCR_REPLACEMENTS[cp] || cp
<span class="linenr"> 9257: </span>        }
<span class=
"linenr"> 9258: </span>        decodedText += String.fromCodePoint(cp)
<span class=
"linenr"> 9259: </span>        advance(body[<span class="org-highlight-numbers-number">0</span>].length)
<span class="linenr"> 9260: </span>      }
<span class="linenr"> 9261: </span>    }
<span class="linenr"> 9262: </span>  }
<span class="linenr"> 9263: </span>  <span class=
"org-keyword">return</span> decodedText
<span class="linenr"> 9264: </span>}
<span class="linenr"> 9265: </span>
<span class="linenr"> 9266: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">https://html.spec.whatwg.org/multipage/parsing.html#numeric-character-reference-end-state</span>
<span class="linenr"> 9267: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CCR_REPLACEMENTS</span> = {
<span class="linenr"> 9268: </span>  0x80: 0x20ac,
<span class="linenr"> 9269: </span>  0x82: 0x201a,
<span class="linenr"> 9270: </span>  0x83: 0x0192,
<span class="linenr"> 9271: </span>  0x84: 0x201e,
<span class="linenr"> 9272: </span>  0x85: 0x2026,
<span class="linenr"> 9273: </span>  0x86: 0x2020,
<span class="linenr"> 9274: </span>  0x87: 0x2021,
<span class="linenr"> 9275: </span>  0x88: 0x02c6,
<span class="linenr"> 9276: </span>  0x89: 0x2030,
<span class="linenr"> 9277: </span>  0x8a: 0x0160,
<span class="linenr"> 9278: </span>  0x8b: 0x2039,
<span class="linenr"> 9279: </span>  0x8c: 0x0152,
<span class="linenr"> 9280: </span>  0x8e: 0x017d,
<span class="linenr"> 9281: </span>  0x91: 0x2018,
<span class="linenr"> 9282: </span>  0x92: 0x2019,
<span class="linenr"> 9283: </span>  0x93: 0x201c,
<span class="linenr"> 9284: </span>  0x94: 0x201d,
<span class="linenr"> 9285: </span>  0x95: 0x2022,
<span class="linenr"> 9286: </span>  0x96: 0x2013,
<span class="linenr"> 9287: </span>  0x97: 0x2014,
<span class="linenr"> 9288: </span>  0x98: 0x02dc,
<span class="linenr"> 9289: </span>  0x99: 0x2122,
<span class="linenr"> 9290: </span>  0x9a: 0x0161,
<span class="linenr"> 9291: </span>  0x9b: 0x203a,
<span class="linenr"> 9292: </span>  0x9c: 0x0153,
<span class="linenr"> 9293: </span>  0x9e: 0x017e,
<span class="linenr"> 9294: </span>  0x9f: 0x0178
<span class="linenr"> 9295: </span>}
<span class="linenr"> 9296: </span>
<span class="linenr"> 9297: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">decoder</span>
<span class="linenr"> 9298: </span>
<span class="linenr"> 9299: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">decodeHtmlBrowser</span>(<span class=
"org-variable-name">raw</span>, <span class=
"org-variable-name">asAttr</span> = <span class=
"org-constant">false</span>) {
<span class="linenr"> 9300: </span>  <span class=
"org-keyword">if</span> (!decoder) {
<span class=
"linenr"> 9301: </span>    decoder = document.createElement(<span class="org-string">'div'</span>)
<span class="linenr"> 9302: </span>  }
<span class="linenr"> 9303: </span>  <span class=
"org-keyword">if</span> (asAttr) {
<span class=
"linenr"> 9304: </span>    decoder.innerHTML = <span class=
"org-string">`&lt;div foo="${raw.replace(/"/g, '&amp;quot;')}"&gt;`</span>
<span class="linenr"> 9305: </span>    <span class=
"org-keyword">return</span> decoder.children[<span class=
"org-highlight-numbers-number">0</span>].getAttribute(<span class=
"org-string">'foo'</span>)
<span class="linenr"> 9306: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 9307: </span>    decoder.innerHTML = raw
<span class="linenr"> 9308: </span>    <span class=
"org-keyword">return</span> decoder.textContent
<span class="linenr"> 9309: </span>  }
<span class="linenr"> 9310: </span>}
<span class="linenr"> 9311: </span>
<span class="linenr"> 9312: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_MODEL_RADIO</span> = Symbol(__DEV__ ? <span class="org-string">`vModelRadio`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9313: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_MODEL_CHECKBOX</span> = Symbol(__DEV__ ? <span class="org-string">`vModelCheckbox`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9314: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_MODEL_TEXT</span> = Symbol(__DEV__ ? <span class="org-string">`vModelText`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9315: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_MODEL_SELECT</span> = Symbol(__DEV__ ? <span class="org-string">`vModelSelect`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9316: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_MODEL_DYNAMIC</span> = Symbol(__DEV__ ? <span class="org-string">`vModelDynamic`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9317: </span>
<span class="linenr"> 9318: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_ON_WITH_MODIFIERS</span> = Symbol(__DEV__ ? <span class="org-string">`vOnModifiersGuard`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9319: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_ON_WITH_KEYS</span> = Symbol(__DEV__ ? <span class="org-string">`vOnKeysGuard`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9320: </span>
<span class="linenr"> 9321: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">V_SHOW</span> = Symbol(__DEV__ ? <span class=
"org-string">`vShow`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9322: </span>
<span class="linenr"> 9323: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TRANSITION</span> = Symbol(__DEV__ ? <span class="org-string">`Transition`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9324: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">TRANSITION_GROUP</span> = Symbol(__DEV__ ? <span class="org-string">`TransitionGroup`</span> : <span class="org-string">``</span>)
<span class="linenr"> 9325: </span>
<span class="linenr"> 9326: </span>registerRuntimeHelpers({
<span class="linenr"> 9327: </span>  [V_MODEL_RADIO]: <span class=
"org-string">`vModelRadio`</span>,
<span class=
"linenr"> 9328: </span>  [V_MODEL_CHECKBOX]: <span class=
"org-string">`vModelCheckbox`</span>,
<span class="linenr"> 9329: </span>  [V_MODEL_TEXT]: <span class=
"org-string">`vModelText`</span>,
<span class="linenr"> 9330: </span>  [V_MODEL_SELECT]: <span class=
"org-string">`vModelSelect`</span>,
<span class=
"linenr"> 9331: </span>  [V_MODEL_DYNAMIC]: <span class="org-string">`vModelDynamic`</span>,
<span class=
"linenr"> 9332: </span>  [V_ON_WITH_MODIFIERS]: <span class=
"org-string">`withModifiers`</span>,
<span class="linenr"> 9333: </span>  [V_ON_WITH_KEYS]: <span class=
"org-string">`withKeys`</span>,
<span class="linenr"> 9334: </span>  [V_SHOW]: <span class=
"org-string">`vShow`</span>,
<span class="linenr"> 9335: </span>  [TRANSITION]: <span class=
"org-string">`Transition`</span>,
<span class=
"linenr"> 9336: </span>  [TRANSITION_GROUP]: <span class=
"org-string">`TransitionGroup`</span>
<span class="linenr"> 9337: </span>})
<span class="linenr"> 9338: </span>
<span class="linenr"> 9339: </span><span class="org-doc">/**</span>
<span class="linenr"> 9340: </span><span class=
"org-doc"> * On the client we only need to offer special cases for boolean attributes that</span>
<span class="linenr"> 9341: </span><span class=
"org-doc"> * have different names from their corresponding dom properties:</span>
<span class="linenr"> 9342: </span><span class=
"org-doc"> * - itemscope -&gt; N/A</span>
<span class="linenr"> 9343: </span><span class=
"org-doc"> * - allowfullscreen -&gt; allowFullscreen</span>
<span class="linenr"> 9344: </span><span class=
"org-doc"> * - formnovalidate -&gt; formNoValidate</span>
<span class="linenr"> 9345: </span><span class=
"org-doc"> * - ismap -&gt; isMap</span>
<span class="linenr"> 9346: </span><span class=
"org-doc"> * - nomodule -&gt; noModule</span>
<span class="linenr"> 9347: </span><span class=
"org-doc"> * - novalidate -&gt; noValidate</span>
<span class="linenr"> 9348: </span><span class=
"org-doc"> * - readonly -&gt; readOnly</span>
<span class="linenr"> 9349: </span><span class="org-doc"> */</span>
<span class="linenr"> 9350: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">specialBooleanAttrs</span> = <span class=
"org-string">`itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly`</span>
<span class="linenr"> 9351: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSpecialBooleanAttr</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(specialBooleanAttrs)
<span class="linenr"> 9352: </span>
<span class="linenr"> 9353: </span><span class="org-doc">/**</span>
<span class="linenr"> 9354: </span><span class=
"org-doc"> * The full list is needed during SSR to produce the correct initial markup.</span>
<span class="linenr"> 9355: </span><span class="org-doc"> */</span>
<span class="linenr"> 9356: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isBooleanAttr</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr"> 9357: </span>  specialBooleanAttrs +
<span class="linenr"> 9358: </span>    <span class=
"org-string">`,async,autofocus,autoplay,controls,default,defer,disabled,hidden,`</span> +
<span class="linenr"> 9359: </span>    <span class=
"org-string">`loop,open,required,reversed,scoped,seamless,`</span> +
<span class="linenr"> 9360: </span>    <span class=
"org-string">`checked,muted,multiple,selected`</span>
<span class="linenr"> 9361: </span>)
<span class="linenr"> 9362: </span>
<span class="linenr"> 9363: </span><span class="org-doc">/**</span>
<span class="linenr"> 9364: </span><span class=
"org-doc"> * Boolean attributes should be included if the value is truthy or ''.</span>
<span class="linenr"> 9365: </span><span class=
"org-doc"> * e.g. `&lt;select multiple&gt;` compiles to `{ multiple: '' }`</span>
<span class="linenr"> 9366: </span><span class="org-doc"> */</span>
<span class="linenr"> 9367: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">includeBooleanAttr</span>(<span class=
"org-variable-name">value</span>) {
<span class="linenr"> 9368: </span>  <span class=
"org-keyword">return</span> !!value || value === <span class=
"org-string">''</span>
<span class="linenr"> 9369: </span>}
<span class="linenr"> 9370: </span>
<span class="linenr"> 9371: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">unsafeAttrCharRE</span> = <span class=
"org-string">/[&gt;/="'\u0009\u000a\u000c\u0020]/</span>
<span class="linenr"> 9372: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">attrValidationCache</span> = {}
<span class="linenr"> 9373: </span>
<span class="linenr"> 9374: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isSSRSafeAttrName</span>(<span class=
"org-variable-name">name</span>) {
<span class="linenr"> 9375: </span>  <span class=
"org-keyword">if</span> (attrValidationCache.hasOwnProperty(name)) {
<span class="linenr"> 9376: </span>    <span class=
"org-keyword">return</span> attrValidationCache[name]
<span class="linenr"> 9377: </span>  }
<span class="linenr"> 9378: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isUnsafe</span> = unsafeAttrCharRE.test(name)
<span class="linenr"> 9379: </span>  <span class=
"org-keyword">if</span> (isUnsafe) {
<span class="linenr"> 9380: </span>    console.error(<span class=
"org-string">`unsafe attribute name: ${name}`</span>)
<span class="linenr"> 9381: </span>  }
<span class="linenr"> 9382: </span>  <span class=
"org-keyword">return</span> (attrValidationCache[name] = !isUnsafe)
<span class="linenr"> 9383: </span>}
<span class="linenr"> 9384: </span>
<span class="linenr"> 9385: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">propsToAttrMap</span> = {
<span class="linenr"> 9386: </span>  acceptCharset: <span class=
"org-string">'accept-charset'</span>,
<span class="linenr"> 9387: </span>  className: <span class=
"org-string">'class'</span>,
<span class="linenr"> 9388: </span>  htmlFor: <span class=
"org-string">'for'</span>,
<span class="linenr"> 9389: </span>  httpEquiv: <span class=
"org-string">'http-equiv'</span>
<span class="linenr"> 9390: </span>}
<span class="linenr"> 9391: </span>
<span class="linenr"> 9392: </span><span class="org-doc">/**</span>
<span class="linenr"> 9393: </span><span class=
"org-doc"> * CSS properties that accept plain numbers</span>
<span class="linenr"> 9394: </span><span class="org-doc"> */</span>
<span class="linenr"> 9395: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isNoUnitNumericStyleProp</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr"> 9396: </span>  <span class=
"org-string">`animation-iteration-count,border-image-outset,border-image-slice,`</span> +
<span class="linenr"> 9397: </span>    <span class=
"org-string">`border-image-width,box-flex,box-flex-group,box-ordinal-group,column-count,`</span> +
<span class="linenr"> 9398: </span>    <span class=
"org-string">`columns,flex,flex-grow,flex-positive,flex-shrink,flex-negative,flex-order,`</span> +
<span class="linenr"> 9399: </span>    <span class=
"org-string">`grid-row,grid-row-end,grid-row-span,grid-row-start,grid-column,`</span> +
<span class="linenr"> 9400: </span>    <span class=
"org-string">`grid-column-end,grid-column-span,grid-column-start,font-weight,line-clamp,`</span> +
<span class="linenr"> 9401: </span>    <span class=
"org-string">`line-height,opacity,order,orphans,tab-size,widows,z-index,zoom,`</span> +
<span class="linenr"> 9402: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">SVG</span>
<span class="linenr"> 9403: </span>    <span class=
"org-string">`fill-opacity,flood-opacity,stop-opacity,stroke-dasharray,stroke-dashoffset,`</span> +
<span class="linenr"> 9404: </span>    <span class=
"org-string">`stroke-miterlimit,stroke-opacity,stroke-width`</span>
<span class="linenr"> 9405: </span>)
<span class="linenr"> 9406: </span>
<span class="linenr"> 9407: </span><span class="org-doc">/**</span>
<span class="linenr"> 9408: </span><span class=
"org-doc"> * Known attributes, this is used for stringification of runtime static nodes</span>
<span class="linenr"> 9409: </span><span class=
"org-doc"> * so that we don't stringify bindings that cannot be set from HTML.</span>
<span class="linenr"> 9410: </span><span class=
"org-doc"> * Don't also forget to allow `data-*` and `aria-*`!</span>
<span class="linenr"> 9411: </span><span class=
"org-doc"> * Generated from https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes</span>
<span class="linenr"> 9412: </span><span class="org-doc"> */</span>
<span class="linenr"> 9413: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isKnownHtmlAttr</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr"> 9414: </span>  <span class=
"org-string">`accept,accept-charset,accesskey,action,align,allow,alt,async,`</span> +
<span class="linenr"> 9415: </span>    <span class=
"org-string">`autocapitalize,autocomplete,autofocus,autoplay,background,bgcolor,`</span> +
<span class="linenr"> 9416: </span>    <span class=
"org-string">`border,buffered,capture,challenge,charset,checked,cite,class,code,`</span> +
<span class="linenr"> 9417: </span>    <span class=
"org-string">`codebase,color,cols,colspan,content,contenteditable,contextmenu,controls,`</span> +
<span class="linenr"> 9418: </span>    <span class=
"org-string">`coords,crossorigin,csp,data,datetime,decoding,default,defer,dir,dirname,`</span> +
<span class="linenr"> 9419: </span>    <span class=
"org-string">`disabled,download,draggable,dropzone,enctype,enterkeyhint,for,form,`</span> +
<span class="linenr"> 9420: </span>    <span class=
"org-string">`formaction,formenctype,formmethod,formnovalidate,formtarget,headers,`</span> +
<span class="linenr"> 9421: </span>    <span class=
"org-string">`height,hidden,high,href,hreflang,http-equiv,icon,id,importance,integrity,`</span> +
<span class="linenr"> 9422: </span>    <span class=
"org-string">`ismap,itemprop,keytype,kind,label,lang,language,loading,list,loop,low,`</span> +
<span class="linenr"> 9423: </span>    <span class=
"org-string">`manifest,max,maxlength,minlength,media,min,multiple,muted,name,novalidate,`</span> +
<span class="linenr"> 9424: </span>    <span class=
"org-string">`open,optimum,pattern,ping,placeholder,poster,preload,radiogroup,readonly,`</span> +
<span class="linenr"> 9425: </span>    <span class=
"org-string">`referrerpolicy,rel,required,reversed,rows,rowspan,sandbox,scope,scoped,`</span> +
<span class="linenr"> 9426: </span>    <span class=
"org-string">`selected,shape,size,sizes,slot,span,spellcheck,src,srcdoc,srclang,srcset,`</span> +
<span class="linenr"> 9427: </span>    <span class=
"org-string">`start,step,style,summary,tabindex,target,title,translate,type,usemap,`</span> +
<span class="linenr"> 9428: </span>    <span class=
"org-string">`value,width,wrap`</span>
<span class="linenr"> 9429: </span>)
<span class="linenr"> 9430: </span>
<span class="linenr"> 9431: </span><span class="org-doc">/**</span>
<span class="linenr"> 9432: </span><span class=
"org-doc"> * Generated from https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute</span>
<span class="linenr"> 9433: </span><span class="org-doc"> */</span>
<span class="linenr"> 9434: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isKnownSvgAttr</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr"> 9435: </span>  <span class=
"org-string">`xmlns,accent-height,accumulate,additive,alignment-baseline,alphabetic,amplitude,`</span> +
<span class="linenr"> 9436: </span>    <span class=
"org-string">`arabic-form,ascent,attributeName,attributeType,azimuth,baseFrequency,`</span> +
<span class="linenr"> 9437: </span>    <span class=
"org-string">`baseline-shift,baseProfile,bbox,begin,bias,by,calcMode,cap-height,class,`</span> +
<span class="linenr"> 9438: </span>    <span class=
"org-string">`clip,clipPathUnits,clip-path,clip-rule,color,color-interpolation,`</span> +
<span class="linenr"> 9439: </span>    <span class=
"org-string">`color-interpolation-filters,color-profile,color-rendering,`</span> +
<span class="linenr"> 9440: </span>    <span class=
"org-string">`contentScriptType,contentStyleType,crossorigin,cursor,cx,cy,d,decelerate,`</span> +
<span class="linenr"> 9441: </span>    <span class=
"org-string">`descent,diffuseConstant,direction,display,divisor,dominant-baseline,dur,dx,`</span> +
<span class="linenr"> 9442: </span>    <span class=
"org-string">`dy,edgeMode,elevation,enable-background,end,exponent,fill,fill-opacity,`</span> +
<span class="linenr"> 9443: </span>    <span class=
"org-string">`fill-rule,filter,filterRes,filterUnits,flood-color,flood-opacity,`</span> +
<span class="linenr"> 9444: </span>    <span class=
"org-string">`font-family,font-size,font-size-adjust,font-stretch,font-style,`</span> +
<span class="linenr"> 9445: </span>    <span class=
"org-string">`font-variant,font-weight,format,from,fr,fx,fy,g1,g2,glyph-name,`</span> +
<span class="linenr"> 9446: </span>    <span class=
"org-string">`glyph-orientation-horizontal,glyph-orientation-vertical,glyphRef,`</span> +
<span class="linenr"> 9447: </span>    <span class=
"org-string">`gradientTransform,gradientUnits,hanging,height,href,hreflang,horiz-adv-x,`</span> +
<span class="linenr"> 9448: </span>    <span class=
"org-string">`horiz-origin-x,id,ideographic,image-rendering,in,in2,intercept,k,k1,k2,k3,`</span> +
<span class="linenr"> 9449: </span>    <span class=
"org-string">`k4,kernelMatrix,kernelUnitLength,kerning,keyPoints,keySplines,keyTimes,`</span> +
<span class="linenr"> 9450: </span>    <span class=
"org-string">`lang,lengthAdjust,letter-spacing,lighting-color,limitingConeAngle,local,`</span> +
<span class="linenr"> 9451: </span>    <span class=
"org-string">`marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,`</span> +
<span class="linenr"> 9452: </span>    <span class=
"org-string">`mask,maskContentUnits,maskUnits,mathematical,max,media,method,min,mode,`</span> +
<span class="linenr"> 9453: </span>    <span class=
"org-string">`name,numOctaves,offset,opacity,operator,order,orient,orientation,origin,`</span> +
<span class="linenr"> 9454: </span>    <span class=
"org-string">`overflow,overline-position,overline-thickness,panose-1,paint-order,path,`</span> +
<span class="linenr"> 9455: </span>    <span class=
"org-string">`pathLength,patternContentUnits,patternTransform,patternUnits,ping,`</span> +
<span class="linenr"> 9456: </span>    <span class=
"org-string">`pointer-events,points,pointsAtX,pointsAtY,pointsAtZ,preserveAlpha,`</span> +
<span class="linenr"> 9457: </span>    <span class=
"org-string">`preserveAspectRatio,primitiveUnits,r,radius,referrerPolicy,refX,refY,rel,`</span> +
<span class="linenr"> 9458: </span>    <span class=
"org-string">`rendering-intent,repeatCount,repeatDur,requiredExtensions,requiredFeatures,`</span> +
<span class="linenr"> 9459: </span>    <span class=
"org-string">`restart,result,rotate,rx,ry,scale,seed,shape-rendering,slope,spacing,`</span> +
<span class="linenr"> 9460: </span>    <span class=
"org-string">`specularConstant,specularExponent,speed,spreadMethod,startOffset,`</span> +
<span class="linenr"> 9461: </span>    <span class=
"org-string">`stdDeviation,stemh,stemv,stitchTiles,stop-color,stop-opacity,`</span> +
<span class="linenr"> 9462: </span>    <span class=
"org-string">`strikethrough-position,strikethrough-thickness,string,stroke,`</span> +
<span class="linenr"> 9463: </span>    <span class=
"org-string">`stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,`</span> +
<span class="linenr"> 9464: </span>    <span class=
"org-string">`stroke-miterlimit,stroke-opacity,stroke-width,style,surfaceScale,`</span> +
<span class="linenr"> 9465: </span>    <span class=
"org-string">`systemLanguage,tabindex,tableValues,target,targetX,targetY,text-anchor,`</span> +
<span class="linenr"> 9466: </span>    <span class=
"org-string">`text-decoration,text-rendering,textLength,to,transform,transform-origin,`</span> +
<span class="linenr"> 9467: </span>    <span class=
"org-string">`type,u1,u2,underline-position,underline-thickness,unicode,unicode-bidi,`</span> +
<span class="linenr"> 9468: </span>    <span class=
"org-string">`unicode-range,units-per-em,v-alphabetic,v-hanging,v-ideographic,`</span> +
<span class="linenr"> 9469: </span>    <span class=
"org-string">`v-mathematical,values,vector-effect,version,vert-adv-y,vert-origin-x,`</span> +
<span class="linenr"> 9470: </span>    <span class=
"org-string">`vert-origin-y,viewBox,viewTarget,visibility,width,widths,word-spacing,`</span> +
<span class="linenr"> 9471: </span>    <span class=
"org-string">`writing-mode,x,x-height,x1,x2,xChannelSelector,xlink:actuate,xlink:arcrole,`</span> +
<span class="linenr"> 9472: </span>    <span class=
"org-string">`xlink:href,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,`</span> +
<span class="linenr"> 9473: </span>    <span class=
"org-string">`xml:space,y,y1,y2,yChannelSelector,z,zoomAndPan`</span>
<span class="linenr"> 9474: </span>)
<span class="linenr"> 9475: </span>
<span class="linenr"> 9476: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">https://developer.mozilla.org/en-US/docs/Web/HTML/Element</span>
<span class="linenr"> 9477: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">HTML_TAGS</span> =
<span class="linenr"> 9478: </span>  <span class=
"org-string">'html,body,base,head,link,meta,style,title,address,article,aside,footer,'</span> +
<span class="linenr"> 9479: </span>  <span class=
"org-string">'header,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,'</span> +
<span class="linenr"> 9480: </span>  <span class=
"org-string">'figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,'</span> +
<span class="linenr"> 9481: </span>  <span class=
"org-string">'data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,'</span> +
<span class="linenr"> 9482: </span>  <span class=
"org-string">'time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,'</span> +
<span class="linenr"> 9483: </span>  <span class=
"org-string">'canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,'</span> +
<span class="linenr"> 9484: </span>  <span class=
"org-string">'th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,'</span> +
<span class="linenr"> 9485: </span>  <span class=
"org-string">'option,output,progress,select,textarea,details,dialog,menu,'</span> +
<span class="linenr"> 9486: </span>  <span class=
"org-string">'summary,template,blockquote,iframe,tfoot'</span>
<span class="linenr"> 9487: </span>
<span class="linenr"> 9488: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">https://developer.mozilla.org/en-US/docs/Web/SVG/Element</span>
<span class="linenr"> 9489: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">SVG_TAGS</span> =
<span class="linenr"> 9490: </span>  <span class=
"org-string">'svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,'</span> +
<span class="linenr"> 9491: </span>  <span class=
"org-string">'defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,'</span> +
<span class="linenr"> 9492: </span>  <span class=
"org-string">'feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,'</span> +
<span class="linenr"> 9493: </span>  <span class=
"org-string">'feDistanceLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,'</span> +
<span class="linenr"> 9494: </span>  <span class=
"org-string">'feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,'</span> +
<span class="linenr"> 9495: </span>  <span class=
"org-string">'fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,'</span> +
<span class="linenr"> 9496: </span>  <span class=
"org-string">'foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,'</span> +
<span class="linenr"> 9497: </span>  <span class=
"org-string">'mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,'</span> +
<span class="linenr"> 9498: </span>  <span class=
"org-string">'polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,'</span> +
<span class="linenr"> 9499: </span>  <span class=
"org-string">'text,textPath,title,tspan,unknown,use,view'</span>
<span class="linenr"> 9500: </span>
<span class="linenr"> 9501: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">VOID_TAGS</span> =
<span class="linenr"> 9502: </span>  <span class=
"org-string">'area,base,br,col,embed,hr,img,input,link,meta,param,source,track,wbr'</span>
<span class="linenr"> 9503: </span>
<span class="linenr"> 9504: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isHTMLTag</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(HTML_TAGS)
<span class="linenr"> 9505: </span><span class="org-doc">/**</span>
<span class="linenr"> 9506: </span><span class=
"org-doc"> * Compiler only.</span>
<span class="linenr"> 9507: </span><span class=
"org-doc"> * Do NOT use in runtime code paths unless behind `__DEV__` flag.</span>
<span class="linenr"> 9508: </span><span class="org-doc"> */</span>
<span class="linenr"> 9509: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isSVGTag</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(SVG_TAGS)
<span class="linenr"> 9510: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isVoidTag</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(VOID_TAGS)
<span class="linenr"> 9511: </span>
<span class="linenr"> 9512: </span>
<span class="linenr"> 9513: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">normalizeStyle</span>(<span class=
"org-variable-name">value</span>) {
<span class="linenr"> 9514: </span>  <span class=
"org-keyword">if</span> (isArray(value)) {
<span class="linenr"> 9515: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">res</span> = {}
<span class="linenr"> 9516: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; value.length; i++) {
<span class="linenr"> 9517: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">item</span> = value[i]
<span class="linenr"> 9518: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">normalized</span> = isString(item)
<span class="linenr"> 9519: </span>        ? parseStringStyle(item)
<span class="linenr"> 9520: </span>        : normalizeStyle(item)
<span class="linenr"> 9521: </span>      <span class=
"org-keyword">if</span> (normalized) {
<span class="linenr"> 9522: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> normalized) {
<span class=
"linenr"> 9523: </span>          res[key] = normalized[key]
<span class="linenr"> 9524: </span>        }
<span class="linenr"> 9525: </span>      }
<span class="linenr"> 9526: </span>    }
<span class="linenr"> 9527: </span>    <span class=
"org-keyword">return</span> res
<span class="linenr"> 9528: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isString(value)) {
<span class="linenr"> 9529: </span>    <span class=
"org-keyword">return</span> value
<span class="linenr"> 9530: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isObject(value)) {
<span class="linenr"> 9531: </span>    <span class=
"org-keyword">return</span> value
<span class="linenr"> 9532: </span>  }
<span class="linenr"> 9533: </span>}
<span class="linenr"> 9534: </span>
<span class="linenr"> 9535: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">listDelimiterRE</span> = <span class=
"org-string">/;(?![^(]*\))/</span>g
<span class="linenr"> 9536: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">propertyDelimiterRE</span> = <span class=
"org-string">/:(.+)/</span>
<span class="linenr"> 9537: </span>
<span class="linenr"> 9538: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseStringStyle</span>(<span class=
"org-variable-name">cssText</span>) {
<span class="linenr"> 9539: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ret</span> = {}
<span class=
"linenr"> 9540: </span>  cssText.split(listDelimiterRE).forEach(item =&gt; {
<span class="linenr"> 9541: </span>    <span class=
"org-keyword">if</span> (item) {
<span class="linenr"> 9542: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">tmp</span> = item.split(propertyDelimiterRE)
<span class=
"linenr"> 9543: </span>      tmp.length &gt; <span class=
"org-highlight-numbers-number">1</span> &amp;& (ret[tmp[<span class="org-highlight-numbers-number">0</span>].trim()] = tmp[<span class="org-highlight-numbers-number">1</span>].trim())
<span class="linenr"> 9544: </span>    }
<span class="linenr"> 9545: </span>  })
<span class="linenr"> 9546: </span>  <span class=
"org-keyword">return</span> ret
<span class="linenr"> 9547: </span>}
<span class="linenr"> 9548: </span>
<span class="linenr"> 9549: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">stringifyStyle</span>(<span class=
"org-variable-name">styles</span>) {
<span class="linenr"> 9550: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">ret</span> = <span class="org-string">''</span>
<span class="linenr"> 9551: </span>  <span class=
"org-keyword">if</span> (!styles || isString(styles)) {
<span class="linenr"> 9552: </span>    <span class=
"org-keyword">return</span> ret
<span class="linenr"> 9553: </span>  }
<span class="linenr"> 9554: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> styles) {
<span class="linenr"> 9555: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">value</span> = styles[key]
<span class="linenr"> 9556: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">normalizedKey</span> = key.startsWith(<span class="org-string">`--`</span>) ? key : hyphenate(key)
<span class="linenr"> 9557: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr"> 9558: </span>      isString(value) ||
<span class="linenr"> 9559: </span>      (<span class=
"org-keyword">typeof</span> value === <span class=
"org-string">'number'</span> &amp;& isNoUnitNumericStyleProp(normalizedKey))
<span class="linenr"> 9560: </span>    ) {
<span class="linenr"> 9561: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">only render valid values</span>
<span class="linenr"> 9562: </span>      ret += <span class=
"org-string">`${normalizedKey}:${value};`</span>
<span class="linenr"> 9563: </span>    }
<span class="linenr"> 9564: </span>  }
<span class="linenr"> 9565: </span>  <span class=
"org-keyword">return</span> ret
<span class="linenr"> 9566: </span>}
<span class="linenr"> 9567: </span>
<span class="linenr"> 9568: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">normalizeClass</span>(<span class=
"org-variable-name">value</span>) {
<span class="linenr"> 9569: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">res</span> = <span class="org-string">''</span>
<span class="linenr"> 9570: </span>  <span class=
"org-keyword">if</span> (isString(value)) {
<span class="linenr"> 9571: </span>    res = value
<span class="linenr"> 9572: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isArray(value)) {
<span class="linenr"> 9573: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; value.length; i++) {
<span class="linenr"> 9574: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">normalized</span> = normalizeClass(value[i])
<span class="linenr"> 9575: </span>      <span class=
"org-keyword">if</span> (normalized) {
<span class=
"linenr"> 9576: </span>        res += normalized + <span class=
"org-string">' '</span>
<span class="linenr"> 9577: </span>      }
<span class="linenr"> 9578: </span>    }
<span class="linenr"> 9579: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isObject(value)) {
<span class="linenr"> 9580: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">name</span> <span class=
"org-keyword">in</span> value) {
<span class="linenr"> 9581: </span>      <span class=
"org-keyword">if</span> (value[name]) {
<span class=
"linenr"> 9582: </span>        res += name + <span class=
"org-string">' '</span>
<span class="linenr"> 9583: </span>      }
<span class="linenr"> 9584: </span>    }
<span class="linenr"> 9585: </span>  }
<span class="linenr"> 9586: </span>  <span class=
"org-keyword">return</span> res.trim()
<span class="linenr"> 9587: </span>}
<span class="linenr"> 9588: </span>
<span class="linenr"> 9589: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">normalizeProps</span>(<span class=
"org-variable-name">props</span>) {
<span class="linenr"> 9590: </span>  <span class=
"org-keyword">if</span> (!props) <span class=
"org-keyword">return</span> <span class="org-constant">null</span>
<span class="linenr"> 9591: </span>  <span class=
"org-keyword">let</span> { <span class=
"org-keyword">class</span>: klass, style } = props
<span class="linenr"> 9592: </span>  <span class=
"org-keyword">if</span> (klass &amp;& !isString(klass)) {
<span class="linenr"> 9593: </span>    props.<span class=
"org-keyword">class</span> = normalizeClass(klass)
<span class="linenr"> 9594: </span>  }
<span class="linenr"> 9595: </span>  <span class=
"org-keyword">if</span> (style) {
<span class=
"linenr"> 9596: </span>    props.style = normalizeStyle(style)
<span class="linenr"> 9597: </span>  }
<span class="linenr"> 9598: </span>  <span class=
"org-keyword">return</span> props
<span class="linenr"> 9599: </span>}
<span class="linenr"> 9600: </span>
<span class="linenr"> 9601: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">escapeRE</span> = <span class=
"org-string">/["'&amp;&lt;&gt;]/</span>
<span class="linenr"> 9602: </span>
<span class="linenr"> 9603: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">escapeHtml</span>(<span class=
"org-variable-name">string</span>) {
<span class="linenr"> 9604: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">str</span> = <span class=
"org-string">''</span> + string
<span class="linenr"> 9605: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">match</span> = escapeRE.exec(str)
<span class="linenr"> 9606: </span>
<span class="linenr"> 9607: </span>  <span class=
"org-keyword">if</span> (!match) {
<span class="linenr"> 9608: </span>    <span class=
"org-keyword">return</span> str
<span class="linenr"> 9609: </span>  }
<span class="linenr"> 9610: </span>
<span class="linenr"> 9611: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">html</span> = <span class=
"org-string">''</span>
<span class="linenr"> 9612: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">escaped</span>
<span class="linenr"> 9613: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">index</span>
<span class="linenr"> 9614: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">lastIndex</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 9615: </span>  <span class=
"org-keyword">for</span> (index = match.index; index &lt; str.length; index++) {
<span class="linenr"> 9616: </span>    <span class=
"org-keyword">switch</span> (str.charCodeAt(index)) {
<span class="linenr"> 9617: </span>      <span class=
"org-keyword">case</span> <span class=
"org-highlight-numbers-number">34</span>: <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">"</span>
<span class="linenr"> 9618: </span>        escaped = <span class=
"org-string">'&amp;quot;'</span>
<span class="linenr"> 9619: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 9620: </span>      <span class=
"org-keyword">case</span> <span class=
"org-highlight-numbers-number">38</span>: <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&</span>
<span class="linenr"> 9621: </span>        escaped = <span class=
"org-string">'&amp;amp;'</span>
<span class="linenr"> 9622: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 9623: </span>      <span class=
"org-keyword">case</span> <span class=
"org-highlight-numbers-number">39</span>: <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">'</span>
<span class="linenr"> 9624: </span>        escaped = <span class=
"org-string">'&amp;#39;'</span>
<span class="linenr"> 9625: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 9626: </span>      <span class=
"org-keyword">case</span> <span class=
"org-highlight-numbers-number">60</span>: <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;</span>
<span class="linenr"> 9627: </span>        escaped = <span class=
"org-string">'&amp;lt;'</span>
<span class="linenr"> 9628: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 9629: </span>      <span class=
"org-keyword">case</span> <span class=
"org-highlight-numbers-number">62</span>: <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&gt;</span>
<span class="linenr"> 9630: </span>        escaped = <span class=
"org-string">'&amp;gt;'</span>
<span class="linenr"> 9631: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 9632: </span>      <span class=
"org-keyword">default</span>:
<span class="linenr"> 9633: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr"> 9634: </span>    }
<span class="linenr"> 9635: </span>
<span class="linenr"> 9636: </span>    <span class=
"org-keyword">if</span> (lastIndex !== index) {
<span class=
"linenr"> 9637: </span>      html += str.slice(lastIndex, index)
<span class="linenr"> 9638: </span>    }
<span class="linenr"> 9639: </span>
<span class=
"linenr"> 9640: </span>    lastIndex = index + <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr"> 9641: </span>    html += escaped
<span class="linenr"> 9642: </span>  }
<span class="linenr"> 9643: </span>
<span class="linenr"> 9644: </span>  <span class=
"org-keyword">return</span> lastIndex !== index ? html + str.slice(lastIndex, index) : html
<span class="linenr"> 9645: </span>}
<span class="linenr"> 9646: </span>
<span class="linenr"> 9647: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">https://www.w3.org/TR/html52/syntax.html#comments</span>
<span class="linenr"> 9648: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">commentStripRE</span> = <span class=
"org-string">/^-?&gt;|&lt;!--|--&gt;|--!&gt;|&lt;!-$/</span>g
<span class="linenr"> 9649: </span>
<span class="linenr"> 9650: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">escapeHtmlComment</span>(<span class=
"org-variable-name">src</span>) {
<span class="linenr"> 9651: </span>  <span class=
"org-keyword">return</span> src.replace(commentStripRE, <span class="org-string">''</span>)
<span class="linenr"> 9652: </span>}
<span class="linenr"> 9653: </span>
<span class="linenr"> 9654: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">toDisplayString</span> = (val) =&gt; {
<span class="linenr"> 9655: </span>  <span class=
"org-keyword">return</span> isString(val)
<span class="linenr"> 9656: </span>    ? val
<span class="linenr"> 9657: </span>    : val == <span class=
"org-constant">null</span>
<span class="linenr"> 9658: </span>    ? <span class=
"org-string">''</span>
<span class="linenr"> 9659: </span>    : isArray(val) ||
<span class="linenr"> 9660: </span>      (isObject(val) &amp;&
<span class=
"linenr"> 9661: </span>        (val.toString === objectToString || !isFunction(val.toString)))
<span class=
"linenr"> 9662: </span>    ? JSON.stringify(val, replacer, <span class="org-highlight-numbers-number">2</span>)
<span class="linenr"> 9663: </span>    : String(val)
<span class="linenr"> 9664: </span>}
<span class="linenr"> 9665: </span>
<span class="linenr"> 9666: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">replacer</span> = (_key, val) =&gt; {
<span class="linenr"> 9667: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">can't use isRef here since @vue/shared has no deps</span>
<span class="linenr"> 9668: </span>  <span class=
"org-keyword">if</span> (val &amp;& val.__v_isRef) {
<span class="linenr"> 9669: </span>    <span class=
"org-keyword">return</span> replacer(_key, val.value)
<span class="linenr"> 9670: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isMap(val)) {
<span class="linenr"> 9671: </span>    <span class=
"org-keyword">return</span> {
<span class="linenr"> 9672: </span>      [<span class=
"org-string">`Map(${val.size})`</span>]: [...val.entries()].reduce((entries, [key, val]) =&gt; {
<span class="linenr"> 9673: </span>        ;entries[<span class=
"org-string">`${key} =&gt;`</span>] = val
<span class="linenr"> 9674: </span>        <span class=
"org-keyword">return</span> entries
<span class="linenr"> 9675: </span>      }, {})
<span class="linenr"> 9676: </span>    }
<span class="linenr"> 9677: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isSet(val)) {
<span class="linenr"> 9678: </span>    <span class=
"org-keyword">return</span> {
<span class="linenr"> 9679: </span>      [<span class=
"org-string">`Set(${val.size})`</span>]: [...val.values()]
<span class="linenr"> 9680: </span>    }
<span class="linenr"> 9681: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isObject(val) &amp;& !isArray(val) &amp;& !isPlainObject(val)) {
<span class="linenr"> 9682: </span>    <span class=
"org-keyword">return</span> String(val)
<span class="linenr"> 9683: </span>  }
<span class="linenr"> 9684: </span>  <span class=
"org-keyword">return</span> val
<span class="linenr"> 9685: </span>}
<span class="linenr"> 9686: </span>
<span class="linenr"> 9687: </span>
<span class="linenr"> 9688: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">noopDirectiveTransform</span> = () =&gt; ({ props: [] })
<span class="linenr"> 9689: </span>
<span class="linenr"> 9690: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isRawTextContainer</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr"> 9691: </span>  <span class=
"org-string">'style,iframe,script,noscript'</span>,
<span class="linenr"> 9692: </span>  <span class=
"org-constant">true</span>
<span class="linenr"> 9693: </span>)
<span class="linenr"> 9694: </span>
<span class="linenr"> 9695: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">DOMNamespaces</span> = {
<span class="linenr"> 9696: </span>  HTML: Namespaces.HTML,
<span class="linenr"> 9697: </span>  SVG: <span class=
"org-highlight-numbers-number">1</span>,
<span class="linenr"> 9698: </span>  MATH_ML: <span class=
"org-highlight-numbers-number">2</span>
<span class="linenr"> 9699: </span>}
<span class="linenr"> 9700: </span>
<span class="linenr"> 9701: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">parserOptions</span> = {
<span class="linenr"> 9702: </span>  isVoidTag,
<span class=
"linenr"> 9703: </span>  isNativeTag: tag =&gt; isHTMLTag(tag) || isSVGTag(tag),
<span class=
"linenr"> 9704: </span>  isPreTag: tag =&gt; tag === <span class=
"org-string">'pre'</span>,
<span class=
"linenr"> 9705: </span>  decodeEntities: __BROWSER__ ? decodeHtmlBrowser : decodeHtml,
<span class="linenr"> 9706: </span>
<span class=
"linenr"> 9707: </span>  isBuiltInComponent: tag =&gt; {
<span class="linenr"> 9708: </span>    <span class=
"org-keyword">if</span> (isBuiltInType(tag, <span class=
"org-string">`Transition`</span>)) {
<span class="linenr"> 9709: </span>      <span class=
"org-keyword">return</span> TRANSITION
<span class="linenr"> 9710: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isBuiltInType(tag, <span class=
"org-string">`TransitionGroup`</span>)) {
<span class="linenr"> 9711: </span>      <span class=
"org-keyword">return</span> TRANSITION_GROUP
<span class="linenr"> 9712: </span>    }
<span class="linenr"> 9713: </span>  },
<span class="linenr"> 9714: </span>
<span class="linenr"> 9715: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">https://html.spec.whatwg.org/multipage/parsing.html#tree-construction-dispatcher</span>
<span class="linenr"> 9716: </span>  getNamespace(tag, parent) {
<span class="linenr"> 9717: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">ns</span> = parent ? parent.ns : DOMNamespaces.HTML
<span class="linenr"> 9718: </span>
<span class="linenr"> 9719: </span>    <span class=
"org-keyword">if</span> (parent &amp;& ns === DOMNamespaces.MATH_ML) {
<span class="linenr"> 9720: </span>      <span class=
"org-keyword">if</span> (parent.tag === <span class=
"org-string">'annotation-xml'</span>) {
<span class="linenr"> 9721: </span>        <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'svg'</span>) {
<span class="linenr"> 9722: </span>          <span class=
"org-keyword">return</span> DOMNamespaces.SVG
<span class="linenr"> 9723: </span>        }
<span class="linenr"> 9724: </span>        <span class=
"org-keyword">if</span> (
<span class="linenr"> 9725: </span>          parent.props.some(
<span class="linenr"> 9726: </span>            a =&gt;
<span class=
"linenr"> 9727: </span>              a.type === NodeTypes.ATTRIBUTE &amp;&
<span class=
"linenr"> 9728: </span>              a.name === <span class=
"org-string">'encoding'</span> &amp;&
<span class=
"linenr"> 9729: </span>              a.value != <span class=
"org-constant">null</span> &amp;&
<span class=
"linenr"> 9730: </span>              (a.value.content === <span class="org-string">'text/html'</span> ||
<span class=
"linenr"> 9731: </span>                a.value.content === <span class="org-string">'application/xhtml+xml'</span>)
<span class="linenr"> 9732: </span>          )
<span class="linenr"> 9733: </span>        ) {
<span class=
"linenr"> 9734: </span>          ns = DOMNamespaces.HTML
<span class="linenr"> 9735: </span>        }
<span class="linenr"> 9736: </span>      } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class="linenr"> 9737: </span>        <span class=
"org-string">/^m(?:[ions]|text)$/</span>.test(parent.tag) &amp;&
<span class="linenr"> 9738: </span>        tag !== <span class=
"org-string">'mglyph'</span> &amp;&
<span class="linenr"> 9739: </span>        tag !== <span class=
"org-string">'malignmark'</span>
<span class="linenr"> 9740: </span>      ) {
<span class="linenr"> 9741: </span>        ns = DOMNamespaces.HTML
<span class="linenr"> 9742: </span>      }
<span class="linenr"> 9743: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (parent &amp;& ns === DOMNamespaces.SVG) {
<span class="linenr"> 9744: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 9745: </span>        parent.tag === <span class=
"org-string">'foreignObject'</span> ||
<span class=
"linenr"> 9746: </span>        parent.tag === <span class=
"org-string">'desc'</span> ||
<span class=
"linenr"> 9747: </span>        parent.tag === <span class=
"org-string">'title'</span>
<span class="linenr"> 9748: </span>      ) {
<span class="linenr"> 9749: </span>        ns = DOMNamespaces.HTML
<span class="linenr"> 9750: </span>      }
<span class="linenr"> 9751: </span>    }
<span class="linenr"> 9752: </span>
<span class="linenr"> 9753: </span>    <span class=
"org-keyword">if</span> (ns === DOMNamespaces.HTML) {
<span class="linenr"> 9754: </span>      <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'svg'</span>) {
<span class="linenr"> 9755: </span>        <span class=
"org-keyword">return</span> DOMNamespaces.SVG
<span class="linenr"> 9756: </span>      }
<span class="linenr"> 9757: </span>      <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'math'</span>) {
<span class="linenr"> 9758: </span>        <span class=
"org-keyword">return</span> DOMNamespaces.MATH_ML
<span class="linenr"> 9759: </span>      }
<span class="linenr"> 9760: </span>    }
<span class="linenr"> 9761: </span>    <span class=
"org-keyword">return</span> ns
<span class="linenr"> 9762: </span>  },
<span class="linenr"> 9763: </span>
<span class="linenr"> 9764: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">https://html.spec.whatwg.org/multipage/parsing.html#parsing-html-fragments</span>
<span class="linenr"> 9765: </span>  getTextMode({ tag, ns }) {
<span class="linenr"> 9766: </span>    <span class=
"org-keyword">if</span> (ns === DOMNamespaces.HTML) {
<span class="linenr"> 9767: </span>      <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'textarea'</span> || tag === <span class=
"org-string">'title'</span>) {
<span class="linenr"> 9768: </span>        <span class=
"org-keyword">return</span> TextModes.RCDATA
<span class="linenr"> 9769: </span>      }
<span class="linenr"> 9770: </span>      <span class=
"org-keyword">if</span> (isRawTextContainer(tag)) {
<span class="linenr"> 9771: </span>        <span class=
"org-keyword">return</span> TextModes.RAWTEXT
<span class="linenr"> 9772: </span>      }
<span class="linenr"> 9773: </span>    }
<span class="linenr"> 9774: </span>    <span class=
"org-keyword">return</span> TextModes.DATA
<span class="linenr"> 9775: </span>  }
<span class="linenr"> 9776: </span>}
<span class="linenr"> 9777: </span>
<span class="linenr"> 9778: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">hasDynamicKeyVBind</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr"> 9779: </span>  <span class=
"org-keyword">return</span> node.props.some(
<span class="linenr"> 9780: </span>    p =&gt;
<span class=
"linenr"> 9781: </span>      p.type === NodeTypes.DIRECTIVE &amp;&
<span class="linenr"> 9782: </span>      p.name === <span class=
"org-string">'bind'</span> &amp;&
<span class="linenr"> 9783: </span>      (!p.arg || <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-bind="obj"</span>
<span class=
"linenr"> 9784: </span>        p.arg.type !== NodeTypes.SIMPLE_EXPRESSION || <span class="org-comment-delimiter">// </span><span class="org-comment">v-bind:[_ctx.foo]</span>
<span class=
"linenr"> 9785: </span>        !p.arg.isStatic) <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">v-bind:[foo]</span>
<span class="linenr"> 9786: </span>  )
<span class="linenr"> 9787: </span>}
<span class="linenr"> 9788: </span>
<span class="linenr"> 9789: </span>
<span class="linenr"> 9790: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">hasMultipleChildren</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr"> 9791: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#1352 filter out potential comment nodes.</span>
<span class="linenr"> 9792: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">children</span> = (node.children = node.children.filter(
<span class="linenr"> 9793: </span>    c =&gt;
<span class=
"linenr"> 9794: </span>      c.type !== NodeTypes.COMMENT &amp;&
<span class=
"linenr"> 9795: </span>      !(c.type === NodeTypes.TEXT &amp;& !c.content.trim())
<span class="linenr"> 9796: </span>  ))
<span class="linenr"> 9797: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = children[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr"> 9798: </span>  <span class=
"org-keyword">return</span> (
<span class=
"linenr"> 9799: </span>    children.length !== <span class=
"org-highlight-numbers-number">1</span> ||
<span class=
"linenr"> 9800: </span>    child.type === NodeTypes.FOR ||
<span class=
"linenr"> 9801: </span>    (child.type === NodeTypes.IF &amp;& child.branches.some(hasMultipleChildren))
<span class="linenr"> 9802: </span>  )
<span class="linenr"> 9803: </span>}
<span class="linenr"> 9804: </span>
<span class="linenr"> 9805: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">warnTransitionChildren</span> = (node, context) =&gt; {
<span class="linenr"> 9806: </span>  <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 9807: </span>    node.type === NodeTypes.ELEMENT &amp;&
<span class=
"linenr"> 9808: </span>    node.tagType === ElementTypes.COMPONENT
<span class="linenr"> 9809: </span>  ) {
<span class="linenr"> 9810: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">component</span> = context.isBuiltInComponent(node.tag)
<span class="linenr"> 9811: </span>    <span class=
"org-keyword">if</span> (component === TRANSITION) {
<span class="linenr"> 9812: </span>      <span class=
"org-keyword">return</span> () =&gt; {
<span class="linenr"> 9813: </span>        <span class=
"org-keyword">if</span> (node.children.length &amp;& hasMultipleChildren(node)) {
<span class=
"linenr"> 9814: </span>          console.warn(<span class=
"org-string">`X_TRANSITION_INVALID_CHILDREN`</span>, node)
<span class="linenr"> 9815: </span>        }
<span class="linenr"> 9816: </span>      }
<span class="linenr"> 9817: </span>    }
<span class="linenr"> 9818: </span>  }
<span class="linenr"> 9819: </span>}
<span class="linenr"> 9820: </span>
<span class="linenr"> 9821: </span>
<span class="linenr"> 9822: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">ignoreSideEffectTags</span> = (node, context) =&gt; {
<span class="linenr"> 9823: </span>  <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 9824: </span>    node.type === NodeTypes.ELEMENT &amp;&
<span class=
"linenr"> 9825: </span>    node.tagType === ElementTypes.ELEMENT &amp;&
<span class="linenr"> 9826: </span>    (node.tag === <span class=
"org-string">'script'</span> || node.tag === <span class=
"org-string">'style'</span>)
<span class="linenr"> 9827: </span>  ) {
<span class="linenr"> 9828: </span>    console.warn(<span class=
"org-string">`X_IGNORED_SIDE_EFFECT_TAG`</span>)
<span class="linenr"> 9829: </span>    context.removeNode()
<span class="linenr"> 9830: </span>  }
<span class="linenr"> 9831: </span>}
<span class="linenr"> 9832: </span>
<span class="linenr"> 9833: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Parse inline CSS strings for static style attributes into an object.</span>
<span class="linenr"> 9834: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">This is a NodeTransform since it works on the static `style` attribute and</span>
<span class="linenr"> 9835: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">converts it into a dynamic equivalent:</span>
<span class="linenr"> 9836: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">style="color: red" -&gt; :style='{ "color": "red" }'</span>
<span class="linenr"> 9837: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">It is then processed by `transformElement` and included in the generated</span>
<span class="linenr"> 9838: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props.</span>
<span class="linenr"> 9839: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformStyleCD</span> = node =&gt; {
<span class="linenr"> 9840: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.ELEMENT) {
<span class=
"linenr"> 9841: </span>    node.props.forEach((p, i) =&gt; {
<span class="linenr"> 9842: </span>      <span class=
"org-keyword">if</span> (p.type === NodeTypes.ATTRIBUTE &amp;& p.name === <span class="org-string">'style'</span> &amp;& p.value) {
<span class="linenr"> 9843: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">replace p with an expression node</span>
<span class="linenr"> 9844: </span>        node.props[i] = {
<span class=
"linenr"> 9845: </span>          type: NodeTypes.DIRECTIVE,
<span class="linenr"> 9846: </span>          name: <span class=
"org-string">`bind`</span>,
<span class=
"linenr"> 9847: </span>          arg: createSimpleExpression(<span class="org-string">`style`</span>, <span class="org-constant">true</span>, p.loc),
<span class=
"linenr"> 9848: </span>          exp: parseInlineCSS(p.value.content, p.loc),
<span class="linenr"> 9849: </span>          modifiers: [],
<span class="linenr"> 9850: </span>          loc: p.loc
<span class="linenr"> 9851: </span>        }
<span class="linenr"> 9852: </span>      }
<span class="linenr"> 9853: </span>    })
<span class="linenr"> 9854: </span>  }
<span class="linenr"> 9855: </span>}
<span class="linenr"> 9856: </span>
<span class="linenr"> 9857: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">parseInlineCSS</span> = (cssText, loc) =&gt; {
<span class="linenr"> 9858: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">normalized</span> = parseStringStyle(cssText)
<span class="linenr"> 9859: </span>  <span class=
"org-keyword">return</span> createSimpleExpression(
<span class="linenr"> 9860: </span>    JSON.stringify(normalized),
<span class="linenr"> 9861: </span>    <span class=
"org-constant">false</span>,
<span class="linenr"> 9862: </span>    loc,
<span class="linenr"> 9863: </span>    ConstantTypes.CAN_STRINGIFY
<span class="linenr"> 9864: </span>  )
<span class="linenr"> 9865: </span>}
<span class="linenr"> 9866: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformVHtml</span> = (dir, node, context) =&gt; {
<span class="linenr"> 9867: </span>  <span class=
"org-keyword">const</span> { exp, loc } = dir
<span class="linenr"> 9868: </span>  <span class=
"org-keyword">if</span> (!exp) {
<span class="linenr"> 9869: </span>    logg(<span class=
"org-string">"v-html no exp"</span>)
<span class="linenr"> 9870: </span>  }
<span class="linenr"> 9871: </span>  <span class=
"org-keyword">if</span> (node.children.length) {
<span class="linenr"> 9872: </span>    logg(<span class=
"org-string">'v-html can not has children'</span>)
<span class=
"linenr"> 9873: </span>    node.children.length = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 9874: </span>  }
<span class="linenr"> 9875: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 9876: </span>    props: [
<span class="linenr"> 9877: </span>      createObjectProperty(
<span class=
"linenr"> 9878: </span>        createSimpleExpression(<span class=
"org-string">`innerHTML`</span>, <span class=
"org-constant">true</span>, loc),
<span class=
"linenr"> 9879: </span>        exp || createSimpleExpression(<span class="org-string">''</span>, <span class="org-constant">true</span>)
<span class="linenr"> 9880: </span>      )
<span class="linenr"> 9881: </span>    ]
<span class="linenr"> 9882: </span>  }
<span class="linenr"> 9883: </span>}
<span class="linenr"> 9884: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformVText</span> = (dir, node, context) =&gt; {
<span class="linenr"> 9885: </span>  <span class=
"org-keyword">const</span> { exp, loc } = dir
<span class="linenr"> 9886: </span>  <span class=
"org-keyword">if</span> (!exp) {
<span class="linenr"> 9887: </span>    logg(<span class=
"org-string">'v-text no exp'</span>)
<span class="linenr"> 9888: </span>  }
<span class="linenr"> 9889: </span>  <span class=
"org-keyword">if</span> (node.children.length) {
<span class="linenr"> 9890: </span>    logg(<span class=
"org-string">'v-text can not have children'</span>)
<span class=
"linenr"> 9891: </span>    node.children.length = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 9892: </span>  }
<span class="linenr"> 9893: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 9894: </span>    props: [
<span class="linenr"> 9895: </span>      createObjectProperty(
<span class=
"linenr"> 9896: </span>        createSimpleExpression(<span class=
"org-string">`textContent`</span>, <span class=
"org-constant">true</span>),
<span class="linenr"> 9897: </span>        exp
<span class=
"linenr"> 9898: </span>          ? createCallExpression(
<span class=
"linenr"> 9899: </span>              context.helperString(TO_DISPLAY_STRING),
<span class="linenr"> 9900: </span>              [exp],
<span class="linenr"> 9901: </span>              loc
<span class="linenr"> 9902: </span>            )
<span class=
"linenr"> 9903: </span>          : createSimpleExpression(<span class="org-string">''</span>, <span class="org-constant">true</span>)
<span class="linenr"> 9904: </span>      )
<span class="linenr"> 9905: </span>    ]
<span class="linenr"> 9906: </span>  }
<span class="linenr"> 9907: </span>}
<span class="linenr"> 9908: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformModelCD</span> = (dir, node, context) =&gt; {
<span class="linenr"> 9909: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">baseResult</span> = transformModel(dir, node, context)
<span class="linenr"> 9910: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">base transform has errors OR component v-model (only need props)</span>
<span class="linenr"> 9911: </span>  <span class=
"org-keyword">if</span> (!baseResult.props.length || node.tagType === ElementTypes.COMPONENT) {
<span class="linenr"> 9912: </span>    <span class=
"org-keyword">return</span> baseResult
<span class="linenr"> 9913: </span>  }
<span class="linenr"> 9914: </span>
<span class="linenr"> 9915: </span>  <span class=
"org-keyword">if</span> (dir.arg) {
<span class="linenr"> 9916: </span>    logg(<span class=
"org-string">"transfromModelCD - X_V_MODEL_ARG_ON_ELEMENT"</span>)
<span class="linenr"> 9917: </span>  }
<span class="linenr"> 9918: </span>
<span class="linenr"> 9919: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">checkDuplicatedValue</span>() {
<span class="linenr"> 9920: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">value</span> = findProp(node, <span class=
"org-string">'value'</span>)
<span class="linenr"> 9921: </span>    <span class=
"org-keyword">if</span> (value) {
<span class="linenr"> 9922: </span>      logg(<span class=
"org-string">"transfromModelCD - X_V_MODEL_UNNECESSARY_VALUE"</span>)
<span class="linenr"> 9923: </span>    }
<span class="linenr"> 9924: </span>  }
<span class="linenr"> 9925: </span>
<span class="linenr"> 9926: </span>  <span class=
"org-keyword">const</span> { tag } = node
<span class="linenr"> 9927: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isCustomElement</span> = context.isCustomElement(tag)
<span class="linenr"> 9928: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 9929: </span>    tag === <span class=
"org-string">'input'</span> ||
<span class="linenr"> 9930: </span>    tag === <span class=
"org-string">'textarea'</span> ||
<span class="linenr"> 9931: </span>    tag === <span class=
"org-string">'select'</span> ||
<span class="linenr"> 9932: </span>    isCustomElement
<span class="linenr"> 9933: </span>  ) {
<span class="linenr"> 9934: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">directiveToUse</span> = V_MODEL_TEXT
<span class="linenr"> 9935: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">isInvalidType</span> = <span class=
"org-constant">false</span>
<span class="linenr"> 9936: </span>    <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'input'</span> || isCustomElement) {
<span class="linenr"> 9937: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = findProp(node, <span class=
"org-string">`type`</span>)
<span class="linenr"> 9938: </span>      <span class=
"org-keyword">if</span> (type) {
<span class="linenr"> 9939: </span>        <span class=
"org-keyword">if</span> (type.type === NodeTypes.DIRECTIVE) {
<span class="linenr"> 9940: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">:type="foo"</span>
<span class=
"linenr"> 9941: </span>          directiveToUse = V_MODEL_DYNAMIC
<span class="linenr"> 9942: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (type.value) {
<span class="linenr"> 9943: </span>          <span class=
"org-keyword">switch</span> (type.value.content) {
<span class="linenr"> 9944: </span>            <span class=
"org-keyword">case</span> <span class="org-string">'radio'</span>:
<span class=
"linenr"> 9945: </span>              directiveToUse = V_MODEL_RADIO
<span class="linenr"> 9946: </span>              <span class=
"org-keyword">break</span>
<span class="linenr"> 9947: </span>            <span class=
"org-keyword">case</span> <span class=
"org-string">'checkbox'</span>:
<span class=
"linenr"> 9948: </span>              directiveToUse = V_MODEL_CHECKBOX
<span class="linenr"> 9949: </span>              <span class=
"org-keyword">break</span>
<span class="linenr"> 9950: </span>            <span class=
"org-keyword">case</span> <span class="org-string">'file'</span>:
<span class=
"linenr"> 9951: </span>              isInvalidType = <span class=
"org-constant">true</span>
<span class="linenr"> 9952: </span>              logg(<span class=
"org-string">"[DOM]transformModel - X_V_MODEL_ON_FILE_INPUT_ELEMENT"</span>)
<span class="linenr"> 9953: </span>              <span class=
"org-keyword">break</span>
<span class="linenr"> 9954: </span>            <span class=
"org-keyword">default</span>:
<span class="linenr"> 9955: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">text type</span>
<span class=
"linenr"> 9956: </span>              __DEV__ &amp;& checkDuplicatedValue()
<span class="linenr"> 9957: </span>              <span class=
"org-keyword">break</span>
<span class="linenr"> 9958: </span>          }
<span class="linenr"> 9959: </span>        }
<span class="linenr"> 9960: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (hasDynamicKeyVBind(node)) {
<span class="linenr"> 9961: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">element has bindings with dynamic keys, which can possibly contain</span>
<span class="linenr"> 9962: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">"type".</span>
<span class=
"linenr"> 9963: </span>        directiveToUse = V_MODEL_DYNAMIC
<span class="linenr"> 9964: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr"> 9965: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">text type</span>
<span class=
"linenr"> 9966: </span>        __DEV__ &amp;& checkDuplicatedValue()
<span class="linenr"> 9967: </span>      }
<span class="linenr"> 9968: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (tag === <span class=
"org-string">'select'</span>) {
<span class=
"linenr"> 9969: </span>      directiveToUse = V_MODEL_SELECT
<span class="linenr"> 9970: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 9971: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">textarea</span>
<span class=
"linenr"> 9972: </span>      __DEV__ &amp;& checkDuplicatedValue()
<span class="linenr"> 9973: </span>    }
<span class="linenr"> 9974: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject runtime directive</span>
<span class="linenr"> 9975: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">by returning the helper symbol via needRuntime</span>
<span class="linenr"> 9976: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the import will replaced a resolveDirective call.</span>
<span class="linenr"> 9977: </span>    <span class=
"org-keyword">if</span> (!isInvalidType) {
<span class=
"linenr"> 9978: </span>      baseResult.needRuntime = context.helper(directiveToUse)
<span class="linenr"> 9979: </span>    }
<span class="linenr"> 9980: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 9981: </span>    logg(<span class=
"org-string">"[DOM]transformModel - X_V_MODEL_ON_INVALID_ELEMENT"</span>)
<span class="linenr"> 9982: </span>  }
<span class="linenr"> 9983: </span>
<span class="linenr"> 9984: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">native vmodel doesn't need the `modelValue` props since they are also</span>
<span class="linenr"> 9985: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">passed to the runtime as `binding.value`. removing it reduces code size.</span>
<span class=
"linenr"> 9986: </span>  baseResult.props = baseResult.props.filter(
<span class="linenr"> 9987: </span>    p =&gt;
<span class="linenr"> 9988: </span>      !(
<span class=
"linenr"> 9989: </span>        p.key.type === NodeTypes.SIMPLE_EXPRESSION &amp;&
<span class=
"linenr"> 9990: </span>        p.key.content === <span class=
"org-string">'modelValue'</span>
<span class="linenr"> 9991: </span>      )
<span class="linenr"> 9992: </span>  )
<span class="linenr"> 9993: </span>
<span class="linenr"> 9994: </span>  <span class=
"org-keyword">return</span> baseResult
<span class="linenr"> 9995: </span>}
<span class="linenr"> 9996: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isEventOptionModifier</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(<span class=
"org-string">`passive,once,capture`</span>)
<span class="linenr"> 9997: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isNonKeyModifier</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr"> 9998: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">event propagation management</span>
<span class="linenr"> 9999: </span>  <span class=
"org-string">`stop,prevent,self,`</span> +
<span class="linenr">10000: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">system modifiers + exact</span>
<span class="linenr">10001: </span>    <span class=
"org-string">`ctrl,shift,alt,meta,exact,`</span> +
<span class="linenr">10002: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">mouse</span>
<span class="linenr">10003: </span>    <span class=
"org-string">`middle`</span>
<span class="linenr">10004: </span>)
<span class="linenr">10005: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">left & right could be mouse or key modifiers based on event type</span>
<span class="linenr">10006: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">maybeKeyModifier</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(<span class=
"org-string">'left,right'</span>)
<span class="linenr">10007: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isKeyboardEvent</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr">10008: </span>  <span class=
"org-string">`onkeyup,onkeydown,onkeypress`</span>,
<span class="linenr">10009: </span>  <span class=
"org-constant">true</span>
<span class="linenr">10010: </span>)
<span class="linenr">10011: </span>
<span class="linenr">10012: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">将修饰符分类</span>
<span class="linenr">10013: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">resolveModifiers</span> = (key, modifiers, context, loc) =&gt; {
<span class="linenr">10014: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyModifiers</span> = []
<span class="linenr">10015: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">nonKeyModifiers</span> = []
<span class="linenr">10016: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">eventOptionModifiers</span> = []
<span class="linenr">10017: </span>
<span class="linenr">10018: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; modifiers.length; i++) {
<span class="linenr">10019: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">modifier</span> = modifiers[i]
<span class="linenr">10020: </span>
<span class="linenr">10021: </span>    <span class=
"org-keyword">if</span> (isEventOptionModifier(modifier)) {
<span class="linenr">10022: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">eventOptionModifiers: modifiers for addEventListener() options,</span>
<span class="linenr">10023: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">e.g. .passive & .capture</span>
<span class=
"linenr">10024: </span>      eventOptionModifiers.push(modifier)
<span class="linenr">10025: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">10026: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">runtimeModifiers: modifiers that needs runtime guards</span>
<span class="linenr">10027: </span>      <span class=
"org-keyword">if</span> (maybeKeyModifier(modifier)) {
<span class="linenr">10028: </span>        <span class=
"org-keyword">if</span> (isStaticExp(key)) {
<span class="linenr">10029: </span>          <span class=
"org-keyword">if</span> (isKeyboardEvent(key.content)) {
<span class=
"linenr">10030: </span>            keyModifiers.push(modifier)
<span class="linenr">10031: </span>          } <span class=
"org-keyword">else</span> {
<span class=
"linenr">10032: </span>            nonKeyModifiers.push(modifier)
<span class="linenr">10033: </span>          }
<span class="linenr">10034: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr">10035: </span>          keyModifiers.push(modifier)
<span class=
"linenr">10036: </span>          nonKeyModifiers.push(modifier)
<span class="linenr">10037: </span>        }
<span class="linenr">10038: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">10039: </span>        <span class=
"org-keyword">if</span> (isNonKeyModifier(modifier)) {
<span class=
"linenr">10040: </span>          nonKeyModifiers.push(modifier)
<span class="linenr">10041: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr">10042: </span>          keyModifiers.push(modifier)
<span class="linenr">10043: </span>        }
<span class="linenr">10044: </span>      }
<span class="linenr">10045: </span>    }
<span class="linenr">10046: </span>  }
<span class="linenr">10047: </span>
<span class="linenr">10048: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr">10049: </span>    keyModifiers,
<span class="linenr">10050: </span>    nonKeyModifiers,
<span class="linenr">10051: </span>    eventOptionModifiers
<span class="linenr">10052: </span>  }
<span class="linenr">10053: </span>}
<span class="linenr">10054: </span>
<span class="linenr">10055: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">原生 click 事件</span>
<span class="linenr">10056: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformClick</span> = (key, event) =&gt; {
<span class="linenr">10057: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isStaticClick</span> =
<span class=
"linenr">10058: </span>    isStaticExp(key) &amp;& key.content.toLowerCase() === <span class="org-string">'onclick'</span>
<span class="linenr">10059: </span>  <span class=
"org-keyword">return</span> isStaticClick
<span class=
"linenr">10060: </span>    ? createSimpleExpression(event, <span class="org-constant">true</span>)
<span class=
"linenr">10061: </span>    : key.type !== NodeTypes.SIMPLE_EXPRESSION
<span class="linenr">10062: </span>    ? createCompoundExpression([
<span class="linenr">10063: </span>        <span class=
"org-string">`(`</span>,
<span class="linenr">10064: </span>        key,
<span class="linenr">10065: </span>        <span class=
"org-string">`) === "onClick" ? "${event}" : (`</span>,
<span class="linenr">10066: </span>        key,
<span class="linenr">10067: </span>        <span class=
"org-string">`)`</span>
<span class="linenr">10068: </span>      ])
<span class="linenr">10069: </span>    : key
<span class="linenr">10070: </span>}
<span class="linenr">10071: </span>
<span class="linenr">10072: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformOnCD</span> = (dir, node, context) =&gt; {
<span class="linenr">10073: </span>  <span class=
"org-keyword">return</span> transformOn(dir, node, context, baseResult =&gt; {
<span class="linenr">10074: </span>    <span class=
"org-keyword">const</span> { modifiers } = dir
<span class="linenr">10075: </span>    <span class=
"org-keyword">if</span> (!modifiers.length) <span class=
"org-keyword">return</span> baseResult
<span class="linenr">10076: </span>
<span class="linenr">10077: </span>    <span class=
"org-keyword">let</span> { key, value: handlerExp } = baseResult.props[<span class="org-highlight-numbers-number">0</span>]
<span class="linenr">10078: </span>    <span class=
"org-keyword">const</span> { keyModifiers, nonKeyModifiers, eventOptionModifiers } =
<span class=
"linenr">10079: </span>      resolveModifiers(key, modifiers, context, dir.loc)
<span class="linenr">10080: </span>
<span class="linenr">10081: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">normalize click.right and click.middle since they don't actually fire</span>
<span class="linenr">10082: </span>    <span class=
"org-keyword">if</span> (nonKeyModifiers.includes(<span class=
"org-string">'right'</span>)) {
<span class=
"linenr">10083: </span>      key = transformClick(key, <span class=
"org-string">`onContextmenu`</span>)
<span class="linenr">10084: </span>    }
<span class="linenr">10085: </span>    <span class=
"org-keyword">if</span> (nonKeyModifiers.includes(<span class=
"org-string">'middle'</span>)) {
<span class=
"linenr">10086: </span>      key = transformClick(key, <span class=
"org-string">`onMouseup`</span>)
<span class="linenr">10087: </span>    }
<span class="linenr">10088: </span>
<span class="linenr">10089: </span>    <span class=
"org-keyword">if</span> (nonKeyModifiers.length) {
<span class=
"linenr">10090: </span>      handlerExp = createCallExpression(context.helper(V_ON_WITH_MODIFIERS), [
<span class="linenr">10091: </span>        handlerExp,
<span class=
"linenr">10092: </span>        JSON.stringify(nonKeyModifiers)
<span class="linenr">10093: </span>      ])
<span class="linenr">10094: </span>    }
<span class="linenr">10095: </span>
<span class="linenr">10096: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr">10097: </span>      keyModifiers.length &amp;&
<span class="linenr">10098: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if event name is dynamic, always wrap with keys guard</span>
<span class=
"linenr">10099: </span>      (!isStaticExp(key) || isKeyboardEvent(key.content))
<span class="linenr">10100: </span>    ) {
<span class=
"linenr">10101: </span>      handlerExp = createCallExpression(context.helper(V_ON_WITH_KEYS), [
<span class="linenr">10102: </span>        handlerExp,
<span class=
"linenr">10103: </span>        JSON.stringify(keyModifiers)
<span class="linenr">10104: </span>      ])
<span class="linenr">10105: </span>    }
<span class="linenr">10106: </span>
<span class="linenr">10107: </span>    <span class=
"org-keyword">if</span> (eventOptionModifiers.length) {
<span class="linenr">10108: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">modifierPostfix</span> = eventOptionModifiers.map(capitalize).join(<span class="org-string">''</span>)
<span class="linenr">10109: </span>      key = isStaticExp(key)
<span class=
"linenr">10110: </span>        ? createSimpleExpression(<span class="org-string">`${key.content}${modifierPostfix}`</span>, <span class="org-constant">true</span>)
<span class=
"linenr">10111: </span>        : createCompoundExpression([<span class="org-string">`(`</span>, key, <span class="org-string">`) + "${modifierPostfix}"`</span>])
<span class="linenr">10112: </span>    }
<span class="linenr">10113: </span>
<span class="linenr">10114: </span>    <span class=
"org-keyword">return</span> {
<span class=
"linenr">10115: </span>      props: [createObjectProperty(key, handlerExp)]
<span class="linenr">10116: </span>    }
<span class="linenr">10117: </span>  })
<span class="linenr">10118: </span>}
<span class="linenr">10119: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformShowCD</span> = (dir, node, context) =&gt; {
<span class="linenr">10120: </span>  <span class=
"org-keyword">const</span> { exp, loc } = dir
<span class="linenr">10121: </span>  <span class=
"org-keyword">if</span> (!exp) {
<span class="linenr">10122: </span>    logg(<span class=
"org-string">'transformShowCD no exp.'</span>)
<span class="linenr">10123: </span>  }
<span class="linenr">10124: </span>
<span class="linenr">10125: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr">10126: </span>    props: [],
<span class=
"linenr">10127: </span>    needRuntime: context.helper(V_SHOW)
<span class="linenr">10128: </span>  }
<span class="linenr">10129: </span>}
<span class="linenr">10130: </span> <span class=
"org-keyword">const</span> <span class=
"org-variable-name">StringifyThresholds</span> = {
<span class=
"linenr">10131: </span>   ELEMENT_WITH_BINDING_COUNT: <span class=
"org-highlight-numbers-number">5</span>,
<span class="linenr">10132: </span>   NODE_COUNT: <span class=
"org-highlight-numbers-number">20</span>
<span class="linenr">10133: </span>}
<span class="linenr">10134: </span>
<span class="linenr">10135: </span><span class="org-doc">/**</span>
<span class="linenr">10136: </span><span class=
"org-doc"> * Regex for replacing placeholders for embedded constant variables</span>
<span class="linenr">10137: </span><span class=
"org-doc"> * (e.g. import URL string constants generated by compiler-sfc)</span>
<span class="linenr">10138: </span><span class="org-doc"> */</span>
<span class="linenr">10139: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">expReplaceRE</span> = <span class=
"org-string">/__VUE_EXP_START__(.*?)__VUE_EXP_END__/</span>g
<span class="linenr">10140: </span>
<span class="linenr">10141: </span><span class="org-doc">/**</span>
<span class="linenr">10142: </span><span class=
"org-doc"> * Turn eligible hoisted static trees into stringified static nodes, e.g.</span>
<span class="linenr">10143: </span><span class="org-doc"> *</span>
<span class="linenr">10144: </span><span class=
"org-doc"> * ```js</span>
<span class="linenr">10145: </span><span class=
"org-doc"> * const _hoisted_1 = createStaticVNode(`&lt;div class="foo"&gt;bar&lt;/div&gt;`)</span>
<span class="linenr">10146: </span><span class=
"org-doc"> * ```</span>
<span class="linenr">10147: </span><span class="org-doc"> *</span>
<span class="linenr">10148: </span><span class=
"org-doc"> * A single static vnode can contain stringified content for **multiple**</span>
<span class="linenr">10149: </span><span class=
"org-doc"> * consecutive nodes (element and plain text), called a "chunk".</span>
<span class="linenr">10150: </span><span class=
"org-doc"> * `@vue/runtime-dom` will create the content via innerHTML in a hidden</span>
<span class="linenr">10151: </span><span class=
"org-doc"> * container element and insert all the nodes in place. The call must also</span>
<span class="linenr">10152: </span><span class=
"org-doc"> * provide the number of nodes contained in the chunk so that during hydration</span>
<span class="linenr">10153: </span><span class=
"org-doc"> * we can know how many nodes the static vnode should adopt.</span>
<span class="linenr">10154: </span><span class="org-doc"> *</span>
<span class="linenr">10155: </span><span class=
"org-doc"> * The optimization scans a children list that contains hoisted nodes, and</span>
<span class="linenr">10156: </span><span class=
"org-doc"> * tries to find the largest chunk of consecutive hoisted nodes before running</span>
<span class="linenr">10157: </span><span class=
"org-doc"> * into a non-hoisted node or the end of the list. A chunk is then converted</span>
<span class="linenr">10158: </span><span class=
"org-doc"> * into a single static vnode and replaces the hoisted expression of the first</span>
<span class="linenr">10159: </span><span class=
"org-doc"> * node in the chunk. Other nodes in the chunk are considered "merged" and</span>
<span class="linenr">10160: </span><span class=
"org-doc"> * therefore removed from both the hoist list and the children array.</span>
<span class="linenr">10161: </span><span class="org-doc"> *</span>
<span class="linenr">10162: </span><span class=
"org-doc"> * This optimization is only performed in Node.js.</span>
<span class="linenr">10163: </span><span class="org-doc"> */</span>
<span class="linenr">10164: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">stringifyStatic</span> = (children, context, parent) =&gt; {
<span class="linenr">10165: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">bail stringification for slot content</span>
<span class="linenr">10166: </span>  <span class=
"org-keyword">if</span> (context.scopes.vSlot &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr">10167: </span>    <span class=
"org-keyword">return</span>
<span class="linenr">10168: </span>  }
<span class="linenr">10169: </span>
<span class="linenr">10170: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">nc</span> = <span class=
"org-highlight-numbers-number">0</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">current node count</span>
<span class="linenr">10171: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">ec</span> = <span class=
"org-highlight-numbers-number">0</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">current element with binding count</span>
<span class="linenr">10172: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">currentChunk</span> = []
<span class="linenr">10173: </span>
<span class="linenr">10174: </span>  logg(<span class=
"org-string">`stringifyStatic - children.length = ${children.length}`</span>)
<span class="linenr">10175: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">stringifyCurrentChunk</span> = (currentIndex) =&gt; {
<span class="linenr">10176: </span>    <span class=
"org-keyword">if</span> (
<span class=
"linenr">10177: </span>      nc &gt;= StringifyThresholds.NODE_COUNT ||
<span class=
"linenr">10178: </span>      ec &gt;= StringifyThresholds.ELEMENT_WITH_BINDING_COUNT
<span class="linenr">10179: </span>    ) {
<span class="linenr">10180: </span>      logg(<span class=
"org-string">`stringifyCurrentChunk - index = ${currentIndex}`</span>)
<span class="linenr">10181: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">combine all currently eligible nodes into a single static vnode call</span>
<span class="linenr">10182: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">staticCall</span> = createCallExpression(context.helper(CREATE_STATIC), [
<span class="linenr">10183: </span>        JSON.stringify(
<span class=
"linenr">10184: </span>          currentChunk.map(node =&gt; stringifyNode(node, context)).join(<span class="org-string">''</span>)
<span class=
"linenr">10185: </span>        ).replace(expReplaceRE, <span class=
"org-string">`" + $1 + "`</span>),
<span class="linenr">10186: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the 2nd argument indicates the number of DOM nodes this static vnode</span>
<span class="linenr">10187: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">will insert / hydrate</span>
<span class=
"linenr">10188: </span>        String(currentChunk.length)
<span class="linenr">10189: </span>      ])
<span class="linenr">10190: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">replace the first node's hoisted expression with the static vnode call</span>
<span class=
"linenr">10191: </span>      replaceHoist(currentChunk[<span class=
"org-highlight-numbers-number">0</span>], staticCall, context)
<span class="linenr">10192: </span>
<span class="linenr">10193: </span>      <span class=
"org-keyword">if</span> (currentChunk.length &gt; <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr">10194: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">1</span>; i &lt; currentChunk.length; i++) {
<span class="linenr">10195: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for the merged nodes, set their hoisted expression to null</span>
<span class=
"linenr">10196: </span>          replaceHoist(currentChunk[i], <span class="org-constant">null</span>, context)
<span class="linenr">10197: </span>        }
<span class="linenr">10198: </span>
<span class="linenr">10199: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">also remove merged nodes from children</span>
<span class="linenr">10200: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">deleteCount</span> = currentChunk.length - <span class="org-highlight-numbers-number">1</span>
<span class=
"linenr">10201: </span>        children.splice(currentIndex - currentChunk.length + <span class="org-highlight-numbers-number">1</span>, deleteCount)
<span class="linenr">10202: </span>        <span class=
"org-keyword">return</span> deleteCount
<span class="linenr">10203: </span>      }
<span class="linenr">10204: </span>    }
<span class="linenr">10205: </span>    <span class=
"org-keyword">return</span> <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">10206: </span>  }
<span class="linenr">10207: </span>
<span class="linenr">10208: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">10209: </span>  <span class=
"org-keyword">for</span> (; i &lt; children.length; i++) {
<span class="linenr">10210: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = children[i]
<span class="linenr">10211: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hoisted</span> = getHoistedNode(child)
<span class="linenr">10212: </span>    <span class=
"org-keyword">if</span> (hoisted) {
<span class="linenr">10213: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">presence of hoisted means child must be a stringifiable node</span>
<span class="linenr">10214: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> = child
<span class="linenr">10215: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">result</span> = analyzeNode(node)
<span class="linenr">10216: </span>      <span class=
"org-keyword">if</span> (result) {
<span class="linenr">10217: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">node is stringifiable, record state</span>
<span class=
"linenr">10218: </span>        nc += result[<span class="org-highlight-numbers-number">0</span>]
<span class=
"linenr">10219: </span>        ec += result[<span class="org-highlight-numbers-number">1</span>]
<span class="linenr">10220: </span>        currentChunk.push(node)
<span class="linenr">10221: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr">10222: </span>      }
<span class="linenr">10223: </span>    }
<span class="linenr">10224: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we only reach here if we ran into a node that is not stringifiable</span>
<span class="linenr">10225: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check if currently analyzed nodes meet criteria for stringification.</span>
<span class="linenr">10226: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">adjust iteration index</span>
<span class=
"linenr">10227: </span>    i -= stringifyCurrentChunk(i)
<span class="linenr">10228: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">reset state</span>
<span class="linenr">10229: </span>    nc = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">10230: </span>    ec = <span class=
"org-highlight-numbers-number">0</span>
<span class=
"linenr">10231: </span>    currentChunk.length = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">10232: </span>  }
<span class="linenr">10233: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in case the last node was also stringifiable</span>
<span class="linenr">10234: </span>  stringifyCurrentChunk(i)
<span class="linenr">10235: </span>}
<span class="linenr">10236: </span>
<span class="linenr">10237: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">getHoistedNode</span> = (node) =&gt;
<span class=
"linenr">10238: </span>  ((node.type === NodeTypes.ELEMENT &amp;& node.tagType === ElementTypes.ELEMENT) ||
<span class=
"linenr">10239: </span>    node.type == NodeTypes.TEXT_CALL) &amp;&
<span class="linenr">10240: </span>  node.codegenNode &amp;&
<span class=
"linenr">10241: </span>  node.codegenNode.type === NodeTypes.SIMPLE_EXPRESSION &amp;&
<span class="linenr">10242: </span>  node.codegenNode.hoisted
<span class="linenr">10243: </span>
<span class="linenr">10244: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">dataAriaRE</span> = <span class=
"org-string">/^(data|aria)-/</span>
<span class="linenr">10245: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isStringifiableAttr</span> = (name, ns) =&gt; {
<span class="linenr">10246: </span>  <span class=
"org-keyword">return</span> (
<span class="linenr">10247: </span>    (ns === DOMNamespaces.HTML
<span class="linenr">10248: </span>      ? isKnownHtmlAttr(name)
<span class="linenr">10249: </span>      : ns === DOMNamespaces.SVG
<span class="linenr">10250: </span>      ? isKnownSvgAttr(name)
<span class="linenr">10251: </span>      : <span class=
"org-constant">false</span>) || dataAriaRE.test(name)
<span class="linenr">10252: </span>  )
<span class="linenr">10253: </span>}
<span class="linenr">10254: </span>
<span class="linenr">10255: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">replaceHoist</span> = (node,replacement,context) =&gt; {
<span class="linenr">10256: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hoistToReplace</span> = node.codegenNode.hoisted
<span class=
"linenr">10257: </span>  context.hoists[context.hoists.indexOf(hoistToReplace)] = replacement
<span class="linenr">10258: </span>}
<span class="linenr">10259: </span>
<span class="linenr">10260: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isNonStringifiable</span> = <span class=
"org-comment-delimiter">/*</span><span class=
"org-comment">#__PURE__</span><span class=
"org-comment-delimiter">*/</span> makeMap(
<span class="linenr">10261: </span>  <span class=
"org-string">`caption,thead,tr,th,tbody,td,tfoot,colgroup,col`</span>
<span class="linenr">10262: </span>)
<span class="linenr">10263: </span>
<span class="linenr">10264: </span><span class="org-doc">/**</span>
<span class="linenr">10265: </span><span class=
"org-doc"> * for a hoisted node, analyze it and return:</span>
<span class="linenr">10266: </span><span class=
"org-doc"> * - false: bailed (contains non-stringifiable props or runtime constant)</span>
<span class="linenr">10267: </span><span class=
"org-doc"> * - [nc, ec] where</span>
<span class="linenr">10268: </span><span class=
"org-doc"> *   - nc is the number of nodes inside</span>
<span class="linenr">10269: </span><span class=
"org-doc"> *   - ec is the number of element with bindings inside</span>
<span class="linenr">10270: </span><span class="org-doc"> */</span>
<span class="linenr">10271: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">analyzeNode</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">10272: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.ELEMENT &amp;& isNonStringifiable(node.tag)) {
<span class="linenr">10273: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">10274: </span>  }
<span class="linenr">10275: </span>
<span class="linenr">10276: </span>  <span class=
"org-keyword">if</span> (node.type === NodeTypes.TEXT_CALL) {
<span class="linenr">10277: </span>    <span class=
"org-keyword">return</span> [<span class=
"org-highlight-numbers-number">1</span>, <span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr">10278: </span>  }
<span class="linenr">10279: </span>
<span class="linenr">10280: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">nc</span> = <span class=
"org-highlight-numbers-number">1</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">node count</span>
<span class="linenr">10281: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">ec</span> = node.props.length &gt; <span class=
"org-highlight-numbers-number">0</span> ? <span class=
"org-highlight-numbers-number">1</span> : <span class=
"org-highlight-numbers-number">0</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">element w/ binding count</span>
<span class="linenr">10282: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">bailed</span> = <span class=
"org-constant">false</span>
<span class="linenr">10283: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bail</span> = () =&gt; {
<span class="linenr">10284: </span>    bailed = <span class=
"org-constant">true</span>
<span class="linenr">10285: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">10286: </span>  }
<span class="linenr">10287: </span>
<span class="linenr">10288: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO:</span></span></span><span class=
"org-comment"> check for cases where using innerHTML will result in different</span>
<span class="linenr">10289: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">output compared to imperative node insertions.</span>
<span class="linenr">10290: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">probably only need to check for most common case</span>
<span class="linenr">10291: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">i.e. non-phrasing-content tags inside `&lt;p&gt;`</span>
<span class="linenr">10292: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">walk</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">10293: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr">10294: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = node.props[i]
<span class="linenr">10295: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">bail on non-attr bindings</span>
<span class="linenr">10296: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr">10297: </span>        p.type === NodeTypes.ATTRIBUTE &amp;&
<span class=
"linenr">10298: </span>        !isStringifiableAttr(p.name, node.ns)
<span class="linenr">10299: </span>      ) {
<span class="linenr">10300: </span>        <span class=
"org-keyword">return</span> bail()
<span class="linenr">10301: </span>      }
<span class="linenr">10302: </span>      <span class=
"org-keyword">if</span> (p.type === NodeTypes.DIRECTIVE &amp;& p.name === <span class="org-string">'bind'</span>) {
<span class="linenr">10303: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">bail on non-attr bindings</span>
<span class="linenr">10304: </span>        <span class=
"org-keyword">if</span> (
<span class="linenr">10305: </span>          p.arg &amp;&
<span class=
"linenr">10306: </span>          (p.arg.type === NodeTypes.COMPOUND_EXPRESSION ||
<span class=
"linenr">10307: </span>            (p.arg.isStatic &amp;& !isStringifiableAttr(p.arg.content, node.ns)))
<span class="linenr">10308: </span>        ) {
<span class="linenr">10309: </span>          <span class=
"org-keyword">return</span> bail()
<span class="linenr">10310: </span>        }
<span class="linenr">10311: </span>        <span class=
"org-keyword">if</span> (
<span class="linenr">10312: </span>          p.exp &amp;&
<span class=
"linenr">10313: </span>          (p.exp.type === NodeTypes.COMPOUND_EXPRESSION ||
<span class=
"linenr">10314: </span>            p.exp.constType &lt; ConstantTypes.CAN_STRINGIFY)
<span class="linenr">10315: </span>        ) {
<span class="linenr">10316: </span>          <span class=
"org-keyword">return</span> bail()
<span class="linenr">10317: </span>        }
<span class="linenr">10318: </span>      }
<span class="linenr">10319: </span>    }
<span class="linenr">10320: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.children.length; i++) {
<span class="linenr">10321: </span>      nc++
<span class="linenr">10322: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">child</span> = node.children[i]
<span class="linenr">10323: </span>      <span class=
"org-keyword">if</span> (child.type === NodeTypes.ELEMENT) {
<span class="linenr">10324: </span>        <span class=
"org-keyword">if</span> (child.props.length &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr">10325: </span>          ec++
<span class="linenr">10326: </span>        }
<span class="linenr">10327: </span>        walk(child)
<span class="linenr">10328: </span>        <span class=
"org-keyword">if</span> (bailed) {
<span class="linenr">10329: </span>          <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">10330: </span>        }
<span class="linenr">10331: </span>      }
<span class="linenr">10332: </span>    }
<span class="linenr">10333: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">10334: </span>  }
<span class="linenr">10335: </span>
<span class="linenr">10336: </span>  <span class=
"org-keyword">return</span> walk(node) ? [nc, ec] : <span class=
"org-constant">false</span>
<span class="linenr">10337: </span>}
<span class="linenr">10338: </span>
<span class="linenr">10339: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">stringifyNode</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr">10340: </span>  <span class=
"org-keyword">if</span> (isString(node)) {
<span class="linenr">10341: </span>    <span class=
"org-keyword">return</span> node
<span class="linenr">10342: </span>  }
<span class="linenr">10343: </span>  <span class=
"org-keyword">if</span> (isSymbol(node)) {
<span class="linenr">10344: </span>    <span class=
"org-keyword">return</span> <span class="org-string">``</span>
<span class="linenr">10345: </span>  }
<span class="linenr">10346: </span>  <span class=
"org-keyword">switch</span> (node.type) {
<span class="linenr">10347: </span>    <span class=
"org-keyword">case</span> NodeTypes.ELEMENT:
<span class="linenr">10348: </span>      <span class=
"org-keyword">return</span> stringifyElement(node, context)
<span class="linenr">10349: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT:
<span class="linenr">10350: </span>      <span class=
"org-keyword">return</span> escapeHtml(node.content)
<span class="linenr">10351: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMMENT:
<span class="linenr">10352: </span>      <span class=
"org-keyword">return</span> <span class=
"org-string">`&lt;!--${escapeHtml(node.content)}--&gt;`</span>
<span class="linenr">10353: </span>    <span class=
"org-keyword">case</span> NodeTypes.INTERPOLATION:
<span class="linenr">10354: </span>      <span class=
"org-keyword">return</span> escapeHtml(toDisplayString(evaluateConstant(node.content)))
<span class="linenr">10355: </span>    <span class=
"org-keyword">case</span> NodeTypes.COMPOUND_EXPRESSION:
<span class="linenr">10356: </span>      <span class=
"org-keyword">return</span> escapeHtml(evaluateConstant(node))
<span class="linenr">10357: </span>    <span class=
"org-keyword">case</span> NodeTypes.TEXT_CALL:
<span class="linenr">10358: </span>      <span class=
"org-keyword">return</span> stringifyNode(node.content, context)
<span class="linenr">10359: </span>    <span class=
"org-keyword">default</span>:
<span class="linenr">10360: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">static trees will not contain if/for nodes</span>
<span class="linenr">10361: </span>      <span class=
"org-keyword">return</span> <span class="org-string">''</span>
<span class="linenr">10362: </span>  }
<span class="linenr">10363: </span>}
<span class="linenr">10364: </span>
<span class="linenr">10365: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">stringifyElement</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">context</span>) {
<span class="linenr">10366: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">res</span> = <span class=
"org-string">`&lt;${node.tag}`</span>
<span class="linenr">10367: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr">10368: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> = node.props[i]
<span class="linenr">10369: </span>    <span class=
"org-keyword">if</span> (p.type === NodeTypes.ATTRIBUTE) {
<span class="linenr">10370: </span>      res += <span class=
"org-string">` ${p.name}`</span>
<span class="linenr">10371: </span>      <span class=
"org-keyword">if</span> (p.value) {
<span class="linenr">10372: </span>        res += <span class=
"org-string">`="${escapeHtml(p.value.content)}"`</span>
<span class="linenr">10373: </span>      }
<span class="linenr">10374: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.type === NodeTypes.DIRECTIVE &amp;& p.name === <span class="org-string">'bind'</span>) {
<span class="linenr">10375: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exp</span> = p.exp
<span class="linenr">10376: </span>      <span class=
"org-keyword">if</span> (exp.content[<span class=
"org-highlight-numbers-number">0</span>] === <span class=
"org-string">'_'</span>) {
<span class="linenr">10377: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">internally generated string constant references</span>
<span class="linenr">10378: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">e.g. imported URL strings via compiler-sfc transformAssetUrl plugin</span>
<span class="linenr">10379: </span>        res += <span class=
"org-string">` ${p.arg.content}="__VUE_EXP_START__${</span>
<span class="linenr">10380: </span><span class=
"org-string">          exp.content</span>
<span class="linenr">10381: </span><span class=
"org-string">        }__VUE_EXP_END__"`</span>
<span class="linenr">10382: </span>        <span class=
"org-keyword">continue</span>
<span class="linenr">10383: </span>      }
<span class="linenr">10384: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">constant v-bind, e.g. :foo="1"</span>
<span class="linenr">10385: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">evaluated</span> = evaluateConstant(exp)
<span class="linenr">10386: </span>      <span class=
"org-keyword">if</span> (evaluated != <span class=
"org-constant">null</span>) {
<span class="linenr">10387: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">arg</span> = p.arg &amp;& p.arg.content
<span class="linenr">10388: </span>        <span class=
"org-keyword">if</span> (arg === <span class=
"org-string">'class'</span>) {
<span class=
"linenr">10389: </span>          evaluated = normalizeClass(evaluated)
<span class="linenr">10390: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (arg === <span class=
"org-string">'style'</span>) {
<span class=
"linenr">10391: </span>          evaluated = stringifyStyle(normalizeStyle(evaluated))
<span class="linenr">10392: </span>        }
<span class="linenr">10393: </span>        res += <span class=
"org-string">` ${p.arg.content}="${escapeHtml(evaluated)}"`</span>
<span class="linenr">10394: </span>      }
<span class="linenr">10395: </span>    }
<span class="linenr">10396: </span>  }
<span class="linenr">10397: </span>  <span class=
"org-keyword">if</span> (context.scopeId) {
<span class="linenr">10398: </span>    res += <span class=
"org-string">` ${context.scopeId}`</span>
<span class="linenr">10399: </span>  }
<span class="linenr">10400: </span>  res += <span class=
"org-string">`&gt;`</span>
<span class="linenr">10401: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.children.length; i++) {
<span class=
"linenr">10402: </span>    res += stringifyNode(node.children[i], context)
<span class="linenr">10403: </span>  }
<span class="linenr">10404: </span>  <span class=
"org-keyword">if</span> (!isVoidTag(node.tag)) {
<span class="linenr">10405: </span>    res += <span class=
"org-string">`&lt;/${node.tag}&gt;`</span>
<span class="linenr">10406: </span>  }
<span class="linenr">10407: </span>  <span class=
"org-keyword">return</span> res
<span class="linenr">10408: </span>}
<span class="linenr">10409: </span>
<span class="linenr">10410: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">__UNSAFE__</span>
<span class="linenr">10411: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Reason: eval.</span>
<span class="linenr">10412: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">It's technically safe to eval because only constant expressions are possible</span>
<span class="linenr">10413: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">here, e.g. `{{ 1 }}` or `{{ 'foo' }}`</span>
<span class="linenr">10414: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in addition, constant exps bail on presence of parens so you can't even</span>
<span class="linenr">10415: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">run JSFuck in here. But we mark it unsafe for security review purposes.</span>
<span class="linenr">10416: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">(see compiler-core/src/transformExpressions)</span>
<span class="linenr">10417: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">evaluateConstant</span>(<span class=
"org-variable-name">exp</span>) {
<span class="linenr">10418: </span>  <span class=
"org-keyword">if</span> (exp.type === NodeTypes.SIMPLE_EXPRESSION) {
<span class="linenr">10419: </span>    <span class=
"org-keyword">return</span> <span class=
"org-keyword">new</span> <span class=
"org-type">Function</span>(<span class=
"org-string">`return ${exp.content}`</span>)()
<span class="linenr">10420: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">10421: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">compound</span>
<span class="linenr">10422: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">res</span> = <span class="org-string">``</span>
<span class=
"linenr">10423: </span>    exp.children.forEach(c =&gt; {
<span class="linenr">10424: </span>      <span class=
"org-keyword">if</span> (isString(c) || isSymbol(c)) {
<span class="linenr">10425: </span>        <span class=
"org-keyword">return</span>
<span class="linenr">10426: </span>      }
<span class="linenr">10427: </span>      <span class=
"org-keyword">if</span> (c.type === NodeTypes.TEXT) {
<span class="linenr">10428: </span>        res += c.content
<span class="linenr">10429: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (c.type === NodeTypes.INTERPOLATION) {
<span class=
"linenr">10430: </span>        res += toDisplayString(evaluateConstant(c.content))
<span class="linenr">10431: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr">10432: </span>        res += evaluateConstant(c)
<span class="linenr">10433: </span>      }
<span class="linenr">10434: </span>    })
<span class="linenr">10435: </span>    <span class=
"org-keyword">return</span> res
<span class="linenr">10436: </span>  }
<span class="linenr">10437: </span>}
<span class="linenr">10438: </span>
<span class="linenr">10439: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">DOMDirectiveTransforms</span> = {
<span class="linenr">10440: </span>  cloak: noopDirectiveTransform,
<span class="linenr">10441: </span>  html: transformVHtml,
<span class="linenr">10442: </span>  text: transformVText,
<span class=
"linenr">10443: </span>  model: transformModelCD, <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">override compiler-core</span>
<span class=
"linenr">10444: </span>  on: transformOnCD, <span class="org-comment-delimiter">// </span><span class="org-comment">override compiler-core</span>
<span class="linenr">10445: </span>  show: transformShowCD
<span class="linenr">10446: </span>}
<span class="linenr">10447: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">DOMNodeTransforms</span> = [
<span class="linenr">10448: </span>  transformStyleCD,
<span class=
"linenr">10449: </span>  ...(__DEV__ ? [warnTransitionChildren] : [])
<span class="linenr">10450: </span>]
<span class="linenr">10451: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">compile</span>(<span class=
"org-variable-name">template</span>, <span class=
"org-variable-name">options</span> = {}) {
<span class="linenr">10452: </span>  <span class=
"org-keyword">return</span> baseCompile(
<span class="linenr">10453: </span>    template,
<span class=
"linenr">10454: </span>    extend({}, parserOptions, options, {
<span class="linenr">10455: </span>      nodeTransforms: [
<span class="linenr">10456: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">ignore &lt;script&gt; and &lt;tag&gt;</span>
<span class="linenr">10457: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">this is not put inside DOMNodeTransforms because that list is used</span>
<span class="linenr">10458: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">by compiler-ssr to generate vnode fallback branches</span>
<span class="linenr">10459: </span>        ignoreSideEffectTags,
<span class="linenr">10460: </span>        ...DOMNodeTransforms,
<span class=
"linenr">10461: </span>        ...(options.nodeTransforms || [])
<span class="linenr">10462: </span>      ],
<span class=
"linenr">10463: </span>      directiveTransforms: extend(
<span class="linenr">10464: </span>        {},
<span class="linenr">10465: </span>        DOMDirectiveTransforms,
<span class=
"linenr">10466: </span>        options.directiveTransforms || {}
<span class="linenr">10467: </span>      ),
<span class=
"linenr">10468: </span>      transformHoist: __BROWSER__ ? <span class="org-constant">null</span> : stringifyStatic
<span class="linenr">10469: </span>    })
<span class="linenr">10470: </span>  )
<span class="linenr">10471: </span>}
<span class="linenr">10472: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parse</span>(<span class=
"org-variable-name">template</span>, <span class=
"org-variable-name">options</span> = {}) {
<span class="linenr">10473: </span>  <span class=
"org-keyword">return</span> baseParse(template, extend({}, parserOptions, options))
<span class="linenr">10474: </span>}
<span class="linenr">10475: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">__ESM_BROWSER__</span> = <span class=
"org-constant">false</span>, <span class=
"org-variable-name">__GLOBAL__</span> = <span class=
"org-constant">true</span>
<span class="linenr">10476: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">MagicString</span> = require(process.env.NODE_LIB + <span class="org-string">'/magic-string'</span>)
<span class="linenr">10477: </span>
<span class="linenr">10478: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createCache</span>(<span class=
"org-variable-name">size</span> = <span class=
"org-highlight-numbers-number">500</span>) {
<span class="linenr">10479: </span>  <span class=
"org-keyword">return</span> <span class=
"org-keyword">new</span> <span class="org-type">Map</span>()
<span class="linenr">10480: </span>}
<span class="linenr">10481: </span>
<span class="linenr">10482: </span>
<span class="linenr">10483: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">defaultExportRE</span> = <span class=
"org-string">/((?:^|\n|;)\s*)export(\s*)default/</span>
<span class="linenr">10484: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">namedDefaultExportRE</span> = <span class=
"org-string">/((?:^|\n|;)\s*)export(.+)as(\s*)default/</span>s
<span class="linenr">10485: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">exportDefaultClassRE</span> =
<span class="linenr">10486: </span>  <span class=
"org-string">/((?:^|\n|;)\s*)export\s+default\s+class\s+([\w$]+)/</span>
<span class="linenr">10487: </span>
<span class="linenr">10488: </span><span class="org-doc">/**</span>
<span class="linenr">10489: </span><span class=
"org-doc"> * Utility for rewriting `export default` in a script block into a variable</span>
<span class="linenr">10490: </span><span class=
"org-doc"> * declaration so that we can inject things into it</span>
<span class="linenr">10491: </span><span class="org-doc"> */</span>
<span class="linenr">10492: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">rewriteDefault</span>(<span class=
"org-variable-name">input</span>, <span class=
"org-variable-name">as</span>, <span class=
"org-variable-name">parserPlugins</span>) {
<span class="linenr">10493: </span>  <span class=
"org-keyword">if</span> (!hasDefaultExport(input)) {
<span class="linenr">10494: </span>    <span class=
"org-keyword">return</span> input + <span class=
"org-string">`\nconst ${as} = {}`</span>
<span class="linenr">10495: </span>  }
<span class="linenr">10496: </span>
<span class="linenr">10497: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">replaced</span>
<span class="linenr">10498: </span>
<span class="linenr">10499: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">classMatch</span> = input.match(exportDefaultClassRE)
<span class="linenr">10500: </span>  <span class=
"org-keyword">if</span> (classMatch) {
<span class="linenr">10501: </span>    replaced =
<span class=
"linenr">10502: </span>      input.replace(exportDefaultClassRE, <span class="org-string">'$1class $2'</span>) +
<span class="linenr">10503: </span>      <span class=
"org-string">`\nconst ${as} = ${classMatch[2]}`</span>
<span class="linenr">10504: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr">10505: </span>    replaced = input.replace(defaultExportRE, <span class="org-string">`$1const ${as} =`</span>)
<span class="linenr">10506: </span>  }
<span class="linenr">10507: </span>  <span class=
"org-keyword">if</span> (!hasDefaultExport(replaced)) {
<span class="linenr">10508: </span>    <span class=
"org-keyword">return</span> replaced
<span class="linenr">10509: </span>  }
<span class="linenr">10510: </span>
<span class="linenr">10511: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if the script somehow still contains `default export`, it probably has</span>
<span class="linenr">10512: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">multi-line comments or template strings. fallback to a full parse.</span>
<span class="linenr">10513: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">s</span> = <span class=
"org-keyword">new</span> <span class=
"org-type">MagicString</span>(input)
<span class="linenr">10514: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ast</span> = babelParser.parse(input, {
<span class="linenr">10515: </span>    sourceType: <span class=
"org-string">'module'</span>,
<span class="linenr">10516: </span>    plugins: parserPlugins
<span class="linenr">10517: </span>  }).program.body
<span class="linenr">10518: </span>  ast.forEach(node =&gt; {
<span class="linenr">10519: </span>    <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ExportDefaultDeclaration'</span>) {
<span class=
"linenr">10520: </span>      s.overwrite(node.start, node.declaration.start, <span class="org-string">`const ${as} = `</span>)
<span class="linenr">10521: </span>    }
<span class="linenr">10522: </span>    <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ExportNamedDeclaration'</span>) {
<span class=
"linenr">10523: </span>      node.specifiers.forEach(specifier =&gt; {
<span class="linenr">10524: </span>        <span class=
"org-keyword">if</span> (
<span class=
"linenr">10525: </span>          specifier.type === <span class=
"org-string">'ExportSpecifier'</span> &amp;&
<span class=
"linenr">10526: </span>          specifier.exported.type === <span class="org-string">'Identifier'</span> &amp;&
<span class=
"linenr">10527: </span>          specifier.exported.name === <span class="org-string">'default'</span>
<span class="linenr">10528: </span>        ) {
<span class="linenr">10529: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">end</span> = specifier.end
<span class="linenr">10530: </span>          s.overwrite(
<span class="linenr">10531: </span>            specifier.start,
<span class=
"linenr">10532: </span>            input.charAt(end) === <span class="org-string">','</span> ? end + <span class="org-highlight-numbers-number">1</span> : end,
<span class="linenr">10533: </span>            <span class=
"org-string">``</span>
<span class="linenr">10534: </span>          )
<span class="linenr">10535: </span>          s.append(<span class=
"org-string">`\nconst ${as} = ${specifier.local.name}`</span>)
<span class="linenr">10536: </span>        }
<span class="linenr">10537: </span>      })
<span class="linenr">10538: </span>    }
<span class="linenr">10539: </span>  })
<span class="linenr">10540: </span>  <span class=
"org-keyword">return</span> s.toString()
<span class="linenr">10541: </span>}
<span class="linenr">10542: </span>
<span class="linenr">10543: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">hasDefaultExport</span>(<span class=
"org-variable-name">input</span>) {
<span class="linenr">10544: </span>  <span class=
"org-keyword">return</span> defaultExportRE.test(input) || namedDefaultExportRE.test(input)
<span class="linenr">10545: </span>}
<span class="linenr">10546: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">RT</span> = (<span class=
"org-keyword">function</span>() {
<span class="linenr">10547: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">CONVERT_SYMBOL</span> = <span class=
"org-string">'$'</span>
<span class="linenr">10548: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">ESCAPE_SYMBOL</span> = <span class=
"org-string">'$$'</span>
<span class="linenr">10549: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">shorthands</span> = [<span class=
"org-string">'ref'</span>, <span class=
"org-string">'computed'</span>, <span class=
"org-string">'shallowRef'</span>, <span class=
"org-string">'toRef'</span>, <span class=
"org-string">'customRef'</span>]
<span class="linenr">10550: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformCheckRE</span> = <span class=
"org-string">/[^\w]\$(?:\$|ref|computed|shallowRef)?\s*(\(|\&lt;)/</span>
<span class="linenr">10551: </span>
<span class="linenr">10552: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">shouldTransform</span>(<span class=
"org-variable-name">src</span>) {
<span class="linenr">10553: </span>  <span class=
"org-keyword">return</span> transformCheckRE.test(src)
<span class="linenr">10554: </span>}
<span class="linenr">10555: </span>
<span class="linenr">10556: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">transform</span>(
<span class="linenr">10557: </span>  <span class=
"org-variable-name">src</span>,
<span class="linenr">10558: </span>  {
<span class="linenr">10559: </span>    filename,
<span class="linenr">10560: </span>    sourceMap,
<span class="linenr">10561: </span>    parserPlugins,
<span class=
"linenr">10562: </span>    importHelpersFrom = <span class=
"org-string">'vue'</span>
<span class="linenr">10563: </span>  } = {}
<span class="linenr">10564: </span>) {
<span class="linenr">10565: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">plugins</span> = parserPlugins || []
<span class="linenr">10566: </span>  <span class=
"org-keyword">if</span> (filename) {
<span class="linenr">10567: </span>    <span class=
"org-keyword">if</span> (<span class=
"org-string">/\.tsx?$/</span>.test(filename)) {
<span class="linenr">10568: </span>      plugins.push(<span class=
"org-string">'typescript'</span>)
<span class="linenr">10569: </span>    }
<span class="linenr">10570: </span>    <span class=
"org-keyword">if</span> (filename.endsWith(<span class=
"org-string">'x'</span>)) {
<span class="linenr">10571: </span>      plugins.push(<span class=
"org-string">'jsx'</span>)
<span class="linenr">10572: </span>    }
<span class="linenr">10573: </span>  }
<span class="linenr">10574: </span>
<span class="linenr">10575: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ast</span> = babelParser.parse(src, {
<span class="linenr">10576: </span>    sourceType: <span class=
"org-string">'module'</span>,
<span class="linenr">10577: </span>    plugins
<span class="linenr">10578: </span>  })
<span class="linenr">10579: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">s</span> = <span class=
"org-keyword">new</span> <span class=
"org-type">MagicString</span>(src)
<span class="linenr">10580: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">res</span> = transformAST(ast.program, s, <span class="org-highlight-numbers-number">0</span>)
<span class="linenr">10581: </span>
<span class="linenr">10582: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject helper imports</span>
<span class="linenr">10583: </span>  <span class=
"org-keyword">if</span> (res.importedHelpers.length) {
<span class="linenr">10584: </span>    s.prepend(
<span class="linenr">10585: </span>      <span class=
"org-string">`import { ${res.importedHelpers</span>
<span class="linenr">10586: </span><span class=
"org-string">        .map(h =&gt; `</span>${h} as _${h}<span class=
"org-string">`)</span>
<span class="linenr">10587: </span><span class=
"org-string">        .join(', ')} } from '${importHelpersFrom}'\n`</span>
<span class="linenr">10588: </span>    )
<span class="linenr">10589: </span>  }
<span class="linenr">10590: </span>
<span class="linenr">10591: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr">10592: </span>    ...res,
<span class="linenr">10593: </span>    code: s.toString(),
<span class="linenr">10594: </span>    map: sourceMap
<span class="linenr">10595: </span>      ? s.generateMap({
<span class="linenr">10596: </span>          source: filename,
<span class="linenr">10597: </span>          hires: <span class=
"org-constant">true</span>,
<span class=
"linenr">10598: </span>          includeContent: <span class=
"org-constant">true</span>
<span class="linenr">10599: </span>        })
<span class="linenr">10600: </span>      : <span class=
"org-constant">null</span>
<span class="linenr">10601: </span>  }
<span class="linenr">10602: </span>}
<span class="linenr">10603: </span>
<span class="linenr">10604: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">transformAST</span>(
<span class="linenr">10605: </span>  <span class=
"org-variable-name">ast</span>,
<span class="linenr">10606: </span>  <span class=
"org-variable-name">s</span>,
<span class="linenr">10607: </span>  offset = <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr">10608: </span>  <span class=
"org-variable-name">knownRefs</span>,
<span class="linenr">10609: </span>  knownProps
<span class="linenr">10610: </span>) {
<span class="linenr">10611: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">convertSymbol</span> = CONVERT_SYMBOL
<span class="linenr">10612: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">escapeSymbol</span> = ESCAPE_SYMBOL
<span class="linenr">10613: </span>
<span class="linenr">10614: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">macro import handling</span>
<span class="linenr">10615: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> <span class=
"org-keyword">of</span> ast.body) {
<span class="linenr">10616: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr">10617: </span>      node.type === <span class=
"org-string">'ImportDeclaration'</span> &amp;&
<span class=
"linenr">10618: </span>      node.source.value === <span class=
"org-string">'vue/macros'</span>
<span class="linenr">10619: </span>    ) {
<span class="linenr">10620: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">remove macro imports</span>
<span class=
"linenr">10621: </span>      s.remove(node.start + offset, node.end + offset)
<span class="linenr">10622: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check aliasing</span>
<span class="linenr">10623: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">specifier</span> <span class=
"org-keyword">of</span> node.specifiers) {
<span class="linenr">10624: </span>        <span class=
"org-keyword">if</span> (specifier.type === <span class=
"org-string">'ImportSpecifier'</span>) {
<span class="linenr">10625: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">imported</span> = specifier.imported.name
<span class="linenr">10626: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">local</span> = specifier.local.name
<span class="linenr">10627: </span>          <span class=
"org-keyword">if</span> (local !== imported) {
<span class="linenr">10628: </span>            <span class=
"org-keyword">if</span> (imported === ESCAPE_SYMBOL) {
<span class=
"linenr">10629: </span>              escapeSymbol = local
<span class="linenr">10630: </span>            } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (imported === CONVERT_SYMBOL) {
<span class=
"linenr">10631: </span>              convertSymbol = local
<span class="linenr">10632: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr">10633: </span>              error(
<span class="linenr">10634: </span>                <span class=
"org-string">`macro imports for ref-creating methods do not support aliasing.`</span>,
<span class="linenr">10635: </span>                specifier
<span class="linenr">10636: </span>              )
<span class="linenr">10637: </span>            }
<span class="linenr">10638: </span>          }
<span class="linenr">10639: </span>        }
<span class="linenr">10640: </span>      }
<span class="linenr">10641: </span>    }
<span class="linenr">10642: </span>  }
<span class="linenr">10643: </span>
<span class="linenr">10644: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">importedHelpers</span> = <span class=
"org-keyword">new</span> <span class="org-type">Set</span>()
<span class="linenr">10645: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rootScope</span> = {}
<span class="linenr">10646: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scopeStack</span> = [rootScope]
<span class="linenr">10647: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">currentScope</span> = rootScope
<span class="linenr">10648: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">escapeScope</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inside $$()</span>
<span class="linenr">10649: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">excludedIds</span> = <span class=
"org-keyword">new</span> <span class="org-type">WeakSet</span>()
<span class="linenr">10650: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parentStack</span> = []
<span class="linenr">10651: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">propsLocalToPublicMap</span> = Object.create(<span class="org-constant">null</span>)
<span class="linenr">10652: </span>
<span class="linenr">10653: </span>  <span class=
"org-keyword">if</span> (knownRefs) {
<span class="linenr">10654: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">of</span> knownRefs) {
<span class=
"linenr">10655: </span>      rootScope[key] = <span class=
"org-constant">true</span>
<span class="linenr">10656: </span>    }
<span class="linenr">10657: </span>  }
<span class="linenr">10658: </span>  <span class=
"org-keyword">if</span> (knownProps) {
<span class="linenr">10659: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> knownProps) {
<span class="linenr">10660: </span>      <span class=
"org-keyword">const</span> { local } = knownProps[key]
<span class=
"linenr">10661: </span>      rootScope[local] = <span class=
"org-string">'prop'</span>
<span class=
"linenr">10662: </span>      propsLocalToPublicMap[local] = key
<span class="linenr">10663: </span>    }
<span class="linenr">10664: </span>  }
<span class="linenr">10665: </span>
<span class="linenr">10666: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">isRefCreationCall</span>(<span class=
"org-variable-name">callee</span>) {
<span class="linenr">10667: </span>    <span class=
"org-keyword">if</span> (callee === convertSymbol) {
<span class="linenr">10668: </span>      <span class=
"org-keyword">return</span> convertSymbol
<span class="linenr">10669: </span>    }
<span class="linenr">10670: </span>    <span class=
"org-keyword">if</span> (callee[<span class=
"org-highlight-numbers-number">0</span>] === <span class=
"org-string">'$'</span> &amp;& shorthands.includes(callee.slice(<span class="org-highlight-numbers-number">1</span>))) {
<span class="linenr">10671: </span>      <span class=
"org-keyword">return</span> callee
<span class="linenr">10672: </span>    }
<span class="linenr">10673: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">10674: </span>  }
<span class="linenr">10675: </span>
<span class="linenr">10676: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">error</span>(<span class=
"org-variable-name">msg</span>, <span class=
"org-variable-name">node</span>) {
<span class="linenr">10677: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">e</span> = <span class=
"org-keyword">new</span> <span class="org-type">Error</span>(msg)
<span class="linenr">10678: </span>    e.node = node
<span class="linenr">10679: </span>    <span class=
"org-keyword">throw</span> e
<span class="linenr">10680: </span>  }
<span class="linenr">10681: </span>
<span class="linenr">10682: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">helper</span>(<span class=
"org-variable-name">msg</span>) {
<span class="linenr">10683: </span>    importedHelpers.add(msg)
<span class="linenr">10684: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`_${msg}`</span>
<span class="linenr">10685: </span>  }
<span class="linenr">10686: </span>
<span class="linenr">10687: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">registerBinding</span>(<span class=
"org-variable-name">id</span>, <span class=
"org-variable-name">isRef</span> = <span class=
"org-constant">false</span>) {
<span class="linenr">10688: </span>    excludedIds.add(id)
<span class="linenr">10689: </span>    <span class=
"org-keyword">if</span> (currentScope) {
<span class=
"linenr">10690: </span>      currentScope[id.name] = isRef
<span class="linenr">10691: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">10692: </span>      error(
<span class="linenr">10693: </span>        <span class=
"org-string">'registerBinding called without active scope, something is wrong.'</span>,
<span class="linenr">10694: </span>        id
<span class="linenr">10695: </span>      )
<span class="linenr">10696: </span>    }
<span class="linenr">10697: </span>  }
<span class="linenr">10698: </span>
<span class="linenr">10699: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">registerRefBinding</span> = (id) =&gt; registerBinding(id, <span class="org-constant">true</span>)
<span class="linenr">10700: </span>
<span class="linenr">10701: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">tempVarCount</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">10702: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">genTempVar</span>() {
<span class="linenr">10703: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`__$temp_${++tempVarCount}`</span>
<span class="linenr">10704: </span>  }
<span class="linenr">10705: </span>
<span class="linenr">10706: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">snip</span>(<span class=
"org-variable-name">nod</span>) {
<span class="linenr">10707: </span>    <span class=
"org-keyword">return</span> s.original.slice(node.start + offset, node.end + offset)
<span class="linenr">10708: </span>  }
<span class="linenr">10709: </span>
<span class="linenr">10710: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">walkScope</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">isRoot</span> = <span class=
"org-constant">false</span>) {
<span class="linenr">10711: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">stmt</span> <span class=
"org-keyword">of</span> node.body) {
<span class="linenr">10712: </span>      <span class=
"org-keyword">if</span> (stmt.type === <span class=
"org-string">'VariableDeclaration'</span>) {
<span class=
"linenr">10713: </span>        walkVariableDeclaration(stmt, isRoot)
<span class="linenr">10714: </span>      } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr">10715: </span>        stmt.type === <span class=
"org-string">'FunctionDeclaration'</span> ||
<span class=
"linenr">10716: </span>        stmt.type === <span class=
"org-string">'ClassDeclaration'</span>
<span class="linenr">10717: </span>      ) {
<span class="linenr">10718: </span>        <span class=
"org-keyword">if</span> (stmt.declare || !stmt.id) <span class=
"org-keyword">continue</span>
<span class="linenr">10719: </span>        registerBinding(stmt.id)
<span class="linenr">10720: </span>      } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr">10721: </span>        (stmt.type === <span class=
"org-string">'ForOfStatement'</span> || stmt.type === <span class=
"org-string">'ForInStatement'</span>) &amp;&
<span class=
"linenr">10722: </span>        stmt.left.type === <span class=
"org-string">'VariableDeclaration'</span>
<span class="linenr">10723: </span>      ) {
<span class=
"linenr">10724: </span>        walkVariableDeclaration(stmt.left)
<span class="linenr">10725: </span>      } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr">10726: </span>        stmt.type === <span class=
"org-string">'ExportNamedDeclaration'</span> &amp;&
<span class="linenr">10727: </span>        stmt.declaration &amp;&
<span class=
"linenr">10728: </span>        stmt.declaration.type === <span class="org-string">'VariableDeclaration'</span>
<span class="linenr">10729: </span>      ) {
<span class=
"linenr">10730: </span>        walkVariableDeclaration(stmt.declaration, isRoot)
<span class="linenr">10731: </span>      } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr">10732: </span>        stmt.type === <span class=
"org-string">'LabeledStatement'</span> &amp;&
<span class=
"linenr">10733: </span>        stmt.body.type === <span class=
"org-string">'VariableDeclaration'</span>
<span class="linenr">10734: </span>      ) {
<span class=
"linenr">10735: </span>        walkVariableDeclaration(stmt.body, isRoot)
<span class="linenr">10736: </span>      }
<span class="linenr">10737: </span>    }
<span class="linenr">10738: </span>  }
<span class="linenr">10739: </span>
<span class="linenr">10740: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">walkVariableDeclaration</span>(<span class=
"org-variable-name">stmt</span>, <span class=
"org-variable-name">isRoot</span> = <span class=
"org-constant">false</span>) {
<span class="linenr">10741: </span>    <span class=
"org-keyword">if</span> (stmt.declare) {
<span class="linenr">10742: </span>      <span class=
"org-keyword">return</span>
<span class="linenr">10743: </span>    }
<span class="linenr">10744: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">decl</span> <span class=
"org-keyword">of</span> stmt.declarations) {
<span class="linenr">10745: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">refCall</span>
<span class="linenr">10746: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isCall</span> =
<span class="linenr">10747: </span>        decl.init &amp;&
<span class=
"linenr">10748: </span>        decl.init.type === <span class=
"org-string">'CallExpression'</span> &amp;&
<span class=
"linenr">10749: </span>        decl.init.callee.type === <span class="org-string">'Identifier'</span>
<span class="linenr">10750: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr">10751: </span>        isCall &amp;&
<span class=
"linenr">10752: </span>        (refCall = isRefCreationCall(decl.init.callee.name))
<span class="linenr">10753: </span>      ) {
<span class=
"linenr">10754: </span>        processRefDeclaration(refCall, decl.id, decl.init)
<span class="linenr">10755: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">10756: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isProps</span> =
<span class=
"linenr">10757: </span>          isRoot &amp;& isCall &amp;& decl.init.callee.name === <span class="org-string">'defineProps'</span>
<span class="linenr">10758: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">id</span> <span class=
"org-keyword">of</span> extractIdentifiers(decl.id)) {
<span class="linenr">10759: </span>          <span class=
"org-keyword">if</span> (isProps) {
<span class="linenr">10760: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for defineProps destructure, only exclude them since they</span>
<span class="linenr">10761: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">are already passed in as knownProps</span>
<span class="linenr">10762: </span>            excludedIds.add(id)
<span class="linenr">10763: </span>          } <span class=
"org-keyword">else</span> {
<span class="linenr">10764: </span>            registerBinding(id)
<span class="linenr">10765: </span>          }
<span class="linenr">10766: </span>        }
<span class="linenr">10767: </span>      }
<span class="linenr">10768: </span>    }
<span class="linenr">10769: </span>  }
<span class="linenr">10770: </span>
<span class="linenr">10771: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">processRefDeclaration</span>(<span class=
"org-variable-name">method</span>, <span class=
"org-variable-name">id</span>, <span class=
"org-variable-name">call</span>) {
<span class="linenr">10772: </span>    excludedIds.add(call.callee)
<span class="linenr">10773: </span>    <span class=
"org-keyword">if</span> (method === convertSymbol) {
<span class="linenr">10774: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">$</span>
<span class="linenr">10775: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">remove macro</span>
<span class=
"linenr">10776: </span>      s.remove(call.callee.start + offset, call.callee.end + offset)
<span class="linenr">10777: </span>      <span class=
"org-keyword">if</span> (id.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">10778: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">single variable</span>
<span class="linenr">10779: </span>        registerRefBinding(id)
<span class="linenr">10780: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (id.type === <span class=
"org-string">'ObjectPattern'</span>) {
<span class=
"linenr">10781: </span>        processRefObjectPattern(id, call)
<span class="linenr">10782: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (id.type === <span class=
"org-string">'ArrayPattern'</span>) {
<span class=
"linenr">10783: </span>        processRefArrayPattern(id, call)
<span class="linenr">10784: </span>      }
<span class="linenr">10785: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">10786: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">shorthands</span>
<span class="linenr">10787: </span>      <span class=
"org-keyword">if</span> (id.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">10788: </span>        registerRefBinding(id)
<span class="linenr">10789: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">replace call</span>
<span class="linenr">10790: </span>        s.overwrite(
<span class="linenr">10791: </span>          call.start + offset,
<span class=
"linenr">10792: </span>          call.start + method.length + offset,
<span class=
"linenr">10793: </span>          helper(method.slice(<span class=
"org-highlight-numbers-number">1</span>))
<span class="linenr">10794: </span>        )
<span class="linenr">10795: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">10796: </span>        error(<span class=
"org-string">`${method}() cannot be used with destructure patterns.`</span>, call)
<span class="linenr">10797: </span>      }
<span class="linenr">10798: </span>    }
<span class="linenr">10799: </span>  }
<span class="linenr">10800: </span>
<span class="linenr">10801: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">processRefObjectPattern</span>(<span class=
"org-variable-name">pattern</span>, <span class=
"org-variable-name">call</span>, <span class=
"org-variable-name">tempVar</span>, <span class=
"org-variable-name">path</span> = []) {
<span class="linenr">10802: </span>    <span class=
"org-keyword">if</span> (!tempVar) {
<span class="linenr">10803: </span>      tempVar = genTempVar()
<span class="linenr">10804: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">const { x } = $(useFoo()) --&gt; const __$temp_1 = useFoo()</span>
<span class=
"linenr">10805: </span>      s.overwrite(pattern.start + offset, pattern.end + offset, tempVar)
<span class="linenr">10806: </span>    }
<span class="linenr">10807: </span>
<span class="linenr">10808: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> <span class=
"org-keyword">of</span> pattern.properties) {
<span class="linenr">10809: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">nameId</span>
<span class="linenr">10810: </span>      <span class=
"org-keyword">let</span> <span class="org-variable-name">key</span>
<span class="linenr">10811: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">defaultValue</span>
<span class="linenr">10812: </span>      <span class=
"org-keyword">if</span> (p.type === <span class=
"org-string">'ObjectProperty'</span>) {
<span class="linenr">10813: </span>        <span class=
"org-keyword">if</span> (p.key.start === p.value.start) {
<span class="linenr">10814: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">shorthand { foo }</span>
<span class="linenr">10815: </span>          nameId = p.key
<span class="linenr">10816: </span>          <span class=
"org-keyword">if</span> (p.value.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">10817: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">avoid shorthand value identifier from being processed</span>
<span class=
"linenr">10818: </span>            excludedIds.add(p.value)
<span class="linenr">10819: </span>          } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr">10820: </span>            p.value.type === <span class=
"org-string">'AssignmentPattern'</span> &amp;&
<span class=
"linenr">10821: </span>            p.value.left.type === <span class="org-string">'Identifier'</span>
<span class="linenr">10822: </span>          ) {
<span class="linenr">10823: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">{ foo = 1 }</span>
<span class=
"linenr">10824: </span>            excludedIds.add(p.value.left)
<span class=
"linenr">10825: </span>            defaultValue = p.value.right
<span class="linenr">10826: </span>          }
<span class="linenr">10827: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr">10828: </span>          key = p.computed ? p.key : p.key.name
<span class="linenr">10829: </span>          <span class=
"org-keyword">if</span> (p.value.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">10830: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">{ foo: bar }</span>
<span class="linenr">10831: </span>            nameId = p.value
<span class="linenr">10832: </span>          } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.value.type === <span class=
"org-string">'ObjectPattern'</span>) {
<span class=
"linenr">10833: </span>            processRefObjectPattern(p.value, call, tempVar, [...path, key])
<span class="linenr">10834: </span>          } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.value.type === <span class=
"org-string">'ArrayPattern'</span>) {
<span class=
"linenr">10835: </span>            processRefArrayPattern(p.value, call, tempVar, [...path, key])
<span class="linenr">10836: </span>          } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.value.type === <span class=
"org-string">'AssignmentPattern'</span>) {
<span class="linenr">10837: </span>            <span class=
"org-keyword">if</span> (p.value.left.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">10838: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">{ foo: bar = 1 }</span>
<span class=
"linenr">10839: </span>              nameId = p.value.left
<span class=
"linenr">10840: </span>              defaultValue = p.value.right
<span class="linenr">10841: </span>            } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.value.left.type === <span class=
"org-string">'ObjectPattern'</span>) {
<span class=
"linenr">10842: </span>              processRefObjectPattern(p.value.left, call, tempVar, [
<span class="linenr">10843: </span>                ...path,
<span class=
"linenr">10844: </span>                [key, p.value.right]
<span class="linenr">10845: </span>              ])
<span class="linenr">10846: </span>            } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.value.left.type === <span class=
"org-string">'ArrayPattern'</span>) {
<span class=
"linenr">10847: </span>              processRefArrayPattern(p.value.left, call, tempVar, [
<span class="linenr">10848: </span>                ...path,
<span class=
"linenr">10849: </span>                [key, p.value.right]
<span class="linenr">10850: </span>              ])
<span class="linenr">10851: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr">10852: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">MemberExpression case is not possible here, ignore</span>
<span class="linenr">10853: </span>            }
<span class="linenr">10854: </span>          }
<span class="linenr">10855: </span>        }
<span class="linenr">10856: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">10857: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">rest element { ...foo }</span>
<span class="linenr">10858: </span>        error(<span class=
"org-string">`reactivity destructure does not support rest elements.`</span>, p)
<span class="linenr">10859: </span>      }
<span class="linenr">10860: </span>      <span class=
"org-keyword">if</span> (nameId) {
<span class=
"linenr">10861: </span>        registerRefBinding(nameId)
<span class="linenr">10862: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject toRef() after original replaced pattern</span>
<span class="linenr">10863: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = pathToString(tempVar, path)
<span class="linenr">10864: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyStr</span> = isString(key)
<span class="linenr">10865: </span>          ? <span class=
"org-string">`'${key}'`</span>
<span class="linenr">10866: </span>          : key
<span class="linenr">10867: </span>          ? snip(key)
<span class="linenr">10868: </span>          : <span class=
"org-string">`'${nameId.name}'`</span>
<span class="linenr">10869: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">defaultStr</span> = defaultValue ? <span class=
"org-string">`, ${snip(defaultValue)}`</span> : <span class=
"org-string">``</span>
<span class="linenr">10870: </span>        s.appendLeft(
<span class="linenr">10871: </span>          call.end + offset,
<span class="linenr">10872: </span>          <span class=
"org-string">`,\n  ${nameId.name} = ${helper(</span>
<span class="linenr">10873: </span><span class=
"org-string">            'toRef'</span>
<span class="linenr">10874: </span><span class=
"org-string">          )}(${source}, ${keyStr}${defaultStr})`</span>
<span class="linenr">10875: </span>        )
<span class="linenr">10876: </span>      }
<span class="linenr">10877: </span>    }
<span class="linenr">10878: </span>  }
<span class="linenr">10879: </span>
<span class="linenr">10880: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">processRefArrayPattern</span>(<span class=
"org-variable-name">pattern</span>, <span class=
"org-variable-name">call</span>, <span class=
"org-variable-name">tempVar</span>, <span class=
"org-variable-name">path</span> = []) {
<span class="linenr">10881: </span>    <span class=
"org-keyword">if</span> (!tempVar) {
<span class="linenr">10882: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">const [x] = $(useFoo()) --&gt; const __$temp_1 = useFoo()</span>
<span class="linenr">10883: </span>      tempVar = genTempVar()
<span class=
"linenr">10884: </span>      s.overwrite(pattern.start + offset, pattern.end + offset, tempVar)
<span class="linenr">10885: </span>    }
<span class="linenr">10886: </span>
<span class="linenr">10887: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; pattern.elements.length; i++) {
<span class="linenr">10888: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">e</span> = pattern.elements[i]
<span class="linenr">10889: </span>      <span class=
"org-keyword">if</span> (!e) <span class=
"org-keyword">continue</span>
<span class="linenr">10890: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">nameId</span>
<span class="linenr">10891: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">defaultValue</span>
<span class="linenr">10892: </span>      <span class=
"org-keyword">if</span> (e.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">10893: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">[a] --&gt; [__a]</span>
<span class="linenr">10894: </span>        nameId = e
<span class="linenr">10895: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (e.type === <span class=
"org-string">'AssignmentPattern'</span>) {
<span class="linenr">10896: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">[a = 1]</span>
<span class="linenr">10897: </span>        nameId = e.left
<span class="linenr">10898: </span>        defaultValue = e.right
<span class="linenr">10899: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (e.type === <span class=
"org-string">'RestElement'</span>) {
<span class="linenr">10900: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">[...a]</span>
<span class="linenr">10901: </span>        error(<span class=
"org-string">`reactivity destructure does not support rest elements.`</span>, e)
<span class="linenr">10902: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (e.type === <span class=
"org-string">'ObjectPattern'</span>) {
<span class=
"linenr">10903: </span>        processRefObjectPattern(e, call, tempVar, [...path, i])
<span class="linenr">10904: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (e.type === <span class=
"org-string">'ArrayPattern'</span>) {
<span class=
"linenr">10905: </span>        processRefArrayPattern(e, call, tempVar, [...path, i])
<span class="linenr">10906: </span>      }
<span class="linenr">10907: </span>      <span class=
"org-keyword">if</span> (nameId) {
<span class=
"linenr">10908: </span>        registerRefBinding(nameId)
<span class="linenr">10909: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject toRef() after original replaced pattern</span>
<span class="linenr">10910: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = pathToString(tempVar, path)
<span class="linenr">10911: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">defaultStr</span> = defaultValue ? <span class=
"org-string">`, ${snip(defaultValue)}`</span> : <span class=
"org-string">``</span>
<span class="linenr">10912: </span>        s.appendLeft(
<span class="linenr">10913: </span>          call.end + offset,
<span class="linenr">10914: </span>          <span class=
"org-string">`,\n  ${nameId.name} = ${helper(</span>
<span class="linenr">10915: </span><span class=
"org-string">            'toRef'</span>
<span class="linenr">10916: </span><span class=
"org-string">          )}(${source}, ${i}${defaultStr})`</span>
<span class="linenr">10917: </span>        )
<span class="linenr">10918: </span>      }
<span class="linenr">10919: </span>    }
<span class="linenr">10920: </span>  }
<span class="linenr">10921: </span>
<span class="linenr">10922: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">pathToString</span>(<span class=
"org-variable-name">source</span>, <span class=
"org-variable-name">path</span>) {
<span class="linenr">10923: </span>    <span class=
"org-keyword">if</span> (path.length) {
<span class="linenr">10924: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">seg</span> <span class=
"org-keyword">of</span> path) {
<span class="linenr">10925: </span>        <span class=
"org-keyword">if</span> (isArray(seg)) {
<span class="linenr">10926: </span>          source = <span class=
"org-string">`(${source}${segToString(seg[0])} || ${snip(seg[1])})`</span>
<span class="linenr">10927: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr">10928: </span>          source += segToString(seg)
<span class="linenr">10929: </span>        }
<span class="linenr">10930: </span>      }
<span class="linenr">10931: </span>    }
<span class="linenr">10932: </span>    <span class=
"org-keyword">return</span> source
<span class="linenr">10933: </span>  }
<span class="linenr">10934: </span>
<span class="linenr">10935: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">segToString</span>(<span class=
"org-variable-name">seg</span>) {
<span class="linenr">10936: </span>    <span class=
"org-keyword">if</span> (<span class=
"org-keyword">typeof</span> seg === <span class=
"org-string">'number'</span>) {
<span class="linenr">10937: </span>      <span class=
"org-keyword">return</span> <span class=
"org-string">`[${seg}]`</span>
<span class="linenr">10938: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-keyword">typeof</span> seg === <span class=
"org-string">'string'</span>) {
<span class="linenr">10939: </span>      <span class=
"org-keyword">return</span> <span class=
"org-string">`.${seg}`</span>
<span class="linenr">10940: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">10941: </span>      <span class=
"org-keyword">return</span> snip(seg)
<span class="linenr">10942: </span>    }
<span class="linenr">10943: </span>  }
<span class="linenr">10944: </span>
<span class="linenr">10945: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">rewriteId</span>(<span class=
"org-variable-name">scope</span>, <span class=
"org-variable-name">id</span>, <span class=
"org-variable-name">parent</span>, <span class=
"org-variable-name">parentStack</span>) {
<span class="linenr">10946: </span>    <span class=
"org-keyword">if</span> (hasOwn(scope, id.name)) {
<span class="linenr">10947: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bindingType</span> = scope[id.name]
<span class="linenr">10948: </span>      <span class=
"org-keyword">if</span> (bindingType) {
<span class="linenr">10949: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isProp</span> = bindingType === <span class=
"org-string">'prop'</span>
<span class="linenr">10950: </span>        <span class=
"org-keyword">if</span> (isStaticProperty(parent) &amp;& parent.shorthand) {
<span class="linenr">10951: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let binding used in a property shorthand</span>
<span class="linenr">10952: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip for destructure patterns</span>
<span class="linenr">10953: </span>          <span class=
"org-keyword">if</span> (
<span class="linenr">10954: </span>            !parent.inPattern ||
<span class=
"linenr">10955: </span>            isInDestructureAssignment(parent, parentStack)
<span class="linenr">10956: </span>          ) {
<span class="linenr">10957: </span>            <span class=
"org-keyword">if</span> (isProp) {
<span class="linenr">10958: </span>              <span class=
"org-keyword">if</span> (escapeScope) {
<span class="linenr">10959: </span>                <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">prop binding in $$()</span>
<span class="linenr">10960: </span>                <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">{ prop } -&gt; { prop: __prop_prop }</span>
<span class=
"linenr">10961: </span>                registerEscapedPropBinding(id)
<span class="linenr">10962: </span>                s.appendLeft(
<span class=
"linenr">10963: </span>                  id.end + offset,
<span class="linenr">10964: </span>                  <span class=
"org-string">`: __props_${propsLocalToPublicMap[id.name]}`</span>
<span class="linenr">10965: </span>                )
<span class="linenr">10966: </span>              } <span class=
"org-keyword">else</span> {
<span class="linenr">10967: </span>                <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">{ prop } -&gt; { prop: __prop.prop }</span>
<span class="linenr">10968: </span>                s.appendLeft(
<span class=
"linenr">10969: </span>                  id.end + offset,
<span class="linenr">10970: </span>                  <span class=
"org-string">`: __props.${propsLocalToPublicMap[id.name]}`</span>
<span class="linenr">10971: </span>                )
<span class="linenr">10972: </span>              }
<span class="linenr">10973: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr">10974: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">{ foo } -&gt; { foo: foo.value }</span>
<span class=
"linenr">10975: </span>              s.appendLeft(id.end + offset, <span class="org-string">`: ${id.name}.value`</span>)
<span class="linenr">10976: </span>            }
<span class="linenr">10977: </span>          }
<span class="linenr">10978: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr">10979: </span>          <span class=
"org-keyword">if</span> (isProp) {
<span class="linenr">10980: </span>            <span class=
"org-keyword">if</span> (escapeScope) {
<span class="linenr">10981: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x --&gt; __props_x</span>
<span class=
"linenr">10982: </span>              registerEscapedPropBinding(id)
<span class="linenr">10983: </span>              s.overwrite(
<span class=
"linenr">10984: </span>                id.start + offset,
<span class="linenr">10985: </span>                id.end + offset,
<span class="linenr">10986: </span>                <span class=
"org-string">`__props_${propsLocalToPublicMap[id.name]}`</span>
<span class="linenr">10987: </span>              )
<span class="linenr">10988: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr">10989: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x --&gt; __props.x</span>
<span class="linenr">10990: </span>              s.overwrite(
<span class=
"linenr">10991: </span>                id.start + offset,
<span class="linenr">10992: </span>                id.end + offset,
<span class="linenr">10993: </span>                <span class=
"org-string">`__props.${propsLocalToPublicMap[id.name]}`</span>
<span class="linenr">10994: </span>              )
<span class="linenr">10995: </span>            }
<span class="linenr">10996: </span>          } <span class=
"org-keyword">else</span> {
<span class="linenr">10997: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x --&gt; x.value</span>
<span class=
"linenr">10998: </span>            s.appendLeft(id.end + offset, <span class="org-string">'.value'</span>)
<span class="linenr">10999: </span>          }
<span class="linenr">11000: </span>        }
<span class="linenr">11001: </span>      }
<span class="linenr">11002: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">11003: </span>    }
<span class="linenr">11004: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">11005: </span>  }
<span class="linenr">11006: </span>
<span class="linenr">11007: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">propBindingRefs</span> = {}
<span class="linenr">11008: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">registerEscapedPropBinding</span>(<span class=
"org-variable-name">id</span>) {
<span class="linenr">11009: </span>    <span class=
"org-keyword">if</span> (!propBindingRefs.hasOwnProperty(id.name)) {
<span class=
"linenr">11010: </span>      propBindingRefs[id.name] = <span class="org-constant">true</span>
<span class="linenr">11011: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">publicKey</span> = propsLocalToPublicMap[id.name]
<span class="linenr">11012: </span>      s.prependRight(
<span class="linenr">11013: </span>        offset,
<span class="linenr">11014: </span>        <span class=
"org-string">`const __props_${publicKey} = ${helper(</span>
<span class="linenr">11015: </span><span class=
"org-string">          `</span>toRef<span class=
"org-string">`</span>
<span class="linenr">11016: </span><span class=
"org-string">        )}(__props, '${publicKey}')\n`</span>
<span class="linenr">11017: </span>      )
<span class="linenr">11018: </span>    }
<span class="linenr">11019: </span>  }
<span class="linenr">11020: </span>
<span class="linenr">11021: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check root scope first</span>
<span class="linenr">11022: </span>  walkScope(ast, <span class=
"org-constant">true</span>)
<span class="linenr">11023: </span>  walk(ast, {
<span class="linenr">11024: </span>    enter(node, parent) {
<span class=
"linenr">11025: </span>      parent &amp;& parentStack.push(parent)
<span class="linenr">11026: </span>
<span class="linenr">11027: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">function scopes</span>
<span class="linenr">11028: </span>      <span class=
"org-keyword">if</span> (isFunctionType(node)) {
<span class=
"linenr">11029: </span>        scopeStack.push((currentScope = {}))
<span class=
"linenr">11030: </span>        walkFunctionParams(node, registerBinding)
<span class="linenr">11031: </span>        <span class=
"org-keyword">if</span> (node.body.type === <span class=
"org-string">'BlockStatement'</span>) {
<span class="linenr">11032: </span>          walkScope(node.body)
<span class="linenr">11033: </span>        }
<span class="linenr">11034: </span>        <span class=
"org-keyword">return</span>
<span class="linenr">11035: </span>      }
<span class="linenr">11036: </span>
<span class="linenr">11037: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">catch param</span>
<span class="linenr">11038: </span>      <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'CatchClause'</span>) {
<span class=
"linenr">11039: </span>        scopeStack.push((currentScope = {}))
<span class="linenr">11040: </span>        <span class=
"org-keyword">if</span> (node.param &amp;& node.param.type === <span class="org-string">'Identifier'</span>) {
<span class=
"linenr">11041: </span>          registerBinding(node.param)
<span class="linenr">11042: </span>        }
<span class="linenr">11043: </span>        walkScope(node.body)
<span class="linenr">11044: </span>        <span class=
"org-keyword">return</span>
<span class="linenr">11045: </span>      }
<span class="linenr">11046: </span>
<span class="linenr">11047: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">non-function block scopes</span>
<span class="linenr">11048: </span>      <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'BlockStatement'</span> &amp;& !isFunctionType(parent)) {
<span class=
"linenr">11049: </span>        scopeStack.push((currentScope = {}))
<span class="linenr">11050: </span>        walkScope(node)
<span class="linenr">11051: </span>        <span class=
"org-keyword">return</span>
<span class="linenr">11052: </span>      }
<span class="linenr">11053: </span>
<span class="linenr">11054: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip type nodes</span>
<span class="linenr">11055: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr">11056: </span>        parent &amp;&
<span class=
"linenr">11057: </span>        parent.type.startsWith(<span class=
"org-string">'TS'</span>) &amp;&
<span class=
"linenr">11058: </span>        parent.type !== <span class=
"org-string">'TSAsExpression'</span> &amp;&
<span class=
"linenr">11059: </span>        parent.type !== <span class=
"org-string">'TSNonNullExpression'</span> &amp;&
<span class=
"linenr">11060: </span>        parent.type !== <span class=
"org-string">'TSTypeAssertion'</span>
<span class="linenr">11061: </span>      ) {
<span class="linenr">11062: </span>        <span class=
"org-keyword">return</span> <span class=
"org-constant">this</span>.skip()
<span class="linenr">11063: </span>      }
<span class="linenr">11064: </span>
<span class="linenr">11065: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr">11066: </span>        node.type === <span class=
"org-string">'Identifier'</span> &amp;&
<span class="linenr">11067: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if inside $$(), skip unless this is a destructured prop binding</span>
<span class=
"linenr">11068: </span>        !(escapeScope &amp;& rootScope[node.name] !== <span class="org-string">'prop'</span>) &amp;&
<span class=
"linenr">11069: </span>        isReferencedIdentifier(node, parent, parentStack) &amp;&
<span class="linenr">11070: </span>        !excludedIds.has(node)
<span class="linenr">11071: </span>      ) {
<span class="linenr">11072: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">walk up the scope chain to check if id should be appended .value</span>
<span class="linenr">11073: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = scopeStack.length
<span class="linenr">11074: </span>        <span class=
"org-keyword">while</span> (i--) {
<span class="linenr">11075: </span>          <span class=
"org-keyword">if</span> (rewriteId(scopeStack[i], node, parent, parentStack)) {
<span class="linenr">11076: </span>            <span class=
"org-keyword">return</span>
<span class="linenr">11077: </span>          }
<span class="linenr">11078: </span>        }
<span class="linenr">11079: </span>      }
<span class="linenr">11080: </span>
<span class="linenr">11081: </span>      <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'CallExpression'</span> &amp;& node.callee.type === <span class="org-string">'Identifier'</span>) {
<span class="linenr">11082: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">callee</span> = node.callee.name
<span class="linenr">11083: </span>
<span class="linenr">11084: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">refCall</span> = isRefCreationCall(callee)
<span class="linenr">11085: </span>        <span class=
"org-keyword">if</span> (refCall &amp;& (!parent || parent.type !== <span class="org-string">'VariableDeclarator'</span>)) {
<span class="linenr">11086: </span>          <span class=
"org-keyword">return</span> error(
<span class="linenr">11087: </span>            <span class=
"org-string">`${refCall} can only be used as the initializer of `</span> +
<span class="linenr">11088: </span>              <span class=
"org-string">`a variable declaration.`</span>,
<span class="linenr">11089: </span>            node
<span class="linenr">11090: </span>          )
<span class="linenr">11091: </span>        }
<span class="linenr">11092: </span>
<span class="linenr">11093: </span>        <span class=
"org-keyword">if</span> (callee === escapeSymbol) {
<span class=
"linenr">11094: </span>          s.remove(node.callee.start + offset, node.callee.end + offset)
<span class="linenr">11095: </span>          escapeScope = node
<span class="linenr">11096: </span>        }
<span class="linenr">11097: </span>
<span class="linenr">11098: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO</span></span></span><span class=
"org-comment"> remove when out of experimental</span>
<span class="linenr">11099: </span>        <span class=
"org-keyword">if</span> (callee === <span class=
"org-string">'$raw'</span>) {
<span class="linenr">11100: </span>          error(
<span class="linenr">11101: </span>            <span class=
"org-string">`$raw() has been replaced by $$(). `</span> +
<span class="linenr">11102: </span>              <span class=
"org-string">`See ${RFC_LINK} for latest updates.`</span>,
<span class="linenr">11103: </span>            node
<span class="linenr">11104: </span>          )
<span class="linenr">11105: </span>        }
<span class="linenr">11106: </span>        <span class=
"org-keyword">if</span> (callee === <span class=
"org-string">'$fromRef'</span>) {
<span class="linenr">11107: </span>          error(
<span class="linenr">11108: </span>            <span class=
"org-string">`$fromRef() has been replaced by $(). `</span> +
<span class="linenr">11109: </span>              <span class=
"org-string">`See ${RFC_LINK} for latest updates.`</span>,
<span class="linenr">11110: </span>            node
<span class="linenr">11111: </span>          )
<span class="linenr">11112: </span>        }
<span class="linenr">11113: </span>      }
<span class="linenr">11114: </span>    },
<span class="linenr">11115: </span>    leave(node, parent) {
<span class=
"linenr">11116: </span>      parent &amp;& parentStack.pop()
<span class="linenr">11117: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr">11118: </span>        (node.type === <span class=
"org-string">'BlockStatement'</span> &amp;& !isFunctionType(parent)) ||
<span class="linenr">11119: </span>        isFunctionType(node)
<span class="linenr">11120: </span>      ) {
<span class="linenr">11121: </span>        scopeStack.pop()
<span class=
"linenr">11122: </span>        currentScope = scopeStack[scopeStack.length - <span class="org-highlight-numbers-number">1</span>] || <span class="org-constant">null</span>
<span class="linenr">11123: </span>      }
<span class="linenr">11124: </span>      <span class=
"org-keyword">if</span> (node === escapeScope) {
<span class=
"linenr">11125: </span>        escapeScope = <span class=
"org-constant">undefined</span>
<span class="linenr">11126: </span>      }
<span class="linenr">11127: </span>    }
<span class="linenr">11128: </span>  })
<span class="linenr">11129: </span>
<span class="linenr">11130: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr">11131: </span>    rootRefs: Object.keys(rootScope).filter(key =&gt; rootScope[key] === <span class="org-constant">true</span>),
<span class=
"linenr">11132: </span>    importedHelpers: [...importedHelpers]
<span class="linenr">11133: </span>  }
<span class="linenr">11134: </span>}
<span class="linenr">11135: </span>
<span class="linenr">11136: </span>  <span class=
"org-keyword">return</span> { transformAST, transform, shouldTransform }
<span class="linenr">11137: </span>}())
<span class="linenr">11138: </span>
<span class="linenr">11139: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">range</span> = <span class=
"org-highlight-numbers-number">2</span>
<span class="linenr">11140: </span>
<span class="linenr">11141: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">generateCodeFrame</span>(
<span class="linenr">11142: </span>  <span class=
"org-variable-name">source</span>,
<span class="linenr">11143: </span>  start = <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr">11144: </span>  end = source.length
<span class="linenr">11145: </span>) {
<span class="linenr">11146: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Split the content into individual lines but capture the newline sequence</span>
<span class="linenr">11147: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">that separated each line. This is important because the actual sequence is</span>
<span class="linenr">11148: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">needed to properly take into account the full line length for offset</span>
<span class="linenr">11149: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">comparison</span>
<span class="linenr">11150: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">lines</span> = source.split(<span class=
"org-string">/(\r?\n)/</span>)
<span class="linenr">11151: </span>
<span class="linenr">11152: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Separate the lines and newline sequences into separate arrays for easier referencing</span>
<span class="linenr">11153: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">newlineSequences</span> = lines.filter((_, idx) =&gt; idx % <span class="org-highlight-numbers-number">2</span> === <span class="org-highlight-numbers-number">1</span>)
<span class=
"linenr">11154: </span>  lines = lines.filter((_, idx) =&gt; idx % <span class="org-highlight-numbers-number">2</span> === <span class="org-highlight-numbers-number">0</span>)
<span class="linenr">11155: </span>
<span class="linenr">11156: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">count</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">11157: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">res</span> = []
<span class="linenr">11158: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; lines.length; i++) {
<span class="linenr">11159: </span>    count +=
<span class="linenr">11160: </span>      lines[i].length +
<span class=
"linenr">11161: </span>      ((newlineSequences[i] &amp;& newlineSequences[i].length) || <span class="org-highlight-numbers-number">0</span>)
<span class="linenr">11162: </span>    <span class=
"org-keyword">if</span> (count &gt;= start) {
<span class="linenr">11163: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">j</span> = i - range; j &lt;= i + range || end &gt; count; j++) {
<span class="linenr">11164: </span>        <span class=
"org-keyword">if</span> (j &lt; <span class=
"org-highlight-numbers-number">0</span> || j &gt;= lines.length) <span class="org-keyword">continue</span>
<span class="linenr">11165: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">line</span> = j + <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr">11166: </span>        res.push(
<span class="linenr">11167: </span>          <span class=
"org-string">`${line}${' '.repeat(Math.max(3 - String(line).length, 0))}|  ${</span>
<span class="linenr">11168: </span><span class=
"org-string">            lines[j]</span>
<span class="linenr">11169: </span><span class=
"org-string">          }`</span>
<span class="linenr">11170: </span>        )
<span class="linenr">11171: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">lineLength</span> = lines[j].length
<span class="linenr">11172: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">newLineSeqLength</span> =
<span class=
"linenr">11173: </span>          (newlineSequences[j] &amp;& newlineSequences[j].length) || <span class="org-highlight-numbers-number">0</span>
<span class="linenr">11174: </span>
<span class="linenr">11175: </span>        <span class=
"org-keyword">if</span> (j === i) {
<span class="linenr">11176: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">push underline</span>
<span class="linenr">11177: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">pad</span> = start - (count - (lineLength + newLineSeqLength))
<span class="linenr">11178: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">length</span> = Math.max(
<span class="linenr">11179: </span>            <span class=
"org-highlight-numbers-number">1</span>,
<span class=
"linenr">11180: </span>            end &gt; count ? lineLength - pad : end - start
<span class="linenr">11181: </span>          )
<span class="linenr">11182: </span>          res.push(<span class=
"org-string">`   |  `</span> + <span class=
"org-string">' '</span>.repeat(pad) + <span class=
"org-string">'^'</span>.repeat(length))
<span class="linenr">11183: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (j &gt; i) {
<span class="linenr">11184: </span>          <span class=
"org-keyword">if</span> (end &gt; count) {
<span class="linenr">11185: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">length</span> = Math.max(Math.min(end - count, lineLength), <span class="org-highlight-numbers-number">1</span>)
<span class=
"linenr">11186: </span>            res.push(<span class="org-string">`   |  `</span> + <span class="org-string">'^'</span>.repeat(length))
<span class="linenr">11187: </span>          }
<span class="linenr">11188: </span>
<span class=
"linenr">11189: </span>          count += lineLength + newLineSeqLength
<span class="linenr">11190: </span>        }
<span class="linenr">11191: </span>      }
<span class="linenr">11192: </span>      <span class=
"org-keyword">break</span>
<span class="linenr">11193: </span>    }
<span class="linenr">11194: </span>  }
<span class="linenr">11195: </span>  <span class=
"org-keyword">return</span> res.join(<span class=
"org-string">'\n'</span>)
<span class="linenr">11196: </span>}
<span class="linenr">11197: </span>
<span class="linenr">11198: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">registerBinding</span>(<span class=
"org-variable-name">bindings</span>, <span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">type</span>) {
<span class="linenr">11199: </span>  bindings[node.name] = type
<span class="linenr">11200: </span>}
<span class="linenr">11201: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">walkDeclaration</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">bindings</span>, <span class=
"org-variable-name">userImportAlias</span>) {
<span class="linenr">11202: </span>  <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'VariableDeclaration'</span>) {
<span class="linenr">11203: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isConst</span> = node.kind === <span class=
"org-string">'const'</span>
<span class="linenr">11204: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export const foo = ...</span>
<span class="linenr">11205: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> { id, init } <span class=
"org-keyword">of</span> node.declarations) {
<span class="linenr">11206: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDefineCall</span> = !!(
<span class="linenr">11207: </span>        isConst &amp;&
<span class="linenr">11208: </span>        isCallOf(
<span class="linenr">11209: </span>          init,
<span class=
"linenr">11210: </span>          c =&gt; c === DEFINE_PROPS || c === DEFINE_EMITS || c === WITH_DEFAULTS
<span class="linenr">11211: </span>        )
<span class="linenr">11212: </span>      )
<span class="linenr">11213: </span>      <span class=
"org-keyword">if</span> (id.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">11214: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">bindingType</span>
<span class="linenr">11215: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">userReactiveBinding</span> = userImportAlias[<span class="org-string">'reactive'</span>] || <span class="org-string">'reactive'</span>
<span class="linenr">11216: </span>        <span class=
"org-keyword">if</span> (isCallOf(init, userReactiveBinding)) {
<span class="linenr">11217: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">treat reactive() calls as let since it's meant to be mutable</span>
<span class=
"linenr">11218: </span>          bindingType = BindingTypes.SETUP_LET
<span class="linenr">11219: </span>        } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class="linenr">11220: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if a declaration is a const literal, we can mark it so that</span>
<span class="linenr">11221: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the generated render fn code doesn't need to unref() it</span>
<span class="linenr">11222: </span>          isDefineCall ||
<span class=
"linenr">11223: </span>          (isConst &amp;& canNeverBeRef(init, userReactiveBinding))
<span class="linenr">11224: </span>        ) {
<span class=
"linenr">11225: </span>          bindingType = BindingTypes.SETUP_CONST
<span class="linenr">11226: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isConst) {
<span class="linenr">11227: </span>          <span class=
"org-keyword">if</span> (isCallOf(init, userImportAlias[<span class="org-string">'ref'</span>] || <span class="org-string">'ref'</span>)) {
<span class=
"linenr">11228: </span>            bindingType = BindingTypes.SETUP_REF
<span class="linenr">11229: </span>          } <span class=
"org-keyword">else</span> {
<span class=
"linenr">11230: </span>            bindingType = BindingTypes.SETUP_MAYBE_REF
<span class="linenr">11231: </span>          }
<span class="linenr">11232: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr">11233: </span>          bindingType = BindingTypes.SETUP_LET
<span class="linenr">11234: </span>        }
<span class=
"linenr">11235: </span>        registerBinding(bindings, id, bindingType)
<span class="linenr">11236: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">11237: </span>        <span class=
"org-keyword">if</span> (isCallOf(init, DEFINE_PROPS)) {
<span class="linenr">11238: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip walking props destructure</span>
<span class="linenr">11239: </span>          <span class=
"org-keyword">return</span>
<span class="linenr">11240: </span>        }
<span class="linenr">11241: </span>        <span class=
"org-keyword">if</span> (id.type === <span class=
"org-string">'ObjectPattern'</span>) {
<span class=
"linenr">11242: </span>          walkObjectPattern(id, bindings, isConst, isDefineCall)
<span class="linenr">11243: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (id.type === <span class=
"org-string">'ArrayPattern'</span>) {
<span class=
"linenr">11244: </span>          walkArrayPattern(id, bindings, isConst, isDefineCall)
<span class="linenr">11245: </span>        }
<span class="linenr">11246: </span>      }
<span class="linenr">11247: </span>    }
<span class="linenr">11248: </span>  } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class="linenr">11249: </span>    node.type === <span class=
"org-string">'TSEnumDeclaration'</span> ||
<span class="linenr">11250: </span>    node.type === <span class=
"org-string">'FunctionDeclaration'</span> ||
<span class="linenr">11251: </span>    node.type === <span class=
"org-string">'ClassDeclaration'</span>
<span class="linenr">11252: </span>  ) {
<span class="linenr">11253: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export function foo() {} / export class Foo {}</span>
<span class="linenr">11254: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export declarations must be named.</span>
<span class=
"linenr">11255: </span>    bindings[node.id.name] = BindingTypes.SETUP_CONST
<span class="linenr">11256: </span>  }
<span class="linenr">11257: </span>}
<span class="linenr">11258: </span>
<span class="linenr">11259: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">walkObjectPattern</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">bindings</span>, <span class=
"org-variable-name">isConst</span>, <span class=
"org-variable-name">isDefineCall</span> = <span class=
"org-constant">false</span>) {
<span class="linenr">11260: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> <span class=
"org-keyword">of</span> node.properties) {
<span class="linenr">11261: </span>    <span class=
"org-keyword">if</span> (p.type === <span class=
"org-string">'ObjectProperty'</span>) {
<span class="linenr">11262: </span>      <span class=
"org-keyword">if</span> (p.key.type === <span class=
"org-string">'Identifier'</span> &amp;& p.key === p.value) {
<span class="linenr">11263: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">shorthand: const { x } = ...</span>
<span class="linenr">11264: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = isDefineCall
<span class=
"linenr">11265: </span>          ? BindingTypes.SETUP_CONST
<span class="linenr">11266: </span>          : isConst
<span class=
"linenr">11267: </span>          ? BindingTypes.SETUP_MAYBE_REF
<span class=
"linenr">11268: </span>          : BindingTypes.SETUP_LET
<span class=
"linenr">11269: </span>        registerBinding(bindings, p.key, type)
<span class="linenr">11270: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr">11271: </span>        walkPattern(p.value, bindings, isConst, isDefineCall)
<span class="linenr">11272: </span>      }
<span class="linenr">11273: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">11274: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">...rest</span>
<span class="linenr">11275: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">argument can only be identifier when destructuring</span>
<span class="linenr">11276: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = isConst ? BindingTypes.SETUP_CONST : BindingTypes.SETUP_LET
<span class=
"linenr">11277: </span>      registerBinding(bindings, p.argument, type)
<span class="linenr">11278: </span>    }
<span class="linenr">11279: </span>  }
<span class="linenr">11280: </span>}
<span class="linenr">11281: </span>
<span class="linenr">11282: </span>
<span class="linenr">11283: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">walkArrayPattern</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">bindings</span>, <span class=
"org-variable-name">isConst</span>, <span class=
"org-variable-name">isDefineCall</span> = <span class=
"org-constant">false</span>) {
<span class="linenr">11284: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">e</span> <span class=
"org-keyword">of</span> node.elements) {
<span class=
"linenr">11285: </span>    e &amp;& walkPattern(e, bindings, isConst, isDefineCall)
<span class="linenr">11286: </span>  }
<span class="linenr">11287: </span>}
<span class="linenr">11288: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">walkPattern</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">bindings</span>, <span class=
"org-variable-name">isConst</span>, <span class=
"org-variable-name">isDefineCall</span> = <span class=
"org-constant">false</span>) {
<span class="linenr">11289: </span>  <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">11290: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = isDefineCall
<span class="linenr">11291: </span>      ? BindingTypes.SETUP_CONST
<span class="linenr">11292: </span>      : isConst
<span class=
"linenr">11293: </span>      ? BindingTypes.SETUP_MAYBE_REF
<span class="linenr">11294: </span>      : BindingTypes.SETUP_LET
<span class=
"linenr">11295: </span>    registerBinding(bindings, node, type)
<span class="linenr">11296: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'RestElement'</span>) {
<span class="linenr">11297: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">argument can only be identifier when destructuring</span>
<span class="linenr">11298: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = isConst ? BindingTypes.SETUP_CONST : BindingTypes.SETUP_LET
<span class=
"linenr">11299: </span>    registerBinding(bindings, node.argument, type)
<span class="linenr">11300: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ObjectPattern'</span>) {
<span class=
"linenr">11301: </span>    walkObjectPattern(node, bindings, isConst)
<span class="linenr">11302: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ArrayPattern'</span>) {
<span class=
"linenr">11303: </span>    walkArrayPattern(node, bindings, isConst)
<span class="linenr">11304: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'AssignmentPattern'</span>) {
<span class="linenr">11305: </span>    <span class=
"org-keyword">if</span> (node.left.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">11306: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = isDefineCall
<span class=
"linenr">11307: </span>        ? BindingTypes.SETUP_CONST
<span class="linenr">11308: </span>        : isConst
<span class=
"linenr">11309: </span>        ? BindingTypes.SETUP_MAYBE_REF
<span class="linenr">11310: </span>        : BindingTypes.SETUP_LET
<span class=
"linenr">11311: </span>      registerBinding(bindings, node.left, type)
<span class="linenr">11312: </span>    } <span class=
"org-keyword">else</span> {
<span class=
"linenr">11313: </span>      walkPattern(node.left, bindings, isConst)
<span class="linenr">11314: </span>    }
<span class="linenr">11315: </span>  }
<span class="linenr">11316: </span>}
<span class="linenr">11317: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">recordType</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">declaredTypes</span>) {
<span class="linenr">11318: </span>  <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'TSInterfaceDeclaration'</span>) {
<span class=
"linenr">11319: </span>    declaredTypes[node.id.name] = [<span class="org-string">`Object`</span>]
<span class="linenr">11320: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'TSTypeAliasDeclaration'</span>) {
<span class=
"linenr">11321: </span>    declaredTypes[node.id.name] = inferRuntimeType(
<span class="linenr">11322: </span>      node.typeAnnotation,
<span class="linenr">11323: </span>      declaredTypes
<span class="linenr">11324: </span>    )
<span class="linenr">11325: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ExportNamedDeclaration'</span> &amp;& node.declaration) {
<span class=
"linenr">11326: </span>    recordType(node.declaration, declaredTypes)
<span class="linenr">11327: </span>  }
<span class="linenr">11328: </span>}
<span class="linenr">11329: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">extractRuntimeProps</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">props</span>, <span class=
"org-variable-name">declaredTypes</span>, <span class=
"org-variable-name">isProd</span>) {
<span class="linenr">11330: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">members</span> = node.type === <span class=
"org-string">'TSTypeLiteral'</span> ? node.members : node.body
<span class="linenr">11331: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">m</span> <span class=
"org-keyword">of</span> members) {
<span class="linenr">11332: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr">11333: </span>      (m.type === <span class=
"org-string">'TSPropertySignature'</span> || m.type === <span class="org-string">'TSMethodSignature'</span>) &amp;&
<span class=
"linenr">11334: </span>      m.key.type === <span class="org-string">'Identifier'</span>
<span class="linenr">11335: </span>    ) {
<span class="linenr">11336: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">type</span>
<span class="linenr">11337: </span>      <span class=
"org-keyword">if</span> (m.type === <span class=
"org-string">'TSMethodSignature'</span>) {
<span class="linenr">11338: </span>        type = [<span class=
"org-string">'Function'</span>]
<span class="linenr">11339: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (m.typeAnnotation) {
<span class=
"linenr">11340: </span>        type = inferRuntimeType(m.typeAnnotation.typeAnnotation, declaredTypes)
<span class="linenr">11341: </span>      }
<span class="linenr">11342: </span>      props[m.key.name] = {
<span class="linenr">11343: </span>        key: m.key.name,
<span class="linenr">11344: </span>        required: !m.optional,
<span class=
"linenr">11345: </span>        type: type || [<span class=
"org-string">`null`</span>]
<span class="linenr">11346: </span>      }
<span class="linenr">11347: </span>    }
<span class="linenr">11348: </span>  }
<span class="linenr">11349: </span>}
<span class="linenr">11350: </span>
<span class="linenr">11351: </span>
<span class="linenr">11352: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">inferRuntimeType</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">declaredTypes</span>) {
<span class="linenr">11353: </span>  <span class=
"org-keyword">switch</span> (node.type) {
<span class="linenr">11354: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSStringKeyword'</span>:
<span class="linenr">11355: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'String'</span>]
<span class="linenr">11356: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSNumberKeyword'</span>:
<span class="linenr">11357: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Number'</span>]
<span class="linenr">11358: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSBooleanKeyword'</span>:
<span class="linenr">11359: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Boolean'</span>]
<span class="linenr">11360: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSObjectKeyword'</span>:
<span class="linenr">11361: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Object'</span>]
<span class="linenr">11362: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSTypeLiteral'</span>:
<span class="linenr">11363: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO</span></span></span><span class=
"org-comment"> (nice to have) generate runtime property validation</span>
<span class="linenr">11364: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Object'</span>]
<span class="linenr">11365: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSFunctionType'</span>:
<span class="linenr">11366: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Function'</span>]
<span class="linenr">11367: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSArrayType'</span>:
<span class="linenr">11368: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSTupleType'</span>:
<span class="linenr">11369: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO</span></span></span><span class=
"org-comment"> (nice to have) generate runtime element type/length checks</span>
<span class="linenr">11370: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Array'</span>]
<span class="linenr">11371: </span>
<span class="linenr">11372: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSLiteralType'</span>:
<span class="linenr">11373: </span>      <span class=
"org-keyword">switch</span> (node.literal.type) {
<span class="linenr">11374: </span>        <span class=
"org-keyword">case</span> <span class=
"org-string">'StringLiteral'</span>:
<span class="linenr">11375: </span>          <span class=
"org-keyword">return</span> [<span class=
"org-string">'String'</span>]
<span class="linenr">11376: </span>        <span class=
"org-keyword">case</span> <span class=
"org-string">'BooleanLiteral'</span>:
<span class="linenr">11377: </span>          <span class=
"org-keyword">return</span> [<span class=
"org-string">'Boolean'</span>]
<span class="linenr">11378: </span>        <span class=
"org-keyword">case</span> <span class=
"org-string">'NumericLiteral'</span>:
<span class="linenr">11379: </span>        <span class=
"org-keyword">case</span> <span class=
"org-string">'BigIntLiteral'</span>:
<span class="linenr">11380: </span>          <span class=
"org-keyword">return</span> [<span class=
"org-string">'Number'</span>]
<span class="linenr">11381: </span>        <span class=
"org-keyword">default</span>:
<span class="linenr">11382: </span>          <span class=
"org-keyword">return</span> [<span class=
"org-string">`null`</span>]
<span class="linenr">11383: </span>      }
<span class="linenr">11384: </span>
<span class="linenr">11385: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSTypeReference'</span>:
<span class="linenr">11386: </span>      <span class=
"org-keyword">if</span> (node.typeName.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">11387: </span>        <span class=
"org-keyword">if</span> (declaredTypes[node.typeName.name]) {
<span class="linenr">11388: </span>          <span class=
"org-keyword">return</span> declaredTypes[node.typeName.name]
<span class="linenr">11389: </span>        }
<span class="linenr">11390: </span>        <span class=
"org-keyword">switch</span> (node.typeName.name) {
<span class="linenr">11391: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Array'</span>:
<span class="linenr">11392: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'Function'</span>:
<span class="linenr">11393: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Object'</span>:
<span class="linenr">11394: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Set'</span>:
<span class="linenr">11395: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Map'</span>:
<span class="linenr">11396: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'WeakSet'</span>:
<span class="linenr">11397: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'WeakMap'</span>:
<span class="linenr">11398: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Date'</span>:
<span class="linenr">11399: </span>            <span class=
"org-keyword">return</span> [node.typeName.name]
<span class="linenr">11400: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Record'</span>:
<span class="linenr">11401: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'Partial'</span>:
<span class="linenr">11402: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'Readonly'</span>:
<span class="linenr">11403: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Pick'</span>:
<span class="linenr">11404: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Omit'</span>:
<span class="linenr">11405: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'Exclude'</span>:
<span class="linenr">11406: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'Extract'</span>:
<span class="linenr">11407: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'Required'</span>:
<span class="linenr">11408: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'InstanceType'</span>:
<span class="linenr">11409: </span>            <span class=
"org-keyword">return</span> [<span class=
"org-string">'Object'</span>]
<span class="linenr">11410: </span>        }
<span class="linenr">11411: </span>      }
<span class="linenr">11412: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">`null`</span>]
<span class="linenr">11413: </span>
<span class="linenr">11414: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSParenthesizedType'</span>:
<span class="linenr">11415: </span>      <span class=
"org-keyword">return</span> inferRuntimeType(node.typeAnnotation, declaredTypes)
<span class="linenr">11416: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSUnionType'</span>:
<span class="linenr">11417: </span>      <span class=
"org-keyword">return</span> [
<span class="linenr">11418: </span>        ...<span class=
"org-keyword">new</span> <span class="org-type">Set</span>(
<span class="linenr">11419: </span>          [].concat(
<span class=
"linenr">11420: </span>            ...(node.types.map(t =&gt; inferRuntimeType(t, declaredTypes)))
<span class="linenr">11421: </span>          )
<span class="linenr">11422: </span>        )
<span class="linenr">11423: </span>      ]
<span class="linenr">11424: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSIntersectionType'</span>:
<span class="linenr">11425: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Object'</span>]
<span class="linenr">11426: </span>
<span class="linenr">11427: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSSymbolKeyword'</span>:
<span class="linenr">11428: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Symbol'</span>]
<span class="linenr">11429: </span>
<span class="linenr">11430: </span>    <span class=
"org-keyword">default</span>:
<span class="linenr">11431: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">`null`</span>] <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no runtime check</span>
<span class="linenr">11432: </span>  }
<span class="linenr">11433: </span>}
<span class="linenr">11434: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">toRuntimeTypeString</span>(<span class=
"org-variable-name">types</span>) {
<span class="linenr">11435: </span>  <span class=
"org-keyword">return</span> types.length &gt; <span class=
"org-highlight-numbers-number">1</span> ? <span class=
"org-string">`[${types.join(', ')}]`</span> : types[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr">11436: </span>}
<span class="linenr">11437: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">extractRuntimeEmits</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">emits</span>) {
<span class="linenr">11438: </span>  <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'TSTypeLiteral'</span> || node.type === <span class=
"org-string">'TSInterfaceBody'</span>) {
<span class="linenr">11439: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">members</span> = node.type === <span class=
"org-string">'TSTypeLiteral'</span> ? node.members : node.body
<span class="linenr">11440: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">t</span> <span class=
"org-keyword">of</span> members) {
<span class="linenr">11441: </span>      <span class=
"org-keyword">if</span> (t.type === <span class=
"org-string">'TSCallSignatureDeclaration'</span>) {
<span class=
"linenr">11442: </span>        extractEventNames(t.parameters[<span class="org-highlight-numbers-number">0</span>], emits)
<span class="linenr">11443: </span>      }
<span class="linenr">11444: </span>    }
<span class="linenr">11445: </span>    <span class=
"org-keyword">return</span>
<span class="linenr">11446: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr">11447: </span>    extractEventNames(node.parameters[<span class="org-highlight-numbers-number">0</span>], emits)
<span class="linenr">11448: </span>  }
<span class="linenr">11449: </span>}
<span class="linenr">11450: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">extractEventNames</span>(<span class=
"org-variable-name">eventName</span>, <span class=
"org-variable-name">emits</span>) {
<span class="linenr">11451: </span>  <span class=
"org-keyword">if</span> (
<span class=
"linenr">11452: </span>    eventName.type === <span class=
"org-string">'Identifier'</span> &amp;&
<span class=
"linenr">11453: </span>    eventName.typeAnnotation &amp;&
<span class=
"linenr">11454: </span>    eventName.typeAnnotation.type === <span class="org-string">'TSTypeAnnotation'</span>
<span class="linenr">11455: </span>  ) {
<span class="linenr">11456: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">typeNode</span> = eventName.typeAnnotation.typeAnnotation
<span class="linenr">11457: </span>    <span class=
"org-keyword">if</span> (typeNode.type === <span class=
"org-string">'TSLiteralType'</span>) {
<span class="linenr">11458: </span>      <span class=
"org-keyword">if</span> (typeNode.literal.type !== <span class=
"org-string">'UnaryExpression'</span>) {
<span class=
"linenr">11459: </span>        emits.add(String(typeNode.literal.value))
<span class="linenr">11460: </span>      }
<span class="linenr">11461: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (typeNode.type === <span class=
"org-string">'TSUnionType'</span>) {
<span class="linenr">11462: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">t</span> <span class=
"org-keyword">of</span> typeNode.types) {
<span class="linenr">11463: </span>        <span class=
"org-keyword">if</span> (
<span class=
"linenr">11464: </span>          t.type === <span class="org-string">'TSLiteralType'</span> &amp;&
<span class=
"linenr">11465: </span>          t.literal.type !== <span class=
"org-string">'UnaryExpression'</span>
<span class="linenr">11466: </span>        ) {
<span class=
"linenr">11467: </span>          emits.add(String(t.literal.value))
<span class="linenr">11468: </span>        }
<span class="linenr">11469: </span>      }
<span class="linenr">11470: </span>    }
<span class="linenr">11471: </span>  }
<span class="linenr">11472: </span>}
<span class="linenr">11473: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genRuntimeEmits</span>(<span class=
"org-variable-name">emits</span>) {
<span class="linenr">11474: </span>  <span class=
"org-keyword">return</span> emits.size
<span class="linenr">11475: </span>    ? <span class=
"org-string">`\n  emits: [${Array.from(emits)</span>
<span class="linenr">11476: </span><span class=
"org-string">        .map(p =&gt; JSON.stringify(p))</span>
<span class="linenr">11477: </span><span class=
"org-string">        .join(', ')}],`</span>
<span class="linenr">11478: </span>    : <span class=
"org-string">``</span>
<span class="linenr">11479: </span>}
<span class="linenr">11480: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isCallOf</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">test</span>) {
<span class="linenr">11481: </span>  <span class=
"org-keyword">return</span> !!(
<span class="linenr">11482: </span>    node &amp;&
<span class="linenr">11483: </span>    node.type === <span class=
"org-string">'CallExpression'</span> &amp;&
<span class=
"linenr">11484: </span>    node.callee.type === <span class=
"org-string">'Identifier'</span> &amp;&
<span class="linenr">11485: </span>    (<span class=
"org-keyword">typeof</span> test === <span class=
"org-string">'string'</span>
<span class=
"linenr">11486: </span>      ? node.callee.name === test
<span class="linenr">11487: </span>      : test(node.callee.name))
<span class="linenr">11488: </span>  )
<span class="linenr">11489: </span>}
<span class="linenr">11490: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">canNeverBeRef</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">userReactiveImport</span>) {
<span class="linenr">11491: </span>  <span class=
"org-keyword">if</span> (isCallOf(node, userReactiveImport)) {
<span class="linenr">11492: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">11493: </span>  }
<span class="linenr">11494: </span>  <span class=
"org-keyword">switch</span> (node.type) {
<span class="linenr">11495: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'UnaryExpression'</span>:
<span class="linenr">11496: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'BinaryExpression'</span>:
<span class="linenr">11497: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ArrayExpression'</span>:
<span class="linenr">11498: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ObjectExpression'</span>:
<span class="linenr">11499: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'FunctionExpression'</span>:
<span class="linenr">11500: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ArrowFunctionExpression'</span>:
<span class="linenr">11501: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'UpdateExpression'</span>:
<span class="linenr">11502: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ClassExpression'</span>:
<span class="linenr">11503: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TaggedTemplateExpression'</span>:
<span class="linenr">11504: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">11505: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'SequenceExpression'</span>:
<span class="linenr">11506: </span>      <span class=
"org-keyword">return</span> canNeverBeRef(
<span class=
"linenr">11507: </span>        node.expressions[node.expressions.length - <span class="org-highlight-numbers-number">1</span>],
<span class="linenr">11508: </span>        userReactiveImport
<span class="linenr">11509: </span>      )
<span class="linenr">11510: </span>    <span class=
"org-keyword">default</span>:
<span class="linenr">11511: </span>      <span class=
"org-keyword">if</span> (node.type.endsWith(<span class=
"org-string">'Literal'</span>)) {
<span class="linenr">11512: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">11513: </span>      }
<span class="linenr">11514: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">11515: </span>  }
<span class="linenr">11516: </span>}
<span class="linenr">11517: </span>
<span class="linenr">11518: </span>
<span class="linenr">11519: </span><span class="org-doc">/**</span>
<span class="linenr">11520: </span><span class=
"org-doc"> * Analyze bindings in normal `&lt;script&gt;`</span>
<span class="linenr">11521: </span><span class=
"org-doc"> * Note that `compileScriptSetup` already analyzes bindings as part of its</span>
<span class="linenr">11522: </span><span class=
"org-doc"> * compilation process so this should only be used on single `&lt;script&gt;` SFCs.</span>
<span class="linenr">11523: </span><span class="org-doc"> */</span>
<span class="linenr">11524: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">analyzeScriptBindings</span>(<span class=
"org-variable-name">ast</span>) {
<span class="linenr">11525: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> <span class=
"org-keyword">of</span> ast) {
<span class="linenr">11526: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr">11527: </span>      node.type === <span class=
"org-string">'ExportDefaultDeclaration'</span> &amp;&
<span class=
"linenr">11528: </span>      node.declaration.type === <span class=
"org-string">'ObjectExpression'</span>
<span class="linenr">11529: </span>    ) {
<span class="linenr">11530: </span>      <span class=
"org-keyword">return</span> analyzeBindingsFromOptions(node.declaration)
<span class="linenr">11531: </span>    }
<span class="linenr">11532: </span>  }
<span class="linenr">11533: </span>  <span class=
"org-keyword">return</span> {}
<span class="linenr">11534: </span>}
<span class="linenr">11535: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">analyzeBindingsFromOptions</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">11536: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bindings</span> = {}
<span class="linenr">11537: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#3270, #3275</span>
<span class="linenr">11538: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">mark non-script-setup so we don't resolve components/directives from these</span>
<span class=
"linenr">11539: </span>  Object.defineProperty(bindings, <span class="org-string">'__isScriptSetup'</span>, {
<span class="linenr">11540: </span>    enumerable: <span class=
"org-constant">false</span>,
<span class="linenr">11541: </span>    value: <span class=
"org-constant">false</span>
<span class="linenr">11542: </span>  })
<span class="linenr">11543: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">property</span> <span class=
"org-keyword">of</span> node.properties) {
<span class="linenr">11544: </span>    <span class=
"org-keyword">if</span> (
<span class=
"linenr">11545: </span>      property.type === <span class=
"org-string">'ObjectProperty'</span> &amp;&
<span class="linenr">11546: </span>      !property.computed &amp;&
<span class=
"linenr">11547: </span>      property.key.type === <span class=
"org-string">'Identifier'</span>
<span class="linenr">11548: </span>    ) {
<span class="linenr">11549: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props</span>
<span class="linenr">11550: </span>      <span class=
"org-keyword">if</span> (property.key.name === <span class=
"org-string">'props'</span>) {
<span class="linenr">11551: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props: ['foo']</span>
<span class="linenr">11552: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props: { foo: ... }</span>
<span class="linenr">11553: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">of</span> getObjectOrArrayExpressionKeys(property.value)) {
<span class=
"linenr">11554: </span>          bindings[key] = BindingTypes.PROPS
<span class="linenr">11555: </span>        }
<span class="linenr">11556: </span>      }
<span class="linenr">11557: </span>
<span class="linenr">11558: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject</span>
<span class="linenr">11559: </span>      <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (property.key.name === <span class=
"org-string">'inject'</span>) {
<span class="linenr">11560: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject: ['foo']</span>
<span class="linenr">11561: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject: { foo: {} }</span>
<span class="linenr">11562: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">of</span> getObjectOrArrayExpressionKeys(property.value)) {
<span class=
"linenr">11563: </span>          bindings[key] = BindingTypes.OPTIONS
<span class="linenr">11564: </span>        }
<span class="linenr">11565: </span>      }
<span class="linenr">11566: </span>
<span class="linenr">11567: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">computed & methods</span>
<span class="linenr">11568: </span>      <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr">11569: </span>        property.value.type === <span class=
"org-string">'ObjectExpression'</span> &amp;&
<span class=
"linenr">11570: </span>        (property.key.name === <span class=
"org-string">'computed'</span> || property.key.name === <span class="org-string">'methods'</span>)
<span class="linenr">11571: </span>      ) {
<span class="linenr">11572: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">methods: { foo() {} }</span>
<span class="linenr">11573: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">computed: { foo() {} }</span>
<span class="linenr">11574: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">of</span> getObjectExpressionKeys(property.value)) {
<span class=
"linenr">11575: </span>          bindings[key] = BindingTypes.OPTIONS
<span class="linenr">11576: </span>        }
<span class="linenr">11577: </span>      }
<span class="linenr">11578: </span>    }
<span class="linenr">11579: </span>
<span class="linenr">11580: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">setup & data</span>
<span class="linenr">11581: </span>    <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr">11582: </span>      property.type === <span class=
"org-string">'ObjectMethod'</span> &amp;&
<span class=
"linenr">11583: </span>      property.key.type === <span class=
"org-string">'Identifier'</span> &amp;&
<span class=
"linenr">11584: </span>      (property.key.name === <span class=
"org-string">'setup'</span> || property.key.name === <span class=
"org-string">'data'</span>)
<span class="linenr">11585: </span>    ) {
<span class="linenr">11586: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">bodyItem</span> <span class=
"org-keyword">of</span> property.body.body) {
<span class="linenr">11587: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">setup() {</span>
<span class="linenr">11588: </span>        <span class=
"org-comment-delimiter">//   </span><span class=
"org-comment">return {</span>
<span class="linenr">11589: </span>        <span class=
"org-comment-delimiter">//     </span><span class=
"org-comment">foo: null</span>
<span class="linenr">11590: </span>        <span class=
"org-comment-delimiter">//   </span><span class=
"org-comment">}</span>
<span class="linenr">11591: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">}</span>
<span class="linenr">11592: </span>        <span class=
"org-keyword">if</span> (
<span class=
"linenr">11593: </span>          bodyItem.type === <span class=
"org-string">'ReturnStatement'</span> &amp;&
<span class=
"linenr">11594: </span>          bodyItem.argument &amp;&
<span class=
"linenr">11595: </span>          bodyItem.argument.type === <span class="org-string">'ObjectExpression'</span>
<span class="linenr">11596: </span>        ) {
<span class="linenr">11597: </span>          <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">of</span> getObjectExpressionKeys(bodyItem.argument)) {
<span class="linenr">11598: </span>            bindings[key] =
<span class=
"linenr">11599: </span>              property.key.name === <span class="org-string">'setup'</span>
<span class=
"linenr">11600: </span>                ? BindingTypes.SETUP_MAYBE_REF
<span class=
"linenr">11601: </span>                : BindingTypes.DATA
<span class="linenr">11602: </span>          }
<span class="linenr">11603: </span>        }
<span class="linenr">11604: </span>      }
<span class="linenr">11605: </span>    }
<span class="linenr">11606: </span>  }
<span class="linenr">11607: </span>
<span class="linenr">11608: </span>  <span class=
"org-keyword">return</span> bindings
<span class="linenr">11609: </span>}
<span class="linenr">11610: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getObjectExpressionKeys</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">11611: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keys</span> = []
<span class="linenr">11612: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">prop</span> <span class=
"org-keyword">of</span> node.properties) {
<span class="linenr">11613: </span>    <span class=
"org-keyword">if</span> (
<span class=
"linenr">11614: </span>      (prop.type === <span class="org-string">'ObjectProperty'</span> || prop.type === <span class="org-string">'ObjectMethod'</span>) &amp;&
<span class="linenr">11615: </span>      !prop.computed
<span class="linenr">11616: </span>    ) {
<span class="linenr">11617: </span>      <span class=
"org-keyword">if</span> (prop.key.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">11618: </span>        keys.push(prop.key.name)
<span class="linenr">11619: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (prop.key.type === <span class=
"org-string">'StringLiteral'</span>) {
<span class=
"linenr">11620: </span>        keys.push(prop.key.value)
<span class="linenr">11621: </span>      }
<span class="linenr">11622: </span>    }
<span class="linenr">11623: </span>  }
<span class="linenr">11624: </span>  <span class=
"org-keyword">return</span> keys
<span class="linenr">11625: </span>}
<span class="linenr">11626: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getArrayExpressionKeys</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">11627: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keys</span> = []
<span class="linenr">11628: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">element</span> <span class=
"org-keyword">of</span> node.elements) {
<span class="linenr">11629: </span>    <span class=
"org-keyword">if</span> (element &amp;& element.type === <span class="org-string">'StringLiteral'</span>) {
<span class="linenr">11630: </span>      keys.push(element.value)
<span class="linenr">11631: </span>    }
<span class="linenr">11632: </span>  }
<span class="linenr">11633: </span>  <span class=
"org-keyword">return</span> keys
<span class="linenr">11634: </span>}
<span class="linenr">11635: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">getObjectOrArrayExpressionKeys</span>(<span class="org-variable-name">value</span>) {
<span class="linenr">11636: </span>  <span class=
"org-keyword">if</span> (value.type === <span class=
"org-string">'ArrayExpression'</span>) {
<span class="linenr">11637: </span>    <span class=
"org-keyword">return</span> getArrayExpressionKeys(value)
<span class="linenr">11638: </span>  }
<span class="linenr">11639: </span>  <span class=
"org-keyword">if</span> (value.type === <span class=
"org-string">'ObjectExpression'</span>) {
<span class="linenr">11640: </span>    <span class=
"org-keyword">return</span> getObjectExpressionKeys(value)
<span class="linenr">11641: </span>  }
<span class="linenr">11642: </span>  <span class=
"org-keyword">return</span> []
<span class="linenr">11643: </span>}
<span class="linenr">11644: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">resolveTemplateUsageCheckString</span>(<span class="org-variable-name">sfc</span>) {
<span class="linenr">11645: </span>  <span class=
"org-keyword">const</span> { content, ast } = sfc.template
<span class="linenr">11646: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">cached</span> = templateUsageCheckCache.get(content)
<span class="linenr">11647: </span>  <span class=
"org-keyword">if</span> (cached) {
<span class="linenr">11648: </span>    <span class=
"org-keyword">return</span> cached
<span class="linenr">11649: </span>  }
<span class="linenr">11650: </span>
<span class="linenr">11651: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">code</span> = <span class=
"org-string">''</span>
<span class="linenr">11652: </span>  transform(createRoot([ast]), {
<span class="linenr">11653: </span>    nodeTransforms: [
<span class="linenr">11654: </span>      node =&gt; {
<span class="linenr">11655: </span>        <span class=
"org-keyword">if</span> (node.type === NodeTypes.ELEMENT) {
<span class="linenr">11656: </span>          <span class=
"org-keyword">if</span> (
<span class=
"linenr">11657: </span>            !parserOptions.isNativeTag(node.tag) &amp;&
<span class=
"linenr">11658: </span>            !parserOptions.isBuiltInComponent(node.tag)
<span class="linenr">11659: </span>          ) {
<span class="linenr">11660: </span>            code += <span class=
"org-string">`,${camelize(node.tag)},${capitalize(camelize(node.tag))}`</span>
<span class="linenr">11661: </span>          }
<span class="linenr">11662: </span>          <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr">11663: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prop</span> = node.props[i]
<span class="linenr">11664: </span>            <span class=
"org-keyword">if</span> (prop.type === NodeTypes.DIRECTIVE) {
<span class="linenr">11665: </span>              <span class=
"org-keyword">if</span> (!isBuiltInDir(prop.name)) {
<span class=
"linenr">11666: </span>                code += <span class=
"org-string">`,v${capitalize(camelize(prop.name))}`</span>
<span class="linenr">11667: </span>              }
<span class="linenr">11668: </span>              <span class=
"org-keyword">if</span> (prop.exp) {
<span class=
"linenr">11669: </span>                code += <span class=
"org-string">`,${stripStrings(prop.exp.content)}`</span>
<span class="linenr">11670: </span>              }
<span class="linenr">11671: </span>            }
<span class="linenr">11672: </span>          }
<span class="linenr">11673: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === NodeTypes.INTERPOLATION) {
<span class="linenr">11674: </span>          code += <span class=
"org-string">`,${stripStrings(node.content.content)}`</span>
<span class="linenr">11675: </span>        }
<span class="linenr">11676: </span>      }
<span class="linenr">11677: </span>    ]
<span class="linenr">11678: </span>  })
<span class="linenr">11679: </span>
<span class="linenr">11680: </span>  code += <span class=
"org-string">';'</span>
<span class=
"linenr">11681: </span>  templateUsageCheckCache.set(content, code)
<span class="linenr">11682: </span>  <span class=
"org-keyword">return</span> code
<span class="linenr">11683: </span>}
<span class="linenr">11684: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">stripStrings</span>(<span class=
"org-variable-name">exp</span>) {
<span class="linenr">11685: </span>  <span class=
"org-keyword">return</span> exp
<span class="linenr">11686: </span>    .replace(<span class=
"org-string">/'[^']*'|"[^"]*"/</span>g, <span class=
"org-string">''</span>)
<span class="linenr">11687: </span>    .replace(<span class=
"org-string">/`[^`]+`/</span>g, stripTemplateString)
<span class="linenr">11688: </span>}
<span class="linenr">11689: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">isImportUsed</span>(<span class=
"org-variable-name">local</span>, <span class=
"org-variable-name">sfc</span>) {
<span class="linenr">11690: </span>  <span class=
"org-keyword">return</span> <span class=
"org-keyword">new</span> <span class="org-type">RegExp</span>(
<span class="linenr">11691: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#4274 escape $ since it's a special char in regex</span>
<span class="linenr">11692: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">(and is the only regex special char that is valid in identifiers)</span>
<span class="linenr">11693: </span>    <span class=
"org-string">`[^\\w$_]${local.replace(/\$/g, '\\$')}[^\\w$_]`</span>
<span class=
"linenr">11694: </span>  ).test(resolveTemplateUsageCheckString(sfc))
<span class="linenr">11695: </span>}
<span class="linenr">11696: </span><span class="org-doc">/**</span>
<span class="linenr">11697: </span><span class=
"org-doc"> * Note: this comparison assumes the prev/next script are already identical,</span>
<span class="linenr">11698: </span><span class=
"org-doc"> * and only checks the special case where &lt;script setup lang="ts"&gt; unused import</span>
<span class="linenr">11699: </span><span class=
"org-doc"> * pruning result changes due to template changes.</span>
<span class="linenr">11700: </span><span class="org-doc"> */</span>
<span class="linenr">11701: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">hmrShouldReload</span>(<span class=
"org-variable-name">prevImports</span>, <span class=
"org-variable-name">next</span>) {
<span class="linenr">11702: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr">11703: </span>    !next.scriptSetup ||
<span class=
"linenr">11704: </span>    (next.scriptSetup.lang !== <span class=
"org-string">'ts'</span> &amp;& next.scriptSetup.lang !== <span class="org-string">'tsx'</span>)
<span class="linenr">11705: </span>  ) {
<span class="linenr">11706: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">11707: </span>  }
<span class="linenr">11708: </span>
<span class="linenr">11709: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for each previous import, check if its used status remain the same based on</span>
<span class="linenr">11710: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the next descriptor's template</span>
<span class="linenr">11711: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> prevImports) {
<span class="linenr">11712: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if an import was previous unused, but now is used, we need to force</span>
<span class="linenr">11713: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">reload so that the script now includes that import.</span>
<span class="linenr">11714: </span>    <span class=
"org-keyword">if</span> (!prevImports[key].isUsedInTemplate &amp;& isImportUsed(key, next)) {
<span class="linenr">11715: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">11716: </span>    }
<span class="linenr">11717: </span>  }
<span class="linenr">11718: </span>
<span class="linenr">11719: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">11720: </span>}
<span class="linenr">11721: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">compileTemplate</span>(<span class=
"org-variable-name">options</span>) {
<span class="linenr">11722: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">...省略直接使用现有的 compile</span>
<span class="linenr">11723: </span>
<span class="linenr">11724: </span>  <span class=
"org-keyword">return</span> doCompileTemplate(options)
<span class="linenr">11725: </span>}
<span class="linenr">11726: </span>
<span class="linenr">11727: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">doCompileTemplate</span>({
<span class="linenr">11728: </span>  filename,
<span class="linenr">11729: </span>  id,
<span class="linenr">11730: </span>  scoped,
<span class="linenr">11731: </span>  slotted,
<span class="linenr">11732: </span>  inMap,
<span class="linenr">11733: </span>  source,
<span class="linenr">11734: </span>  ssr = <span class=
"org-constant">false</span>,
<span class="linenr">11735: </span>  ssrCssVars,
<span class="linenr">11736: </span>  isProd = <span class=
"org-constant">false</span>,
<span class="linenr">11737: </span>  compiler,
<span class="linenr">11738: </span>  compilerOptions = {},
<span class="linenr">11739: </span>  transformAssetUrls
<span class="linenr">11740: </span>}) {
<span class="linenr">11741: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">errors</span> = []
<span class="linenr">11742: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">warnings</span> = []
<span class="linenr">11743: </span>
<span class="linenr">11744: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">nodeTransforms</span> = []
<span class="linenr">11745: </span>  <span class=
"org-keyword">if</span> (isObject(transformAssetUrls)) {
<span class="linenr">11746: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">assetOptions</span> = normalizeOptions(transformAssetUrls)
<span class="linenr">11747: </span>    nodeTransforms = [
<span class=
"linenr">11748: </span>      createAssetUrlTransformWithOptions(assetOptions),
<span class=
"linenr">11749: </span>      createSrcsetTransformWithOptions(assetOptions)
<span class="linenr">11750: </span>    ]
<span class="linenr">11751: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (transformAssetUrls !== <span class=
"org-constant">false</span>) {
<span class=
"linenr">11752: </span>    nodeTransforms = [transformAssetUrl, transformSrcset]
<span class="linenr">11753: </span>  }
<span class="linenr">11754: </span>
<span class="linenr">11755: </span>  <span class=
"org-keyword">if</span> (!id) {
<span class="linenr">11756: </span>    id = <span class=
"org-string">''</span>
<span class="linenr">11757: </span>  }
<span class="linenr">11758: </span>
<span class="linenr">11759: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">shortId</span> = id.replace(<span class=
"org-string">/^data-v-/</span>, <span class="org-string">''</span>)
<span class="linenr">11760: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">longId</span> = <span class=
"org-string">`data-v-${shortId}`</span>
<span class="linenr">11761: </span>
<span class="linenr">11762: </span>  <span class=
"org-keyword">let</span> { code, ast, preamble, map } = baseCompile(source, {
<span class="linenr">11763: </span>    mode: <span class=
"org-string">'module'</span>,
<span class=
"linenr">11764: </span>    prefixIdentifiers: <span class=
"org-constant">true</span>,
<span class="linenr">11765: </span>    hoistStatic: <span class=
"org-constant">true</span>,
<span class="linenr">11766: </span>    cacheHandlers: <span class=
"org-constant">true</span>,
<span class="linenr">11767: </span>    ssrCssVars:
<span class=
"linenr">11768: </span>      ssr &amp;& ssrCssVars &amp;& ssrCssVars.length
<span class=
"linenr">11769: </span>        ? genCssVarsFromList(ssrCssVars, shortId, isProd)
<span class="linenr">11770: </span>        : <span class=
"org-string">''</span>,
<span class=
"linenr">11771: </span>    scopeId: scoped ? longId : <span class=
"org-constant">undefined</span>,
<span class="linenr">11772: </span>    slotted,
<span class="linenr">11773: </span>    sourceMap: <span class=
"org-constant">true</span>,
<span class="linenr">11774: </span>    ...compilerOptions,
<span class=
"linenr">11775: </span>    nodeTransforms: nodeTransforms.concat(compilerOptions.nodeTransforms || []),
<span class="linenr">11776: </span>    filename,
<span class=
"linenr">11777: </span>    onError: e =&gt; errors.push(e),
<span class=
"linenr">11778: </span>    onWarn: w =&gt; warnings.push(w)
<span class="linenr">11779: </span>  })
<span class="linenr">11780: </span>
<span class="linenr">11781: </span>  <span class=
"org-keyword">return</span> { code, ast, preamble, source, errors, tips, map }
<span class="linenr">11782: </span>}
<span class="linenr">11783: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">hash</span> = require(process.env.NODE_LIB + <span class="org-string">'/hash-sum'</span>)
<span class="linenr">11784: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CSS_VARS_HELPER</span> = <span class=
"org-string">`useCssVars`</span>
<span class="linenr">11785: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">match v-bind() with max 2-levels of nested parens.</span>
<span class="linenr">11786: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">cssVarRE</span> = <span class=
"org-string">/v-bind\s*\(((?:[^)(]+|\((?:[^)(]+|\([^)(]*\))*\))*)\)/</span>g
<span class="linenr">11787: </span>
<span class="linenr">11788: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genCssVarsFromList</span>(
<span class="linenr">11789: </span>  <span class=
"org-variable-name">vars</span>,
<span class="linenr">11790: </span>  <span class=
"org-variable-name">id</span>,
<span class="linenr">11791: </span>  isProd
<span class="linenr">11792: </span>) {
<span class="linenr">11793: </span>  <span class=
"org-keyword">return</span> <span class=
"org-string">`{\n  ${vars</span>
<span class="linenr">11794: </span><span class=
"org-string">    .map(key =&gt; `"${genVarName(id, key, isProd)}"</span>: (${key})<span class="org-string">`)</span>
<span class="linenr">11795: </span><span class=
"org-string">    .join(',\n  ')}\n}`</span>
<span class="linenr">11796: </span>}
<span class="linenr">11797: </span>
<span class="linenr">11798: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genVarName</span>(<span class=
"org-variable-name">id</span>, <span class=
"org-variable-name">raw</span>, <span class=
"org-variable-name">isProd</span>) {
<span class="linenr">11799: </span>  <span class=
"org-keyword">if</span> (isProd) {
<span class="linenr">11800: </span>    <span class=
"org-keyword">return</span> hash(id + raw)
<span class="linenr">11801: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">11802: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`${id}-${raw.replace(/([^\w-])/g, '_')}`</span>
<span class="linenr">11803: </span>  }
<span class="linenr">11804: </span>}
<span class="linenr">11805: </span>
<span class="linenr">11806: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">noramlizeExpression</span>(<span class=
"org-variable-name">exp</span>) {
<span class="linenr">11807: </span>  exp = exp.trim()
<span class="linenr">11808: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr">11809: </span>    (exp[<span class=
"org-highlight-numbers-number">0</span>] === <span class=
"org-string">`'`</span> &amp;& exp[exp.length - <span class=
"org-highlight-numbers-number">1</span>] === <span class=
"org-string">`'`</span>) ||
<span class="linenr">11810: </span>    (exp[<span class=
"org-highlight-numbers-number">0</span>] === <span class=
"org-string">`"`</span> &amp;& exp[exp.length - <span class=
"org-highlight-numbers-number">1</span>] === <span class=
"org-string">`"`</span>)
<span class="linenr">11811: </span>  ) {
<span class="linenr">11812: </span>    <span class=
"org-keyword">return</span> exp.slice(<span class=
"org-highlight-numbers-number">1</span>, -<span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr">11813: </span>  }
<span class="linenr">11814: </span>  <span class=
"org-keyword">return</span> exp
<span class="linenr">11815: </span>}
<span class="linenr">11816: </span>
<span class="linenr">11817: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseCssVars</span>(<span class=
"org-variable-name">sfc</span>) {
<span class="linenr">11818: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">vars</span> = []
<span class=
"linenr">11819: </span>  sfc.styles.forEach(style =&gt; {
<span class="linenr">11820: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">match</span>
<span class="linenr">11821: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">ignore v-bind() in comments /* ... */</span>
<span class="linenr">11822: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">content</span> = style.content.replace(<span class="org-string">/\/\*([\s\S]*?)\*\//</span>g, <span class="org-string">''</span>)
<span class="linenr">11823: </span>    <span class=
"org-keyword">while</span> ((match = cssVarRE.exec(content))) {
<span class="linenr">11824: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">variable</span> = noramlizeExpression(match[<span class="org-highlight-numbers-number">1</span>])
<span class="linenr">11825: </span>      <span class=
"org-keyword">if</span> (!vars.includes(variable)) {
<span class="linenr">11826: </span>        vars.push(variable)
<span class="linenr">11827: </span>      }
<span class="linenr">11828: </span>    }
<span class="linenr">11829: </span>  })
<span class="linenr">11830: </span>  <span class=
"org-keyword">return</span> vars
<span class="linenr">11831: </span>}
<span class="linenr">11832: </span>
<span class="linenr">11833: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for compileStyle</span>
<span class="linenr">11834: </span>
<span class="linenr">11835: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">cssVarsPlugin</span> = opts =&gt; {
<span class="linenr">11836: </span>  <span class=
"org-keyword">const</span> { id, isProd } = opts
<span class="linenr">11837: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr">11838: </span>    postcssPlugin: <span class=
"org-string">'vue-sfc-vars'</span>,
<span class="linenr">11839: </span>    Declaration(decl) {
<span class="linenr">11840: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">rewrite CSS variables</span>
<span class="linenr">11841: </span>      <span class=
"org-keyword">if</span> (cssVarRE.test(decl.value)) {
<span class=
"linenr">11842: </span>        decl.value = decl.value.replace(cssVarRE, (_, $1) =&gt; {
<span class="linenr">11843: </span>          <span class=
"org-keyword">return</span> <span class=
"org-string">`var(--${genVarName(id, noramlizeExpression($1), isProd)})`</span>
<span class="linenr">11844: </span>        })
<span class="linenr">11845: </span>      }
<span class="linenr">11846: </span>    }
<span class="linenr">11847: </span>  }
<span class="linenr">11848: </span>}
<span class=
"linenr">11849: </span>cssVarsPlugin.postcss = <span class=
"org-constant">true</span>
<span class="linenr">11850: </span>
<span class="linenr">11851: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genCssVarsCode</span>(
<span class="linenr">11852: </span>  <span class=
"org-variable-name">vars</span>,
<span class="linenr">11853: </span>  <span class=
"org-variable-name">bindings</span>,
<span class="linenr">11854: </span>  <span class=
"org-variable-name">id</span>,
<span class="linenr">11855: </span>  isProd
<span class="linenr">11856: </span>) {
<span class="linenr">11857: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">varsExp</span> = genCssVarsFromList(vars, id, isProd)
<span class="linenr">11858: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exp</span> = createSimpleExpression(varsExp, <span class="org-constant">false</span>)
<span class="linenr">11859: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">context</span> = createTransformContext(createRoot([]), {
<span class=
"linenr">11860: </span>    prefixIdentifiers: <span class=
"org-constant">true</span>,
<span class="linenr">11861: </span>    inline: <span class=
"org-constant">true</span>,
<span class=
"linenr">11862: </span>    bindingMetadata: bindings.__isScriptSetup === <span class="org-constant">false</span> ? <span class="org-constant">undefined</span> : bindings
<span class="linenr">11863: </span>  })
<span class="linenr">11864: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformed</span> = processExpression(exp, context)
<span class="linenr">11865: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformedString</span> =
<span class=
"linenr">11866: </span>    transformed.type === NodeTypes.SIMPLE_EXPRESSION
<span class="linenr">11867: </span>      ? transformed.content
<span class="linenr">11868: </span>      : transformed.children
<span class="linenr">11869: </span>          .map(c =&gt; {
<span class="linenr">11870: </span>            <span class=
"org-keyword">return</span> <span class=
"org-keyword">typeof</span> c === <span class=
"org-string">'string'</span>
<span class="linenr">11871: </span>              ? c
<span class="linenr">11872: </span>              : c.content
<span class="linenr">11873: </span>          })
<span class="linenr">11874: </span>          .join(<span class=
"org-string">''</span>)
<span class="linenr">11875: </span>
<span class="linenr">11876: </span>  <span class=
"org-keyword">return</span> <span class=
"org-string">`_${CSS_VARS_HELPER}(_ctx =&gt; (${transformedString}))`</span>
<span class="linenr">11877: </span>}
<span class="linenr">11878: </span>
<span class="linenr">11879: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;script setup&gt; already gets the calls injected as part of the transform</span>
<span class="linenr">11880: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">this is only for single normal &lt;script&gt;</span>
<span class="linenr">11881: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genNormalScriptCssVarsCode</span>(
<span class="linenr">11882: </span>  <span class=
"org-variable-name">cssVars</span>,
<span class="linenr">11883: </span>  <span class=
"org-variable-name">bindings</span>,
<span class="linenr">11884: </span>  <span class=
"org-variable-name">id</span>,
<span class="linenr">11885: </span>  isProd
<span class="linenr">11886: </span>) {
<span class="linenr">11887: </span>  <span class=
"org-keyword">return</span> (
<span class="linenr">11888: </span>    <span class=
"org-string">`\nimport { ${CSS_VARS_HELPER} as _${CSS_VARS_HELPER} } from 'vue'\n`</span> +
<span class="linenr">11889: </span>    <span class=
"org-string">`const __injectCSSVars__ = () =&gt; {\n${genCssVarsCode(</span>
<span class="linenr">11890: </span><span class=
"org-string">      cssVars,</span>
<span class="linenr">11891: </span><span class=
"org-string">      bindings,</span>
<span class="linenr">11892: </span><span class=
"org-string">      id,</span>
<span class="linenr">11893: </span><span class=
"org-string">      isProd</span>
<span class="linenr">11894: </span><span class=
"org-string">    )}}\n`</span> +
<span class="linenr">11895: </span>    <span class=
"org-string">`const __setup__ = __default__.setup\n`</span> +
<span class="linenr">11896: </span>    <span class=
"org-string">`__default__.setup = __setup__\n`</span> +
<span class="linenr">11897: </span>    <span class=
"org-string">`  ? (props, ctx) =&gt; { __injectCSSVars__();return __setup__(props, ctx) }\n`</span> +
<span class="linenr">11898: </span>    <span class=
"org-string">`  : __injectCSSVars__\n`</span>
<span class="linenr">11899: </span>  )
<span class="linenr">11900: </span>}
<span class="linenr">11901: </span>
<span class="linenr">11902: </span>
<span class="linenr">11903: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Special compiler macros</span>
<span class="linenr">11904: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">DEFINE_PROPS</span> = <span class=
"org-string">'defineProps'</span>
<span class="linenr">11905: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">DEFINE_EMITS</span> = <span class=
"org-string">'defineEmits'</span>
<span class="linenr">11906: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">DEFINE_EXPOSE</span> = <span class=
"org-string">'defineExpose'</span>
<span class="linenr">11907: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">WITH_DEFAULTS</span> = <span class=
"org-string">'withDefaults'</span>
<span class="linenr">11908: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">templateUsageCheckCache</span> = createCache()
<span class="linenr">11909: </span>
<span class="linenr">11910: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">constants</span>
<span class="linenr">11911: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">DEFAULT_VAR</span> = <span class=
"org-string">`__default__`</span>
<span class="linenr">11912: </span>
<span class="linenr">11913: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isBuiltInDir</span> = makeMap(
<span class="linenr">11914: </span>  <span class=
"org-string">`once,memo,if,else,else-if,slot,text,html,on,bind,model,show,cloak,is`</span>
<span class="linenr">11915: </span>)
<span class="linenr">11916: </span>
<span class="linenr">11917: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">compileScript</span>(<span class=
"org-variable-name">sfc</span>, <span class=
"org-variable-name">options</span>) {
<span class="linenr">11918: </span>  <span class=
"org-keyword">let</span> { script, scriptSetup, source, filename } = sfc
<span class="linenr">11919: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">feature flags</span>
<span class="linenr">11920: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO</span></span></span><span class=
"org-comment"> remove support for deprecated options when out of experimental</span>
<span class="linenr">11921: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">enableReactivityTransform</span> =
<span class=
"linenr">11922: </span>    !!options.reactivityTransform ||
<span class="linenr">11923: </span>    !!options.refSugar ||
<span class="linenr">11924: </span>    !!options.refTransform
<span class="linenr">11925: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">enablePropsTransform</span> =
<span class=
"linenr">11926: </span>    !!options.reactivityTransform || !!options.propsDestructureTransform
<span class="linenr">11927: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isProd</span> = !!options.isProd
<span class="linenr">11928: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">genSourceMap</span> = options.sourceMap !== <span class="org-constant">false</span>
<span class="linenr">11929: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">ref 声明的变量</span>
<span class="linenr">11930: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">refBindings</span>
<span class="linenr">11931: </span>
<span class="linenr">11932: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scopeId</span> = options.id ? options.id.replace(<span class="org-string">/^data-v-/</span>, <span class="org-string">''</span>) : <span class="org-string">''</span>
<span class="linenr">11933: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">cssVars</span> = sfc.cssVars
<span class="linenr">11934: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptLang</span> = script &amp;& script.lang
<span class="linenr">11935: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptSetupLang</span> = scriptSetup &amp;& scriptSetup.lang
<span class="linenr">11936: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isTS</span> =
<span class="linenr">11937: </span>    scriptLang === <span class=
"org-string">'ts'</span> ||
<span class="linenr">11938: </span>    scriptLang === <span class=
"org-string">'tsx'</span> ||
<span class=
"linenr">11939: </span>    scriptSetupLang === <span class=
"org-string">'ts'</span> ||
<span class=
"linenr">11940: </span>    scriptSetupLang === <span class=
"org-string">'tsx'</span>
<span class="linenr">11941: </span>
<span class="linenr">11942: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">resolve parser plugins</span>
<span class="linenr">11943: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">plugins</span> = []
<span class="linenr">11944: </span>  <span class=
"org-keyword">if</span> (!isTS || scriptLang === <span class=
"org-string">'tsx'</span> || scriptSetupLang === <span class=
"org-string">'tsx'</span>) {
<span class="linenr">11945: </span>    plugins.push(<span class=
"org-string">'jsx'</span>)
<span class="linenr">11946: </span>  }
<span class="linenr">11947: </span>  <span class=
"org-keyword">if</span> (options.babelParserPlugins) plugins.push(...options.babelParserPlugins)
<span class="linenr">11948: </span>  <span class=
"org-keyword">if</span> (isTS) plugins.push(<span class=
"org-string">'typescript'</span>, <span class=
"org-string">'decorators-legacy'</span>)
<span class="linenr">11949: </span>
<span class="linenr">11950: </span>  <span class=
"org-keyword">if</span> (!scriptSetup) {
<span class="linenr">11951: </span>    <span class=
"org-keyword">if</span> (!script) {
<span class="linenr">11952: </span>      <span class=
"org-keyword">throw</span> <span class=
"org-keyword">new</span> <span class=
"org-type">Error</span>(<span class=
"org-string">`[@vue/compiler-sfc] SFC contains no &lt;script&gt; tags.`</span>)
<span class="linenr">11953: </span>    }
<span class="linenr">11954: </span>    <span class=
"org-keyword">if</span> (scriptLang &amp;& !isTS &amp;& scriptLang !== <span class="org-string">'jsx'</span>) {
<span class="linenr">11955: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">do not process non js/ts script blocks</span>
<span class="linenr">11956: </span>      <span class=
"org-keyword">return</span> script
<span class="linenr">11957: </span>    }
<span class="linenr">11958: </span>    <span class=
"org-keyword">try</span> {
<span class="linenr">11959: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">content</span> = script.content
<span class="linenr">11960: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">map</span> = script.map
<span class="linenr">11961: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptAst</span> = babelParser.parse(content, {
<span class="linenr">11962: </span>        plugins,
<span class="linenr">11963: </span>        sourceType: <span class=
"org-string">'module'</span>
<span class="linenr">11964: </span>      }).program
<span class="linenr">11965: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bindings</span> = analyzeScriptBindings(scriptAst.body)
<span class="linenr">11966: </span>      <span class=
"org-keyword">if</span> (enableReactivityTransform &amp;& RT.shouldTransform(content)) {
<span class="linenr">11967: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">s</span> = <span class=
"org-keyword">new</span> <span class=
"org-type">MagicString</span>(source)
<span class="linenr">11968: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">startOffset</span> = script.loc.start.offset
<span class="linenr">11969: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">endOffset</span> = script.loc.end.offset
<span class="linenr">11970: </span>        <span class=
"org-keyword">const</span> { importedHelpers } = RT.transformAST(scriptAst, s, startOffset)
<span class="linenr">11971: </span>        <span class=
"org-keyword">if</span> (importedHelpers.length) {
<span class="linenr">11972: </span>          s.prepend(
<span class="linenr">11973: </span>            <span class=
"org-string">`import { ${importedHelpers</span>
<span class="linenr">11974: </span><span class=
"org-string">              .map(h =&gt; `</span>${h} as _${h}<span class="org-string">`)</span>
<span class="linenr">11975: </span><span class=
"org-string">              .join(', ')} } from 'vue'\n`</span>
<span class="linenr">11976: </span>          )
<span class="linenr">11977: </span>        }
<span class="linenr">11978: </span>        s.remove(<span class=
"org-highlight-numbers-number">0</span>, startOffset)
<span class=
"linenr">11979: </span>        s.remove(endOffset, source.length)
<span class="linenr">11980: </span>        content = s.toString()
<span class="linenr">11981: </span>        <span class=
"org-keyword">if</span> (genSourceMap) {
<span class="linenr">11982: </span>          map = s.generateMap({
<span class="linenr">11983: </span>            source: filename,
<span class="linenr">11984: </span>            hires: <span class=
"org-constant">true</span>,
<span class=
"linenr">11985: </span>            includeContent: <span class=
"org-constant">true</span>
<span class="linenr">11986: </span>          })
<span class="linenr">11987: </span>        }
<span class="linenr">11988: </span>      }
<span class="linenr">11989: </span>      <span class=
"org-keyword">if</span> (cssVars.length) {
<span class=
"linenr">11990: </span>        content = rewriteDefault(content, DEFAULT_VAR, plugins)
<span class=
"linenr">11991: </span>        content += genNormalScriptCssVarsCode(
<span class="linenr">11992: </span>          cssVars,
<span class="linenr">11993: </span>          bindings,
<span class="linenr">11994: </span>          scopeId,
<span class="linenr">11995: </span>          isProd
<span class="linenr">11996: </span>        )
<span class="linenr">11997: </span>        content += <span class=
"org-string">`\nexport default ${DEFAULT_VAR}`</span>
<span class="linenr">11998: </span>      }
<span class="linenr">11999: </span>      <span class=
"org-keyword">return</span> {
<span class="linenr">12000: </span>        ...script,
<span class="linenr">12001: </span>        content,
<span class="linenr">12002: </span>        map,
<span class="linenr">12003: </span>        bindings,
<span class=
"linenr">12004: </span>        scriptAst: scriptAst.body
<span class="linenr">12005: </span>      }
<span class="linenr">12006: </span>    } <span class=
"org-keyword">catch</span> (e) {
<span class="linenr">12007: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">silently fallback if parse fails since user may be using custom</span>
<span class="linenr">12008: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">babel syntax</span>
<span class="linenr">12009: </span>      <span class=
"org-keyword">return</span> script
<span class="linenr">12010: </span>    }
<span class="linenr">12011: </span>  }
<span class="linenr">12012: </span>
<span class="linenr">12013: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">script 和 script setup 的语言必须一致</span>
<span class="linenr">12014: </span>  <span class=
"org-keyword">if</span> (script &amp;& scriptLang !== scriptSetupLang) {
<span class="linenr">12015: </span>    <span class=
"org-keyword">throw</span> <span class=
"org-keyword">new</span> <span class="org-type">Error</span>(
<span class="linenr">12016: </span>      <span class=
"org-string">`[@vue/compiler-sfc] &lt;script&gt; and &lt;script setup&gt; must have the same `</span> +
<span class="linenr">12017: </span>        <span class=
"org-string">`language type.`</span>
<span class="linenr">12018: </span>    )
<span class="linenr">12019: </span>  }
<span class="linenr">12020: </span>
<span class="linenr">12021: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">只处理 js/ts script</span>
<span class="linenr">12022: </span>  <span class=
"org-keyword">if</span> (scriptSetupLang &amp;& !isTS &amp;& scriptSetupLang !== <span class="org-string">'jsx'</span>) {
<span class="linenr">12023: </span>    <span class=
"org-keyword">return</span> scriptSetup
<span class="linenr">12024: </span>  }
<span class="linenr">12025: </span>
<span class="linenr">12026: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">变量，imports 都需要导出</span>
<span class="linenr">12027: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bindingMetadata</span> = {}
<span class="linenr">12028: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">helperImports</span> = <span class=
"org-keyword">new</span> <span class="org-type">Set</span>()
<span class="linenr">12029: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">userImports</span> = Object.create(<span class=
"org-constant">null</span>)
<span class="linenr">12030: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">userImportAlias</span> = Object.create(<span class="org-constant">null</span>)
<span class="linenr">12031: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptBindings</span> = Object.create(<span class="org-constant">null</span>)
<span class="linenr">12032: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">setupBindings</span> = Object.create(<span class="org-constant">null</span>)
<span class="linenr">12033: </span>
<span class="linenr">12034: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">defaultExport</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export default</span>
<span class="linenr">12035: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasDefinePropsCall</span> = <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">defineProps()</span>
<span class="linenr">12036: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasDefineEmitCall</span> = <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">defineEmits()</span>
<span class="linenr">12037: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasDefineExposeCall</span> = <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">defineExpose()</span>
<span class="linenr">12038: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsRuntimeDecl</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">属性声明</span>
<span class="linenr">12039: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsRuntimeDefaults</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">属性默认值</span>
<span class="linenr">12040: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsDestructureDecl</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">属性解构声明</span>
<span class="linenr">12041: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsDestructureRestId</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">属性解构的 ... 符号</span>
<span class="linenr">12042: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsTypeDecl</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">属性类型声明</span>
<span class="linenr">12043: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsTypeDeclRaw</span>
<span class="linenr">12044: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsIdentifier</span>
<span class="linenr">12045: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">emitsRuntimeDecl</span>
<span class="linenr">12046: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">emitsTypeDecl</span>
<span class="linenr">12047: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">emitsTypeDeclRaw</span>
<span class="linenr">12048: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">emitIdentifier</span>
<span class="linenr">12049: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasAwait</span> = <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">有没 await 符号，如果有则会转成 async setup</span>
<span class="linenr">12050: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasInlinedSsrRenderFn</span> = <span class=
"org-constant">false</span>
<span class="linenr">12051: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props/emits declared via types</span>
<span class="linenr">12052: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">typeDeclaredProps</span> = {}
<span class="linenr">12053: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">typeDeclaredEmits</span> = <span class=
"org-keyword">new</span> <span class="org-type">Set</span>()
<span class="linenr">12054: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">record declared types for runtime props type generation</span>
<span class="linenr">12055: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">declaredTypes</span> = {}
<span class="linenr">12056: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props destructure data</span>
<span class="linenr">12057: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">propsDestructuredBindings</span> = Object.create(<span class="org-constant">null</span>)
<span class="linenr">12058: </span>
<span class="linenr">12059: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">magic-string state</span>
<span class="linenr">12060: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">s</span> = <span class=
"org-keyword">new</span> <span class=
"org-type">MagicString</span>(source)
<span class="linenr">12061: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">startOffset</span> = scriptSetup.loc.start.offset
<span class="linenr">12062: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">endOffset</span> = scriptSetup.loc.end.offset
<span class="linenr">12063: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptStartOffset</span> = script &amp;& script.loc.start.offset
<span class="linenr">12064: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptEndOffset</span> = script &amp;& script.loc.end.offset
<span class="linenr">12065: </span>
<span class="linenr">12066: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">helper</span>(<span class=
"org-variable-name">key</span>) {
<span class="linenr">12067: </span>    helperImports.add(key)
<span class="linenr">12068: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`_${key}`</span>
<span class="linenr">12069: </span>  }
<span class="linenr">12070: </span>    <span class=
"org-keyword">function</span> <span class=
"org-function-name">parse</span>(<span class=
"org-variable-name">input</span>, <span class=
"org-variable-name">options</span>, <span class=
"org-variable-name">offset</span>) {
<span class="linenr">12071: </span>      <span class=
"org-keyword">try</span> {
<span class="linenr">12072: </span>        <span class=
"org-keyword">return</span> babelParser.parse(input, options).program
<span class="linenr">12073: </span>      } <span class=
"org-keyword">catch</span> (e) {
<span class="linenr">12074: </span>        e.message = <span class=
"org-string">`[@vue/compiler-sfc] ${e.message}\n\n${</span>
<span class="linenr">12075: </span><span class=
"org-string">          sfc.filename</span>
<span class="linenr">12076: </span><span class=
"org-string">        }\n${generateCodeFrame(source, e.pos + offset, e.pos + offset + 1)}`</span>
<span class="linenr">12077: </span>        <span class=
"org-keyword">throw</span> e
<span class="linenr">12078: </span>      }
<span class="linenr">12079: </span>    }
<span class="linenr">12080: </span>  
<span class="linenr">12081: </span>  
<span class="linenr">12082: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">error</span>(<span class=
"org-variable-name">msg</span>, <span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">end</span> = <span class=
"org-variable-name">node</span>.<span class=
"org-variable-name">end</span> + <span class=
"org-variable-name">startOffset</span>) {
<span class="linenr">12083: </span>    <span class=
"org-keyword">throw</span> <span class=
"org-keyword">new</span> <span class="org-type">Error</span>(
<span class="linenr">12084: </span>      <span class=
"org-string">`[@vue/compiler-sfc] ${msg}\n\n${sfc.filename}\n${generateCodeFrame(</span>
<span class="linenr">12085: </span><span class=
"org-string">      source,</span>
<span class="linenr">12086: </span><span class=
"org-string">      node.start + startOffset,</span>
<span class="linenr">12087: </span><span class=
"org-string">      end</span>
<span class="linenr">12088: </span><span class=
"org-string">      )}`</span>
<span class="linenr">12089: </span>    )
<span class="linenr">12090: </span>  }
<span class="linenr">12091: </span>    <span class=
"org-keyword">function</span> <span class=
"org-function-name">registerUserImport</span>(<span class=
"org-variable-name">source</span>, <span class=
"org-variable-name">local</span>, <span class=
"org-variable-name">imported</span>, <span class=
"org-variable-name">isType</span>, <span class=
"org-variable-name">isFromSetup</span>) {
<span class="linenr">12092: </span>      <span class=
"org-keyword">if</span> (source === <span class=
"org-string">'vue'</span> &amp;& imported) {
<span class=
"linenr">12093: </span>        userImportAlias[imported] = local
<span class="linenr">12094: </span>      }
<span class="linenr">12095: </span>  
<span class="linenr">12096: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">isUsedInTemplate</span> = <span class=
"org-constant">true</span>
<span class="linenr">12097: </span>      <span class=
"org-keyword">if</span> (isTS &amp;& sfc.template &amp;& !sfc.template.src &amp;& !sfc.template.lang) {
<span class=
"linenr">12098: </span>        isUsedInTemplate = isImportUsed(local, sfc)
<span class="linenr">12099: </span>      }
<span class="linenr">12100: </span>  
<span class="linenr">12101: </span>      userImports[local] = {
<span class="linenr">12102: </span>        isType,
<span class=
"linenr">12103: </span>        imported: imported || <span class=
"org-string">'default'</span>,
<span class="linenr">12104: </span>        source,
<span class="linenr">12105: </span>        isFromSetup,
<span class="linenr">12106: </span>        isUsedInTemplate
<span class="linenr">12107: </span>      }
<span class="linenr">12108: </span>    }
<span class="linenr">12109: </span>  
<span class="linenr">12110: </span>    <span class=
"org-keyword">function</span> <span class=
"org-function-name">processDefineProps</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">declId</span>) {
<span class="linenr">12111: </span>      <span class=
"org-keyword">if</span> (!isCallOf(node, DEFINE_PROPS)) {
<span class="linenr">12112: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">12113: </span>      }
<span class="linenr">12114: </span>  
<span class="linenr">12115: </span>      <span class=
"org-keyword">if</span> (hasDefinePropsCall) {
<span class="linenr">12116: </span>        error(<span class=
"org-string">`duplicate ${DEFINE_PROPS}() call`</span>, node)
<span class="linenr">12117: </span>      }
<span class=
"linenr">12118: </span>      hasDefinePropsCall = <span class=
"org-constant">true</span>
<span class="linenr">12119: </span>  
<span class=
"linenr">12120: </span>      propsRuntimeDecl = node.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr">12121: </span>  
<span class="linenr">12122: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">call has type parameters - infer runtime types from it</span>
<span class="linenr">12123: </span>      <span class=
"org-keyword">if</span> (node.typeParameters) {
<span class="linenr">12124: </span>        <span class=
"org-keyword">if</span> (propsRuntimeDecl) {
<span class="linenr">12125: </span>          error(
<span class="linenr">12126: </span>            <span class=
"org-string">`${DEFINE_PROPS}() cannot accept both type and non-type arguments `</span> +
<span class="linenr">12127: </span>              <span class=
"org-string">`at the same time. Use one or the other.`</span>,
<span class="linenr">12128: </span>            node
<span class="linenr">12129: </span>          )
<span class="linenr">12130: </span>        }
<span class="linenr">12131: </span>  
<span class=
"linenr">12132: </span>        propsTypeDeclRaw = node.typeParameters.params[<span class="org-highlight-numbers-number">0</span>]
<span class=
"linenr">12133: </span>        propsTypeDecl = resolveQualifiedType(
<span class="linenr">12134: </span>          propsTypeDeclRaw,
<span class=
"linenr">12135: </span>          node =&gt; node.type === <span class="org-string">'TSTypeLiteral'</span>
<span class="linenr">12136: </span>        )
<span class="linenr">12137: </span>  
<span class="linenr">12138: </span>        <span class=
"org-keyword">if</span> (!propsTypeDecl) {
<span class="linenr">12139: </span>          error(
<span class="linenr">12140: </span>            <span class=
"org-string">`type argument passed to ${DEFINE_PROPS}() must be a literal type, `</span> +
<span class="linenr">12141: </span>              <span class=
"org-string">`or a reference to an interface or literal type.`</span>,
<span class="linenr">12142: </span>            propsTypeDeclRaw
<span class="linenr">12143: </span>          )
<span class="linenr">12144: </span>        }
<span class="linenr">12145: </span>      }
<span class="linenr">12146: </span>  
<span class="linenr">12147: </span>      <span class=
"org-keyword">if</span> (declId) {
<span class="linenr">12148: </span>        <span class=
"org-keyword">if</span> (enablePropsTransform &amp;& declId.type === <span class="org-string">'ObjectPattern'</span>) {
<span class=
"linenr">12149: </span>          propsDestructureDecl = declId
<span class="linenr">12150: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props destructure - handle compilation sugar</span>
<span class="linenr">12151: </span>          <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">prop</span> <span class=
"org-keyword">of</span> declId.properties) {
<span class="linenr">12152: </span>            <span class=
"org-keyword">if</span> (prop.type === <span class=
"org-string">'ObjectProperty'</span>) {
<span class="linenr">12153: </span>              <span class=
"org-keyword">if</span> (prop.computed) {
<span class="linenr">12154: </span>                error(
<span class="linenr">12155: </span>                  <span class=
"org-string">`${DEFINE_PROPS}() destructure cannot use computed key.`</span>,
<span class="linenr">12156: </span>                  prop.key
<span class="linenr">12157: </span>                )
<span class="linenr">12158: </span>              }
<span class="linenr">12159: </span>              <span class=
"org-keyword">const</span> <span class=
"org-variable-name">propKey</span> = prop.key.name
<span class="linenr">12160: </span>              <span class=
"org-keyword">if</span> (prop.value.type === <span class=
"org-string">'AssignmentPattern'</span>) {
<span class="linenr">12161: </span>                <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">default value { foo = 123 }</span>
<span class="linenr">12162: </span>                <span class=
"org-keyword">const</span> { left, right } = prop.value
<span class="linenr">12163: </span>                <span class=
"org-keyword">if</span> (left.type !== <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">12164: </span>                  error(
<span class="linenr">12165: </span>                    <span class=
"org-string">`${DEFINE_PROPS}() destructure does not support nested patterns.`</span>,
<span class="linenr">12166: </span>                    left
<span class="linenr">12167: </span>                  )
<span class="linenr">12168: </span>                }
<span class="linenr">12169: </span>                <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">store default value</span>
<span class=
"linenr">12170: </span>                propsDestructuredBindings[propKey] = {
<span class=
"linenr">12171: </span>                  local: left.name,
<span class="linenr">12172: </span>                  <span class=
"org-keyword">default</span>: right
<span class="linenr">12173: </span>                }
<span class="linenr">12174: </span>              } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (prop.value.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">12175: </span>                <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">simple destructure</span>
<span class=
"linenr">12176: </span>                propsDestructuredBindings[propKey] = {
<span class=
"linenr">12177: </span>                  local: prop.value.name
<span class="linenr">12178: </span>                }
<span class="linenr">12179: </span>              } <span class=
"org-keyword">else</span> {
<span class="linenr">12180: </span>                error(
<span class="linenr">12181: </span>                  <span class=
"org-string">`${DEFINE_PROPS}() destructure does not support nested patterns.`</span>,
<span class="linenr">12182: </span>                  prop.value
<span class="linenr">12183: </span>                )
<span class="linenr">12184: </span>              }
<span class="linenr">12185: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr">12186: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">rest spread</span>
<span class=
"linenr">12187: </span>              propsDestructureRestId = prop.argument.name
<span class="linenr">12188: </span>            }
<span class="linenr">12189: </span>          }
<span class="linenr">12190: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr">12191: </span>          propsIdentifier = scriptSetup.content.slice(declId.start, declId.end)
<span class="linenr">12192: </span>        }
<span class="linenr">12193: </span>      }
<span class="linenr">12194: </span>  
<span class="linenr">12195: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">12196: </span>    }
<span class="linenr">12197: </span>  
<span class="linenr">12198: </span>  
<span class="linenr">12199: </span>    <span class=
"org-keyword">function</span> <span class=
"org-function-name">processWithDefaults</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">declId</span>) {
<span class="linenr">12200: </span>      <span class=
"org-keyword">if</span> (!isCallOf(node, WITH_DEFAULTS)) {
<span class="linenr">12201: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">12202: </span>      }
<span class="linenr">12203: </span>      <span class=
"org-keyword">if</span> (processDefineProps(node.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>], declId)) {
<span class="linenr">12204: </span>        <span class=
"org-keyword">if</span> (propsRuntimeDecl) {
<span class="linenr">12205: </span>          error(
<span class="linenr">12206: </span>            <span class=
"org-string">`${WITH_DEFAULTS} can only be used with type-based `</span> +
<span class="linenr">12207: </span>              <span class=
"org-string">`${DEFINE_PROPS} declaration.`</span>,
<span class="linenr">12208: </span>            node
<span class="linenr">12209: </span>          )
<span class="linenr">12210: </span>        }
<span class="linenr">12211: </span>        <span class=
"org-keyword">if</span> (propsDestructureDecl) {
<span class="linenr">12212: </span>          error(
<span class="linenr">12213: </span>            <span class=
"org-string">`${WITH_DEFAULTS}() is unnecessary when using destructure with ${DEFINE_PROPS}().\n`</span> +
<span class="linenr">12214: </span>              <span class=
"org-string">`Prefer using destructure default values, e.g. const { foo = 1 } = defineProps(...).`</span>,
<span class="linenr">12215: </span>            node.callee
<span class="linenr">12216: </span>          )
<span class="linenr">12217: </span>        }
<span class=
"linenr">12218: </span>        propsRuntimeDefaults = node.<span class="org-constant">arguments</span>[<span class="org-highlight-numbers-number">1</span>]
<span class="linenr">12219: </span>        <span class=
"org-keyword">if</span> (
<span class=
"linenr">12220: </span>          !propsRuntimeDefaults ||
<span class=
"linenr">12221: </span>          propsRuntimeDefaults.type !== <span class="org-string">'ObjectExpression'</span>
<span class="linenr">12222: </span>        ) {
<span class="linenr">12223: </span>          error(
<span class="linenr">12224: </span>            <span class=
"org-string">`The 2nd argument of ${WITH_DEFAULTS} must be an object literal.`</span>,
<span class=
"linenr">12225: </span>            propsRuntimeDefaults || node
<span class="linenr">12226: </span>          )
<span class="linenr">12227: </span>        }
<span class="linenr">12228: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">12229: </span>        error(
<span class="linenr">12230: </span>          <span class=
"org-string">`${WITH_DEFAULTS}' first argument must be a ${DEFINE_PROPS} call.`</span>,
<span class="linenr">12231: </span>          node.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>] || node
<span class="linenr">12232: </span>        )
<span class="linenr">12233: </span>      }
<span class="linenr">12234: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">12235: </span>    }
<span class="linenr">12236: </span>  
<span class="linenr">12237: </span>  
<span class="linenr">12238: </span>  
<span class="linenr">12239: </span>    <span class=
"org-keyword">function</span> <span class=
"org-function-name">processDefineEmits</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">declId</span>) {
<span class="linenr">12240: </span>      <span class=
"org-keyword">if</span> (!isCallOf(node, DEFINE_EMITS)) {
<span class="linenr">12241: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">12242: </span>      }
<span class="linenr">12243: </span>      <span class=
"org-keyword">if</span> (hasDefineEmitCall) {
<span class="linenr">12244: </span>        error(<span class=
"org-string">`duplicate ${DEFINE_EMITS}() call`</span>, node)
<span class="linenr">12245: </span>      }
<span class=
"linenr">12246: </span>      hasDefineEmitCall = <span class=
"org-constant">true</span>
<span class=
"linenr">12247: </span>      emitsRuntimeDecl = node.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr">12248: </span>      <span class=
"org-keyword">if</span> (node.typeParameters) {
<span class="linenr">12249: </span>        <span class=
"org-keyword">if</span> (emitsRuntimeDecl) {
<span class="linenr">12250: </span>          error(
<span class="linenr">12251: </span>            <span class=
"org-string">`${DEFINE_EMITS}() cannot accept both type and non-type arguments `</span> +
<span class="linenr">12252: </span>              <span class=
"org-string">`at the same time. Use one or the other.`</span>,
<span class="linenr">12253: </span>            node
<span class="linenr">12254: </span>          )
<span class="linenr">12255: </span>        }
<span class="linenr">12256: </span>  
<span class=
"linenr">12257: </span>        emitsTypeDeclRaw = node.typeParameters.params[<span class="org-highlight-numbers-number">0</span>]
<span class=
"linenr">12258: </span>        emitsTypeDecl = resolveQualifiedType(
<span class="linenr">12259: </span>          emitsTypeDeclRaw,
<span class=
"linenr">12260: </span>          node =&gt; node.type === <span class="org-string">'TSFunctionType'</span> || node.type === <span class="org-string">'TSTypeLiteral'</span>
<span class="linenr">12261: </span>        )
<span class="linenr">12262: </span>  
<span class="linenr">12263: </span>        <span class=
"org-keyword">if</span> (!emitsTypeDecl) {
<span class="linenr">12264: </span>          error(
<span class="linenr">12265: </span>            <span class=
"org-string">`type argument passed to ${DEFINE_EMITS}() must be a function type, `</span> +
<span class="linenr">12266: </span>              <span class=
"org-string">`a literal type with call signatures, or a reference to the above types.`</span>,
<span class="linenr">12267: </span>            emitsTypeDeclRaw
<span class="linenr">12268: </span>          )
<span class="linenr">12269: </span>        }
<span class="linenr">12270: </span>      }
<span class="linenr">12271: </span>  
<span class="linenr">12272: </span>      <span class=
"org-keyword">if</span> (declId) {
<span class=
"linenr">12273: </span>        emitIdentifier = scriptSetup.content.slice(declId.start, declId.end)
<span class="linenr">12274: </span>      }
<span class="linenr">12275: </span>  
<span class="linenr">12276: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">12277: </span>    }
<span class="linenr">12278: </span>  
<span class="linenr">12279: </span>  
<span class="linenr">12280: </span>  
<span class="linenr">12281: </span>    <span class=
"org-keyword">function</span> <span class=
"org-function-name">resolveQualifiedType</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">qualifier</span>) {
<span class="linenr">12282: </span>      <span class=
"org-keyword">if</span> (qualifier(node)) {
<span class="linenr">12283: </span>        <span class=
"org-keyword">return</span> node
<span class="linenr">12284: </span>      }
<span class="linenr">12285: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr">12286: </span>        node.type === <span class=
"org-string">'TSTypeReference'</span> &amp;&
<span class=
"linenr">12287: </span>        node.typeName.type === <span class=
"org-string">'Identifier'</span>
<span class="linenr">12288: </span>      ) {
<span class="linenr">12289: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">refName</span> = node.typeName.name
<span class="linenr">12290: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isQualifiedType</span> = (node) =&gt; {
<span class="linenr">12291: </span>          <span class=
"org-keyword">if</span> (
<span class=
"linenr">12292: </span>            node.type === <span class=
"org-string">'TSInterfaceDeclaration'</span> &amp;&
<span class=
"linenr">12293: </span>            node.id.name === refName
<span class="linenr">12294: </span>          ) {
<span class="linenr">12295: </span>            <span class=
"org-keyword">return</span> node.body
<span class="linenr">12296: </span>          } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr">12297: </span>            node.type === <span class=
"org-string">'TSTypeAliasDeclaration'</span> &amp;&
<span class=
"linenr">12298: </span>            node.id.name === refName &amp;&
<span class=
"linenr">12299: </span>            qualifier(node.typeAnnotation)
<span class="linenr">12300: </span>          ) {
<span class="linenr">12301: </span>            <span class=
"org-keyword">return</span> node.typeAnnotation
<span class="linenr">12302: </span>          } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ExportNamedDeclaration'</span> &amp;& node.declaration) {
<span class="linenr">12303: </span>            <span class=
"org-keyword">return</span> isQualifiedType(node.declaration)
<span class="linenr">12304: </span>          }
<span class="linenr">12305: </span>        }
<span class="linenr">12306: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">body</span> = scriptAst
<span class=
"linenr">12307: </span>          ? [...scriptSetupAst.body, ...scriptAst.body]
<span class="linenr">12308: </span>          : scriptSetupAst.body
<span class="linenr">12309: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> <span class=
"org-keyword">of</span> body) {
<span class="linenr">12310: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">qualified</span> = isQualifiedType(node)
<span class="linenr">12311: </span>          <span class=
"org-keyword">if</span> (qualified) {
<span class="linenr">12312: </span>            <span class=
"org-keyword">return</span> qualified
<span class="linenr">12313: </span>          }
<span class="linenr">12314: </span>        }
<span class="linenr">12315: </span>      }
<span class="linenr">12316: </span>    }
<span class="linenr">12317: </span>  
<span class="linenr">12318: </span>  
<span class="linenr">12319: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">processDefineExpose</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">12320: </span>      <span class=
"org-keyword">if</span> (isCallOf(node, DEFINE_EXPOSE)) {
<span class="linenr">12321: </span>        <span class=
"org-keyword">if</span> (hasDefineExposeCall) {
<span class="linenr">12322: </span>          error(<span class=
"org-string">`duplicate ${DEFINE_EXPOSE}() call`</span>, node)
<span class="linenr">12323: </span>        }
<span class=
"linenr">12324: </span>        hasDefineExposeCall = <span class=
"org-constant">true</span>
<span class="linenr">12325: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">12326: </span>      }
<span class="linenr">12327: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">12328: </span>    }
<span class="linenr">12329: </span>  
<span class="linenr">12330: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">12331: </span><span class=
"org-doc">     * await foo()</span>
<span class="linenr">12332: </span><span class=
"org-doc">     * --&gt;</span>
<span class="linenr">12333: </span><span class=
"org-doc">     * ;(</span>
<span class="linenr">12334: </span><span class=
"org-doc">     *   ([__temp,__restore] = withAsyncContext(() =&gt; foo())),</span>
<span class="linenr">12335: </span><span class=
"org-doc">     *   await __temp,</span>
<span class="linenr">12336: </span><span class=
"org-doc">     *   __restore()</span>
<span class="linenr">12337: </span><span class=
"org-doc">     * )</span>
<span class="linenr">12338: </span><span class=
"org-doc">     *</span>
<span class="linenr">12339: </span><span class=
"org-doc">     * const a = await foo()</span>
<span class="linenr">12340: </span><span class=
"org-doc">     * --&gt;</span>
<span class="linenr">12341: </span><span class=
"org-doc">     * const a = (</span>
<span class="linenr">12342: </span><span class=
"org-doc">     *   ([__temp, __restore] = withAsyncContext(() =&gt; foo())),</span>
<span class="linenr">12343: </span><span class=
"org-doc">     *   __temp = await __temp,</span>
<span class="linenr">12344: </span><span class=
"org-doc">     *   __restore(),</span>
<span class="linenr">12345: </span><span class=
"org-doc">     *   __temp</span>
<span class="linenr">12346: </span><span class=
"org-doc">     * )</span>
<span class="linenr">12347: </span><span class=
"org-doc">     */</span>
<span class="linenr">12348: </span>    <span class=
"org-keyword">function</span> <span class=
"org-function-name">processAwait</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">needSemi</span>, <span class=
"org-variable-name">isStatement</span>) {
<span class="linenr">12349: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">argumentStart</span> =
<span class=
"linenr">12350: </span>        node.argument.extra &amp;& node.argument.extra.parenthesized
<span class=
"linenr">12351: </span>          ? node.argument.extra.parenStart
<span class="linenr">12352: </span>          : node.argument.start
<span class="linenr">12353: </span>  
<span class="linenr">12354: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">argumentStr</span> = source.slice(
<span class=
"linenr">12355: </span>        argumentStart + startOffset,
<span class=
"linenr">12356: </span>        node.argument.end + startOffset
<span class="linenr">12357: </span>      )
<span class="linenr">12358: </span>  
<span class="linenr">12359: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">containsNestedAwait</span> = <span class=
"org-string">/\bawait\b/</span>.test(argumentStr)
<span class="linenr">12360: </span>  
<span class="linenr">12361: </span>      s.overwrite(
<span class=
"linenr">12362: </span>        node.start + startOffset,
<span class=
"linenr">12363: </span>        argumentStart + startOffset,
<span class="linenr">12364: </span>        <span class=
"org-string">`${needSemi ? `</span>;<span class=
"org-string">` : ``}(\n  ([__temp,__restore] = ${helper(</span>
<span class="linenr">12365: </span><span class=
"org-string">          `</span>withAsyncContext<span class=
"org-string">`</span>
<span class="linenr">12366: </span><span class=
"org-string">        )}(${containsNestedAwait ? `</span><span class="org-keyword">async</span> <span class="org-string">` : ``}() =&gt; `</span>
<span class="linenr">12367: </span>      )
<span class="linenr">12368: </span>      s.appendLeft(
<span class="linenr">12369: </span>        node.end + startOffset,
<span class="linenr">12370: </span>        <span class=
"org-string">`)),\n  ${isStatement ? `` : `</span>__temp = <span class="org-string">`}await __temp,\n  __restore()${</span>
<span class="linenr">12371: </span><span class=
"org-string">          isStatement ? `` : `</span>,\n  __temp<span class="org-string">`</span>
<span class="linenr">12372: </span><span class=
"org-string">        }\n)`</span>
<span class="linenr">12373: </span>      )
<span class="linenr">12374: </span>    }
<span class="linenr">12375: </span>  
<span class="linenr">12376: </span>  
<span class="linenr">12377: </span>  <span class=
"org-doc">/**</span>
<span class="linenr">12378: </span><span class=
"org-doc">     * check defaults. If the default object is an object literal with only</span>
<span class="linenr">12379: </span><span class=
"org-doc">     * static properties, we can directly generate more optimized default</span>
<span class="linenr">12380: </span><span class=
"org-doc">     * declarations. Otherwise we will have to fallback to runtime merging.</span>
<span class="linenr">12381: </span><span class=
"org-doc">     */</span>
<span class="linenr">12382: </span>    <span class=
"org-keyword">function</span> <span class=
"org-function-name">hasStaticWithDefaults</span>() {
<span class="linenr">12383: </span>      <span class=
"org-keyword">return</span> (
<span class=
"linenr">12384: </span>        propsRuntimeDefaults &amp;&
<span class=
"linenr">12385: </span>        propsRuntimeDefaults.type === <span class="org-string">'ObjectExpression'</span> &amp;&
<span class=
"linenr">12386: </span>        propsRuntimeDefaults.properties.every(
<span class="linenr">12387: </span>          node =&gt;
<span class=
"linenr">12388: </span>            (node.type === <span class=
"org-string">'ObjectProperty'</span> &amp;& !node.computed) ||
<span class=
"linenr">12389: </span>            node.type === <span class=
"org-string">'ObjectMethod'</span>
<span class="linenr">12390: </span>        )
<span class="linenr">12391: </span>      )
<span class="linenr">12392: </span>    }
<span class="linenr">12393: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">genRuntimeProps</span>(<span class=
"org-variable-name">props</span>) {
<span class="linenr">12394: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keys</span> = Object.keys(props)
<span class="linenr">12395: </span>      <span class=
"org-keyword">if</span> (!keys.length) {
<span class="linenr">12396: </span>        <span class=
"org-keyword">return</span> <span class="org-string">``</span>
<span class="linenr">12397: </span>      }
<span class="linenr">12398: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hasStaticDefaults</span> = hasStaticWithDefaults()
<span class="linenr">12399: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptSetupSource</span> = scriptSetup.content
<span class="linenr">12400: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsDecls</span> = <span class=
"org-string">`{</span>
<span class="linenr">12401: </span><span class=
"org-string">      ${keys</span>
<span class="linenr">12402: </span><span class=
"org-string">        .map(key =&gt; {</span>
<span class="linenr">12403: </span><span class=
"org-string">          let defaultString</span>
<span class="linenr">12404: </span><span class=
"org-string">          const destructured = genDestructuredDefaultValue(key)</span>
<span class="linenr">12405: </span><span class=
"org-string">          if (destructured) {</span>
<span class="linenr">12406: </span><span class=
"org-string">            defaultString = `</span><span class=
"org-keyword">default</span>: ${destructured}<span class=
"org-string">`</span>
<span class="linenr">12407: </span><span class=
"org-string">          } else if (hasStaticDefaults) {</span>
<span class="linenr">12408: </span><span class=
"org-string">            const prop = propsRuntimeDefaults.properties.find(</span>
<span class="linenr">12409: </span><span class=
"org-string">              (node) =&gt; node.key.name === key</span>
<span class="linenr">12410: </span><span class=
"org-string">            )</span>
<span class="linenr">12411: </span><span class=
"org-string">            if (prop) {</span>
<span class="linenr">12412: </span><span class=
"org-string">              if (prop.type === 'ObjectProperty') {</span>
<span class="linenr">12413: </span><span class=
"org-string">                // prop has corresponding static default value</span>
<span class="linenr">12414: </span><span class=
"org-string">                defaultString = `</span><span class=
"org-keyword">default</span>: ${scriptSetupSource.slice(
<span class=
"linenr">12415: </span>                  prop.value.start,
<span class="linenr">12416: </span>                  prop.value.end
<span class="linenr">12417: </span>                )}<span class=
"org-string">`</span>
<span class="linenr">12418: </span><span class=
"org-string">              } else {</span>
<span class="linenr">12419: </span><span class=
"org-string">                defaultString = `</span><span class=
"org-keyword">default</span>() ${scriptSetupSource.slice(
<span class=
"linenr">12420: </span>                  prop.body.start,
<span class="linenr">12421: </span>                  prop.body.end
<span class="linenr">12422: </span>                )}<span class=
"org-string">`</span>
<span class="linenr">12423: </span><span class=
"org-string">              }</span>
<span class="linenr">12424: </span><span class=
"org-string">            }</span>
<span class="linenr">12425: </span><span class=
"org-string">          }</span>
<span class="linenr">12426: </span><span class=
"org-string">  </span>
<span class="linenr">12427: </span><span class=
"org-string">          const { type, required } = props[key]</span>
<span class="linenr">12428: </span><span class=
"org-string">          if (!isProd) {</span>
<span class="linenr">12429: </span><span class=
"org-string">            return `</span>${key}: { type: ${toRuntimeTypeString(
<span class="linenr">12430: </span>              type
<span class=
"linenr">12431: </span>            )}, required: ${required}${
<span class=
"linenr">12432: </span>              defaultString ? <span class=
"org-string">`, ${defaultString}`</span> : <span class=
"org-string">``</span>
<span class="linenr">12433: </span>            } }<span class=
"org-string">`</span>
<span class="linenr">12434: </span><span class=
"org-string">          } else if (</span>
<span class="linenr">12435: </span><span class=
"org-string">            type.some(</span>
<span class="linenr">12436: </span><span class=
"org-string">              el =&gt; el === 'Boolean' || (defaultString &amp;& el === 'Function')</span>
<span class="linenr">12437: </span><span class=
"org-string">            )</span>
<span class="linenr">12438: </span><span class=
"org-string">          ) {</span>
<span class="linenr">12439: </span><span class=
"org-string">            // #4783 production: if boolean or defaultString and function exists, should keep the type.</span>
<span class="linenr">12440: </span><span class=
"org-string">            return `</span>${key}: { type: ${toRuntimeTypeString(type)}${
<span class=
"linenr">12441: </span>              defaultString ? <span class=
"org-string">`, ${defaultString}`</span> : <span class=
"org-string">``</span>
<span class="linenr">12442: </span>            } }<span class=
"org-string">`</span>
<span class="linenr">12443: </span><span class=
"org-string">          } else {</span>
<span class="linenr">12444: </span><span class=
"org-string">            // production: checks are useless</span>
<span class="linenr">12445: </span><span class=
"org-string">            return `</span>${key}: ${defaultString ? <span class="org-string">`{ ${defaultString} }`</span> : <span class="org-string">'null'</span>}<span class="org-string">`</span>
<span class="linenr">12446: </span><span class=
"org-string">          }</span>
<span class="linenr">12447: </span><span class=
"org-string">        })</span>
<span class="linenr">12448: </span><span class=
"org-string">        .join(',\n    ')}\n  }`</span>
<span class="linenr">12449: </span>  
<span class="linenr">12450: </span>      <span class=
"org-keyword">if</span> (propsRuntimeDefaults &amp;& !hasStaticDefaults) {
<span class=
"linenr">12451: </span>        propsDecls = <span class="org-string">`${helper('mergeDefaults')}(${propsDecls}, ${source.slice(</span>
<span class="linenr">12452: </span><span class=
"org-string">          propsRuntimeDefaults.start + startOffset,</span>
<span class="linenr">12453: </span><span class=
"org-string">          propsRuntimeDefaults.end + startOffset</span>
<span class="linenr">12454: </span><span class=
"org-string">        )})`</span>
<span class="linenr">12455: </span>      }
<span class="linenr">12456: </span>  
<span class="linenr">12457: </span>      <span class=
"org-keyword">return</span> <span class=
"org-string">`\n  props: ${propsDecls},`</span>
<span class="linenr">12458: </span>    }
<span class="linenr">12459: </span>  
<span class="linenr">12460: </span>  
<span class="linenr">12461: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">genDestructuredDefaultValue</span>(<span class=
"org-variable-name">key</span>) {
<span class="linenr">12462: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">destructured</span> = propsDestructuredBindings[key]
<span class="linenr">12463: </span>      <span class=
"org-keyword">if</span> (destructured &amp;& destructured.<span class="org-keyword">default</span>) {
<span class="linenr">12464: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">value</span> = scriptSetup.content.slice(
<span class=
"linenr">12465: </span>          destructured.<span class=
"org-keyword">default</span>.start,
<span class=
"linenr">12466: </span>          destructured.<span class=
"org-keyword">default</span>.end
<span class="linenr">12467: </span>        )
<span class="linenr">12468: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isLiteral</span> = destructured.<span class=
"org-keyword">default</span>.type.endsWith(<span class=
"org-string">'Literal'</span>)
<span class="linenr">12469: </span>        <span class=
"org-keyword">return</span> isLiteral ? value : <span class=
"org-string">`() =&gt; ${value}`</span>
<span class="linenr">12470: </span>      }
<span class="linenr">12471: </span>    }
<span class="linenr">12472: </span>  
<span class="linenr">12473: </span>    <span class=
"org-keyword">function</span> <span class=
"org-function-name">genSetupPropsType</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr">12474: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptSetupSource</span> = scriptSetup.content
<span class="linenr">12475: </span>      <span class=
"org-keyword">if</span> (hasStaticWithDefaults()) {
<span class="linenr">12476: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if withDefaults() is used, we need to remove the optional flags</span>
<span class="linenr">12477: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">on props that have default values</span>
<span class="linenr">12478: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">res</span> = <span class=
"org-string">`{ `</span>
<span class="linenr">12479: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">members</span> = node.type === <span class=
"org-string">'TSTypeLiteral'</span> ? node.members : node.body
<span class="linenr">12480: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">m</span> <span class=
"org-keyword">of</span> members) {
<span class="linenr">12481: </span>          <span class=
"org-keyword">if</span> (
<span class=
"linenr">12482: </span>            (m.type === <span class=
"org-string">'TSPropertySignature'</span> ||
<span class=
"linenr">12483: </span>              m.type === <span class=
"org-string">'TSMethodSignature'</span>) &amp;&
<span class=
"linenr">12484: </span>            m.typeAnnotation &amp;&
<span class=
"linenr">12485: </span>            m.key.type === <span class=
"org-string">'Identifier'</span>
<span class="linenr">12486: </span>          ) {
<span class="linenr">12487: </span>            <span class=
"org-keyword">if</span> (
<span class=
"linenr">12488: </span>              propsRuntimeDefaults.properties.some(
<span class=
"linenr">12489: </span>                (p) =&gt; p.key.name === m.key.name
<span class="linenr">12490: </span>              )
<span class="linenr">12491: </span>            ) {
<span class="linenr">12492: </span>              res +=
<span class="linenr">12493: </span>                m.key.name +
<span class=
"linenr">12494: </span>                (m.type === <span class=
"org-string">'TSMethodSignature'</span> ? <span class=
"org-string">'()'</span> : <span class="org-string">''</span>) +
<span class=
"linenr">12495: </span>                scriptSetupSource.slice(
<span class=
"linenr">12496: </span>                  m.typeAnnotation.start,
<span class=
"linenr">12497: </span>                  m.typeAnnotation.end
<span class="linenr">12498: </span>                ) +
<span class="linenr">12499: </span>                <span class=
"org-string">', '</span>
<span class="linenr">12500: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr">12501: </span>              res +=
<span class=
"linenr">12502: </span>                scriptSetupSource.slice(m.start, m.typeAnnotation.end) + <span class="org-string">`, `</span>
<span class="linenr">12503: </span>            }
<span class="linenr">12504: </span>          }
<span class="linenr">12505: </span>        }
<span class="linenr">12506: </span>        <span class=
"org-keyword">return</span> (res.length ? res.slice(<span class=
"org-highlight-numbers-number">0</span>, -<span class=
"org-highlight-numbers-number">2</span>) : res) + <span class=
"org-string">` }`</span>
<span class="linenr">12507: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">12508: </span>        <span class=
"org-keyword">return</span> scriptSetupSource.slice(node.start, node.end)
<span class="linenr">12509: </span>      }
<span class="linenr">12510: </span>    }
<span class="linenr">12511: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">processNormalScript</span>() {
<span class="linenr">12512: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">scriptAst</span>
<span class="linenr">12513: </span>    <span class=
"org-keyword">if</span> (script) {
<span class="linenr">12514: </span>      scriptAst = parse(
<span class="linenr">12515: </span>        script.content,
<span class="linenr">12516: </span>        {
<span class="linenr">12517: </span>          plugins,
<span class=
"linenr">12518: </span>          sourceType: <span class=
"org-string">'module'</span>
<span class="linenr">12519: </span>        },
<span class="linenr">12520: </span>        scriptStartOffset
<span class="linenr">12521: </span>      )
<span class="linenr">12522: </span>  
<span class="linenr">12523: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> <span class=
"org-keyword">of</span> scriptAst.body) {
<span class="linenr">12524: </span>        <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ImportDeclaration'</span>) {
<span class="linenr">12525: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">record imports for dedupe</span>
<span class="linenr">12526: </span>          <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">specifier</span> <span class=
"org-keyword">of</span> node.specifiers) {
<span class="linenr">12527: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">imported</span> =
<span class=
"linenr">12528: </span>              specifier.type === <span class="org-string">'ImportSpecifier'</span> &amp;&
<span class=
"linenr">12529: </span>              specifier.imported.type === <span class="org-string">'Identifier'</span> &amp;&
<span class=
"linenr">12530: </span>              specifier.imported.name
<span class="linenr">12531: </span>            registerUserImport(
<span class="linenr">12532: </span>              node.source.value,
<span class=
"linenr">12533: </span>              specifier.local.name,
<span class="linenr">12534: </span>              imported,
<span class=
"linenr">12535: </span>              node.importKind === <span class="org-string">'type'</span> ||
<span class=
"linenr">12536: </span>                (specifier.type === <span class="org-string">'ImportSpecifier'</span> &amp;&
<span class=
"linenr">12537: </span>                  specifier.importKind === <span class="org-string">'type'</span>),
<span class="linenr">12538: </span>              <span class=
"org-constant">false</span>
<span class="linenr">12539: </span>            )
<span class="linenr">12540: </span>          }
<span class="linenr">12541: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ExportDefaultDeclaration'</span>) {
<span class="linenr">12542: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export default</span>
<span class="linenr">12543: </span>          defaultExport = node
<span class="linenr">12544: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export default { ... } --&gt; const __default__ = { ... }</span>
<span class="linenr">12545: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = node.start + scriptStartOffset
<span class="linenr">12546: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">end</span> = node.declaration.start + scriptStartOffset
<span class=
"linenr">12547: </span>          s.overwrite(start, end, <span class="org-string">`const ${DEFAULT_VAR} = `</span>)
<span class="linenr">12548: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ExportNamedDeclaration'</span>) {
<span class="linenr">12549: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">defaultSpecifier</span> = node.specifiers.find(
<span class=
"linenr">12550: </span>            s =&gt; s.exported.type === <span class="org-string">'Identifier'</span> &amp;& s.exported.name === <span class="org-string">'default'</span>
<span class="linenr">12551: </span>          )
<span class="linenr">12552: </span>          <span class=
"org-keyword">if</span> (defaultSpecifier) {
<span class="linenr">12553: </span>            defaultExport = node
<span class="linenr">12554: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. remove specifier</span>
<span class="linenr">12555: </span>            <span class=
"org-keyword">if</span> (node.specifiers.length &gt; <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr">12556: </span>              s.remove(
<span class=
"linenr">12557: </span>                defaultSpecifier.start + scriptStartOffset,
<span class=
"linenr">12558: </span>                defaultSpecifier.end + scriptStartOffset
<span class="linenr">12559: </span>              )
<span class="linenr">12560: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr">12561: </span>              s.remove(
<span class=
"linenr">12562: </span>                node.start + scriptStartOffset,
<span class=
"linenr">12563: </span>                node.end + scriptStartOffset
<span class="linenr">12564: </span>              )
<span class="linenr">12565: </span>            }
<span class="linenr">12566: </span>            <span class=
"org-keyword">if</span> (node.source) {
<span class="linenr">12567: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export { x as default } from './x'</span>
<span class="linenr">12568: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">rewrite to `import { x as __default__ } from './x'` and</span>
<span class="linenr">12569: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">add to top</span>
<span class="linenr">12570: </span>              s.prepend(
<span class="linenr">12571: </span>                <span class=
"org-string">`import { ${defaultSpecifier.local.name} as ${DEFAULT_VAR} } from '${node.source.value}'\n`</span>
<span class="linenr">12572: </span>              )
<span class="linenr">12573: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr">12574: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export { x as default }</span>
<span class="linenr">12575: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">rewrite to `const __default__ = x` and move to end</span>
<span class="linenr">12576: </span>              s.appendLeft(
<span class="linenr">12577: </span>                scriptEndOffset,
<span class="linenr">12578: </span>                <span class=
"org-string">`\nconst ${DEFAULT_VAR} = ${defaultSpecifier.local.name}\n`</span>
<span class="linenr">12579: </span>              )
<span class="linenr">12580: </span>            }
<span class="linenr">12581: </span>          }
<span class="linenr">12582: </span>          <span class=
"org-keyword">if</span> (node.declaration) {
<span class=
"linenr">12583: </span>            walkDeclaration(node.declaration, scriptBindings, userImportAlias)
<span class="linenr">12584: </span>          }
<span class="linenr">12585: </span>        } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr">12586: </span>          (node.type === <span class=
"org-string">'VariableDeclaration'</span> ||
<span class=
"linenr">12587: </span>            node.type === <span class=
"org-string">'FunctionDeclaration'</span> ||
<span class=
"linenr">12588: </span>            node.type === <span class=
"org-string">'ClassDeclaration'</span> ||
<span class=
"linenr">12589: </span>            node.type === <span class=
"org-string">'TSEnumDeclaration'</span>) &amp;&
<span class="linenr">12590: </span>          !node.declare
<span class="linenr">12591: </span>        ) {
<span class=
"linenr">12592: </span>          walkDeclaration(node, scriptBindings, userImportAlias)
<span class="linenr">12593: </span>        }
<span class="linenr">12594: </span>      }
<span class="linenr">12595: </span>  
<span class="linenr">12596: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">apply reactivity transform</span>
<span class="linenr">12597: </span>      <span class=
"org-keyword">if</span> (enableReactivityTransform &amp;& RT.shouldTransform(script.content)) {
<span class="linenr">12598: </span>        <span class=
"org-keyword">const</span> { rootRefs, importedHelpers } = transformAST(
<span class="linenr">12599: </span>          scriptAst,
<span class="linenr">12600: </span>          s,
<span class="linenr">12601: </span>          scriptStartOffset
<span class="linenr">12602: </span>        )
<span class="linenr">12603: </span>        refBindings = rootRefs
<span class="linenr">12604: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">h</span> <span class=
"org-keyword">of</span> importedHelpers) {
<span class="linenr">12605: </span>          helperImports.add(h)
<span class="linenr">12606: </span>        }
<span class="linenr">12607: </span>      }
<span class="linenr">12608: </span>  
<span class="linenr">12609: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;script&gt; after &lt;script setup&gt;</span>
<span class="linenr">12610: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we need to move the block up so that `const __default__` is</span>
<span class="linenr">12611: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">declared before being used in the actual component definition</span>
<span class="linenr">12612: </span>      <span class=
"org-keyword">if</span> (scriptStartOffset &gt; startOffset) {
<span class=
"linenr">12613: </span>        s.move(scriptStartOffset, scriptEndOffset, <span class="org-highlight-numbers-number">0</span>)
<span class="linenr">12614: </span>      }
<span class="linenr">12615: </span>    }
<span class="linenr">12616: </span>  
<span class="linenr">12617: </span>    <span class=
"org-keyword">return</span> scriptAst
<span class="linenr">12618: </span>  }
<span class="linenr">12619: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">processSetupScript</span>() {
<span class="linenr">12620: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptSetupAst</span> = babelParser.parse(
<span class="linenr">12621: </span>      scriptSetup.content,
<span class="linenr">12622: </span>      {
<span class="linenr">12623: </span>        plugins: [
<span class="linenr">12624: </span>          ...plugins,
<span class="linenr">12625: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">allow top level await but only inside &lt;script setup&gt;</span>
<span class="linenr">12626: </span>          <span class=
"org-string">'topLevelAwait'</span>
<span class="linenr">12627: </span>        ],
<span class="linenr">12628: </span>        sourceType: <span class=
"org-string">'module'</span>
<span class="linenr">12629: </span>      },
<span class="linenr">12630: </span>      startOffset
<span class="linenr">12631: </span>    )
<span class="linenr">12632: </span>  
<span class="linenr">12633: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> <span class=
"org-keyword">of</span> scriptSetupAst.body) {
<span class="linenr">12634: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = node.start + startOffset
<span class="linenr">12635: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">end</span> = node.end + startOffset
<span class="linenr">12636: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">locate comment</span>
<span class="linenr">12637: </span>      <span class=
"org-keyword">if</span> (node.trailingComments &amp;& node.trailingComments.length &gt; <span class="org-highlight-numbers-number">0</span>) {
<span class="linenr">12638: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">lastCommentNode</span> =
<span class=
"linenr">12639: </span>          node.trailingComments[node.trailingComments.length - <span class="org-highlight-numbers-number">1</span>]
<span class=
"linenr">12640: </span>        end = lastCommentNode.end + startOffset
<span class="linenr">12641: </span>      }
<span class="linenr">12642: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">locate the end of whitespace between this statement and the next</span>
<span class="linenr">12643: </span>      <span class=
"org-keyword">while</span> (end &lt;= source.length) {
<span class="linenr">12644: </span>        <span class=
"org-keyword">if</span> (!<span class=
"org-string">/\s/</span>.test(source.charAt(end))) {
<span class="linenr">12645: </span>          <span class=
"org-keyword">break</span>
<span class="linenr">12646: </span>        }
<span class="linenr">12647: </span>        end++
<span class="linenr">12648: </span>      }
<span class="linenr">12649: </span>  
<span class="linenr">12650: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">(Dropped) `ref: x` bindings</span>
<span class="linenr">12651: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr">12652: </span>        node.type === <span class=
"org-string">'LabeledStatement'</span> &amp;&
<span class=
"linenr">12653: </span>        node.label.name === <span class=
"org-string">'ref'</span> &amp;&
<span class=
"linenr">12654: </span>        node.body.type === <span class=
"org-string">'ExpressionStatement'</span>
<span class="linenr">12655: </span>      ) {
<span class="linenr">12656: </span>        error(
<span class="linenr">12657: </span>          <span class=
"org-string">`ref sugar using the label syntax was an experimental proposal and `</span> +
<span class="linenr">12658: </span>            <span class=
"org-string">`has been dropped based on community feedback. Please check out `</span> +
<span class="linenr">12659: </span>            <span class=
"org-string">`the new proposal at https://github.com/vuejs/rfcs/discussions/369`</span>,
<span class="linenr">12660: </span>          node
<span class="linenr">12661: </span>        )
<span class="linenr">12662: </span>      }
<span class="linenr">12663: </span>  
<span class="linenr">12664: </span>      <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ImportDeclaration'</span>) {
<span class="linenr">12665: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">import declarations are moved to top</span>
<span class=
"linenr">12666: </span>        s.move(start, end, <span class=
"org-highlight-numbers-number">0</span>)
<span class="linenr">12667: </span>  
<span class="linenr">12668: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">dedupe imports</span>
<span class="linenr">12669: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">removed</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">12670: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">removeSpecifier</span> = (i) =&gt; {
<span class="linenr">12671: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">removeLeft</span> = i &gt; removed
<span class="linenr">12672: </span>          removed++
<span class="linenr">12673: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">current</span> = node.specifiers[i]
<span class="linenr">12674: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">next</span> = node.specifiers[i + <span class=
"org-highlight-numbers-number">1</span>]
<span class="linenr">12675: </span>          s.remove(
<span class="linenr">12676: </span>            removeLeft
<span class=
"linenr">12677: </span>              ? node.specifiers[i - <span class="org-highlight-numbers-number">1</span>].end + startOffset
<span class=
"linenr">12678: </span>              : current.start + startOffset,
<span class=
"linenr">12679: </span>            next &amp;& !removeLeft
<span class=
"linenr">12680: </span>              ? next.start + startOffset
<span class=
"linenr">12681: </span>              : current.end + startOffset
<span class="linenr">12682: </span>          )
<span class="linenr">12683: </span>        }
<span class="linenr">12684: </span>  
<span class="linenr">12685: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.specifiers.length; i++) {
<span class="linenr">12686: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">specifier</span> = node.specifiers[i]
<span class="linenr">12687: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">local</span> = specifier.local.name
<span class="linenr">12688: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">imported</span> =
<span class=
"linenr">12689: </span>            specifier.type === <span class=
"org-string">'ImportSpecifier'</span> &amp;&
<span class=
"linenr">12690: </span>            specifier.imported.type === <span class="org-string">'Identifier'</span> &amp;&
<span class=
"linenr">12691: </span>            specifier.imported.name
<span class="linenr">12692: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = node.source.value
<span class="linenr">12693: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">existing</span> = userImports[local]
<span class="linenr">12694: </span>          <span class=
"org-keyword">if</span> (
<span class=
"linenr">12695: </span>            source === <span class=
"org-string">'vue'</span> &amp;&
<span class=
"linenr">12696: </span>            (imported === DEFINE_PROPS ||
<span class=
"linenr">12697: </span>              imported === DEFINE_EMITS ||
<span class=
"linenr">12698: </span>              imported === DEFINE_EXPOSE)
<span class="linenr">12699: </span>          ) {
<span class="linenr">12700: </span>            removeSpecifier(i)
<span class="linenr">12701: </span>          } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (existing) {
<span class="linenr">12702: </span>            <span class=
"org-keyword">if</span> (existing.source === source &amp;& existing.imported === imported) {
<span class="linenr">12703: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">already imported in &lt;script setup&gt;, dedupe</span>
<span class="linenr">12704: </span>              removeSpecifier(i)
<span class="linenr">12705: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr">12706: </span>              error(<span class=
"org-string">`different imports aliased to same local name.`</span>, specifier)
<span class="linenr">12707: </span>            }
<span class="linenr">12708: </span>          } <span class=
"org-keyword">else</span> {
<span class="linenr">12709: </span>            registerUserImport(
<span class="linenr">12710: </span>              source,
<span class="linenr">12711: </span>              local,
<span class="linenr">12712: </span>              imported,
<span class=
"linenr">12713: </span>              node.importKind === <span class="org-string">'type'</span> ||
<span class=
"linenr">12714: </span>                (specifier.type === <span class="org-string">'ImportSpecifier'</span> &amp;&
<span class=
"linenr">12715: </span>                  specifier.importKind === <span class="org-string">'type'</span>),
<span class="linenr">12716: </span>              <span class=
"org-constant">true</span>
<span class="linenr">12717: </span>            )
<span class="linenr">12718: </span>          }
<span class="linenr">12719: </span>        }
<span class="linenr">12720: </span>        <span class=
"org-keyword">if</span> (node.specifiers.length &amp;& removed === node.specifiers.length) {
<span class=
"linenr">12721: </span>          s.remove(node.start + startOffset, node.end + startOffset)
<span class="linenr">12722: </span>        }
<span class="linenr">12723: </span>      }
<span class="linenr">12724: </span>  
<span class="linenr">12725: </span>      <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ExpressionStatement'</span>) {
<span class="linenr">12726: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">process `defineProps` and `defineEmit(s)` calls</span>
<span class="linenr">12727: </span>        <span class=
"org-keyword">if</span> (
<span class=
"linenr">12728: </span>          processDefineProps(node.expression) ||
<span class=
"linenr">12729: </span>          processDefineEmits(node.expression) ||
<span class=
"linenr">12730: </span>          processWithDefaults(node.expression)
<span class="linenr">12731: </span>        ) {
<span class=
"linenr">12732: </span>          s.remove(node.start + startOffset, node.end + startOffset)
<span class="linenr">12733: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (processDefineExpose(node.expression)) {
<span class="linenr">12734: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">defineExpose({}) -&gt; expose({})</span>
<span class="linenr">12735: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">callee</span> = node.expression.callee
<span class="linenr">12736: </span>          s.overwrite(
<span class=
"linenr">12737: </span>            callee.start + startOffset,
<span class=
"linenr">12738: </span>            callee.end + startOffset,
<span class="linenr">12739: </span>            <span class=
"org-string">'expose'</span>
<span class="linenr">12740: </span>          )
<span class="linenr">12741: </span>        }
<span class="linenr">12742: </span>      }
<span class="linenr">12743: </span>  
<span class="linenr">12744: </span>      <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'VariableDeclaration'</span> &amp;& !node.declare) {
<span class="linenr">12745: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">total</span> = node.declarations.length
<span class="linenr">12746: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">left</span> = total
<span class="linenr">12747: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; total; i++) {
<span class="linenr">12748: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">decl</span> = node.declarations[i]
<span class="linenr">12749: </span>          <span class=
"org-keyword">if</span> (decl.init) {
<span class="linenr">12750: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">defineProps / defineEmits</span>
<span class="linenr">12751: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDefineProps</span> =
<span class=
"linenr">12752: </span>              processDefineProps(decl.init, decl.id) ||
<span class=
"linenr">12753: </span>              processWithDefaults(decl.init, decl.id)
<span class="linenr">12754: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDefineEmits</span> = processDefineEmits(decl.init, decl.id)
<span class="linenr">12755: </span>            <span class=
"org-keyword">if</span> (isDefineProps || isDefineEmits) {
<span class="linenr">12756: </span>              <span class=
"org-keyword">if</span> (left === <span class=
"org-highlight-numbers-number">1</span>) {
<span class=
"linenr">12757: </span>                s.remove(node.start + startOffset, node.end + startOffset)
<span class="linenr">12758: </span>              } <span class=
"org-keyword">else</span> {
<span class="linenr">12759: </span>                <span class=
"org-keyword">let</span> <span class=
"org-variable-name">start</span> = decl.start + startOffset
<span class="linenr">12760: </span>                <span class=
"org-keyword">let</span> <span class=
"org-variable-name">end</span> = decl.end + startOffset
<span class="linenr">12761: </span>                <span class=
"org-keyword">if</span> (i &lt; total - <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr">12762: </span>                  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">not the last one, locate the start of the next</span>
<span class=
"linenr">12763: </span>                  end = node.declarations[i + <span class="org-highlight-numbers-number">1</span>].start + startOffset
<span class="linenr">12764: </span>                } <span class=
"org-keyword">else</span> {
<span class="linenr">12765: </span>                  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">last one, locate the end of the prev</span>
<span class=
"linenr">12766: </span>                  start = node.declarations[i - <span class="org-highlight-numbers-number">1</span>].end + startOffset
<span class="linenr">12767: </span>                }
<span class=
"linenr">12768: </span>                s.remove(start, end)
<span class="linenr">12769: </span>                left--
<span class="linenr">12770: </span>              }
<span class="linenr">12771: </span>            }
<span class="linenr">12772: </span>          }
<span class="linenr">12773: </span>        }
<span class="linenr">12774: </span>      }
<span class="linenr">12775: </span>  
<span class="linenr">12776: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">walk declarations to record declared bindings</span>
<span class="linenr">12777: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr">12778: </span>        (node.type === <span class=
"org-string">'VariableDeclaration'</span> ||
<span class=
"linenr">12779: </span>          node.type === <span class=
"org-string">'FunctionDeclaration'</span> ||
<span class=
"linenr">12780: </span>          node.type === <span class=
"org-string">'ClassDeclaration'</span>) &amp;&
<span class="linenr">12781: </span>        !node.declare
<span class="linenr">12782: </span>      ) {
<span class=
"linenr">12783: </span>        walkDeclaration(node, setupBindings, userImportAlias)
<span class="linenr">12784: </span>      }
<span class="linenr">12785: </span>  
<span class="linenr">12786: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">walk statements & named exports / variable declarations for top level</span>
<span class="linenr">12787: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">await</span>
<span class="linenr">12788: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr">12789: </span>        (node.type === <span class=
"org-string">'VariableDeclaration'</span> &amp;& !node.declare) ||
<span class=
"linenr">12790: </span>        node.type.endsWith(<span class=
"org-string">'Statement'</span>)
<span class="linenr">12791: </span>      ) {
<span class="linenr">12792: </span>        walk(node, {
<span class="linenr">12793: </span>          enter(child, parent) {
<span class="linenr">12794: </span>            <span class=
"org-keyword">if</span> (isFunctionType(child)) {
<span class="linenr">12795: </span>              <span class=
"org-constant">this</span>.skip()
<span class="linenr">12796: </span>            }
<span class="linenr">12797: </span>            <span class=
"org-keyword">if</span> (child.type === <span class=
"org-string">'AwaitExpression'</span>) {
<span class=
"linenr">12798: </span>              hasAwait = <span class=
"org-constant">true</span>
<span class="linenr">12799: </span>              <span class=
"org-keyword">const</span> <span class=
"org-variable-name">needsSemi</span> = scriptSetupAst.body.some(n =&gt; {
<span class="linenr">12800: </span>                <span class=
"org-keyword">return</span> n.type === <span class=
"org-string">'ExpressionStatement'</span> &amp;& n.start === child.start
<span class="linenr">12801: </span>              })
<span class="linenr">12802: </span>              processAwait(
<span class="linenr">12803: </span>                child,
<span class="linenr">12804: </span>                needsSemi,
<span class=
"linenr">12805: </span>                parent.type === <span class=
"org-string">'ExpressionStatement'</span>
<span class="linenr">12806: </span>              )
<span class="linenr">12807: </span>            }
<span class="linenr">12808: </span>          }
<span class="linenr">12809: </span>        })
<span class="linenr">12810: </span>      }
<span class="linenr">12811: </span>  
<span class="linenr">12812: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr">12813: </span>        (node.type === <span class=
"org-string">'ExportNamedDeclaration'</span> &amp;& node.exportKind !== <span class="org-string">'type'</span>) ||
<span class=
"linenr">12814: </span>        node.type === <span class=
"org-string">'ExportAllDeclaration'</span> ||
<span class=
"linenr">12815: </span>        node.type === <span class=
"org-string">'ExportDefaultDeclaration'</span>
<span class="linenr">12816: </span>      ) {
<span class="linenr">12817: </span>        error(
<span class="linenr">12818: </span>          <span class=
"org-string">`&lt;script setup&gt; cannot contain ES module exports. `</span> +
<span class="linenr">12819: </span>            <span class=
"org-string">`If you are using a previous version of &lt;script setup&gt;, please `</span> +
<span class="linenr">12820: </span>            <span class=
"org-string">`consult the updated RFC at https://github.com/vuejs/rfcs/pull/227.`</span>,
<span class="linenr">12821: </span>          node
<span class="linenr">12822: </span>        )
<span class="linenr">12823: </span>      }
<span class="linenr">12824: </span>  
<span class="linenr">12825: </span>      <span class=
"org-keyword">if</span> (isTS) {
<span class="linenr">12826: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">runtime enum</span>
<span class="linenr">12827: </span>        <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'TSEnumDeclaration'</span>) {
<span class=
"linenr">12828: </span>          registerBinding(setupBindings, node.id, BindingTypes.SETUP_CONST)
<span class="linenr">12829: </span>        }
<span class="linenr">12830: </span>  
<span class="linenr">12831: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">move all Type declarations to outer scope</span>
<span class="linenr">12832: </span>        <span class=
"org-keyword">if</span> (
<span class=
"linenr">12833: </span>          node.type.startsWith(<span class=
"org-string">'TS'</span>) ||
<span class=
"linenr">12834: </span>          (node.type === <span class=
"org-string">'ExportNamedDeclaration'</span> &amp;&
<span class=
"linenr">12835: </span>            node.exportKind === <span class=
"org-string">'type'</span>) ||
<span class=
"linenr">12836: </span>          (node.type === <span class=
"org-string">'VariableDeclaration'</span> &amp;& node.declare)
<span class="linenr">12837: </span>        ) {
<span class=
"linenr">12838: </span>          recordType(node, declaredTypes)
<span class=
"linenr">12839: </span>          s.move(start, end, <span class=
"org-highlight-numbers-number">0</span>)
<span class="linenr">12840: </span>        }
<span class="linenr">12841: </span>      }
<span class="linenr">12842: </span>    }
<span class="linenr">12843: </span>  
<span class="linenr">12844: </span>    <span class=
"org-keyword">return</span> scriptSetupAst
<span class="linenr">12845: </span>  }
<span class="linenr">12846: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">applyReactivityTransform</span>() {
<span class="linenr">12847: </span>    <span class=
"org-keyword">if</span> (
<span class=
"linenr">12848: </span>      (enableReactivityTransform &amp;&
<span class="linenr">12849: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">normal &lt;script&gt; had ref bindings that maybe used in &lt;script setup&gt;</span>
<span class=
"linenr">12850: </span>        (refBindings || RT.shouldTransform(scriptSetup.content))) ||
<span class="linenr">12851: </span>      propsDestructureDecl
<span class="linenr">12852: </span>    ) {
<span class="linenr">12853: </span>      <span class=
"org-keyword">const</span> { rootRefs, importedHelpers } = transformAST(
<span class="linenr">12854: </span>        scriptSetupAst,
<span class="linenr">12855: </span>        s,
<span class="linenr">12856: </span>        startOffset,
<span class="linenr">12857: </span>        refBindings,
<span class=
"linenr">12858: </span>        propsDestructuredBindings
<span class="linenr">12859: </span>      )
<span class=
"linenr">12860: </span>      refBindings = refBindings ? [...refBindings, ...rootRefs] : rootRefs
<span class="linenr">12861: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">h</span> <span class=
"org-keyword">of</span> importedHelpers) {
<span class="linenr">12862: </span>        helperImports.add(h)
<span class="linenr">12863: </span>      }
<span class="linenr">12864: </span>    }
<span class="linenr">12865: </span>  }
<span class="linenr">12866: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">extractRuntimePropsEmits</span>() {
<span class="linenr">12867: </span>    <span class=
"org-keyword">if</span> (propsTypeDecl) {
<span class=
"linenr">12868: </span>      extractRuntimeProps(propsTypeDecl, typeDeclaredProps, declaredTypes, isProd)
<span class="linenr">12869: </span>    }
<span class="linenr">12870: </span>    <span class=
"org-keyword">if</span> (emitsTypeDecl) {
<span class=
"linenr">12871: </span>      extractRuntimeEmits(emitsTypeDecl, typeDeclaredEmits)
<span class="linenr">12872: </span>    }
<span class="linenr">12873: </span>  }
<span class="linenr">12874: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">checkUseOptions</span>() {
<span class=
"linenr">12875: </span>    checkInvalidScopeReference(propsRuntimeDecl, DEFINE_PROPS)
<span class=
"linenr">12876: </span>    checkInvalidScopeReference(propsRuntimeDefaults, DEFINE_PROPS)
<span class=
"linenr">12877: </span>    checkInvalidScopeReference(propsDestructureDecl, DEFINE_PROPS)
<span class=
"linenr">12878: </span>    checkInvalidScopeReference(emitsRuntimeDecl, DEFINE_PROPS)
<span class="linenr">12879: </span>  }
<span class="linenr">12880: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">removeNonScriptContent</span>() {
<span class="linenr">12881: </span>    <span class=
"org-keyword">if</span> (script) {
<span class="linenr">12882: </span>      <span class=
"org-keyword">if</span> (startOffset &lt; scriptStartOffset) {
<span class="linenr">12883: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;script setup&gt; before &lt;script&gt;</span>
<span class="linenr">12884: </span>        s.remove(<span class=
"org-highlight-numbers-number">0</span>, startOffset)
<span class=
"linenr">12885: </span>        s.remove(endOffset, scriptStartOffset)
<span class=
"linenr">12886: </span>        s.remove(scriptEndOffset, source.length)
<span class="linenr">12887: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">12888: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;script&gt; before &lt;script setup&gt;</span>
<span class="linenr">12889: </span>        s.remove(<span class=
"org-highlight-numbers-number">0</span>, scriptStartOffset)
<span class=
"linenr">12890: </span>        s.remove(scriptEndOffset, startOffset)
<span class=
"linenr">12891: </span>        s.remove(endOffset, source.length)
<span class="linenr">12892: </span>      }
<span class="linenr">12893: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">12894: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">only &lt;script setup&gt;</span>
<span class="linenr">12895: </span>      s.remove(<span class=
"org-highlight-numbers-number">0</span>, startOffset)
<span class=
"linenr">12896: </span>      s.remove(endOffset, source.length)
<span class="linenr">12897: </span>    }
<span class="linenr">12898: </span>  }
<span class="linenr">12899: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">analyzeBindingMetadata</span>() {
<span class="linenr">12900: </span>    <span class=
"org-keyword">if</span> (scriptAst) {
<span class=
"linenr">12901: </span>      Object.assign(bindingMetadata, analyzeScriptBindings(scriptAst.body))
<span class="linenr">12902: </span>    }
<span class="linenr">12903: </span>    <span class=
"org-keyword">if</span> (propsRuntimeDecl) {
<span class="linenr">12904: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">of</span> getObjectOrArrayExpressionKeys(propsRuntimeDecl)) {
<span class=
"linenr">12905: </span>        bindingMetadata[key] = BindingTypes.PROPS
<span class="linenr">12906: </span>      }
<span class="linenr">12907: </span>    }
<span class="linenr">12908: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> typeDeclaredProps) {
<span class=
"linenr">12909: </span>      bindingMetadata[key] = BindingTypes.PROPS
<span class="linenr">12910: </span>    }
<span class="linenr">12911: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props aliases</span>
<span class="linenr">12912: </span>    <span class=
"org-keyword">if</span> (propsDestructureDecl) {
<span class="linenr">12913: </span>      <span class=
"org-keyword">if</span> (propsDestructureRestId) {
<span class=
"linenr">12914: </span>        bindingMetadata[propsDestructureRestId] = BindingTypes.SETUP_CONST
<span class="linenr">12915: </span>      }
<span class="linenr">12916: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> propsDestructuredBindings) {
<span class="linenr">12917: </span>        <span class=
"org-keyword">const</span> { local } = propsDestructuredBindings[key]
<span class="linenr">12918: </span>        <span class=
"org-keyword">if</span> (local !== key) {
<span class=
"linenr">12919: </span>          bindingMetadata[local] = BindingTypes.PROPS_ALIASED
<span class=
"linenr">12920: </span>          ;(bindingMetadata.__propsAliases ||
<span class=
"linenr">12921: </span>            (bindingMetadata.__propsAliases = {}))[local] = key
<span class="linenr">12922: </span>        }
<span class="linenr">12923: </span>      }
<span class="linenr">12924: </span>    }
<span class="linenr">12925: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> [key, { isType, imported, source }] <span class="org-keyword">of</span> Object.entries(
<span class="linenr">12926: </span>      userImports
<span class="linenr">12927: </span>    )) {
<span class="linenr">12928: </span>      <span class=
"org-keyword">if</span> (isType) <span class=
"org-keyword">continue</span>
<span class="linenr">12929: </span>      bindingMetadata[key] =
<span class=
"linenr">12930: </span>        (imported === <span class=
"org-string">'default'</span> &amp;& source.endsWith(<span class=
"org-string">'.vue'</span>)) || source === <span class=
"org-string">'vue'</span>
<span class=
"linenr">12931: </span>          ? BindingTypes.SETUP_CONST
<span class=
"linenr">12932: </span>          : BindingTypes.SETUP_MAYBE_REF
<span class="linenr">12933: </span>    }
<span class="linenr">12934: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> scriptBindings) {
<span class=
"linenr">12935: </span>      bindingMetadata[key] = scriptBindings[key]
<span class="linenr">12936: </span>    }
<span class="linenr">12937: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> setupBindings) {
<span class=
"linenr">12938: </span>      bindingMetadata[key] = setupBindings[key]
<span class="linenr">12939: </span>    }
<span class="linenr">12940: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">known ref bindings</span>
<span class="linenr">12941: </span>    <span class=
"org-keyword">if</span> (refBindings) {
<span class="linenr">12942: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">of</span> refBindings) {
<span class=
"linenr">12943: </span>        bindingMetadata[key] = BindingTypes.SETUP_REF
<span class="linenr">12944: </span>      }
<span class="linenr">12945: </span>    }
<span class="linenr">12946: </span>  }
<span class="linenr">12947: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">injectUseCssVarsCalls</span>() {
<span class="linenr">12948: </span>    <span class=
"org-keyword">if</span> (cssVars.length) {
<span class=
"linenr">12949: </span>      helperImports.add(CSS_VARS_HELPER)
<span class=
"linenr">12950: </span>      helperImports.add(<span class=
"org-string">'unref'</span>)
<span class="linenr">12951: </span>      s.prependRight(
<span class="linenr">12952: </span>        startOffset,
<span class="linenr">12953: </span>        <span class=
"org-string">`\n${genCssVarsCode(cssVars, bindingMetadata, scopeId, isProd)}\n`</span>
<span class="linenr">12954: </span>      )
<span class="linenr">12955: </span>    }
<span class="linenr">12956: </span>  }
<span class="linenr">12957: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">finalizeSetupArgumentSignature</span>() {
<span class="linenr">12958: </span>    <span class=
"org-keyword">if</span> (propsTypeDecl) {
<span class="linenr">12959: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">mark as any and only cast on assignment</span>
<span class="linenr">12960: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">since the user defined complex types may be incompatible with the</span>
<span class="linenr">12961: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inferred type from generated runtime declarations</span>
<span class="linenr">12962: </span>      args += <span class=
"org-string">`: any`</span>
<span class="linenr">12963: </span>    }
<span class="linenr">12964: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject user assignment of props</span>
<span class="linenr">12965: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we use a default __props so that template expressions referencing props</span>
<span class="linenr">12966: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">can use it directly</span>
<span class="linenr">12967: </span>    <span class=
"org-keyword">if</span> (propsIdentifier) {
<span class="linenr">12968: </span>      s.prependLeft(
<span class="linenr">12969: </span>        startOffset,
<span class="linenr">12970: </span>        <span class=
"org-string">`\nconst ${propsIdentifier} = __props${</span>
<span class="linenr">12971: </span><span class=
"org-string">          propsTypeDecl ? `</span> as ${genSetupPropsType(propsTypeDecl)}<span class="org-string">` : ``</span>
<span class="linenr">12972: </span><span class=
"org-string">        }\n`</span>
<span class="linenr">12973: </span>      )
<span class="linenr">12974: </span>    }
<span class="linenr">12975: </span>    <span class=
"org-keyword">if</span> (propsDestructureRestId) {
<span class="linenr">12976: </span>      s.prependLeft(
<span class="linenr">12977: </span>        startOffset,
<span class="linenr">12978: </span>        <span class=
"org-string">`\nconst ${propsDestructureRestId} = ${helper(</span>
<span class="linenr">12979: </span><span class=
"org-string">          `</span>createPropsRestProxy<span class=
"org-string">`</span>
<span class="linenr">12980: </span><span class=
"org-string">        )}(__props, ${JSON.stringify(Object.keys(propsDestructuredBindings))})\n`</span>
<span class="linenr">12981: </span>      )
<span class="linenr">12982: </span>    }
<span class="linenr">12983: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject temp variables for async context preservation</span>
<span class="linenr">12984: </span>    <span class=
"org-keyword">if</span> (hasAwait) {
<span class="linenr">12985: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">any</span> = isTS ? <span class=
"org-string">`: any`</span> : <span class="org-string">``</span>
<span class=
"linenr">12986: </span>      s.prependLeft(startOffset, <span class="org-string">`\nlet __temp${any}, __restore${any}\n`</span>)
<span class="linenr">12987: </span>    }
<span class="linenr">12988: </span>  
<span class="linenr">12989: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">destructureElements</span> =
<span class=
"linenr">12990: </span>      hasDefineExposeCall || !options.inlineTemplate ? [<span class="org-string">`expose`</span>] : []
<span class="linenr">12991: </span>    <span class=
"org-keyword">if</span> (emitIdentifier) {
<span class="linenr">12992: </span>      destructureElements.push(
<span class=
"linenr">12993: </span>        emitIdentifier === <span class=
"org-string">`emit`</span> ? <span class=
"org-string">`emit`</span> : <span class=
"org-string">`emit: ${emitIdentifier}`</span>
<span class="linenr">12994: </span>      )
<span class="linenr">12995: </span>    }
<span class="linenr">12996: </span>    <span class=
"org-keyword">if</span> (destructureElements.length) {
<span class="linenr">12997: </span>      args += <span class=
"org-string">`, { ${destructureElements.join(', ')} }`</span>
<span class="linenr">12998: </span>      <span class=
"org-keyword">if</span> (emitsTypeDecl) {
<span class="linenr">12999: </span>        args += <span class=
"org-string">`: { emit: (${scriptSetup.content.slice(</span>
<span class="linenr">13000: </span><span class=
"org-string">          emitsTypeDecl.start,</span>
<span class="linenr">13001: </span><span class=
"org-string">          emitsTypeDecl.end</span>
<span class="linenr">13002: </span><span class=
"org-string">        )}), expose: any, slots: any, attrs: any }`</span>
<span class="linenr">13003: </span>      }
<span class="linenr">13004: </span>    }
<span class="linenr">13005: </span>  }
<span class="linenr">13006: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">finalizeSetupArgumentSignature</span>() {
<span class="linenr">13007: </span>    <span class=
"org-keyword">if</span> (propsTypeDecl) {
<span class="linenr">13008: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">mark as any and only cast on assignment</span>
<span class="linenr">13009: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">since the user defined complex types may be incompatible with the</span>
<span class="linenr">13010: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inferred type from generated runtime declarations</span>
<span class="linenr">13011: </span>      args += <span class=
"org-string">`: any`</span>
<span class="linenr">13012: </span>    }
<span class="linenr">13013: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject user assignment of props</span>
<span class="linenr">13014: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we use a default __props so that template expressions referencing props</span>
<span class="linenr">13015: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">can use it directly</span>
<span class="linenr">13016: </span>    <span class=
"org-keyword">if</span> (propsIdentifier) {
<span class="linenr">13017: </span>      s.prependLeft(
<span class="linenr">13018: </span>        startOffset,
<span class="linenr">13019: </span>        <span class=
"org-string">`\nconst ${propsIdentifier} = __props${</span>
<span class="linenr">13020: </span><span class=
"org-string">          propsTypeDecl ? `</span> as ${genSetupPropsType(propsTypeDecl)}<span class="org-string">` : ``</span>
<span class="linenr">13021: </span><span class=
"org-string">        }\n`</span>
<span class="linenr">13022: </span>      )
<span class="linenr">13023: </span>    }
<span class="linenr">13024: </span>    <span class=
"org-keyword">if</span> (propsDestructureRestId) {
<span class="linenr">13025: </span>      s.prependLeft(
<span class="linenr">13026: </span>        startOffset,
<span class="linenr">13027: </span>        <span class=
"org-string">`\nconst ${propsDestructureRestId} = ${helper(</span>
<span class="linenr">13028: </span><span class=
"org-string">          `</span>createPropsRestProxy<span class=
"org-string">`</span>
<span class="linenr">13029: </span><span class=
"org-string">        )}(__props, ${JSON.stringify(Object.keys(propsDestructuredBindings))})\n`</span>
<span class="linenr">13030: </span>      )
<span class="linenr">13031: </span>    }
<span class="linenr">13032: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject temp variables for async context preservation</span>
<span class="linenr">13033: </span>    <span class=
"org-keyword">if</span> (hasAwait) {
<span class="linenr">13034: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">any</span> = isTS ? <span class=
"org-string">`: any`</span> : <span class="org-string">``</span>
<span class=
"linenr">13035: </span>      s.prependLeft(startOffset, <span class="org-string">`\nlet __temp${any}, __restore${any}\n`</span>)
<span class="linenr">13036: </span>    }
<span class="linenr">13037: </span>  
<span class="linenr">13038: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">destructureElements</span> =
<span class=
"linenr">13039: </span>      hasDefineExposeCall || !options.inlineTemplate ? [<span class="org-string">`expose`</span>] : []
<span class="linenr">13040: </span>    <span class=
"org-keyword">if</span> (emitIdentifier) {
<span class="linenr">13041: </span>      destructureElements.push(
<span class=
"linenr">13042: </span>        emitIdentifier === <span class=
"org-string">`emit`</span> ? <span class=
"org-string">`emit`</span> : <span class=
"org-string">`emit: ${emitIdentifier}`</span>
<span class="linenr">13043: </span>      )
<span class="linenr">13044: </span>    }
<span class="linenr">13045: </span>    <span class=
"org-keyword">if</span> (destructureElements.length) {
<span class="linenr">13046: </span>      args += <span class=
"org-string">`, { ${destructureElements.join(', ')} }`</span>
<span class="linenr">13047: </span>      <span class=
"org-keyword">if</span> (emitsTypeDecl) {
<span class="linenr">13048: </span>        args += <span class=
"org-string">`: { emit: (${scriptSetup.content.slice(</span>
<span class="linenr">13049: </span><span class=
"org-string">          emitsTypeDecl.start,</span>
<span class="linenr">13050: </span><span class=
"org-string">          emitsTypeDecl.end</span>
<span class="linenr">13051: </span><span class=
"org-string">        )}), expose: any, slots: any, attrs: any }`</span>
<span class="linenr">13052: </span>      }
<span class="linenr">13053: </span>    }
<span class="linenr">13054: </span>  }
<span class="linenr">13055: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">generateReturnStatement</span>() {
<span class="linenr">13056: </span>    <span class=
"org-keyword">if</span> (options.inlineTemplate) {
<span class="linenr">13057: </span>      <span class=
"org-keyword">if</span> (sfc.template &amp;& !sfc.template.src) {
<span class="linenr">13058: </span>        <span class=
"org-keyword">if</span> (options.templateOptions &amp;& options.templateOptions.ssr) {
<span class=
"linenr">13059: </span>          hasInlinedSsrRenderFn = <span class="org-constant">true</span>
<span class="linenr">13060: </span>        }
<span class="linenr">13061: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inline render function mode - we are going to compile the template and</span>
<span class="linenr">13062: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inline it right here</span>
<span class="linenr">13063: </span>        <span class=
"org-keyword">const</span> { code, ast, preamble, tips, errors } = compileTemplate({
<span class="linenr">13064: </span>          filename,
<span class=
"linenr">13065: </span>          source: sfc.template.content,
<span class=
"linenr">13066: </span>          inMap: sfc.template.map,
<span class=
"linenr">13067: </span>          ...options.templateOptions,
<span class="linenr">13068: </span>          id: scopeId,
<span class=
"linenr">13069: </span>          scoped: sfc.styles.some(s =&gt; s.scoped),
<span class=
"linenr">13070: </span>          isProd: options.isProd,
<span class=
"linenr">13071: </span>          ssrCssVars: sfc.cssVars,
<span class="linenr">13072: </span>          compilerOptions: {
<span class=
"linenr">13073: </span>            ...(options.templateOptions &amp;&
<span class=
"linenr">13074: </span>              options.templateOptions.compilerOptions),
<span class="linenr">13075: </span>            inline: <span class=
"org-constant">true</span>,
<span class="linenr">13076: </span>            isTS,
<span class="linenr">13077: </span>            bindingMetadata
<span class="linenr">13078: </span>          }
<span class="linenr">13079: </span>        })
<span class="linenr">13080: </span>  
<span class="linenr">13081: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">err</span> = errors[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr">13082: </span>        <span class=
"org-keyword">if</span> (<span class=
"org-keyword">typeof</span> err === <span class=
"org-string">'string'</span>) {
<span class="linenr">13083: </span>          <span class=
"org-keyword">throw</span> <span class=
"org-keyword">new</span> <span class="org-type">Error</span>(err)
<span class="linenr">13084: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (err) {
<span class="linenr">13085: </span>          <span class=
"org-keyword">if</span> (err.loc) {
<span class="linenr">13086: </span>            err.message +=
<span class="linenr">13087: </span>              <span class=
"org-string">`\n\n`</span> +
<span class="linenr">13088: </span>              sfc.filename +
<span class="linenr">13089: </span>              <span class=
"org-string">'\n'</span> +
<span class="linenr">13090: </span>              generateCodeFrame(
<span class="linenr">13091: </span>                source,
<span class=
"linenr">13092: </span>                err.loc.start.offset,
<span class=
"linenr">13093: </span>                err.loc.end.offset
<span class="linenr">13094: </span>              ) +
<span class="linenr">13095: </span>              <span class=
"org-string">`\n`</span>
<span class="linenr">13096: </span>          }
<span class="linenr">13097: </span>          <span class=
"org-keyword">throw</span> err
<span class="linenr">13098: </span>        }
<span class="linenr">13099: </span>        <span class=
"org-keyword">if</span> (preamble) {
<span class="linenr">13100: </span>          s.prepend(preamble)
<span class="linenr">13101: </span>        }
<span class="linenr">13102: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">avoid duplicated unref import</span>
<span class="linenr">13103: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">as this may get injected by the render function preamble OR the</span>
<span class="linenr">13104: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">css vars codegen</span>
<span class="linenr">13105: </span>        <span class=
"org-keyword">if</span> (ast &amp;& ast.helpers.includes(UNREF)) {
<span class=
"linenr">13106: </span>          helperImports.<span class=
"org-keyword">delete</span>(<span class=
"org-string">'unref'</span>)
<span class="linenr">13107: </span>        }
<span class="linenr">13108: </span>        returned = code
<span class="linenr">13109: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">13110: </span>        returned = <span class=
"org-string">`() =&gt; {}`</span>
<span class="linenr">13111: </span>      }
<span class="linenr">13112: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">13113: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">return bindings from script and script setup</span>
<span class="linenr">13114: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">allBindings</span>= {
<span class="linenr">13115: </span>        ...scriptBindings,
<span class="linenr">13116: </span>        ...setupBindings
<span class="linenr">13117: </span>      }
<span class="linenr">13118: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> userImports) {
<span class="linenr">13119: </span>        <span class=
"org-keyword">if</span> (!userImports[key].isType &amp;& userImports[key].isUsedInTemplate) {
<span class=
"linenr">13120: </span>          allBindings[key] = <span class=
"org-constant">true</span>
<span class="linenr">13121: </span>        }
<span class="linenr">13122: </span>      }
<span class="linenr">13123: </span>      returned = <span class=
"org-string">`{ ${Object.keys(allBindings).join(', ')} }`</span>
<span class="linenr">13124: </span>    }
<span class="linenr">13125: </span>  
<span class="linenr">13126: </span>    <span class=
"org-keyword">if</span> (!options.inlineTemplate) {
<span class="linenr">13127: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in non-inline mode, the `__isScriptSetup: true` flag is used by</span>
<span class="linenr">13128: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">componentPublicInstance proxy to allow properties that start with $ or _</span>
<span class="linenr">13129: </span>      s.appendRight(
<span class="linenr">13130: </span>        endOffset,
<span class="linenr">13131: </span>        <span class=
"org-string">`\nconst __returned__ = ${returned}\n`</span> +
<span class="linenr">13132: </span>          <span class=
"org-string">`Object.defineProperty(__returned__, '__isScriptSetup', { enumerable: false, value: true })\n`</span> +
<span class="linenr">13133: </span>          <span class=
"org-string">`return __returned__`</span> +
<span class="linenr">13134: </span>          <span class=
"org-string">`\n}\n\n`</span>
<span class="linenr">13135: </span>      )
<span class="linenr">13136: </span>    } <span class=
"org-keyword">else</span> {
<span class=
"linenr">13137: </span>      s.appendRight(endOffset, <span class=
"org-string">`\nreturn ${returned}\n}\n\n`</span>)
<span class="linenr">13138: </span>    }
<span class="linenr">13139: </span>  }
<span class="linenr">13140: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">finalizeDefaultExport</span>() {
<span class="linenr">13141: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">runtimeOptions</span> = <span class=
"org-string">``</span>
<span class="linenr">13142: </span>    <span class=
"org-keyword">if</span> (hasInlinedSsrRenderFn) {
<span class=
"linenr">13143: </span>      runtimeOptions += <span class=
"org-string">`\n  __ssrInlineRender: true,`</span>
<span class="linenr">13144: </span>    }
<span class="linenr">13145: </span>    <span class=
"org-keyword">if</span> (propsRuntimeDecl) {
<span class="linenr">13146: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">declCode</span> = scriptSetup.content
<span class=
"linenr">13147: </span>        .slice(propsRuntimeDecl.start, propsRuntimeDecl.end)
<span class="linenr">13148: </span>        .trim()
<span class="linenr">13149: </span>      <span class=
"org-keyword">if</span> (propsDestructureDecl) {
<span class="linenr">13150: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">defaults</span> = []
<span class="linenr">13151: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> propsDestructuredBindings) {
<span class="linenr">13152: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">d</span> = genDestructuredDefaultValue(key)
<span class="linenr">13153: </span>          <span class=
"org-keyword">if</span> (d) defaults.push(<span class=
"org-string">`${key}: ${d}`</span>)
<span class="linenr">13154: </span>        }
<span class="linenr">13155: </span>        <span class=
"org-keyword">if</span> (defaults.length) {
<span class=
"linenr">13156: </span>          declCode = <span class="org-string">`${helper(</span>
<span class="linenr">13157: </span><span class=
"org-string">            `</span>mergeDefaults<span class=
"org-string">`</span>
<span class="linenr">13158: </span><span class=
"org-string">          )}(${declCode}, {\n  ${defaults.join(',\n  ')}\n})`</span>
<span class="linenr">13159: </span>        }
<span class="linenr">13160: </span>      }
<span class=
"linenr">13161: </span>      runtimeOptions += <span class=
"org-string">`\n  props: ${declCode},`</span>
<span class="linenr">13162: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (propsTypeDecl) {
<span class=
"linenr">13163: </span>      runtimeOptions += genRuntimeProps(typeDeclaredProps)
<span class="linenr">13164: </span>    }
<span class="linenr">13165: </span>    <span class=
"org-keyword">if</span> (emitsRuntimeDecl) {
<span class=
"linenr">13166: </span>      runtimeOptions += <span class=
"org-string">`\n  emits: ${scriptSetup.content</span>
<span class="linenr">13167: </span><span class=
"org-string">        .slice(emitsRuntimeDecl.start, emitsRuntimeDecl.end)</span>
<span class="linenr">13168: </span><span class=
"org-string">        .trim()},`</span>
<span class="linenr">13169: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (emitsTypeDecl) {
<span class=
"linenr">13170: </span>      runtimeOptions += genRuntimeEmits(typeDeclaredEmits)
<span class="linenr">13171: </span>    }
<span class="linenr">13172: </span>  
<span class="linenr">13173: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;script setup&gt; components are closed by default. If the user did not</span>
<span class="linenr">13174: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">explicitly call `defineExpose`, call expose() with no args.</span>
<span class="linenr">13175: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exposeCall</span> =
<span class=
"linenr">13176: </span>      hasDefineExposeCall || options.inlineTemplate ? <span class="org-string">``</span> : <span class="org-string">`  expose();\n`</span>
<span class="linenr">13177: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">wrap setup code with function.</span>
<span class="linenr">13178: </span>    <span class=
"org-keyword">if</span> (isTS) {
<span class="linenr">13179: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for TS, make sure the exported type is still valid type with</span>
<span class="linenr">13180: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">correct props information</span>
<span class="linenr">13181: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we have to use object spread for types to be merged properly</span>
<span class="linenr">13182: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">user's TS setting should compile it down to proper targets</span>
<span class="linenr">13183: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export default defineComponent({ ...__default__, ... })</span>
<span class="linenr">13184: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">def</span> = defaultExport ? <span class=
"org-string">`\n  ...${DEFAULT_VAR},`</span> : <span class=
"org-string">``</span>
<span class="linenr">13185: </span>      s.prependLeft(
<span class="linenr">13186: </span>        startOffset,
<span class="linenr">13187: </span>        <span class=
"org-string">`\nexport default /*#__PURE__*/${helper(</span>
<span class="linenr">13188: </span><span class=
"org-string">          `</span>defineComponent<span class=
"org-string">`</span>
<span class="linenr">13189: </span><span class=
"org-string">        )}({${def}${runtimeOptions}\n  ${</span>
<span class="linenr">13190: </span><span class=
"org-string">          hasAwait ? `</span><span class=
"org-keyword">async</span> <span class="org-string">` : ``</span>
<span class="linenr">13191: </span><span class=
"org-string">        }setup(${args}) {\n${exposeCall}`</span>
<span class="linenr">13192: </span>      )
<span class=
"linenr">13193: </span>      s.appendRight(endOffset, <span class=
"org-string">`})`</span>)
<span class="linenr">13194: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">13195: </span>      <span class=
"org-keyword">if</span> (defaultExport) {
<span class="linenr">13196: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">without TS, can't rely on rest spread, so we use Object.assign</span>
<span class="linenr">13197: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export default Object.assign(__default__, { ... })</span>
<span class="linenr">13198: </span>        s.prependLeft(
<span class="linenr">13199: </span>          startOffset,
<span class="linenr">13200: </span>          <span class=
"org-string">`\nexport default /*#__PURE__*/Object.assign(${DEFAULT_VAR}, {${runtimeOptions}\n  `</span> +
<span class="linenr">13201: </span>            <span class=
"org-string">`${hasAwait ? `</span><span class=
"org-keyword">async</span> <span class=
"org-string">` : ``}setup(${args}) {\n${exposeCall}`</span>
<span class="linenr">13202: </span>        )
<span class=
"linenr">13203: </span>        s.appendRight(endOffset, <span class="org-string">`})`</span>)
<span class="linenr">13204: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">13205: </span>        s.prependLeft(
<span class="linenr">13206: </span>          startOffset,
<span class="linenr">13207: </span>          <span class=
"org-string">`\nexport default {${runtimeOptions}\n  `</span> +
<span class="linenr">13208: </span>            <span class=
"org-string">`${hasAwait ? `</span><span class=
"org-keyword">async</span> <span class=
"org-string">` : ``}setup(${args}) {\n${exposeCall}`</span>
<span class="linenr">13209: </span>        )
<span class=
"linenr">13210: </span>        s.appendRight(endOffset, <span class="org-string">`}`</span>)
<span class="linenr">13211: </span>      }
<span class="linenr">13212: </span>    }
<span class="linenr">13213: </span>  }
<span class="linenr">13214: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">finalizeVueHelperImports</span>() {
<span class="linenr">13215: </span>    <span class=
"org-keyword">if</span> (helperImports.size &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr">13216: </span>      s.prepend(
<span class="linenr">13217: </span>        <span class=
"org-string">`import { ${[...helperImports]</span>
<span class="linenr">13218: </span><span class=
"org-string">          .map(h =&gt; `</span>${h} as _${h}<span class="org-string">`)</span>
<span class="linenr">13219: </span><span class=
"org-string">          .join(', ')} } from 'vue'\n`</span>
<span class="linenr">13220: </span>      )
<span class="linenr">13221: </span>    }
<span class="linenr">13222: </span>  }
<span class="linenr">13223: </span>
<span class="linenr">13224: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. process normal &lt;script&gt; first if it exists</span>
<span class="linenr">13225: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">scriptAst</span> = processNormalScript()
<span class="linenr">13226: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. parse &lt;script setup&gt; and  walk over top level statements</span>
<span class="linenr">13227: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptSetupAst</span> = processSetupScript()
<span class="linenr">13228: </span>
<span class="linenr">13229: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">3. Apply reactivity transform</span>
<span class="linenr">13230: </span>  applyReactivityTransform()
<span class="linenr">13231: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">4. extract runtime props/emits code from setup context type</span>
<span class="linenr">13232: </span>  extractRuntimePropsEmits()
<span class="linenr">13233: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">5. check useOptions args to make sure it doesn't reference setup scope</span>
<span class="linenr">13234: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">variables</span>
<span class="linenr">13235: </span>  checkUseOptions()
<span class="linenr">13236: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">6. remove non-script content</span>
<span class="linenr">13237: </span>  removeNonScriptContent()
<span class="linenr">13238: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">7. analyze binding metadata</span>
<span class="linenr">13239: </span>  analyzeBindingMetadata()
<span class="linenr">13240: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">8. inject `useCssVars` calls</span>
<span class="linenr">13241: </span>  injectUseCssVarsCalls()
<span class="linenr">13242: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">9. finalize setup() argument signature</span>
<span class="linenr">13243: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">args</span> = <span class=
"org-string">`__props`</span>
<span class=
"linenr">13244: </span>  finalizeSetupArgumentSignature()
<span class="linenr">13245: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">10. generate return statement</span>
<span class="linenr">13246: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">returned</span>
<span class="linenr">13247: </span>  generateReturnStatement()
<span class="linenr">13248: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">11. finalize default export</span>
<span class="linenr">13249: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">runtimeOptions</span> = <span class=
"org-string">''</span>
<span class="linenr">13250: </span>  finalizeDefaultExport()
<span class="linenr">13251: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">12. finalize Vue helper imports</span>
<span class="linenr">13252: </span>  finalizeVueHelperImports()
<span class="linenr">13253: </span>
<span class="linenr">13254: </span>  s.trim()
<span class="linenr">13255: </span>
<span class="linenr">13256: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr">13257: </span>    ...scriptSetup,
<span class="linenr">13258: </span>    bindings: bindingMetadata,
<span class="linenr">13259: </span>    imports: userImports,
<span class="linenr">13260: </span>    content: s.toString(),
<span class="linenr">13261: </span>    map: genSourceMap
<span class="linenr">13262: </span>      ? (s.generateMap({
<span class="linenr">13263: </span>          source: filename,
<span class="linenr">13264: </span>          hires: <span class=
"org-constant">true</span>,
<span class=
"linenr">13265: </span>          includeContent: <span class=
"org-constant">true</span>
<span class="linenr">13266: </span>        }))
<span class="linenr">13267: </span>      : <span class=
"org-constant">undefined</span>,
<span class="linenr">13268: </span>    scriptAst: scriptAst?.body,
<span class=
"linenr">13269: </span>    scriptSetupAst: scriptSetupAst?.body
<span class="linenr">13270: </span>  }
<span class="linenr">13271: </span>}
</pre>
      </div>
    </details>
    <div id="outline-container-org0bf7807" class="outline-2">
      <h2 id="org0bf7807"><span class="section-number-2">1.</span>
      GlobalVars</h2>
      <div class="outline-text-2" id="text-1">
        <br>
        <details class="code-details" style=
        "padding: 1em; background-color: #e5f5e5; /* background-color: pink; */ border-radius: 15px; color: hsl(157 75%); font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;">
          <summary>
            <strong><font face="Courier" size="3" color=
            "green">globalVars</font></strong>
          </summary>
          <div class="org-src-container">
            <pre class="src src-js" id="orge22855a"><span class=
            "linenr"> 1: </span>&lt;&lt;compiler-dom&gt;&gt;
<span class="linenr"> 2: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">__ESM_BROWSER__</span> = <span class=
"org-constant">false</span>, <span class=
"org-variable-name">__GLOBAL__</span> = <span class=
"org-constant">true</span>
<span class="linenr"> 3: </span><span class=
"org-keyword">let</span> <span class=
"org-variable-name">MagicString</span> = require(process.env.NODE_LIB + <span class="org-string">'/magic-string'</span>)
<span class="linenr"> 4: </span>
<span class="linenr"> 5: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">createCache</span>(<span class=
"org-variable-name">size</span> = <span class=
"org-highlight-numbers-number">500</span>) {
<span class="linenr"> 6: </span>  <span class=
"org-keyword">return</span> <span class=
"org-keyword">new</span> <span class="org-type">Map</span>()
<span class="linenr"> 7: </span>}
<span class="linenr"> 8: </span>
<span class="linenr"> 9: </span>&lt;&lt;rewriteDefault&gt;&gt;
<span class=
"linenr">10: </span>&lt;&lt;reactivity-transform&gt;&gt;
<span class="linenr">11: </span>
<span class="linenr">12: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">range</span> = <span class=
"org-highlight-numbers-number">2</span>
<span class="linenr">13: </span>
<span class="linenr">14: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">generateCodeFrame</span>(
<span class="linenr">15: </span>  <span class=
"org-variable-name">source</span>,
<span class="linenr">16: </span>  start = <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr">17: </span>  end = source.length
<span class="linenr">18: </span>) {
<span class="linenr">19: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Split the content into individual lines but capture the newline sequence</span>
<span class="linenr">20: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">that separated each line. This is important because the actual sequence is</span>
<span class="linenr">21: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">needed to properly take into account the full line length for offset</span>
<span class="linenr">22: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">comparison</span>
<span class="linenr">23: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">lines</span> = source.split(<span class=
"org-string">/(\r?\n)/</span>)
<span class="linenr">24: </span>
<span class="linenr">25: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Separate the lines and newline sequences into separate arrays for easier referencing</span>
<span class="linenr">26: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">newlineSequences</span> = lines.filter((_, idx) =&gt; idx % <span class="org-highlight-numbers-number">2</span> === <span class="org-highlight-numbers-number">1</span>)
<span class=
"linenr">27: </span>  lines = lines.filter((_, idx) =&gt; idx % <span class="org-highlight-numbers-number">2</span> === <span class="org-highlight-numbers-number">0</span>)
<span class="linenr">28: </span>
<span class="linenr">29: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">count</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">30: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">res</span> = []
<span class="linenr">31: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; lines.length; i++) {
<span class="linenr">32: </span>    count +=
<span class="linenr">33: </span>      lines[i].length +
<span class=
"linenr">34: </span>      ((newlineSequences[i] &amp;& newlineSequences[i].length) || <span class="org-highlight-numbers-number">0</span>)
<span class="linenr">35: </span>    <span class=
"org-keyword">if</span> (count &gt;= start) {
<span class="linenr">36: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">j</span> = i - range; j &lt;= i + range || end &gt; count; j++) {
<span class="linenr">37: </span>        <span class=
"org-keyword">if</span> (j &lt; <span class=
"org-highlight-numbers-number">0</span> || j &gt;= lines.length) <span class="org-keyword">continue</span>
<span class="linenr">38: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">line</span> = j + <span class=
"org-highlight-numbers-number">1</span>
<span class="linenr">39: </span>        res.push(
<span class="linenr">40: </span>          <span class=
"org-string">`${line}${' '.repeat(Math.max(3 - String(line).length, 0))}|  ${</span>
<span class="linenr">41: </span><span class=
"org-string">            lines[j]</span>
<span class="linenr">42: </span><span class=
"org-string">          }`</span>
<span class="linenr">43: </span>        )
<span class="linenr">44: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">lineLength</span> = lines[j].length
<span class="linenr">45: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">newLineSeqLength</span> =
<span class=
"linenr">46: </span>          (newlineSequences[j] &amp;& newlineSequences[j].length) || <span class="org-highlight-numbers-number">0</span>
<span class="linenr">47: </span>
<span class="linenr">48: </span>        <span class=
"org-keyword">if</span> (j === i) {
<span class="linenr">49: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">push underline</span>
<span class="linenr">50: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">pad</span> = start - (count - (lineLength + newLineSeqLength))
<span class="linenr">51: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">length</span> = Math.max(
<span class="linenr">52: </span>            <span class=
"org-highlight-numbers-number">1</span>,
<span class=
"linenr">53: </span>            end &gt; count ? lineLength - pad : end - start
<span class="linenr">54: </span>          )
<span class="linenr">55: </span>          res.push(<span class=
"org-string">`   |  `</span> + <span class=
"org-string">' '</span>.repeat(pad) + <span class=
"org-string">'^'</span>.repeat(length))
<span class="linenr">56: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (j &gt; i) {
<span class="linenr">57: </span>          <span class=
"org-keyword">if</span> (end &gt; count) {
<span class="linenr">58: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">length</span> = Math.max(Math.min(end - count, lineLength), <span class="org-highlight-numbers-number">1</span>)
<span class="linenr">59: </span>            res.push(<span class=
"org-string">`   |  `</span> + <span class=
"org-string">'^'</span>.repeat(length))
<span class="linenr">60: </span>          }
<span class="linenr">61: </span>
<span class=
"linenr">62: </span>          count += lineLength + newLineSeqLength
<span class="linenr">63: </span>        }
<span class="linenr">64: </span>      }
<span class="linenr">65: </span>      <span class=
"org-keyword">break</span>
<span class="linenr">66: </span>    }
<span class="linenr">67: </span>  }
<span class="linenr">68: </span>  <span class=
"org-keyword">return</span> res.join(<span class=
"org-string">'\n'</span>)
<span class="linenr">69: </span>}
<span class="linenr">70: </span>
</pre>
          </div>
        </details>
      </div>
      <div id="outline-container-org9139d8f" class="outline-3">
        <h3 id="org9139d8f"><span class=
        "section-number-3">1.1.</span> reactivity-transform</h3>
        <div class="outline-text-3" id="text-1-1">
          <p><a href=
          "https://github.com/vuejs/core/blob/main/packages/reactivity-transform/README.md">
          core/README.md at main · vuejs/core</a></p>
          <p>这个包的作用是转换一些 <code>script setup</code> 中自定义的一些新语法，如：
          <code>$ref()</code>, <code>$computed</code>,
          <code>$shallowRef()</code>, <code>$customRef()</code>,
          <code>$toRef()</code>, 语法糖，可以减少 <code>import ... from
          "vue"</code> 语法。</p>
          <div class="org-src-container">
            <pre class="src src-js" id="orgb655616"><span class=
            "linenr">  1: </span><span class=
            "org-keyword">const</span> <span class=
            "org-variable-name">RT</span> = (<span class=
            "org-keyword">function</span>() {
<span class="linenr">  2: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">CONVERT_SYMBOL</span> = <span class=
"org-string">'$'</span>
<span class="linenr">  3: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">ESCAPE_SYMBOL</span> = <span class=
"org-string">'$$'</span>
<span class="linenr">  4: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">shorthands</span> = [<span class=
"org-string">'ref'</span>, <span class=
"org-string">'computed'</span>, <span class=
"org-string">'shallowRef'</span>, <span class=
"org-string">'toRef'</span>, <span class=
"org-string">'customRef'</span>]
<span class="linenr">  5: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformCheckRE</span> = <span class=
"org-string">/[^\w]\$(?:\$|ref|computed|shallowRef)?\s*(\(|\&lt;)/</span>
<span class="linenr">  6: </span>
<span class="linenr">  7: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">shouldTransform</span>(<span class=
"org-variable-name">src</span>) {
<span class="linenr">  8: </span>  <span class=
"org-keyword">return</span> transformCheckRE.test(src)
<span class="linenr">  9: </span>}
<span class="linenr"> 10: </span>
<span class="linenr"> 11: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">transform</span>(
<span class="linenr"> 12: </span>  <span class=
"org-variable-name">src</span>,
<span class="linenr"> 13: </span>  {
<span class="linenr"> 14: </span>    filename,
<span class="linenr"> 15: </span>    sourceMap,
<span class="linenr"> 16: </span>    parserPlugins,
<span class=
"linenr"> 17: </span>    importHelpersFrom = <span class=
"org-string">'vue'</span>
<span class="linenr"> 18: </span>  } = {}
<span class="linenr"> 19: </span>) {
<span class="linenr"> 20: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">plugins</span> = parserPlugins || []
<span class="linenr"> 21: </span>  <span class=
"org-keyword">if</span> (filename) {
<span class="linenr"> 22: </span>    <span class=
"org-keyword">if</span> (<span class=
"org-string">/\.tsx?$/</span>.test(filename)) {
<span class="linenr"> 23: </span>      plugins.push(<span class=
"org-string">'typescript'</span>)
<span class="linenr"> 24: </span>    }
<span class="linenr"> 25: </span>    <span class=
"org-keyword">if</span> (filename.endsWith(<span class=
"org-string">'x'</span>)) {
<span class="linenr"> 26: </span>      plugins.push(<span class=
"org-string">'jsx'</span>)
<span class="linenr"> 27: </span>    }
<span class="linenr"> 28: </span>  }
<span class="linenr"> 29: </span>
<span class="linenr"> 30: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ast</span> = babelParser.parse(src, {
<span class="linenr"> 31: </span>    sourceType: <span class=
"org-string">'module'</span>,
<span class="linenr"> 32: </span>    plugins
<span class="linenr"> 33: </span>  })
<span class="linenr"> 34: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">s</span> = <span class=
"org-keyword">new</span> <span class=
"org-type">MagicString</span>(src)
<span class="linenr"> 35: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">res</span> = transformAST(ast.program, s, <span class="org-highlight-numbers-number">0</span>)
<span class="linenr"> 36: </span>
<span class="linenr"> 37: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject helper imports</span>
<span class="linenr"> 38: </span>  <span class=
"org-keyword">if</span> (res.importedHelpers.length) {
<span class="linenr"> 39: </span>    s.prepend(
<span class="linenr"> 40: </span>      <span class=
"org-string">`import { ${res.importedHelpers</span>
<span class="linenr"> 41: </span><span class=
"org-string">        .map(h =&gt; `</span>${h} as _${h}<span class=
"org-string">`)</span>
<span class="linenr"> 42: </span><span class=
"org-string">        .join(', ')} } from '${importHelpersFrom}'\n`</span>
<span class="linenr"> 43: </span>    )
<span class="linenr"> 44: </span>  }
<span class="linenr"> 45: </span>
<span class="linenr"> 46: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 47: </span>    ...res,
<span class="linenr"> 48: </span>    code: s.toString(),
<span class="linenr"> 49: </span>    map: sourceMap
<span class="linenr"> 50: </span>      ? s.generateMap({
<span class="linenr"> 51: </span>          source: filename,
<span class="linenr"> 52: </span>          hires: <span class=
"org-constant">true</span>,
<span class=
"linenr"> 53: </span>          includeContent: <span class=
"org-constant">true</span>
<span class="linenr"> 54: </span>        })
<span class="linenr"> 55: </span>      : <span class=
"org-constant">null</span>
<span class="linenr"> 56: </span>  }
<span class="linenr"> 57: </span>}
<span class="linenr"> 58: </span>
<span class="linenr"> 59: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">transformAST</span>(
<span class="linenr"> 60: </span>  <span class=
"org-variable-name">ast</span>,
<span class="linenr"> 61: </span>  <span class=
"org-variable-name">s</span>,
<span class="linenr"> 62: </span>  offset = <span class=
"org-highlight-numbers-number">0</span>,
<span class="linenr"> 63: </span>  <span class=
"org-variable-name">knownRefs</span>,
<span class="linenr"> 64: </span>  knownProps
<span class="linenr"> 65: </span>) {
<span class="linenr"> 66: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">convertSymbol</span> = CONVERT_SYMBOL
<span class="linenr"> 67: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">escapeSymbol</span> = ESCAPE_SYMBOL
<span class="linenr"> 68: </span>
<span class="linenr"> 69: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">macro import handling</span>
<span class="linenr"> 70: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> <span class=
"org-keyword">of</span> ast.body) {
<span class="linenr"> 71: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr"> 72: </span>      node.type === <span class=
"org-string">'ImportDeclaration'</span> &amp;&
<span class=
"linenr"> 73: </span>      node.source.value === <span class=
"org-string">'vue/macros'</span>
<span class="linenr"> 74: </span>    ) {
<span class="linenr"> 75: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">remove macro imports</span>
<span class=
"linenr"> 76: </span>      s.remove(node.start + offset, node.end + offset)
<span class="linenr"> 77: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check aliasing</span>
<span class="linenr"> 78: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">specifier</span> <span class=
"org-keyword">of</span> node.specifiers) {
<span class="linenr"> 79: </span>        <span class=
"org-keyword">if</span> (specifier.type === <span class=
"org-string">'ImportSpecifier'</span>) {
<span class="linenr"> 80: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">imported</span> = specifier.imported.name
<span class="linenr"> 81: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">local</span> = specifier.local.name
<span class="linenr"> 82: </span>          <span class=
"org-keyword">if</span> (local !== imported) {
<span class="linenr"> 83: </span>            <span class=
"org-keyword">if</span> (imported === ESCAPE_SYMBOL) {
<span class="linenr"> 84: </span>              escapeSymbol = local
<span class="linenr"> 85: </span>            } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (imported === CONVERT_SYMBOL) {
<span class=
"linenr"> 86: </span>              convertSymbol = local
<span class="linenr"> 87: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr"> 88: </span>              error(
<span class="linenr"> 89: </span>                <span class=
"org-string">`macro imports for ref-creating methods do not support aliasing.`</span>,
<span class="linenr"> 90: </span>                specifier
<span class="linenr"> 91: </span>              )
<span class="linenr"> 92: </span>            }
<span class="linenr"> 93: </span>          }
<span class="linenr"> 94: </span>        }
<span class="linenr"> 95: </span>      }
<span class="linenr"> 96: </span>    }
<span class="linenr"> 97: </span>  }
<span class="linenr"> 98: </span>
<span class="linenr"> 99: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">importedHelpers</span> = <span class=
"org-keyword">new</span> <span class="org-type">Set</span>()
<span class="linenr">100: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">rootScope</span> = {}
<span class="linenr">101: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scopeStack</span> = [rootScope]
<span class="linenr">102: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">currentScope</span> = rootScope
<span class="linenr">103: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">escapeScope</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inside $$()</span>
<span class="linenr">104: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">excludedIds</span> = <span class=
"org-keyword">new</span> <span class="org-type">WeakSet</span>()
<span class="linenr">105: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">parentStack</span> = []
<span class="linenr">106: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">propsLocalToPublicMap</span> = Object.create(<span class="org-constant">null</span>)
<span class="linenr">107: </span>
<span class="linenr">108: </span>  <span class=
"org-keyword">if</span> (knownRefs) {
<span class="linenr">109: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">of</span> knownRefs) {
<span class=
"linenr">110: </span>      rootScope[key] = <span class="org-constant">true</span>
<span class="linenr">111: </span>    }
<span class="linenr">112: </span>  }
<span class="linenr">113: </span>  <span class=
"org-keyword">if</span> (knownProps) {
<span class="linenr">114: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> knownProps) {
<span class="linenr">115: </span>      <span class=
"org-keyword">const</span> { local } = knownProps[key]
<span class=
"linenr">116: </span>      rootScope[local] = <span class=
"org-string">'prop'</span>
<span class=
"linenr">117: </span>      propsLocalToPublicMap[local] = key
<span class="linenr">118: </span>    }
<span class="linenr">119: </span>  }
<span class="linenr">120: </span>
<span class="linenr">121: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">isRefCreationCall</span>(<span class=
"org-variable-name">callee</span>) {
<span class="linenr">122: </span>    <span class=
"org-keyword">if</span> (callee === convertSymbol) {
<span class="linenr">123: </span>      <span class=
"org-keyword">return</span> convertSymbol
<span class="linenr">124: </span>    }
<span class="linenr">125: </span>    <span class=
"org-keyword">if</span> (callee[<span class=
"org-highlight-numbers-number">0</span>] === <span class=
"org-string">'$'</span> &amp;& shorthands.includes(callee.slice(<span class="org-highlight-numbers-number">1</span>))) {
<span class="linenr">126: </span>      <span class=
"org-keyword">return</span> callee
<span class="linenr">127: </span>    }
<span class="linenr">128: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">129: </span>  }
<span class="linenr">130: </span>
<span class="linenr">131: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">error</span>(<span class=
"org-variable-name">msg</span>, <span class=
"org-variable-name">node</span>) {
<span class="linenr">132: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">e</span> = <span class=
"org-keyword">new</span> <span class="org-type">Error</span>(msg)
<span class="linenr">133: </span>    e.node = node
<span class="linenr">134: </span>    <span class=
"org-keyword">throw</span> e
<span class="linenr">135: </span>  }
<span class="linenr">136: </span>
<span class="linenr">137: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">helper</span>(<span class=
"org-variable-name">msg</span>) {
<span class="linenr">138: </span>    importedHelpers.add(msg)
<span class="linenr">139: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`_${msg}`</span>
<span class="linenr">140: </span>  }
<span class="linenr">141: </span>
<span class="linenr">142: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">registerBinding</span>(<span class=
"org-variable-name">id</span>, <span class=
"org-variable-name">isRef</span> = <span class=
"org-constant">false</span>) {
<span class="linenr">143: </span>    excludedIds.add(id)
<span class="linenr">144: </span>    <span class=
"org-keyword">if</span> (currentScope) {
<span class=
"linenr">145: </span>      currentScope[id.name] = isRef
<span class="linenr">146: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">147: </span>      error(
<span class="linenr">148: </span>        <span class=
"org-string">'registerBinding called without active scope, something is wrong.'</span>,
<span class="linenr">149: </span>        id
<span class="linenr">150: </span>      )
<span class="linenr">151: </span>    }
<span class="linenr">152: </span>  }
<span class="linenr">153: </span>
<span class="linenr">154: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">registerRefBinding</span> = (id) =&gt; registerBinding(id, <span class="org-constant">true</span>)
<span class="linenr">155: </span>
<span class="linenr">156: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">tempVarCount</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr">157: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">genTempVar</span>() {
<span class="linenr">158: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`__$temp_${++tempVarCount}`</span>
<span class="linenr">159: </span>  }
<span class="linenr">160: </span>
<span class="linenr">161: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">snip</span>(<span class=
"org-variable-name">nod</span>) {
<span class="linenr">162: </span>    <span class=
"org-keyword">return</span> s.original.slice(node.start + offset, node.end + offset)
<span class="linenr">163: </span>  }
<span class="linenr">164: </span>
<span class="linenr">165: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">walkScope</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">isRoot</span> = <span class=
"org-constant">false</span>) {
<span class="linenr">166: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">stmt</span> <span class=
"org-keyword">of</span> node.body) {
<span class="linenr">167: </span>      <span class=
"org-keyword">if</span> (stmt.type === <span class=
"org-string">'VariableDeclaration'</span>) {
<span class=
"linenr">168: </span>        walkVariableDeclaration(stmt, isRoot)
<span class="linenr">169: </span>      } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class="linenr">170: </span>        stmt.type === <span class=
"org-string">'FunctionDeclaration'</span> ||
<span class="linenr">171: </span>        stmt.type === <span class=
"org-string">'ClassDeclaration'</span>
<span class="linenr">172: </span>      ) {
<span class="linenr">173: </span>        <span class=
"org-keyword">if</span> (stmt.declare || !stmt.id) <span class=
"org-keyword">continue</span>
<span class="linenr">174: </span>        registerBinding(stmt.id)
<span class="linenr">175: </span>      } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr">176: </span>        (stmt.type === <span class="org-string">'ForOfStatement'</span> || stmt.type === <span class="org-string">'ForInStatement'</span>) &amp;&
<span class=
"linenr">177: </span>        stmt.left.type === <span class=
"org-string">'VariableDeclaration'</span>
<span class="linenr">178: </span>      ) {
<span class=
"linenr">179: </span>        walkVariableDeclaration(stmt.left)
<span class="linenr">180: </span>      } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class="linenr">181: </span>        stmt.type === <span class=
"org-string">'ExportNamedDeclaration'</span> &amp;&
<span class="linenr">182: </span>        stmt.declaration &amp;&
<span class=
"linenr">183: </span>        stmt.declaration.type === <span class=
"org-string">'VariableDeclaration'</span>
<span class="linenr">184: </span>      ) {
<span class=
"linenr">185: </span>        walkVariableDeclaration(stmt.declaration, isRoot)
<span class="linenr">186: </span>      } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class="linenr">187: </span>        stmt.type === <span class=
"org-string">'LabeledStatement'</span> &amp;&
<span class=
"linenr">188: </span>        stmt.body.type === <span class=
"org-string">'VariableDeclaration'</span>
<span class="linenr">189: </span>      ) {
<span class=
"linenr">190: </span>        walkVariableDeclaration(stmt.body, isRoot)
<span class="linenr">191: </span>      }
<span class="linenr">192: </span>    }
<span class="linenr">193: </span>  }
<span class="linenr">194: </span>
<span class="linenr">195: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">walkVariableDeclaration</span>(<span class=
"org-variable-name">stmt</span>, <span class=
"org-variable-name">isRoot</span> = <span class=
"org-constant">false</span>) {
<span class="linenr">196: </span>    <span class=
"org-keyword">if</span> (stmt.declare) {
<span class="linenr">197: </span>      <span class=
"org-keyword">return</span>
<span class="linenr">198: </span>    }
<span class="linenr">199: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">decl</span> <span class=
"org-keyword">of</span> stmt.declarations) {
<span class="linenr">200: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">refCall</span>
<span class="linenr">201: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isCall</span> =
<span class="linenr">202: </span>        decl.init &amp;&
<span class=
"linenr">203: </span>        decl.init.type === <span class=
"org-string">'CallExpression'</span> &amp;&
<span class=
"linenr">204: </span>        decl.init.callee.type === <span class=
"org-string">'Identifier'</span>
<span class="linenr">205: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr">206: </span>        isCall &amp;&
<span class=
"linenr">207: </span>        (refCall = isRefCreationCall(decl.init.callee.name))
<span class="linenr">208: </span>      ) {
<span class=
"linenr">209: </span>        processRefDeclaration(refCall, decl.id, decl.init)
<span class="linenr">210: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">211: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isProps</span> =
<span class=
"linenr">212: </span>          isRoot &amp;& isCall &amp;& decl.init.callee.name === <span class="org-string">'defineProps'</span>
<span class="linenr">213: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">id</span> <span class=
"org-keyword">of</span> extractIdentifiers(decl.id)) {
<span class="linenr">214: </span>          <span class=
"org-keyword">if</span> (isProps) {
<span class="linenr">215: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for defineProps destructure, only exclude them since they</span>
<span class="linenr">216: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">are already passed in as knownProps</span>
<span class="linenr">217: </span>            excludedIds.add(id)
<span class="linenr">218: </span>          } <span class=
"org-keyword">else</span> {
<span class="linenr">219: </span>            registerBinding(id)
<span class="linenr">220: </span>          }
<span class="linenr">221: </span>        }
<span class="linenr">222: </span>      }
<span class="linenr">223: </span>    }
<span class="linenr">224: </span>  }
<span class="linenr">225: </span>
<span class="linenr">226: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">processRefDeclaration</span>(<span class=
"org-variable-name">method</span>, <span class=
"org-variable-name">id</span>, <span class=
"org-variable-name">call</span>) {
<span class="linenr">227: </span>    excludedIds.add(call.callee)
<span class="linenr">228: </span>    <span class=
"org-keyword">if</span> (method === convertSymbol) {
<span class="linenr">229: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">$</span>
<span class="linenr">230: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">remove macro</span>
<span class=
"linenr">231: </span>      s.remove(call.callee.start + offset, call.callee.end + offset)
<span class="linenr">232: </span>      <span class=
"org-keyword">if</span> (id.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">233: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">single variable</span>
<span class="linenr">234: </span>        registerRefBinding(id)
<span class="linenr">235: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (id.type === <span class=
"org-string">'ObjectPattern'</span>) {
<span class=
"linenr">236: </span>        processRefObjectPattern(id, call)
<span class="linenr">237: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (id.type === <span class=
"org-string">'ArrayPattern'</span>) {
<span class=
"linenr">238: </span>        processRefArrayPattern(id, call)
<span class="linenr">239: </span>      }
<span class="linenr">240: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">241: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">shorthands</span>
<span class="linenr">242: </span>      <span class=
"org-keyword">if</span> (id.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">243: </span>        registerRefBinding(id)
<span class="linenr">244: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">replace call</span>
<span class="linenr">245: </span>        s.overwrite(
<span class="linenr">246: </span>          call.start + offset,
<span class=
"linenr">247: </span>          call.start + method.length + offset,
<span class=
"linenr">248: </span>          helper(method.slice(<span class=
"org-highlight-numbers-number">1</span>))
<span class="linenr">249: </span>        )
<span class="linenr">250: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">251: </span>        error(<span class=
"org-string">`${method}() cannot be used with destructure patterns.`</span>, call)
<span class="linenr">252: </span>      }
<span class="linenr">253: </span>    }
<span class="linenr">254: </span>  }
<span class="linenr">255: </span>
<span class="linenr">256: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">processRefObjectPattern</span>(<span class=
"org-variable-name">pattern</span>, <span class=
"org-variable-name">call</span>, <span class=
"org-variable-name">tempVar</span>, <span class=
"org-variable-name">path</span> = []) {
<span class="linenr">257: </span>    <span class=
"org-keyword">if</span> (!tempVar) {
<span class="linenr">258: </span>      tempVar = genTempVar()
<span class="linenr">259: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">const { x } = $(useFoo()) --&gt; const __$temp_1 = useFoo()</span>
<span class=
"linenr">260: </span>      s.overwrite(pattern.start + offset, pattern.end + offset, tempVar)
<span class="linenr">261: </span>    }
<span class="linenr">262: </span>
<span class="linenr">263: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> <span class=
"org-keyword">of</span> pattern.properties) {
<span class="linenr">264: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">nameId</span>
<span class="linenr">265: </span>      <span class=
"org-keyword">let</span> <span class="org-variable-name">key</span>
<span class="linenr">266: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">defaultValue</span>
<span class="linenr">267: </span>      <span class=
"org-keyword">if</span> (p.type === <span class=
"org-string">'ObjectProperty'</span>) {
<span class="linenr">268: </span>        <span class=
"org-keyword">if</span> (p.key.start === p.value.start) {
<span class="linenr">269: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">shorthand { foo }</span>
<span class="linenr">270: </span>          nameId = p.key
<span class="linenr">271: </span>          <span class=
"org-keyword">if</span> (p.value.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">272: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">avoid shorthand value identifier from being processed</span>
<span class=
"linenr">273: </span>            excludedIds.add(p.value)
<span class="linenr">274: </span>          } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr">275: </span>            p.value.type === <span class=
"org-string">'AssignmentPattern'</span> &amp;&
<span class=
"linenr">276: </span>            p.value.left.type === <span class=
"org-string">'Identifier'</span>
<span class="linenr">277: </span>          ) {
<span class="linenr">278: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">{ foo = 1 }</span>
<span class=
"linenr">279: </span>            excludedIds.add(p.value.left)
<span class=
"linenr">280: </span>            defaultValue = p.value.right
<span class="linenr">281: </span>          }
<span class="linenr">282: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr">283: </span>          key = p.computed ? p.key : p.key.name
<span class="linenr">284: </span>          <span class=
"org-keyword">if</span> (p.value.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">285: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">{ foo: bar }</span>
<span class="linenr">286: </span>            nameId = p.value
<span class="linenr">287: </span>          } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.value.type === <span class=
"org-string">'ObjectPattern'</span>) {
<span class=
"linenr">288: </span>            processRefObjectPattern(p.value, call, tempVar, [...path, key])
<span class="linenr">289: </span>          } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.value.type === <span class=
"org-string">'ArrayPattern'</span>) {
<span class=
"linenr">290: </span>            processRefArrayPattern(p.value, call, tempVar, [...path, key])
<span class="linenr">291: </span>          } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.value.type === <span class=
"org-string">'AssignmentPattern'</span>) {
<span class="linenr">292: </span>            <span class=
"org-keyword">if</span> (p.value.left.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">293: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">{ foo: bar = 1 }</span>
<span class=
"linenr">294: </span>              nameId = p.value.left
<span class=
"linenr">295: </span>              defaultValue = p.value.right
<span class="linenr">296: </span>            } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.value.left.type === <span class=
"org-string">'ObjectPattern'</span>) {
<span class=
"linenr">297: </span>              processRefObjectPattern(p.value.left, call, tempVar, [
<span class="linenr">298: </span>                ...path,
<span class=
"linenr">299: </span>                [key, p.value.right]
<span class="linenr">300: </span>              ])
<span class="linenr">301: </span>            } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (p.value.left.type === <span class=
"org-string">'ArrayPattern'</span>) {
<span class=
"linenr">302: </span>              processRefArrayPattern(p.value.left, call, tempVar, [
<span class="linenr">303: </span>                ...path,
<span class=
"linenr">304: </span>                [key, p.value.right]
<span class="linenr">305: </span>              ])
<span class="linenr">306: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr">307: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">MemberExpression case is not possible here, ignore</span>
<span class="linenr">308: </span>            }
<span class="linenr">309: </span>          }
<span class="linenr">310: </span>        }
<span class="linenr">311: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">312: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">rest element { ...foo }</span>
<span class="linenr">313: </span>        error(<span class=
"org-string">`reactivity destructure does not support rest elements.`</span>, p)
<span class="linenr">314: </span>      }
<span class="linenr">315: </span>      <span class=
"org-keyword">if</span> (nameId) {
<span class="linenr">316: </span>        registerRefBinding(nameId)
<span class="linenr">317: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject toRef() after original replaced pattern</span>
<span class="linenr">318: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = pathToString(tempVar, path)
<span class="linenr">319: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keyStr</span> = isString(key)
<span class="linenr">320: </span>          ? <span class=
"org-string">`'${key}'`</span>
<span class="linenr">321: </span>          : key
<span class="linenr">322: </span>          ? snip(key)
<span class="linenr">323: </span>          : <span class=
"org-string">`'${nameId.name}'`</span>
<span class="linenr">324: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">defaultStr</span> = defaultValue ? <span class=
"org-string">`, ${snip(defaultValue)}`</span> : <span class=
"org-string">``</span>
<span class="linenr">325: </span>        s.appendLeft(
<span class="linenr">326: </span>          call.end + offset,
<span class="linenr">327: </span>          <span class=
"org-string">`,\n  ${nameId.name} = ${helper(</span>
<span class="linenr">328: </span><span class=
"org-string">            'toRef'</span>
<span class="linenr">329: </span><span class=
"org-string">          )}(${source}, ${keyStr}${defaultStr})`</span>
<span class="linenr">330: </span>        )
<span class="linenr">331: </span>      }
<span class="linenr">332: </span>    }
<span class="linenr">333: </span>  }
<span class="linenr">334: </span>
<span class="linenr">335: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">processRefArrayPattern</span>(<span class=
"org-variable-name">pattern</span>, <span class=
"org-variable-name">call</span>, <span class=
"org-variable-name">tempVar</span>, <span class=
"org-variable-name">path</span> = []) {
<span class="linenr">336: </span>    <span class=
"org-keyword">if</span> (!tempVar) {
<span class="linenr">337: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">const [x] = $(useFoo()) --&gt; const __$temp_1 = useFoo()</span>
<span class="linenr">338: </span>      tempVar = genTempVar()
<span class=
"linenr">339: </span>      s.overwrite(pattern.start + offset, pattern.end + offset, tempVar)
<span class="linenr">340: </span>    }
<span class="linenr">341: </span>
<span class="linenr">342: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; pattern.elements.length; i++) {
<span class="linenr">343: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">e</span> = pattern.elements[i]
<span class="linenr">344: </span>      <span class=
"org-keyword">if</span> (!e) <span class=
"org-keyword">continue</span>
<span class="linenr">345: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">nameId</span>
<span class="linenr">346: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">defaultValue</span>
<span class="linenr">347: </span>      <span class=
"org-keyword">if</span> (e.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">348: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">[a] --&gt; [__a]</span>
<span class="linenr">349: </span>        nameId = e
<span class="linenr">350: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (e.type === <span class=
"org-string">'AssignmentPattern'</span>) {
<span class="linenr">351: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">[a = 1]</span>
<span class="linenr">352: </span>        nameId = e.left
<span class="linenr">353: </span>        defaultValue = e.right
<span class="linenr">354: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (e.type === <span class=
"org-string">'RestElement'</span>) {
<span class="linenr">355: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">[...a]</span>
<span class="linenr">356: </span>        error(<span class=
"org-string">`reactivity destructure does not support rest elements.`</span>, e)
<span class="linenr">357: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (e.type === <span class=
"org-string">'ObjectPattern'</span>) {
<span class=
"linenr">358: </span>        processRefObjectPattern(e, call, tempVar, [...path, i])
<span class="linenr">359: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (e.type === <span class=
"org-string">'ArrayPattern'</span>) {
<span class=
"linenr">360: </span>        processRefArrayPattern(e, call, tempVar, [...path, i])
<span class="linenr">361: </span>      }
<span class="linenr">362: </span>      <span class=
"org-keyword">if</span> (nameId) {
<span class="linenr">363: </span>        registerRefBinding(nameId)
<span class="linenr">364: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject toRef() after original replaced pattern</span>
<span class="linenr">365: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = pathToString(tempVar, path)
<span class="linenr">366: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">defaultStr</span> = defaultValue ? <span class=
"org-string">`, ${snip(defaultValue)}`</span> : <span class=
"org-string">``</span>
<span class="linenr">367: </span>        s.appendLeft(
<span class="linenr">368: </span>          call.end + offset,
<span class="linenr">369: </span>          <span class=
"org-string">`,\n  ${nameId.name} = ${helper(</span>
<span class="linenr">370: </span><span class=
"org-string">            'toRef'</span>
<span class="linenr">371: </span><span class=
"org-string">          )}(${source}, ${i}${defaultStr})`</span>
<span class="linenr">372: </span>        )
<span class="linenr">373: </span>      }
<span class="linenr">374: </span>    }
<span class="linenr">375: </span>  }
<span class="linenr">376: </span>
<span class="linenr">377: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">pathToString</span>(<span class=
"org-variable-name">source</span>, <span class=
"org-variable-name">path</span>) {
<span class="linenr">378: </span>    <span class=
"org-keyword">if</span> (path.length) {
<span class="linenr">379: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">seg</span> <span class=
"org-keyword">of</span> path) {
<span class="linenr">380: </span>        <span class=
"org-keyword">if</span> (isArray(seg)) {
<span class="linenr">381: </span>          source = <span class=
"org-string">`(${source}${segToString(seg[0])} || ${snip(seg[1])})`</span>
<span class="linenr">382: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr">383: </span>          source += segToString(seg)
<span class="linenr">384: </span>        }
<span class="linenr">385: </span>      }
<span class="linenr">386: </span>    }
<span class="linenr">387: </span>    <span class=
"org-keyword">return</span> source
<span class="linenr">388: </span>  }
<span class="linenr">389: </span>
<span class="linenr">390: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">segToString</span>(<span class=
"org-variable-name">seg</span>) {
<span class="linenr">391: </span>    <span class=
"org-keyword">if</span> (<span class=
"org-keyword">typeof</span> seg === <span class=
"org-string">'number'</span>) {
<span class="linenr">392: </span>      <span class=
"org-keyword">return</span> <span class=
"org-string">`[${seg}]`</span>
<span class="linenr">393: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (<span class=
"org-keyword">typeof</span> seg === <span class=
"org-string">'string'</span>) {
<span class="linenr">394: </span>      <span class=
"org-keyword">return</span> <span class=
"org-string">`.${seg}`</span>
<span class="linenr">395: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">396: </span>      <span class=
"org-keyword">return</span> snip(seg)
<span class="linenr">397: </span>    }
<span class="linenr">398: </span>  }
<span class="linenr">399: </span>
<span class="linenr">400: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">rewriteId</span>(<span class=
"org-variable-name">scope</span>, <span class=
"org-variable-name">id</span>, <span class=
"org-variable-name">parent</span>, <span class=
"org-variable-name">parentStack</span>) {
<span class="linenr">401: </span>    <span class=
"org-keyword">if</span> (hasOwn(scope, id.name)) {
<span class="linenr">402: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bindingType</span> = scope[id.name]
<span class="linenr">403: </span>      <span class=
"org-keyword">if</span> (bindingType) {
<span class="linenr">404: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isProp</span> = bindingType === <span class=
"org-string">'prop'</span>
<span class="linenr">405: </span>        <span class=
"org-keyword">if</span> (isStaticProperty(parent) &amp;& parent.shorthand) {
<span class="linenr">406: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">let binding used in a property shorthand</span>
<span class="linenr">407: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip for destructure patterns</span>
<span class="linenr">408: </span>          <span class=
"org-keyword">if</span> (
<span class="linenr">409: </span>            !parent.inPattern ||
<span class=
"linenr">410: </span>            isInDestructureAssignment(parent, parentStack)
<span class="linenr">411: </span>          ) {
<span class="linenr">412: </span>            <span class=
"org-keyword">if</span> (isProp) {
<span class="linenr">413: </span>              <span class=
"org-keyword">if</span> (escapeScope) {
<span class="linenr">414: </span>                <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">prop binding in $$()</span>
<span class="linenr">415: </span>                <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">{ prop } -&gt; { prop: __prop_prop }</span>
<span class=
"linenr">416: </span>                registerEscapedPropBinding(id)
<span class="linenr">417: </span>                s.appendLeft(
<span class="linenr">418: </span>                  id.end + offset,
<span class="linenr">419: </span>                  <span class=
"org-string">`: __props_${propsLocalToPublicMap[id.name]}`</span>
<span class="linenr">420: </span>                )
<span class="linenr">421: </span>              } <span class=
"org-keyword">else</span> {
<span class="linenr">422: </span>                <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">{ prop } -&gt; { prop: __prop.prop }</span>
<span class="linenr">423: </span>                s.appendLeft(
<span class="linenr">424: </span>                  id.end + offset,
<span class="linenr">425: </span>                  <span class=
"org-string">`: __props.${propsLocalToPublicMap[id.name]}`</span>
<span class="linenr">426: </span>                )
<span class="linenr">427: </span>              }
<span class="linenr">428: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr">429: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">{ foo } -&gt; { foo: foo.value }</span>
<span class=
"linenr">430: </span>              s.appendLeft(id.end + offset, <span class="org-string">`: ${id.name}.value`</span>)
<span class="linenr">431: </span>            }
<span class="linenr">432: </span>          }
<span class="linenr">433: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr">434: </span>          <span class=
"org-keyword">if</span> (isProp) {
<span class="linenr">435: </span>            <span class=
"org-keyword">if</span> (escapeScope) {
<span class="linenr">436: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x --&gt; __props_x</span>
<span class=
"linenr">437: </span>              registerEscapedPropBinding(id)
<span class="linenr">438: </span>              s.overwrite(
<span class="linenr">439: </span>                id.start + offset,
<span class="linenr">440: </span>                id.end + offset,
<span class="linenr">441: </span>                <span class=
"org-string">`__props_${propsLocalToPublicMap[id.name]}`</span>
<span class="linenr">442: </span>              )
<span class="linenr">443: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr">444: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x --&gt; __props.x</span>
<span class="linenr">445: </span>              s.overwrite(
<span class="linenr">446: </span>                id.start + offset,
<span class="linenr">447: </span>                id.end + offset,
<span class="linenr">448: </span>                <span class=
"org-string">`__props.${propsLocalToPublicMap[id.name]}`</span>
<span class="linenr">449: </span>              )
<span class="linenr">450: </span>            }
<span class="linenr">451: </span>          } <span class=
"org-keyword">else</span> {
<span class="linenr">452: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">x --&gt; x.value</span>
<span class=
"linenr">453: </span>            s.appendLeft(id.end + offset, <span class="org-string">'.value'</span>)
<span class="linenr">454: </span>          }
<span class="linenr">455: </span>        }
<span class="linenr">456: </span>      }
<span class="linenr">457: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">458: </span>    }
<span class="linenr">459: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">460: </span>  }
<span class="linenr">461: </span>
<span class="linenr">462: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">propBindingRefs</span> = {}
<span class="linenr">463: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">registerEscapedPropBinding</span>(<span class=
"org-variable-name">id</span>) {
<span class="linenr">464: </span>    <span class=
"org-keyword">if</span> (!propBindingRefs.hasOwnProperty(id.name)) {
<span class=
"linenr">465: </span>      propBindingRefs[id.name] = <span class=
"org-constant">true</span>
<span class="linenr">466: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">publicKey</span> = propsLocalToPublicMap[id.name]
<span class="linenr">467: </span>      s.prependRight(
<span class="linenr">468: </span>        offset,
<span class="linenr">469: </span>        <span class=
"org-string">`const __props_${publicKey} = ${helper(</span>
<span class="linenr">470: </span><span class=
"org-string">          `</span>toRef<span class=
"org-string">`</span>
<span class="linenr">471: </span><span class=
"org-string">        )}(__props, '${publicKey}')\n`</span>
<span class="linenr">472: </span>      )
<span class="linenr">473: </span>    }
<span class="linenr">474: </span>  }
<span class="linenr">475: </span>
<span class="linenr">476: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">check root scope first</span>
<span class="linenr">477: </span>  walkScope(ast, <span class=
"org-constant">true</span>)
<span class="linenr">478: </span>  walk(ast, {
<span class="linenr">479: </span>    enter(node, parent) {
<span class=
"linenr">480: </span>      parent &amp;& parentStack.push(parent)
<span class="linenr">481: </span>
<span class="linenr">482: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">function scopes</span>
<span class="linenr">483: </span>      <span class=
"org-keyword">if</span> (isFunctionType(node)) {
<span class=
"linenr">484: </span>        scopeStack.push((currentScope = {}))
<span class=
"linenr">485: </span>        walkFunctionParams(node, registerBinding)
<span class="linenr">486: </span>        <span class=
"org-keyword">if</span> (node.body.type === <span class=
"org-string">'BlockStatement'</span>) {
<span class="linenr">487: </span>          walkScope(node.body)
<span class="linenr">488: </span>        }
<span class="linenr">489: </span>        <span class=
"org-keyword">return</span>
<span class="linenr">490: </span>      }
<span class="linenr">491: </span>
<span class="linenr">492: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">catch param</span>
<span class="linenr">493: </span>      <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'CatchClause'</span>) {
<span class=
"linenr">494: </span>        scopeStack.push((currentScope = {}))
<span class="linenr">495: </span>        <span class=
"org-keyword">if</span> (node.param &amp;& node.param.type === <span class="org-string">'Identifier'</span>) {
<span class=
"linenr">496: </span>          registerBinding(node.param)
<span class="linenr">497: </span>        }
<span class="linenr">498: </span>        walkScope(node.body)
<span class="linenr">499: </span>        <span class=
"org-keyword">return</span>
<span class="linenr">500: </span>      }
<span class="linenr">501: </span>
<span class="linenr">502: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">non-function block scopes</span>
<span class="linenr">503: </span>      <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'BlockStatement'</span> &amp;& !isFunctionType(parent)) {
<span class=
"linenr">504: </span>        scopeStack.push((currentScope = {}))
<span class="linenr">505: </span>        walkScope(node)
<span class="linenr">506: </span>        <span class=
"org-keyword">return</span>
<span class="linenr">507: </span>      }
<span class="linenr">508: </span>
<span class="linenr">509: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip type nodes</span>
<span class="linenr">510: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr">511: </span>        parent &amp;&
<span class=
"linenr">512: </span>        parent.type.startsWith(<span class=
"org-string">'TS'</span>) &amp;&
<span class=
"linenr">513: </span>        parent.type !== <span class=
"org-string">'TSAsExpression'</span> &amp;&
<span class=
"linenr">514: </span>        parent.type !== <span class=
"org-string">'TSNonNullExpression'</span> &amp;&
<span class=
"linenr">515: </span>        parent.type !== <span class=
"org-string">'TSTypeAssertion'</span>
<span class="linenr">516: </span>      ) {
<span class="linenr">517: </span>        <span class=
"org-keyword">return</span> <span class=
"org-constant">this</span>.skip()
<span class="linenr">518: </span>      }
<span class="linenr">519: </span>
<span class="linenr">520: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr">521: </span>        node.type === <span class=
"org-string">'Identifier'</span> &amp;&
<span class="linenr">522: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if inside $$(), skip unless this is a destructured prop binding</span>
<span class=
"linenr">523: </span>        !(escapeScope &amp;& rootScope[node.name] !== <span class="org-string">'prop'</span>) &amp;&
<span class=
"linenr">524: </span>        isReferencedIdentifier(node, parent, parentStack) &amp;&
<span class="linenr">525: </span>        !excludedIds.has(node)
<span class="linenr">526: </span>      ) {
<span class="linenr">527: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">walk up the scope chain to check if id should be appended .value</span>
<span class="linenr">528: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = scopeStack.length
<span class="linenr">529: </span>        <span class=
"org-keyword">while</span> (i--) {
<span class="linenr">530: </span>          <span class=
"org-keyword">if</span> (rewriteId(scopeStack[i], node, parent, parentStack)) {
<span class="linenr">531: </span>            <span class=
"org-keyword">return</span>
<span class="linenr">532: </span>          }
<span class="linenr">533: </span>        }
<span class="linenr">534: </span>      }
<span class="linenr">535: </span>
<span class="linenr">536: </span>      <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'CallExpression'</span> &amp;& node.callee.type === <span class="org-string">'Identifier'</span>) {
<span class="linenr">537: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">callee</span> = node.callee.name
<span class="linenr">538: </span>
<span class="linenr">539: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">refCall</span> = isRefCreationCall(callee)
<span class="linenr">540: </span>        <span class=
"org-keyword">if</span> (refCall &amp;& (!parent || parent.type !== <span class="org-string">'VariableDeclarator'</span>)) {
<span class="linenr">541: </span>          <span class=
"org-keyword">return</span> error(
<span class="linenr">542: </span>            <span class=
"org-string">`${refCall} can only be used as the initializer of `</span> +
<span class="linenr">543: </span>              <span class=
"org-string">`a variable declaration.`</span>,
<span class="linenr">544: </span>            node
<span class="linenr">545: </span>          )
<span class="linenr">546: </span>        }
<span class="linenr">547: </span>
<span class="linenr">548: </span>        <span class=
"org-keyword">if</span> (callee === escapeSymbol) {
<span class=
"linenr">549: </span>          s.remove(node.callee.start + offset, node.callee.end + offset)
<span class="linenr">550: </span>          escapeScope = node
<span class="linenr">551: </span>        }
<span class="linenr">552: </span>
<span class="linenr">553: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO</span></span></span><span class=
"org-comment"> remove when out of experimental</span>
<span class="linenr">554: </span>        <span class=
"org-keyword">if</span> (callee === <span class=
"org-string">'$raw'</span>) {
<span class="linenr">555: </span>          error(
<span class="linenr">556: </span>            <span class=
"org-string">`$raw() has been replaced by $$(). `</span> +
<span class="linenr">557: </span>              <span class=
"org-string">`See ${RFC_LINK} for latest updates.`</span>,
<span class="linenr">558: </span>            node
<span class="linenr">559: </span>          )
<span class="linenr">560: </span>        }
<span class="linenr">561: </span>        <span class=
"org-keyword">if</span> (callee === <span class=
"org-string">'$fromRef'</span>) {
<span class="linenr">562: </span>          error(
<span class="linenr">563: </span>            <span class=
"org-string">`$fromRef() has been replaced by $(). `</span> +
<span class="linenr">564: </span>              <span class=
"org-string">`See ${RFC_LINK} for latest updates.`</span>,
<span class="linenr">565: </span>            node
<span class="linenr">566: </span>          )
<span class="linenr">567: </span>        }
<span class="linenr">568: </span>      }
<span class="linenr">569: </span>    },
<span class="linenr">570: </span>    leave(node, parent) {
<span class=
"linenr">571: </span>      parent &amp;& parentStack.pop()
<span class="linenr">572: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr">573: </span>        (node.type === <span class="org-string">'BlockStatement'</span> &amp;& !isFunctionType(parent)) ||
<span class="linenr">574: </span>        isFunctionType(node)
<span class="linenr">575: </span>      ) {
<span class="linenr">576: </span>        scopeStack.pop()
<span class=
"linenr">577: </span>        currentScope = scopeStack[scopeStack.length - <span class="org-highlight-numbers-number">1</span>] || <span class="org-constant">null</span>
<span class="linenr">578: </span>      }
<span class="linenr">579: </span>      <span class=
"org-keyword">if</span> (node === escapeScope) {
<span class="linenr">580: </span>        escapeScope = <span class=
"org-constant">undefined</span>
<span class="linenr">581: </span>      }
<span class="linenr">582: </span>    }
<span class="linenr">583: </span>  })
<span class="linenr">584: </span>
<span class="linenr">585: </span>  <span class=
"org-keyword">return</span> {
<span class=
"linenr">586: </span>    rootRefs: Object.keys(rootScope).filter(key =&gt; rootScope[key] === <span class="org-constant">true</span>),
<span class=
"linenr">587: </span>    importedHelpers: [...importedHelpers]
<span class="linenr">588: </span>  }
<span class="linenr">589: </span>}
<span class="linenr">590: </span>
<span class="linenr">591: </span>  <span class=
"org-keyword">return</span> { transformAST, transform, shouldTransform }
<span class="linenr">592: </span>}())
</pre>
          </div>
        </div>
      </div>
    </div>
    <div id="outline-container-org92ff454" class="outline-2">
      <h2 id="org92ff454"><span class="section-number-2">2.</span>
      script</h2>
      <div class="outline-text-2" id="text-2"></div>
      <div id="outline-container-org807a578" class="outline-3">
        <h3 id="org807a578"><span class=
        "section-number-3">2.1.</span> compileScript()</h3>
        <div class="outline-text-3" id="text-2-1">
          <div class="org-src-container">
            <pre class="src src-js" id="org4db62e5"><span class=
            "linenr">  1: </span>&lt;&lt;compileScript-functions&gt;&gt;
<span class="linenr">  2: </span>&lt;&lt;compileTemplate&gt;&gt;
<span class="linenr">  3: </span>&lt;&lt;sfc-cssVars&gt;&gt;
<span class="linenr">  4: </span>
<span class="linenr">  5: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">Special compiler macros</span>
<span class="linenr">  6: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">DEFINE_PROPS</span> = <span class=
"org-string">'defineProps'</span>
<span class="linenr">  7: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">DEFINE_EMITS</span> = <span class=
"org-string">'defineEmits'</span>
<span class="linenr">  8: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">DEFINE_EXPOSE</span> = <span class=
"org-string">'defineExpose'</span>
<span class="linenr">  9: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">WITH_DEFAULTS</span> = <span class=
"org-string">'withDefaults'</span>
<span class="linenr"> 10: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">templateUsageCheckCache</span> = createCache()
<span class="linenr"> 11: </span>
<span class="linenr"> 12: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">constants</span>
<span class="linenr"> 13: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">DEFAULT_VAR</span> = <span class=
"org-string">`__default__`</span>
<span class="linenr"> 14: </span>
<span class="linenr"> 15: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">isBuiltInDir</span> = makeMap(
<span class="linenr"> 16: </span>  <span class=
"org-string">`once,memo,if,else,else-if,slot,text,html,on,bind,model,show,cloak,is`</span>
<span class="linenr"> 17: </span>)
<span class="linenr"> 18: </span>
<span class="linenr"> 19: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">compileScript</span>(<span class=
"org-variable-name">sfc</span>, <span class=
"org-variable-name">options</span>) {
<span class="linenr"> 20: </span>  <span class=
"org-keyword">let</span> { script, scriptSetup, source, filename } = sfc
<span class="linenr"> 21: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">feature flags</span>
<span class="linenr"> 22: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO</span></span></span><span class=
"org-comment"> remove support for deprecated options when out of experimental</span>
<span class="linenr"> 23: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">enableReactivityTransform</span> =
<span class=
"linenr"> 24: </span>    !!options.reactivityTransform ||
<span class="linenr"> 25: </span>    !!options.refSugar ||
<span class="linenr"> 26: </span>    !!options.refTransform
<span class="linenr"> 27: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">enablePropsTransform</span> =
<span class=
"linenr"> 28: </span>    !!options.reactivityTransform || !!options.propsDestructureTransform
<span class="linenr"> 29: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isProd</span> = !!options.isProd
<span class="linenr"> 30: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">genSourceMap</span> = options.sourceMap !== <span class="org-constant">false</span>
<span class="linenr"> 31: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">ref 声明的变量</span>
<span class="linenr"> 32: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">refBindings</span>
<span class="linenr"> 33: </span>
<span class="linenr"> 34: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scopeId</span> = options.id ? options.id.replace(<span class="org-string">/^data-v-/</span>, <span class="org-string">''</span>) : <span class="org-string">''</span>
<span class="linenr"> 35: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">cssVars</span> = sfc.cssVars
<span class="linenr"> 36: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptLang</span> = script &amp;& script.lang
<span class="linenr"> 37: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptSetupLang</span> = scriptSetup &amp;& scriptSetup.lang
<span class="linenr"> 38: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isTS</span> =
<span class="linenr"> 39: </span>    scriptLang === <span class=
"org-string">'ts'</span> ||
<span class="linenr"> 40: </span>    scriptLang === <span class=
"org-string">'tsx'</span> ||
<span class=
"linenr"> 41: </span>    scriptSetupLang === <span class=
"org-string">'ts'</span> ||
<span class=
"linenr"> 42: </span>    scriptSetupLang === <span class=
"org-string">'tsx'</span>
<span class="linenr"> 43: </span>
<span class="linenr"> 44: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">resolve parser plugins</span>
<span class="linenr"> 45: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">plugins</span> = []
<span class="linenr"> 46: </span>  <span class=
"org-keyword">if</span> (!isTS || scriptLang === <span class=
"org-string">'tsx'</span> || scriptSetupLang === <span class=
"org-string">'tsx'</span>) {
<span class="linenr"> 47: </span>    plugins.push(<span class=
"org-string">'jsx'</span>)
<span class="linenr"> 48: </span>  }
<span class="linenr"> 49: </span>  <span class=
"org-keyword">if</span> (options.babelParserPlugins) plugins.push(...options.babelParserPlugins)
<span class="linenr"> 50: </span>  <span class=
"org-keyword">if</span> (isTS) plugins.push(<span class=
"org-string">'typescript'</span>, <span class=
"org-string">'decorators-legacy'</span>)
<span class="linenr"> 51: </span>
<span class="linenr"> 52: </span>  <span class=
"org-keyword">if</span> (!scriptSetup) {
<span class="linenr"> 53: </span>    <span class=
"org-keyword">if</span> (!script) {
<span class="linenr"> 54: </span>      <span class=
"org-keyword">throw</span> <span class=
"org-keyword">new</span> <span class=
"org-type">Error</span>(<span class=
"org-string">`[@vue/compiler-sfc] SFC contains no &lt;script&gt; tags.`</span>)
<span class="linenr"> 55: </span>    }
<span class="linenr"> 56: </span>    <span class=
"org-keyword">if</span> (scriptLang &amp;& !isTS &amp;& scriptLang !== <span class="org-string">'jsx'</span>) {
<span class="linenr"> 57: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">do not process non js/ts script blocks</span>
<span class="linenr"> 58: </span>      <span class=
"org-keyword">return</span> script
<span class="linenr"> 59: </span>    }
<span class="linenr"> 60: </span>    <span class=
"org-keyword">try</span> {
<span class="linenr"> 61: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">content</span> = script.content
<span class="linenr"> 62: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">map</span> = script.map
<span class="linenr"> 63: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptAst</span> = babelParser.parse(content, {
<span class="linenr"> 64: </span>        plugins,
<span class="linenr"> 65: </span>        sourceType: <span class=
"org-string">'module'</span>
<span class="linenr"> 66: </span>      }).program
<span class="linenr"> 67: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bindings</span> = analyzeScriptBindings(scriptAst.body)
<span class="linenr"> 68: </span>      <span class=
"org-keyword">if</span> (enableReactivityTransform &amp;& RT.shouldTransform(content)) {
<span class="linenr"> 69: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">s</span> = <span class=
"org-keyword">new</span> <span class=
"org-type">MagicString</span>(source)
<span class="linenr"> 70: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">startOffset</span> = script.loc.start.offset
<span class="linenr"> 71: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">endOffset</span> = script.loc.end.offset
<span class="linenr"> 72: </span>        <span class=
"org-keyword">const</span> { importedHelpers } = RT.transformAST(scriptAst, s, startOffset)
<span class="linenr"> 73: </span>        <span class=
"org-keyword">if</span> (importedHelpers.length) {
<span class="linenr"> 74: </span>          s.prepend(
<span class="linenr"> 75: </span>            <span class=
"org-string">`import { ${importedHelpers</span>
<span class="linenr"> 76: </span><span class=
"org-string">              .map(h =&gt; `</span>${h} as _${h}<span class="org-string">`)</span>
<span class="linenr"> 77: </span><span class=
"org-string">              .join(', ')} } from 'vue'\n`</span>
<span class="linenr"> 78: </span>          )
<span class="linenr"> 79: </span>        }
<span class="linenr"> 80: </span>        s.remove(<span class=
"org-highlight-numbers-number">0</span>, startOffset)
<span class=
"linenr"> 81: </span>        s.remove(endOffset, source.length)
<span class="linenr"> 82: </span>        content = s.toString()
<span class="linenr"> 83: </span>        <span class=
"org-keyword">if</span> (genSourceMap) {
<span class="linenr"> 84: </span>          map = s.generateMap({
<span class="linenr"> 85: </span>            source: filename,
<span class="linenr"> 86: </span>            hires: <span class=
"org-constant">true</span>,
<span class=
"linenr"> 87: </span>            includeContent: <span class=
"org-constant">true</span>
<span class="linenr"> 88: </span>          })
<span class="linenr"> 89: </span>        }
<span class="linenr"> 90: </span>      }
<span class="linenr"> 91: </span>      <span class=
"org-keyword">if</span> (cssVars.length) {
<span class=
"linenr"> 92: </span>        content = rewriteDefault(content, DEFAULT_VAR, plugins)
<span class=
"linenr"> 93: </span>        content += genNormalScriptCssVarsCode(
<span class="linenr"> 94: </span>          cssVars,
<span class="linenr"> 95: </span>          bindings,
<span class="linenr"> 96: </span>          scopeId,
<span class="linenr"> 97: </span>          isProd
<span class="linenr"> 98: </span>        )
<span class="linenr"> 99: </span>        content += <span class=
"org-string">`\nexport default ${DEFAULT_VAR}`</span>
<span class="linenr">100: </span>      }
<span class="linenr">101: </span>      <span class=
"org-keyword">return</span> {
<span class="linenr">102: </span>        ...script,
<span class="linenr">103: </span>        content,
<span class="linenr">104: </span>        map,
<span class="linenr">105: </span>        bindings,
<span class="linenr">106: </span>        scriptAst: scriptAst.body
<span class="linenr">107: </span>      }
<span class="linenr">108: </span>    } <span class=
"org-keyword">catch</span> (e) {
<span class="linenr">109: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">silently fallback if parse fails since user may be using custom</span>
<span class="linenr">110: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">babel syntax</span>
<span class="linenr">111: </span>      <span class=
"org-keyword">return</span> script
<span class="linenr">112: </span>    }
<span class="linenr">113: </span>  }
<span class="linenr">114: </span>
<span class="linenr">115: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">script 和 script setup 的语言必须一致</span>
<span class="linenr">116: </span>  <span class=
"org-keyword">if</span> (script &amp;& scriptLang !== scriptSetupLang) {
<span class="linenr">117: </span>    <span class=
"org-keyword">throw</span> <span class=
"org-keyword">new</span> <span class="org-type">Error</span>(
<span class="linenr">118: </span>      <span class=
"org-string">`[@vue/compiler-sfc] &lt;script&gt; and &lt;script setup&gt; must have the same `</span> +
<span class="linenr">119: </span>        <span class=
"org-string">`language type.`</span>
<span class="linenr">120: </span>    )
<span class="linenr">121: </span>  }
<span class="linenr">122: </span>
<span class="linenr">123: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">只处理 js/ts script</span>
<span class="linenr">124: </span>  <span class=
"org-keyword">if</span> (scriptSetupLang &amp;& !isTS &amp;& scriptSetupLang !== <span class="org-string">'jsx'</span>) {
<span class="linenr">125: </span>    <span class=
"org-keyword">return</span> scriptSetup
<span class="linenr">126: </span>  }
<span class="linenr">127: </span>
<span class="linenr">128: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">变量，imports 都需要导出</span>
<span class="linenr">129: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bindingMetadata</span> = {}
<span class="linenr">130: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">helperImports</span> = <span class=
"org-keyword">new</span> <span class="org-type">Set</span>()
<span class="linenr">131: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">userImports</span> = Object.create(<span class=
"org-constant">null</span>)
<span class="linenr">132: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">userImportAlias</span> = Object.create(<span class="org-constant">null</span>)
<span class="linenr">133: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptBindings</span> = Object.create(<span class="org-constant">null</span>)
<span class="linenr">134: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">setupBindings</span> = Object.create(<span class="org-constant">null</span>)
<span class="linenr">135: </span>
<span class="linenr">136: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">defaultExport</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export default</span>
<span class="linenr">137: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasDefinePropsCall</span> = <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">defineProps()</span>
<span class="linenr">138: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasDefineEmitCall</span> = <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">defineEmits()</span>
<span class="linenr">139: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasDefineExposeCall</span> = <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">defineExpose()</span>
<span class="linenr">140: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsRuntimeDecl</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">属性声明</span>
<span class="linenr">141: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsRuntimeDefaults</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">属性默认值</span>
<span class="linenr">142: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsDestructureDecl</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">属性解构声明</span>
<span class="linenr">143: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsDestructureRestId</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">属性解构的 ... 符号</span>
<span class="linenr">144: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsTypeDecl</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">属性类型声明</span>
<span class="linenr">145: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsTypeDeclRaw</span>
<span class="linenr">146: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsIdentifier</span>
<span class="linenr">147: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">emitsRuntimeDecl</span>
<span class="linenr">148: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">emitsTypeDecl</span>
<span class="linenr">149: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">emitsTypeDeclRaw</span>
<span class="linenr">150: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">emitIdentifier</span>
<span class="linenr">151: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasAwait</span> = <span class=
"org-constant">false</span> <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">有没 await 符号，如果有则会转成 async setup</span>
<span class="linenr">152: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">hasInlinedSsrRenderFn</span> = <span class=
"org-constant">false</span>
<span class="linenr">153: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props/emits declared via types</span>
<span class="linenr">154: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">typeDeclaredProps</span> = {}
<span class="linenr">155: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">typeDeclaredEmits</span> = <span class=
"org-keyword">new</span> <span class="org-type">Set</span>()
<span class="linenr">156: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">record declared types for runtime props type generation</span>
<span class="linenr">157: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">declaredTypes</span> = {}
<span class="linenr">158: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props destructure data</span>
<span class="linenr">159: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">propsDestructuredBindings</span> = Object.create(<span class="org-constant">null</span>)
<span class="linenr">160: </span>
<span class="linenr">161: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">magic-string state</span>
<span class="linenr">162: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">s</span> = <span class=
"org-keyword">new</span> <span class=
"org-type">MagicString</span>(source)
<span class="linenr">163: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">startOffset</span> = scriptSetup.loc.start.offset
<span class="linenr">164: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">endOffset</span> = scriptSetup.loc.end.offset
<span class="linenr">165: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptStartOffset</span> = script &amp;& script.loc.start.offset
<span class="linenr">166: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptEndOffset</span> = script &amp;& script.loc.end.offset
<span class="linenr">167: </span>
<span class=
"linenr">168: </span>  &lt;&lt;compileScript-utils&gt;&gt;
<span class=
"linenr">169: </span>  &lt;&lt;compileScript-steps&gt;&gt;
<span class="linenr">170: </span>
<span class="linenr">171: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. process normal &lt;script&gt; first if it exists</span>
<span class="linenr">172: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">scriptAst</span> = processNormalScript()
<span class="linenr">173: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">2. parse &lt;script setup&gt; and  walk over top level statements</span>
<span class="linenr">174: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptSetupAst</span> = processSetupScript()
<span class="linenr">175: </span>
<span class="linenr">176: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">3. Apply reactivity transform</span>
<span class="linenr">177: </span>  applyReactivityTransform()
<span class="linenr">178: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">4. extract runtime props/emits code from setup context type</span>
<span class="linenr">179: </span>  extractRuntimePropsEmits()
<span class="linenr">180: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">5. check useOptions args to make sure it doesn't reference setup scope</span>
<span class="linenr">181: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">variables</span>
<span class="linenr">182: </span>  checkUseOptions()
<span class="linenr">183: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">6. remove non-script content</span>
<span class="linenr">184: </span>  removeNonScriptContent()
<span class="linenr">185: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">7. analyze binding metadata</span>
<span class="linenr">186: </span>  analyzeBindingMetadata()
<span class="linenr">187: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">8. inject `useCssVars` calls</span>
<span class="linenr">188: </span>  injectUseCssVarsCalls()
<span class="linenr">189: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">9. finalize setup() argument signature</span>
<span class="linenr">190: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">args</span> = <span class=
"org-string">`__props`</span>
<span class="linenr">191: </span>  finalizeSetupArgumentSignature()
<span class="linenr">192: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">10. generate return statement</span>
<span class="linenr">193: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">returned</span>
<span class="linenr">194: </span>  generateReturnStatement()
<span class="linenr">195: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">11. finalize default export</span>
<span class="linenr">196: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">runtimeOptions</span> = <span class=
"org-string">''</span>
<span class="linenr">197: </span>  finalizeDefaultExport()
<span class="linenr">198: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">12. finalize Vue helper imports</span>
<span class="linenr">199: </span>  finalizeVueHelperImports()
<span class="linenr">200: </span>
<span class="linenr">201: </span>  s.trim()
<span class="linenr">202: </span>
<span class="linenr">203: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr">204: </span>    ...scriptSetup,
<span class="linenr">205: </span>    bindings: bindingMetadata,
<span class="linenr">206: </span>    imports: userImports,
<span class="linenr">207: </span>    content: s.toString(),
<span class="linenr">208: </span>    map: genSourceMap
<span class="linenr">209: </span>      ? (s.generateMap({
<span class="linenr">210: </span>          source: filename,
<span class="linenr">211: </span>          hires: <span class=
"org-constant">true</span>,
<span class=
"linenr">212: </span>          includeContent: <span class=
"org-constant">true</span>
<span class="linenr">213: </span>        }))
<span class="linenr">214: </span>      : <span class=
"org-constant">undefined</span>,
<span class="linenr">215: </span>    scriptAst: scriptAst?.body,
<span class=
"linenr">216: </span>    scriptSetupAst: scriptSetupAst?.body
<span class="linenr">217: </span>  }
<span class="linenr">218: </span>}
</pre>
          </div>
          <p>这个函数是用来编译 SFC 文件中 <code>&lt;script&gt;</code> 和
          <code>&lt;script setup&gt;</code> 中代码的，内容很多，主要 分为了 12
          个步聚完成，这里为了简化这个函数，会将这 12 步拆分成 12 个单独的函数。</p>
        </div>
      </div>
      <div id="outline-container-org92987cf" class="outline-3">
        <h3 id="org92987cf"><span class=
        "section-number-3">2.2.</span> utils</h3>
        <div class="outline-text-3" id="text-2-2">
          <div class="org-src-container">
            <pre class="src src-js" id="org9ce5726"><span class=
            "linenr"> 1: </span>&lt;&lt;cs-u-helper&gt;&gt;
<span class="linenr"> 2: </span>&lt;&lt;cs-u-parse&gt;&gt;
<span class="linenr"> 3: </span>&lt;&lt;cs-u-error&gt;&gt;
<span class=
"linenr"> 4: </span>&lt;&lt;cs-u-registerUserImport&gt;&gt;
<span class=
"linenr"> 5: </span>&lt;&lt;cs-u-processDefineProps&gt;&gt;
<span class=
"linenr"> 6: </span>&lt;&lt;cs-u-processWithDefaults&gt;&gt;
<span class=
"linenr"> 7: </span>&lt;&lt;cs-u-processDefineEmits&gt;&gt;
<span class=
"linenr"> 8: </span>&lt;&lt;cs-u-resolveQualifiedType&gt;&gt;
<span class=
"linenr"> 9: </span>&lt;&lt;cs-u-processDefineExpose&gt;&gt;
<span class=
"linenr">10: </span>&lt;&lt;cs-u-checkInvalidScopeReference&gt;&gt;
<span class="linenr">11: </span>&lt;&lt;cs-u-processAwait&gt;&gt;
<span class=
"linenr">12: </span>&lt;&lt;cs-u-hasStaticWithDefaults&gt;&gt;
<span class=
"linenr">13: </span>&lt;&lt;cs-u-genRuntimeProps&gt;&gt;
<span class=
"linenr">14: </span>&lt;&lt;cs-u-genDestructuredDefaultValue&gt;&gt;
<span class=
"linenr">15: </span>&lt;&lt;cs-u-genSetupPropsType&gt;&gt;
</pre>
          </div>
        </div>
        <div id="outline-container-orgfb208d2" class="outline-4">
          <h4 id="orgfb208d2"><span class=
          "section-number-4">2.2.1.</span> helper()</h4>
          <div class="outline-text-4" id="text-2-2-1">
            <div class="org-src-container">
              <pre class="src src-js" id="orgd5de3d2"><span class=
              "linenr">1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">helper</span>(<span class=
              "org-variable-name">key</span>) {
<span class="linenr">2: </span>  helperImports.add(key)
<span class="linenr">3: </span>  <span class=
"org-keyword">return</span> <span class=
"org-string">`_${key}`</span>
<span class="linenr">4: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org0d7af35" class="outline-4">
          <h4 id="org0d7af35"><span class=
          "section-number-4">2.2.2.</span> parse()</h4>
          <div class="outline-text-4" id="text-2-2-2">
            <div class="org-src-container">
              <pre class="src src-js" id="orgbb0d8ef"><span class=
              "linenr"> 1: </span>  <span class=
              "org-keyword">function</span> <span class=
              "org-function-name">parse</span>(<span class=
              "org-variable-name">input</span>, <span class=
              "org-variable-name">options</span>, <span class=
              "org-variable-name">offset</span>) {
<span class="linenr"> 2: </span>    <span class=
"org-keyword">try</span> {
<span class="linenr"> 3: </span>      <span class=
"org-keyword">return</span> babelParser.parse(input, options).program
<span class="linenr"> 4: </span>    } <span class=
"org-keyword">catch</span> (e) {
<span class="linenr"> 5: </span>      e.message = <span class=
"org-string">`[@vue/compiler-sfc] ${e.message}\n\n${</span>
<span class="linenr"> 6: </span><span class=
"org-string">        sfc.filename</span>
<span class="linenr"> 7: </span><span class=
"org-string">      }\n${generateCodeFrame(source, e.pos + offset, e.pos + offset + 1)}`</span>
<span class="linenr"> 8: </span>      <span class=
"org-keyword">throw</span> e
<span class="linenr"> 9: </span>    }
<span class="linenr">10: </span>  }
<span class="linenr">11: </span>
<span class="linenr">12: </span>
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org4f93937" class="outline-4">
          <h4 id="org4f93937"><span class=
          "section-number-4">2.2.3.</span> error()</h4>
          <div class="outline-text-4" id="text-2-2-3">
            <div class="org-src-container">
              <pre class="src src-js" id="org75185d2"><span class=
              "linenr">1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">error</span>(<span class=
              "org-variable-name">msg</span>, <span class=
              "org-variable-name">node</span>, <span class=
              "org-variable-name">end</span> = <span class=
              "org-variable-name">node</span>.<span class=
              "org-variable-name">end</span> + <span class=
              "org-variable-name">startOffset</span>) {
<span class="linenr">2: </span>  <span class=
"org-keyword">throw</span> <span class=
"org-keyword">new</span> <span class="org-type">Error</span>(
<span class="linenr">3: </span>    <span class=
"org-string">`[@vue/compiler-sfc] ${msg}\n\n${sfc.filename}\n${generateCodeFrame(</span>
<span class="linenr">4: </span><span class=
"org-string">    source,</span>
<span class="linenr">5: </span><span class=
"org-string">    node.start + startOffset,</span>
<span class="linenr">6: </span><span class=
"org-string">    end</span>
<span class="linenr">7: </span><span class=
"org-string">    )}`</span>
<span class="linenr">8: </span>  )
<span class="linenr">9: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgdf5b916" class="outline-4">
          <h4 id="orgdf5b916"><span class=
          "section-number-4">2.2.4.</span>
          registerUserImport()</h4>
          <div class="outline-text-4" id="text-2-2-4">
            <div class="org-src-container">
              <pre class="src src-js" id="orgec20e6c"><span class=
              "linenr"> 1: </span>  <span class=
              "org-keyword">function</span> <span class=
              "org-function-name">registerUserImport</span>(<span class=
              "org-variable-name">source</span>, <span class=
              "org-variable-name">local</span>, <span class=
              "org-variable-name">imported</span>, <span class=
              "org-variable-name">isType</span>, <span class=
              "org-variable-name">isFromSetup</span>) {
<span class="linenr"> 2: </span>    <span class=
"org-keyword">if</span> (source === <span class=
"org-string">'vue'</span> &amp;& imported) {
<span class=
"linenr"> 3: </span>      userImportAlias[imported] = local
<span class="linenr"> 4: </span>    }
<span class="linenr"> 5: </span>
<span class="linenr"> 6: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">isUsedInTemplate</span> = <span class=
"org-constant">true</span>
<span class="linenr"> 7: </span>    <span class=
"org-keyword">if</span> (isTS &amp;& sfc.template &amp;& !sfc.template.src &amp;& !sfc.template.lang) {
<span class=
"linenr"> 8: </span>      isUsedInTemplate = isImportUsed(local, sfc)
<span class="linenr"> 9: </span>    }
<span class="linenr">10: </span>
<span class="linenr">11: </span>    userImports[local] = {
<span class="linenr">12: </span>      isType,
<span class=
"linenr">13: </span>      imported: imported || <span class=
"org-string">'default'</span>,
<span class="linenr">14: </span>      source,
<span class="linenr">15: </span>      isFromSetup,
<span class="linenr">16: </span>      isUsedInTemplate
<span class="linenr">17: </span>    }
<span class="linenr">18: </span>  }
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org1b99f2e" class="outline-4">
          <h4 id="org1b99f2e"><span class=
          "section-number-4">2.2.5.</span>
          processDefineProps()</h4>
          <div class="outline-text-4" id="text-2-2-5">
            <p>TODO 使用场景：</p>
            <ol class="org-ol">
              <li>不能重复调用 <code>defineProps()</code></li>
              <li>不能同时使用类型和非类型参数</li>
              <li>类型参数必须是字面量类型</li>
              <li>解构后的变量命名不能使用 <code>computed</code> 做为名字</li>
              <li>解构不支持嵌套使用</li>
            </ol>
            <div class="org-src-container">
              <pre class="src src-js" id="org7b7911f"><span class=
              "linenr"> 1: </span>
<span class="linenr"> 2: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">processDefineProps</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">declId</span>) {
<span class="linenr"> 3: </span>    <span class=
"org-keyword">if</span> (!isCallOf(node, DEFINE_PROPS)) {
<span class="linenr"> 4: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 5: </span>    }
<span class="linenr"> 6: </span>
<span class="linenr"> 7: </span>    <span class=
"org-keyword">if</span> (hasDefinePropsCall) {
<span class="linenr"> 8: </span>      error(<span class=
"org-string">`duplicate ${DEFINE_PROPS}() call`</span>, node)
<span class="linenr"> 9: </span>    }
<span class=
"linenr">10: </span>    hasDefinePropsCall = <span class=
"org-constant">true</span>
<span class="linenr">11: </span>
<span class=
"linenr">12: </span>    propsRuntimeDecl = node.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr">13: </span>
<span class="linenr">14: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">call has type parameters - infer runtime types from it</span>
<span class="linenr">15: </span>    <span class=
"org-keyword">if</span> (node.typeParameters) {
<span class="linenr">16: </span>      <span class=
"org-keyword">if</span> (propsRuntimeDecl) {
<span class="linenr">17: </span>        error(
<span class="linenr">18: </span>          <span class=
"org-string">`${DEFINE_PROPS}() cannot accept both type and non-type arguments `</span> +
<span class="linenr">19: </span>            <span class=
"org-string">`at the same time. Use one or the other.`</span>,
<span class="linenr">20: </span>          node
<span class="linenr">21: </span>        )
<span class="linenr">22: </span>      }
<span class="linenr">23: </span>
<span class=
"linenr">24: </span>      propsTypeDeclRaw = node.typeParameters.params[<span class="org-highlight-numbers-number">0</span>]
<span class=
"linenr">25: </span>      propsTypeDecl = resolveQualifiedType(
<span class="linenr">26: </span>        propsTypeDeclRaw,
<span class=
"linenr">27: </span>        node =&gt; node.type === <span class=
"org-string">'TSTypeLiteral'</span>
<span class="linenr">28: </span>      )
<span class="linenr">29: </span>
<span class="linenr">30: </span>      <span class=
"org-keyword">if</span> (!propsTypeDecl) {
<span class="linenr">31: </span>        error(
<span class="linenr">32: </span>          <span class=
"org-string">`type argument passed to ${DEFINE_PROPS}() must be a literal type, `</span> +
<span class="linenr">33: </span>            <span class=
"org-string">`or a reference to an interface or literal type.`</span>,
<span class="linenr">34: </span>          propsTypeDeclRaw
<span class="linenr">35: </span>        )
<span class="linenr">36: </span>      }
<span class="linenr">37: </span>    }
<span class="linenr">38: </span>
<span class="linenr">39: </span>    <span class=
"org-keyword">if</span> (declId) {
<span class="linenr">40: </span>      <span class=
"org-keyword">if</span> (enablePropsTransform &amp;& declId.type === <span class="org-string">'ObjectPattern'</span>) {
<span class=
"linenr">41: </span>        propsDestructureDecl = declId
<span class="linenr">42: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props destructure - handle compilation sugar</span>
<span class="linenr">43: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">prop</span> <span class=
"org-keyword">of</span> declId.properties) {
<span class="linenr">44: </span>          <span class=
"org-keyword">if</span> (prop.type === <span class=
"org-string">'ObjectProperty'</span>) {
<span class="linenr">45: </span>            <span class=
"org-keyword">if</span> (prop.computed) {
<span class="linenr">46: </span>              error(
<span class="linenr">47: </span>                <span class=
"org-string">`${DEFINE_PROPS}() destructure cannot use computed key.`</span>,
<span class="linenr">48: </span>                prop.key
<span class="linenr">49: </span>              )
<span class="linenr">50: </span>            }
<span class="linenr">51: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">propKey</span> = prop.key.name
<span class="linenr">52: </span>            <span class=
"org-keyword">if</span> (prop.value.type === <span class=
"org-string">'AssignmentPattern'</span>) {
<span class="linenr">53: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">default value { foo = 123 }</span>
<span class="linenr">54: </span>              <span class=
"org-keyword">const</span> { left, right } = prop.value
<span class="linenr">55: </span>              <span class=
"org-keyword">if</span> (left.type !== <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">56: </span>                error(
<span class="linenr">57: </span>                  <span class=
"org-string">`${DEFINE_PROPS}() destructure does not support nested patterns.`</span>,
<span class="linenr">58: </span>                  left
<span class="linenr">59: </span>                )
<span class="linenr">60: </span>              }
<span class="linenr">61: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">store default value</span>
<span class=
"linenr">62: </span>              propsDestructuredBindings[propKey] = {
<span class="linenr">63: </span>                local: left.name,
<span class="linenr">64: </span>                <span class=
"org-keyword">default</span>: right
<span class="linenr">65: </span>              }
<span class="linenr">66: </span>            } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (prop.value.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">67: </span>              <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">simple destructure</span>
<span class=
"linenr">68: </span>              propsDestructuredBindings[propKey] = {
<span class=
"linenr">69: </span>                local: prop.value.name
<span class="linenr">70: </span>              }
<span class="linenr">71: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr">72: </span>              error(
<span class="linenr">73: </span>                <span class=
"org-string">`${DEFINE_PROPS}() destructure does not support nested patterns.`</span>,
<span class="linenr">74: </span>                prop.value
<span class="linenr">75: </span>              )
<span class="linenr">76: </span>            }
<span class="linenr">77: </span>          } <span class=
"org-keyword">else</span> {
<span class="linenr">78: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">rest spread</span>
<span class=
"linenr">79: </span>            propsDestructureRestId = prop.argument.name
<span class="linenr">80: </span>          }
<span class="linenr">81: </span>        }
<span class="linenr">82: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr">83: </span>        propsIdentifier = scriptSetup.content.slice(declId.start, declId.end)
<span class="linenr">84: </span>      }
<span class="linenr">85: </span>    }
<span class="linenr">86: </span>
<span class="linenr">87: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">88: </span>  }
<span class="linenr">89: </span>
<span class="linenr">90: </span>
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgda18fb6" class="outline-4">
          <h4 id="orgda18fb6"><span class=
          "section-number-4">2.2.6.</span>
          processWithDefaults()</h4>
          <div class="outline-text-4" id="text-2-2-6">
            <p>处理带默认值的 props.</p>
            <div class="org-src-container">
              <pre class="src src-js" id="orga029f55"><span class=
              "linenr"> 1: </span>  <span class=
              "org-keyword">function</span> <span class=
              "org-function-name">processWithDefaults</span>(<span class=
              "org-variable-name">node</span>, <span class=
              "org-variable-name">declId</span>) {
<span class="linenr"> 2: </span>    <span class=
"org-keyword">if</span> (!isCallOf(node, WITH_DEFAULTS)) {
<span class="linenr"> 3: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 4: </span>    }
<span class="linenr"> 5: </span>    <span class=
"org-keyword">if</span> (processDefineProps(node.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>], declId)) {
<span class="linenr"> 6: </span>      <span class=
"org-keyword">if</span> (propsRuntimeDecl) {
<span class="linenr"> 7: </span>        error(
<span class="linenr"> 8: </span>          <span class=
"org-string">`${WITH_DEFAULTS} can only be used with type-based `</span> +
<span class="linenr"> 9: </span>            <span class=
"org-string">`${DEFINE_PROPS} declaration.`</span>,
<span class="linenr">10: </span>          node
<span class="linenr">11: </span>        )
<span class="linenr">12: </span>      }
<span class="linenr">13: </span>      <span class=
"org-keyword">if</span> (propsDestructureDecl) {
<span class="linenr">14: </span>        error(
<span class="linenr">15: </span>          <span class=
"org-string">`${WITH_DEFAULTS}() is unnecessary when using destructure with ${DEFINE_PROPS}().\n`</span> +
<span class="linenr">16: </span>            <span class=
"org-string">`Prefer using destructure default values, e.g. const { foo = 1 } = defineProps(...).`</span>,
<span class="linenr">17: </span>          node.callee
<span class="linenr">18: </span>        )
<span class="linenr">19: </span>      }
<span class=
"linenr">20: </span>      propsRuntimeDefaults = node.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">1</span>]
<span class="linenr">21: </span>      <span class=
"org-keyword">if</span> (
<span class="linenr">22: </span>        !propsRuntimeDefaults ||
<span class=
"linenr">23: </span>        propsRuntimeDefaults.type !== <span class="org-string">'ObjectExpression'</span>
<span class="linenr">24: </span>      ) {
<span class="linenr">25: </span>        error(
<span class="linenr">26: </span>          <span class=
"org-string">`The 2nd argument of ${WITH_DEFAULTS} must be an object literal.`</span>,
<span class=
"linenr">27: </span>          propsRuntimeDefaults || node
<span class="linenr">28: </span>        )
<span class="linenr">29: </span>      }
<span class="linenr">30: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">31: </span>      error(
<span class="linenr">32: </span>        <span class=
"org-string">`${WITH_DEFAULTS}' first argument must be a ${DEFINE_PROPS} call.`</span>,
<span class="linenr">33: </span>        node.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>] || node
<span class="linenr">34: </span>      )
<span class="linenr">35: </span>    }
<span class="linenr">36: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">37: </span>  }
<span class="linenr">38: </span>
<span class="linenr">39: </span>
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org80b2259" class="outline-4">
          <h4 id="org80b2259"><span class=
          "section-number-4">2.2.7.</span>
          processDefineEmits()</h4>
          <div class="outline-text-4" id="text-2-2-7">
            <div class="org-src-container">
              <pre class="src src-js" id="orgcb2cef2"><span class=
              "linenr"> 1: </span>
<span class="linenr"> 2: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">processDefineEmits</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">declId</span>) {
<span class="linenr"> 3: </span>    <span class=
"org-keyword">if</span> (!isCallOf(node, DEFINE_EMITS)) {
<span class="linenr"> 4: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr"> 5: </span>    }
<span class="linenr"> 6: </span>    <span class=
"org-keyword">if</span> (hasDefineEmitCall) {
<span class="linenr"> 7: </span>      error(<span class=
"org-string">`duplicate ${DEFINE_EMITS}() call`</span>, node)
<span class="linenr"> 8: </span>    }
<span class=
"linenr"> 9: </span>    hasDefineEmitCall = <span class="org-constant">true</span>
<span class=
"linenr">10: </span>    emitsRuntimeDecl = node.<span class=
"org-constant">arguments</span>[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr">11: </span>    <span class=
"org-keyword">if</span> (node.typeParameters) {
<span class="linenr">12: </span>      <span class=
"org-keyword">if</span> (emitsRuntimeDecl) {
<span class="linenr">13: </span>        error(
<span class="linenr">14: </span>          <span class=
"org-string">`${DEFINE_EMITS}() cannot accept both type and non-type arguments `</span> +
<span class="linenr">15: </span>            <span class=
"org-string">`at the same time. Use one or the other.`</span>,
<span class="linenr">16: </span>          node
<span class="linenr">17: </span>        )
<span class="linenr">18: </span>      }
<span class="linenr">19: </span>
<span class=
"linenr">20: </span>      emitsTypeDeclRaw = node.typeParameters.params[<span class="org-highlight-numbers-number">0</span>]
<span class=
"linenr">21: </span>      emitsTypeDecl = resolveQualifiedType(
<span class="linenr">22: </span>        emitsTypeDeclRaw,
<span class=
"linenr">23: </span>        node =&gt; node.type === <span class=
"org-string">'TSFunctionType'</span> || node.type === <span class=
"org-string">'TSTypeLiteral'</span>
<span class="linenr">24: </span>      )
<span class="linenr">25: </span>
<span class="linenr">26: </span>      <span class=
"org-keyword">if</span> (!emitsTypeDecl) {
<span class="linenr">27: </span>        error(
<span class="linenr">28: </span>          <span class=
"org-string">`type argument passed to ${DEFINE_EMITS}() must be a function type, `</span> +
<span class="linenr">29: </span>            <span class=
"org-string">`a literal type with call signatures, or a reference to the above types.`</span>,
<span class="linenr">30: </span>          emitsTypeDeclRaw
<span class="linenr">31: </span>        )
<span class="linenr">32: </span>      }
<span class="linenr">33: </span>    }
<span class="linenr">34: </span>
<span class="linenr">35: </span>    <span class=
"org-keyword">if</span> (declId) {
<span class=
"linenr">36: </span>      emitIdentifier = scriptSetup.content.slice(declId.start, declId.end)
<span class="linenr">37: </span>    }
<span class="linenr">38: </span>
<span class="linenr">39: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">40: </span>  }
<span class="linenr">41: </span>
<span class="linenr">42: </span>
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgcdc2f57" class="outline-4">
          <h4 id="orgcdc2f57"><span class=
          "section-number-4">2.2.8.</span>
          resolveQualifiedType()</h4>
          <div class="outline-text-4" id="text-2-2-8">
            <div class="org-src-container">
              <pre class="src src-js" id="orgc929a07"><span class=
              "linenr"> 1: </span>
<span class="linenr"> 2: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">resolveQualifiedType</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">qualifier</span>) {
<span class="linenr"> 3: </span>    <span class=
"org-keyword">if</span> (qualifier(node)) {
<span class="linenr"> 4: </span>      <span class=
"org-keyword">return</span> node
<span class="linenr"> 5: </span>    }
<span class="linenr"> 6: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr"> 7: </span>      node.type === <span class=
"org-string">'TSTypeReference'</span> &amp;&
<span class=
"linenr"> 8: </span>      node.typeName.type === <span class=
"org-string">'Identifier'</span>
<span class="linenr"> 9: </span>    ) {
<span class="linenr">10: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">refName</span> = node.typeName.name
<span class="linenr">11: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isQualifiedType</span> = (node) =&gt; {
<span class="linenr">12: </span>        <span class=
"org-keyword">if</span> (
<span class=
"linenr">13: </span>          node.type === <span class="org-string">'TSInterfaceDeclaration'</span> &amp;&
<span class="linenr">14: </span>          node.id.name === refName
<span class="linenr">15: </span>        ) {
<span class="linenr">16: </span>          <span class=
"org-keyword">return</span> node.body
<span class="linenr">17: </span>        } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr">18: </span>          node.type === <span class="org-string">'TSTypeAliasDeclaration'</span> &amp;&
<span class=
"linenr">19: </span>          node.id.name === refName &amp;&
<span class=
"linenr">20: </span>          qualifier(node.typeAnnotation)
<span class="linenr">21: </span>        ) {
<span class="linenr">22: </span>          <span class=
"org-keyword">return</span> node.typeAnnotation
<span class="linenr">23: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ExportNamedDeclaration'</span> &amp;& node.declaration) {
<span class="linenr">24: </span>          <span class=
"org-keyword">return</span> isQualifiedType(node.declaration)
<span class="linenr">25: </span>        }
<span class="linenr">26: </span>      }
<span class="linenr">27: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">body</span> = scriptAst
<span class=
"linenr">28: </span>        ? [...scriptSetupAst.body, ...scriptAst.body]
<span class="linenr">29: </span>        : scriptSetupAst.body
<span class="linenr">30: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> <span class=
"org-keyword">of</span> body) {
<span class="linenr">31: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">qualified</span> = isQualifiedType(node)
<span class="linenr">32: </span>        <span class=
"org-keyword">if</span> (qualified) {
<span class="linenr">33: </span>          <span class=
"org-keyword">return</span> qualified
<span class="linenr">34: </span>        }
<span class="linenr">35: </span>      }
<span class="linenr">36: </span>    }
<span class="linenr">37: </span>  }
<span class="linenr">38: </span>
<span class="linenr">39: </span>
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgaef0ead" class="outline-4">
          <h4 id="orgaef0ead"><span class=
          "section-number-4">2.2.9.</span>
          processDefineExpose()</h4>
          <div class="outline-text-4" id="text-2-2-9">
            <div class="org-src-container">
              <pre class="src src-js" id="org93d14a6"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">processDefineExpose</span>(<span class=
              "org-variable-name">node</span>) {
<span class="linenr"> 2: </span>    <span class=
"org-keyword">if</span> (isCallOf(node, DEFINE_EXPOSE)) {
<span class="linenr"> 3: </span>      <span class=
"org-keyword">if</span> (hasDefineExposeCall) {
<span class="linenr"> 4: </span>        error(<span class=
"org-string">`duplicate ${DEFINE_EXPOSE}() call`</span>, node)
<span class="linenr"> 5: </span>      }
<span class=
"linenr"> 6: </span>      hasDefineExposeCall = <span class=
"org-constant">true</span>
<span class="linenr"> 7: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 8: </span>    }
<span class="linenr"> 9: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">10: </span>  }
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org6da1a64" class="outline-4">
          <h4 id="org6da1a64"><span class=
          "section-number-4">2.2.10.</span>
          checkInvalidScopeReference()</h4>
          <div class="outline-text-4" id="text-2-2-10">
            <div class="org-src-container">
              <pre class="src src-js" id="org25a0406"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">checkInvalidScopeReference</span>(<span class=
              "org-variable-name">node</span>, <span class=
              "org-variable-name">method</span>) {
<span class="linenr"> 2: </span>    <span class=
"org-keyword">if</span> (!node) <span class=
"org-keyword">return</span>
<span class=
"linenr"> 3: </span>    walkIdentifiers(node, id =&gt; {
<span class="linenr"> 4: </span>      <span class=
"org-keyword">if</span> (setupBindings[id.name]) {
<span class="linenr"> 5: </span>        error(
<span class="linenr"> 6: </span>          <span class=
"org-string">`\`${method}()\` in &lt;script setup&gt; cannot reference locally `</span> +
<span class="linenr"> 7: </span>            <span class=
"org-string">`declared variables because it will be hoisted outside of the `</span> +
<span class="linenr"> 8: </span>            <span class=
"org-string">`setup() function. If your component options require initialization `</span> +
<span class="linenr"> 9: </span>            <span class=
"org-string">`in the module scope, use a separate normal &lt;script&gt; to export `</span> +
<span class="linenr">10: </span>            <span class=
"org-string">`the options instead.`</span>,
<span class="linenr">11: </span>          id
<span class="linenr">12: </span>        )
<span class="linenr">13: </span>      }
<span class="linenr">14: </span>    })
<span class="linenr">15: </span>  }
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org1cbcbee" class="outline-4">
          <h4 id="org1cbcbee"><span class=
          "section-number-4">2.2.11.</span> processAwait()</h4>
          <div class="outline-text-4" id="text-2-2-11">
            <div class="org-src-container">
              <pre class="src src-js" id="orgcba2544"><span class=
              "linenr"> 1: </span><span class="org-doc">/**</span>
<span class="linenr"> 2: </span><span class=
"org-doc">   * await foo()</span>
<span class="linenr"> 3: </span><span class=
"org-doc">   * --&gt;</span>
<span class="linenr"> 4: </span><span class=
"org-doc">   * ;(</span>
<span class="linenr"> 5: </span><span class=
"org-doc">   *   ([__temp,__restore] = withAsyncContext(() =&gt; foo())),</span>
<span class="linenr"> 6: </span><span class=
"org-doc">   *   await __temp,</span>
<span class="linenr"> 7: </span><span class=
"org-doc">   *   __restore()</span>
<span class="linenr"> 8: </span><span class="org-doc">   * )</span>
<span class="linenr"> 9: </span><span class="org-doc">   *</span>
<span class="linenr">10: </span><span class=
"org-doc">   * const a = await foo()</span>
<span class="linenr">11: </span><span class=
"org-doc">   * --&gt;</span>
<span class="linenr">12: </span><span class=
"org-doc">   * const a = (</span>
<span class="linenr">13: </span><span class=
"org-doc">   *   ([__temp, __restore] = withAsyncContext(() =&gt; foo())),</span>
<span class="linenr">14: </span><span class=
"org-doc">   *   __temp = await __temp,</span>
<span class="linenr">15: </span><span class=
"org-doc">   *   __restore(),</span>
<span class="linenr">16: </span><span class=
"org-doc">   *   __temp</span>
<span class="linenr">17: </span><span class="org-doc">   * )</span>
<span class="linenr">18: </span><span class="org-doc">   */</span>
<span class="linenr">19: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">processAwait</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">needSemi</span>, <span class=
"org-variable-name">isStatement</span>) {
<span class="linenr">20: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">argumentStart</span> =
<span class=
"linenr">21: </span>      node.argument.extra &amp;& node.argument.extra.parenthesized
<span class=
"linenr">22: </span>        ? node.argument.extra.parenStart
<span class="linenr">23: </span>        : node.argument.start
<span class="linenr">24: </span>
<span class="linenr">25: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">argumentStr</span> = source.slice(
<span class="linenr">26: </span>      argumentStart + startOffset,
<span class=
"linenr">27: </span>      node.argument.end + startOffset
<span class="linenr">28: </span>    )
<span class="linenr">29: </span>
<span class="linenr">30: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">containsNestedAwait</span> = <span class=
"org-string">/\bawait\b/</span>.test(argumentStr)
<span class="linenr">31: </span>
<span class="linenr">32: </span>    s.overwrite(
<span class="linenr">33: </span>      node.start + startOffset,
<span class="linenr">34: </span>      argumentStart + startOffset,
<span class="linenr">35: </span>      <span class=
"org-string">`${needSemi ? `</span>;<span class=
"org-string">` : ``}(\n  ([__temp,__restore] = ${helper(</span>
<span class="linenr">36: </span><span class=
"org-string">        `</span>withAsyncContext<span class=
"org-string">`</span>
<span class="linenr">37: </span><span class=
"org-string">      )}(${containsNestedAwait ? `</span><span class=
"org-keyword">async</span> <span class=
"org-string">` : ``}() =&gt; `</span>
<span class="linenr">38: </span>    )
<span class="linenr">39: </span>    s.appendLeft(
<span class="linenr">40: </span>      node.end + startOffset,
<span class="linenr">41: </span>      <span class=
"org-string">`)),\n  ${isStatement ? `` : `</span>__temp = <span class="org-string">`}await __temp,\n  __restore()${</span>
<span class="linenr">42: </span><span class=
"org-string">        isStatement ? `` : `</span>,\n  __temp<span class="org-string">`</span>
<span class="linenr">43: </span><span class=
"org-string">      }\n)`</span>
<span class="linenr">44: </span>    )
<span class="linenr">45: </span>  }
<span class="linenr">46: </span>
<span class="linenr">47: </span>
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orged495a9" class="outline-4">
          <h4 id="orged495a9"><span class=
          "section-number-4">2.2.12.</span>
          hasStaticWithDefaults()</h4>
          <div class="outline-text-4" id="text-2-2-12">
            <div class="org-src-container">
              <pre class="src src-js" id="orgd82708e"><span class=
              "linenr"> 1: </span><span class="org-doc">/**</span>
<span class="linenr"> 2: </span><span class=
"org-doc">   * check defaults. If the default object is an object literal with only</span>
<span class="linenr"> 3: </span><span class=
"org-doc">   * static properties, we can directly generate more optimized default</span>
<span class="linenr"> 4: </span><span class=
"org-doc">   * declarations. Otherwise we will have to fallback to runtime merging.</span>
<span class="linenr"> 5: </span><span class="org-doc">   */</span>
<span class="linenr"> 6: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">hasStaticWithDefaults</span>() {
<span class="linenr"> 7: </span>    <span class=
"org-keyword">return</span> (
<span class="linenr"> 8: </span>      propsRuntimeDefaults &amp;&
<span class=
"linenr"> 9: </span>      propsRuntimeDefaults.type === <span class="org-string">'ObjectExpression'</span> &amp;&
<span class=
"linenr">10: </span>      propsRuntimeDefaults.properties.every(
<span class="linenr">11: </span>        node =&gt;
<span class=
"linenr">12: </span>          (node.type === <span class=
"org-string">'ObjectProperty'</span> &amp;& !node.computed) ||
<span class=
"linenr">13: </span>          node.type === <span class="org-string">'ObjectMethod'</span>
<span class="linenr">14: </span>      )
<span class="linenr">15: </span>    )
<span class="linenr">16: </span>  }
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org4a211df" class="outline-4">
          <h4 id="org4a211df"><span class=
          "section-number-4">2.2.13.</span> genRuntimeProps()</h4>
          <div class="outline-text-4" id="text-2-2-13">
            <div class="org-src-container">
              <pre class="src src-js" id="org228999f"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">genRuntimeProps</span>(<span class=
              "org-variable-name">props</span>) {
<span class="linenr"> 2: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keys</span> = Object.keys(props)
<span class="linenr"> 3: </span>    <span class=
"org-keyword">if</span> (!keys.length) {
<span class="linenr"> 4: </span>      <span class=
"org-keyword">return</span> <span class="org-string">``</span>
<span class="linenr"> 5: </span>    }
<span class="linenr"> 6: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">hasStaticDefaults</span> = hasStaticWithDefaults()
<span class="linenr"> 7: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptSetupSource</span> = scriptSetup.content
<span class="linenr"> 8: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">propsDecls</span> = <span class=
"org-string">`{</span>
<span class="linenr"> 9: </span><span class=
"org-string">    ${keys</span>
<span class="linenr">10: </span><span class=
"org-string">      .map(key =&gt; {</span>
<span class="linenr">11: </span><span class=
"org-string">        let defaultString</span>
<span class="linenr">12: </span><span class=
"org-string">        const destructured = genDestructuredDefaultValue(key)</span>
<span class="linenr">13: </span><span class=
"org-string">        if (destructured) {</span>
<span class="linenr">14: </span><span class=
"org-string">          defaultString = `</span><span class=
"org-keyword">default</span>: ${destructured}<span class=
"org-string">`</span>
<span class="linenr">15: </span><span class=
"org-string">        } else if (hasStaticDefaults) {</span>
<span class="linenr">16: </span><span class=
"org-string">          const prop = propsRuntimeDefaults.properties.find(</span>
<span class="linenr">17: </span><span class=
"org-string">            (node) =&gt; node.key.name === key</span>
<span class="linenr">18: </span><span class=
"org-string">          )</span>
<span class="linenr">19: </span><span class=
"org-string">          if (prop) {</span>
<span class="linenr">20: </span><span class=
"org-string">            if (prop.type === 'ObjectProperty') {</span>
<span class="linenr">21: </span><span class=
"org-string">              // prop has corresponding static default value</span>
<span class="linenr">22: </span><span class=
"org-string">              defaultString = `</span><span class=
"org-keyword">default</span>: ${scriptSetupSource.slice(
<span class="linenr">23: </span>                prop.value.start,
<span class="linenr">24: </span>                prop.value.end
<span class="linenr">25: </span>              )}<span class=
"org-string">`</span>
<span class="linenr">26: </span><span class=
"org-string">            } else {</span>
<span class="linenr">27: </span><span class=
"org-string">              defaultString = `</span><span class=
"org-keyword">default</span>() ${scriptSetupSource.slice(
<span class="linenr">28: </span>                prop.body.start,
<span class="linenr">29: </span>                prop.body.end
<span class="linenr">30: </span>              )}<span class=
"org-string">`</span>
<span class="linenr">31: </span><span class=
"org-string">            }</span>
<span class="linenr">32: </span><span class=
"org-string">          }</span>
<span class="linenr">33: </span><span class=
"org-string">        }</span>
<span class="linenr">34: </span>
<span class="linenr">35: </span><span class=
"org-string">        const { type, required } = props[key]</span>
<span class="linenr">36: </span><span class=
"org-string">        if (!isProd) {</span>
<span class="linenr">37: </span><span class=
"org-string">          return `</span>${key}: { type: ${toRuntimeTypeString(
<span class="linenr">38: </span>            type
<span class=
"linenr">39: </span>          )}, required: ${required}${
<span class=
"linenr">40: </span>            defaultString ? <span class=
"org-string">`, ${defaultString}`</span> : <span class=
"org-string">``</span>
<span class="linenr">41: </span>          } }<span class=
"org-string">`</span>
<span class="linenr">42: </span><span class=
"org-string">        } else if (</span>
<span class="linenr">43: </span><span class=
"org-string">          type.some(</span>
<span class="linenr">44: </span><span class=
"org-string">            el =&gt; el === 'Boolean' || (defaultString &amp;& el === 'Function')</span>
<span class="linenr">45: </span><span class=
"org-string">          )</span>
<span class="linenr">46: </span><span class=
"org-string">        ) {</span>
<span class="linenr">47: </span><span class=
"org-string">          // #4783 production: if boolean or defaultString and function exists, should keep the type.</span>
<span class="linenr">48: </span><span class=
"org-string">          return `</span>${key}: { type: ${toRuntimeTypeString(type)}${
<span class=
"linenr">49: </span>            defaultString ? <span class=
"org-string">`, ${defaultString}`</span> : <span class=
"org-string">``</span>
<span class="linenr">50: </span>          } }<span class=
"org-string">`</span>
<span class="linenr">51: </span><span class=
"org-string">        } else {</span>
<span class="linenr">52: </span><span class=
"org-string">          // production: checks are useless</span>
<span class="linenr">53: </span><span class=
"org-string">          return `</span>${key}: ${defaultString ? <span class="org-string">`{ ${defaultString} }`</span> : <span class="org-string">'null'</span>}<span class="org-string">`</span>
<span class="linenr">54: </span><span class=
"org-string">        }</span>
<span class="linenr">55: </span><span class=
"org-string">      })</span>
<span class="linenr">56: </span><span class=
"org-string">      .join(',\n    ')}\n  }`</span>
<span class="linenr">57: </span>
<span class="linenr">58: </span>    <span class=
"org-keyword">if</span> (propsRuntimeDefaults &amp;& !hasStaticDefaults) {
<span class="linenr">59: </span>      propsDecls = <span class=
"org-string">`${helper('mergeDefaults')}(${propsDecls}, ${source.slice(</span>
<span class="linenr">60: </span><span class=
"org-string">        propsRuntimeDefaults.start + startOffset,</span>
<span class="linenr">61: </span><span class=
"org-string">        propsRuntimeDefaults.end + startOffset</span>
<span class="linenr">62: </span><span class=
"org-string">      )})`</span>
<span class="linenr">63: </span>    }
<span class="linenr">64: </span>
<span class="linenr">65: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`\n  props: ${propsDecls},`</span>
<span class="linenr">66: </span>  }
<span class="linenr">67: </span>
<span class="linenr">68: </span>
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org5320144" class="outline-4">
          <h4 id="org5320144"><span class=
          "section-number-4">2.2.14.</span>
          genDestructuredDefaultValue()</h4>
          <div class="outline-text-4" id="text-2-2-14">
            <div class="org-src-container">
              <pre class="src src-js" id="org17237f6"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">genDestructuredDefaultValue</span>(<span class=
              "org-variable-name">key</span>) {
<span class="linenr"> 2: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">destructured</span> = propsDestructuredBindings[key]
<span class="linenr"> 3: </span>    <span class=
"org-keyword">if</span> (destructured &amp;& destructured.<span class="org-keyword">default</span>) {
<span class="linenr"> 4: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">value</span> = scriptSetup.content.slice(
<span class="linenr"> 5: </span>        destructured.<span class=
"org-keyword">default</span>.start,
<span class="linenr"> 6: </span>        destructured.<span class=
"org-keyword">default</span>.end
<span class="linenr"> 7: </span>      )
<span class="linenr"> 8: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isLiteral</span> = destructured.<span class=
"org-keyword">default</span>.type.endsWith(<span class=
"org-string">'Literal'</span>)
<span class="linenr"> 9: </span>      <span class=
"org-keyword">return</span> isLiteral ? value : <span class=
"org-string">`() =&gt; ${value}`</span>
<span class="linenr">10: </span>    }
<span class="linenr">11: </span>  }
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org45d51ad" class="outline-4">
          <h4 id="org45d51ad"><span class=
          "section-number-4">2.2.15.</span>
          genSetupPropsType()</h4>
          <div class="outline-text-4" id="text-2-2-15">
            <div class="org-src-container">
              <pre class="src src-js" id="org59a324c"><span class=
              "linenr"> 1: </span>
<span class="linenr"> 2: </span>  <span class=
"org-keyword">function</span> <span class=
"org-function-name">genSetupPropsType</span>(<span class=
"org-variable-name">node</span>) {
<span class="linenr"> 3: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptSetupSource</span> = scriptSetup.content
<span class="linenr"> 4: </span>    <span class=
"org-keyword">if</span> (hasStaticWithDefaults()) {
<span class="linenr"> 5: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if withDefaults() is used, we need to remove the optional flags</span>
<span class="linenr"> 6: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">on props that have default values</span>
<span class="linenr"> 7: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">res</span> = <span class=
"org-string">`{ `</span>
<span class="linenr"> 8: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">members</span> = node.type === <span class=
"org-string">'TSTypeLiteral'</span> ? node.members : node.body
<span class="linenr"> 9: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">m</span> <span class=
"org-keyword">of</span> members) {
<span class="linenr">10: </span>        <span class=
"org-keyword">if</span> (
<span class="linenr">11: </span>          (m.type === <span class=
"org-string">'TSPropertySignature'</span> ||
<span class="linenr">12: </span>            m.type === <span class=
"org-string">'TSMethodSignature'</span>) &amp;&
<span class="linenr">13: </span>          m.typeAnnotation &amp;&
<span class=
"linenr">14: </span>          m.key.type === <span class=
"org-string">'Identifier'</span>
<span class="linenr">15: </span>        ) {
<span class="linenr">16: </span>          <span class=
"org-keyword">if</span> (
<span class=
"linenr">17: </span>            propsRuntimeDefaults.properties.some(
<span class=
"linenr">18: </span>              (p) =&gt; p.key.name === m.key.name
<span class="linenr">19: </span>            )
<span class="linenr">20: </span>          ) {
<span class="linenr">21: </span>            res +=
<span class="linenr">22: </span>              m.key.name +
<span class=
"linenr">23: </span>              (m.type === <span class=
"org-string">'TSMethodSignature'</span> ? <span class=
"org-string">'()'</span> : <span class="org-string">''</span>) +
<span class=
"linenr">24: </span>              scriptSetupSource.slice(
<span class=
"linenr">25: </span>                m.typeAnnotation.start,
<span class=
"linenr">26: </span>                m.typeAnnotation.end
<span class="linenr">27: </span>              ) +
<span class="linenr">28: </span>              <span class=
"org-string">', '</span>
<span class="linenr">29: </span>          } <span class=
"org-keyword">else</span> {
<span class="linenr">30: </span>            res +=
<span class=
"linenr">31: </span>              scriptSetupSource.slice(m.start, m.typeAnnotation.end) + <span class="org-string">`, `</span>
<span class="linenr">32: </span>          }
<span class="linenr">33: </span>        }
<span class="linenr">34: </span>      }
<span class="linenr">35: </span>      <span class=
"org-keyword">return</span> (res.length ? res.slice(<span class=
"org-highlight-numbers-number">0</span>, -<span class=
"org-highlight-numbers-number">2</span>) : res) + <span class=
"org-string">` }`</span>
<span class="linenr">36: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">37: </span>      <span class=
"org-keyword">return</span> scriptSetupSource.slice(node.start, node.end)
<span class="linenr">38: </span>    }
<span class="linenr">39: </span>  }
</pre>
            </div>
          </div>
        </div>
      </div>
      <div id="outline-container-org0a984a9" class="outline-3">
        <h3 id="org0a984a9"><span class=
        "section-number-3">2.3.</span> steps</h3>
        <div class="outline-text-3" id="text-2-3">
          <div class="org-src-container">
            <pre class="src src-js" id="orge1fc369"><span class=
            "linenr"> 1: </span>&lt;&lt;cs-s-processNormalScript&gt;&gt;
<span class=
"linenr"> 2: </span>&lt;&lt;cs-s-processSetupScript&gt;&gt;
<span class=
"linenr"> 3: </span>&lt;&lt;cs-s-applyReactivityTransform&gt;&gt;
<span class=
"linenr"> 4: </span>&lt;&lt;cs-s-extractRuntimePropsEmits&gt;&gt;
<span class=
"linenr"> 5: </span>&lt;&lt;cs-s-checkUseOptions&gt;&gt;
<span class=
"linenr"> 6: </span>&lt;&lt;cs-s-removeNonScriptContent&gt;&gt;
<span class=
"linenr"> 7: </span>&lt;&lt;cs-s-analyzeBindingMetadata&gt;&gt;
<span class=
"linenr"> 8: </span>&lt;&lt;cs-s-injectUseCssVarsCalls&gt;&gt;
<span class=
"linenr"> 9: </span>&lt;&lt;cs-s-finalizeSetupArgumentSignature&gt;&gt;
<span class=
"linenr">10: </span>&lt;&lt;cs-s-finalizeSetupArgumentSignature&gt;&gt;
<span class=
"linenr">11: </span>&lt;&lt;cs-s-generateReturnStatement&gt;&gt;
<span class=
"linenr">12: </span>&lt;&lt;cs-s-finalizeDefaultExport&gt;&gt;
<span class=
"linenr">13: </span>&lt;&lt;cs-s-finalizeVueHelperImports&gt;&gt;
</pre>
          </div>
        </div>
        <div id="outline-container-org934fbd6" class="outline-4">
          <h4 id="org934fbd6"><span class=
          "section-number-4">2.3.1.</span> process normal
          script</h4>
          <div class="outline-text-4" id="text-2-3-1">
            <div class="org-src-container">
              <pre class="src src-js" id="org20e39cf"><span class=
              "linenr">  1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">processNormalScript</span>() {
<span class="linenr">  2: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">scriptAst</span>
<span class="linenr">  3: </span>  <span class=
"org-keyword">if</span> (script) {
<span class="linenr">  4: </span>    scriptAst = parse(
<span class="linenr">  5: </span>      script.content,
<span class="linenr">  6: </span>      {
<span class="linenr">  7: </span>        plugins,
<span class="linenr">  8: </span>        sourceType: <span class=
"org-string">'module'</span>
<span class="linenr">  9: </span>      },
<span class="linenr"> 10: </span>      scriptStartOffset
<span class="linenr"> 11: </span>    )
<span class="linenr"> 12: </span>
<span class="linenr"> 13: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> <span class=
"org-keyword">of</span> scriptAst.body) {
<span class="linenr"> 14: </span>      <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ImportDeclaration'</span>) {
<span class="linenr"> 15: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">record imports for dedupe</span>
<span class="linenr"> 16: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">specifier</span> <span class=
"org-keyword">of</span> node.specifiers) {
<span class="linenr"> 17: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">imported</span> =
<span class=
"linenr"> 18: </span>            specifier.type === <span class=
"org-string">'ImportSpecifier'</span> &amp;&
<span class=
"linenr"> 19: </span>            specifier.imported.type === <span class="org-string">'Identifier'</span> &amp;&
<span class=
"linenr"> 20: </span>            specifier.imported.name
<span class="linenr"> 21: </span>          registerUserImport(
<span class="linenr"> 22: </span>            node.source.value,
<span class="linenr"> 23: </span>            specifier.local.name,
<span class="linenr"> 24: </span>            imported,
<span class=
"linenr"> 25: </span>            node.importKind === <span class=
"org-string">'type'</span> ||
<span class=
"linenr"> 26: </span>              (specifier.type === <span class=
"org-string">'ImportSpecifier'</span> &amp;&
<span class=
"linenr"> 27: </span>                specifier.importKind === <span class="org-string">'type'</span>),
<span class="linenr"> 28: </span>            <span class=
"org-constant">false</span>
<span class="linenr"> 29: </span>          )
<span class="linenr"> 30: </span>        }
<span class="linenr"> 31: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ExportDefaultDeclaration'</span>) {
<span class="linenr"> 32: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export default</span>
<span class="linenr"> 33: </span>        defaultExport = node
<span class="linenr"> 34: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export default { ... } --&gt; const __default__ = { ... }</span>
<span class="linenr"> 35: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = node.start + scriptStartOffset
<span class="linenr"> 36: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">end</span> = node.declaration.start + scriptStartOffset
<span class=
"linenr"> 37: </span>        s.overwrite(start, end, <span class=
"org-string">`const ${DEFAULT_VAR} = `</span>)
<span class="linenr"> 38: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ExportNamedDeclaration'</span>) {
<span class="linenr"> 39: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">defaultSpecifier</span> = node.specifiers.find(
<span class=
"linenr"> 40: </span>          s =&gt; s.exported.type === <span class="org-string">'Identifier'</span> &amp;& s.exported.name === <span class="org-string">'default'</span>
<span class="linenr"> 41: </span>        )
<span class="linenr"> 42: </span>        <span class=
"org-keyword">if</span> (defaultSpecifier) {
<span class="linenr"> 43: </span>          defaultExport = node
<span class="linenr"> 44: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">1. remove specifier</span>
<span class="linenr"> 45: </span>          <span class=
"org-keyword">if</span> (node.specifiers.length &gt; <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr"> 46: </span>            s.remove(
<span class=
"linenr"> 47: </span>              defaultSpecifier.start + scriptStartOffset,
<span class=
"linenr"> 48: </span>              defaultSpecifier.end + scriptStartOffset
<span class="linenr"> 49: </span>            )
<span class="linenr"> 50: </span>          } <span class=
"org-keyword">else</span> {
<span class="linenr"> 51: </span>            s.remove(
<span class=
"linenr"> 52: </span>              node.start + scriptStartOffset,
<span class=
"linenr"> 53: </span>              node.end + scriptStartOffset
<span class="linenr"> 54: </span>            )
<span class="linenr"> 55: </span>          }
<span class="linenr"> 56: </span>          <span class=
"org-keyword">if</span> (node.source) {
<span class="linenr"> 57: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export { x as default } from './x'</span>
<span class="linenr"> 58: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">rewrite to `import { x as __default__ } from './x'` and</span>
<span class="linenr"> 59: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">add to top</span>
<span class="linenr"> 60: </span>            s.prepend(
<span class="linenr"> 61: </span>              <span class=
"org-string">`import { ${defaultSpecifier.local.name} as ${DEFAULT_VAR} } from '${node.source.value}'\n`</span>
<span class="linenr"> 62: </span>            )
<span class="linenr"> 63: </span>          } <span class=
"org-keyword">else</span> {
<span class="linenr"> 64: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export { x as default }</span>
<span class="linenr"> 65: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">rewrite to `const __default__ = x` and move to end</span>
<span class="linenr"> 66: </span>            s.appendLeft(
<span class="linenr"> 67: </span>              scriptEndOffset,
<span class="linenr"> 68: </span>              <span class=
"org-string">`\nconst ${DEFAULT_VAR} = ${defaultSpecifier.local.name}\n`</span>
<span class="linenr"> 69: </span>            )
<span class="linenr"> 70: </span>          }
<span class="linenr"> 71: </span>        }
<span class="linenr"> 72: </span>        <span class=
"org-keyword">if</span> (node.declaration) {
<span class=
"linenr"> 73: </span>          walkDeclaration(node.declaration, scriptBindings, userImportAlias)
<span class="linenr"> 74: </span>        }
<span class="linenr"> 75: </span>      } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr"> 76: </span>        (node.type === <span class="org-string">'VariableDeclaration'</span> ||
<span class=
"linenr"> 77: </span>          node.type === <span class=
"org-string">'FunctionDeclaration'</span> ||
<span class=
"linenr"> 78: </span>          node.type === <span class=
"org-string">'ClassDeclaration'</span> ||
<span class=
"linenr"> 79: </span>          node.type === <span class=
"org-string">'TSEnumDeclaration'</span>) &amp;&
<span class="linenr"> 80: </span>        !node.declare
<span class="linenr"> 81: </span>      ) {
<span class=
"linenr"> 82: </span>        walkDeclaration(node, scriptBindings, userImportAlias)
<span class="linenr"> 83: </span>      }
<span class="linenr"> 84: </span>    }
<span class="linenr"> 85: </span>
<span class="linenr"> 86: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">apply reactivity transform</span>
<span class="linenr"> 87: </span>    <span class=
"org-keyword">if</span> (enableReactivityTransform &amp;& RT.shouldTransform(script.content)) {
<span class="linenr"> 88: </span>      <span class=
"org-keyword">const</span> { rootRefs, importedHelpers } = transformAST(
<span class="linenr"> 89: </span>        scriptAst,
<span class="linenr"> 90: </span>        s,
<span class="linenr"> 91: </span>        scriptStartOffset
<span class="linenr"> 92: </span>      )
<span class="linenr"> 93: </span>      refBindings = rootRefs
<span class="linenr"> 94: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">h</span> <span class=
"org-keyword">of</span> importedHelpers) {
<span class="linenr"> 95: </span>        helperImports.add(h)
<span class="linenr"> 96: </span>      }
<span class="linenr"> 97: </span>    }
<span class="linenr"> 98: </span>
<span class="linenr"> 99: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;script&gt; after &lt;script setup&gt;</span>
<span class="linenr">100: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we need to move the block up so that `const __default__` is</span>
<span class="linenr">101: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">declared before being used in the actual component definition</span>
<span class="linenr">102: </span>    <span class=
"org-keyword">if</span> (scriptStartOffset &gt; startOffset) {
<span class=
"linenr">103: </span>      s.move(scriptStartOffset, scriptEndOffset, <span class="org-highlight-numbers-number">0</span>)
<span class="linenr">104: </span>    }
<span class="linenr">105: </span>  }
<span class="linenr">106: </span>
<span class="linenr">107: </span>  <span class=
"org-keyword">return</span> scriptAst
<span class="linenr">108: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org69d0234" class="outline-4">
          <h4 id="org69d0234"><span class=
          "section-number-4">2.3.2.</span> process setup
          script</h4>
          <div class="outline-text-4" id="text-2-3-2">
            <div class="org-src-container">
              <pre class="src src-js" id="orgcadeb0e"><span class=
              "linenr">  1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">processSetupScript</span>() {
<span class="linenr">  2: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">scriptSetupAst</span> = babelParser.parse(
<span class="linenr">  3: </span>    scriptSetup.content,
<span class="linenr">  4: </span>    {
<span class="linenr">  5: </span>      plugins: [
<span class="linenr">  6: </span>        ...plugins,
<span class="linenr">  7: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">allow top level await but only inside &lt;script setup&gt;</span>
<span class="linenr">  8: </span>        <span class=
"org-string">'topLevelAwait'</span>
<span class="linenr">  9: </span>      ],
<span class="linenr"> 10: </span>      sourceType: <span class=
"org-string">'module'</span>
<span class="linenr"> 11: </span>    },
<span class="linenr"> 12: </span>    startOffset
<span class="linenr"> 13: </span>  )
<span class="linenr"> 14: </span>
<span class="linenr"> 15: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> <span class=
"org-keyword">of</span> scriptSetupAst.body) {
<span class="linenr"> 16: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">start</span> = node.start + startOffset
<span class="linenr"> 17: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">end</span> = node.end + startOffset
<span class="linenr"> 18: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">locate comment</span>
<span class="linenr"> 19: </span>    <span class=
"org-keyword">if</span> (node.trailingComments &amp;& node.trailingComments.length &gt; <span class="org-highlight-numbers-number">0</span>) {
<span class="linenr"> 20: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">lastCommentNode</span> =
<span class=
"linenr"> 21: </span>        node.trailingComments[node.trailingComments.length - <span class="org-highlight-numbers-number">1</span>]
<span class=
"linenr"> 22: </span>      end = lastCommentNode.end + startOffset
<span class="linenr"> 23: </span>    }
<span class="linenr"> 24: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">locate the end of whitespace between this statement and the next</span>
<span class="linenr"> 25: </span>    <span class=
"org-keyword">while</span> (end &lt;= source.length) {
<span class="linenr"> 26: </span>      <span class=
"org-keyword">if</span> (!<span class=
"org-string">/\s/</span>.test(source.charAt(end))) {
<span class="linenr"> 27: </span>        <span class=
"org-keyword">break</span>
<span class="linenr"> 28: </span>      }
<span class="linenr"> 29: </span>      end++
<span class="linenr"> 30: </span>    }
<span class="linenr"> 31: </span>
<span class="linenr"> 32: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">(Dropped) `ref: x` bindings</span>
<span class="linenr"> 33: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr"> 34: </span>      node.type === <span class=
"org-string">'LabeledStatement'</span> &amp;&
<span class=
"linenr"> 35: </span>      node.label.name === <span class=
"org-string">'ref'</span> &amp;&
<span class=
"linenr"> 36: </span>      node.body.type === <span class=
"org-string">'ExpressionStatement'</span>
<span class="linenr"> 37: </span>    ) {
<span class="linenr"> 38: </span>      error(
<span class="linenr"> 39: </span>        <span class=
"org-string">`ref sugar using the label syntax was an experimental proposal and `</span> +
<span class="linenr"> 40: </span>          <span class=
"org-string">`has been dropped based on community feedback. Please check out `</span> +
<span class="linenr"> 41: </span>          <span class=
"org-string">`the new proposal at https://github.com/vuejs/rfcs/discussions/369`</span>,
<span class="linenr"> 42: </span>        node
<span class="linenr"> 43: </span>      )
<span class="linenr"> 44: </span>    }
<span class="linenr"> 45: </span>
<span class="linenr"> 46: </span>    <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ImportDeclaration'</span>) {
<span class="linenr"> 47: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">import declarations are moved to top</span>
<span class=
"linenr"> 48: </span>      s.move(start, end, <span class=
"org-highlight-numbers-number">0</span>)
<span class="linenr"> 49: </span>
<span class="linenr"> 50: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">dedupe imports</span>
<span class="linenr"> 51: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">removed</span> = <span class=
"org-highlight-numbers-number">0</span>
<span class="linenr"> 52: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">removeSpecifier</span> = (i) =&gt; {
<span class="linenr"> 53: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">removeLeft</span> = i &gt; removed
<span class="linenr"> 54: </span>        removed++
<span class="linenr"> 55: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">current</span> = node.specifiers[i]
<span class="linenr"> 56: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">next</span> = node.specifiers[i + <span class=
"org-highlight-numbers-number">1</span>]
<span class="linenr"> 57: </span>        s.remove(
<span class="linenr"> 58: </span>          removeLeft
<span class=
"linenr"> 59: </span>            ? node.specifiers[i - <span class=
"org-highlight-numbers-number">1</span>].end + startOffset
<span class=
"linenr"> 60: </span>            : current.start + startOffset,
<span class="linenr"> 61: </span>          next &amp;& !removeLeft
<span class=
"linenr"> 62: </span>            ? next.start + startOffset
<span class=
"linenr"> 63: </span>            : current.end + startOffset
<span class="linenr"> 64: </span>        )
<span class="linenr"> 65: </span>      }
<span class="linenr"> 66: </span>
<span class="linenr"> 67: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.specifiers.length; i++) {
<span class="linenr"> 68: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">specifier</span> = node.specifiers[i]
<span class="linenr"> 69: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">local</span> = specifier.local.name
<span class="linenr"> 70: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">imported</span> =
<span class=
"linenr"> 71: </span>          specifier.type === <span class=
"org-string">'ImportSpecifier'</span> &amp;&
<span class=
"linenr"> 72: </span>          specifier.imported.type === <span class="org-string">'Identifier'</span> &amp;&
<span class="linenr"> 73: </span>          specifier.imported.name
<span class="linenr"> 74: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">source</span> = node.source.value
<span class="linenr"> 75: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">existing</span> = userImports[local]
<span class="linenr"> 76: </span>        <span class=
"org-keyword">if</span> (
<span class="linenr"> 77: </span>          source === <span class=
"org-string">'vue'</span> &amp;&
<span class=
"linenr"> 78: </span>          (imported === DEFINE_PROPS ||
<span class=
"linenr"> 79: </span>            imported === DEFINE_EMITS ||
<span class=
"linenr"> 80: </span>            imported === DEFINE_EXPOSE)
<span class="linenr"> 81: </span>        ) {
<span class="linenr"> 82: </span>          removeSpecifier(i)
<span class="linenr"> 83: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (existing) {
<span class="linenr"> 84: </span>          <span class=
"org-keyword">if</span> (existing.source === source &amp;& existing.imported === imported) {
<span class="linenr"> 85: </span>            <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">already imported in &lt;script setup&gt;, dedupe</span>
<span class="linenr"> 86: </span>            removeSpecifier(i)
<span class="linenr"> 87: </span>          } <span class=
"org-keyword">else</span> {
<span class="linenr"> 88: </span>            error(<span class=
"org-string">`different imports aliased to same local name.`</span>, specifier)
<span class="linenr"> 89: </span>          }
<span class="linenr"> 90: </span>        } <span class=
"org-keyword">else</span> {
<span class="linenr"> 91: </span>          registerUserImport(
<span class="linenr"> 92: </span>            source,
<span class="linenr"> 93: </span>            local,
<span class="linenr"> 94: </span>            imported,
<span class=
"linenr"> 95: </span>            node.importKind === <span class=
"org-string">'type'</span> ||
<span class=
"linenr"> 96: </span>              (specifier.type === <span class=
"org-string">'ImportSpecifier'</span> &amp;&
<span class=
"linenr"> 97: </span>                specifier.importKind === <span class="org-string">'type'</span>),
<span class="linenr"> 98: </span>            <span class=
"org-constant">true</span>
<span class="linenr"> 99: </span>          )
<span class="linenr">100: </span>        }
<span class="linenr">101: </span>      }
<span class="linenr">102: </span>      <span class=
"org-keyword">if</span> (node.specifiers.length &amp;& removed === node.specifiers.length) {
<span class=
"linenr">103: </span>        s.remove(node.start + startOffset, node.end + startOffset)
<span class="linenr">104: </span>      }
<span class="linenr">105: </span>    }
<span class="linenr">106: </span>
<span class="linenr">107: </span>    <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ExpressionStatement'</span>) {
<span class="linenr">108: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">process `defineProps` and `defineEmit(s)` calls</span>
<span class="linenr">109: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr">110: </span>        processDefineProps(node.expression) ||
<span class=
"linenr">111: </span>        processDefineEmits(node.expression) ||
<span class=
"linenr">112: </span>        processWithDefaults(node.expression)
<span class="linenr">113: </span>      ) {
<span class=
"linenr">114: </span>        s.remove(node.start + startOffset, node.end + startOffset)
<span class="linenr">115: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (processDefineExpose(node.expression)) {
<span class="linenr">116: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">defineExpose({}) -&gt; expose({})</span>
<span class="linenr">117: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">callee</span> = node.expression.callee
<span class="linenr">118: </span>        s.overwrite(
<span class=
"linenr">119: </span>          callee.start + startOffset,
<span class=
"linenr">120: </span>          callee.end + startOffset,
<span class="linenr">121: </span>          <span class=
"org-string">'expose'</span>
<span class="linenr">122: </span>        )
<span class="linenr">123: </span>      }
<span class="linenr">124: </span>    }
<span class="linenr">125: </span>
<span class="linenr">126: </span>    <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'VariableDeclaration'</span> &amp;& !node.declare) {
<span class="linenr">127: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">total</span> = node.declarations.length
<span class="linenr">128: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">left</span> = total
<span class="linenr">129: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; total; i++) {
<span class="linenr">130: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">decl</span> = node.declarations[i]
<span class="linenr">131: </span>        <span class=
"org-keyword">if</span> (decl.init) {
<span class="linenr">132: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">defineProps / defineEmits</span>
<span class="linenr">133: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDefineProps</span> =
<span class=
"linenr">134: </span>            processDefineProps(decl.init, decl.id) ||
<span class=
"linenr">135: </span>            processWithDefaults(decl.init, decl.id)
<span class="linenr">136: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDefineEmits</span> = processDefineEmits(decl.init, decl.id)
<span class="linenr">137: </span>          <span class=
"org-keyword">if</span> (isDefineProps || isDefineEmits) {
<span class="linenr">138: </span>            <span class=
"org-keyword">if</span> (left === <span class=
"org-highlight-numbers-number">1</span>) {
<span class=
"linenr">139: </span>              s.remove(node.start + startOffset, node.end + startOffset)
<span class="linenr">140: </span>            } <span class=
"org-keyword">else</span> {
<span class="linenr">141: </span>              <span class=
"org-keyword">let</span> <span class=
"org-variable-name">start</span> = decl.start + startOffset
<span class="linenr">142: </span>              <span class=
"org-keyword">let</span> <span class=
"org-variable-name">end</span> = decl.end + startOffset
<span class="linenr">143: </span>              <span class=
"org-keyword">if</span> (i &lt; total - <span class=
"org-highlight-numbers-number">1</span>) {
<span class="linenr">144: </span>                <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">not the last one, locate the start of the next</span>
<span class=
"linenr">145: </span>                end = node.declarations[i + <span class="org-highlight-numbers-number">1</span>].start + startOffset
<span class="linenr">146: </span>              } <span class=
"org-keyword">else</span> {
<span class="linenr">147: </span>                <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">last one, locate the end of the prev</span>
<span class=
"linenr">148: </span>                start = node.declarations[i - <span class="org-highlight-numbers-number">1</span>].end + startOffset
<span class="linenr">149: </span>              }
<span class="linenr">150: </span>              s.remove(start, end)
<span class="linenr">151: </span>              left--
<span class="linenr">152: </span>            }
<span class="linenr">153: </span>          }
<span class="linenr">154: </span>        }
<span class="linenr">155: </span>      }
<span class="linenr">156: </span>    }
<span class="linenr">157: </span>
<span class="linenr">158: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">walk declarations to record declared bindings</span>
<span class="linenr">159: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr">160: </span>      (node.type === <span class=
"org-string">'VariableDeclaration'</span> ||
<span class="linenr">161: </span>        node.type === <span class=
"org-string">'FunctionDeclaration'</span> ||
<span class="linenr">162: </span>        node.type === <span class=
"org-string">'ClassDeclaration'</span>) &amp;&
<span class="linenr">163: </span>      !node.declare
<span class="linenr">164: </span>    ) {
<span class=
"linenr">165: </span>      walkDeclaration(node, setupBindings, userImportAlias)
<span class="linenr">166: </span>    }
<span class="linenr">167: </span>
<span class="linenr">168: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">walk statements & named exports / variable declarations for top level</span>
<span class="linenr">169: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">await</span>
<span class="linenr">170: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr">171: </span>      (node.type === <span class=
"org-string">'VariableDeclaration'</span> &amp;& !node.declare) ||
<span class=
"linenr">172: </span>      node.type.endsWith(<span class=
"org-string">'Statement'</span>)
<span class="linenr">173: </span>    ) {
<span class="linenr">174: </span>      walk(node, {
<span class="linenr">175: </span>        enter(child, parent) {
<span class="linenr">176: </span>          <span class=
"org-keyword">if</span> (isFunctionType(child)) {
<span class="linenr">177: </span>            <span class=
"org-constant">this</span>.skip()
<span class="linenr">178: </span>          }
<span class="linenr">179: </span>          <span class=
"org-keyword">if</span> (child.type === <span class=
"org-string">'AwaitExpression'</span>) {
<span class=
"linenr">180: </span>            hasAwait = <span class="org-constant">true</span>
<span class="linenr">181: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">needsSemi</span> = scriptSetupAst.body.some(n =&gt; {
<span class="linenr">182: </span>              <span class=
"org-keyword">return</span> n.type === <span class=
"org-string">'ExpressionStatement'</span> &amp;& n.start === child.start
<span class="linenr">183: </span>            })
<span class="linenr">184: </span>            processAwait(
<span class="linenr">185: </span>              child,
<span class="linenr">186: </span>              needsSemi,
<span class=
"linenr">187: </span>              parent.type === <span class=
"org-string">'ExpressionStatement'</span>
<span class="linenr">188: </span>            )
<span class="linenr">189: </span>          }
<span class="linenr">190: </span>        }
<span class="linenr">191: </span>      })
<span class="linenr">192: </span>    }
<span class="linenr">193: </span>
<span class="linenr">194: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr">195: </span>      (node.type === <span class=
"org-string">'ExportNamedDeclaration'</span> &amp;& node.exportKind !== <span class="org-string">'type'</span>) ||
<span class="linenr">196: </span>      node.type === <span class=
"org-string">'ExportAllDeclaration'</span> ||
<span class="linenr">197: </span>      node.type === <span class=
"org-string">'ExportDefaultDeclaration'</span>
<span class="linenr">198: </span>    ) {
<span class="linenr">199: </span>      error(
<span class="linenr">200: </span>        <span class=
"org-string">`&lt;script setup&gt; cannot contain ES module exports. `</span> +
<span class="linenr">201: </span>          <span class=
"org-string">`If you are using a previous version of &lt;script setup&gt;, please `</span> +
<span class="linenr">202: </span>          <span class=
"org-string">`consult the updated RFC at https://github.com/vuejs/rfcs/pull/227.`</span>,
<span class="linenr">203: </span>        node
<span class="linenr">204: </span>      )
<span class="linenr">205: </span>    }
<span class="linenr">206: </span>
<span class="linenr">207: </span>    <span class=
"org-keyword">if</span> (isTS) {
<span class="linenr">208: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">runtime enum</span>
<span class="linenr">209: </span>      <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'TSEnumDeclaration'</span>) {
<span class=
"linenr">210: </span>        registerBinding(setupBindings, node.id, BindingTypes.SETUP_CONST)
<span class="linenr">211: </span>      }
<span class="linenr">212: </span>
<span class="linenr">213: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">move all Type declarations to outer scope</span>
<span class="linenr">214: </span>      <span class=
"org-keyword">if</span> (
<span class=
"linenr">215: </span>        node.type.startsWith(<span class=
"org-string">'TS'</span>) ||
<span class=
"linenr">216: </span>        (node.type === <span class="org-string">'ExportNamedDeclaration'</span> &amp;&
<span class=
"linenr">217: </span>          node.exportKind === <span class=
"org-string">'type'</span>) ||
<span class=
"linenr">218: </span>        (node.type === <span class="org-string">'VariableDeclaration'</span> &amp;& node.declare)
<span class="linenr">219: </span>      ) {
<span class=
"linenr">220: </span>        recordType(node, declaredTypes)
<span class=
"linenr">221: </span>        s.move(start, end, <span class=
"org-highlight-numbers-number">0</span>)
<span class="linenr">222: </span>      }
<span class="linenr">223: </span>    }
<span class="linenr">224: </span>  }
<span class="linenr">225: </span>
<span class="linenr">226: </span>  <span class=
"org-keyword">return</span> scriptSetupAst
<span class="linenr">227: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgb9eb434" class="outline-4">
          <h4 id="orgb9eb434"><span class=
          "section-number-4">2.3.3.</span> apply reactivity
          transform</h4>
          <div class="outline-text-4" id="text-2-3-3">
            <div class="org-src-container">
              <pre class="src src-js" id="org5cc4a5c"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">applyReactivityTransform</span>() {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">if</span> (
<span class=
"linenr"> 3: </span>    (enableReactivityTransform &amp;&
<span class="linenr"> 4: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">normal &lt;script&gt; had ref bindings that maybe used in &lt;script setup&gt;</span>
<span class=
"linenr"> 5: </span>      (refBindings || RT.shouldTransform(scriptSetup.content))) ||
<span class="linenr"> 6: </span>    propsDestructureDecl
<span class="linenr"> 7: </span>  ) {
<span class="linenr"> 8: </span>    <span class=
"org-keyword">const</span> { rootRefs, importedHelpers } = transformAST(
<span class="linenr"> 9: </span>      scriptSetupAst,
<span class="linenr">10: </span>      s,
<span class="linenr">11: </span>      startOffset,
<span class="linenr">12: </span>      refBindings,
<span class="linenr">13: </span>      propsDestructuredBindings
<span class="linenr">14: </span>    )
<span class=
"linenr">15: </span>    refBindings = refBindings ? [...refBindings, ...rootRefs] : rootRefs
<span class="linenr">16: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">h</span> <span class=
"org-keyword">of</span> importedHelpers) {
<span class="linenr">17: </span>      helperImports.add(h)
<span class="linenr">18: </span>    }
<span class="linenr">19: </span>  }
<span class="linenr">20: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgef5f97f" class="outline-4">
          <h4 id="orgef5f97f"><span class=
          "section-number-4">2.3.4.</span> extract runtime
          props/emits</h4>
          <div class="outline-text-4" id="text-2-3-4">
            <div class="org-src-container">
              <pre class="src src-js" id="orgfa6dc06"><span class=
              "linenr">1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">extractRuntimePropsEmits</span>() {
<span class="linenr">2: </span>  <span class=
"org-keyword">if</span> (propsTypeDecl) {
<span class=
"linenr">3: </span>    extractRuntimeProps(propsTypeDecl, typeDeclaredProps, declaredTypes, isProd)
<span class="linenr">4: </span>  }
<span class="linenr">5: </span>  <span class=
"org-keyword">if</span> (emitsTypeDecl) {
<span class=
"linenr">6: </span>    extractRuntimeEmits(emitsTypeDecl, typeDeclaredEmits)
<span class="linenr">7: </span>  }
<span class="linenr">8: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org2f63b19" class="outline-4">
          <h4 id="org2f63b19"><span class=
          "section-number-4">2.3.5.</span> check useOptions dont
          ref setup scope variables</h4>
          <div class="outline-text-4" id="text-2-3-5">
            <div class="org-src-container">
              <pre class="src src-js" id="org57eb772"><span class=
              "linenr">1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">checkUseOptions</span>() {
<span class=
"linenr">2: </span>  checkInvalidScopeReference(propsRuntimeDecl, DEFINE_PROPS)
<span class=
"linenr">3: </span>  checkInvalidScopeReference(propsRuntimeDefaults, DEFINE_PROPS)
<span class=
"linenr">4: </span>  checkInvalidScopeReference(propsDestructureDecl, DEFINE_PROPS)
<span class=
"linenr">5: </span>  checkInvalidScopeReference(emitsRuntimeDecl, DEFINE_PROPS)
<span class="linenr">6: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org9e9ebdb" class="outline-4">
          <h4 id="org9e9ebdb"><span class=
          "section-number-4">2.3.6.</span> remove non-script
          content</h4>
          <div class="outline-text-4" id="text-2-3-6">
            <div class="org-src-container">
              <pre class="src src-js" id="org4c21bbb"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">removeNonScriptContent</span>() {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">if</span> (script) {
<span class="linenr"> 3: </span>    <span class=
"org-keyword">if</span> (startOffset &lt; scriptStartOffset) {
<span class="linenr"> 4: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;script setup&gt; before &lt;script&gt;</span>
<span class="linenr"> 5: </span>      s.remove(<span class=
"org-highlight-numbers-number">0</span>, startOffset)
<span class=
"linenr"> 6: </span>      s.remove(endOffset, scriptStartOffset)
<span class=
"linenr"> 7: </span>      s.remove(scriptEndOffset, source.length)
<span class="linenr"> 8: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr"> 9: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;script&gt; before &lt;script setup&gt;</span>
<span class="linenr">10: </span>      s.remove(<span class=
"org-highlight-numbers-number">0</span>, scriptStartOffset)
<span class=
"linenr">11: </span>      s.remove(scriptEndOffset, startOffset)
<span class=
"linenr">12: </span>      s.remove(endOffset, source.length)
<span class="linenr">13: </span>    }
<span class="linenr">14: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">15: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">only &lt;script setup&gt;</span>
<span class="linenr">16: </span>    s.remove(<span class=
"org-highlight-numbers-number">0</span>, startOffset)
<span class=
"linenr">17: </span>    s.remove(endOffset, source.length)
<span class="linenr">18: </span>  }
<span class="linenr">19: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgb8f7b27" class="outline-4">
          <h4 id="orgb8f7b27"><span class=
          "section-number-4">2.3.7.</span> analyze binding
          metadata</h4>
          <div class="outline-text-4" id="text-2-3-7">
            <div class="org-src-container">
              <pre class="src src-js" id="orga88fba4"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">analyzeBindingMetadata</span>() {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">if</span> (scriptAst) {
<span class=
"linenr"> 3: </span>    Object.assign(bindingMetadata, analyzeScriptBindings(scriptAst.body))
<span class="linenr"> 4: </span>  }
<span class="linenr"> 5: </span>  <span class=
"org-keyword">if</span> (propsRuntimeDecl) {
<span class="linenr"> 6: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">of</span> getObjectOrArrayExpressionKeys(propsRuntimeDecl)) {
<span class=
"linenr"> 7: </span>      bindingMetadata[key] = BindingTypes.PROPS
<span class="linenr"> 8: </span>    }
<span class="linenr"> 9: </span>  }
<span class="linenr">10: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> typeDeclaredProps) {
<span class=
"linenr">11: </span>    bindingMetadata[key] = BindingTypes.PROPS
<span class="linenr">12: </span>  }
<span class="linenr">13: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props aliases</span>
<span class="linenr">14: </span>  <span class=
"org-keyword">if</span> (propsDestructureDecl) {
<span class="linenr">15: </span>    <span class=
"org-keyword">if</span> (propsDestructureRestId) {
<span class=
"linenr">16: </span>      bindingMetadata[propsDestructureRestId] = BindingTypes.SETUP_CONST
<span class="linenr">17: </span>    }
<span class="linenr">18: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> propsDestructuredBindings) {
<span class="linenr">19: </span>      <span class=
"org-keyword">const</span> { local } = propsDestructuredBindings[key]
<span class="linenr">20: </span>      <span class=
"org-keyword">if</span> (local !== key) {
<span class=
"linenr">21: </span>        bindingMetadata[local] = BindingTypes.PROPS_ALIASED
<span class=
"linenr">22: </span>        ;(bindingMetadata.__propsAliases ||
<span class=
"linenr">23: </span>          (bindingMetadata.__propsAliases = {}))[local] = key
<span class="linenr">24: </span>      }
<span class="linenr">25: </span>    }
<span class="linenr">26: </span>  }
<span class="linenr">27: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> [key, { isType, imported, source }] <span class="org-keyword">of</span> Object.entries(
<span class="linenr">28: </span>    userImports
<span class="linenr">29: </span>  )) {
<span class="linenr">30: </span>    <span class=
"org-keyword">if</span> (isType) <span class=
"org-keyword">continue</span>
<span class="linenr">31: </span>    bindingMetadata[key] =
<span class="linenr">32: </span>      (imported === <span class=
"org-string">'default'</span> &amp;& source.endsWith(<span class=
"org-string">'.vue'</span>)) || source === <span class=
"org-string">'vue'</span>
<span class="linenr">33: </span>        ? BindingTypes.SETUP_CONST
<span class=
"linenr">34: </span>        : BindingTypes.SETUP_MAYBE_REF
<span class="linenr">35: </span>  }
<span class="linenr">36: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> scriptBindings) {
<span class=
"linenr">37: </span>    bindingMetadata[key] = scriptBindings[key]
<span class="linenr">38: </span>  }
<span class="linenr">39: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> setupBindings) {
<span class=
"linenr">40: </span>    bindingMetadata[key] = setupBindings[key]
<span class="linenr">41: </span>  }
<span class="linenr">42: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">known ref bindings</span>
<span class="linenr">43: </span>  <span class=
"org-keyword">if</span> (refBindings) {
<span class="linenr">44: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">of</span> refBindings) {
<span class=
"linenr">45: </span>      bindingMetadata[key] = BindingTypes.SETUP_REF
<span class="linenr">46: </span>    }
<span class="linenr">47: </span>  }
<span class="linenr">48: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgfeaa62f" class="outline-4">
          <h4 id="orgfeaa62f"><span class=
          "section-number-4">2.3.8.</span> inject useCssVars
          calls</h4>
          <div class="outline-text-4" id="text-2-3-8">
            <div class="org-src-container">
              <pre class="src src-js" id="orgce1c826"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">injectUseCssVarsCalls</span>() {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">if</span> (cssVars.length) {
<span class=
"linenr"> 3: </span>    helperImports.add(CSS_VARS_HELPER)
<span class="linenr"> 4: </span>    helperImports.add(<span class=
"org-string">'unref'</span>)
<span class="linenr"> 5: </span>    s.prependRight(
<span class="linenr"> 6: </span>      startOffset,
<span class="linenr"> 7: </span>      <span class=
"org-string">`\n${genCssVarsCode(cssVars, bindingMetadata, scopeId, isProd)}\n`</span>
<span class="linenr"> 8: </span>    )
<span class="linenr"> 9: </span>  }
<span class="linenr">10: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org09fc0a6" class="outline-4">
          <h4 id="org09fc0a6"><span class=
          "section-number-4">2.3.9.</span> finalize setup()
          argument signature</h4>
          <div class="outline-text-4" id="text-2-3-9">
            <div class="org-src-container">
              <pre class="src src-js" id="orgedd0d2f"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">finalizeSetupArgumentSignature</span>() {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">if</span> (propsTypeDecl) {
<span class="linenr"> 3: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">mark as any and only cast on assignment</span>
<span class="linenr"> 4: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">since the user defined complex types may be incompatible with the</span>
<span class="linenr"> 5: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inferred type from generated runtime declarations</span>
<span class="linenr"> 6: </span>    args += <span class=
"org-string">`: any`</span>
<span class="linenr"> 7: </span>  }
<span class="linenr"> 8: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject user assignment of props</span>
<span class="linenr"> 9: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we use a default __props so that template expressions referencing props</span>
<span class="linenr">10: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">can use it directly</span>
<span class="linenr">11: </span>  <span class=
"org-keyword">if</span> (propsIdentifier) {
<span class="linenr">12: </span>    s.prependLeft(
<span class="linenr">13: </span>      startOffset,
<span class="linenr">14: </span>      <span class=
"org-string">`\nconst ${propsIdentifier} = __props${</span>
<span class="linenr">15: </span><span class=
"org-string">        propsTypeDecl ? `</span> as ${genSetupPropsType(propsTypeDecl)}<span class="org-string">` : ``</span>
<span class="linenr">16: </span><span class=
"org-string">      }\n`</span>
<span class="linenr">17: </span>    )
<span class="linenr">18: </span>  }
<span class="linenr">19: </span>  <span class=
"org-keyword">if</span> (propsDestructureRestId) {
<span class="linenr">20: </span>    s.prependLeft(
<span class="linenr">21: </span>      startOffset,
<span class="linenr">22: </span>      <span class=
"org-string">`\nconst ${propsDestructureRestId} = ${helper(</span>
<span class="linenr">23: </span><span class=
"org-string">        `</span>createPropsRestProxy<span class=
"org-string">`</span>
<span class="linenr">24: </span><span class=
"org-string">      )}(__props, ${JSON.stringify(Object.keys(propsDestructuredBindings))})\n`</span>
<span class="linenr">25: </span>    )
<span class="linenr">26: </span>  }
<span class="linenr">27: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject temp variables for async context preservation</span>
<span class="linenr">28: </span>  <span class=
"org-keyword">if</span> (hasAwait) {
<span class="linenr">29: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">any</span> = isTS ? <span class=
"org-string">`: any`</span> : <span class="org-string">``</span>
<span class=
"linenr">30: </span>    s.prependLeft(startOffset, <span class=
"org-string">`\nlet __temp${any}, __restore${any}\n`</span>)
<span class="linenr">31: </span>  }
<span class="linenr">32: </span>
<span class="linenr">33: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">destructureElements</span> =
<span class=
"linenr">34: </span>    hasDefineExposeCall || !options.inlineTemplate ? [<span class="org-string">`expose`</span>] : []
<span class="linenr">35: </span>  <span class=
"org-keyword">if</span> (emitIdentifier) {
<span class="linenr">36: </span>    destructureElements.push(
<span class=
"linenr">37: </span>      emitIdentifier === <span class=
"org-string">`emit`</span> ? <span class=
"org-string">`emit`</span> : <span class=
"org-string">`emit: ${emitIdentifier}`</span>
<span class="linenr">38: </span>    )
<span class="linenr">39: </span>  }
<span class="linenr">40: </span>  <span class=
"org-keyword">if</span> (destructureElements.length) {
<span class="linenr">41: </span>    args += <span class=
"org-string">`, { ${destructureElements.join(', ')} }`</span>
<span class="linenr">42: </span>    <span class=
"org-keyword">if</span> (emitsTypeDecl) {
<span class="linenr">43: </span>      args += <span class=
"org-string">`: { emit: (${scriptSetup.content.slice(</span>
<span class="linenr">44: </span><span class=
"org-string">        emitsTypeDecl.start,</span>
<span class="linenr">45: </span><span class=
"org-string">        emitsTypeDecl.end</span>
<span class="linenr">46: </span><span class=
"org-string">      )}), expose: any, slots: any, attrs: any }`</span>
<span class="linenr">47: </span>    }
<span class="linenr">48: </span>  }
<span class="linenr">49: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orge3301b8" class="outline-4">
          <h4 id="orge3301b8"><span class=
          "section-number-4">2.3.10.</span> generate return
          statement</h4>
          <div class="outline-text-4" id="text-2-3-10">
            <div class="org-src-container">
              <pre class="src src-js" id="org684d15e"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">generateReturnStatement</span>() {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">if</span> (options.inlineTemplate) {
<span class="linenr"> 3: </span>    <span class=
"org-keyword">if</span> (sfc.template &amp;& !sfc.template.src) {
<span class="linenr"> 4: </span>      <span class=
"org-keyword">if</span> (options.templateOptions &amp;& options.templateOptions.ssr) {
<span class=
"linenr"> 5: </span>        hasInlinedSsrRenderFn = <span class=
"org-constant">true</span>
<span class="linenr"> 6: </span>      }
<span class="linenr"> 7: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inline render function mode - we are going to compile the template and</span>
<span class="linenr"> 8: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inline it right here</span>
<span class="linenr"> 9: </span>      <span class=
"org-keyword">const</span> { code, ast, preamble, tips, errors } = compileTemplate({
<span class="linenr">10: </span>        filename,
<span class=
"linenr">11: </span>        source: sfc.template.content,
<span class="linenr">12: </span>        inMap: sfc.template.map,
<span class="linenr">13: </span>        ...options.templateOptions,
<span class="linenr">14: </span>        id: scopeId,
<span class=
"linenr">15: </span>        scoped: sfc.styles.some(s =&gt; s.scoped),
<span class="linenr">16: </span>        isProd: options.isProd,
<span class="linenr">17: </span>        ssrCssVars: sfc.cssVars,
<span class="linenr">18: </span>        compilerOptions: {
<span class=
"linenr">19: </span>          ...(options.templateOptions &amp;&
<span class=
"linenr">20: </span>            options.templateOptions.compilerOptions),
<span class="linenr">21: </span>          inline: <span class=
"org-constant">true</span>,
<span class="linenr">22: </span>          isTS,
<span class="linenr">23: </span>          bindingMetadata
<span class="linenr">24: </span>        }
<span class="linenr">25: </span>      })
<span class="linenr">26: </span>
<span class="linenr">27: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">err</span> = errors[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr">28: </span>      <span class=
"org-keyword">if</span> (<span class=
"org-keyword">typeof</span> err === <span class=
"org-string">'string'</span>) {
<span class="linenr">29: </span>        <span class=
"org-keyword">throw</span> <span class=
"org-keyword">new</span> <span class="org-type">Error</span>(err)
<span class="linenr">30: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (err) {
<span class="linenr">31: </span>        <span class=
"org-keyword">if</span> (err.loc) {
<span class="linenr">32: </span>          err.message +=
<span class="linenr">33: </span>            <span class=
"org-string">`\n\n`</span> +
<span class="linenr">34: </span>            sfc.filename +
<span class="linenr">35: </span>            <span class=
"org-string">'\n'</span> +
<span class="linenr">36: </span>            generateCodeFrame(
<span class="linenr">37: </span>              source,
<span class="linenr">38: </span>              err.loc.start.offset,
<span class="linenr">39: </span>              err.loc.end.offset
<span class="linenr">40: </span>            ) +
<span class="linenr">41: </span>            <span class=
"org-string">`\n`</span>
<span class="linenr">42: </span>        }
<span class="linenr">43: </span>        <span class=
"org-keyword">throw</span> err
<span class="linenr">44: </span>      }
<span class="linenr">45: </span>      <span class=
"org-keyword">if</span> (preamble) {
<span class="linenr">46: </span>        s.prepend(preamble)
<span class="linenr">47: </span>      }
<span class="linenr">48: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">avoid duplicated unref import</span>
<span class="linenr">49: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">as this may get injected by the render function preamble OR the</span>
<span class="linenr">50: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">css vars codegen</span>
<span class="linenr">51: </span>      <span class=
"org-keyword">if</span> (ast &amp;& ast.helpers.includes(UNREF)) {
<span class="linenr">52: </span>        helperImports.<span class=
"org-keyword">delete</span>(<span class=
"org-string">'unref'</span>)
<span class="linenr">53: </span>      }
<span class="linenr">54: </span>      returned = code
<span class="linenr">55: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">56: </span>      returned = <span class=
"org-string">`() =&gt; {}`</span>
<span class="linenr">57: </span>    }
<span class="linenr">58: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">59: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">return bindings from script and script setup</span>
<span class="linenr">60: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">allBindings</span>= {
<span class="linenr">61: </span>      ...scriptBindings,
<span class="linenr">62: </span>      ...setupBindings
<span class="linenr">63: </span>    }
<span class="linenr">64: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> userImports) {
<span class="linenr">65: </span>      <span class=
"org-keyword">if</span> (!userImports[key].isType &amp;& userImports[key].isUsedInTemplate) {
<span class=
"linenr">66: </span>        allBindings[key] = <span class=
"org-constant">true</span>
<span class="linenr">67: </span>      }
<span class="linenr">68: </span>    }
<span class="linenr">69: </span>    returned = <span class=
"org-string">`{ ${Object.keys(allBindings).join(', ')} }`</span>
<span class="linenr">70: </span>  }
<span class="linenr">71: </span>
<span class="linenr">72: </span>  <span class=
"org-keyword">if</span> (!options.inlineTemplate) {
<span class="linenr">73: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">in non-inline mode, the `__isScriptSetup: true` flag is used by</span>
<span class="linenr">74: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">componentPublicInstance proxy to allow properties that start with $ or _</span>
<span class="linenr">75: </span>    s.appendRight(
<span class="linenr">76: </span>      endOffset,
<span class="linenr">77: </span>      <span class=
"org-string">`\nconst __returned__ = ${returned}\n`</span> +
<span class="linenr">78: </span>        <span class=
"org-string">`Object.defineProperty(__returned__, '__isScriptSetup', { enumerable: false, value: true })\n`</span> +
<span class="linenr">79: </span>        <span class=
"org-string">`return __returned__`</span> +
<span class="linenr">80: </span>        <span class=
"org-string">`\n}\n\n`</span>
<span class="linenr">81: </span>    )
<span class="linenr">82: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr">83: </span>    s.appendRight(endOffset, <span class=
"org-string">`\nreturn ${returned}\n}\n\n`</span>)
<span class="linenr">84: </span>  }
<span class="linenr">85: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgd6ebf1b" class="outline-4">
          <h4 id="orgd6ebf1b"><span class=
          "section-number-4">2.3.11.</span> finalize default
          export</h4>
          <div class="outline-text-4" id="text-2-3-11">
            <div class="org-src-container">
              <pre class="src src-js" id="org7b9b9a0"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">finalizeDefaultExport</span>() {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">runtimeOptions</span> = <span class=
"org-string">``</span>
<span class="linenr"> 3: </span>  <span class=
"org-keyword">if</span> (hasInlinedSsrRenderFn) {
<span class="linenr"> 4: </span>    runtimeOptions += <span class=
"org-string">`\n  __ssrInlineRender: true,`</span>
<span class="linenr"> 5: </span>  }
<span class="linenr"> 6: </span>  <span class=
"org-keyword">if</span> (propsRuntimeDecl) {
<span class="linenr"> 7: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">declCode</span> = scriptSetup.content
<span class=
"linenr"> 8: </span>      .slice(propsRuntimeDecl.start, propsRuntimeDecl.end)
<span class="linenr"> 9: </span>      .trim()
<span class="linenr">10: </span>    <span class=
"org-keyword">if</span> (propsDestructureDecl) {
<span class="linenr">11: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">defaults</span> = []
<span class="linenr">12: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> propsDestructuredBindings) {
<span class="linenr">13: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">d</span> = genDestructuredDefaultValue(key)
<span class="linenr">14: </span>        <span class=
"org-keyword">if</span> (d) defaults.push(<span class=
"org-string">`${key}: ${d}`</span>)
<span class="linenr">15: </span>      }
<span class="linenr">16: </span>      <span class=
"org-keyword">if</span> (defaults.length) {
<span class="linenr">17: </span>        declCode = <span class=
"org-string">`${helper(</span>
<span class="linenr">18: </span><span class=
"org-string">          `</span>mergeDefaults<span class=
"org-string">`</span>
<span class="linenr">19: </span><span class=
"org-string">        )}(${declCode}, {\n  ${defaults.join(',\n  ')}\n})`</span>
<span class="linenr">20: </span>      }
<span class="linenr">21: </span>    }
<span class="linenr">22: </span>    runtimeOptions += <span class=
"org-string">`\n  props: ${declCode},`</span>
<span class="linenr">23: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (propsTypeDecl) {
<span class=
"linenr">24: </span>    runtimeOptions += genRuntimeProps(typeDeclaredProps)
<span class="linenr">25: </span>  }
<span class="linenr">26: </span>  <span class=
"org-keyword">if</span> (emitsRuntimeDecl) {
<span class="linenr">27: </span>    runtimeOptions += <span class=
"org-string">`\n  emits: ${scriptSetup.content</span>
<span class="linenr">28: </span><span class=
"org-string">      .slice(emitsRuntimeDecl.start, emitsRuntimeDecl.end)</span>
<span class="linenr">29: </span><span class=
"org-string">      .trim()},`</span>
<span class="linenr">30: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (emitsTypeDecl) {
<span class=
"linenr">31: </span>    runtimeOptions += genRuntimeEmits(typeDeclaredEmits)
<span class="linenr">32: </span>  }
<span class="linenr">33: </span>
<span class="linenr">34: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;script setup&gt; components are closed by default. If the user did not</span>
<span class="linenr">35: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">explicitly call `defineExpose`, call expose() with no args.</span>
<span class="linenr">36: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exposeCall</span> =
<span class=
"linenr">37: </span>    hasDefineExposeCall || options.inlineTemplate ? <span class="org-string">``</span> : <span class="org-string">`  expose();\n`</span>
<span class="linenr">38: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">wrap setup code with function.</span>
<span class="linenr">39: </span>  <span class=
"org-keyword">if</span> (isTS) {
<span class="linenr">40: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for TS, make sure the exported type is still valid type with</span>
<span class="linenr">41: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">correct props information</span>
<span class="linenr">42: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">we have to use object spread for types to be merged properly</span>
<span class="linenr">43: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">user's TS setting should compile it down to proper targets</span>
<span class="linenr">44: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export default defineComponent({ ...__default__, ... })</span>
<span class="linenr">45: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">def</span> = defaultExport ? <span class=
"org-string">`\n  ...${DEFAULT_VAR},`</span> : <span class=
"org-string">``</span>
<span class="linenr">46: </span>    s.prependLeft(
<span class="linenr">47: </span>      startOffset,
<span class="linenr">48: </span>      <span class=
"org-string">`\nexport default /*#__PURE__*/${helper(</span>
<span class="linenr">49: </span><span class=
"org-string">        `</span>defineComponent<span class=
"org-string">`</span>
<span class="linenr">50: </span><span class=
"org-string">      )}({${def}${runtimeOptions}\n  ${</span>
<span class="linenr">51: </span><span class=
"org-string">        hasAwait ? `</span><span class=
"org-keyword">async</span> <span class="org-string">` : ``</span>
<span class="linenr">52: </span><span class=
"org-string">      }setup(${args}) {\n${exposeCall}`</span>
<span class="linenr">53: </span>    )
<span class=
"linenr">54: </span>    s.appendRight(endOffset, <span class=
"org-string">`})`</span>)
<span class="linenr">55: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr">56: </span>    <span class=
"org-keyword">if</span> (defaultExport) {
<span class="linenr">57: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">without TS, can't rely on rest spread, so we use Object.assign</span>
<span class="linenr">58: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export default Object.assign(__default__, { ... })</span>
<span class="linenr">59: </span>      s.prependLeft(
<span class="linenr">60: </span>        startOffset,
<span class="linenr">61: </span>        <span class=
"org-string">`\nexport default /*#__PURE__*/Object.assign(${DEFAULT_VAR}, {${runtimeOptions}\n  `</span> +
<span class="linenr">62: </span>          <span class=
"org-string">`${hasAwait ? `</span><span class=
"org-keyword">async</span> <span class=
"org-string">` : ``}setup(${args}) {\n${exposeCall}`</span>
<span class="linenr">63: </span>      )
<span class=
"linenr">64: </span>      s.appendRight(endOffset, <span class=
"org-string">`})`</span>)
<span class="linenr">65: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">66: </span>      s.prependLeft(
<span class="linenr">67: </span>        startOffset,
<span class="linenr">68: </span>        <span class=
"org-string">`\nexport default {${runtimeOptions}\n  `</span> +
<span class="linenr">69: </span>          <span class=
"org-string">`${hasAwait ? `</span><span class=
"org-keyword">async</span> <span class=
"org-string">` : ``}setup(${args}) {\n${exposeCall}`</span>
<span class="linenr">70: </span>      )
<span class=
"linenr">71: </span>      s.appendRight(endOffset, <span class=
"org-string">`}`</span>)
<span class="linenr">72: </span>    }
<span class="linenr">73: </span>  }
<span class="linenr">74: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orga8fcc52" class="outline-4">
          <h4 id="orga8fcc52"><span class=
          "section-number-4">2.3.12.</span> finalize Vue helper
          imports</h4>
          <div class="outline-text-4" id="text-2-3-12">
            <div class="org-src-container">
              <pre class="src src-js" id="org55630e2"><span class=
              "linenr">1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">finalizeVueHelperImports</span>() {
<span class="linenr">2: </span>  <span class=
"org-keyword">if</span> (helperImports.size &gt; <span class=
"org-highlight-numbers-number">0</span>) {
<span class="linenr">3: </span>    s.prepend(
<span class="linenr">4: </span>      <span class=
"org-string">`import { ${[...helperImports]</span>
<span class="linenr">5: </span><span class=
"org-string">        .map(h =&gt; `</span>${h} as _${h}<span class=
"org-string">`)</span>
<span class="linenr">6: </span><span class=
"org-string">        .join(', ')} } from 'vue'\n`</span>
<span class="linenr">7: </span>    )
<span class="linenr">8: </span>  }
<span class="linenr">9: </span>}
</pre>
            </div>
          </div>
        </div>
      </div>
      <div id="outline-container-orgb2db54f" class="outline-3">
        <h3 id="orgb2db54f"><span class=
        "section-number-3">2.4.</span> functions</h3>
        <div class="outline-text-3" id="text-2-4">
          <div class="org-src-container">
            <pre class="src src-js" id="org560b792"><span class=
            "linenr"> 1: </span>&lt;&lt;registerBinding&gt;&gt;
<span class="linenr"> 2: </span>&lt;&lt;walkDeclaration&gt;&gt;
<span class="linenr"> 3: </span>&lt;&lt;walkObjectPattern&gt;&gt;
<span class="linenr"> 4: </span>&lt;&lt;walkArrayPattern&gt;&gt;
<span class="linenr"> 5: </span>&lt;&lt;walkPattern&gt;&gt;
<span class="linenr"> 6: </span>&lt;&lt;recordType&gt;&gt;
<span class="linenr"> 7: </span>&lt;&lt;extractRuntimeProps&gt;&gt;
<span class="linenr"> 8: </span>&lt;&lt;inferRuntimeType&gt;&gt;
<span class="linenr"> 9: </span>&lt;&lt;toRuntimeTypeString&gt;&gt;
<span class="linenr">10: </span>&lt;&lt;extractRuntimeEmits&gt;&gt;
<span class="linenr">11: </span>&lt;&lt;extractEventNames&gt;&gt;
<span class="linenr">12: </span>&lt;&lt;genRuntimeEmits&gt;&gt;
<span class="linenr">13: </span>&lt;&lt;isCallOf&gt;&gt;
<span class="linenr">14: </span>&lt;&lt;canNeverBeRef&gt;&gt;
<span class=
"linenr">15: </span>&lt;&lt;analyzeScriptBindings&gt;&gt;
<span class=
"linenr">16: </span>&lt;&lt;analyzeBindingsFromOptions&gt;&gt;
<span class=
"linenr">17: </span>&lt;&lt;getObjectExpressionKeys&gt;&gt;
<span class=
"linenr">18: </span>&lt;&lt;getArrayExpressionKeys&gt;&gt;
<span class=
"linenr">19: </span>&lt;&lt;getObjectOrArrayExpressionKeys&gt;&gt;
<span class=
"linenr">20: </span>&lt;&lt;resolveTemplateUsageCheckString&gt;&gt;
<span class="linenr">21: </span>&lt;&lt;stripStrings&gt;&gt;
<span class="linenr">22: </span>&lt;&lt;isImportUsed&gt;&gt;
<span class="linenr">23: </span>&lt;&lt;hmrShouldReload&gt;&gt;
</pre>
          </div>
        </div>
        <div id="outline-container-org6296eab" class="outline-4">
          <h4 id="org6296eab"><span class=
          "section-number-4">2.4.1.</span> registerBinding()</h4>
          <div class="outline-text-4" id="text-2-4-1">
            <div class="org-src-container">
              <pre class="src src-js" id="orgbaccb9b"><span class=
              "linenr">1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">registerBinding</span>(<span class=
              "org-variable-name">bindings</span>, <span class=
              "org-variable-name">node</span>, <span class=
              "org-variable-name">type</span>) {
<span class="linenr">2: </span>  bindings[node.name] = type
<span class="linenr">3: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgf0bbba4" class="outline-4">
          <h4 id="orgf0bbba4"><span class=
          "section-number-4">2.4.2.</span> walkDeclaration()</h4>
          <div class="outline-text-4" id="text-2-4-2">
            <div class="org-src-container">
              <pre class="src src-js" id="org145fa4f"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">walkDeclaration</span>(<span class=
              "org-variable-name">node</span>, <span class=
              "org-variable-name">bindings</span>, <span class=
              "org-variable-name">userImportAlias</span>) {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'VariableDeclaration'</span>) {
<span class="linenr"> 3: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isConst</span> = node.kind === <span class=
"org-string">'const'</span>
<span class="linenr"> 4: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export const foo = ...</span>
<span class="linenr"> 5: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> { id, init } <span class=
"org-keyword">of</span> node.declarations) {
<span class="linenr"> 6: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">isDefineCall</span> = !!(
<span class="linenr"> 7: </span>        isConst &amp;&
<span class="linenr"> 8: </span>        isCallOf(
<span class="linenr"> 9: </span>          init,
<span class=
"linenr">10: </span>          c =&gt; c === DEFINE_PROPS || c === DEFINE_EMITS || c === WITH_DEFAULTS
<span class="linenr">11: </span>        )
<span class="linenr">12: </span>      )
<span class="linenr">13: </span>      <span class=
"org-keyword">if</span> (id.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">14: </span>        <span class=
"org-keyword">let</span> <span class=
"org-variable-name">bindingType</span>
<span class="linenr">15: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">userReactiveBinding</span> = userImportAlias[<span class="org-string">'reactive'</span>] || <span class="org-string">'reactive'</span>
<span class="linenr">16: </span>        <span class=
"org-keyword">if</span> (isCallOf(init, userReactiveBinding)) {
<span class="linenr">17: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">treat reactive() calls as let since it's meant to be mutable</span>
<span class=
"linenr">18: </span>          bindingType = BindingTypes.SETUP_LET
<span class="linenr">19: </span>        } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class="linenr">20: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if a declaration is a const literal, we can mark it so that</span>
<span class="linenr">21: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the generated render fn code doesn't need to unref() it</span>
<span class="linenr">22: </span>          isDefineCall ||
<span class=
"linenr">23: </span>          (isConst &amp;& canNeverBeRef(init, userReactiveBinding))
<span class="linenr">24: </span>        ) {
<span class=
"linenr">25: </span>          bindingType = BindingTypes.SETUP_CONST
<span class="linenr">26: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (isConst) {
<span class="linenr">27: </span>          <span class=
"org-keyword">if</span> (isCallOf(init, userImportAlias[<span class="org-string">'ref'</span>] || <span class="org-string">'ref'</span>)) {
<span class=
"linenr">28: </span>            bindingType = BindingTypes.SETUP_REF
<span class="linenr">29: </span>          } <span class=
"org-keyword">else</span> {
<span class=
"linenr">30: </span>            bindingType = BindingTypes.SETUP_MAYBE_REF
<span class="linenr">31: </span>          }
<span class="linenr">32: </span>        } <span class=
"org-keyword">else</span> {
<span class=
"linenr">33: </span>          bindingType = BindingTypes.SETUP_LET
<span class="linenr">34: </span>        }
<span class=
"linenr">35: </span>        registerBinding(bindings, id, bindingType)
<span class="linenr">36: </span>      } <span class=
"org-keyword">else</span> {
<span class="linenr">37: </span>        <span class=
"org-keyword">if</span> (isCallOf(init, DEFINE_PROPS)) {
<span class="linenr">38: </span>          <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">skip walking props destructure</span>
<span class="linenr">39: </span>          <span class=
"org-keyword">return</span>
<span class="linenr">40: </span>        }
<span class="linenr">41: </span>        <span class=
"org-keyword">if</span> (id.type === <span class=
"org-string">'ObjectPattern'</span>) {
<span class=
"linenr">42: </span>          walkObjectPattern(id, bindings, isConst, isDefineCall)
<span class="linenr">43: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (id.type === <span class=
"org-string">'ArrayPattern'</span>) {
<span class=
"linenr">44: </span>          walkArrayPattern(id, bindings, isConst, isDefineCall)
<span class="linenr">45: </span>        }
<span class="linenr">46: </span>      }
<span class="linenr">47: </span>    }
<span class="linenr">48: </span>  } <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class="linenr">49: </span>    node.type === <span class=
"org-string">'TSEnumDeclaration'</span> ||
<span class="linenr">50: </span>    node.type === <span class=
"org-string">'FunctionDeclaration'</span> ||
<span class="linenr">51: </span>    node.type === <span class=
"org-string">'ClassDeclaration'</span>
<span class="linenr">52: </span>  ) {
<span class="linenr">53: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export function foo() {} / export class Foo {}</span>
<span class="linenr">54: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">export declarations must be named.</span>
<span class=
"linenr">55: </span>    bindings[node.id.name] = BindingTypes.SETUP_CONST
<span class="linenr">56: </span>  }
<span class="linenr">57: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org234c7d6" class="outline-4">
          <h4 id="org234c7d6"><span class=
          "section-number-4">2.4.3.</span> walkObjectPattern()</h4>
          <div class="outline-text-4" id="text-2-4-3">
            <div class="org-src-container">
              <pre class="src src-js" id="org885e056"><span class=
              "linenr"> 1: </span>
<span class="linenr"> 2: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">walkObjectPattern</span>(<span class=
"org-variable-name">node</span>, <span class=
"org-variable-name">bindings</span>, <span class=
"org-variable-name">isConst</span>, <span class=
"org-variable-name">isDefineCall</span> = <span class=
"org-constant">false</span>) {
<span class="linenr"> 3: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">p</span> <span class=
"org-keyword">of</span> node.properties) {
<span class="linenr"> 4: </span>    <span class=
"org-keyword">if</span> (p.type === <span class=
"org-string">'ObjectProperty'</span>) {
<span class="linenr"> 5: </span>      <span class=
"org-keyword">if</span> (p.key.type === <span class=
"org-string">'Identifier'</span> &amp;& p.key === p.value) {
<span class="linenr"> 6: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">shorthand: const { x } = ...</span>
<span class="linenr"> 7: </span>        <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = isDefineCall
<span class=
"linenr"> 8: </span>          ? BindingTypes.SETUP_CONST
<span class="linenr"> 9: </span>          : isConst
<span class=
"linenr">10: </span>          ? BindingTypes.SETUP_MAYBE_REF
<span class="linenr">11: </span>          : BindingTypes.SETUP_LET
<span class=
"linenr">12: </span>        registerBinding(bindings, p.key, type)
<span class="linenr">13: </span>      } <span class=
"org-keyword">else</span> {
<span class=
"linenr">14: </span>        walkPattern(p.value, bindings, isConst, isDefineCall)
<span class="linenr">15: </span>      }
<span class="linenr">16: </span>    } <span class=
"org-keyword">else</span> {
<span class="linenr">17: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">...rest</span>
<span class="linenr">18: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">argument can only be identifier when destructuring</span>
<span class="linenr">19: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = isConst ? BindingTypes.SETUP_CONST : BindingTypes.SETUP_LET
<span class=
"linenr">20: </span>      registerBinding(bindings, p.argument, type)
<span class="linenr">21: </span>    }
<span class="linenr">22: </span>  }
<span class="linenr">23: </span>}
<span class="linenr">24: </span>
<span class="linenr">25: </span>
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orga60be00" class="outline-4">
          <h4 id="orga60be00"><span class=
          "section-number-4">2.4.4.</span> walkArrayPattern()</h4>
          <div class="outline-text-4" id="text-2-4-4">
            <div class="org-src-container">
              <pre class="src src-js" id="orga9b72b9"><span class=
              "linenr">1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">walkArrayPattern</span>(<span class=
              "org-variable-name">node</span>, <span class=
              "org-variable-name">bindings</span>, <span class=
              "org-variable-name">isConst</span>, <span class=
              "org-variable-name">isDefineCall</span> = <span class=
              "org-constant">false</span>) {
<span class="linenr">2: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">e</span> <span class=
"org-keyword">of</span> node.elements) {
<span class=
"linenr">3: </span>    e &amp;& walkPattern(e, bindings, isConst, isDefineCall)
<span class="linenr">4: </span>  }
<span class="linenr">5: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgd71799c" class="outline-4">
          <h4 id="orgd71799c"><span class=
          "section-number-4">2.4.5.</span> walkPattern()</h4>
          <div class="outline-text-4" id="text-2-4-5">
            <div class="org-src-container">
              <pre class="src src-js" id="org0567754"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">walkPattern</span>(<span class=
              "org-variable-name">node</span>, <span class=
              "org-variable-name">bindings</span>, <span class=
              "org-variable-name">isConst</span>, <span class=
              "org-variable-name">isDefineCall</span> = <span class=
              "org-constant">false</span>) {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr"> 3: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = isDefineCall
<span class="linenr"> 4: </span>      ? BindingTypes.SETUP_CONST
<span class="linenr"> 5: </span>      : isConst
<span class=
"linenr"> 6: </span>      ? BindingTypes.SETUP_MAYBE_REF
<span class="linenr"> 7: </span>      : BindingTypes.SETUP_LET
<span class=
"linenr"> 8: </span>    registerBinding(bindings, node, type)
<span class="linenr"> 9: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'RestElement'</span>) {
<span class="linenr">10: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">argument can only be identifier when destructuring</span>
<span class="linenr">11: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = isConst ? BindingTypes.SETUP_CONST : BindingTypes.SETUP_LET
<span class=
"linenr">12: </span>    registerBinding(bindings, node.argument, type)
<span class="linenr">13: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ObjectPattern'</span>) {
<span class=
"linenr">14: </span>    walkObjectPattern(node, bindings, isConst)
<span class="linenr">15: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ArrayPattern'</span>) {
<span class=
"linenr">16: </span>    walkArrayPattern(node, bindings, isConst)
<span class="linenr">17: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'AssignmentPattern'</span>) {
<span class="linenr">18: </span>    <span class=
"org-keyword">if</span> (node.left.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">19: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">type</span> = isDefineCall
<span class="linenr">20: </span>        ? BindingTypes.SETUP_CONST
<span class="linenr">21: </span>        : isConst
<span class=
"linenr">22: </span>        ? BindingTypes.SETUP_MAYBE_REF
<span class="linenr">23: </span>        : BindingTypes.SETUP_LET
<span class=
"linenr">24: </span>      registerBinding(bindings, node.left, type)
<span class="linenr">25: </span>    } <span class=
"org-keyword">else</span> {
<span class=
"linenr">26: </span>      walkPattern(node.left, bindings, isConst)
<span class="linenr">27: </span>    }
<span class="linenr">28: </span>  }
<span class="linenr">29: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org97d0f54" class="outline-4">
          <h4 id="org97d0f54"><span class=
          "section-number-4">2.4.6.</span> recordType()</h4>
          <div class="outline-text-4" id="text-2-4-6">
            <div class="org-src-container">
              <pre class="src src-js" id="org087da3c"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">recordType</span>(<span class=
              "org-variable-name">node</span>, <span class=
              "org-variable-name">declaredTypes</span>) {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'TSInterfaceDeclaration'</span>) {
<span class=
"linenr"> 3: </span>    declaredTypes[node.id.name] = [<span class=
"org-string">`Object`</span>]
<span class="linenr"> 4: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'TSTypeAliasDeclaration'</span>) {
<span class=
"linenr"> 5: </span>    declaredTypes[node.id.name] = inferRuntimeType(
<span class="linenr"> 6: </span>      node.typeAnnotation,
<span class="linenr"> 7: </span>      declaredTypes
<span class="linenr"> 8: </span>    )
<span class="linenr"> 9: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ExportNamedDeclaration'</span> &amp;& node.declaration) {
<span class=
"linenr">10: </span>    recordType(node.declaration, declaredTypes)
<span class="linenr">11: </span>  }
<span class="linenr">12: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgc41d9be" class="outline-4">
          <h4 id="orgc41d9be"><span class=
          "section-number-4">2.4.7.</span>
          extractRuntimeProps()</h4>
          <div class="outline-text-4" id="text-2-4-7">
            <div class="org-src-container">
              <pre class="src src-js" id="orgce126b8"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">extractRuntimeProps</span>(<span class=
              "org-variable-name">node</span>, <span class=
              "org-variable-name">props</span>, <span class=
              "org-variable-name">declaredTypes</span>, <span class=
              "org-variable-name">isProd</span>) {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">members</span> = node.type === <span class=
"org-string">'TSTypeLiteral'</span> ? node.members : node.body
<span class="linenr"> 3: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">m</span> <span class=
"org-keyword">of</span> members) {
<span class="linenr"> 4: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr"> 5: </span>      (m.type === <span class=
"org-string">'TSPropertySignature'</span> || m.type === <span class="org-string">'TSMethodSignature'</span>) &amp;&
<span class="linenr"> 6: </span>      m.key.type === <span class=
"org-string">'Identifier'</span>
<span class="linenr"> 7: </span>    ) {
<span class="linenr"> 8: </span>      <span class=
"org-keyword">let</span> <span class=
"org-variable-name">type</span>
<span class="linenr"> 9: </span>      <span class=
"org-keyword">if</span> (m.type === <span class=
"org-string">'TSMethodSignature'</span>) {
<span class="linenr">10: </span>        type = [<span class=
"org-string">'Function'</span>]
<span class="linenr">11: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (m.typeAnnotation) {
<span class=
"linenr">12: </span>        type = inferRuntimeType(m.typeAnnotation.typeAnnotation, declaredTypes)
<span class="linenr">13: </span>      }
<span class="linenr">14: </span>      props[m.key.name] = {
<span class="linenr">15: </span>        key: m.key.name,
<span class="linenr">16: </span>        required: !m.optional,
<span class="linenr">17: </span>        type: type || [<span class=
"org-string">`null`</span>]
<span class="linenr">18: </span>      }
<span class="linenr">19: </span>    }
<span class="linenr">20: </span>  }
<span class="linenr">21: </span>}
<span class="linenr">22: </span>
<span class="linenr">23: </span>
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org999a464" class="outline-4">
          <h4 id="org999a464"><span class=
          "section-number-4">2.4.8.</span> inferRuntimeType()</h4>
          <div class="outline-text-4" id="text-2-4-8">
            <div class="org-src-container">
              <pre class="src src-js" id="orgd855af3"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">inferRuntimeType</span>(<span class=
              "org-variable-name">node</span>, <span class=
              "org-variable-name">declaredTypes</span>) {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">switch</span> (node.type) {
<span class="linenr"> 3: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSStringKeyword'</span>:
<span class="linenr"> 4: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'String'</span>]
<span class="linenr"> 5: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSNumberKeyword'</span>:
<span class="linenr"> 6: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Number'</span>]
<span class="linenr"> 7: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSBooleanKeyword'</span>:
<span class="linenr"> 8: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Boolean'</span>]
<span class="linenr"> 9: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSObjectKeyword'</span>:
<span class="linenr">10: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Object'</span>]
<span class="linenr">11: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSTypeLiteral'</span>:
<span class="linenr">12: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO</span></span></span><span class=
"org-comment"> (nice to have) generate runtime property validation</span>
<span class="linenr">13: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Object'</span>]
<span class="linenr">14: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSFunctionType'</span>:
<span class="linenr">15: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Function'</span>]
<span class="linenr">16: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSArrayType'</span>:
<span class="linenr">17: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSTupleType'</span>:
<span class="linenr">18: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment"><span class="org-bold"><span class=
"org-warning">TODO</span></span></span><span class=
"org-comment"> (nice to have) generate runtime element type/length checks</span>
<span class="linenr">19: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Array'</span>]
<span class="linenr">20: </span>
<span class="linenr">21: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSLiteralType'</span>:
<span class="linenr">22: </span>      <span class=
"org-keyword">switch</span> (node.literal.type) {
<span class="linenr">23: </span>        <span class=
"org-keyword">case</span> <span class=
"org-string">'StringLiteral'</span>:
<span class="linenr">24: </span>          <span class=
"org-keyword">return</span> [<span class=
"org-string">'String'</span>]
<span class="linenr">25: </span>        <span class=
"org-keyword">case</span> <span class=
"org-string">'BooleanLiteral'</span>:
<span class="linenr">26: </span>          <span class=
"org-keyword">return</span> [<span class=
"org-string">'Boolean'</span>]
<span class="linenr">27: </span>        <span class=
"org-keyword">case</span> <span class=
"org-string">'NumericLiteral'</span>:
<span class="linenr">28: </span>        <span class=
"org-keyword">case</span> <span class=
"org-string">'BigIntLiteral'</span>:
<span class="linenr">29: </span>          <span class=
"org-keyword">return</span> [<span class=
"org-string">'Number'</span>]
<span class="linenr">30: </span>        <span class=
"org-keyword">default</span>:
<span class="linenr">31: </span>          <span class=
"org-keyword">return</span> [<span class=
"org-string">`null`</span>]
<span class="linenr">32: </span>      }
<span class="linenr">33: </span>
<span class="linenr">34: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSTypeReference'</span>:
<span class="linenr">35: </span>      <span class=
"org-keyword">if</span> (node.typeName.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr">36: </span>        <span class=
"org-keyword">if</span> (declaredTypes[node.typeName.name]) {
<span class="linenr">37: </span>          <span class=
"org-keyword">return</span> declaredTypes[node.typeName.name]
<span class="linenr">38: </span>        }
<span class="linenr">39: </span>        <span class=
"org-keyword">switch</span> (node.typeName.name) {
<span class="linenr">40: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Array'</span>:
<span class="linenr">41: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'Function'</span>:
<span class="linenr">42: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Object'</span>:
<span class="linenr">43: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Set'</span>:
<span class="linenr">44: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Map'</span>:
<span class="linenr">45: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'WeakSet'</span>:
<span class="linenr">46: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'WeakMap'</span>:
<span class="linenr">47: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Date'</span>:
<span class="linenr">48: </span>            <span class=
"org-keyword">return</span> [node.typeName.name]
<span class="linenr">49: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Record'</span>:
<span class="linenr">50: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'Partial'</span>:
<span class="linenr">51: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'Readonly'</span>:
<span class="linenr">52: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Pick'</span>:
<span class="linenr">53: </span>          <span class=
"org-keyword">case</span> <span class="org-string">'Omit'</span>:
<span class="linenr">54: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'Exclude'</span>:
<span class="linenr">55: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'Extract'</span>:
<span class="linenr">56: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'Required'</span>:
<span class="linenr">57: </span>          <span class=
"org-keyword">case</span> <span class=
"org-string">'InstanceType'</span>:
<span class="linenr">58: </span>            <span class=
"org-keyword">return</span> [<span class=
"org-string">'Object'</span>]
<span class="linenr">59: </span>        }
<span class="linenr">60: </span>      }
<span class="linenr">61: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">`null`</span>]
<span class="linenr">62: </span>
<span class="linenr">63: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSParenthesizedType'</span>:
<span class="linenr">64: </span>      <span class=
"org-keyword">return</span> inferRuntimeType(node.typeAnnotation, declaredTypes)
<span class="linenr">65: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSUnionType'</span>:
<span class="linenr">66: </span>      <span class=
"org-keyword">return</span> [
<span class="linenr">67: </span>        ...<span class=
"org-keyword">new</span> <span class="org-type">Set</span>(
<span class="linenr">68: </span>          [].concat(
<span class=
"linenr">69: </span>            ...(node.types.map(t =&gt; inferRuntimeType(t, declaredTypes)))
<span class="linenr">70: </span>          )
<span class="linenr">71: </span>        )
<span class="linenr">72: </span>      ]
<span class="linenr">73: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSIntersectionType'</span>:
<span class="linenr">74: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Object'</span>]
<span class="linenr">75: </span>
<span class="linenr">76: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TSSymbolKeyword'</span>:
<span class="linenr">77: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">'Symbol'</span>]
<span class="linenr">78: </span>
<span class="linenr">79: </span>    <span class=
"org-keyword">default</span>:
<span class="linenr">80: </span>      <span class=
"org-keyword">return</span> [<span class=
"org-string">`null`</span>] <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">no runtime check</span>
<span class="linenr">81: </span>  }
<span class="linenr">82: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org7e4ac77" class="outline-4">
          <h4 id="org7e4ac77"><span class=
          "section-number-4">2.4.9.</span>
          toRuntimeTypeString()</h4>
          <div class="outline-text-4" id="text-2-4-9">
            <div class="org-src-container">
              <pre class="src src-js" id="org0004690"><span class=
              "linenr">1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">toRuntimeTypeString</span>(<span class=
              "org-variable-name">types</span>) {
<span class="linenr">2: </span>  <span class=
"org-keyword">return</span> types.length &gt; <span class=
"org-highlight-numbers-number">1</span> ? <span class=
"org-string">`[${types.join(', ')}]`</span> : types[<span class=
"org-highlight-numbers-number">0</span>]
<span class="linenr">3: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org7dbc85e" class="outline-4">
          <h4 id="org7dbc85e"><span class=
          "section-number-4">2.4.10.</span>
          extractRuntimeEmits()</h4>
          <div class="outline-text-4" id="text-2-4-10">
            <div class="org-src-container">
              <pre class="src src-js" id="org0739208"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">extractRuntimeEmits</span>(<span class=
              "org-variable-name">node</span>, <span class=
              "org-variable-name">emits</span>) {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'TSTypeLiteral'</span> || node.type === <span class=
"org-string">'TSInterfaceBody'</span>) {
<span class="linenr"> 3: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">members</span> = node.type === <span class=
"org-string">'TSTypeLiteral'</span> ? node.members : node.body
<span class="linenr"> 4: </span>    <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">t</span> <span class=
"org-keyword">of</span> members) {
<span class="linenr"> 5: </span>      <span class=
"org-keyword">if</span> (t.type === <span class=
"org-string">'TSCallSignatureDeclaration'</span>) {
<span class=
"linenr"> 6: </span>        extractEventNames(t.parameters[<span class="org-highlight-numbers-number">0</span>], emits)
<span class="linenr"> 7: </span>      }
<span class="linenr"> 8: </span>    }
<span class="linenr"> 9: </span>    <span class=
"org-keyword">return</span>
<span class="linenr">10: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr">11: </span>    extractEventNames(node.parameters[<span class="org-highlight-numbers-number">0</span>], emits)
<span class="linenr">12: </span>  }
<span class="linenr">13: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgea4e472" class="outline-4">
          <h4 id="orgea4e472"><span class=
          "section-number-4">2.4.11.</span>
          extractEventNames()</h4>
          <div class="outline-text-4" id="text-2-4-11">
            <div class="org-src-container">
              <pre class="src src-js" id="orga55b919"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">extractEventNames</span>(<span class=
              "org-variable-name">eventName</span>, <span class=
              "org-variable-name">emits</span>) {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 3: </span>    eventName.type === <span class=
"org-string">'Identifier'</span> &amp;&
<span class="linenr"> 4: </span>    eventName.typeAnnotation &amp;&
<span class=
"linenr"> 5: </span>    eventName.typeAnnotation.type === <span class="org-string">'TSTypeAnnotation'</span>
<span class="linenr"> 6: </span>  ) {
<span class="linenr"> 7: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">typeNode</span> = eventName.typeAnnotation.typeAnnotation
<span class="linenr"> 8: </span>    <span class=
"org-keyword">if</span> (typeNode.type === <span class=
"org-string">'TSLiteralType'</span>) {
<span class="linenr"> 9: </span>      <span class=
"org-keyword">if</span> (typeNode.literal.type !== <span class=
"org-string">'UnaryExpression'</span>) {
<span class=
"linenr">10: </span>        emits.add(String(typeNode.literal.value))
<span class="linenr">11: </span>      }
<span class="linenr">12: </span>    } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (typeNode.type === <span class=
"org-string">'TSUnionType'</span>) {
<span class="linenr">13: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">t</span> <span class=
"org-keyword">of</span> typeNode.types) {
<span class="linenr">14: </span>        <span class=
"org-keyword">if</span> (
<span class="linenr">15: </span>          t.type === <span class=
"org-string">'TSLiteralType'</span> &amp;&
<span class=
"linenr">16: </span>          t.literal.type !== <span class=
"org-string">'UnaryExpression'</span>
<span class="linenr">17: </span>        ) {
<span class=
"linenr">18: </span>          emits.add(String(t.literal.value))
<span class="linenr">19: </span>        }
<span class="linenr">20: </span>      }
<span class="linenr">21: </span>    }
<span class="linenr">22: </span>  }
<span class="linenr">23: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org297819b" class="outline-4">
          <h4 id="org297819b"><span class=
          "section-number-4">2.4.12.</span> genRuntimeEmits()</h4>
          <div class="outline-text-4" id="text-2-4-12">
            <div class="org-src-container">
              <pre class="src src-js" id="orgc370ecb"><span class=
              "linenr">1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">genRuntimeEmits</span>(<span class=
              "org-variable-name">emits</span>) {
<span class="linenr">2: </span>  <span class=
"org-keyword">return</span> emits.size
<span class="linenr">3: </span>    ? <span class=
"org-string">`\n  emits: [${Array.from(emits)</span>
<span class="linenr">4: </span><span class=
"org-string">        .map(p =&gt; JSON.stringify(p))</span>
<span class="linenr">5: </span><span class=
"org-string">        .join(', ')}],`</span>
<span class="linenr">6: </span>    : <span class=
"org-string">``</span>
<span class="linenr">7: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgfde16d9" class="outline-4">
          <h4 id="orgfde16d9"><span class=
          "section-number-4">2.4.13.</span> isCallOf()</h4>
          <div class="outline-text-4" id="text-2-4-13">
            <div class="org-src-container">
              <pre class="src src-js" id="org3a42446"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">isCallOf</span>(<span class=
              "org-variable-name">node</span>, <span class=
              "org-variable-name">test</span>) {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">return</span> !!(
<span class="linenr"> 3: </span>    node &amp;&
<span class="linenr"> 4: </span>    node.type === <span class=
"org-string">'CallExpression'</span> &amp;&
<span class=
"linenr"> 5: </span>    node.callee.type === <span class=
"org-string">'Identifier'</span> &amp;&
<span class="linenr"> 6: </span>    (<span class=
"org-keyword">typeof</span> test === <span class=
"org-string">'string'</span>
<span class="linenr"> 7: </span>      ? node.callee.name === test
<span class="linenr"> 8: </span>      : test(node.callee.name))
<span class="linenr"> 9: </span>  )
<span class="linenr">10: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org28fbd86" class="outline-4">
          <h4 id="org28fbd86"><span class=
          "section-number-4">2.4.14.</span> canNeverBeRef()</h4>
          <div class="outline-text-4" id="text-2-4-14">
            <div class="org-src-container">
              <pre class="src src-js" id="org2db7871"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">canNeverBeRef</span>(<span class=
              "org-variable-name">node</span>, <span class=
              "org-variable-name">userReactiveImport</span>) {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">if</span> (isCallOf(node, userReactiveImport)) {
<span class="linenr"> 3: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr"> 4: </span>  }
<span class="linenr"> 5: </span>  <span class=
"org-keyword">switch</span> (node.type) {
<span class="linenr"> 6: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'UnaryExpression'</span>:
<span class="linenr"> 7: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'BinaryExpression'</span>:
<span class="linenr"> 8: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ArrayExpression'</span>:
<span class="linenr"> 9: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ObjectExpression'</span>:
<span class="linenr">10: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'FunctionExpression'</span>:
<span class="linenr">11: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ArrowFunctionExpression'</span>:
<span class="linenr">12: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'UpdateExpression'</span>:
<span class="linenr">13: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'ClassExpression'</span>:
<span class="linenr">14: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'TaggedTemplateExpression'</span>:
<span class="linenr">15: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">16: </span>    <span class=
"org-keyword">case</span> <span class=
"org-string">'SequenceExpression'</span>:
<span class="linenr">17: </span>      <span class=
"org-keyword">return</span> canNeverBeRef(
<span class=
"linenr">18: </span>        node.expressions[node.expressions.length - <span class="org-highlight-numbers-number">1</span>],
<span class="linenr">19: </span>        userReactiveImport
<span class="linenr">20: </span>      )
<span class="linenr">21: </span>    <span class=
"org-keyword">default</span>:
<span class="linenr">22: </span>      <span class=
"org-keyword">if</span> (node.type.endsWith(<span class=
"org-string">'Literal'</span>)) {
<span class="linenr">23: </span>        <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">24: </span>      }
<span class="linenr">25: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">26: </span>  }
<span class="linenr">27: </span>}
<span class="linenr">28: </span>
<span class="linenr">29: </span>
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgda510b0" class="outline-4">
          <h4 id="orgda510b0"><span class=
          "section-number-4">2.4.15.</span>
          analyzeScriptBindings()</h4>
          <div class="outline-text-4" id="text-2-4-15">
            <div class="org-src-container">
              <pre class="src src-js" id="org40b32b1"><span class=
              "linenr"> 1: </span><span class="org-doc">/**</span>
<span class="linenr"> 2: </span><span class=
"org-doc"> * Analyze bindings in normal `&lt;script&gt;`</span>
<span class="linenr"> 3: </span><span class=
"org-doc"> * Note that `compileScriptSetup` already analyzes bindings as part of its</span>
<span class="linenr"> 4: </span><span class=
"org-doc"> * compilation process so this should only be used on single `&lt;script&gt;` SFCs.</span>
<span class="linenr"> 5: </span><span class="org-doc"> */</span>
<span class="linenr"> 6: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">analyzeScriptBindings</span>(<span class=
"org-variable-name">ast</span>) {
<span class="linenr"> 7: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">node</span> <span class=
"org-keyword">of</span> ast) {
<span class="linenr"> 8: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr"> 9: </span>      node.type === <span class=
"org-string">'ExportDefaultDeclaration'</span> &amp;&
<span class=
"linenr">10: </span>      node.declaration.type === <span class=
"org-string">'ObjectExpression'</span>
<span class="linenr">11: </span>    ) {
<span class="linenr">12: </span>      <span class=
"org-keyword">return</span> analyzeBindingsFromOptions(node.declaration)
<span class="linenr">13: </span>    }
<span class="linenr">14: </span>  }
<span class="linenr">15: </span>  <span class=
"org-keyword">return</span> {}
<span class="linenr">16: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgd96b3d9" class="outline-4">
          <h4 id="orgd96b3d9"><span class=
          "section-number-4">2.4.16.</span>
          analyzeBindingsFromOptions()</h4>
          <div class="outline-text-4" id="text-2-4-16">
            <div class="org-src-container">
              <pre class="src src-js" id="orgb483b58"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">analyzeBindingsFromOptions</span>(<span class=
              "org-variable-name">node</span>) {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">bindings</span> = {}
<span class="linenr"> 3: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#3270, #3275</span>
<span class="linenr"> 4: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">mark non-script-setup so we don't resolve components/directives from these</span>
<span class=
"linenr"> 5: </span>  Object.defineProperty(bindings, <span class=
"org-string">'__isScriptSetup'</span>, {
<span class="linenr"> 6: </span>    enumerable: <span class=
"org-constant">false</span>,
<span class="linenr"> 7: </span>    value: <span class=
"org-constant">false</span>
<span class="linenr"> 8: </span>  })
<span class="linenr"> 9: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">property</span> <span class=
"org-keyword">of</span> node.properties) {
<span class="linenr">10: </span>    <span class=
"org-keyword">if</span> (
<span class=
"linenr">11: </span>      property.type === <span class="org-string">'ObjectProperty'</span> &amp;&
<span class="linenr">12: </span>      !property.computed &amp;&
<span class=
"linenr">13: </span>      property.key.type === <span class=
"org-string">'Identifier'</span>
<span class="linenr">14: </span>    ) {
<span class="linenr">15: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props</span>
<span class="linenr">16: </span>      <span class=
"org-keyword">if</span> (property.key.name === <span class=
"org-string">'props'</span>) {
<span class="linenr">17: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props: ['foo']</span>
<span class="linenr">18: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">props: { foo: ... }</span>
<span class="linenr">19: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">of</span> getObjectOrArrayExpressionKeys(property.value)) {
<span class=
"linenr">20: </span>          bindings[key] = BindingTypes.PROPS
<span class="linenr">21: </span>        }
<span class="linenr">22: </span>      }
<span class="linenr">23: </span>
<span class="linenr">24: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject</span>
<span class="linenr">25: </span>      <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (property.key.name === <span class=
"org-string">'inject'</span>) {
<span class="linenr">26: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject: ['foo']</span>
<span class="linenr">27: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">inject: { foo: {} }</span>
<span class="linenr">28: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">of</span> getObjectOrArrayExpressionKeys(property.value)) {
<span class=
"linenr">29: </span>          bindings[key] = BindingTypes.OPTIONS
<span class="linenr">30: </span>        }
<span class="linenr">31: </span>      }
<span class="linenr">32: </span>
<span class="linenr">33: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">computed & methods</span>
<span class="linenr">34: </span>      <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr">35: </span>        property.value.type === <span class=
"org-string">'ObjectExpression'</span> &amp;&
<span class=
"linenr">36: </span>        (property.key.name === <span class=
"org-string">'computed'</span> || property.key.name === <span class="org-string">'methods'</span>)
<span class="linenr">37: </span>      ) {
<span class="linenr">38: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">methods: { foo() {} }</span>
<span class="linenr">39: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">computed: { foo() {} }</span>
<span class="linenr">40: </span>        <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">of</span> getObjectExpressionKeys(property.value)) {
<span class=
"linenr">41: </span>          bindings[key] = BindingTypes.OPTIONS
<span class="linenr">42: </span>        }
<span class="linenr">43: </span>      }
<span class="linenr">44: </span>    }
<span class="linenr">45: </span>
<span class="linenr">46: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">setup & data</span>
<span class="linenr">47: </span>    <span class=
"org-keyword">else</span> <span class="org-keyword">if</span> (
<span class=
"linenr">48: </span>      property.type === <span class="org-string">'ObjectMethod'</span> &amp;&
<span class=
"linenr">49: </span>      property.key.type === <span class=
"org-string">'Identifier'</span> &amp;&
<span class=
"linenr">50: </span>      (property.key.name === <span class=
"org-string">'setup'</span> || property.key.name === <span class=
"org-string">'data'</span>)
<span class="linenr">51: </span>    ) {
<span class="linenr">52: </span>      <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">bodyItem</span> <span class=
"org-keyword">of</span> property.body.body) {
<span class="linenr">53: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">setup() {</span>
<span class="linenr">54: </span>        <span class=
"org-comment-delimiter">//   </span><span class=
"org-comment">return {</span>
<span class="linenr">55: </span>        <span class=
"org-comment-delimiter">//     </span><span class=
"org-comment">foo: null</span>
<span class="linenr">56: </span>        <span class=
"org-comment-delimiter">//   </span><span class=
"org-comment">}</span>
<span class="linenr">57: </span>        <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">}</span>
<span class="linenr">58: </span>        <span class=
"org-keyword">if</span> (
<span class=
"linenr">59: </span>          bodyItem.type === <span class=
"org-string">'ReturnStatement'</span> &amp;&
<span class="linenr">60: </span>          bodyItem.argument &amp;&
<span class=
"linenr">61: </span>          bodyItem.argument.type === <span class="org-string">'ObjectExpression'</span>
<span class="linenr">62: </span>        ) {
<span class="linenr">63: </span>          <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">of</span> getObjectExpressionKeys(bodyItem.argument)) {
<span class="linenr">64: </span>            bindings[key] =
<span class=
"linenr">65: </span>              property.key.name === <span class="org-string">'setup'</span>
<span class=
"linenr">66: </span>                ? BindingTypes.SETUP_MAYBE_REF
<span class="linenr">67: </span>                : BindingTypes.DATA
<span class="linenr">68: </span>          }
<span class="linenr">69: </span>        }
<span class="linenr">70: </span>      }
<span class="linenr">71: </span>    }
<span class="linenr">72: </span>  }
<span class="linenr">73: </span>
<span class="linenr">74: </span>  <span class=
"org-keyword">return</span> bindings
<span class="linenr">75: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org30d8fc0" class="outline-4">
          <h4 id="org30d8fc0"><span class=
          "section-number-4">2.4.17.</span>
          getObjectExpressionKeys()</h4>
          <div class="outline-text-4" id="text-2-4-17">
            <div class="org-src-container">
              <pre class="src src-js" id="org95233c5"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">getObjectExpressionKeys</span>(<span class=
              "org-variable-name">node</span>) {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keys</span> = []
<span class="linenr"> 3: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">prop</span> <span class=
"org-keyword">of</span> node.properties) {
<span class="linenr"> 4: </span>    <span class=
"org-keyword">if</span> (
<span class="linenr"> 5: </span>      (prop.type === <span class=
"org-string">'ObjectProperty'</span> || prop.type === <span class=
"org-string">'ObjectMethod'</span>) &amp;&
<span class="linenr"> 6: </span>      !prop.computed
<span class="linenr"> 7: </span>    ) {
<span class="linenr"> 8: </span>      <span class=
"org-keyword">if</span> (prop.key.type === <span class=
"org-string">'Identifier'</span>) {
<span class="linenr"> 9: </span>        keys.push(prop.key.name)
<span class="linenr">10: </span>      } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (prop.key.type === <span class=
"org-string">'StringLiteral'</span>) {
<span class="linenr">11: </span>        keys.push(prop.key.value)
<span class="linenr">12: </span>      }
<span class="linenr">13: </span>    }
<span class="linenr">14: </span>  }
<span class="linenr">15: </span>  <span class=
"org-keyword">return</span> keys
<span class="linenr">16: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org5684efd" class="outline-4">
          <h4 id="org5684efd"><span class=
          "section-number-4">2.4.18.</span>
          getArrayExpressionKeys()</h4>
          <div class="outline-text-4" id="text-2-4-18">
            <div class="org-src-container">
              <pre class="src src-js" id="orgc041c43"><span class=
              "linenr">1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">getArrayExpressionKeys</span>(<span class=
              "org-variable-name">node</span>) {
<span class="linenr">2: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">keys</span> = []
<span class="linenr">3: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">element</span> <span class=
"org-keyword">of</span> node.elements) {
<span class="linenr">4: </span>    <span class=
"org-keyword">if</span> (element &amp;& element.type === <span class="org-string">'StringLiteral'</span>) {
<span class="linenr">5: </span>      keys.push(element.value)
<span class="linenr">6: </span>    }
<span class="linenr">7: </span>  }
<span class="linenr">8: </span>  <span class=
"org-keyword">return</span> keys
<span class="linenr">9: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org6b35df7" class="outline-4">
          <h4 id="org6b35df7"><span class=
          "section-number-4">2.4.19.</span>
          getObjectOrArrayExpressionKeys()</h4>
          <div class="outline-text-4" id="text-2-4-19">
            <div class="org-src-container">
              <pre class="src src-js" id="org23db007"><span class=
              "linenr">1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">getObjectOrArrayExpressionKeys</span>(<span class="org-variable-name">value</span>) {
<span class="linenr">2: </span>  <span class=
"org-keyword">if</span> (value.type === <span class=
"org-string">'ArrayExpression'</span>) {
<span class="linenr">3: </span>    <span class=
"org-keyword">return</span> getArrayExpressionKeys(value)
<span class="linenr">4: </span>  }
<span class="linenr">5: </span>  <span class=
"org-keyword">if</span> (value.type === <span class=
"org-string">'ObjectExpression'</span>) {
<span class="linenr">6: </span>    <span class=
"org-keyword">return</span> getObjectExpressionKeys(value)
<span class="linenr">7: </span>  }
<span class="linenr">8: </span>  <span class=
"org-keyword">return</span> []
<span class="linenr">9: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org01b16fb" class="outline-4">
          <h4 id="org01b16fb"><span class=
          "section-number-4">2.4.20.</span>
          resolveTemplateUsageCheckString()</h4>
          <div class="outline-text-4" id="text-2-4-20">
            <div class="org-src-container">
              <pre class="src src-js" id="orgfb1335b"><span class=
              "linenr"> 1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">resolveTemplateUsageCheckString</span>(<span class="org-variable-name">sfc</span>) {
<span class="linenr"> 2: </span>  <span class=
"org-keyword">const</span> { content, ast } = sfc.template
<span class="linenr"> 3: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">cached</span> = templateUsageCheckCache.get(content)
<span class="linenr"> 4: </span>  <span class=
"org-keyword">if</span> (cached) {
<span class="linenr"> 5: </span>    <span class=
"org-keyword">return</span> cached
<span class="linenr"> 6: </span>  }
<span class="linenr"> 7: </span>
<span class="linenr"> 8: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">code</span> = <span class=
"org-string">''</span>
<span class="linenr"> 9: </span>  transform(createRoot([ast]), {
<span class="linenr">10: </span>    nodeTransforms: [
<span class="linenr">11: </span>      node =&gt; {
<span class="linenr">12: </span>        <span class=
"org-keyword">if</span> (node.type === NodeTypes.ELEMENT) {
<span class="linenr">13: </span>          <span class=
"org-keyword">if</span> (
<span class=
"linenr">14: </span>            !parserOptions.isNativeTag(node.tag) &amp;&
<span class=
"linenr">15: </span>            !parserOptions.isBuiltInComponent(node.tag)
<span class="linenr">16: </span>          ) {
<span class="linenr">17: </span>            code += <span class=
"org-string">`,${camelize(node.tag)},${capitalize(camelize(node.tag))}`</span>
<span class="linenr">18: </span>          }
<span class="linenr">19: </span>          <span class=
"org-keyword">for</span> (<span class=
"org-keyword">let</span> <span class=
"org-variable-name">i</span> = <span class=
"org-highlight-numbers-number">0</span>; i &lt; node.props.length; i++) {
<span class="linenr">20: </span>            <span class=
"org-keyword">const</span> <span class=
"org-variable-name">prop</span> = node.props[i]
<span class="linenr">21: </span>            <span class=
"org-keyword">if</span> (prop.type === NodeTypes.DIRECTIVE) {
<span class="linenr">22: </span>              <span class=
"org-keyword">if</span> (!isBuiltInDir(prop.name)) {
<span class=
"linenr">23: </span>                code += <span class="org-string">`,v${capitalize(camelize(prop.name))}`</span>
<span class="linenr">24: </span>              }
<span class="linenr">25: </span>              <span class=
"org-keyword">if</span> (prop.exp) {
<span class=
"linenr">26: </span>                code += <span class="org-string">`,${stripStrings(prop.exp.content)}`</span>
<span class="linenr">27: </span>              }
<span class="linenr">28: </span>            }
<span class="linenr">29: </span>          }
<span class="linenr">30: </span>        } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (node.type === NodeTypes.INTERPOLATION) {
<span class="linenr">31: </span>          code += <span class=
"org-string">`,${stripStrings(node.content.content)}`</span>
<span class="linenr">32: </span>        }
<span class="linenr">33: </span>      }
<span class="linenr">34: </span>    ]
<span class="linenr">35: </span>  })
<span class="linenr">36: </span>
<span class="linenr">37: </span>  code += <span class=
"org-string">';'</span>
<span class=
"linenr">38: </span>  templateUsageCheckCache.set(content, code)
<span class="linenr">39: </span>  <span class=
"org-keyword">return</span> code
<span class="linenr">40: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orgdac734f" class="outline-4">
          <h4 id="orgdac734f"><span class=
          "section-number-4">2.4.21.</span> stripStrings()</h4>
          <div class="outline-text-4" id="text-2-4-21">
            <div class="org-src-container">
              <pre class="src src-js" id="org62f198a"><span class=
              "linenr">1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">stripStrings</span>(<span class=
              "org-variable-name">exp</span>) {
<span class="linenr">2: </span>  <span class=
"org-keyword">return</span> exp
<span class="linenr">3: </span>    .replace(<span class=
"org-string">/'[^']*'|"[^"]*"/</span>g, <span class=
"org-string">''</span>)
<span class="linenr">4: </span>    .replace(<span class=
"org-string">/`[^`]+`/</span>g, stripTemplateString)
<span class="linenr">5: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-orga7be713" class="outline-4">
          <h4 id="orga7be713"><span class=
          "section-number-4">2.4.22.</span>
          stripTemplateString()</h4>
          <div class="outline-text-4" id="text-2-4-22">
            <div class="org-src-container">
              <pre class="src src-js" id="orgcc0628e"><span class=
              "linenr">1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">stripTemplateString</span>(<span class=
              "org-variable-name">str</span>) {
<span class="linenr">2: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">interpMatch</span> = str.match(<span class=
"org-string">/\${[^}]+}/</span>g)
<span class="linenr">3: </span>  <span class=
"org-keyword">if</span> (interpMatch) {
<span class="linenr">4: </span>    <span class=
"org-keyword">return</span> interpMatch.map(m =&gt; m.slice(<span class="org-highlight-numbers-number">2</span>, -<span class="org-highlight-numbers-number">1</span>)).join(<span class="org-string">','</span>)
<span class="linenr">5: </span>  }
<span class="linenr">6: </span>  <span class=
"org-keyword">return</span> <span class="org-string">''</span>
<span class="linenr">7: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org08f0a0a" class="outline-4">
          <h4 id="org08f0a0a"><span class=
          "section-number-4">2.4.23.</span> isImportUsed()</h4>
          <div class="outline-text-4" id="text-2-4-23">
            <div class="org-src-container">
              <pre class="src src-js" id="orgf17bf34"><span class=
              "linenr">1: </span><span class=
              "org-keyword">function</span> <span class=
              "org-function-name">isImportUsed</span>(<span class=
              "org-variable-name">local</span>, <span class=
              "org-variable-name">sfc</span>) {
<span class="linenr">2: </span>  <span class=
"org-keyword">return</span> <span class=
"org-keyword">new</span> <span class="org-type">RegExp</span>(
<span class="linenr">3: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">#4274 escape $ since it's a special char in regex</span>
<span class="linenr">4: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">(and is the only regex special char that is valid in identifiers)</span>
<span class="linenr">5: </span>    <span class=
"org-string">`[^\\w$_]${local.replace(/\$/g, '\\$')}[^\\w$_]`</span>
<span class=
"linenr">6: </span>  ).test(resolveTemplateUsageCheckString(sfc))
<span class="linenr">7: </span>}
</pre>
            </div>
          </div>
        </div>
        <div id="outline-container-org5f0593d" class="outline-4">
          <h4 id="org5f0593d"><span class=
          "section-number-4">2.4.24.</span> hmrShouldReload()</h4>
          <div class="outline-text-4" id="text-2-4-24">
            <div class="org-src-container">
              <pre class="src src-js" id="org9a3558b"><span class=
              "linenr"> 1: </span><span class="org-doc">/**</span>
<span class="linenr"> 2: </span><span class=
"org-doc"> * Note: this comparison assumes the prev/next script are already identical,</span>
<span class="linenr"> 3: </span><span class=
"org-doc"> * and only checks the special case where &lt;script setup lang="ts"&gt; unused import</span>
<span class="linenr"> 4: </span><span class=
"org-doc"> * pruning result changes due to template changes.</span>
<span class="linenr"> 5: </span><span class="org-doc"> */</span>
<span class="linenr"> 6: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">hmrShouldReload</span>(<span class=
"org-variable-name">prevImports</span>, <span class=
"org-variable-name">next</span>) {
<span class="linenr"> 7: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 8: </span>    !next.scriptSetup ||
<span class=
"linenr"> 9: </span>    (next.scriptSetup.lang !== <span class=
"org-string">'ts'</span> &amp;& next.scriptSetup.lang !== <span class="org-string">'tsx'</span>)
<span class="linenr">10: </span>  ) {
<span class="linenr">11: </span>    <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">12: </span>  }
<span class="linenr">13: </span>
<span class="linenr">14: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for each previous import, check if its used status remain the same based on</span>
<span class="linenr">15: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">the next descriptor's template</span>
<span class="linenr">16: </span>  <span class=
"org-keyword">for</span> (<span class=
"org-keyword">const</span> <span class=
"org-variable-name">key</span> <span class=
"org-keyword">in</span> prevImports) {
<span class="linenr">17: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if an import was previous unused, but now is used, we need to force</span>
<span class="linenr">18: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">reload so that the script now includes that import.</span>
<span class="linenr">19: </span>    <span class=
"org-keyword">if</span> (!prevImports[key].isUsedInTemplate &amp;& isImportUsed(key, next)) {
<span class="linenr">20: </span>      <span class=
"org-keyword">return</span> <span class="org-constant">true</span>
<span class="linenr">21: </span>    }
<span class="linenr">22: </span>  }
<span class="linenr">23: </span>
<span class="linenr">24: </span>  <span class=
"org-keyword">return</span> <span class="org-constant">false</span>
<span class="linenr">25: </span>}
</pre>
            </div>
          </div>
        </div>
      </div>
      <div id="outline-container-org5cb8c0d" class="outline-3">
        <h3 id="org5cb8c0d"><span class=
        "section-number-3">2.5.</span> rewriteDefault</h3>
        <div class="outline-text-3" id="text-2-5">
          <div class="org-src-container">
            <pre class="src src-js" id="org0cc6aa4"><span class=
            "linenr"> 1: </span>
<span class="linenr"> 2: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">defaultExportRE</span> = <span class=
"org-string">/((?:^|\n|;)\s*)export(\s*)default/</span>
<span class="linenr"> 3: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">namedDefaultExportRE</span> = <span class=
"org-string">/((?:^|\n|;)\s*)export(.+)as(\s*)default/</span>s
<span class="linenr"> 4: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">exportDefaultClassRE</span> =
<span class="linenr"> 5: </span>  <span class=
"org-string">/((?:^|\n|;)\s*)export\s+default\s+class\s+([\w$]+)/</span>
<span class="linenr"> 6: </span>
<span class="linenr"> 7: </span><span class="org-doc">/**</span>
<span class="linenr"> 8: </span><span class=
"org-doc"> * Utility for rewriting `export default` in a script block into a variable</span>
<span class="linenr"> 9: </span><span class=
"org-doc"> * declaration so that we can inject things into it</span>
<span class="linenr">10: </span><span class="org-doc"> */</span>
<span class="linenr">11: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">rewriteDefault</span>(<span class=
"org-variable-name">input</span>, <span class=
"org-variable-name">as</span>, <span class=
"org-variable-name">parserPlugins</span>) {
<span class="linenr">12: </span>  <span class=
"org-keyword">if</span> (!hasDefaultExport(input)) {
<span class="linenr">13: </span>    <span class=
"org-keyword">return</span> input + <span class=
"org-string">`\nconst ${as} = {}`</span>
<span class="linenr">14: </span>  }
<span class="linenr">15: </span>
<span class="linenr">16: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">replaced</span>
<span class="linenr">17: </span>
<span class="linenr">18: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">classMatch</span> = input.match(exportDefaultClassRE)
<span class="linenr">19: </span>  <span class=
"org-keyword">if</span> (classMatch) {
<span class="linenr">20: </span>    replaced =
<span class=
"linenr">21: </span>      input.replace(exportDefaultClassRE, <span class="org-string">'$1class $2'</span>) +
<span class="linenr">22: </span>      <span class=
"org-string">`\nconst ${as} = ${classMatch[2]}`</span>
<span class="linenr">23: </span>  } <span class=
"org-keyword">else</span> {
<span class=
"linenr">24: </span>    replaced = input.replace(defaultExportRE, <span class="org-string">`$1const ${as} =`</span>)
<span class="linenr">25: </span>  }
<span class="linenr">26: </span>  <span class=
"org-keyword">if</span> (!hasDefaultExport(replaced)) {
<span class="linenr">27: </span>    <span class=
"org-keyword">return</span> replaced
<span class="linenr">28: </span>  }
<span class="linenr">29: </span>
<span class="linenr">30: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">if the script somehow still contains `default export`, it probably has</span>
<span class="linenr">31: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">multi-line comments or template strings. fallback to a full parse.</span>
<span class="linenr">32: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">s</span> = <span class=
"org-keyword">new</span> <span class=
"org-type">MagicString</span>(input)
<span class="linenr">33: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">ast</span> = babelParser.parse(input, {
<span class="linenr">34: </span>    sourceType: <span class=
"org-string">'module'</span>,
<span class="linenr">35: </span>    plugins: parserPlugins
<span class="linenr">36: </span>  }).program.body
<span class="linenr">37: </span>  ast.forEach(node =&gt; {
<span class="linenr">38: </span>    <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ExportDefaultDeclaration'</span>) {
<span class=
"linenr">39: </span>      s.overwrite(node.start, node.declaration.start, <span class="org-string">`const ${as} = `</span>)
<span class="linenr">40: </span>    }
<span class="linenr">41: </span>    <span class=
"org-keyword">if</span> (node.type === <span class=
"org-string">'ExportNamedDeclaration'</span>) {
<span class=
"linenr">42: </span>      node.specifiers.forEach(specifier =&gt; {
<span class="linenr">43: </span>        <span class=
"org-keyword">if</span> (
<span class=
"linenr">44: </span>          specifier.type === <span class=
"org-string">'ExportSpecifier'</span> &amp;&
<span class=
"linenr">45: </span>          specifier.exported.type === <span class="org-string">'Identifier'</span> &amp;&
<span class=
"linenr">46: </span>          specifier.exported.name === <span class="org-string">'default'</span>
<span class="linenr">47: </span>        ) {
<span class="linenr">48: </span>          <span class=
"org-keyword">const</span> <span class=
"org-variable-name">end</span> = specifier.end
<span class="linenr">49: </span>          s.overwrite(
<span class="linenr">50: </span>            specifier.start,
<span class=
"linenr">51: </span>            input.charAt(end) === <span class=
"org-string">','</span> ? end + <span class=
"org-highlight-numbers-number">1</span> : end,
<span class="linenr">52: </span>            <span class=
"org-string">``</span>
<span class="linenr">53: </span>          )
<span class="linenr">54: </span>          s.append(<span class=
"org-string">`\nconst ${as} = ${specifier.local.name}`</span>)
<span class="linenr">55: </span>        }
<span class="linenr">56: </span>      })
<span class="linenr">57: </span>    }
<span class="linenr">58: </span>  })
<span class="linenr">59: </span>  <span class=
"org-keyword">return</span> s.toString()
<span class="linenr">60: </span>}
<span class="linenr">61: </span>
<span class="linenr">62: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">hasDefaultExport</span>(<span class=
"org-variable-name">input</span>) {
<span class="linenr">63: </span>  <span class=
"org-keyword">return</span> defaultExportRE.test(input) || namedDefaultExportRE.test(input)
<span class="linenr">64: </span>}
</pre>
          </div>
        </div>
      </div>
      <div id="outline-container-org51806fe" class="outline-3">
        <h3 id="org51806fe"><span class=
        "section-number-3">2.6.</span> cssVars</h3>
        <div class="outline-text-3" id="text-2-6">
          <div class="org-src-container">
            <pre class="src src-js" id="orgc94db5a"><span class=
            "linenr">  1: </span><span class=
            "org-keyword">const</span> <span class=
            "org-variable-name">hash</span> = require(process.env.NODE_LIB + <span class="org-string">'/hash-sum'</span>)
<span class="linenr">  2: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">CSS_VARS_HELPER</span> = <span class=
"org-string">`useCssVars`</span>
<span class="linenr">  3: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">match v-bind() with max 2-levels of nested parens.</span>
<span class="linenr">  4: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">cssVarRE</span> = <span class=
"org-string">/v-bind\s*\(((?:[^)(]+|\((?:[^)(]+|\([^)(]*\))*\))*)\)/</span>g
<span class="linenr">  5: </span>
<span class="linenr">  6: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genCssVarsFromList</span>(
<span class="linenr">  7: </span>  <span class=
"org-variable-name">vars</span>,
<span class="linenr">  8: </span>  <span class=
"org-variable-name">id</span>,
<span class="linenr">  9: </span>  isProd
<span class="linenr"> 10: </span>) {
<span class="linenr"> 11: </span>  <span class=
"org-keyword">return</span> <span class=
"org-string">`{\n  ${vars</span>
<span class="linenr"> 12: </span><span class=
"org-string">    .map(key =&gt; `"${genVarName(id, key, isProd)}"</span>: (${key})<span class="org-string">`)</span>
<span class="linenr"> 13: </span><span class=
"org-string">    .join(',\n  ')}\n}`</span>
<span class="linenr"> 14: </span>}
<span class="linenr"> 15: </span>
<span class="linenr"> 16: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genVarName</span>(<span class=
"org-variable-name">id</span>, <span class=
"org-variable-name">raw</span>, <span class=
"org-variable-name">isProd</span>) {
<span class="linenr"> 17: </span>  <span class=
"org-keyword">if</span> (isProd) {
<span class="linenr"> 18: </span>    <span class=
"org-keyword">return</span> hash(id + raw)
<span class="linenr"> 19: </span>  } <span class=
"org-keyword">else</span> {
<span class="linenr"> 20: </span>    <span class=
"org-keyword">return</span> <span class=
"org-string">`${id}-${raw.replace(/([^\w-])/g, '_')}`</span>
<span class="linenr"> 21: </span>  }
<span class="linenr"> 22: </span>}
<span class="linenr"> 23: </span>
<span class="linenr"> 24: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">noramlizeExpression</span>(<span class=
"org-variable-name">exp</span>) {
<span class="linenr"> 25: </span>  exp = exp.trim()
<span class="linenr"> 26: </span>  <span class=
"org-keyword">if</span> (
<span class="linenr"> 27: </span>    (exp[<span class=
"org-highlight-numbers-number">0</span>] === <span class=
"org-string">`'`</span> &amp;& exp[exp.length - <span class=
"org-highlight-numbers-number">1</span>] === <span class=
"org-string">`'`</span>) ||
<span class="linenr"> 28: </span>    (exp[<span class=
"org-highlight-numbers-number">0</span>] === <span class=
"org-string">`"`</span> &amp;& exp[exp.length - <span class=
"org-highlight-numbers-number">1</span>] === <span class=
"org-string">`"`</span>)
<span class="linenr"> 29: </span>  ) {
<span class="linenr"> 30: </span>    <span class=
"org-keyword">return</span> exp.slice(<span class=
"org-highlight-numbers-number">1</span>, -<span class=
"org-highlight-numbers-number">1</span>)
<span class="linenr"> 31: </span>  }
<span class="linenr"> 32: </span>  <span class=
"org-keyword">return</span> exp
<span class="linenr"> 33: </span>}
<span class="linenr"> 34: </span>
<span class="linenr"> 35: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">parseCssVars</span>(<span class=
"org-variable-name">sfc</span>) {
<span class="linenr"> 36: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">vars</span> = []
<span class="linenr"> 37: </span>  sfc.styles.forEach(style =&gt; {
<span class="linenr"> 38: </span>    <span class=
"org-keyword">let</span> <span class=
"org-variable-name">match</span>
<span class="linenr"> 39: </span>    <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">ignore v-bind() in comments /* ... */</span>
<span class="linenr"> 40: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">content</span> = style.content.replace(<span class="org-string">/\/\*([\s\S]*?)\*\//</span>g, <span class="org-string">''</span>)
<span class="linenr"> 41: </span>    <span class=
"org-keyword">while</span> ((match = cssVarRE.exec(content))) {
<span class="linenr"> 42: </span>      <span class=
"org-keyword">const</span> <span class=
"org-variable-name">variable</span> = noramlizeExpression(match[<span class="org-highlight-numbers-number">1</span>])
<span class="linenr"> 43: </span>      <span class=
"org-keyword">if</span> (!vars.includes(variable)) {
<span class="linenr"> 44: </span>        vars.push(variable)
<span class="linenr"> 45: </span>      }
<span class="linenr"> 46: </span>    }
<span class="linenr"> 47: </span>  })
<span class="linenr"> 48: </span>  <span class=
"org-keyword">return</span> vars
<span class="linenr"> 49: </span>}
<span class="linenr"> 50: </span>
<span class="linenr"> 51: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">for compileStyle</span>
<span class="linenr"> 52: </span>
<span class="linenr"> 53: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">cssVarsPlugin</span> = opts =&gt; {
<span class="linenr"> 54: </span>  <span class=
"org-keyword">const</span> { id, isProd } = opts
<span class="linenr"> 55: </span>  <span class=
"org-keyword">return</span> {
<span class="linenr"> 56: </span>    postcssPlugin: <span class=
"org-string">'vue-sfc-vars'</span>,
<span class="linenr"> 57: </span>    Declaration(decl) {
<span class="linenr"> 58: </span>      <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">rewrite CSS variables</span>
<span class="linenr"> 59: </span>      <span class=
"org-keyword">if</span> (cssVarRE.test(decl.value)) {
<span class=
"linenr"> 60: </span>        decl.value = decl.value.replace(cssVarRE, (_, $1) =&gt; {
<span class="linenr"> 61: </span>          <span class=
"org-keyword">return</span> <span class=
"org-string">`var(--${genVarName(id, noramlizeExpression($1), isProd)})`</span>
<span class="linenr"> 62: </span>        })
<span class="linenr"> 63: </span>      }
<span class="linenr"> 64: </span>    }
<span class="linenr"> 65: </span>  }
<span class="linenr"> 66: </span>}
<span class=
"linenr"> 67: </span>cssVarsPlugin.postcss = <span class=
"org-constant">true</span>
<span class="linenr"> 68: </span>
<span class="linenr"> 69: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genCssVarsCode</span>(
<span class="linenr"> 70: </span>  <span class=
"org-variable-name">vars</span>,
<span class="linenr"> 71: </span>  <span class=
"org-variable-name">bindings</span>,
<span class="linenr"> 72: </span>  <span class=
"org-variable-name">id</span>,
<span class="linenr"> 73: </span>  isProd
<span class="linenr"> 74: </span>) {
<span class="linenr"> 75: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">varsExp</span> = genCssVarsFromList(vars, id, isProd)
<span class="linenr"> 76: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">exp</span> = createSimpleExpression(varsExp, <span class="org-constant">false</span>)
<span class="linenr"> 77: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">context</span> = createTransformContext(createRoot([]), {
<span class=
"linenr"> 78: </span>    prefixIdentifiers: <span class="org-constant">true</span>,
<span class="linenr"> 79: </span>    inline: <span class=
"org-constant">true</span>,
<span class=
"linenr"> 80: </span>    bindingMetadata: bindings.__isScriptSetup === <span class="org-constant">false</span> ? <span class="org-constant">undefined</span> : bindings
<span class="linenr"> 81: </span>  })
<span class="linenr"> 82: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformed</span> = processExpression(exp, context)
<span class="linenr"> 83: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">transformedString</span> =
<span class=
"linenr"> 84: </span>    transformed.type === NodeTypes.SIMPLE_EXPRESSION
<span class="linenr"> 85: </span>      ? transformed.content
<span class="linenr"> 86: </span>      : transformed.children
<span class="linenr"> 87: </span>          .map(c =&gt; {
<span class="linenr"> 88: </span>            <span class=
"org-keyword">return</span> <span class=
"org-keyword">typeof</span> c === <span class=
"org-string">'string'</span>
<span class="linenr"> 89: </span>              ? c
<span class="linenr"> 90: </span>              : c.content
<span class="linenr"> 91: </span>          })
<span class="linenr"> 92: </span>          .join(<span class=
"org-string">''</span>)
<span class="linenr"> 93: </span>
<span class="linenr"> 94: </span>  <span class=
"org-keyword">return</span> <span class=
"org-string">`_${CSS_VARS_HELPER}(_ctx =&gt; (${transformedString}))`</span>
<span class="linenr"> 95: </span>}
<span class="linenr"> 96: </span>
<span class="linenr"> 97: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">&lt;script setup&gt; already gets the calls injected as part of the transform</span>
<span class="linenr"> 98: </span><span class=
"org-comment-delimiter">// </span><span class=
"org-comment">this is only for single normal &lt;script&gt;</span>
<span class="linenr"> 99: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">genNormalScriptCssVarsCode</span>(
<span class="linenr">100: </span>  <span class=
"org-variable-name">cssVars</span>,
<span class="linenr">101: </span>  <span class=
"org-variable-name">bindings</span>,
<span class="linenr">102: </span>  <span class=
"org-variable-name">id</span>,
<span class="linenr">103: </span>  isProd
<span class="linenr">104: </span>) {
<span class="linenr">105: </span>  <span class=
"org-keyword">return</span> (
<span class="linenr">106: </span>    <span class=
"org-string">`\nimport { ${CSS_VARS_HELPER} as _${CSS_VARS_HELPER} } from 'vue'\n`</span> +
<span class="linenr">107: </span>    <span class=
"org-string">`const __injectCSSVars__ = () =&gt; {\n${genCssVarsCode(</span>
<span class="linenr">108: </span><span class=
"org-string">      cssVars,</span>
<span class="linenr">109: </span><span class=
"org-string">      bindings,</span>
<span class="linenr">110: </span><span class=
"org-string">      id,</span>
<span class="linenr">111: </span><span class=
"org-string">      isProd</span>
<span class="linenr">112: </span><span class=
"org-string">    )}}\n`</span> +
<span class="linenr">113: </span>    <span class=
"org-string">`const __setup__ = __default__.setup\n`</span> +
<span class="linenr">114: </span>    <span class=
"org-string">`__default__.setup = __setup__\n`</span> +
<span class="linenr">115: </span>    <span class=
"org-string">`  ? (props, ctx) =&gt; { __injectCSSVars__();return __setup__(props, ctx) }\n`</span> +
<span class="linenr">116: </span>    <span class=
"org-string">`  : __injectCSSVars__\n`</span>
<span class="linenr">117: </span>  )
<span class="linenr">118: </span>}
<span class="linenr">119: </span>
</pre>
          </div>
        </div>
      </div>
      <div id="outline-container-org1cf2850" class="outline-3">
        <h3 id="org1cf2850"><span class=
        "section-number-3">2.7.</span> testing</h3>
        <div class="outline-text-3" id="text-2-7">
          <div class="org-src-container">
            <pre class="src src-js" id="orgd340279"><span class=
            "linenr"> 1: </span>&lt;&lt;compiler-sfc&gt;&gt;
<span class="linenr"> 2: </span>
<span class="linenr"> 3: </span><span class=
"org-keyword">const</span> <span class=
"org-variable-name">mockId</span> = <span class=
"org-string">'xxxxxxxx'</span>
<span class="linenr"> 4: </span>
<span class="linenr"> 5: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">compileSFCScript</span>(
<span class="linenr"> 6: </span>  <span class=
"org-variable-name">src</span>,
<span class="linenr"> 7: </span>  options
<span class="linenr"> 8: </span>) {
<span class="linenr"> 9: </span>  <span class=
"org-keyword">const</span> { descriptor } = parse(src)
<span class="linenr">10: </span>  <span class=
"org-keyword">return</span> compileScript(descriptor, {
<span class="linenr">11: </span>    ...options,
<span class="linenr">12: </span>    id: mockId
<span class="linenr">13: </span>  })
<span class="linenr">14: </span>}
</pre>
          </div>
          <div class="org-src-container">
            <pre class="src src-js"><span class=
            "linenr"> 1: </span>&lt;&lt;sfc-testing&gt;&gt;
<span class="linenr"> 2: </span>
<span class="linenr"> 3: </span><span class=
"org-keyword">const</span> { content, bindings } = compileSFCScript(<span class="org-string">`</span>
<span class="linenr"> 4: </span><span class=
"org-string">      &lt;script setup&gt;</span>
<span class="linenr"> 5: </span><span class=
"org-string">      import { x } from './x'</span>
<span class="linenr"> 6: </span><span class=
"org-string">      let a = 1</span>
<span class="linenr"> 7: </span><span class=
"org-string">      const b = 2</span>
<span class="linenr"> 8: </span><span class=
"org-string">      function c() {}</span>
<span class="linenr"> 9: </span><span class=
"org-string">      class d {}</span>
<span class="linenr">10: </span><span class=
"org-string">      &lt;/script&gt;</span>
<span class="linenr">11: </span>
<span class="linenr">12: </span><span class=
"org-string">      &lt;script&gt;</span>
<span class="linenr">13: </span><span class=
"org-string">      import { xx } from './x'</span>
<span class="linenr">14: </span><span class=
"org-string">      let aa = 1</span>
<span class="linenr">15: </span><span class=
"org-string">      const bb = 2</span>
<span class="linenr">16: </span><span class=
"org-string">      function cc() {}</span>
<span class="linenr">17: </span><span class=
"org-string">      class dd {}</span>
<span class="linenr">18: </span><span class=
"org-string">      &lt;/script&gt;</span>
<span class="linenr">19: </span><span class=
"org-string">      `</span>)
</pre>
          </div>
        </div>
      </div>
    </div>
    <div id="outline-container-org5259eed" class="outline-2">
      <h2 id="org5259eed"><span class="section-number-2">3.</span>
      template</h2>
      <div class="outline-text-2" id="text-3"></div>
      <div id="outline-container-org7ca679e" class="outline-3">
        <h3 id="org7ca679e"><span class=
        "section-number-3">3.1.</span> compileTemplate()</h3>
        <div class="outline-text-3" id="text-3-1">
          <div class="org-src-container">
            <pre class="src src-js" id="org5d78677"><span class=
            "linenr"> 1: </span><span class=
            "org-keyword">function</span> <span class=
            "org-function-name">compileTemplate</span>(<span class=
            "org-variable-name">options</span>) {
<span class="linenr"> 2: </span>  <span class=
"org-comment-delimiter">// </span><span class=
"org-comment">...省略直接使用现有的 compile</span>
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span>  <span class=
"org-keyword">return</span> doCompileTemplate(options)
<span class="linenr"> 5: </span>}
<span class="linenr"> 6: </span>
<span class="linenr"> 7: </span><span class=
"org-keyword">function</span> <span class=
"org-function-name">doCompileTemplate</span>({
<span class="linenr"> 8: </span>  filename,
<span class="linenr"> 9: </span>  id,
<span class="linenr">10: </span>  scoped,
<span class="linenr">11: </span>  slotted,
<span class="linenr">12: </span>  inMap,
<span class="linenr">13: </span>  source,
<span class="linenr">14: </span>  ssr = <span class=
"org-constant">false</span>,
<span class="linenr">15: </span>  ssrCssVars,
<span class="linenr">16: </span>  isProd = <span class=
"org-constant">false</span>,
<span class="linenr">17: </span>  compiler,
<span class="linenr">18: </span>  compilerOptions = {},
<span class="linenr">19: </span>  transformAssetUrls
<span class="linenr">20: </span>}) {
<span class="linenr">21: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">errors</span> = []
<span class="linenr">22: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">warnings</span> = []
<span class="linenr">23: </span>
<span class="linenr">24: </span>  <span class=
"org-keyword">let</span> <span class=
"org-variable-name">nodeTransforms</span> = []
<span class="linenr">25: </span>  <span class=
"org-keyword">if</span> (isObject(transformAssetUrls)) {
<span class="linenr">26: </span>    <span class=
"org-keyword">const</span> <span class=
"org-variable-name">assetOptions</span> = normalizeOptions(transformAssetUrls)
<span class="linenr">27: </span>    nodeTransforms = [
<span class=
"linenr">28: </span>      createAssetUrlTransformWithOptions(assetOptions),
<span class=
"linenr">29: </span>      createSrcsetTransformWithOptions(assetOptions)
<span class="linenr">30: </span>    ]
<span class="linenr">31: </span>  } <span class=
"org-keyword">else</span> <span class=
"org-keyword">if</span> (transformAssetUrls !== <span class=
"org-constant">false</span>) {
<span class=
"linenr">32: </span>    nodeTransforms = [transformAssetUrl, transformSrcset]
<span class="linenr">33: </span>  }
<span class="linenr">34: </span>
<span class="linenr">35: </span>  <span class=
"org-keyword">if</span> (!id) {
<span class="linenr">36: </span>    id = <span class=
"org-string">''</span>
<span class="linenr">37: </span>  }
<span class="linenr">38: </span>
<span class="linenr">39: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">shortId</span> = id.replace(<span class=
"org-string">/^data-v-/</span>, <span class="org-string">''</span>)
<span class="linenr">40: </span>  <span class=
"org-keyword">const</span> <span class=
"org-variable-name">longId</span> = <span class=
"org-string">`data-v-${shortId}`</span>
<span class="linenr">41: </span>
<span class="linenr">42: </span>  <span class=
"org-keyword">let</span> { code, ast, preamble, map } = baseCompile(source, {
<span class="linenr">43: </span>    mode: <span class=
"org-string">'module'</span>,
<span class="linenr">44: </span>    prefixIdentifiers: <span class=
"org-constant">true</span>,
<span class="linenr">45: </span>    hoistStatic: <span class=
"org-constant">true</span>,
<span class="linenr">46: </span>    cacheHandlers: <span class=
"org-constant">true</span>,
<span class="linenr">47: </span>    ssrCssVars:
<span class=
"linenr">48: </span>      ssr &amp;& ssrCssVars &amp;& ssrCssVars.length
<span class=
"linenr">49: </span>        ? genCssVarsFromList(ssrCssVars, shortId, isProd)
<span class="linenr">50: </span>        : <span class=
"org-string">''</span>,
<span class=
"linenr">51: </span>    scopeId: scoped ? longId : <span class=
"org-constant">undefined</span>,
<span class="linenr">52: </span>    slotted,
<span class="linenr">53: </span>    sourceMap: <span class=
"org-constant">true</span>,
<span class="linenr">54: </span>    ...compilerOptions,
<span class=
"linenr">55: </span>    nodeTransforms: nodeTransforms.concat(compilerOptions.nodeTransforms || []),
<span class="linenr">56: </span>    filename,
<span class=
"linenr">57: </span>    onError: e =&gt; errors.push(e),
<span class=
"linenr">58: </span>    onWarn: w =&gt; warnings.push(w)
<span class="linenr">59: </span>  })
<span class="linenr">60: </span>
<span class="linenr">61: </span>  <span class=
"org-keyword">return</span> { code, ast, preamble, source, errors, tips, map }
<span class="linenr">62: </span>}
</pre>
          </div>
        </div>
      </div>
    </div>
    <div id="outline-container-org9b490a0" class="outline-2">
      <h2 id="org9b490a0"><span class="section-number-2">4.</span>
      mindmaps</h2>
      <div class="outline-text-2" id="text-4">
        <p><a href="#org4db62e5">compileScript()</a>:</p><a href=
        "../assets/img/vue3/compiler-sfc/vue-compiler-sfc-compile-script.svg"
        data-fancybox="gallery" data-caption="Preview"><img src=
        "../assets/img/vue3/compiler-sfc/vue-compiler-sfc-compile-script.svg"></a>
        <p>关键知识点：</p><a href=
        "../assets/img/vue3/compiler-sfc/vue-compiler-sfc-keypoints.svg"
        data-fancybox="gallery" data-caption="Preview"><img src=
        "../assets/img/vue3/compiler-sfc/vue-compiler-sfc-keypoints.svg"></a>
      </div>
    </div>
  </div>
  <div id="postamble" class="status">
    <p class="author">Author: Zhicheng Lee</p>
    <p class="date">Created: 2022-05-05 Thu 10:14</p>
  </div>
</body>
</html>
